(self.webpackChunklogic_programming=self.webpackChunklogic_programming||[]).push([[566],{1566:(ci,po,Ee)=>{"use strict";Ee.r(po),Ee.d(po,{HomeModule:()=>He});var V=Ee(6814),Je=Ee(9310),t=Ee(4946);let D=(()=>{class u{constructor(r){this.router=r}isElectron(){return!!(window&&window.process&&window.process.type||window&&window.require||typeof navigator<"u"&&navigator.userAgent.toLowerCase().indexOf("electron")>-1||"file:"===window.location.protocol)}isGitHubPages(){return"napssters.github.io"===window.location.hostname}isLocalDevelopment(){return"localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname}navigateTo(r){if(console.log("Environment check:",{isElectron:this.isElectron(),isGitHubPages:this.isGitHubPages(),isLocalDevelopment:this.isLocalDevelopment(),protocol:window.location.protocol,hostname:window.location.hostname}),this.isElectron())console.log("Using Angular Router for Electron:",r),this.router.navigate([r]);else if(this.isGitHubPages()){const c=`/logic-programming${r}`;console.log("Using window.location for GitHub Pages:",c),window.location.href=c}else console.log("Using Angular Router for local development:",r),this.router.navigate([r])}static{this.\u0275fac=function(c){return new(c||u)(t.LFG(Je.F0))}}static{this.\u0275prov=t.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"})}}return u})(),p=(()=>{class u{transform(r){return r?"funciones y modularidad"===r.trim().toLowerCase()?"Funciones/Modularidad":"abstracci\xf3n y simplificaci\xf3n"===r.trim().toLowerCase()?"Abstracci\xf3n/Simplificaci\xf3n":r:""}static{this.\u0275fac=function(c){return new(c||u)}}static{this.\u0275pipe=t.Yjl({name:"cardTitleFormat",type:u,pure:!0})}}return u})();function mt(u,T){if(1&u){const r=t.EpF();t.TgZ(0,"div",2)(1,"button",3),t.NdJ("click",function(){const g=t.CHM(r).$implicit,f=t.oxw();return t.KtG(f.redirigir(g.url))}),t.TgZ(2,"div",4)(3,"div",5)(4,"div",6),t._UZ(5,"img",7),t.qZA(),t.TgZ(6,"h3",8),t.ALo(7,"cardTitleFormat"),t._uU(8),t.ALo(9,"cardTitleFormat"),t.qZA()(),t.TgZ(10,"div",9)(11,"span",10),t._uU(12),t.qZA(),t.TgZ(13,"p",11),t._uU(14),t.qZA()()()()()}if(2&u){const r=T.$implicit,c=T.index;t.xp6(4),t.Udp("background",r.color),t.xp6(1),t.Q6J("src",r.image,t.LSH)("alt",r.title),t.xp6(1),t.Q6J("ngClass","Abstracci\xf3n/Simplificaci\xf3n"===t.lcZ(7,8,r.title)?"text-left":"text-center justify-center mx-auto"),t.xp6(2),t.Oqu(t.lcZ(9,10,r.title)),t.xp6(4),t.hij("M\xf3dulo ",c+1,""),t.xp6(2),t.Oqu(r.description)}}let Bo=(()=>{class u{constructor(r){this.navigationService=r,this.cards=[]}redirigir(r){this.navigationService.navigateTo(r)}static{this.\u0275fac=function(c){return new(c||u)(t.Y36(D))}}static{this.\u0275cmp=t.Xpm({type:u,selectors:[["app-cards"]],inputs:{cards:"cards"},decls:2,vars:1,consts:[[1,"grid","grid-cols-1","md:grid-cols-3","gap-32","justify-center","mb-20"],["class","card-flip-container",4,"ngFor","ngForOf"],[1,"card-flip-container"],[1,"card-link",3,"click"],[1,"card-flip"],[1,"card-flip-front","flex","flex-col","items-center","justify-center","rounded-xl","shadow-lg","p-6","h-[292px]","w-[286px]","cursor-pointer","bg-white"],[1,"w-[153px]","h-[153px]","mb-4","rounded-full","shadow-md","flex","items-center","justify-center"],[1,"w-[145px]","h-[145px]","rounded-full","object-cover",3,"src","alt"],[1,"text-base","font-semibold","text-gray-900","drop-shadow","max-w-[250px]","line-clamp-2","h-12","flex","items-center",3,"ngClass"],[1,"card-flip-back","flex","flex-col","items-center","justify-center","rounded-xl","shadow-lg","p-6","h-[292px]","w-[286px]","cursor-pointer","bg-white/90"],[1,"text-sm","font-bold","text-cyan-700","mb-2"],[1,"text-base","text-gray-800","w-full","text-justify"]],template:function(c,a){1&c&&(t.TgZ(0,"div",0),t.YNc(1,mt,15,12,"div",1),t.qZA()),2&c&&(t.xp6(1),t.Q6J("ngForOf",a.cards))},dependencies:[V.mk,V.sg,p],styles:[".card-flip-container[_ngcontent-%COMP%]{perspective:1000px;display:flex;justify-content:center;align-items:center}.card-link[_ngcontent-%COMP%]{text-decoration:none}.card-flip[_ngcontent-%COMP%]{width:260px;height:280px;position:relative;transition:transform .6s;transform-style:preserve-3d;cursor:pointer}.card-flip-container[_ngcontent-%COMP%]:hover   .card-flip[_ngcontent-%COMP%]{transform:rotateY(180deg)}.card-flip-front[_ngcontent-%COMP%], .card-flip-back[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;backface-visibility:hidden;border-radius:1rem;box-shadow:0 8px 32px #1f26875e;display:flex;flex-direction:column;align-items:center;justify-content:center}.card-flip-back[_ngcontent-%COMP%]{transform:rotateY(180deg)}"]})}}return u})(),Po=(()=>{class u{static{this.\u0275fac=function(c){return new(c||u)}}static{this.\u0275cmp=t.Xpm({type:u,selectors:[["app-tutorial"]],decls:88,vars:0,consts:[[1,"p-4","max-w-2xl","mx-auto"],[1,"text-3xl","font-extrabold","mb-4","text-cyan-700"],[1,"mb-6","text-lg","text-gray-700"],[1,"mb-8"],[1,"text-xl","font-bold","text-cyan-600","mb-2"],[1,"flex","gap-4","flex-wrap"],["src","assets/img/tutorial/menu-flotante.png","alt","Men\xfa flotante",1,"tutorial-img"],["src","assets/img/tutorial/menu-flotante-2.png","alt","Men\xfa flotante 2",1,"tutorial-img"],["src","assets/img/tutorial/pantalla-ppal.png","alt","Pantalla principal",1,"tutorial-img"],["src","assets/img/tutorial/modulos.png","alt","M\xf3dulos",1,"tutorial-img"],["src","assets/img/tutorial/modulos-card-girado.png","alt","M\xf3dulo girado",1,"tutorial-img"],["src","assets/img/tutorial/ejemplos.png","alt","Ejemplos",1,"tutorial-img"],["src","assets/img/tutorial/ejercicios.png","alt","Ejercicios",1,"tutorial-img"],["src","assets/img/tutorial/seccion-ejemplo.png","alt","Controles de ejercicios y ejemplos",1,"tutorial-img"],[1,"list-disc","ml-6"],[1,"mt-2"],["src","assets/img/tutorial/paso-a-paso.png","alt","Diagrama de flujo",1,"tutorial-img"],["src","assets/img/tutorial/blockly.png","alt","Blockly",1,"tutorial-img"],["src","assets/img/tutorial/seleccionar-opcion.png","alt","Selecci\xf3n de opci\xf3n",1,"tutorial-img"],[1,"mt-8","text-center","text-lg","text-cyan-700","font-semibold"]],template:function(c,a){1&c&&(t.TgZ(0,"div",0)(1,"h2",1),t._uU(2,"Tutorial de uso del aplicativo"),t.qZA(),t.TgZ(3,"p",2),t._uU(4,"Bienvenido. Aqu\xed aprender\xe1s c\xf3mo usar cada parte del aplicativo paso a paso, con im\xe1genes y explicaciones sencillas. Si nunca has usado una app de l\xf3gica de programaci\xf3n, este tutorial es para ti."),t.qZA(),t.TgZ(5,"div",3)(6,"h3",4),t._uU(7,"1. Navegaci\xf3n flotante"),t.qZA(),t.TgZ(8,"div",5),t._UZ(9,"img",6)(10,"img",7),t.qZA(),t.TgZ(11,"p"),t._uU(12,"En la esquina inferior derecha ver\xe1s un bot\xf3n flotante. Haz clic para moverte entre los m\xf3dulos del curso. Puedes ir al siguiente, anterior o volver al inicio f\xe1cilmente."),t._UZ(13,"br"),t._uU(14," Si pones el mouse encima de cada bot\xf3n, aparecer\xe1 un peque\xf1o mensaje que te explica para qu\xe9 sirve cada uno. As\xed sabr\xe1s si el bot\xf3n te lleva al siguiente m\xf3dulo, al anterior o al inicio."),t.qZA()(),t.TgZ(15,"div",3)(16,"h3",4),t._uU(17,"2. Pantalla principal y m\xf3dulos"),t.qZA(),t.TgZ(18,"div",5),t._UZ(19,"img",8)(20,"img",9)(21,"img",10),t.qZA(),t.TgZ(22,"p"),t._uU(23,"En la pantalla principal ver\xe1s tarjetas de colores. Cada tarjeta es un m\xf3dulo. Haz clic en una para abrir su contenido y empezar a aprender."),t._UZ(24,"br"),t._uU(25," Si pones el mouse encima de una tarjeta, ver\xe1s una animaci\xf3n donde la tarjeta gira y te muestra m\xe1s detalles sobre el m\xf3dulo."),t.qZA()(),t.TgZ(26,"div",3)(27,"h3",4),t._uU(28,"3. Ejercicios y ejemplos"),t.qZA(),t.TgZ(29,"div",5),t._UZ(30,"img",11)(31,"img",12),t.qZA(),t.TgZ(32,"p"),t._uU(33,"Dentro de cada m\xf3dulo encontrar\xe1s ejemplos y ejercicios. Los ejemplos te muestran c\xf3mo funciona la l\xf3gica. Los ejercicios te permiten practicar y resolver problemas."),t.qZA()(),t.TgZ(34,"div",3)(35,"h3",4),t._uU(36,"4. Controles de ejercicios y ejemplos"),t.qZA(),t._UZ(37,"img",13),t.TgZ(38,"ul",14)(39,"li")(40,"b"),t._uU(41,"Avanzar:"),t.qZA(),t._uU(42,' Pasa al siguiente paso del ejercicio. Si pones el mouse encima del bot\xf3n, ver\xe1s un mensaje que te dice "Avanzar".'),t.qZA(),t.TgZ(43,"li")(44,"b"),t._uU(45,"Retroceder:"),t.qZA(),t._uU(46,' Vuelve al paso anterior. Al poner el mouse encima, ver\xe1s el mensaje "Retroceder".'),t.qZA(),t.TgZ(47,"li")(48,"b"),t._uU(49,"Reiniciar:"),t.qZA(),t._uU(50,' Vuelve a empezar el ejercicio desde cero. El mensaje "Reiniciar" te ayuda a saber para qu\xe9 sirve el bot\xf3n.'),t.qZA()(),t.TgZ(51,"p",15),t._uU(52,"Usa estos botones para controlar el ritmo y repetir los ejercicios cuantas veces quieras. Siempre que pongas el mouse encima de un bot\xf3n, aparecer\xe1 un mensaje que te explica su funci\xf3n."),t.qZA()(),t.TgZ(53,"div",3)(54,"h3",4),t._uU(55,"5. Diagrama de flujo"),t.qZA(),t._UZ(56,"img",16),t.TgZ(57,"p"),t._uU(58,"Muchos ejercicios muestran un diagrama de flujo. Este te ayuda a visualizar la l\xf3gica y el orden de los pasos. Observa c\xf3mo se conectan los bloques y sigue el flujo para entender el proceso."),t.qZA()(),t.TgZ(59,"div",3)(60,"h3",4),t._uU(61,"6. Uso de Blockly"),t.qZA(),t._UZ(62,"img",17),t.TgZ(63,"p"),t._uU(64,'Blockly es una herramienta visual para programar con bloques. Arrastra los bloques, \xfanelos y arma tu soluci\xf3n. Haz clic en "Ejecutar" para ver el resultado y comprobar si tu l\xf3gica es correcta.'),t.qZA()(),t.TgZ(65,"div",3)(66,"h3",4),t._uU(67,"7. Selecci\xf3n de opciones en Concepto de Variables"),t.qZA(),t._UZ(68,"img",18),t.TgZ(69,"p"),t._uU(70,"En el m\xf3dulo de Concepto de Variables, ver\xe1s una lista de opciones. Haz clic en una para abrir ejemplos y ejercicios espec\xedficos de ese tema."),t.qZA()(),t.TgZ(71,"div",3)(72,"h3",4),t._uU(73,"8. Consejos para aprender mejor"),t.qZA(),t.TgZ(74,"ul",14)(75,"li"),t._uU(76,"Lee cada explicaci\xf3n con calma y sigue los pasos."),t.qZA(),t.TgZ(77,"li"),t._uU(78,"Practica los ejercicios varias veces para dominar la l\xf3gica."),t.qZA(),t.TgZ(79,"li"),t._uU(80,"Usa los diagramas de flujo para entender el proceso antes de programar."),t.qZA(),t.TgZ(81,"li"),t._uU(82,"No tengas miedo de equivocarte, cada error es una oportunidad para aprender."),t.qZA(),t.TgZ(83,"li"),t._uU(84,"Si tienes dudas, revisa el tutorial o pregunta a tu profesor."),t.qZA()()(),t.TgZ(85,"div",19)(86,"p"),t._uU(87,"\xa1Listo! Ya sabes c\xf3mo usar el aplicativo. Explora, practica y aprende l\xf3gica de programaci\xf3n de forma visual y divertida."),t.qZA()()())},styles:[".tutorial-img[_ngcontent-%COMP%]{box-shadow:0 4px 16px #0000001f;border-radius:1rem}",".tutorial-img[_ngcontent-%COMP%] {\n    width: 180px;\n    max-width: 100%;\n    border-radius: 0.75rem;\n    box-shadow: 0 2px 8px rgba(0,0,0,0.12);\n    margin-bottom: 0.5rem;\n    transition: transform 0.3s cubic-bezier(.4,2,.3,1), box-shadow 0.3s;\n    cursor: pointer;\n  }\n  .tutorial-img[_ngcontent-%COMP%]:hover {\n    transform: scale(3);\n    box-shadow: 0 12px 48px rgba(0,0,0,0.28);\n    z-index: 100;\n  }\n  .tutorial-modal-bg[_ngcontent-%COMP%] {\n    position: fixed;\n    top: 0; left: 0; right: 0; bottom: 0;\n    background: rgba(0,0,0,0.7);\n    z-index: 1000;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n  .tutorial-modal-img[_ngcontent-%COMP%] {\n    max-width: 90vw;\n    max-height: 90vh;\n    border-radius: 1rem;\n    box-shadow: 0 8px 32px rgba(0,0,0,0.32);\n    background: #fff;\n    padding: 1rem;\n  }"]})}}return u})();const $t=JSON.parse('{"_":[{"title":"Introducci\xf3n a la L\xf3gica de Programaci\xf3n","description":"Fundamentos esenciales para entender c\xf3mo funcionan los programas, comparados con recetas detalladas.","image":"assets/img/landing/m1.png","url":"/home/introduccion","color":"linear-gradient(135deg, #38bdf8 0%, #6366f1 50%, #a78bfa 100%)"},{"title":"Concepto de Variables","description":"Explicaci\xf3n sobre c\xf3mo las variables almacenan datos como n\xfameros, palabras o im\xe1genes, esenciales en programaci\xf3n.","image":"assets/img/landing/m2.png","url":"/home/concepto-variables","color":"linear-gradient(135deg, #38bdf8 0%, #6366f1 50%, #a78bfa 100%)"},{"title":"Estructuras de Control: Condicionales","description":"Uso de estructuras para tomar decisiones en programas seg\xfan condiciones espec\xedficas.","image":"assets/img/landing/m3.png","url":"/home/condicionales","color":"linear-gradient(135deg, #38bdf8 0%, #6366f1 50%, #a78bfa 100%)"},{"title":"Estructuras de Control: Bucles","description":"Repetici\xf3n eficiente de acciones en programas usando bucles \'for\' y \'while\'.","image":"assets/img/landing/m4.png","url":"/home/bucles","color":"linear-gradient(135deg, #fbbf24 0%, #f472b6 100%)"},{"title":"Funciones y Modularidad","description":"Organizaci\xf3n del c\xf3digo mediante funciones para facilitar su mantenimiento y reutilizaci\xf3n.","image":"assets/img/landing/m5.png","url":"/home/modularidad","color":"linear-gradient(135deg, #fbbf24 0%, #f472b6 100%)"},{"title":"Abstracci\xf3n y Simplificaci\xf3n","description":"M\xe9todos para dividir problemas complejos en partes m\xe1s simples y manejables.","image":"assets/img/landing/m6.png","url":"/home/abstraccion","color":"linear-gradient(135deg, #fbbf24 0%, #f472b6 100%)"},{"title":"Pensamiento L\xf3gico y Deductivo","description":"Aplicaci\xf3n de razonamiento l\xf3gico para resolver problemas usando premisas y conclusiones.","image":"assets/img/landing/m7.png","url":"/home/pensamiento-logico","color":"linear-gradient(135deg, #22c55e 0%, #06b6d4 100%)"},{"title":"Toma de Decisiones y Evaluaci\xf3n de Opciones","description":"Proceso sistem\xe1tico para evaluar diferentes opciones y tomar decisiones informadas.","image":"assets/img/landing/m8.png","url":"/home/toma-de-decisiones","color":"linear-gradient(135deg, #22c55e 0%, #06b6d4 100%)"},{"title":"Soluci\xf3n Creativa de Problemas","description":"Enfoque pr\xe1ctico y creativo para resolver desaf\xedos mediante ideas originales y efectivas.","image":"assets/img/landing/m9.png","url":"/home/solucion-creativa","color":"linear-gradient(135deg, #22c55e 0%, #06b6d4 100%)"}]}');var Rt=Ee(2593);let go=(()=>{class u{static{this.\u0275fac=function(c){return new(c||u)}}static{this.\u0275cmp=t.Xpm({type:u,selectors:[["app-footer"]],decls:3,vars:0,consts:[[1,"w-full","bg-white","py-6"],[1,"text-center","text-gray-700","text-base","font-semibold"]],template:function(c,a){1&c&&(t.TgZ(0,"footer",0)(1,"div",1),t._uU(2," Universidad Tecnol\xf3gica de Pereira \xa9 2025 "),t.qZA()())}})}}return u})();const Ve=["dynamicComponentContainer"];function ts(u,T){if(1&u){const r=t.EpF();t.TgZ(0,"div",1),t.NdJ("click",function(a){t.CHM(r);const g=t.oxw();return t.KtG(g.onBackdropClick(a))}),t.TgZ(1,"div",2),t.NdJ("click",function(a){t.CHM(r);const g=t.oxw();return t.KtG(g.onModalContentClick(a))}),t.TgZ(2,"div",3)(3,"div")(4,"h2",4),t._uU(5),t.qZA()(),t.TgZ(6,"div",5)(7,"button",6),t.NdJ("click",function(){t.CHM(r);const a=t.oxw();return t.KtG(a.closeModal())}),t.O4$(),t.TgZ(8,"svg",7),t._UZ(9,"path",8),t.qZA(),t.kcU(),t.TgZ(10,"div",9),t._uU(11," Cerrar "),t._UZ(12,"div",10),t.qZA()()()(),t.TgZ(13,"div",11)(14,"div",12),t.GkF(15,null,13),t.qZA()()()()}if(2&u){const r=t.oxw();t.xp6(1),t.Tol(r.maxWidth+" "+r.maxHeight),t.xp6(4),t.Oqu(r.title)}}let it=(()=>{class u{constructor(){this.isVisible=!1,this.title="",this.componentType=null,this.componentInputs={},this.maxWidth="max-w-4xl",this.maxHeight="max-h-[90vh]",this.onClose=new t.vpe,this.componentRef=null}ngOnChanges(r){r.isVisible&&this.isVisible&&this.componentType&&setTimeout(()=>{this.loadComponent()},0)}ngOnDestroy(){this.destroyComponent()}loadComponent(){!this.dynamicComponentContainer||!this.componentType||(this.destroyComponent(),this.componentRef=this.dynamicComponentContainer.createComponent(this.componentType),this.componentInputs&&Object.keys(this.componentInputs).forEach(r=>{this.componentRef?.instance.hasOwnProperty(r)&&(this.componentRef.instance[r]=this.componentInputs[r])}),this.componentRef.changeDetectorRef.detectChanges())}destroyComponent(){this.componentRef&&(this.componentRef.destroy(),this.componentRef=null),this.dynamicComponentContainer&&this.dynamicComponentContainer.clear()}closeModal(){this.onClose.emit()}onBackdropClick(r){this.closeModal()}onModalContentClick(r){r.stopPropagation()}static{this.\u0275fac=function(c){return new(c||u)}}static{this.\u0275cmp=t.Xpm({type:u,selectors:[["app-modal"]],viewQuery:function(c,a){if(1&c&&t.Gf(Ve,5,t.s_b),2&c){let g;t.iGM(g=t.CRH())&&(a.dynamicComponentContainer=g.first)}},inputs:{isVisible:"isVisible",title:"title",componentType:"componentType",componentInputs:"componentInputs",maxWidth:"maxWidth",maxHeight:"maxHeight"},outputs:{onClose:"onClose"},features:[t.TTD],decls:1,vars:1,consts:[["class","fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",3,"click",4,"ngIf"],[1,"fixed","inset-0","z-50","flex","items-center","justify-center","bg-black","bg-opacity-50",3,"click"],[1,"bg-white","rounded-lg","shadow-xl","w-full","mx-4","overflow-auto",3,"click"],[1,"flex","justify-between","items-center","p-6","border-b","border-gray-200","sticky","top-0","bg-white","z-10"],[1,"text-2xl","font-bold","text-gray-800"],[1,"relative"],[1,"w-10","h-10","text-white","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border-2","group",2,"background-color","#f3ae22","border-color","#d18c00",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7"],[1,"absolute","top-12","left-1/2","transform","-translate-x-1/2","bg-gray-800","text-white","text-xs","px-2","py-1","rounded","shadow-lg","opacity-0","group-hover:opacity-100","transition-opacity","duration-200","whitespace-nowrap","pointer-events-none","z-50"],[1,"absolute","bottom-full","left-1/2","transform","-translate-x-1/2","w-0","h-0","border-l-2","border-r-2","border-b-4","border-transparent","border-b-gray-800"],[1,"p-6"],[1,"min-h-[400px]"],["dynamicComponentContainer",""]],template:function(c,a){1&c&&t.YNc(0,ts,17,3,"div",0),2&c&&t.Q6J("ngIf",a.isVisible)},dependencies:[V.O5],styles:[".modal-overlay[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px)}.modal-content[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_modalSlideIn .3s ease-out}@keyframes _ngcontent-%COMP%_modalSlideIn{0%{opacity:0;transform:translateY(-20px) scale(.95)}to{opacity:1;transform:translateY(0) scale(1)}}"]})}}return u})(),qe=(()=>{class u{constructor(r,c,a){this.router=r,this.navigationService=c,this.modalService=a,this.cards=[],this.showModal=!1,this.modalComponentType=Bo,this.modalTitle="M\xf3dulos disponibles",this.tutorialComponent=Po}redirigir(r){this.navigationService.navigateTo(r)}ngOnInit(){this.loadData(),this.modalSubscription=this.modalService.onOpenModal().subscribe(()=>{this.openCardsModal()})}ngOnDestroy(){this.modalSubscription&&this.modalSubscription.unsubscribe()}loadData(){this.cards=$t._}openCardsModal(){this.modalComponentType=Bo,this.modalTitle="M\xf3dulos disponibles",this.showModal=!0}openTutorialModal(){this.modalComponentType=Po,this.modalTitle="Tutorial de uso del aplicativo",this.showModal=!0}closeCardsModal(){this.showModal=!1}scrollToModulos(){const r=document.getElementById("modulos");r&&(r.scrollIntoView({behavior:"smooth"}),r.classList.add("animate-glow"),setTimeout(()=>{r.classList.remove("animate-glow")},1200))}static{this.\u0275fac=function(c){return new(c||u)(t.Y36(Je.F0),t.Y36(D),t.Y36(Rt.Z))}}static{this.\u0275cmp=t.Xpm({type:u,selectors:[["app-start-page"]],decls:33,vars:6,consts:[[1,"min-h-screen","w-full","bg-gradient-to-br","from-cyan-100","via-white","to-blue-100","relative","overflow-hidden","flex","flex-col"],[1,"absolute","inset-0","w-full","h-full","z-0"],["src","assets/img/landing/logica_de_programacion.jpeg","alt","L\xf3gica de Programaci\xf3n",1,"w-full","h-full","object-cover"],[1,"flex","flex-col","justify-center","items-start","p-8","z-10","w-full","md:w-2/3","relative",2,"margin-left","4rem","min-height","100vh","justify-content","center"],[2,"border-radius","2rem","width","87%","max-width","none","max-height","480px","background","rgba(255,255,255,0.18)","backdrop-filter","blur(16px)","box-shadow","0 8px 32px 0 rgba(31,38,135,0.37)","border","1px solid rgba(255,255,255,0.18)","padding","2.5rem 2rem","display","flex","flex-direction","column","align-items","flex-start","justify-content","center","margin-left","-2rem"],[2,"margin-left","2rem","margin-right","2rem"],[1,"w-32","h-32","rounded-full","shadow-xl","mb-6","flex","items-center","justify-center","bg-white/30","animate-bounce"],["src","assets/img/landing/utp.png","alt","utp",1,"w-28","h-28","object-contain"],[1,"text-4xl","md:text-5xl","font-extrabold","text-white","drop-shadow-lg","mb-4","leading-tight"],[1,"text-xl","md:text-2xl","text-white","drop-shadow-lg","mb-4","font-semibold"],[1,"text-base","text-white","drop-shadow-lg","mb-6","w-full","text-justify"],[1,"flex","items-center","gap-4"],[1,"bg-cyan-600","hover:bg-cyan-700","text-white","font-bold","py-2","px-6","rounded-full","shadow","transition-all","duration-300",3,"click"],[1,"flex","flex-col","items-start"],[1,"text-cyan-700","hover:text-white","hover:underline","font-semibold","text-base","cursor-pointer",3,"click"],[1,"w-full","overflow-hidden","relative","z-10",2,"margin-bottom","-1px"],["viewBox","0 0 1920 120","preserveAspectRatio","none","xmlns","http://www.w3.org/2000/svg",1,"block","w-full","h-32"],["id","blueToWhite","x1","0","y1","0","x2","0","y2","1"],["offset","0%","stop-color","#fff"],["offset","100%","stop-color","#fff"],["d","M0,40 C480,120 1440,0 1920,80 L1920,120 L0,120 Z","fill","url(#blueToWhite)"],["id","modulos",1,"w-full","flex","flex-col","items-center","py-8","bg-white"],[1,"text-2xl","font-bold","mb-6","text-cyan-700"],[3,"cards"],[3,"isVisible","title","componentType","maxWidth","maxHeight","onClose"]],template:function(c,a){1&c&&(t.TgZ(0,"section",0)(1,"div",1),t._UZ(2,"img",2),t.qZA(),t.TgZ(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6),t._UZ(7,"img",7),t.qZA(),t.TgZ(8,"h1",8),t._uU(9,"Pensamiento b\xe1sico de Programador"),t.qZA(),t.TgZ(10,"p",9),t._uU(11,"Explorando la L\xf3gica de la Programaci\xf3n"),t.qZA(),t.TgZ(12,"p",10),t._uU(13,"Aprende l\xf3gica de programaci\xf3n de forma visual, interactiva y divertida. Descubre los m\xf3dulos y comienza tu viaje en el pensamiento computacional."),t.qZA(),t.TgZ(14,"div",11)(15,"button",12),t.NdJ("click",function(){return a.scrollToModulos()}),t._uU(16,"Comenzar ahora"),t.qZA(),t.TgZ(17,"div",13)(18,"a",14),t.NdJ("click",function(){return a.openTutorialModal()}),t._uU(19,"\xbfC\xf3mo usar el aplicativo?"),t.qZA()()()()()(),t.TgZ(20,"div",15),t.O4$(),t.TgZ(21,"svg",16)(22,"defs")(23,"linearGradient",17),t._UZ(24,"stop",18)(25,"stop",19),t.qZA()(),t._UZ(26,"path",20),t.qZA()()(),t.kcU(),t.TgZ(27,"section",21)(28,"h2",22),t._uU(29,"M\xf3dulos disponibles"),t.qZA(),t._UZ(30,"app-cards",23),t.qZA(),t.TgZ(31,"app-modal",24),t.NdJ("onClose",function(){return a.closeCardsModal()}),t.qZA(),t._UZ(32,"app-footer")),2&c&&(t.xp6(30),t.Q6J("cards",a.cards),t.xp6(1),t.Q6J("isVisible",a.showModal)("title",a.modalTitle)("componentType",a.modalComponentType)("maxWidth",a.modalComponentType===a.tutorialComponent?"max-w-5xl":"max-w-3xl")("maxHeight","max-h-[90vh]"))},dependencies:[go,it,Bo],styles:[".animate-glow[_ngcontent-%COMP%]{box-shadow:0 0 40px 10px #06b6d480,0 0 80px 20px #3b82f64d;transform:scale(1.03);transition:box-shadow .7s,transform .7s}"]})}}return u})();var fe=Ee(9862);function mo(u,T){if(1&u){const r=t.EpF();t.ynx(0),t.TgZ(1,"div",6)(2,"span",7),t._uU(3,"\u{1f575}\ufe0f"),t.qZA(),t.TgZ(4,"span",8),t._uU(5,"El Detective de Premisas"),t.qZA()(),t.TgZ(6,"div",9),t._UZ(7,"div",10),t.TgZ(8,"div",11),t._UZ(9,"span",12),t.TgZ(10,"span"),t._uU(11,"Es un juego investigativo donde tu l\xf3gica y capacidad de deducci\xf3n son la clave para resolver misterios. Cada caso te reta a analizar pistas, tomar decisiones y descubrir la verdad usando premisas l\xf3gicas."),t.qZA(),t.TgZ(12,"div",13)(13,"div",14)(14,"span",15),t._uU(15,"Secci\xf3n de pistas"),t.qZA(),t.TgZ(16,"span",16),t._uU(17,"Desbloquea y consulta pistas relevantes para avanzar en la investigaci\xf3n."),t.qZA()(),t.TgZ(18,"div",17)(19,"span",18),t._uU(20,"Historial de decisiones"),t.qZA(),t.TgZ(21,"span",16),t._uU(22,"Revisa las elecciones que has tomado y su impacto en el caso."),t.qZA()(),t.TgZ(23,"div",19)(24,"span",20),t._uU(25,"Caso investigativo e interrogativo"),t.qZA(),t.TgZ(26,"span",16),t._uU(27,"Resuelve el misterio respondiendo preguntas y conectando premisas."),t.qZA()()(),t.TgZ(28,"div",21)(29,"button",22),t.NdJ("click",function(){t.CHM(r);const a=t.oxw();return t.KtG(a.abrirPrimerCaso())}),t._uU(30," \xbfListo para convertirte en el mejor detective l\xf3gico? "),t.qZA()()()(),t.BQk()}}function ai(u,T){if(1&u){const r=t.EpF();t.TgZ(0,"div",26),t._UZ(1,"div",27),t.TgZ(2,"div",28)(3,"h3",29)(4,"span",30),t.O4$(),t.TgZ(5,"svg",31),t._UZ(6,"circle",32)(7,"line",33),t.qZA()(),t.kcU(),t.TgZ(8,"span"),t._uU(9),t.qZA()(),t.TgZ(10,"div",34),t._UZ(11,"div",10),t.TgZ(12,"p",35),t._uU(13),t.ALo(14,"slice"),t.qZA()(),t._UZ(15,"div",36),t.TgZ(16,"button",37),t.NdJ("click",function(){const g=t.CHM(r).$implicit,f=t.oxw(2);return t.KtG(f.seleccionarCaso(g))}),t._uU(17," Resolver el misterio "),t.qZA()()()}if(2&u){const r=T.$implicit;t.xp6(9),t.Oqu(r.titulo),t.xp6(4),t.AsE(" ",t.Dn7(14,3,null!=r.introduccion&&r.introduccion.objetivo&&(null==r.introduccion?null:r.introduccion.objetivo.length)>10?(null==r.introduccion?null:r.introduccion.objetivo)+" "+((null==r.introduccion?null:r.introduccion.narrativa)||""):(null==r.introduccion?null:r.introduccion.narrativa)||"Resuelve el misterio.",0,220)," ",(null!=r.introduccion&&r.introduccion.objetivo&&(null==r.introduccion?null:r.introduccion.objetivo.length)>10?(null==r.introduccion?null:r.introduccion.objetivo)+" "+((null==r.introduccion?null:r.introduccion.narrativa)||""):(null==r.introduccion?null:r.introduccion.narrativa)||"Resuelve el misterio.").length>220?"...":""," ")}}function U(u,T){if(1&u&&(t.TgZ(0,"div",23)(1,"div",24),t.YNc(2,ai,18,7,"div",25),t.qZA()()),2&u){const r=t.oxw();t.xp6(2),t.Q6J("ngForOf",1===r.tipo?null==r.data?null:r.data.ejemplos:null==r.data?null:r.data.ejercicios)}}function lt(u,T){if(1&u&&(t.TgZ(0,"li",61)(1,"strong"),t._uU(2),t.qZA(),t._uU(3),t.qZA()),2&u){const r=T.$implicit;t.xp6(2),t.hij("Etapa ",r.etapa,":"),t.xp6(1),t.lnq(" ",r.opcion," - ",r.resultado," (Puntaje: ",r.puntaje,") ")}}function ne(u,T){if(1&u&&(t.O4$(),t.kcU(),t.TgZ(0,"div",57)(1,"h3",58),t._uU(2,"Historial de Decisiones"),t.qZA(),t.TgZ(3,"ul",59),t.YNc(4,lt,4,4,"li",60),t.qZA()()),2&u){const r=t.oxw(2);t.xp6(4),t.Q6J("ngForOf",r.historial)}}function Fo(u,T){if(1&u){const r=t.EpF();t.TgZ(0,"button",62),t.NdJ("click",function(){t.CHM(r);const a=t.oxw(2);return t.KtG(a.avanzarEtapa())}),t._uU(1," Comenzar "),t.qZA()}}function _t(u,T){if(1&u&&(t.TgZ(0,"div",65)(1,"div",66),t._uU(2),t.qZA(),t.TgZ(3,"div",67),t._uU(4),t.qZA()()),2&u){const r=T.$implicit,c=T.index;t.xp6(2),t.hij(" ",c+1,""),t.xp6(2),t.Oqu(r)}}function $o(u,T){if(1&u&&(t.TgZ(0,"div",63),t.YNc(1,_t,5,2,"div",64),t.qZA()),2&u){const r=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",r.etapaActual.pasosGuiados)}}function Uo(u,T){if(1&u&&(t.TgZ(0,"div",70),t._uU(1),t.qZA()),2&u){const r=T.$implicit;t.xp6(1),t.hij(" ",r," ")}}function ct(u,T){if(1&u&&(t.TgZ(0,"div",68),t.YNc(1,Uo,2,1,"div",69),t.qZA()),2&u){const r=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",r.etapaActual.pasosGuiados)}}function Ne(u,T){if(1&u&&(t.TgZ(0,"div",71),t._uU(1),t.qZA()),2&u){const r=t.oxw(2);t.xp6(1),t.hij(" ",r.etapaActual.explicacion," ")}}function _o(u,T){if(1&u&&(t.TgZ(0,"span",77),t._uU(1),t.qZA()),2&u){const r=t.oxw().index;t.xp6(1),t.Oqu(r+1)}}const ui=function(u,T){return{"bg-green-500 text-white":u,"bg-gray-400 text-white cursor-not-allowed":T}};function zt(u,T){if(1&u){const r=t.EpF();t.TgZ(0,"button",74),t.NdJ("click",function(){const a=t.CHM(r),g=a.$implicit,f=a.index,S=t.oxw(3);return t.KtG(S.seleccionarOpcion(g,f))}),t.YNc(1,_o,2,1,"span",75),t.TgZ(2,"span",76),t._uU(3),t.qZA()()}if(2&u){const r=T.$implicit,c=T.index,a=t.oxw(3);t.Q6J("ngClass",t.WLB(4,ui,(1===a.tipo&&r.esCorrecta||2===a.tipo&&r.esRamaCorrecta)&&a.seleccionadas[c],a.seleccionadas[c]&&!(1===a.tipo&&r.esCorrecta||2===a.tipo&&r.esRamaCorrecta)))("disabled",a.seleccionadas[c]),t.xp6(1),t.Q6J("ngIf",a.opcionesMezcladas.length>1),t.xp6(2),t.Oqu(r.texto)}}function os(u,T){if(1&u&&(t.ynx(0),t.TgZ(1,"div",72),t.YNc(2,zt,4,7,"button",73),t.qZA(),t.BQk()),2&u){const r=t.oxw(2);t.xp6(2),t.Q6J("ngForOf",r.opcionesMezcladas)}}function jt(u,T){if(1&u&&(t.TgZ(0,"div",78),t._uU(1),t.qZA()),2&u){const r=t.oxw(2);t.xp6(1),t.hij(" ",r.feedback," ")}}function is(u,T){if(1&u){const r=t.EpF();t.TgZ(0,"button",79),t.NdJ("click",function(){t.CHM(r);const a=t.oxw(2);return t.KtG(a.avanzarEtapa())}),t._uU(1," Siguiente "),t.qZA()}}function hn(u,T){if(1&u&&(t.TgZ(0,"div",81)(1,"strong"),t._uU(2),t.qZA(),t._uU(3),t.qZA()),2&u){const r=T.$implicit;t.xp6(2),t.Oqu(r.titulo),t.xp6(1),t.hij(": ",r.contenido," ")}}function pn(u,T){if(1&u&&(t.TgZ(0,"div",57)(1,"h3",58),t._uU(2,"Pistas Desbloqueadas"),t.qZA(),t.YNc(3,hn,4,2,"div",80),t.qZA()),2&u){const r=t.oxw(2);t.xp6(3),t.Q6J("ngForOf",r.pistasDesbloqueadas)}}function gn(u,T){if(1&u){const r=t.EpF();t.TgZ(0,"div",38)(1,"div",39)(2,"button",40),t.NdJ("click",function(){t.CHM(r);const a=t.oxw();return t.KtG(a.casoSeleccionado=null)}),t.O4$(),t.TgZ(3,"svg",41),t._UZ(4,"path",42),t.qZA(),t._uU(5," Selecci\xf3n de casos "),t.qZA()(),t.YNc(6,ne,5,1,"div",43),t.kcU(),t.TgZ(7,"div",44)(8,"h3",45),t._uU(9),t.qZA(),t.TgZ(10,"div",46),t._UZ(11,"div",10),t.TgZ(12,"p",47),t._uU(13),t.qZA()(),t.YNc(14,Fo,2,0,"button",48),t.YNc(15,$o,2,1,"div",49),t.YNc(16,ct,2,1,"div",50),t.YNc(17,Ne,2,1,"div",51),t.YNc(18,os,3,1,"ng-container",1),t.YNc(19,jt,2,1,"div",52),t.YNc(20,is,2,0,"button",53),t.qZA(),t.YNc(21,pn,4,1,"div",43),t.TgZ(22,"div",54)(23,"span",55),t._uU(24,"Puntaje:"),t.qZA(),t.TgZ(25,"span",56),t._uU(26),t.qZA()()()}if(2&u){const r=t.oxw();t.xp6(6),t.Q6J("ngIf",r.historial.length>0),t.xp6(3),t.Oqu(r.etapaActual.tituloCard),t.xp6(4),t.hij(" ",r.etapaActual.descripcion||r.etapaActual.narrativa," "),t.xp6(1),t.Q6J("ngIf",r.enIntroduccion),t.xp6(1),t.Q6J("ngIf",r.etapaActual.pasosGuiados&&1===r.tipo),t.xp6(1),t.Q6J("ngIf",r.etapaActual.pasosGuiados&&1!==r.tipo),t.xp6(1),t.Q6J("ngIf",r.etapaActual.explicacion),t.xp6(1),t.Q6J("ngIf",!r.enIntroduccion&&r.etapaActual.opciones),t.xp6(1),t.Q6J("ngIf",r.mostrarFeedback),t.xp6(1),t.Q6J("ngIf",r.mostrarSiguiente&&!r.enIntroduccion),t.xp6(1),t.Q6J("ngIf",r.pistasDesbloqueadas.length>0),t.xp6(5),t.Oqu(r.puntaje)}}function di(u,T){if(1&u){const r=t.EpF();t.TgZ(0,"div",82)(1,"div",83)(2,"div",84),t.O4$(),t.TgZ(3,"svg",85),t._UZ(4,"path",86),t.qZA()(),t.kcU(),t.TgZ(5,"h3",87),t._uU(6),t.qZA(),t.TgZ(7,"p",88),t._uU(8),t.qZA(),t.TgZ(9,"p",89),t._uU(10,"Puntaje Final: "),t.TgZ(11,"span",90),t._uU(12),t.qZA()(),t.TgZ(13,"button",91),t.NdJ("click",function(){t.CHM(r);const a=t.oxw();return t.KtG(a.cerrarModal())}),t._uU(14," Volver al Inicio "),t.qZA()()()}if(2&u){const r=t.oxw();t.xp6(6),t.Oqu(r.etapaActual.tituloCard),t.xp6(2),t.Oqu(r.etapaActual.descripcion),t.xp6(4),t.Oqu(r.puntaje)}}let ss=(()=>{class u{constructor(r){this.http=r,this.opcionesMezcladas=[],this.tipo=1,this.data=null,this.casoSeleccionado=null,this.etapaActual=null,this.enIntroduccion=!0,this.seleccion=null,this.seleccionadas=[],this.seleccionHecha=!1,this.mostrarSiguiente=!1,this.feedback="",this.mostrarFeedback=!1,this.puntaje=0,this.pistasDesbloqueadas=[],this.historial=[],this.progreso={completados:[],puntaje:0},this.mostrarModalFinal=!1}ngOnInit(){this.loadProgreso(),this.loadData()}loadData(){this.http.get("assets/jsons-base/detectives-game.json").subscribe({next:r=>{this.data=r,this.casoSeleccionado=null,this.etapaActual=null,this.enIntroduccion=!0},error:r=>console.error("Error al cargar el JSON:",r)})}loadProgreso(){const r=localStorage.getItem("progreso");r&&(this.progreso=JSON.parse(r))}saveProgreso(){localStorage.setItem("progreso",JSON.stringify(this.progreso))}seleccionarCaso(r){this.casoSeleccionado=r,this.etapaActual=r.introduccion,this.enIntroduccion=!0,this.resetEstado(),this.seleccionadas=[],this.actualizarOpcionesMezcladas()}mezclarArray(r){const c=r.slice();for(let a=c.length-1;a>0;a--){const g=Math.floor(Math.random()*(a+1));[c[a],c[g]]=[c[g],c[a]]}return c}actualizarOpcionesMezcladas(){this.opcionesMezcladas=this.etapaActual&&this.etapaActual.opciones?this.mezclarArray(this.etapaActual.opciones):[]}seleccionarOpcion(r,c){if(!this.seleccionadas.length&&this.etapaActual.opciones&&(this.seleccionadas=this.etapaActual.opciones.map(()=>!1)),this.seleccion=c,this.feedback=r.resultado,this.mostrarFeedback=!0,this.puntaje+=r.puntaje||0,this.historial.push({etapa:this.etapaActual.id,opcion:r.texto,resultado:r.resultado,puntaje:r.puntaje}),this.etapaActual.pistasDesbloqueadas&&this.pistasDesbloqueadas.push(...this.etapaActual.pistasDesbloqueadas),this.seleccionadas[c]=!0,1===this.tipo){const g=this.etapaActual.opciones.filter(f=>f.esCorrecta).every(f=>{const S=this.etapaActual.opciones.indexOf(f);return this.seleccionadas[S]});this.mostrarSiguiente=g,this.seleccionHecha=!1}else if(2===this.tipo){const g=this.etapaActual.opciones.filter(f=>f.esRamaCorrecta).every(f=>{const S=this.etapaActual.opciones.indexOf(f);return this.seleccionadas[S]});this.mostrarSiguiente=g,this.seleccionHecha=!1}}submitOpcion(){null!==this.seleccion&&this.seleccionarOpcion(this.etapaActual.opciones[this.seleccion],this.seleccion)}avanzarEtapa(){if(this.enIntroduccion&&this.casoSeleccionado&&this.casoSeleccionado.etapas.length>0)return this.etapaActual=this.casoSeleccionado.etapas[0],this.enIntroduccion=!1,this.resetEstado(),void this.actualizarOpcionesMezcladas();if(!this.etapaActual.opciones)return;this.actualizarOpcionesMezcladas();const c=(this.etapaActual.opciones.find(a=>1===this.tipo&&a.esCorrecta||2===this.tipo&&a.esRamaCorrecta)||this.etapaActual.opciones[0]).avanzaA;"final"===c?(this.etapaActual={id:"final",tipo:"final",tituloCard:"Caso Resuelto",descripcion:this.casoSeleccionado.finalExplicacion||this.casoSeleccionado.finalFeedback},this.progreso.completados.push(this.casoSeleccionado.id),this.progreso.puntaje+=this.puntaje,this.saveProgreso(),this.mostrarModalFinal=!0):(this.etapaActual=this.casoSeleccionado.etapas.find(a=>a.id===c),this.resetEstado(),this.actualizarOpcionesMezcladas())}resetEstado(){this.seleccion=null,this.seleccionadas=[],this.seleccionHecha=!1,this.mostrarSiguiente=!1,this.mostrarFeedback=!1,this.feedback="",(!this.etapaActual||!this.etapaActual.opciones)&&(this.opcionesMezcladas=[])}cerrarModal(){this.mostrarModalFinal=!1,this.seleccionarCaso(1===this.tipo?this.data.ejemplos[0]:this.data.ejercicios[0]),this.puntaje=0,this.pistasDesbloqueadas=[],this.historial=[]}abrirPrimerCaso(){1===this.tipo&&this.data?.ejemplos?.length>0?this.seleccionarCaso(this.data.ejemplos[0]):2===this.tipo&&this.data?.ejercicios?.length>0&&this.seleccionarCaso(this.data.ejercicios[0])}static{this.\u0275fac=function(c){return new(c||u)(t.Y36(fe.eN))}}static{this.\u0275cmp=t.Xpm({type:u,selectors:[["app-detective-generic"]],inputs:{tipo:"tipo"},decls:6,vars:4,consts:[[1,"container","mx-auto","p-4","w-full"],[4,"ngIf"],[1,"flex","flex-col","md:flex-row","gap-4","mt-6"],["class","w-full max-w-7xl mx-auto",4,"ngIf"],["class","flex flex-row gap-4 w-full justify-center",4,"ngIf"],["class","fixed inset-0 z-50 bg-black bg-opacity-60 flex items-center justify-center animate-fade-in",4,"ngIf"],[1,"w-full","flex","items-center","justify-start","mb-2"],[1,"text-3xl","mr-2"],[1,"font-bold","text-blue-700","text-xl","tracking-tight"],[1,"bg-gradient-to-br","from-blue-50","via-purple-50","to-white","border-l-4","border-l-transparent","shadow","rounded-xl","px-4","py-4","w-full","mb-4","overflow-auto","relative"],[1,"absolute","left-0","top-0","h-full","w-1.5","rounded-l-xl","bg-gradient-to-b","from-green-400","to-blue-400"],[1,"text-gray-700","text-base","font-medium",2,"text-align","justify","white-space","pre-line"],[1,"block","mb-2"],[1,"mt-4","grid","grid-cols-1","md:grid-cols-3","gap-4"],[1,"flex","flex-col","items-start","p-3","rounded-xl","bg-green-50","shadow","border-l-4","border-green-300"],[1,"font-semibold","text-green-700","mb-1"],[1,"text-gray-700","text-sm"],[1,"flex","flex-col","items-start","p-3","rounded-xl","bg-blue-50","shadow","border-l-4","border-blue-300"],[1,"font-semibold","text-blue-700","mb-1"],[1,"flex","flex-col","items-start","p-3","rounded-xl","bg-purple-50","shadow","border-l-4","border-purple-300"],[1,"font-semibold","text-purple-700","mb-1"],[1,"mt-10","mb-10","flex","justify-center"],[1,"px-6","py-3","rounded-lg","font-semibold","transition","duration-300","bg-gradient-to-r","from-blue-500","to-green-400","text-white","shadow-md","border-none","outline-none","focus:ring-2","focus:ring-blue-400","hover:from-green-400","hover:to-blue-500","hover:bg-gradient-to-r","hover:text-white","text-lg",3,"click"],[1,"w-full","max-w-7xl","mx-auto"],[1,"grid","grid-cols-1","sm:grid-cols-2","md:grid-cols-3","gap-12"],["class","aspect-square min-h-[320px] min-w-[320px] max-w-md w-full rounded-2xl bg-white shadow-xl border border-gray-100 p-0 flex flex-col items-stretch transition-transform hover:scale-105 mx-auto overflow-hidden",4,"ngFor","ngForOf"],[1,"aspect-square","min-h-[320px]","min-w-[320px]","max-w-md","w-full","rounded-2xl","bg-white","shadow-xl","border","border-gray-100","p-0","flex","flex-col","items-stretch","transition-transform","hover:scale-105","mx-auto","overflow-hidden"],[1,"h-3","bg-gradient-to-r","from-green-400","to-blue-400","w-full"],[1,"flex","flex-col","items-center","justify-center","flex-1","px-6","py-4"],[1,"text-xl","font-bold","text-gray-800","mb-2","text-left","flex","items-center","gap-2","mt-4","w-full"],[1,"inline-flex","items-center","justify-center","w-10","h-10","rounded-full","bg-green-100","shadow"],["fill","none","stroke","currentColor","stroke-width","2","viewBox","0 0 24 24",1,"w-7","h-7","text-green-500"],["cx","11","cy","11","r","7"],["x1","21","y1","21","x2","16.65","y2","16.65"],[1,"bg-gradient-to-br","from-blue-50","via-purple-50","to-white","border-l-4","border-l-transparent","shadow","rounded-xl","px-2","py-3","w-full","mb-2","overflow-auto","relative"],[1,"text-gray-700","text-sm",2,"text-align","justify","white-space","pre-line"],[1,"flex-grow"],[1,"mb-2","px-6","py-3","rounded-lg","font-semibold","transition","duration-300","bg-gradient-to-r","from-blue-500","to-green-400","text-white","shadow-md","border-none","outline-none","focus:ring-2","focus:ring-blue-400","hover:from-green-400","hover:to-blue-500","hover:bg-gradient-to-r","hover:text-white",3,"click"],[1,"flex","flex-row","gap-4","w-full","justify-center"],[1,"fixed","bottom-6","left-6","z-50"],[1,"px-6","py-3","rounded-xl","font-bold","bg-gradient-to-r","from-blue-500","to-green-400","text-white","shadow-lg","border-none","outline-none","focus:ring-2","focus:ring-blue-400","hover:from-green-400","hover:to-blue-500","transition","duration-300","flex","items-center","gap-2",3,"click"],["fill","none","stroke","currentColor","stroke-width","2","viewBox","0 0 24 24",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","d","M15 19l-7-7 7-7"],["class","bg-white shadow-lg rounded-lg p-4 mb-4 w-[25%] min-w-[180px] h-[410px] overflow-y-auto",4,"ngIf"],[1,"bg-white","shadow-lg","rounded-lg","p-6","mb-4","animate-fade-in","w-[50%]","min-w-[260px]"],[1,"text-xl","font-semibold","mb-2"],[1,"bg-gradient-to-br","from-blue-50","via-purple-50","to-white","border-l-4","border-l-transparent","shadow","rounded-xl","px-2","py-3","w-full","mb-4","overflow-auto","relative"],[1,"text-gray-700","text-sm","pl-3",2,"text-align","justify","white-space","pre-line"],["class","px-4 py-2 rounded-lg font-semibold transition duration-300 bg-gradient-to-r from-blue-500 to-green-400 text-white shadow-md border-none outline-none focus:ring-2 focus:ring-blue-400 hover:from-green-400 hover:to-blue-500 hover:bg-gradient-to-r hover:text-white",3,"click",4,"ngIf"],["class","grid grid-cols-1 md:grid-cols-2 gap-3 mb-4",4,"ngIf"],["class","space-y-2 mb-4",4,"ngIf"],["class","p-3 bg-green-100 text-green-800 rounded-lg mb-4",4,"ngIf"],["class","mt-4 p-3 bg-blue-100 text-blue-800 rounded-lg animate-fade-in",4,"ngIf"],["class","mt-4 px-4 py-2 rounded-lg font-semibold transition duration-300 bg-gradient-to-r from-blue-500 to-green-400 text-white shadow-md border-none outline-none focus:ring-2 focus:ring-blue-400 hover:from-green-400 hover:to-blue-500 hover:bg-gradient-to-r hover:text-white",3,"click",4,"ngIf"],[1,"fixed","bottom-0","right-0","z-50","mb-4","mr-4","bg-gradient-to-r","from-blue-500","to-green-400","text-white","shadow-xl","rounded-xl","px-4","py-2","flex","items-center","border-2","border-white/20","backdrop-blur-md"],[1,"text-base","font-semibold","drop-shadow"],[1,"ml-2","text-lg","font-bold","drop-shadow"],[1,"bg-white","shadow-lg","rounded-lg","p-4","mb-4","w-[25%]","min-w-[180px]","h-[410px]","overflow-y-auto"],[1,"text-base","font-semibold","mb-2"],[1,"space-y-1"],["class","p-2 bg-gray-50 border-l-4 border-blue-500 text-sm",4,"ngFor","ngForOf"],[1,"p-2","bg-gray-50","border-l-4","border-blue-500","text-sm"],[1,"px-4","py-2","rounded-lg","font-semibold","transition","duration-300","bg-gradient-to-r","from-blue-500","to-green-400","text-white","shadow-md","border-none","outline-none","focus:ring-2","focus:ring-blue-400","hover:from-green-400","hover:to-blue-500","hover:bg-gradient-to-r","hover:text-white",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-3","mb-4"],["class","flex items-start gap-3 rounded-xl bg-gradient-to-r from-green-50 via-blue-50 to-white shadow p-3 border-l-4 border-green-300 min-h-[60px]",4,"ngFor","ngForOf"],[1,"flex","items-start","gap-3","rounded-xl","bg-gradient-to-r","from-green-50","via-blue-50","to-white","shadow","p-3","border-l-4","border-green-300","min-h-[60px]"],[1,"flex","items-center","justify-center","w-7","h-7","rounded-full","bg-green-200","text-green-700","font-bold","text-base","shadow-inner"],[1,"flex-1","text-gray-700","text-sm","leading-tight"],[1,"space-y-2","mb-4"],["class","p-3 bg-gray-50 border-l-4 border-blue-500",4,"ngFor","ngForOf"],[1,"p-3","bg-gray-50","border-l-4","border-blue-500"],[1,"p-3","bg-green-100","text-green-800","rounded-lg","mb-4"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4","mt-2"],["class","w-full px-5 py-4 rounded-xl shadow border border-gray-200 transition duration-300 text-base font-semibold text-left flex items-center gap-3 focus:outline-none focus:ring-2 focus:ring-blue-400 bg-blue-500 text-white hover:bg-gradient-to-r hover:from-blue-500 hover:to-green-400",3,"ngClass","disabled","click",4,"ngFor","ngForOf"],[1,"w-full","px-5","py-4","rounded-xl","shadow","border","border-gray-200","transition","duration-300","text-base","font-semibold","text-left","flex","items-center","gap-3","focus:outline-none","focus:ring-2","focus:ring-blue-400","bg-blue-500","text-white","hover:bg-gradient-to-r","hover:from-blue-500","hover:to-green-400",3,"ngClass","disabled","click"],["class","flex-shrink-0 w-8 h-8 rounded-full bg-blue-100 text-blue-500 flex items-center justify-center font-bold text-lg",4,"ngIf"],[1,"flex-1"],[1,"flex-shrink-0","w-8","h-8","rounded-full","bg-blue-100","text-blue-500","flex","items-center","justify-center","font-bold","text-lg"],[1,"mt-4","p-3","bg-blue-100","text-blue-800","rounded-lg","animate-fade-in"],[1,"mt-4","px-4","py-2","rounded-lg","font-semibold","transition","duration-300","bg-gradient-to-r","from-blue-500","to-green-400","text-white","shadow-md","border-none","outline-none","focus:ring-2","focus:ring-blue-400","hover:from-green-400","hover:to-blue-500","hover:bg-gradient-to-r","hover:text-white",3,"click"],["class","p-2 bg-gray-50 border-l-4 border-blue-500 mb-1 text-sm",4,"ngFor","ngForOf"],[1,"p-2","bg-gray-50","border-l-4","border-blue-500","mb-1","text-sm"],[1,"fixed","inset-0","z-50","bg-black","bg-opacity-60","flex","items-center","justify-center","animate-fade-in"],[1,"bg-white","rounded-2xl","shadow-2xl","p-8","max-w-md","w-full","border-4","border-blue-200","relative","flex","flex-col","items-center"],[1,"absolute","-top-8","left-1/2","-translate-x-1/2","flex","items-center","justify-center","w-16","h-16","bg-gradient-to-br","from-blue-500","via-cyan-400","to-green-400","rounded-full","shadow-lg","border-4","border-white"],["fill","none","stroke","currentColor","stroke-width","2","viewBox","0 0 24 24",1,"w-8","h-8","text-white"],["stroke-linecap","round","stroke-linejoin","round","d","M12 4v16m8-8H4"],[1,"text-2xl","font-bold","mb-2","mt-8","text-blue-700","text-center","drop-shadow"],[1,"text-gray-700","mb-4","text-center"],[1,"text-lg","font-semibold","text-green-600","mb-6","text-center"],[1,"font-bold"],[1,"px-6","py-2","rounded-lg","font-semibold","transition","duration-300","bg-gradient-to-r","from-blue-500","to-green-400","text-white","shadow-md","border-none","outline-none","focus:ring-2","focus:ring-blue-400","hover:from-green-400","hover:to-blue-500","hover:bg-gradient-to-r","hover:text-white",3,"click"]],template:function(c,a){1&c&&(t.TgZ(0,"div",0),t.YNc(1,mo,31,0,"ng-container",1),t.TgZ(2,"div",2),t.YNc(3,U,3,1,"div",3),t.YNc(4,gn,27,12,"div",4),t.qZA(),t.YNc(5,di,15,3,"div",5),t.qZA()),2&c&&(t.xp6(1),t.Q6J("ngIf",!a.casoSeleccionado),t.xp6(2),t.Q6J("ngIf",!a.casoSeleccionado),t.xp6(1),t.Q6J("ngIf",a.casoSeleccionado),t.xp6(1),t.Q6J("ngIf",a.mostrarModalFinal))},dependencies:[V.mk,V.sg,V.O5,V.OU],styles:["@keyframes _ngcontent-%COMP%_fade-in{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.animate-fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fade-in .5s ease-out}"]})}}return u})();function hi(u,T){1&u&&(t.TgZ(0,"section",12)(1,"div",13)(2,"h2",14),t._uU(3,"\u{1f4cd} "),t.TgZ(4,"b"),t._uU(5,"\xbfQu\xe9 es la soluci\xf3n creativa de problemas?"),t.qZA()(),t.TgZ(6,"p",15),t._uU(7," La soluci\xf3n creativa de problemas es la capacidad de encontrar caminos innovadores para resolver desaf\xedos, combinando pensamiento l\xf3gico con imaginaci\xf3n."),t._UZ(8,"br"),t._uU(9," No se trata \xfanicamente de \u201cpensar diferente\u201d por el simple hecho de ser original, sino de encontrar soluciones que sean originales y, al mismo tiempo, efectivas."),t.qZA(),t.TgZ(10,"p",15),t._uU(11,"En programaci\xf3n, muchas veces un problema puede resolverse con t\xe9cnicas ya conocidas, pero cuando estas no funcionan o no son \xf3ptimas, entra en juego la creatividad para encontrar un enfoque alternativo."),t.qZA(),t.TgZ(12,"div",16)(13,"h3",17),t._uU(14,"\u{1f4e6} Met\xe1fora: El chef improvisador"),t.qZA(),t.TgZ(15,"p",18),t._uU(16,"Imagina que eres un chef y est\xe1s cocinando un plato especial para un cliente."),t._UZ(17,"br"),t._uU(18," De repente, te das cuenta de que falta un ingrediente clave."),t.qZA(),t.TgZ(19,"ul",19)(20,"li"),t._uU(21,"Opci\xf3n tradicional: cancelar el plato o retrasar el pedido para ir a comprarlo."),t.qZA(),t.TgZ(22,"li"),t._uU(23,"Opci\xf3n creativa: sustituir el ingrediente por otro que tengas a mano y que aporte un sabor similar o incluso mejor."),t.qZA()(),t.TgZ(24,"p",18),t._uU(25,"La creatividad en la soluci\xf3n de problemas es exactamente eso: adaptarte a la situaci\xf3n y buscar nuevas combinaciones que cumplan el objetivo, incluso mejorando el resultado esperado."),t.qZA()(),t.TgZ(26,"div",20)(27,"h2",21),t._uU(28,"\u{1f504} Soluci\xf3n creativa y la vida real"),t.qZA(),t.TgZ(29,"ul",22)(30,"li"),t._uU(31,"En casa: Si se rompe el control remoto, puedes cambiar de canal usando los botones de la TV o incluso una app en el tel\xe9fono."),t.qZA(),t.TgZ(32,"li"),t._uU(33,"En el trabajo: Si un archivo es demasiado pesado para enviarlo por correo, puedes comprimirlo, subirlo a la nube o dividirlo en partes."),t.qZA(),t.TgZ(34,"li"),t._uU(35,"En la escuela: Si olvidaste tu cuaderno, puedes pedirle a un compa\xf1ero una foto de las notas."),t.qZA()(),t.TgZ(36,"p",18),t._uU(37,"La creatividad no siempre es \u201cinventar algo nuevo\u201d desde cero, muchas veces es usar lo que tienes de una forma distinta."),t.qZA()(),t.TgZ(38,"div",23)(39,"h2",24),t._uU(40,"\u{1f9e9} Elementos clave de la soluci\xf3n creativa"),t.qZA(),t.TgZ(41,"ul",22)(42,"li"),t._uU(43,"Identificaci\xf3n precisa del problema"),t._UZ(44,"br"),t.TgZ(45,"span",18),t._uU(46,"No se puede encontrar una soluci\xf3n efectiva si no se entiende exactamente qu\xe9 se quiere resolver."),t._UZ(47,"br"),t._uU(48,"Ejemplo: \u201cEl sistema es lento\u201d es muy general. \u201cEl sistema tarda 5 segundos en cargar la lista de productos\u201d es espec\xedfico y accionable."),t.qZA()(),t.TgZ(49,"li"),t._uU(50,"An\xe1lisis desde diferentes perspectivas"),t._UZ(51,"br"),t.TgZ(52,"span",18),t._uU(53,"Ver el problema desde distintos \xe1ngulos. A veces la soluci\xf3n aparece cuando lo miras desde el punto de vista de otro usuario, otro equipo o incluso otra cultura."),t.qZA()(),t.TgZ(54,"li"),t._uU(55,"Generaci\xf3n de m\xfaltiples ideas"),t._UZ(56,"br"),t.TgZ(57,"span",18),t._uU(58,"Cuantas m\xe1s ideas tengas, m\xe1s probabilidades de encontrar una soluci\xf3n innovadora. Aqu\xed no se juzga si son \u201cbuenas\u201d o \u201cmalas\u201d, la prioridad es cantidad."),t.qZA()(),t.TgZ(59,"li"),t._uU(60,"Pensar fuera del patr\xf3n (out of the box)"),t._UZ(61,"br"),t.TgZ(62,"span",18),t._uU(63,"Se trata de romper las rutas mentales comunes y atreverse a probar lo que, en principio, podr\xeda parecer extra\xf1o."),t.qZA()(),t.TgZ(64,"li"),t._uU(65,"Combinar conceptos"),t._UZ(66,"br"),t.TgZ(67,"span",18),t._uU(68,"La fusi\xf3n de dos ideas distintas suele producir soluciones poderosas. Ejemplo: las \u201cbicicletas el\xe9ctricas\u201d combinan el transporte tradicional con tecnolog\xeda el\xe9ctrica."),t.qZA()(),t.TgZ(69,"li"),t._uU(70,"Evaluaci\xf3n pr\xe1ctica"),t._UZ(71,"br"),t.TgZ(72,"span",18),t._uU(73,"No toda idea creativa es viable. Hay que considerar recursos, tiempo, riesgos y beneficios antes de implementarla."),t.qZA()(),t.TgZ(74,"li"),t._uU(75,"Iteraci\xf3n y mejora"),t._UZ(76,"br"),t.TgZ(77,"span",18),t._uU(78,"La primera versi\xf3n rara vez es perfecta. La creatividad tambi\xe9n incluye la capacidad de mejorar la soluci\xf3n con base en pruebas y retroalimentaci\xf3n."),t.qZA()()()(),t.TgZ(79,"div",16)(80,"h2",25),t._uU(81,"\u{1f9e0} Enfoques creativos usados en programaci\xf3n"),t.qZA(),t.TgZ(82,"ul",22)(83,"li"),t._uU(84,"Reutilizaci\xf3n de c\xf3digo en contextos distintos al que fue creado."),t.qZA(),t.TgZ(85,"li"),t._uU(86,"Uso de librer\xedas de forma no tradicional, combinando funciones para lograr nuevos resultados."),t.qZA(),t.TgZ(87,"li"),t._uU(88,"Aplicar conceptos de un lenguaje de programaci\xf3n en otro para obtener ventajas t\xe9cnicas."),t.qZA(),t.TgZ(89,"li"),t._uU(90,"Pensar en soluciones visuales (UI/UX) para problemas que no son puramente t\xe9cnicos."),t.qZA()()(),t.TgZ(91,"div",26)(92,"h2",27),t._uU(93,"\u{1f680} Beneficios de aplicar soluciones creativas"),t.qZA(),t.TgZ(94,"ul",22)(95,"li"),t._uU(96,"Mayor eficiencia y reducci\xf3n de costos."),t.qZA(),t.TgZ(97,"li"),t._uU(98,"Respuestas r\xe1pidas a problemas imprevistos."),t.qZA(),t.TgZ(99,"li"),t._uU(100,"Mayor competitividad y diferenciaci\xf3n en el mercado."),t.qZA(),t.TgZ(101,"li"),t._uU(102,"Mejor experiencia para el usuario final."),t.qZA(),t.TgZ(103,"li"),t._uU(104,"Incremento de la satisfacci\xf3n personal y del equipo al resolver desaf\xedos de forma ingeniosa."),t.qZA()()()()())}function mn(u,T){1&u&&(t.TgZ(0,"section",12),t._UZ(1,"app-detective-generic",28),t.qZA()),2&u&&(t.xp6(1),t.Q6J("tipo",1))}function $n(u,T){1&u&&(t.TgZ(0,"section",12),t._UZ(1,"app-detective-generic",28),t.qZA()),2&u&&(t.xp6(1),t.Q6J("tipo",2))}const pi=function(u){return{"button-with-point":u}};let Zo=(()=>{class u{constructor(){this.selectedSection=1}static{this.\u0275fac=function(c){return new(c||u)}}static{this.\u0275cmp=t.Xpm({type:u,selectors:[["app-solucion-creativa"]],decls:23,vars:24,consts:[[1,"text-center","mb-6","mt-6"],[1,"text-3xl","font-bold","text-gray-800","mb-2","drop-shadow-md"],[1,"flex","items-center","justify-center","mb-1"],[1,"h-0.5","bg-gradient-to-r","from-transparent","via-green-500","to-transparent","w-96","shadow-sm"],[1,"flex","items-center","justify-center"],[1,"h-px","bg-gradient-to-r","from-transparent","via-gray-300","to-transparent","w-64","opacity-60"],[1,"flex","flex-col","items-center","mb-6"],[1,"sticky","top-0","z-20","w-auto","flex","justify-center","bg-transparent","backdrop-blur-md","py-2","rounded-xl"],[1,"flex","gap-72"],[1,"relative","px-4","py-2","rounded-lg","font-semibold","text-gray-700","hover:text-green-500","transition",3,"ngClass","click"],[1,"flex","flex-col","gap-6","items-center","w-full","px-2","md:px-0"],["class","bg-gray-500/20 backdrop-blur-md p-8 rounded-lg border border-gray-400/30 shadow-lg w-full max-w-7xl mt-2 mb-8",4,"ngIf"],[1,"bg-gray-500/20","backdrop-blur-md","p-8","rounded-lg","border","border-gray-400/30","shadow-lg","w-full","max-w-7xl","mt-2","mb-8"],[1,"flex","flex-col","gap-6","mb-8","justify-start","items-start"],[1,"text-xl","font-bold","text-blue-500","mb-2","flex","items-center","gap-2"],[1,"text-gray-800","ml-8"],[1,"bg-gradient-to-br","from-blue-100","via-blue-50","to-white","border-l-4","border-blue-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"text-lg","font-semibold","text-gray-700","mt-4","mb-2","flex","items-center","gap-2"],[1,"text-gray-700"],[1,"list-disc","pl-6","text-gray-700","mb-2"],[1,"bg-gradient-to-br","from-green-100","via-green-50","to-white","border-l-4","border-green-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"text-xl","font-bold","text-green-600","mb-2","flex","items-center","gap-2"],[1,"list-disc","ml-6","text-gray-800","mb-2"],[1,"bg-gradient-to-br","from-yellow-100","via-yellow-50","to-white","border-l-4","border-yellow-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"text-xl","font-bold","text-yellow-600","mb-2","flex","items-center","gap-2"],[1,"text-xl","font-bold","text-blue-600","mb-2","flex","items-center","gap-2"],[1,"bg-gradient-to-br","from-pink-100","via-pink-50","to-white","border-l-4","border-pink-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"text-xl","font-bold","text-pink-600","mb-2","flex","items-center","gap-2"],[3,"tipo"]],template:function(c,a){1&c&&(t.TgZ(0,"div",0)(1,"h1",1),t._uU(2,"\u{1f3a8} Soluci\xf3n Creativa de Problemas"),t.qZA(),t.TgZ(3,"div",2),t._UZ(4,"div",3),t.qZA(),t.TgZ(5,"div",4),t._UZ(6,"div",5),t.qZA()(),t.TgZ(7,"div",6)(8,"nav",7)(9,"ul",8)(10,"li")(11,"button",9),t.NdJ("click",function(){return a.selectedSection=1}),t._uU(12," Teor\xeda "),t.qZA()(),t.TgZ(13,"li")(14,"button",9),t.NdJ("click",function(){return a.selectedSection=2}),t._uU(15," Ejemplos "),t.qZA()(),t.TgZ(16,"li")(17,"button",9),t.NdJ("click",function(){return a.selectedSection=3}),t._uU(18," Ejercicios "),t.qZA()()()()(),t.TgZ(19,"div",10),t.YNc(20,hi,105,0,"section",11),t.YNc(21,mn,2,1,"section",11),t.YNc(22,$n,2,1,"section",11),t.qZA()),2&c&&(t.xp6(11),t.ekj("border-b-4",1===a.selectedSection)("border-blue-500",1===a.selectedSection),t.Q6J("ngClass",t.VKq(18,pi,1===a.selectedSection)),t.xp6(3),t.ekj("border-b-4",2===a.selectedSection)("border-blue-500",2===a.selectedSection),t.Q6J("ngClass",t.VKq(20,pi,2===a.selectedSection)),t.xp6(3),t.ekj("border-b-4",3===a.selectedSection)("border-blue-500",3===a.selectedSection),t.Q6J("ngClass",t.VKq(22,pi,3===a.selectedSection)),t.xp6(3),t.Q6J("ngIf",1===a.selectedSection),t.xp6(1),t.Q6J("ngIf",2===a.selectedSection),t.xp6(1),t.Q6J("ngIf",3===a.selectedSection))},dependencies:[V.mk,V.O5,ss],styles:[".button-with-point[_ngcontent-%COMP%]{border-bottom-width:4px!important;border-bottom-color:#22c55e!important}"]})}}return u})();const Ho=function(u){return{"background-color":u,display:"flex","align-items":"center","justify-content":"center"}};function _n(u,T){if(1&u&&(t.TgZ(0,"div",35)(1,"span",36),t._uU(2,"\u{1f3e0}"),t.qZA()()),2&u){const r=t.oxw().$implicit,c=t.oxw(2);t.Q6J("ngStyle",t.VKq(1,Ho,c.getEntityColor(r)))}}function bn(u,T){if(1&u&&(t.TgZ(0,"div",37)(1,"span",36),t._uU(2),t.qZA()()),2&u){const r=t.oxw().$implicit,c=t.oxw(2);t.Q6J("ngStyle",t.VKq(2,Ho,c.getEntityColor(r))),t.xp6(2),t.Oqu(c.getEmojiAnimal(r.entityName))}}const fn=function(){return{"background-color":"#22c55e"}},ns=function(){return{}};function Tn(u,T){if(1&u&&(t.TgZ(0,"div",32),t.YNc(1,_n,3,3,"div",33),t.YNc(2,bn,3,4,"div",34),t.qZA()),2&u){const r=T.$implicit;t.Tol("cell "+r.type+" "+r.orientation),t.Q6J("ngStyle",r.isOptimal?t.DdM(5,fn):t.DdM(6,ns)),t.xp6(1),t.Q6J("ngIf","house"===r.entity),t.xp6(1),t.Q6J("ngIf","pet"===r.entity)}}function En(u,T){if(1&u){const r=t.EpF();t.TgZ(0,"div",38)(1,"div",39)(2,"h2",40),t._uU(3),t.qZA(),t.TgZ(4,"div",41)(5,"div",42)(6,"div",43),t._uU(7,"Reiniciar"),t.qZA(),t.TgZ(8,"button",44),t.NdJ("click",function(){t.CHM(r);const a=t.oxw(2);return t.KtG(a.reiniciarNivel())}),t.O4$(),t.TgZ(9,"svg",45),t._UZ(10,"path",22),t.qZA()()(),t.kcU(),t.TgZ(11,"div",42)(12,"div",46),t._uU(13,"Siguiente Nivel"),t.qZA(),t.TgZ(14,"button",47),t.NdJ("click",function(){t.CHM(r);const a=t.oxw(2);return t.KtG(a.siguienteNivel())}),t.O4$(),t.TgZ(15,"svg",45),t._UZ(16,"path",25),t.qZA()()()()()()}if(2&u){const r=t.oxw(2);t.xp6(3),t.Oqu(r.mensaje)}}function vn(u,T){if(1&u){const r=t.EpF();t.TgZ(0,"div",15)(1,"button",48),t.NdJ("click",function(){t.CHM(r);const a=t.oxw(2);return t.KtG(a.toggleRuta())}),t.O4$(),t.TgZ(2,"svg",17),t._UZ(3,"path",49)(4,"circle",50),t.qZA()(),t.kcU(),t.TgZ(5,"div",19),t._uU(6," Ruta \xf3ptima "),t._UZ(7,"div",20),t.qZA()()}}function Ze(u,T){1&u&&(t.TgZ(0,"p"),t._uU(1,"Ninguna a bordo"),t.qZA())}const L=function(u){return{"background-color":u,"border-radius":"0.35em",padding:"0.08em 0.32em","margin-right":"0.18em",display:"inline-block","font-size":"1.45rem"}};function yn(u,T){if(1&u&&(t.TgZ(0,"span",51),t._uU(1),t.qZA()),2&u){const r=T.$implicit,c=t.oxw(2);t.Q6J("ngStyle",t.VKq(2,L,c.getColorCasaMascota(r))),t.xp6(1),t.hij(" ",c.getEmojiAnimal(r)," ")}}function gi(u,T){if(1&u){const r=t.EpF();t.TgZ(0,"div",1)(1,"header",2)(2,"h1",3),t._uU(3,"Carro Recolector"),t.qZA(),t.TgZ(4,"p",4),t._uU(5),t.qZA()(),t.TgZ(6,"div",5)(7,"div",6)(8,"div",7)(9,"main",8),t.YNc(10,Tn,3,7,"div",9),t.TgZ(11,"div",10)(12,"span",11),t._uU(13),t.qZA()(),t.YNc(14,En,17,1,"div",12),t.qZA()(),t.TgZ(15,"div",13)(16,"div",14)(17,"div",15)(18,"button",16),t.NdJ("click",function(){t.CHM(r);const a=t.oxw();return t.KtG(a.anteriorNivel())}),t.O4$(),t.TgZ(19,"svg",17),t._UZ(20,"path",18),t.qZA()(),t.kcU(),t.TgZ(21,"div",19),t._uU(22," Anterior "),t._UZ(23,"div",20),t.qZA()(),t.TgZ(24,"div",15)(25,"button",21),t.NdJ("click",function(){t.CHM(r);const a=t.oxw();return t.KtG(a.reiniciarNivel())}),t.O4$(),t.TgZ(26,"svg",17),t._UZ(27,"path",22),t.qZA()(),t.kcU(),t.TgZ(28,"div",19),t._uU(29," Reiniciar "),t._UZ(30,"div",20),t.qZA()(),t.YNc(31,vn,8,0,"div",23),t.TgZ(32,"div",15)(33,"button",24),t.NdJ("click",function(){t.CHM(r);const a=t.oxw();return t.KtG(a.siguienteNivel())}),t.O4$(),t.TgZ(34,"svg",17),t._UZ(35,"path",25),t.qZA()(),t.kcU(),t.TgZ(36,"div",19),t._uU(37," Siguiente "),t._UZ(38,"div",20),t.qZA()()()()(),t.TgZ(39,"aside",26)(40,"div",27)(41,"h3"),t._uU(42,"Gasolina"),t.qZA(),t.TgZ(43,"p",28),t._uU(44),t.qZA()(),t.TgZ(45,"div",27)(46,"h3"),t._uU(47,"Controles"),t.qZA(),t.TgZ(48,"p",29),t._uU(49,"Usa las "),t.TgZ(50,"strong"),t._uU(51,"flechas"),t.qZA(),t._uU(52," del teclado para moverte."),t.qZA()(),t.TgZ(53,"div",27)(54,"h3"),t._uU(55,"Mascotas"),t.qZA(),t.YNc(56,Ze,2,0,"p",30),t.YNc(57,yn,2,4,"span",31),t.qZA()()()()}if(2&u){const r=t.oxw();t.xp6(5),t.AsE("Nivel ",r.indiceNivel+1,": ",r.nivelActual.nombre,""),t.xp6(4),t.Q6J("ngStyle",r.getGridStyles()),t.xp6(1),t.Q6J("ngForOf",r.flatLayout),t.xp6(1),t.Q6J("ngStyle",r.getCarStyles()),t.xp6(2),t.Oqu(r.getEmojiCarro()),t.xp6(1),t.Q6J("ngIf",r.mensaje),t.xp6(4),t.Q6J("disabled",!1),t.xp6(13),t.Q6J("ngIf",r.esEjemplo()),t.xp6(13),t.Oqu(r.gasolinaRestante),t.xp6(12),t.Q6J("ngIf",0===r.mascotasRecogidas.length),t.xp6(1),t.Q6J("ngForOf",r.mascotasRecogidas)}}let rs=(()=>{class u{constructor(r){this.http=r,this.indiceRutaOptimaActual=0,this.tipoHijo=1,this.niveles=[],this.indiceNivel=0,this.posicionCarro=[0,0],this.gasolinaRestante=0,this.mascotasRecogidas=[],this.casasVisitadas=[],this.mensaje=null,this.flatLayout=[],this.mostrarRuta=!1}ngOnInit(){this.cargarNiveles()}handleKeyDown(r){if(this.mensaje)return;let c=null;switch(r.key){case"ArrowUp":c="arriba";break;case"ArrowDown":c="abajo";break;case"ArrowLeft":c="izquierda";break;case"ArrowRight":c="derecha"}c&&(r.preventDefault(),this.moverCarro(c))}getEntityColor(r){if(!r.entity)return"transparent";const c=this.nivelActual.mapa.entidades.find(a=>a.pos[0]===r.pos[0]&&a.pos[1]===r.pos[1]&&a.tipo===r.entity);return c&&c.color?c.color:"transparent"}cargarNiveles(){this.http.get("assets/jsons-base/niveles-carro-mascotas.json").subscribe(r=>{this.niveles=JSON.parse(JSON.stringify(1===this.tipoHijo?r.ejemplos:r.ejercicios)),this.cargarNivel(0)})}cargarNivel(r){r<0||r>=this.niveles.length||(this.indiceNivel=r,this.nivelActual=JSON.parse(JSON.stringify(this.niveles[r])),this.mostrarRuta=!1,this.reiniciarNivel())}reiniciarNivel(){this.posicionCarro=[...this.nivelActual.carro.pos],this.gasolinaRestante=this.nivelActual.carro.gasolina,this.mascotasRecogidas=[],this.casasVisitadas=[],this.mensaje=null,this.indiceRutaOptimaActual=0,this.generarFlatLayout(),this.mostrarRuta&&this.aplicarRutaOptima()}generarFlatLayout(){const r=this.nivelActual.mapa.layout,c=this.nivelActual.mapa.entidades;this.flatLayout=[];for(let a=0;a<r.length;a++)for(let g=0;g<r[a].length;g++){const f=c.find(Z=>Z.pos[0]===a&&Z.pos[1]===g),S={type:"r"===r[a][g]?"road":"grass",orientation:this.getRoadOrientation(a,g),entity:f?f.tipo:null,entityName:f?f.nombre:void 0,isOptimal:!1,pos:[a,g]};this.flatLayout.push(S)}}moverCarro(r){if(this.mensaje||this.gasolinaRestante<=0)return;let[c,a]=this.posicionCarro;const g=[c,a];"arriba"===r&&g[0]--,"abajo"===r&&g[0]++,"izquierda"===r&&g[1]--,"derecha"===r&&g[1]++,this.esMovimientoValido(g)&&(this.posicionCarro=g,this.gasolinaRestante--,this.verificarInteracciones(),this.verificarCondicionVictoria(),this.mostrarRuta&&this.aplicarRutaOptima())}esMovimientoValido(r){const[c,a]=r,g=this.nivelActual.mapa.layout;return c>=0&&c<g.length&&a>=0&&a<g[0].length&&"r"===g[c][a]}verificarInteracciones(){const[r,c]=this.posicionCarro,a=this.nivelActual.mapa.entidades.find(g=>g.pos[0]===r&&g.pos[1]===c);if(a){if("pet"===a.tipo&&!this.mascotasRecogidas.includes(a.nombre)&&!this.casasVisitadas.includes(a.nombre)){this.mascotasRecogidas.push(a.nombre);const g=this.flatLayout.find(f=>f.pos[0]===r&&f.pos[1]===c);g&&(g.entity=null)}"house"===a.tipo&&this.mascotasRecogidas.includes(a.nombre)&&(this.casasVisitadas.includes(a.nombre)||(this.casasVisitadas.push(a.nombre),this.mascotasRecogidas=this.mascotasRecogidas.filter(g=>g!==a.nombre)))}}verificarCondicionVictoria(){const r=this.nivelActual.mapa.entidades.filter(a=>"pet"===a.tipo).length;this.casasVisitadas.length===r?this.mensaje="\xa1Felicidades!":this.gasolinaRestante<=0&&(this.mensaje="\xa1Te quedaste sin gasolina!")}getGridStyles(){if(!this.nivelActual)return{};const r=this.nivelActual.mapa.layout;return{"grid-template-columns":`repeat(${r[0].length}, 60px)`,"grid-template-rows":`repeat(${r.length}, 60px)`}}getCarStyles(){return this.nivelActual?{transform:`translate(${60*this.posicionCarro[1]}px, ${60*this.posicionCarro[0]}px)`}:{}}getEmojiAnimal(r){return"Perro"===r?"\u{1f436}":"Gato"===r?"\u{1f431}":"Conejo"===r?"\u{1f430}":"Zorro"===r?"\u{1f98a}":"Lobo"===r?"\u{1f43a}":"Pato"===r?"\u{1f986}":"Vaca"===r?"\u{1f42e}":"Cerdo"===r?"\u{1f437}":"Caballo"===r?"\u{1f434}":"Oveja"===r?"\u{1f411}":"\u2753"}getEmojiCarro(){return this.mascotasRecogidas.length>0?"\u{1f695}":"\u{1f697}"}esEjemplo(){return"ejemplo"===this.nivelActual?.tipo}toggleRuta(){this.mostrarRuta=!this.mostrarRuta,this.flatLayout.forEach(r=>r.isOptimal=!1),this.mostrarRuta&&this.aplicarRutaOptima()}aplicarRutaOptima(){if(!this.nivelActual.rutaOptima)return;this.flatLayout.forEach(g=>g.isOptimal=!1);const r=this.nivelActual.rutaOptima;let c=this.indiceRutaOptimaActual;const a=this.posicionCarro;for(;c<r.length&&a[0]===r[c][0]&&a[1]===r[c][1];)c++;if(c<r.length){const g=r[c],f=this.flatLayout.find(S=>S.pos[0]===g[0]&&S.pos[1]===g[1]);f&&(f.isOptimal=!0),this.indiceRutaOptimaActual=c}}getRoadOrientation(r,c){if(!this.nivelActual)return"none";const a=this.nivelActual.mapa.layout;if("r"!==a[r][c])return"none";const he=r>0&&"r"===a[r-1][c]||r<a.length-1&&"r"===a[r+1][c];return he&&(c>0&&"r"===a[r][c-1]||c<a[0].length-1&&"r"===a[r][c+1])?"intersection":he?"vertical":"horizontal"}siguienteNivel(){this.mensaje=null,this.cargarNivel(this.indiceNivel+1)}anteriorNivel(){this.mensaje=null,this.cargarNivel(this.indiceNivel-1)}getColorCasaMascota(r){if(!this.nivelActual)return"transparent";const c=this.nivelActual.mapa.entidades.find(a=>"house"===a.tipo&&a.nombre===r);return c&&c.color?c.color:"#f3ae22"}static{this.\u0275fac=function(c){return new(c||u)(t.Y36(fe.eN))}}static{this.\u0275cmp=t.Xpm({type:u,selectors:[["app-carro-mascotas-game"]],hostBindings:function(c,a){1&c&&t.NdJ("keydown",function(f){return a.handleKeyDown(f)},!1,t.Jf7)},inputs:{tipoHijo:"tipoHijo"},decls:1,vars:1,consts:[["class","container",4,"ngIf"],[1,"container"],[1,"header"],[1,"title"],[1,"level-indicator"],[1,"game-area"],[2,"display","flex","flex-direction","column"],[2,"width","621px","height","560px","display","flex","justify-content","center","align-items","center","background","linear-gradient(135deg, #36D1DC, #5B86E5)","border-radius","15px","border","1px solid rgba(255, 255, 255, 0.2)","box-shadow","0 4px 30px rgba(0, 0, 0, 0.1)"],[1,"game-board",3,"ngStyle"],[3,"class","ngStyle",4,"ngFor","ngForOf"],[1,"game-element","car",3,"ngStyle"],[2,"font-size","2.2rem","background","none"],["class","message-overlay",4,"ngIf"],[2,"display","flex","justify-content","flex-end","padding-top","1rem"],[2,"display","flex","gap","1rem","background","linear-gradient(135deg, #36D1DC, #5B86E5)","border-radius","1.5rem","box-shadow","0 4px 24px rgba(0,0,0,0.08)","padding","1.2rem 1.5rem"],[1,"group",2,"position","relative"],[1,"satellite-btn","w-12","h-12","text-white","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border-2","animate-in","hover:scale-110",2,"background-color","#f3ae22","border-color","#d18c00",3,"disabled","click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[1,"absolute","-top-8","left-1/2","transform","-translate-x-1/2","bg-gray-800","text-white","text-xs","px-2","py-1","rounded","opacity-0","group-hover:opacity-100","transition-opacity","duration-200","whitespace-nowrap","z-10"],[1,"absolute","top-full","left-1/2","transform","-translate-x-1/2","w-0","h-0","border-l-2","border-r-2","border-t-2","border-transparent","border-t-gray-800"],[1,"satellite-btn","w-12","h-12","text-white","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border-2","animate-in","hover:scale-110",2,"background-color","#22c55e","border-color","#15803d",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],["class","group","style","position:relative;",4,"ngIf"],[1,"satellite-btn","w-12","h-12","text-white","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border-2","animate-in","hover:scale-110",2,"background-color","#2563eb","border-color","#1e40af",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],[1,"sidebar"],[1,"info-box"],[1,"value"],[1,"controls-info"],[4,"ngIf"],["class","value",3,"ngStyle",4,"ngFor","ngForOf"],[3,"ngStyle"],["class","game-element house",3,"ngStyle",4,"ngIf"],["class","game-element pet",3,"ngStyle",4,"ngIf"],[1,"game-element","house",3,"ngStyle"],[2,"font-size","2.2rem","display","flex","align-items","center","justify-content","center","width","100%","height","100%"],[1,"game-element","pet",3,"ngStyle"],[1,"message-overlay"],[2,"min-width","320px","max-width","90vw","padding","2.5rem 2rem 2rem 2rem","background","linear-gradient(135deg, #36D1DC, #5B86E5)","border-radius","1.5rem","box-shadow","0 4px 30px rgba(0,0,0,0.15)","border","1px solid rgba(255,255,255,0.25)","display","flex","flex-direction","column","align-items","center","justify-content","center"],[2,"color","#fff","font-size","2rem","font-weight","700","text-align","center","margin-bottom","1.5rem","text-shadow","0 2px 8px rgba(0,0,0,0.10)","font-family","var(--font-display)"],[2,"display","flex","flex-direction","row","gap","1.2rem","align-items","center","justify-content","center","margin-top","0.5rem"],[2,"display","flex","flex-direction","column","align-items","center","position","relative"],[1,"tooltip-reiniciar",2,"pointer-events","none","opacity","0","position","absolute","left","50%","top","-1.7rem","transform","translateX(-50%)","background","#111","color","#fff","font-size","0.78rem","padding","0.13rem 0.7rem","border-radius","0.35rem","font-weight","500","box-shadow","0 2px 8px rgba(0,0,0,0.10)","white-space","nowrap","transition","opacity 0.18s","z-index","10"],["onmouseover","this.style.transform='scale(1.12)'; this.previousElementSibling.style.opacity='1'","onmouseout","this.style.transform='scale(1)'; this.previousElementSibling.style.opacity='0'",2,"width","48px","height","48px","display","flex","align-items","center","justify-content","center","border-radius","50%","border","none","background","linear-gradient(135deg, #22c55e, #38bdf8)","color","#fff","box-shadow","0 2px 12px rgba(0,0,0,0.10)","transition","transform 0.15s","cursor","pointer","outline","none","font-size","1.3rem","position","relative",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],[1,"tooltip-sig-nivel",2,"pointer-events","none","opacity","0","position","absolute","left","50%","top","-1.7rem","transform","translateX(-50%)","background","#111","color","#fff","font-size","0.78rem","padding","0.13rem 0.7rem","border-radius","0.35rem","font-weight","500","box-shadow","0 2px 8px rgba(0,0,0,0.10)","white-space","nowrap","transition","opacity 0.18s","z-index","10"],["onmouseover","this.style.transform='scale(1.07)'; this.previousElementSibling.style.opacity='1'","onmouseout","this.style.transform='scale(1)'; this.previousElementSibling.style.opacity='0'",2,"background","linear-gradient(135deg, #22c55e, #38bdf8)","color","#fff","border","none","border-radius","2rem","padding","0.75rem 2.9rem","box-shadow","0 2px 12px rgba(0,0,0,0.10)","transition","transform 0.15s","cursor","pointer","outline","none","display","flex","align-items","center","justify-content","center","gap","0.7rem","font-size","1.1rem","position","relative",3,"click"],[1,"satellite-btn","w-12","h-12","text-white","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border-2","animate-in","hover:scale-110",2,"background-color","#38bdf8","border-color","#0ea5e9",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z"],["cx","12","cy","9","r","2.5"],[1,"value",3,"ngStyle"]],template:function(c,a){1&c&&t.YNc(0,gi,58,12,"div",0),2&c&&t.Q6J("ngIf",a.nivelActual)},dependencies:[V.sg,V.O5,V.PC],styles:['.container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:2rem;padding:2rem;background-color:var(--color-ui-bg);font-family:var(--font-main);width:100%;max-width:1200px;margin:auto}.header[_ngcontent-%COMP%]{text-align:center}.title[_ngcontent-%COMP%]{font-family:var(--font-display);font-size:2.5rem;color:var(--color-ui-primary);margin:0}.level-indicator[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:600;color:var(--color-ui-secondary)}.game-area[_ngcontent-%COMP%]{display:flex;gap:2rem;width:100%;justify-content:center;align-items:flex-start}.game-board[_ngcontent-%COMP%]{display:grid;position:relative;border:8px solid #57534e;border-radius:16px;overflow:hidden;box-shadow:0 10px 20px #0000001a}.cell[_ngcontent-%COMP%]{width:60px;height:60px;position:relative;display:flex;align-items:center;justify-content:center;transition:background-color .3s}.grass[_ngcontent-%COMP%]{background-color:var(--color-grass)}.road[_ngcontent-%COMP%]{background-color:var(--color-road)}.road.horizontal[_ngcontent-%COMP%]:after{content:"";position:absolute;height:4px;width:100%;background-image:linear-gradient(to right,var(--color-road-line) 70%,transparent 30%);background-size:20px 4px}.road.vertical[_ngcontent-%COMP%]:before{content:"";position:absolute;width:4px;height:100%;background-image:linear-gradient(to bottom,var(--color-road-line) 70%,transparent 30%);background-size:4px 20px}.road.intersection[_ngcontent-%COMP%]{background-image:radial-gradient(var(--color-road-line) 2px,transparent 2px),radial-gradient(var(--color-road-line) 2px,transparent 2px);background-size:15px 15px;background-position:0 0,7.5px 7.5px}.game-element[_ngcontent-%COMP%]{position:absolute;width:80%;height:80%;background-size:contain;background-repeat:no-repeat;background-position:center;transition:all .4s ease-in-out;z-index:10}.car[_ngcontent-%COMP%]{width:54px;height:54px;display:flex;align-items:center;justify-content:center;font-size:2.2rem;background:none!important;border:none!important;border-radius:0!important;box-shadow:none!important}.pet[_ngcontent-%COMP%], .house[_ngcontent-%COMP%]{width:44px;height:44px;font-size:2.3rem;display:flex;align-items:center;justify-content:center;border-radius:12px;margin:auto}.optimal-arrow[_ngcontent-%COMP%]{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);font-weight:700;font-size:2.5rem;color:#ff9800;text-shadow:0 2px 8px #222,0 0 8px #000;pointer-events:none;z-index:2}.sidebar[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem;width:200px}.info-box[_ngcontent-%COMP%], .controls-box[_ngcontent-%COMP%]{background:linear-gradient(135deg,#36D1DC,#5B86E5);border-radius:15px;padding:1.5rem;text-align:center;color:#fff;box-shadow:0 8px 16px #0003;border:1px solid rgba(255,255,255,.1)}.info-box[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .controls-box[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-family:var(--font-display);font-size:1.5rem;margin-top:0;color:#fff;text-shadow:1px 1px 3px rgba(0,0,0,.2)}.info-box[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:2rem;font-weight:600;color:#fff;text-shadow:1px 1px 3px rgba(0,0,0,.2)}.controls-info[_ngcontent-%COMP%]{font-size:.9rem;color:#eee}.action-buttons[_ngcontent-%COMP%]{margin-top:1rem;display:flex;flex-direction:column;gap:.5rem}.action-btn[_ngcontent-%COMP%]{width:100%;padding:.8rem;border-radius:8px;border:none;background-color:var(--color-ui-primary);color:#fff;font-size:1rem;font-weight:600;cursor:pointer;transition:background-color .2s}.action-btn[_ngcontent-%COMP%]:hover{background-color:#44403c}.action-btn[_ngcontent-%COMP%]:disabled{background-color:#d6d3d1;cursor:not-allowed}.message-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background-color:#0009;display:flex;align-items:center;justify-content:center;z-index:100}.message-box[_ngcontent-%COMP%]{background:#fff;padding:3rem;border-radius:16px;text-align:center;box-shadow:0 10px 30px #0003}.message-box[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-family:var(--font-display);font-size:3rem;margin:0 0 1rem;color:var(--color-grass)}']})}}return u})();function mi(u,T){1&u&&(t.TgZ(0,"section",12)(1,"div",13)(2,"h2",14),t._uU(3,"\u{1f9e0} \xbfQu\xe9 es la toma de decisiones?"),t.qZA(),t.TgZ(4,"p",15),t._uU(5,"La toma de decisiones es el proceso consciente de elegir entre varias alternativas (opciones) analizando informaci\xf3n, premisas y consecuencias. En programaci\xf3n y en la vida real implica evaluar datos, aplicar reglas l\xf3gicas y seleccionar la acci\xf3n m\xe1s adecuada seg\xfan objetivos y restricciones."),t.qZA(),t.TgZ(6,"div",16)(7,"h3",17),t._uU(8,"\u{1f527} Elementos fundamentales de todo proceso de decisi\xf3n"),t.qZA(),t.TgZ(9,"ul",18)(10,"li")(11,"b"),t._uU(12,"Opciones (alternativas):"),t.qZA(),t._uU(13," las posibilidades entre las que puedes elegir."),t.qZA(),t.TgZ(14,"li")(15,"b"),t._uU(16,"Premisas / datos:"),t.qZA(),t._uU(17," hechos o suposiciones sobre la situaci\xf3n (lo que sabes)."),t.qZA(),t.TgZ(18,"li")(19,"b"),t._uU(20,"Criterios:"),t.qZA(),t._uU(21," lo que valoras para elegir (rapidez, coste, seguridad, calidad)."),t.qZA(),t.TgZ(22,"li")(23,"b"),t._uU(24,"Restricciones:"),t.qZA(),t._uU(25," l\xedmites reales (presupuesto, tiempo, recursos)."),t.qZA(),t.TgZ(26,"li")(27,"b"),t._uU(28,"Consecuencias:"),t.qZA(),t._uU(29," resultados esperados para cada opci\xf3n."),t.qZA(),t.TgZ(30,"li")(31,"b"),t._uU(32,"Incertidumbre:"),t.qZA(),t._uU(33," grado de desconocimiento o probabilidad de distintos resultados."),t.qZA()()(),t.TgZ(34,"div",19)(35,"h2",20),t._uU(36,"\u{1f4da} Tipos de decisiones"),t.qZA(),t.TgZ(37,"ul",21)(38,"li")(39,"b"),t._uU(40,"Determin\xedsticas:"),t.qZA(),t._uU(41," resultado claro si se cumplen condiciones (ej. sem\xe1foro)."),t.qZA(),t.TgZ(42,"li")(43,"b"),t._uU(44,"Probabil\xedsticas:"),t.qZA(),t._uU(45," resultado incierto (ej. clima, mercado)."),t.qZA(),t.TgZ(46,"li")(47,"b"),t._uU(48,"Simples / aisladas:"),t.qZA(),t._uU(49," una sola elecci\xf3n moment\xe1nea."),t.qZA(),t.TgZ(50,"li")(51,"b"),t._uU(52,"Secuenciales:"),t.qZA(),t._uU(53," m\xfaltiples decisiones encadenadas (planificaci\xf3n)."),t.qZA(),t.TgZ(54,"li")(55,"b"),t._uU(56,"\xd3ptimas vs. satisficing:"),t.qZA(),t._uU(57," buscar la mejor soluci\xf3n o una suficientemente buena (por tiempo/recursos)."),t.qZA()()(),t.TgZ(58,"div",22)(59,"h2",23),t._uU(60,"\u{1f9ed} Met\xe1foras cotidianas"),t.qZA(),t.TgZ(61,"ul",21)(62,"li")(63,"b"),t._uU(64,"Bifurcaci\xf3n en el camino:"),t.qZA(),t._uU(65," llegas a un cruce y tomas la ruta seg\xfan se\xf1ales (condicional)."),t.qZA(),t.TgZ(66,"li")(67,"b"),t._uU(68,"Carta de restaurante:"),t.qZA(),t._uU(69," eliges plato seg\xfan hambre, tiempo y dinero (ponderar criterios)."),t.qZA(),t.TgZ(70,"li")(71,"b"),t._uU(72,"GPS con tr\xe1fico:"),t.qZA(),t._uU(73," elige la ruta m\xe1s r\xe1pida en tiempo real (evaluaci\xf3n din\xe1mica con datos)."),t.qZA(),t.TgZ(74,"li")(75,"b"),t._uU(76,"Comprar en oferta:"),t.qZA(),t._uU(77," comparas precio y necesidad; si el descuento compensa, compras (an\xe1lisis coste-beneficio)."),t.qZA()()(),t.TgZ(78,"div",24)(79,"h2",25),t._uU(80,"\u{1f517} C\xf3mo se conectan premisas y conclusiones"),t.qZA(),t.TgZ(81,"ul",21)(82,"li"),t._uU(83,"Premisa: \u201cSi llueve, llevar\xe9 paraguas.\u201d"),t.qZA(),t.TgZ(84,"li"),t._uU(85,"Hecho observado: \u201cEst\xe1 lloviendo.\u201d"),t.qZA(),t.TgZ(86,"li"),t._uU(87,"Conclusi\xf3n: \u201cLlevo paraguas.\u201d"),t.qZA()(),t.TgZ(88,"p",26),t._uU(89,"Este tipo de razonamiento se llama "),t.TgZ(90,"b"),t._uU(91,"Modus Ponens"),t.qZA(),t._uU(92," en l\xf3gica formal: si se acepta una premisa condicional (\u201cSi A, entonces B\u201d) y se verifica el antecedente (\u201cA\u201d), se puede concluir el consecuente (\u201cB\u201d)."),t._UZ(93,"br"),t._uU(94," En l\xf3gica: premisas \u2192 reglas (si\u2026 entonces, y, o, no) \u2192 conclusi\xf3n. En programaci\xf3n esto se traduce en condiciones ("),t.TgZ(95,"code"),t._uU(96,"if"),t.qZA(),t._uU(97,"), combinaciones ("),t.TgZ(98,"code"),t._uU(99,"&&"),t.qZA(),t._uU(100,", "),t.TgZ(101,"code"),t._uU(102,"||"),t.qZA(),t._uU(103,") y negaciones ("),t.TgZ(104,"code"),t._uU(105,"!"),t.qZA(),t._uU(106,")."),t.qZA()(),t.TgZ(107,"div",27)(108,"h2",28),t._uU(109,"\u{1f9e0} Modelos mentales y t\xe9cnicas l\xf3gicas \xfatiles"),t.qZA(),t.TgZ(110,"ul",21)(111,"li")(112,"b"),t._uU(113,"Si \u2026 entonces (implicaci\xf3n):"),t.qZA(),t._uU(114," estructura b\xe1sica para decisiones."),t.qZA(),t.TgZ(115,"li")(116,"b"),t._uU(117,"AND (y) / OR (o) / NOT (no):"),t.qZA(),t._uU(118," combinar condiciones."),t.qZA(),t.TgZ(119,"li")(120,"b"),t._uU(121,"\xc1rbol de decisi\xf3n:"),t.qZA(),t._uU(122," representar opciones y sus resultados en ramas."),t.qZA(),t.TgZ(123,"li")(124,"b"),t._uU(125,"Funci\xf3n de utilidad / puntuaci\xf3n:"),t.qZA(),t._uU(126," asignar valor num\xe9rico a cada opci\xf3n y elegir la de mayor puntaje."),t.qZA(),t.TgZ(127,"li")(128,"b"),t._uU(129,"Reglas heur\xedsticas:"),t.qZA(),t._uU(130," atajos para decidir r\xe1pido (p. ej. \u201csi tengo menos de 5 minutos, elijo la opci\xf3n r\xe1pida\u201d)."),t.qZA(),t.TgZ(131,"li")(132,"b"),t._uU(133,"B\xfasqueda y optimizaci\xf3n:"),t.qZA(),t._uU(134," cuando hay muchas opciones, aplicar estrategias (greedy, b\xfasqueda por puntaje, backtracking)."),t.qZA()()(),t.TgZ(135,"div",16)(136,"h2",29),t._uU(137,"\u{1f9fe} Herramientas pr\xe1cticas para evaluar opciones"),t.qZA(),t.TgZ(138,"h3",30),t._uU(139,"1) Matriz de decisi\xf3n ponderada"),t.qZA(),t.TgZ(140,"ol",31)(141,"li"),t._uU(142,"Listar criterios relevantes."),t.qZA(),t.TgZ(143,"li"),t._uU(144,"Asignar peso a cada criterio (suma 1 o 100)."),t.qZA(),t.TgZ(145,"li"),t._uU(146,"Puntuar cada opci\xf3n por criterio (0\u20135)."),t.qZA(),t.TgZ(147,"li"),t._uU(148,"Multiplicar y sumar para obtener la puntuaci\xf3n total."),t.qZA()(),t.TgZ(149,"div",32)(150,"table",33)(151,"thead")(152,"tr",34)(153,"th",35),t._uU(154,"Opci\xf3n"),t.qZA(),t.TgZ(155,"th",36),t._uU(156,"Rapidez (0.4)"),t.qZA(),t.TgZ(157,"th",36),t._uU(158,"Costo (0.3)"),t.qZA(),t.TgZ(159,"th",36),t._uU(160,"Facilidad (0.3)"),t.qZA(),t.TgZ(161,"th",37),t._uU(162,"Score total"),t.qZA()()(),t.TgZ(163,"tbody")(164,"tr",38)(165,"td",39),t._uU(166,"Opci\xf3n A"),t.qZA(),t.TgZ(167,"td",39),t._uU(168,"4 \u2192 1.6"),t.qZA(),t.TgZ(169,"td",39),t._uU(170,"3 \u2192 0.9"),t.qZA(),t.TgZ(171,"td",39),t._uU(172,"5 \u2192 1.5"),t.qZA(),t.TgZ(173,"td",39),t._uU(174,"4.0"),t.qZA()(),t.TgZ(175,"tr",40)(176,"td",39),t._uU(177,"Opci\xf3n B"),t.qZA(),t.TgZ(178,"td",39),t._uU(179,"3 \u2192 1.2"),t.qZA(),t.TgZ(180,"td",39),t._uU(181,"5 \u2192 1.5"),t.qZA(),t.TgZ(182,"td",39),t._uU(183,"2 \u2192 0.6"),t.qZA(),t.TgZ(184,"td",39),t._uU(185,"3.3"),t.qZA()()()()(),t.TgZ(186,"h3",30),t._uU(187,"2) Pros / Cons"),t.qZA(),t.TgZ(188,"p",26),t._uU(189,"Lista simple de ventajas y desventajas; \xfatil para decisiones con pocos criterios."),t.qZA(),t.TgZ(190,"h3",30),t._uU(191,"3) \xc1rbol de decisi\xf3n b\xe1sico"),t.qZA(),t.TgZ(192,"p",26),t._uU(193,"Dibuja nodos: en cada nodo una condici\xf3n; en hojas la consecuencia o recompensa. Muy \xfatil para decisiones secuenciales."),t.qZA(),t.TgZ(194,"h3",30),t._uU(195,"4) Sensitivity / An\xe1lisis de sensibilidad"),t.qZA(),t.TgZ(196,"p",26),t._uU(197,"Modificar pesos o supuestos para ver si la decisi\xf3n se mantiene estable."),t.qZA()(),t.TgZ(198,"div",22)(199,"h2",23),t._uU(200,"\u26a0\ufe0f Sesgos y errores comunes"),t.qZA(),t.TgZ(201,"ul",21)(202,"li")(203,"b"),t._uU(204,"Anclaje:"),t.qZA(),t._uU(205," fijarse en la primera informaci\xf3n recibida."),t.qZA(),t.TgZ(206,"li")(207,"b"),t._uU(208,"Confirmaci\xf3n:"),t.qZA(),t._uU(209," buscar solo datos que confirmen nuestra idea."),t.qZA(),t.TgZ(210,"li")(211,"b"),t._uU(212,"Disponibilidad:"),t.qZA(),t._uU(213," sobrevalorar ejemplos recientes o memorables."),t.qZA(),t.TgZ(214,"li")(215,"b"),t._uU(216,"Exceso de confianza:"),t.qZA(),t._uU(217," subestimar la incertidumbre."),t.qZA()(),t.TgZ(218,"p",26),t._uU(219,"Ense\xf1ar a preguntar: \u201c\xbfQu\xe9 supongo?\u201d y \u201c\xbfQu\xe9 pasa si esa suposici\xf3n falla?\u201d ayuda a mitigarlos."),t.qZA()(),t.TgZ(220,"div",24)(221,"h2",25),t._uU(222,"\u{1f5a5} C\xf3mo mapear todo esto en programaci\xf3n"),t.qZA(),t.TgZ(223,"ul",21)(224,"li")(225,"b"),t._uU(226,"Condicionales ("),t.TgZ(227,"code"),t._uU(228,"if/else"),t.qZA(),t._uU(229,"):"),t.qZA(),t._uU(230," decisiones simples."),t.qZA(),t.TgZ(231,"li")(232,"b"),t._uU(233,"Switch / case:"),t.qZA(),t._uU(234," elegir entre varias alternativas discretas."),t.qZA(),t.TgZ(235,"li")(236,"b"),t._uU(237,"Funciones que devuelven puntajes:"),t.qZA(),t._uU(238," implementar matriz ponderada ("),t.TgZ(239,"code"),t._uU(240,"score(option)"),t.qZA(),t._uU(241,")."),t.qZA(),t.TgZ(242,"li")(243,"b"),t._uU(244,"Estructuras de datos (arrays / objetos):"),t.qZA(),t._uU(245," almacenar opciones, criterios y resultados."),t.qZA(),t.TgZ(246,"li")(247,"b"),t._uU(248,"\xc1rboles (estructuras recursivas):"),t.qZA(),t._uU(249," modelar decisiones secuenciales."),t.qZA(),t.TgZ(250,"li")(251,"b"),t._uU(252,"Simulaci\xf3n / Monte Carlo:"),t.qZA(),t._uU(253," cuando hay incertidumbre usar simulaciones para estimar probabilidades. "),t.qZA()(),t.TgZ(254,"h3",41),t._uU(255,"Pseudoc\xf3digo ejemplo (score):"),t.qZA(),t.TgZ(256,"pre",42)(257,"code"),t._uU(258),t.qZA()()()()()),2&u&&(t.xp6(258),t.AsE("// criterios = ","{"," rapidez:0.4, costo:0.3, facilidad:0.3 ","}","\n            // opciones = [A,B,C]\n            for opcion in opciones:\n                score = 0\n                for criterio in criterios:\n                    score += puntaje(opcion, criterio) * criterios[criterio]\n                escoger opcion con max(score)\n            "))}function $i(u,T){1&u&&(t.TgZ(0,"section",12),t._UZ(1,"app-carro-mascotas-game",43),t.qZA()),2&u&&(t.xp6(1),t.Q6J("tipoHijo",1))}function _e(u,T){1&u&&(t.TgZ(0,"section",12),t._UZ(1,"app-carro-mascotas-game",43),t.qZA()),2&u&&(t.xp6(1),t.Q6J("tipoHijo",2))}const We=function(u){return{"button-with-point":u}};let Go=(()=>{class u{constructor(){this.selectedSection=1}static{this.\u0275fac=function(c){return new(c||u)}}static{this.\u0275cmp=t.Xpm({type:u,selectors:[["app-toma-decisiones"]],decls:23,vars:24,consts:[[1,"text-center","mb-6","mt-6"],[1,"text-3xl","font-bold","text-gray-800","mb-2","drop-shadow-md"],[1,"flex","items-center","justify-center","mb-1"],[1,"h-0.5","bg-gradient-to-r","from-transparent","via-blue-500","to-transparent","w-96","shadow-sm"],[1,"flex","items-center","justify-center"],[1,"h-px","bg-gradient-to-r","from-transparent","via-gray-300","to-transparent","w-64","opacity-60"],[1,"flex","flex-col","items-center","mb-6"],[1,"sticky","top-0","z-20","w-auto","flex","justify-center","bg-transparent","backdrop-blur-md","py-2","rounded-xl"],[1,"flex","gap-72"],[1,"relative","px-4","py-2","rounded-lg","font-semibold","text-gray-700","hover:text-blue-500","transition",3,"ngClass","click"],[1,"flex","flex-col","gap-6","items-center","w-full","px-2","md:px-0"],["class","bg-gray-500/20 backdrop-blur-md p-8 rounded-lg border border-gray-400/30 shadow-lg w-full max-w-7xl mt-2 mb-8",4,"ngIf"],[1,"bg-gray-500/20","backdrop-blur-md","p-8","rounded-lg","border","border-gray-400/30","shadow-lg","w-full","max-w-7xl","mt-2","mb-8"],[1,"flex","flex-col","gap-6","mb-8","justify-start","items-start"],[1,"text-xl","font-bold","text-blue-500","mb-2","flex","items-center","gap-2"],[1,"text-gray-800","ml-8"],[1,"bg-gradient-to-br","from-blue-100","via-blue-50","to-white","border-l-4","border-blue-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"text-lg","font-semibold","text-gray-700","mt-4","mb-2","flex","items-center","gap-2"],[1,"list-disc","pl-6","text-gray-700","mb-2"],[1,"bg-gradient-to-br","from-green-100","via-green-50","to-white","border-l-4","border-green-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"text-xl","font-bold","text-green-600","mb-2","flex","items-center","gap-2"],[1,"list-disc","ml-6","text-gray-800","mb-2"],[1,"bg-gradient-to-br","from-yellow-100","via-yellow-50","to-white","border-l-4","border-yellow-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"text-xl","font-bold","text-yellow-600","mb-2","flex","items-center","gap-2"],[1,"bg-gradient-to-br","from-purple-100","via-purple-50","to-white","border-l-4","border-purple-400","shadow-lg","rounded-xl","p-6","w-full","mt-2","mb-2"],[1,"text-xl","font-bold","text-purple-600","mb-2","flex","items-center","gap-2"],[1,"text-gray-700"],[1,"bg-gradient-to-br","from-pink-100","via-pink-50","to-white","border-l-4","border-pink-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"text-xl","font-bold","text-pink-600","mb-2","flex","items-center","gap-2"],[1,"text-xl","font-bold","text-blue-600","mb-2","flex","items-center","gap-2"],[1,"font-semibold","text-blue-700"],[1,"list-decimal","ml-8","text-gray-700","mb-2"],[1,"overflow-x-auto","mb-4"],[1,"min-w-full","text-sm","text-left","border-separate","border-spacing-0","rounded-xl","shadow-lg","bg-white"],[1,"bg-gradient-to-r","from-blue-500","via-cyan-400","to-green-300"],[1,"py-3","px-6","font-bold","text-white","rounded-tl-xl","text-center"],[1,"py-3","px-6","font-bold","text-white","text-center"],[1,"py-3","px-6","font-bold","text-white","rounded-tr-xl","text-center"],[1,"hover:bg-red-50","transition"],[1,"py-3","px-6","border-b","border-gray-200"],[1,"hover:bg-blue-50","transition"],[1,"font-semibold","text-purple-700"],[1,"bg-gray-900","text-green-200","rounded-lg","p-4","text-sm","overflow-x-auto"],[3,"tipoHijo"]],template:function(c,a){1&c&&(t.TgZ(0,"div",0)(1,"h1",1),t._uU(2,"\u{1f5c2}\ufe0f Toma de Decisiones y Evaluaci\xf3n de Opciones"),t.qZA(),t.TgZ(3,"div",2),t._UZ(4,"div",3),t.qZA(),t.TgZ(5,"div",4),t._UZ(6,"div",5),t.qZA()(),t.TgZ(7,"div",6)(8,"nav",7)(9,"ul",8)(10,"li")(11,"button",9),t.NdJ("click",function(){return a.selectedSection=1}),t._uU(12," Teor\xeda "),t.qZA()(),t.TgZ(13,"li")(14,"button",9),t.NdJ("click",function(){return a.selectedSection=2}),t._uU(15," Ejemplos "),t.qZA()(),t.TgZ(16,"li")(17,"button",9),t.NdJ("click",function(){return a.selectedSection=3}),t._uU(18," Ejercicios "),t.qZA()()()()(),t.TgZ(19,"div",10),t.YNc(20,mi,259,2,"section",11),t.YNc(21,$i,2,1,"section",11),t.YNc(22,_e,2,1,"section",11),t.qZA()),2&c&&(t.xp6(11),t.ekj("border-b-4",1===a.selectedSection)("border-blue-500",1===a.selectedSection),t.Q6J("ngClass",t.VKq(18,We,1===a.selectedSection)),t.xp6(3),t.ekj("border-b-4",2===a.selectedSection)("border-blue-500",2===a.selectedSection),t.Q6J("ngClass",t.VKq(20,We,2===a.selectedSection)),t.xp6(3),t.ekj("border-b-4",3===a.selectedSection)("border-blue-500",3===a.selectedSection),t.Q6J("ngClass",t.VKq(22,We,3===a.selectedSection)),t.xp6(3),t.Q6J("ngIf",1===a.selectedSection),t.xp6(1),t.Q6J("ngIf",2===a.selectedSection),t.xp6(1),t.Q6J("ngIf",3===a.selectedSection))},dependencies:[V.mk,V.O5,rs]})}}return u})();function ls(u,T){1&u&&(t.TgZ(0,"div",6),t._uU(1,"Cargando ejemplos..."),t.qZA())}function B(u,T){if(1&u&&(t.TgZ(0,"div",7),t._uU(1),t.qZA()),2&u){const r=t.oxw(2);t.xp6(1),t.Oqu(r.error)}}function cs(u,T){if(1&u){const r=t.EpF();t.TgZ(0,"div",10)(1,"div",11)(2,"div",12)(3,"span",13),t._uU(4),t.qZA(),t.TgZ(5,"span",14),t._uU(6),t.qZA()(),t.TgZ(7,"div",15)(8,"p",16),t._uU(9),t.qZA()()(),t.TgZ(10,"div",17)(11,"div",18),t._uU(12," Puntuaci\xf3n: "),t.TgZ(13,"span",19),t._uU(14),t.qZA(),t.TgZ(15,"span",20),t._uU(16),t.qZA()(),t.TgZ(17,"button",21),t.NdJ("click",function(){const g=t.CHM(r).$implicit,f=t.oxw(3);return t.KtG(f.seleccionarEjemplo(g))}),t._uU(18,"Intentar ejemplo"),t.qZA()()()}if(2&u){const r=T.$implicit,c=t.oxw(3);t.xp6(4),t.Oqu(c.getEmojiEjemplo(r.titulo)),t.xp6(2),t.Oqu(r.titulo),t.xp6(3),t.hij("",r.enunciado," "),t.xp6(5),t.Oqu(c.puntuacionesEjemplos[r.id]||0),t.xp6(2),t.hij("/ ",c.getMaxScoreForCase(r),"")}}function I(u,T){if(1&u&&(t.TgZ(0,"div",8),t.YNc(1,cs,19,5,"div",9),t.qZA()),2&u){const r=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",r.ejemplos)}}function R(u,T){if(1&u&&(t.TgZ(0,"div",48),t._uU(1),t.qZA()),2&u){const r=t.oxw(2).$implicit,c=t.oxw(4);t.Q6J("id","tooltip-"+r),t.xp6(1),t.hij(" ",null==c.ejemploSeleccionado.preguntas[c.preguntaActualEjemplo].consecuencias[r]?null:c.ejemploSeleccionado.preguntas[c.preguntaActualEjemplo].consecuencias[r].feedback," ")}}function _i(u,T){if(1&u){const r=t.EpF();t.TgZ(0,"div",44)(1,"div",45)(2,"button",46),t.NdJ("click",function(){t.CHM(r);const a=t.oxw().$implicit,g=t.oxw(4);return t.KtG(g.responderEjemplo(a))}),t._uU(3),t.qZA()(),t.YNc(4,R,2,2,"div",47),t.qZA()}if(2&u){const r=t.oxw().$implicit,c=t.oxw(4);t.xp6(2),t.uIk("aria-describedby","tooltip-"+r),t.xp6(1),t.hij(" ",r," "),t.xp6(1),t.Q6J("ngIf",null==c.ejemploSeleccionado.preguntas[c.preguntaActualEjemplo].consecuencias[r]?null:c.ejemploSeleccionado.preguntas[c.preguntaActualEjemplo].consecuencias[r].feedback)}}function te(u,T){if(1&u&&(t.TgZ(0,"div",52),t._uU(1),t.qZA()),2&u){const r=t.oxw(2).$implicit,c=t.oxw(4);t.Q6J("id","tooltip-"+r),t.xp6(1),t.hij(" ",null==c.ejemploSeleccionado.preguntas[c.preguntaActualEjemplo].consecuencias[r]?null:c.ejemploSeleccionado.preguntas[c.preguntaActualEjemplo].consecuencias[r].feedback," ")}}function bi(u,T){if(1&u){const r=t.EpF();t.TgZ(0,"div",49)(1,"div",45)(2,"button",50),t.NdJ("click",function(){t.CHM(r);const a=t.oxw().$implicit,g=t.oxw(4);return t.KtG(g.responderEjemplo(a))}),t._uU(3),t.qZA()(),t.YNc(4,te,2,2,"div",51),t.qZA()}if(2&u){const r=t.oxw().$implicit,c=t.oxw(4);t.xp6(2),t.uIk("aria-describedby","tooltip-"+r),t.xp6(1),t.hij(" ",r," "),t.xp6(1),t.Q6J("ngIf",null==c.ejemploSeleccionado.preguntas[c.preguntaActualEjemplo].consecuencias[r]?null:c.ejemploSeleccionado.preguntas[c.preguntaActualEjemplo].consecuencias[r].feedback)}}function ce(u,T){if(1&u&&(t.ynx(0),t.YNc(1,_i,5,3,"div",42),t.YNc(2,bi,5,3,"div",43),t.BQk()),2&u){const r=T.index,c=t.oxw(4);t.xp6(1),t.Q6J("ngIf",c.ejemploSeleccionado.preguntas[c.preguntaActualEjemplo].elecciones.length%2==1&&r===c.ejemploSeleccionado.preguntas[c.preguntaActualEjemplo].elecciones.length-1),t.xp6(1),t.Q6J("ngIf",!(c.ejemploSeleccionado.preguntas[c.preguntaActualEjemplo].elecciones.length%2==1&&r===c.ejemploSeleccionado.preguntas[c.preguntaActualEjemplo].elecciones.length-1))}}function d(u,T){if(1&u&&(t.TgZ(0,"div",37)(1,"h3",38)(2,"span",13),t._uU(3,"\u2753"),t.qZA(),t._uU(4),t.qZA(),t.TgZ(5,"div",39)(6,"div",40),t.YNc(7,ce,3,2,"ng-container",41),t.qZA()()()),2&u){const r=t.oxw(3);t.xp6(4),t.hij(" ",r.ejemploSeleccionado.preguntas[r.preguntaActualEjemplo].pregunta," "),t.xp6(3),t.Q6J("ngForOf",r.ejemploSeleccionado.preguntas[r.preguntaActualEjemplo].elecciones)}}function m(u,T){if(1&u&&(t.TgZ(0,"div",22)(1,"div",23),t._UZ(2,"div",24)(3,"div",25),t.qZA(),t.TgZ(4,"div",26)(5,"div",27)(6,"span",28),t._uU(7),t.qZA(),t.TgZ(8,"span",29),t._uU(9),t.qZA()(),t.TgZ(10,"p",30),t._uU(11),t.qZA()(),t.YNc(12,d,8,2,"div",31),t.TgZ(13,"div",32)(14,"div",33),t._uU(15,"Pregunta "),t.TgZ(16,"span",34),t._uU(17),t.qZA(),t._uU(18," / "),t.TgZ(19,"span",34),t._uU(20),t.qZA()(),t.TgZ(21,"div",35)(22,"span",36),t._uU(23,"\u2b50"),t.qZA(),t._uU(24),t.TgZ(25,"span",20),t._uU(26),t.qZA()()()()),2&u){const r=t.oxw(2);t.xp6(7),t.hij("",r.getEmojiEjemplo(r.ejemploSeleccionado.titulo),"\u200d"),t.xp6(2),t.Oqu(r.ejemploSeleccionado.titulo),t.xp6(2),t.hij("",r.ejemploSeleccionado.enunciado," "),t.xp6(1),t.Q6J("ngIf",r.preguntaActualEjemplo<r.ejemploSeleccionado.preguntas.length),t.xp6(5),t.Oqu(r.preguntaActualEjemplo+1),t.xp6(3),t.Oqu(r.ejemploSeleccionado.preguntas.length),t.xp6(4),t.hij(" ",r.puntuacionEjemplo," "),t.xp6(2),t.hij("/ ",r.getMaxScoreForCase(r.ejemploSeleccionado),"")}}function b(u,T){if(1&u){const r=t.EpF();t.TgZ(0,"div",53)(1,"div",54)(2,"div",55)(3,"span",28),t._uU(4,"\u{1f3c6}"),t.qZA(),t.TgZ(5,"span",56),t._uU(6,"\xa1Ejemplo completado!"),t.qZA()(),t.TgZ(7,"p",57),t._uU(8),t.qZA(),t.TgZ(9,"button",58),t.NdJ("click",function(){t.CHM(r);const a=t.oxw(2);return t.KtG(a.reiniciarEjemplo())}),t._uU(10,"Volver al selector de ejemplos"),t.qZA()()()}if(2&u){const r=t.oxw(2);t.xp6(8),t.Oqu(r.resultadoEjemplo)}}function y(u,T){if(1&u&&(t.TgZ(0,"div"),t.YNc(1,ls,2,0,"div",1),t.YNc(2,B,2,1,"div",2),t.YNc(3,I,2,1,"div",3),t.YNc(4,m,27,8,"div",4),t.YNc(5,b,11,1,"div",5),t.qZA()),2&u){const r=t.oxw();t.xp6(1),t.Q6J("ngIf",r.loading),t.xp6(1),t.Q6J("ngIf",r.error),t.xp6(1),t.Q6J("ngIf",!r.ejemploSeleccionado&&!r.loading&&!r.error),t.xp6(1),t.Q6J("ngIf",r.ejemploSeleccionado&&!r.finalizadoEjemplo),t.xp6(1),t.Q6J("ngIf",r.finalizadoEjemplo)}}function O(u,T){1&u&&(t.TgZ(0,"div",6),t._uU(1,"Cargando ejercicios..."),t.qZA())}function Ce(u,T){if(1&u&&(t.TgZ(0,"div",7),t._uU(1),t.qZA()),2&u){const r=t.oxw(2);t.xp6(1),t.Oqu(r.error)}}function Mt(u,T){if(1&u){const r=t.EpF();t.TgZ(0,"div",60)(1,"div",11)(2,"div",12)(3,"span",13),t._uU(4),t.qZA(),t.TgZ(5,"span",14),t._uU(6),t.qZA()(),t.TgZ(7,"div",61)(8,"p",16),t._uU(9),t.qZA()()(),t.TgZ(10,"div",17)(11,"div",18),t._uU(12," Puntuaci\xf3n: "),t.TgZ(13,"span",62),t._uU(14),t.qZA(),t.TgZ(15,"span",20),t._uU(16),t.qZA()(),t.TgZ(17,"button",63),t.NdJ("click",function(){const g=t.CHM(r).$implicit,f=t.oxw(3);return t.KtG(f.seleccionarEjercicio(g))}),t._uU(18,"Intentar Ejercicio"),t.qZA()()()}if(2&u){const r=T.$implicit,c=t.oxw(3);t.xp6(4),t.Oqu(c.getEmoji(r.titulo)),t.xp6(2),t.Oqu(r.titulo),t.xp6(3),t.hij("",r.enunciado," "),t.xp6(5),t.Oqu(c.puntuacionesEjercicios[r.id]||0),t.xp6(2),t.hij("/ ",c.getMaxScoreForCase(r),"")}}function xn(u,T){if(1&u&&(t.TgZ(0,"div",8),t.YNc(1,Mt,19,5,"div",59),t.qZA()),2&u){const r=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",r.ejercicios)}}function Vo(u,T){if(1&u){const r=t.EpF();t.TgZ(0,"button",71),t.NdJ("click",function(){const g=t.CHM(r).$implicit,f=t.oxw(4);return t.KtG(f.responder(g))}),t._uU(1),t.qZA()}if(2&u){const r=T.$implicit;t.xp6(1),t.hij(" ",r," ")}}function as(u,T){if(1&u&&(t.TgZ(0,"div",68)(1,"h3",69)(2,"span",13),t._uU(3,"\u2753"),t.qZA(),t._uU(4),t.qZA(),t.TgZ(5,"div",39),t.YNc(6,Vo,2,1,"button",70),t.qZA()()),2&u){const r=t.oxw(3);t.xp6(4),t.hij(" ",r.ejercicioSeleccionado.preguntas[r.preguntaActual].pregunta," "),t.xp6(2),t.Q6J("ngForOf",r.ejercicioSeleccionado.preguntas[r.preguntaActual].elecciones)}}function Nt(u,T){if(1&u&&(t.TgZ(0,"div",22)(1,"div",23),t._UZ(2,"div",24)(3,"div",25),t.qZA(),t.TgZ(4,"div",26)(5,"div",27)(6,"span",28),t._uU(7),t.qZA(),t.TgZ(8,"span",64),t._uU(9),t.qZA()(),t.TgZ(10,"p",30),t._uU(11),t.qZA()(),t.YNc(12,as,7,2,"div",65),t.TgZ(13,"div",66)(14,"div",33),t._uU(15,"Pregunta "),t.TgZ(16,"span",34),t._uU(17),t.qZA(),t._uU(18," / "),t.TgZ(19,"span",34),t._uU(20),t.qZA()(),t.TgZ(21,"div",67)(22,"span",36),t._uU(23,"\u2b50"),t.qZA(),t._uU(24),t.TgZ(25,"span",20),t._uU(26),t.qZA()()()()),2&u){const r=t.oxw(2);t.xp6(7),t.Oqu(r.getEmoji(r.ejercicioSeleccionado.titulo)),t.xp6(2),t.Oqu(r.ejercicioSeleccionado.titulo),t.xp6(2),t.hij("",r.ejercicioSeleccionado.enunciado," "),t.xp6(1),t.Q6J("ngIf",r.preguntaActual<r.ejercicioSeleccionado.preguntas.length),t.xp6(5),t.Oqu(r.preguntaActual+1),t.xp6(3),t.Oqu(r.ejercicioSeleccionado.preguntas.length),t.xp6(4),t.hij(" ",r.puntuacion," "),t.xp6(2),t.hij("/ ",r.getMaxScoreForCase(r.ejercicioSeleccionado),"")}}function bo(u,T){if(1&u){const r=t.EpF();t.TgZ(0,"div",53)(1,"div",72)(2,"div",55)(3,"span",28),t._uU(4,"\u{1f3c6}"),t.qZA(),t.TgZ(5,"span",73),t._uU(6,"\xa1Ejercicio completado!"),t.qZA()(),t.TgZ(7,"p",57),t._uU(8),t.qZA(),t.TgZ(9,"button",74),t.NdJ("click",function(){t.CHM(r);const a=t.oxw(2);return t.KtG(a.reiniciar())}),t._uU(10,"Volver al selector de ejercicios"),t.qZA()()()}if(2&u){const r=t.oxw(2);t.xp6(8),t.Oqu(r.resultado)}}function fi(u,T){if(1&u&&(t.TgZ(0,"div"),t.YNc(1,O,2,0,"div",1),t.YNc(2,Ce,2,1,"div",2),t.YNc(3,xn,2,1,"div",3),t.YNc(4,Nt,27,8,"div",4),t.YNc(5,bo,11,1,"div",5),t.qZA()),2&u){const r=t.oxw();t.xp6(1),t.Q6J("ngIf",r.loading),t.xp6(1),t.Q6J("ngIf",r.error),t.xp6(1),t.Q6J("ngIf",!r.ejercicioSeleccionado&&!r.loading&&!r.error),t.xp6(1),t.Q6J("ngIf",r.ejercicioSeleccionado&&!r.finalizado),t.xp6(1),t.Q6J("ngIf",r.finalizado)}}let Gr=(()=>{class u{constructor(r){this.http=r,this.puntuacionesEjemplos={},this.tipo=2,this.ejemplos=[],this.ejemploSeleccionado=null,this.preguntaActualEjemplo=0,this.puntuacionEjemplo=0,this.finalizadoEjemplo=!1,this.resultadoEjemplo="",this.feedbackEjemplo="",this.ejercicios=[],this.loading=!0,this.error="",this.ejercicioSeleccionado=null,this.preguntaActual=0,this.puntuacion=0,this.finalizado=!1,this.resultado="",this.puntuacionesEjercicios={},this.cargarEjercicios()}cargarEjercicios(){this.http.get("assets/jsons-base/pensamiento-logico.json").subscribe({next:r=>{this.ejercicios=r.ejercicios,this.ejemplos=r.ejemplos,this.loading=!1},error:()=>{this.error="No se pudo cargar el archivo de ejercicios.",this.loading=!1}})}seleccionarEjercicio(r){this.ejercicioSeleccionado=r,this.preguntaActual=0,this.puntuacion=0,this.finalizado=!1,this.resultado=""}seleccionarEjemplo(r){this.ejemploSeleccionado=r,this.preguntaActualEjemplo=0,this.puntuacionEjemplo=0,this.finalizadoEjemplo=!1,this.resultadoEjemplo="",this.feedbackEjemplo=""}responderEjemplo(r){if(!this.ejemploSeleccionado)return;const c=this.ejemploSeleccionado.preguntas[this.preguntaActualEjemplo],a=c.consecuencias[r];let g=0;c.puntuaciones&&"number"==typeof c.puntuaciones[r]?g=c.puntuaciones[r]:"number"==typeof a?.puntuacion&&(g=a.puntuacion),this.puntuacionEjemplo+=g,this.feedbackEjemplo=a?.feedback||"",a?.final?(this.finalizadoEjemplo=!0,this.resultadoEjemplo="\xa1Ejemplo finalizado! Puntuaci\xf3n: "+this.puntuacionEjemplo,this.ejemploSeleccionado&&(this.puntuacionesEjemplos[this.ejemploSeleccionado.id]=this.puntuacionEjemplo)):(this.preguntaActualEjemplo++,this.preguntaActualEjemplo>=this.ejemploSeleccionado.preguntas.length&&(this.finalizadoEjemplo=!0,this.resultadoEjemplo="\xa1Ejemplo finalizado! Puntuaci\xf3n: "+this.puntuacionEjemplo,this.ejemploSeleccionado&&(this.puntuacionesEjemplos[this.ejemploSeleccionado.id]=this.puntuacionEjemplo)))}reiniciarEjemplo(){this.ejemploSeleccionado=null,this.preguntaActualEjemplo=0,this.puntuacionEjemplo=0,this.finalizadoEjemplo=!1,this.resultadoEjemplo="",this.feedbackEjemplo=""}responder(r){if(!this.ejercicioSeleccionado)return;const c=this.ejercicioSeleccionado.preguntas[this.preguntaActual],a=c.consecuencias[r];let g=0;c.puntuaciones&&"number"==typeof c.puntuaciones[r]?g=c.puntuaciones[r]:"number"==typeof a?.puntuacion&&(g=a.puntuacion),this.puntuacion+=g,a?.final?(this.finalizado=!0,this.resultado="\xa1Ejercicio finalizado! Puntuaci\xf3n: "+this.puntuacion,this.ejercicioSeleccionado&&(this.puntuacionesEjercicios[this.ejercicioSeleccionado.id]=this.puntuacion)):(this.preguntaActual++,this.preguntaActual>=this.ejercicioSeleccionado.preguntas.length&&(this.finalizado=!0,this.resultado="\xa1Ejercicio finalizado! Puntuaci\xf3n: "+this.puntuacion,this.ejercicioSeleccionado&&(this.puntuacionesEjercicios[this.ejercicioSeleccionado.id]=this.puntuacion)))}reiniciar(){this.ejercicioSeleccionado=null,this.preguntaActual=0,this.puntuacion=0,this.finalizado=!1,this.resultado=""}getEmoji(r){return r.toLowerCase().includes("clima")?"\u{1f326}\ufe0f":r.toLowerCase().includes("desayuno")?"\u{1f373}":r.toLowerCase().includes("sem\xe1foro")?"\u{1f6a6}":r.toLowerCase().includes("detective")?"\u{1f575}\ufe0f":r.toLowerCase().includes("caf\xe9")?"\u2615":r.toLowerCase().includes("robot")?"\u{1f916}":r.toLowerCase().includes("guardarropa")?"\u{1f454}":"\u{1f9e9}"}getEmojiEjemplo(r){return r.toLowerCase().includes("chef")?"\u{1f373}":r.toLowerCase().includes("ingredientes")?"\u{1f957}":r.toLowerCase().includes("enfermera")?"\u{1f489}":r.toLowerCase().includes("pacientes")?"\u{1f3e5}":r.toLowerCase().includes("tienda")?"\u{1f3ea}":r.toLowerCase().includes("estilista")?"\u{1f487}\u200d\u2642\ufe0f":r.toLowerCase().includes("clientas")?"\u{1f481}":r.toLowerCase().includes("organizador")?"\u{1f389}":r.toLowerCase().includes("fiestas")?"\u{1f38a}":r.toLowerCase().includes("entrenador")?"\u{1f3cb}\ufe0f":r.toLowerCase().includes("deportivo")?"\u26bd":r.toLowerCase().includes("t\xe9cnico")?"\u{1f527}":r.toLowerCase().includes("computadoras")?"\u{1f4bb}":"\u{1f9e9}"}getMaxScoreForCase(r){let c=0;return r.preguntas.forEach(a=>{let g=Math.max(...Object.values(a.consecuencias).map(f=>"number"==typeof f.puntuacion?f.puntuacion:0));c+=g}),c}static{this.\u0275fac=function(c){return new(c||u)(t.Y36(fe.eN))}}static{this.\u0275cmp=t.Xpm({type:u,selectors:[["app-game-question-selection"]],inputs:{tipo:"tipo"},decls:2,vars:2,consts:[[4,"ngIf"],["class","text-center py-8",4,"ngIf"],["class","text-red-500 text-center py-8",4,"ngIf"],["class","grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",4,"ngIf"],["class","game-section w-full max-w-2xl mx-auto flex flex-col items-center justify-center relative gap-6",4,"ngIf"],["class","w-full max-w-2xl mx-auto flex flex-col items-center justify-center relative gap-6",4,"ngIf"],[1,"text-center","py-8"],[1,"text-red-500","text-center","py-8"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-6"],["class","card-ejemplo bg-gradient-to-br from-white via-blue-100 to-purple-100 rounded-3xl shadow-xl border border-blue-200 flex flex-col justify-between items-stretch px-6 pt-6 pb-4 h-[22.61180115rem] w-full max-w-md mx-auto transition-all duration-200 hover:scale-105",4,"ngFor","ngForOf"],[1,"card-ejemplo","bg-gradient-to-br","from-white","via-blue-100","to-purple-100","rounded-3xl","shadow-xl","border","border-blue-200","flex","flex-col","justify-between","items-stretch","px-6","pt-6","pb-4","h-[22.61180115rem]","w-full","max-w-md","mx-auto","transition-all","duration-200","hover:scale-105"],[1,"flex","flex-col","gap-2","flex-grow"],[1,"flex","items-center","mb-4","gap-2"],[1,"emoji-card","text-2xl"],[1,"text-lg","font-bold","text-gray-800","truncate"],[1,"bg-gradient-to-br","from-blue-50","via-purple-50","to-white","border-l-4","border-blue-300","shadow","rounded-xl","px-2","py-3","w-full","mb-2","overflow-auto"],[1,"text-gray-700","text-sm",2,"text-align","justify","white-space","pre-line"],[1,"flex","flex-col","items-center","mt-auto"],[1,"text-xs","text-gray-600","mb-2"],[1,"font-bold","text-blue-700"],[1,"text-gray-500"],[1,"btn-ejemplo","w-full","bg-gradient-to-r","from-blue-400","to-purple-400","text-white","font-semibold","py-2","px-4","rounded-lg","shadow","hover:from-blue-500","hover:to-purple-500","transition",3,"click"],[1,"game-section","w-full","max-w-2xl","mx-auto","flex","flex-col","items-center","justify-center","relative","gap-6"],[1,"absolute","top-0","left-0","w-full","h-full","pointer-events-none","z-0"],[1,"game-bg-gradient"],[1,"game-bg-stars"],[1,"game-card","relative","z-10","animate-pop","shadow-2xl","rounded-3xl","px-8","pt-8","pb-6","flex","flex-col","items-center","w-full",2,"background","linear-gradient(135deg, #fef9c3 0%, #e0e7ff 100%)"],[1,"flex","items-center","gap-2","mb-2"],[1,"emoji-card","text-4xl"],[1,"text-2xl","font-extrabold","text-pink-700","drop-shadow"],[1,"mb-2","text-gray-800","text-justify","text-lg","font-medium","w-full","max-w-xl"],["class","game-question-card bg-white/80 rounded-xl p-6 shadow-lg border-2 border-pink-300 animate-fade-in w-full",4,"ngIf"],[1,"game-status-card","bg-white/80","rounded-xl","px-6","py-4","shadow-lg","border-2","border-pink-300","flex","justify-between","items-center","w-full","max-w-md","animate-fade-in"],[1,"text-sm","text-pink-600","font-bold"],[1,"text-base"],[1,"text-pink-600","font-extrabold","text-lg","flex","items-center","gap-1"],[1,"emoji-card","text-xl"],[1,"game-question-card","bg-white/80","rounded-xl","p-6","shadow-lg","border-2","border-pink-300","animate-fade-in","w-full"],[1,"font-bold","text-pink-700","text-xl","mb-4","flex","items-center","gap-2"],[1,"flex","flex-wrap","gap-4","justify-center"],[1,"grid","grid-cols-2","gap-4","w-full"],[4,"ngFor","ngForOf"],["class","relative group flex justify-center col-span-2",4,"ngIf"],["class","relative group flex justify-center col-span-1",4,"ngIf"],[1,"relative","group","flex","justify-center","col-span-2"],[1,"w-full","flex","justify-center"],[1,"game-btn-choice","mx-auto","break-words","whitespace-pre-line","px-6","py-3","rounded-full","font-bold","text-lg","shadow-lg","transition","transform","hover:scale-110","hover:bg-gradient-to-r","hover:from-pink-400","hover:to-yellow-400","bg-gradient-to-r","from-pink-400","to-purple-400","text-white","border-2","border-white",3,"click"],["class","absolute left-1/2 -translate-x-1/2 top-full mt-2 z-20 px-3 py-2 rounded-lg bg-pink-700 text-white text-sm font-medium shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-pre-line min-w-[10rem] max-w-xs",3,"id",4,"ngIf"],[1,"absolute","left-1/2","-translate-x-1/2","top-full","mt-2","z-20","px-3","py-2","rounded-lg","bg-pink-700","text-white","text-sm","font-medium","shadow-lg","opacity-0","group-hover:opacity-100","transition-opacity","duration-200","pointer-events-none","whitespace-pre-line","min-w-[10rem]","max-w-xs",3,"id"],[1,"relative","group","flex","justify-center","col-span-1"],[1,"game-btn-choice","w-full","break-words","whitespace-pre-line","px-6","py-3","rounded-full","font-bold","text-lg","shadow-lg","transition","transform","hover:scale-110","hover:bg-gradient-to-r","hover:from-pink-400","hover:to-yellow-400","bg-gradient-to-r","from-pink-400","to-purple-400","text-white","border-2","border-white",3,"click"],["class","absolute left-1/2 -translate-x-1/2 top-full mt-2 z-20 px-4 py-3 rounded-lg bg-pink-700 text-white text-sm font-medium shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-pre-line min-w-[16rem] max-w-lg",3,"id",4,"ngIf"],[1,"absolute","left-1/2","-translate-x-1/2","top-full","mt-2","z-20","px-4","py-3","rounded-lg","bg-pink-700","text-white","text-sm","font-medium","shadow-lg","opacity-0","group-hover:opacity-100","transition-opacity","duration-200","pointer-events-none","whitespace-pre-line","min-w-[16rem]","max-w-lg",3,"id"],[1,"w-full","max-w-2xl","mx-auto","flex","flex-col","items-center","justify-center","relative","gap-6"],[1,"relative","z-10","animate-pop","shadow-2xl","rounded-3xl","px-8","pt-8","pb-6","flex","flex-col","items-center","w-full","mb-4",2,"background","linear-gradient(135deg, #b6c7ff 0%, #f3f4f6 100%)"],[1,"flex","items-center","gap-2","mb-4"],[1,"text-2xl","font-extrabold","text-blue-700","drop-shadow"],[1,"mb-4","text-gray-800","text-lg","font-medium","w-full","max-w-xl","text-center"],[1,"bg-gradient-to-r","from-blue-200","to-purple-200","hover:from-blue-300","hover:to-purple-300","text-gray-800","font-semibold","py-3","px-8","rounded-full","shadow-xl","transition","transform","hover:scale-105","mt-2",3,"click"],["class","card-ejercicio bg-gradient-to-br from-white via-blue-100 to-green-200 rounded-2xl shadow-xl border border-green-300 flex flex-col justify-between items-stretch px-5 pt-7 pb-5 h-[26.5335rem] w-full max-w-md mx-auto transition-all duration-200 hover:scale-105",4,"ngFor","ngForOf"],[1,"card-ejercicio","bg-gradient-to-br","from-white","via-blue-100","to-green-200","rounded-2xl","shadow-xl","border","border-green-300","flex","flex-col","justify-between","items-stretch","px-5","pt-7","pb-5","h-[26.5335rem]","w-full","max-w-md","mx-auto","transition-all","duration-200","hover:scale-105"],[2,"background","linear-gradient(135deg, #b1eef6 0%, #e0e7ff 100%)","border-left","4px solid #38b2ac","box-shadow","0 2px 8px rgba(59,130,246,0.10)","border-radius","1rem","padding","1rem 0.5rem","width","100%","margin-bottom","0.5rem","overflow","auto"],[1,"font-bold","text-yellow-700"],[1,"btn-ejercicio","w-full","bg-gradient-to-r","from-green-500","to-blue-400","text-white","font-semibold","py-2","px-4","rounded-lg","shadow","hover:from-green-600","hover:to-blue-500","transition",3,"click"],[1,"text-2xl","font-extrabold","text-purple-700","drop-shadow"],["class","game-question-card bg-white/80 rounded-xl p-6 shadow-lg border-2 border-yellow-300 animate-fade-in w-full",4,"ngIf"],[1,"game-status-card","bg-white/80","rounded-xl","px-6","py-4","shadow-lg","border-2","border-purple-300","flex","justify-between","items-center","w-full","max-w-md","animate-fade-in"],[1,"text-green-600","font-extrabold","text-lg","flex","items-center","gap-1"],[1,"game-question-card","bg-white/80","rounded-xl","p-6","shadow-lg","border-2","border-yellow-300","animate-fade-in","w-full"],[1,"font-bold","text-blue-700","text-xl","mb-4","flex","items-center","gap-2"],["class","game-btn-choice px-6 py-3 rounded-full font-bold text-lg shadow-lg transition transform hover:scale-110 hover:bg-gradient-to-r hover:from-yellow-400 hover:to-pink-400 bg-gradient-to-r from-blue-400 to-purple-400 text-white border-2 border-white",3,"click",4,"ngFor","ngForOf"],[1,"game-btn-choice","px-6","py-3","rounded-full","font-bold","text-lg","shadow-lg","transition","transform","hover:scale-110","hover:bg-gradient-to-r","hover:from-yellow-400","hover:to-pink-400","bg-gradient-to-r","from-blue-400","to-purple-400","text-white","border-2","border-white",3,"click"],[1,"relative","z-10","animate-pop","shadow-2xl","rounded-3xl","px-8","pt-8","pb-6","flex","flex-col","items-center","w-full","mb-4",2,"background","linear-gradient(135deg, #94efb5 0%, #f3f4f6 100%)"],[1,"text-2xl","font-extrabold","text-green-700","drop-shadow"],[1,"bg-gradient-to-r","from-green-200","to-blue-200","hover:from-green-300","hover:to-blue-300","text-gray-800","font-semibold","py-3","px-8","rounded-full","shadow-xl","transition","transform","hover:scale-105","mt-2",3,"click"]],template:function(c,a){1&c&&(t.YNc(0,y,6,5,"div",0),t.YNc(1,fi,6,5,"div",0)),2&c&&(t.Q6J("ngIf",1===a.tipo),t.xp6(1),t.Q6J("ngIf",2===a.tipo))},dependencies:[V.sg,V.O5],styles:['.game-card[_ngcontent-%COMP%]{box-shadow:0 12px 40px #0000002e;border-radius:2rem;background:linear-gradient(135deg,#fef9c3 0%,#e0e7ff 100%);animation:_ngcontent-%COMP%_pop .5s cubic-bezier(.17,.67,.83,.67);margin-bottom:0;width:100%;max-width:38rem}.game-question-card[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fade-in .6s;margin-bottom:0;width:100%;max-width:38rem}.game-status-card[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fade-in .6s;margin-top:0;width:100%;max-width:24rem;box-shadow:0 4px 16px #a855f71a;border-radius:1.5rem;background:rgba(255,255,255,.85)}.game-section[_ngcontent-%COMP%]{position:relative;min-height:32rem;max-width:70rem;padding-top:2rem;padding-bottom:2rem}.game-bg-gradient[_ngcontent-%COMP%]{position:absolute;inset:0;z-index:0;background:radial-gradient(circle at 60% 40%,#fbbf24 0%,#a5b4fc 60%,#fff 100%);opacity:.5}.game-bg-stars[_ngcontent-%COMP%]{position:absolute;inset:0;z-index:1;pointer-events:none}.game-bg-stars[_ngcontent-%COMP%]:before{content:"\\2728\\2728\\2728\\2728\\2728";position:absolute;top:5%;left:5%;font-size:2rem;opacity:.3}.game-bg-stars[_ngcontent-%COMP%]:after{content:"\\2b50\\fe0f\\2b50\\fe0f\\2b50\\fe0f";position:absolute;bottom:5%;right:5%;font-size:2.5rem;opacity:.2}.game-card[_ngcontent-%COMP%]{box-shadow:0 12px 40px #0000002e;border-radius:2rem;background:linear-gradient(135deg,#fef9c3 0%,#e0e7ff 100%);animation:_ngcontent-%COMP%_pop .5s cubic-bezier(.17,.67,.83,.67)}.game-question-card[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fade-in .6s}.game-btn-choice[_ngcontent-%COMP%]{cursor:pointer;font-size:1.1rem;font-weight:700;border-radius:999px;box-shadow:0 4px 16px #3b82f61a;background:linear-gradient(90deg,#60a5fa 0%,#a78bfa 100%);color:#fff;border:2px solid #fff;transition:background .2s,color .2s,transform .2s}.game-btn-choice[_ngcontent-%COMP%]:hover{background:linear-gradient(90deg,#fbbf24 0%,#f472b6 100%);color:#fff;transform:scale(1.08)}.animate-pop[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pop .5s cubic-bezier(.17,.67,.83,.67)}@keyframes _ngcontent-%COMP%_pop{0%{transform:scale(.8);opacity:0}80%{transform:scale(1.05);opacity:1}to{transform:scale(1);opacity:1}}@keyframes _ngcontent-%COMP%_fade-in{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.emoji-card[_ngcontent-%COMP%]{font-size:1.3rem;margin-right:.5rem;filter:drop-shadow(0 2px 4px rgba(0,0,0,.1))}.card-ejercicio[_ngcontent-%COMP%]   .text-xs[_ngcontent-%COMP%]{margin-bottom:.5rem}.card-ejercicio[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .card-ejercicio[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:.25rem}.card-ejercicio[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:.5rem;overflow:visible;white-space:pre-line;text-align:justify}.ejercicio-container[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .4s}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}']})}}return u})();function Vr(u,T){1&u&&(t.TgZ(0,"section",12)(1,"div",13)(2,"h2",14),t._uU(3,"\u{1f4cd} \xbfQu\xe9 es el pensamiento l\xf3gico?"),t.qZA(),t.TgZ(4,"p",15),t._uU(5,"El pensamiento l\xf3gico es la "),t.TgZ(6,"b"),t._uU(7,"capacidad"),t.qZA(),t._uU(8," de analizar un problema, dividirlo en partes m\xe1s peque\xf1as y "),t.TgZ(9,"b"),t._uU(10,"organizar esas partes"),t.qZA(),t._uU(11," de manera estructurada para "),t.TgZ(12,"b"),t._uU(13,"resolver el problema"),t.qZA(),t._uU(14," o "),t.TgZ(15,"b"),t._uU(16,"encontrar una soluci\xf3n"),t.qZA(),t._uU(17,". En programaci\xf3n, implica el proceso mental que utilizamos para indicar a la computadora qu\xe9 acciones realizar y en qu\xe9 orden deben ejecutarse, de forma clara y precisa."),t.qZA(),t.TgZ(18,"div",16)(19,"h3",17),t._uU(20,"\u{1f4e6} Met\xe1fora: El constructor de LEGO"),t.qZA(),t.TgZ(21,"p",18),t._uU(22,"Imagina que quieres construir un castillo con piezas LEGO. Para lograrlo:"),t.qZA(),t.TgZ(23,"ul",19)(24,"li"),t._uU(25,"Empiezas por revisar la "),t.TgZ(26,"b"),t._uU(27,"gu\xeda de instrucciones de construcci\xf3n"),t.qZA(),t._uU(28," (el algoritmo)."),t.qZA(),t.TgZ(29,"li"),t._uU(30,"A continuaci\xf3n, buscas las piezas necesarias ("),t.TgZ(31,"b"),t._uU(32,"los datos"),t.qZA(),t._uU(33," que usar\xe1s)."),t.qZA(),t.TgZ(34,"li"),t._uU(35,"Finalmente, unes cada pieza en el "),t.TgZ(36,"b"),t._uU(37,"orden l\xf3gico"),t.qZA(),t._uU(38," que indica la gu\xeda (la secuencia de pasos)."),t.qZA()(),t.TgZ(39,"p",18),t._uU(40,"Si omites un paso o colocas una pieza en el lugar incorrecto, el castillo "),t.TgZ(41,"b"),t._uU(42,"no tendr\xe1 la forma deseada"),t.qZA(),t._uU(43," o "),t.TgZ(44,"b"),t._uU(45,"no funcionar\xe1 como esperabas"),t.qZA(),t._uU(46,". De igual manera, en programaci\xf3n, si no sigues una l\xf3gica clara y ordenada, el programa no funcionar\xe1 correctamente. As\xed, "),t.TgZ(47,"b"),t._uU(48,"las piezas representan las instrucciones"),t.qZA(),t._uU(49,", "),t.TgZ(50,"b"),t._uU(51,"el orden es la l\xf3gica del algoritmo"),t.qZA(),t._uU(52," y "),t.TgZ(53,"b"),t._uU(54,"el resultado es la funcionalidad del programa"),t.qZA(),t._uU(55,"."),t.qZA()(),t.TgZ(56,"div",20)(57,"h2",21),t._uU(58,"\u{1f504} Pensamiento l\xf3gico y la vida real "),t.qZA(),t.TgZ(59,"ul",22)(60,"li"),t._uU(61,"Si me levanto temprano, entonces desayuno tranquilo. Si no me levanto temprano, desayuno r\xe1pido o no desayuno."),t.qZA(),t.TgZ(62,"li"),t._uU(63,"Si llueve, entonces llevo paraguas. Si no llueve, salgo sin paraguas."),t.qZA()(),t.TgZ(64,"p",18),t._uU(65,"Estos ejemplos muestran c\xf3mo en la vida cotidiana "),t.TgZ(66,"b"),t._uU(67,"seguimos una secuencia de pasos, verificamos condiciones y tomamos decisiones en funci\xf3n de los resultados"),t.qZA(),t._uU(68,". El pensamiento l\xf3gico consiste en "),t.TgZ(69,"b"),t._uU(70,"identificar los pasos necesarios, establecer las condiciones relevantes y actuar de acuerdo a ellas"),t.qZA(),t._uU(71," para resolver situaciones o problemas."),t.qZA()(),t.TgZ(72,"div",23)(73,"h2",14),t._uU(74,"\u{1f4dc} Premisas y Conclusiones"),t.qZA(),t.TgZ(75,"h3",24),t._uU(76,"\u{1f9fe} \xbfQu\xe9 es una premisa?"),t.qZA(),t.TgZ(77,"p",18),t._uU(78,"Una premisa es una "),t.TgZ(79,"b"),t._uU(80,"proposici\xf3n que se acepta como verdadera"),t.qZA(),t._uU(81," y que sirve de base para un razonamiento."),t.qZA(),t.TgZ(82,"p",18),t._uU(83,"Ejemplo:"),t._UZ(84,"br"),t._uU(85,'"Si estudio, aprobar\xe9 el examen."'),t._UZ(86,"br"),t._uU(87,"Aqu\xed se asume que "),t.TgZ(88,"b"),t._uU(89,"estudiar conduce a aprobar el examen"),t.qZA(),t._uU(90,"."),t.qZA(),t.TgZ(91,"h3",24),t._uU(92,"\u{1f3c1} \xbfQu\xe9 es una conclusi\xf3n?"),t.qZA(),t.TgZ(93,"p",18),t._uU(94,"Una conclusi\xf3n es una "),t.TgZ(95,"b"),t._uU(96,"afirmaci\xf3n que se deduce l\xf3gicamente"),t.qZA(),t._uU(97," a partir de una o m\xe1s premisas."),t.qZA(),t.TgZ(98,"p",18),t._uU(99,"Ejemplo:"),t._UZ(100,"br"),t._uU(101,'Premisa 1: "Si estudio, aprobar\xe9 el examen."'),t._UZ(102,"br"),t._uU(103,'Premisa 2: "Estudi\xe9."'),t._UZ(104,"br"),t._uU(105,'Conclusi\xf3n: "Aprobar\xe9 el examen."'),t.qZA()(),t.TgZ(106,"div",25)(107,"h2",26),t._uU(108,"\u{1f517} C\xf3mo se conectan las premisas y conclusiones"),t.qZA(),t.TgZ(109,"ul",22)(110,"li")(111,"b"),t._uU(112,"SI... ENTONCES (implicaci\xf3n):"),t.qZA(),t._uU(113," Si se cumple una condici\xf3n, entonces se deduce una consecuencia."),t._UZ(114,"br"),t.TgZ(115,"b"),t._uU(116,"Ejemplo:"),t.qZA(),t._uU(117," Si llueve, entonces llevo paraguas."),t.qZA(),t.TgZ(118,"li")(119,"b"),t._uU(120,"Y (conjunci\xf3n):"),t.qZA(),t._uU(121," Para que ocurra algo, deben cumplirse todas las condiciones."),t._UZ(122,"br"),t.TgZ(123,"b"),t._uU(124,"Ejemplo:"),t.qZA(),t._uU(125," Para que coma, es necesario tener hambre "),t.TgZ(126,"b"),t._uU(127,"y"),t.qZA(),t._uU(128," que haya comida."),t.qZA(),t.TgZ(129,"li")(130,"b"),t._uU(131,"O (disyunci\xf3n):"),t.qZA(),t._uU(132," Basta con que se cumpla al menos una condici\xf3n para que ocurra algo."),t._UZ(133,"br"),t.TgZ(134,"b"),t._uU(135,"Ejemplo:"),t.qZA(),t._uU(136," Si es s\xe1bado "),t.TgZ(137,"b"),t._uU(138,"o"),t.qZA(),t._uU(139," es domingo, entonces descanso."),t.qZA(),t.TgZ(140,"li")(141,"b"),t._uU(142,"NO (negaci\xf3n):"),t.qZA(),t._uU(143," Niega o invierte el valor l\xf3gico de una condici\xf3n."),t._UZ(144,"br"),t.TgZ(145,"b"),t._uU(146,"Ejemplo:"),t.qZA(),t._uU(147," Si "),t.TgZ(148,"b"),t._uU(149,"no"),t.qZA(),t._uU(150," est\xe1 encendido, entonces lo enciendo."),t.qZA(),t.TgZ(151,"li")(152,"b"),t._uU(153,"NO (negaci\xf3n):"),t.qZA(),t._uU(154," Niega o invierte el valor l\xf3gico de una condici\xf3n."),t._UZ(155,"br"),t.TgZ(156,"b"),t._uU(157,"Ejemplo:"),t.qZA(),t._uU(158,' "No es de d\xeda" es la negaci\xf3n de "Es de d\xeda".'),t.qZA()()(),t.TgZ(159,"div",27)(160,"h2",28),t._uU(161,"\u{1f50d} Met\xe1fora: Detectives de la l\xf3gica "),t.qZA(),t.TgZ(162,"ul",22)(163,"li"),t._uU(164,"Las premisas son las pistas que el detective encuentra durante la investigaci\xf3n."),t.qZA(),t.TgZ(165,"li"),t._uU(166,"La conclusi\xf3n l\xf3gica es la deducci\xf3n final que obtiene al juntar esas pistas."),t.qZA(),t.TgZ(167,"li"),t._uU(168,"Si alguna pista (premisa) es falsa, la deducci\xf3n puede ser incorrecta, aunque a veces, por casualidad, la conclusi\xf3n resulte verdadera. Por eso, en l\xf3gica, la validez depende de la veracidad de las premisas y del razonamiento."),t.qZA()()(),t.TgZ(169,"div",16)(170,"h2",29),t._uU(171,"\u{1f9e9} Elementos clave del pensamiento l\xf3gico"),t.qZA(),t.TgZ(172,"ul",22)(173,"li")(174,"b"),t._uU(175,"Observar con atenci\xf3n"),t.qZA(),t._uU(176," para identificar qu\xe9 est\xe1 ocurriendo o qu\xe9 se necesita resolver."),t.qZA(),t.TgZ(177,"li")(178,"b"),t._uU(179,"Analizar"),t.qZA(),t._uU(180," separando el problema en partes m\xe1s peque\xf1as y comprensibles."),t.qZA(),t.TgZ(181,"li")(182,"b"),t._uU(183,"Organizar las acciones en secuencias"),t.qZA(),t._uU(184,", es decir, en un orden l\xf3gico o cronol\xf3gico paso a paso para alcanzar un resultado."),t.qZA(),t.TgZ(185,"li")(186,"b"),t._uU(187,"Establecer condiciones"),t.qZA(),t._uU(188," mediante reglas l\xf3gicas que determinan qu\xe9 hacer en funci\xf3n de cada situaci\xf3n."),t.qZA(),t.TgZ(189,"li")(190,"b"),t._uU(191,"Repetir acciones"),t.qZA(),t._uU(192," hasta que se cumpla un objetivo o condici\xf3n deseada."),t.qZA(),t.TgZ(193,"li")(194,"b"),t._uU(195,"Optimizar"),t.qZA(),t._uU(196," buscando la forma m\xe1s eficiente (r\xe1pida y sencilla) de resolver un problema."),t.qZA()()()()())}function bt(u,T){1&u&&(t.TgZ(0,"section",12),t._UZ(1,"app-game-question-selection",30),t.qZA()),2&u&&(t.xp6(1),t.Q6J("tipo",1))}function us(u,T){1&u&&(t.TgZ(0,"section",12),t._UZ(1,"app-game-question-selection",30),t.qZA()),2&u&&(t.xp6(1),t.Q6J("tipo",2))}const fo=function(u){return{"button-with-point":u}};let Hc=(()=>{class u{constructor(){this.selectedSection=1}static{this.\u0275fac=function(c){return new(c||u)}}static{this.\u0275cmp=t.Xpm({type:u,selectors:[["app-pensamiento-logico"]],decls:23,vars:24,consts:[[1,"text-center","mb-6","mt-6"],[1,"text-3xl","font-bold","text-gray-800","mb-2","drop-shadow-md"],[1,"flex","items-center","justify-center","mb-1"],[1,"h-0.5","bg-gradient-to-r","from-transparent","via-[#facc15]","to-transparent","w-96","shadow-sm"],[1,"flex","items-center","justify-center"],[1,"h-px","bg-gradient-to-r","from-transparent","via-gray-300","to-transparent","w-64","opacity-60"],[1,"flex","flex-col","items-center","mb-6"],[1,"sticky","top-0","z-20","w-auto","flex","justify-center","bg-transparent","backdrop-blur-md","py-2","rounded-xl"],[1,"flex","gap-72"],[1,"relative","px-4","py-2","rounded-lg","font-semibold","text-gray-700","hover:text-[#facc15]","transition",3,"ngClass","click"],[1,"flex","flex-col","gap-6","items-center","w-full","px-2","md:px-0"],["class","bg-gray-500/20 backdrop-blur-md p-8 rounded-lg border border-gray-400/30 shadow-lg w-full max-w-7xl mt-2 mb-8",4,"ngIf"],[1,"bg-gray-500/20","backdrop-blur-md","p-8","rounded-lg","border","border-gray-400/30","shadow-lg","w-full","max-w-7xl","mt-2","mb-8"],[1,"flex","flex-col","gap-6","mb-8","justify-start","items-start"],[1,"text-xl","font-bold","text-yellow-600","mb-2","flex","items-center","gap-2"],[1,"text-gray-800","ml-8"],[1,"bg-gradient-to-br","from-blue-100","via-blue-50","to-white","border-l-4","border-blue-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"text-lg","font-semibold","text-gray-700","mt-4","mb-2","flex","items-center","gap-2"],[1,"text-gray-700"],[1,"list-disc","pl-6","text-gray-700","mb-2"],[1,"bg-gradient-to-br","from-green-100","via-green-50","to-white","border-l-4","border-green-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"text-xl","font-bold","text-green-600","mb-2","flex","items-center","gap-2"],[1,"list-disc","ml-6","text-gray-800","mb-2"],[1,"bg-gradient-to-br","from-yellow-100","via-yellow-50","to-white","border-l-4","border-yellow-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"font-semibold","text-yellow-700"],[1,"bg-gradient-to-br","from-purple-100","via-purple-50","to-white","border-l-4","border-purple-400","shadow-lg","rounded-xl","p-6","w-full","mt-2","mb-2"],[1,"text-xl","font-bold","text-purple-600","mb-2","flex","items-center","gap-2"],[1,"bg-gradient-to-br","from-pink-100","via-pink-50","to-white","border-l-4","border-pink-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"text-xl","font-bold","text-pink-600","mb-2","flex","items-center","gap-2"],[1,"text-xl","font-bold","text-blue-600","mb-2","flex","items-center","gap-2"],[3,"tipo"]],template:function(c,a){1&c&&(t.TgZ(0,"div",0)(1,"h1",1),t._uU(2,"\u{1f4a1} Pensamiento L\xf3gico en Programaci\xf3n"),t.qZA(),t.TgZ(3,"div",2),t._UZ(4,"div",3),t.qZA(),t.TgZ(5,"div",4),t._UZ(6,"div",5),t.qZA()(),t.TgZ(7,"div",6)(8,"nav",7)(9,"ul",8)(10,"li")(11,"button",9),t.NdJ("click",function(){return a.selectedSection=1}),t._uU(12," Teor\xeda "),t.qZA()(),t.TgZ(13,"li")(14,"button",9),t.NdJ("click",function(){return a.selectedSection=2}),t._uU(15," Ejemplos "),t.qZA()(),t.TgZ(16,"li")(17,"button",9),t.NdJ("click",function(){return a.selectedSection=3}),t._uU(18," Ejercicios "),t.qZA()()()()(),t.TgZ(19,"div",10),t.YNc(20,Vr,197,0,"section",11),t.YNc(21,bt,2,1,"section",11),t.YNc(22,us,2,1,"section",11),t.qZA()),2&c&&(t.xp6(11),t.ekj("border-b-4",1===a.selectedSection)("border-blue-500",1===a.selectedSection),t.Q6J("ngClass",t.VKq(18,fo,1===a.selectedSection)),t.xp6(3),t.ekj("border-b-4",2===a.selectedSection)("border-blue-500",2===a.selectedSection),t.Q6J("ngClass",t.VKq(20,fo,2===a.selectedSection)),t.xp6(3),t.ekj("border-b-4",3===a.selectedSection)("border-blue-500",3===a.selectedSection),t.Q6J("ngClass",t.VKq(22,fo,3===a.selectedSection)),t.xp6(3),t.Q6J("ngIf",1===a.selectedSection),t.xp6(1),t.Q6J("ngIf",2===a.selectedSection),t.xp6(1),t.Q6J("ngIf",3===a.selectedSection))},dependencies:[V.mk,V.O5,Gr],styles:[".button-with-point[_ngcontent-%COMP%]{border-bottom-width:4px!important;border-bottom-color:#facc15!important}"]})}}return u})();function To(u,T){1&u&&(t.O4$(),t._UZ(0,"path",40))}function ds(u,T){1&u&&(t.O4$(),t._UZ(0,"path",41))}function Cn(u,T){1&u&&(t.O4$(),t._UZ(0,"path",42))}function Eo(u,T){if(1&u){const r=t.EpF();t.TgZ(0,"div",45)(1,"div",46)(2,"div",47),t.O4$(),t.TgZ(3,"svg",48),t._UZ(4,"circle",49)(5,"path",50),t.qZA()(),t.kcU(),t.TgZ(6,"div",51)(7,"span",52),t._uU(8,"\xbfQuieres ver la explicaci\xf3n paso a paso?"),t.qZA(),t.TgZ(9,"p",53),t._uU(10,"Puedes ver c\xf3mo se resuelve este ejemplo bloque por bloque."),t.qZA()(),t.TgZ(11,"div",13)(12,"button",54),t.NdJ("click",function(){t.CHM(r);const a=t.oxw(4);return t.KtG(a.setShowSteps(!0))}),t.O4$(),t.TgZ(13,"svg",55),t._UZ(14,"path",38),t.qZA()(),t.kcU(),t.TgZ(15,"div",56),t._uU(16," Mostrar explicaci\xf3n paso a paso "),t.qZA()()()()}}function hs(u,T){if(1&u){const r=t.EpF();t.TgZ(0,"div",57)(1,"div",21)(2,"div",58)(3,"div",59),t._uU(4," \u{1f463} "),t.qZA(),t.TgZ(5,"div",56),t._uU(6," Ver pasos "),t.qZA()(),t.TgZ(7,"h2",60),t._uU(8,"Explicaci\xf3n paso a paso"),t.qZA()(),t.TgZ(9,"div")(10,"div",29)(11,"h3",30),t._uU(12,"\u{1f4cb} Instrucciones:"),t.qZA(),t.TgZ(13,"p",31),t._uU(14),t.qZA()(),t._UZ(15,"div",32),t.TgZ(16,"div",61)(17,"button",34),t.NdJ("click",function(){t.CHM(r);const a=t.oxw(4);return t.KtG(a.previousStep())}),t.O4$(),t.TgZ(18,"svg",23),t._UZ(19,"path",35),t.qZA()(),t.kcU(),t.TgZ(20,"span",36),t._uU(21),t.qZA(),t.TgZ(22,"button",37),t.NdJ("click",function(){t.CHM(r);const a=t.oxw(4);return t.KtG(a.nextStep())}),t.O4$(),t.TgZ(23,"svg",23),t._UZ(24,"path",38),t.qZA()()()()()}if(2&u){const r=t.oxw(4);t.xp6(14),t.Oqu(null==r.currentStep?null:r.currentStep.description),t.xp6(3),t.Udp("background-color",r.canGoPreviousStep?"#f3ae22":"")("border-color",r.canGoPreviousStep?"#d18c00":""),t.ekj("opacity-50",!r.canGoPreviousStep)("cursor-not-allowed",!r.canGoPreviousStep),t.Q6J("disabled",!r.canGoPreviousStep),t.xp6(4),t.AsE(" Paso ",r.stepIndex+1," de ",r.currentExample.explanation.length," "),t.xp6(1),t.ekj("opacity-50",!r.canGoNextStep)("cursor-not-allowed",!r.canGoNextStep),t.Q6J("disabled",!r.canGoNextStep)}}function Gc(u,T){if(1&u&&(t.ynx(0),t.YNc(1,Eo,17,0,"div",43),t.YNc(2,hs,25,17,"div",44),t.BQk()),2&u){const r=t.oxw(3);t.xp6(1),t.Q6J("ngIf",!r.showSteps),t.xp6(1),t.Q6J("ngIf",r.showSteps)}}function kn(u,T){if(1&u){const r=t.EpF();t.TgZ(0,"div",19)(1,"div",20)(2,"div",21)(3,"div",13)(4,"div",22),t.O4$(),t.TgZ(5,"svg",23),t.YNc(6,To,1,0,"path",24),t.YNc(7,ds,1,0,"path",25),t.YNc(8,Cn,1,0,"path",26),t.qZA()(),t.kcU(),t.TgZ(9,"div",27),t._uU(10),t.qZA()(),t.TgZ(11,"h2",28),t._uU(12),t.qZA()(),t.TgZ(13,"div",29)(14,"h3",30),t._uU(15,"\u{1f4cb} Instrucciones:"),t.qZA(),t.TgZ(16,"p",31),t._uU(17),t.qZA()(),t._UZ(18,"div",32),t.TgZ(19,"div",33)(20,"button",34),t.NdJ("click",function(){t.CHM(r);const a=t.oxw(2);return t.KtG(a.onPreviousExercise())}),t.O4$(),t.TgZ(21,"svg",23),t._UZ(22,"path",35),t.qZA()(),t.kcU(),t.TgZ(23,"span",36),t._uU(24),t.qZA(),t.TgZ(25,"button",37),t.NdJ("click",function(){t.CHM(r);const a=t.oxw(2);return t.KtG(a.onNextExercise())}),t.O4$(),t.TgZ(26,"svg",23),t._UZ(27,"path",38),t.qZA()()()(),t.kcU(),t.TgZ(28,"div",39),t.YNc(29,Gc,3,2,"ng-container",9),t.qZA()()}if(2&u){const r=t.oxw(2);t.xp6(4),t.Udp("background-color",r.getDifficultyColor(r.currentDifficulty))("border-color",r.getDifficultyBorderColor(r.currentDifficulty)),t.xp6(2),t.Q6J("ngIf","easy"===r.currentDifficulty),t.xp6(1),t.Q6J("ngIf","medium"===r.currentDifficulty),t.xp6(1),t.Q6J("ngIf","hard"===r.currentDifficulty),t.xp6(2),t.hij(" ",r.getDifficultyText(r.currentDifficulty)," "),t.xp6(2),t.Oqu(null==r.currentExample?null:r.currentExample.title),t.xp6(5),t.Oqu(null==r.currentExample?null:r.currentExample.description),t.xp6(3),t.Udp("background-color",r.currentExampleIndex>0?"#f3ae22":"")("border-color",r.currentExampleIndex>0?"#d18c00":""),t.ekj("opacity-50",0===r.currentExampleIndex)("cursor-not-allowed",0===r.currentExampleIndex),t.Q6J("disabled",0===r.currentExampleIndex),t.xp6(4),t.AsE(" ",r.currentExampleIndex+1," de ",r.examples.length," "),t.xp6(1),t.ekj("opacity-50",r.currentExampleIndex===r.examples.length-1)("cursor-not-allowed",r.currentExampleIndex===r.examples.length-1),t.Q6J("disabled",r.currentExampleIndex===r.examples.length-1),t.xp6(4),t.Q6J("ngIf",(null==r.currentExample?null:r.currentExample.explanation)&&(null==r.currentExample?null:r.currentExample.explanation.length)>0)}}function Vc(u,T){if(1&u){const r=t.EpF();t.TgZ(0,"div",62),t.NdJ("dragstart",function(a){const f=t.CHM(r).$implicit,S=t.oxw(2);return t.KtG(S.onDragStart(a,f))})("drop",function(a){t.CHM(r);const g=t.oxw(2);return t.KtG(g.onDropToDrag(a))})("dragover",function(a){return a.preventDefault()}),t._uU(1),t.qZA()}if(2&u){const r=T.$implicit;t.xp6(1),t.hij(" ",r.text," ")}}function ps(u,T){if(1&u&&(t.TgZ(0,"div",68)(1,"div",69)(2,"div",70)(3,"span",71),t._uU(4),t.qZA()(),t.TgZ(5,"span",72),t._uU(6,"Este bloque es parte de la respuesta correcta"),t.qZA()()()),2&u){const r=t.oxw(3);t.xp6(2),t.Tol(4===r.n?"cellblock small":"cellblock"),t.xp6(2),t.Oqu(r.suggestedBlock.text)}}function ft(u,T){if(1&u){const r=t.EpF();t.ynx(0),t.TgZ(1,"div",63)(2,"div",64),t.NdJ("mouseenter",function(){t.CHM(r);const a=t.oxw(2);return a.suggestMissingBlock(),t.KtG(a.showSuggestionToast=!0)})("mouseleave",function(){t.CHM(r);const a=t.oxw(2);return t.KtG(a.showSuggestionToast=!1)}),t.TgZ(3,"button",65),t._uU(4," \u{1f4a1} "),t.qZA(),t.TgZ(5,"div",66),t._uU(6," Sugerencia "),t.qZA(),t.YNc(7,ps,7,3,"div",67),t.qZA()(),t.BQk()}if(2&u){const r=t.oxw(2);t.xp6(7),t.Q6J("ngIf",r.showSuggestionToast&&r.suggestedBlock)}}function Dt(u,T){1&u&&(t.ynx(0),t.O4$(),t.TgZ(1,"svg",76),t._UZ(2,"path",77),t.qZA(),t.BQk())}const qr=function(u){return{fontSize:u}};function gs(u,T){if(1&u&&(t.ynx(0),t.TgZ(1,"div",78),t._uU(2),t.qZA(),t.BQk()),2&u){const r=t.oxw().$implicit,c=t.oxw(3);t.xp6(1),t.Q6J("ngStyle",t.VKq(2,qr,4===c.n?"0.8rem":"1.1rem")),t.xp6(1),t.hij(" ",(null==r?null:r.text)||r," ")}}const qc=function(){return{width:"113px",height:"113px"}},Wr=function(){return{width:"160px",height:"160px"}};function Lt(u,T){if(1&u){const r=t.EpF();t.TgZ(0,"div",75),t.NdJ("drop",function(a){const f=t.CHM(r).index,S=t.oxw().index,Z=t.oxw(2);return t.KtG(Z.onDrop(a,S,f))})("dragover",function(a){return a.preventDefault()})("dragstart",function(a){const g=t.CHM(r),f=g.$implicit,S=g.index,Z=t.oxw().index,he=t.oxw(2);return t.KtG(f?he.onDragStart(a,f,Z,S):null)}),t.YNc(1,Dt,3,0,"ng-container",9),t.YNc(2,gs,3,4,"ng-container",9),t.qZA()}if(2&u){const r=T.$implicit,c=t.oxw(3);t.Q6J("ngClass",r?"cellblock":"cell")("ngStyle",4===c.n?t.DdM(5,qc):t.DdM(6,Wr))("draggable",!!r),t.xp6(1),t.Q6J("ngIf",!r),t.xp6(1),t.Q6J("ngIf",r)}}function vo(u,T){if(1&u&&(t.TgZ(0,"div")(1,"div",73),t.YNc(2,Lt,3,7,"div",74),t.qZA()()),2&u){const r=T.$implicit;t.xp6(2),t.Q6J("ngForOf",r)}}function zr(u,T){if(1&u&&(t.TgZ(0,"div",79)(1,"div",80)(2,"div",81),t.O4$(),t.TgZ(3,"svg",82),t._UZ(4,"path",83),t.qZA(),t.kcU(),t.TgZ(5,"div")(6,"p",84),t._uU(7,"\xa1Perfecto!"),t.qZA(),t.TgZ(8,"p",85),t._uU(9),t.qZA()()()()()),2&u){const r=t.oxw(2);t.xp6(9),t.Oqu(r.currentMessage)}}function jr(u,T){if(1&u&&(t.TgZ(0,"div",79)(1,"div",86)(2,"div",81),t.O4$(),t.TgZ(3,"svg",82),t._UZ(4,"path",87),t.qZA(),t.kcU(),t.TgZ(5,"div")(6,"p",84),t._uU(7,"Int\xe9ntalo de nuevo"),t.qZA(),t.TgZ(8,"p",85),t._uU(9),t.qZA()()()()()),2&u){const r=t.oxw(2);t.xp6(9),t.Oqu(r.currentMessage)}}const Yr=function(u){return{"grid-template-columns":u,"justify-content":"center",margin:"0 auto",width:"max-content"}};function Xr(u,T){if(1&u){const r=t.EpF();t.TgZ(0,"div",1),t.YNc(1,kn,30,27,"div",2),t.TgZ(2,"div",3)(3,"div",4)(4,"h3",5)(5,"b"),t._uU(6,"Tomar Bloques"),t.qZA()(),t.TgZ(7,"div",6),t.YNc(8,Vc,2,1,"div",7),t.qZA()(),t.TgZ(9,"div",8)(10,"h3",5)(11,"b"),t._uU(12,"Soltar Bloques"),t.qZA()(),t.YNc(13,ft,8,1,"ng-container",9),t.TgZ(14,"div",10),t.YNc(15,vo,3,1,"div",11),t.qZA()()(),t.TgZ(16,"div",12)(17,"div",13)(18,"button",14),t.NdJ("click",function(){t.CHM(r);const a=t.oxw();return a.showValidationModal=!0,t.KtG(a.onValidatePuzzle())}),t.O4$(),t.TgZ(19,"svg",15),t._UZ(20,"path",16),t.qZA()(),t.kcU(),t.TgZ(21,"div",17),t._uU(22," Validar ejercicio "),t.qZA()()(),t.YNc(23,zr,10,1,"div",18),t.YNc(24,jr,10,1,"div",18),t.qZA()}if(2&u){const r=t.oxw();t.xp6(1),t.Q6J("ngIf",r.examples&&r.examples.length>0),t.xp6(7),t.Q6J("ngForOf",r.blocks),t.xp6(5),t.Q6J("ngIf",r.isExercise),t.xp6(1),t.Q6J("ngStyle",t.VKq(7,Yr,"repeat("+r.n+", 1fr)")),t.xp6(1),t.Q6J("ngForOf",r.dropMatrix),t.xp6(8),t.Q6J("ngIf",r.showSuccess),t.xp6(1),t.Q6J("ngIf",r.showError)}}let ms=(()=>{class u{constructor(){this.showSuggestionToast=!1,this.suggestedBlock=null,this.showSuccess=!1,this.showError=!1,this.currentMessage="",this.showValidationModal=!1,this.showSteps=!1,this.n=3,this.description="",this.blocks=[],this.currentExampleIndex=0,this.examples=[],this.validationResult="",this.previousExample=new t.vpe,this.nextExample=new t.vpe,this.isExercise=!1,this.stepIndex=0,this.validatePuzzle=new t.vpe,this.blocksChange=new t.vpe,this.dropMatrix=[],this.dragSource=null}get currentStep(){return this.currentExample?.explanation&&this.currentExample.explanation.length>0?this.currentExample.explanation[this.stepIndex]:null}get canGoPreviousStep(){return this.stepIndex>0}get canGoNextStep(){return this.currentExample?.explanation&&this.stepIndex<this.currentExample.explanation.length-1}previousStep(){if(this.canGoPreviousStep){const r=this.stepIndex,c=Math.floor(r/this.n),a=r%this.n,g=this.dropMatrix[c][a];g&&(this.blocks.push(g),this.dropMatrix[c][a]=null,this.blocks=[...this.blocks]),this.stepIndex--}}nextStep(){if(this.canGoNextStep&&(this.stepIndex++,this.currentExample?.explanation&&this.currentExample?.answer&&Array.isArray(this.currentExample.answer)&&void 0!==this.currentExample.explanation[this.stepIndex]?.blockId_answer)){const r=this.currentExample.explanation[this.stepIndex].blockId_answer,a=(this.currentExample.answer.find(Z=>Z.blockId===r),this.blocks.find(Z=>Z.id===r)),g=Math.floor(this.stepIndex/this.n),f=this.stepIndex%this.n,S=this.dropMatrix[g][f];S&&S.id!==r&&(this.blocks.push(S),this.dropMatrix[g][f]=null),a&&(this.dropMatrix[g][f]=a,this.blocks=this.blocks.filter(Z=>Z.id!==r),this.blocks=[...this.blocks])}}ngOnChanges(){this.stepIndex=0}ngOnInit(){let c=Math.sqrt(this.currentExample?.answer?.length||9);this.n=Number.isInteger(c)&&c>1?c:3,this.dropMatrix=Array.from({length:this.n},()=>Array(this.n).fill(null)),(!this.examples||0===this.examples.length)&&(this.blocks=this.blocks&&this.blocks.length>0?[...this.blocks]:Array.from({length:this.n*this.n},(a,g)=>({id:g+1,text:`Bloque ${g+1}`})))}onDrop(r,c,a){const g=r.dataTransfer.getData("text");if(this.dragSource&&"matrix"===this.dragSource.type){const f=this.dragSource.row,S=this.dragSource.col,Z=this.dropMatrix[c][a];this.dropMatrix[c][a]=this.dropMatrix[f][S],this.dropMatrix[f][S]=Z}else if(this.dragSource&&"block"===this.dragSource.type){const f=this.blocks.find(S=>S.text===g);if(f)if(this.dropMatrix[c][a]){const S=this.dropMatrix[c][a];this.dropMatrix[c][a]=f,this.blocks=this.blocks.filter(Z=>Z.text!==g),this.blocks.push(S)}else this.dropMatrix[c][a]=f,this.blocks=this.blocks.filter(S=>S.text!==g)}this.dragSource=null}onDropToDrag(r){const c=r.dataTransfer.getData("text");for(let a=0;a<this.n;a++)for(let g=0;g<this.n;g++){const f=this.dropMatrix[a][g];if(f&&f.text===c){this.blocks.push(f),this.dropMatrix[a][g]=null,this.blocksChange.emit(this.blocks);break}}this.dragSource=null}onDragStart(r,c,a,g){r.dataTransfer.setData("text",c.text),this.dragSource=void 0!==a&&void 0!==g?{type:"matrix",row:a,col:g,value:c.text}:{type:"block",value:c.text}}onPreviousExercise(){this.showSteps=!1,this.stepIndex=0,this.previousExample.emit()}onNextExercise(){this.showSteps=!1,this.stepIndex=0,this.nextExample.emit()}onValidatePuzzle(){let r=[];for(let f=0;f<this.n;f++)for(let S=0;S<this.n;S++){const Z=this.dropMatrix[f][S];Z&&void 0!==Z.id&&r.push(Z.id)}const c=(this.currentExample?.answer||[]).map(f=>f.blockId);r.sort((f,S)=>f-S);const a=[...c].sort((f,S)=>f-S),g=r.length===a.length&&r.every((f,S)=>f===a[S]);this.validationResult=g?"correcto":"incorrecto",g?(this.showSuccess=!0,this.currentMessage="\xa1Excelente! Has completado el ejercicio correctamente. \u{1f389}",setTimeout(()=>{this.showSuccess=!1},2500)):(this.showError=!0,this.currentMessage="La soluci\xf3n no es correcta. Revisa las instrucciones e int\xe9ntalo de nuevo. \u{1f4aa}",setTimeout(()=>{this.showError=!1},2500)),this.validatePuzzle.emit()}get canGoPrevious(){return this.currentExampleIndex>0}get canGoNext(){return this.currentExampleIndex<this.examples.length-1}get currentTitle(){return this.currentExample?.title||""}get currentDescription(){return this.currentExample?.description||""}get currentInstructions(){return this.currentExample?.instructions||""}get currentDifficulty(){return this.currentExample?.difficulty||"easy"}getDifficultyColor(r){return"easy"===r?"#4ade80":"medium"===r?"#fbbf24":"hard"===r?"#ef4444":"#a3a3a3"}getDifficultyBorderColor(r){return"easy"===r?"#22c55e":"medium"===r?"#d97706":"hard"===r?"#b91c1c":"#737373"}getDifficultyText(r){return"easy"===r?"F\xe1cil":"medium"===r?"Intermedio":"hard"===r?"Dif\xedcil":"Desconocido"}setShowSteps(r){if(this.showSteps=r,r){this.stepIndex=0;let c=[];for(let a=0;a<this.n;a++)for(let g=0;g<this.n;g++)this.dropMatrix[a][g]&&(c.push(this.dropMatrix[a][g]),this.dropMatrix[a][g]=null);if(this.blocks=[...this.blocks,...c],this.currentExample?.answer&&Array.isArray(this.currentExample.answer)&&this.currentExample.answer.length>0){const a=this.currentExample.answer[0],g=void 0!==a.blockId?a.blockId:a,f=this.blocks.find(S=>S.id===g);if(f){const S=Math.floor(0/this.n);this.dropMatrix[S][0%this.n]=f,this.blocks=this.blocks.filter(he=>he.id!==g),this.blocks=[...this.blocks]}}}}suggestMissingBlock(){if(!this.currentExample?.answer||!Array.isArray(this.currentExample.answer))return void(this.suggestedBlock=null);const r=this.dropMatrix.flat().filter(g=>null!==g).map(g=>g.text),c=this.currentExample.answer.filter(g=>!r.includes(g.text));if(0===c.length)return void(this.suggestedBlock=null);const a=Math.floor(Math.random()*c.length);this.suggestedBlock=c[a]}static{this.\u0275fac=function(c){return new(c||u)}}static{this.\u0275cmp=t.Xpm({type:u,selectors:[["app-puzzle"]],inputs:{n:"n",description:"description",blocks:"blocks",currentExample:"currentExample",currentExampleIndex:"currentExampleIndex",examples:"examples",validationResult:"validationResult",isExercise:"isExercise"},outputs:{previousExample:"previousExample",nextExample:"nextExample",validatePuzzle:"validatePuzzle",blocksChange:"blocksChange"},features:[t.TTD],decls:1,vars:1,consts:[["class","w-full",4,"ngIf"],[1,"w-full"],["class","w-full flex flex-row items-start mt-2 gap-8",4,"ngIf"],[1,"flex","flex-row","gap-8","items-start","w-full","mb-6"],[1,"drag-box","w-1/2"],[1,"mb-2","text-center"],[1,"blocks","grid","grid-cols-4","gap-2",2,"display","grid","grid-template-columns","repeat(4, 1fr)","justify-content","center","width","100%","max-width","460px","margin","0 auto"],["class","block","draggable","true","style","width:110px;height:100px;display:flex;align-items:center;justify-content:center;text-align:center;font-size:0.85rem;color:#333;font-weight:500;overflow-wrap:break-word;word-break:break-word;white-space:pre-line;line-height:1.1;padding:0;",3,"dragstart","drop","dragover",4,"ngFor","ngForOf"],[1,"drop-box","w-1/2",2,"position","relative"],[4,"ngIf"],[1,"matrix","mt-[1002px]","grid","gap-x-2",2,"position","relative",3,"ngStyle"],[4,"ngFor","ngForOf"],[1,"w-full","flex","justify-end","mt-6"],[1,"relative","group"],["aria-label","Validar ejercicio",1,"w-12","h-12","bg-green-600","hover:bg-green-700","text-white","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border-2","border-green-800",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 13l4 4L19 7"],[1,"absolute","right-0","top-full","mt-2","bg-gray-800","text-white","text-xs","rounded","py-1","px-2","opacity-0","group-hover:opacity-100","transition-opacity","duration-200","whitespace-nowrap","z-10"],["class","fixed inset-0 z-[9999] flex items-center justify-center bg-black bg-opacity-50",4,"ngIf"],[1,"w-full","flex","flex-row","items-start","mt-2","gap-8"],[1,"px-4","py-3","max-w-xl","flex-shrink-0"],[1,"flex","items-center","space-x-3","mb-2"],[1,"w-8","h-8","text-white","rounded-full","shadow-lg","flex","items-center","justify-center","border-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 10V3L4 14h7v7l9-11h-7z",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17.657 18.657A8 8 0 016.343 7.343S7 9 9 10c0-2 .5-5 2.986-7C14 5 16.09 5.777 17.656 7.343A7.975 7.975 0 0120 13a7.975 7.975 0 01-2.343 5.657z",4,"ngIf"],[1,"absolute","left-1/2","transform","-translate-x-1/2","-top-8","bg-gray-800","text-white","text-xs","rounded","py-1","px-2","opacity-0","group-hover:opacity-100","transition-opacity","duration-200","whitespace-nowrap","z-10"],[1,"text-xl","font-bold","text-gray-800"],[1,"bg-blue-50","border-l-4","border-blue-400","p-2","rounded-r-lg","mb-4"],[1,"font-semibold","text-blue-800","mb-1","text-sm"],[1,"text-blue-700","text-sm","text-justify"],[1,"border-t","border-gray-200","w-full"],[1,"flex","justify-between","items-center","pt-4"],[1,"w-10","h-10","text-white","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border-2","disabled:bg-gray-400","disabled:border-gray-300","disabled:hover:bg-gray-400",3,"disabled","click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[1,"text-sm","text-green-600","font-bold"],[1,"w-10","h-10","bg-blue-600","hover:bg-blue-700","text-white","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border-2","border-blue-800","disabled:bg-gray-400","disabled:border-gray-300","disabled:hover:bg-gray-400",3,"disabled","click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],[1,"flex-1","flex","flex-col","items-center","justify-center"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 10V3L4 14h7v7l9-11h-7z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17.657 18.657A8 8 0 016.343 7.343S7 9 9 10c0-2 .5-5 2.986-7C14 5 16.09 5.777 17.656 7.343A7.975 7.975 0 0120 13a7.975 7.975 0 01-2.343 5.657z"],["class","mx-auto",4,"ngIf"],["class","px-4 py-3 w-full max-w-xl",4,"ngIf"],[1,"mx-auto"],[1,"rounded-xl","shadow-lg","p-4","flex","flex-col","items-center","justify-center","bg-gradient-to-br","from-blue-100","via-blue-50","to-white","border","border-blue-300",2,"width","220px","height","220px"],[1,"mb-2","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-10","h-10","text-blue-400"],["cx","12","cy","12","r","10","stroke-width","2","stroke","currentColor","fill","#e3f2fd"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01"],[1,"text-center","mb-3"],[1,"text-blue-700","font-semibold","text-base"],[1,"text-gray-600","text-xs","mt-1"],["aria-label","Ver pasos",1,"w-10","h-10","bg-blue-600","hover:bg-blue-700","text-white","rounded-full","shadow-lg","flex","items-center","justify-center","border-2","border-blue-800","transition-all","duration-300","ease-in-out",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],[1,"absolute","left-1/2","transform","-translate-x-1/2","-top-10","bg-gray-800","text-white","text-xs","rounded","py-1","px-2","opacity-0","group-hover:opacity-100","transition-opacity","duration-200","whitespace-nowrap","z-10"],[1,"px-4","py-3","w-full","max-w-xl"],[1,"relative","group","flex","items-center"],[1,"w-8","h-8","bg-blue-200","text-blue-700","rounded-full","shadow-lg","flex","items-center","justify-center","border-2","border-blue-400","text-base"],[1,"text-xl","font-bold","text-black","mb-0","flex","items-center"],[1,"flex","justify-between","items-center","pt-2"],["draggable","true",1,"block",2,"width","110px","height","100px","display","flex","align-items","center","justify-content","center","text-align","center","font-size","0.85rem","color","#333","font-weight","500","overflow-wrap","break-word","word-break","break-word","white-space","pre-line","line-height","1.1","padding","0",3,"dragstart","drop","dragover"],[1,"absolute",2,"top","-50px","right","24px","z-index","20"],[1,"relative","group",3,"mouseenter","mouseleave"],["type","button","tabindex","-1",1,"w-10","h-10","bg-yellow-400","hover:bg-yellow-500","text-white","rounded-full","shadow-lg","flex","items-center","justify-center","border-2","border-yellow-600","transition-all","duration-300","ease-in-out","text-2xl"],[1,"absolute","-right-4","mt-2","bg-gray-800","text-white","text-xs","rounded","py-1","px-2","opacity-0","group-hover:opacity-100","transition-opacity","duration-200","whitespace-nowrap","z-10"],["class","absolute z-30 flex flex-col items-start","style","bottom:43px; left:-180px;",4,"ngIf"],[1,"absolute","z-30","flex","flex-col","items-start",2,"bottom","43px","left","-180px"],[1,"bg-white","rounded-xl","shadow-lg","border","border-blue-400","p-4","flex","flex-col","items-center","justify-center","min-w-[180px]","max-w-xs","animate-fade-in"],[1,"text-center","flex","items-center","justify-center"],[1,"w-full","text-center"],[1,"text-yellow-700","text-xs","mt-2","w-full","text-center"],[1,"flex","flex-row",2,"gap","8px","margin-bottom","0"],[3,"ngClass","ngStyle","draggable","drop","dragover","dragstart",4,"ngFor","ngForOf"],[3,"ngClass","ngStyle","draggable","drop","dragover","dragstart"],["width","80","height","80","viewBox","0 0 80 80"],["d","M7,7 Q7,40 40,40 Q73,40 73,7 Q40,7 40,40 Q40,73 7,73 Q7,40 40,40 Q73,40 73,73 Q40,73 40,40 Q7,40 7,7 Z","fill","#fafafa","stroke","#90caf9","stroke-width","3"],[2,"width","100%","height","100%","display","flex","align-items","center","justify-content","center","text-align","center","color","#333",3,"ngStyle"],[1,"fixed","inset-0","z-[9999]","flex","items-center","justify-center","bg-black","bg-opacity-50"],[1,"bg-green-500","text-white","px-8","py-6","rounded-xl","shadow-2xl","transform","transition-all","duration-500","ease-in-out","max-w-md","mx-4"],[1,"flex","items-center","space-x-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","flex-shrink-0"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"font-bold","text-lg"],[1,"text-sm","opacity-90"],[1,"bg-red-500","text-white","px-8","py-6","rounded-xl","shadow-2xl","transform","transition-all","duration-500","ease-in-out","max-w-md","mx-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"]],template:function(c,a){1&c&&t.YNc(0,Xr,25,9,"div",0),2&c&&t.Q6J("ngIf",a.currentExample)},dependencies:[V.mk,V.sg,V.O5,V.PC],styles:[".puzzle-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:1rem}.flex-row-box[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:flex-start;gap:3rem;width:100%;justify-content:center}.drag-box[_ngcontent-%COMP%]{min-width:180px;background:linear-gradient(135deg,#f4fafe 0%,#f7eafd 100%);border-radius:16px;box-shadow:0 4px 16px #5050a01a;padding:1.5rem 1rem 1.2rem;border:none;transition:box-shadow .3s,background .3s}.drop-box[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f7eafd 0%,#f4fafe 100%);border-radius:16px;box-shadow:0 4px 16px #5050a01a;padding:1.5rem 1rem 1.2rem;border:none;transition:box-shadow .3s,background .3s}.blocks[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.75rem}.block[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8fafc 0%,#e0e7ff 60%,#fbc2eb 100%);border:2px solid #a5b4fc;box-shadow:0 4px 16px #a5b4fc33,0 1.5px 6px #fbc2eb22;border-radius:14px;cursor:grab;font-size:2rem;padding:1.2rem 2.5rem;transition:transform .18s cubic-bezier(.4,2,.3,1),box-shadow .18s,background .18s}.block[_ngcontent-%COMP%]:hover{transform:scale(1.07) translateY(-4px);box-shadow:0 8px 24px #a5b4fc55,0 2px 12px #fbc2eb44;background:linear-gradient(135deg,#fbc2eb 0%,#e0e7ff 80%,#f8fafc 100%);border-color:#6366f1}.block[_ngcontent-%COMP%]:active{transform:scale(.97);box-shadow:0 2px 8px #a5b4fc33}.matrix[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem}.row[_ngcontent-%COMP%]{display:flex;gap:2rem}.cell[_ngcontent-%COMP%]{width:160px;height:160px;background:linear-gradient(135deg,#e3f2fd 0%,#fafafa 100%);border:4px dashed #90caf9;display:flex;align-items:center;justify-content:center;border-radius:16px;font-size:2.2rem;transition:background .2s}.cell[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#bbdefb 0%,#e3f2fd 80%,#fafafa 100%)}.cell[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;align-items:center;justify-content:center;text-align:center;font-size:1.1rem;color:#333;padding:8px;overflow-wrap:break-word;word-break:break-word;white-space:pre-line}.cell[_ngcontent-%COMP%]:hover{background:#e3f2fd}.controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1.5rem;margin-top:2rem}.description[_ngcontent-%COMP%]{font-weight:700;font-size:1.1rem}.cellblock[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fbc2eb 0%,#e0e7ff 80%,#f8fafc 100%);border:2px solid #a5b4fc;box-shadow:0 4px 16px #a5b4fc33,0 1.5px 6px #fbc2eb22;border-radius:14px;width:160px;height:160px;border:4px dashed #90caf9;display:flex;align-items:center;justify-content:center;transition:background .2s}.cellblock[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#f8fafc 0%,#e0e7ff 60%,#fbc2eb 100%);box-shadow:0 8px 24px #a5b4fc55,0 2px 12px #fbc2eb44}.cellblock.small[_ngcontent-%COMP%]{width:110px;height:100px}"]})}}return u})();const In=["puzzleRef"];function Kr(u,T){1&u&&(t.TgZ(0,"section",12)(1,"div",13)(2,"h2",14),t._uU(3,"\u{1f393} \xbfQu\xe9 es la Abstracci\xf3n?"),t.qZA(),t.TgZ(4,"p",15),t._uU(5,"La abstracci\xf3n es el proceso de enfocarse en los aspectos m\xe1s importantes de un problema, ignorando todo lo que no es esencial para resolverlo."),t.qZA(),t.TgZ(6,"div",16)(7,"h3",17),t._uU(8,"\u{1f9e9} Explicaci\xf3n:"),t.qZA(),t.TgZ(9,"p",18),t._uU(10,"Imagina que explicas c\xf3mo llegar a tu casa: das solo los pasos clave y eliminas detalles innecesarios. As\xed aplicas abstracci\xf3n, qued\xe1ndote con lo esencial para no perderse."),t.qZA(),t.TgZ(11,"h3",17),t._uU(12,"\u{1f3e1} Ejemplo cotidiano:"),t.qZA(),t.TgZ(13,"p",18),t._uU(14,"Al pensar en \u201cpreparar desayuno\u201d, tu mente abstrae y simplifica la acci\xf3n en pasos importantes, sin cada movimiento exacto."),t.qZA()(),t.TgZ(15,"div",19)(16,"h2",20),t._uU(17,"\u{1f6e0} \xbfQu\xe9 es la Simplificaci\xf3n?"),t.qZA(),t.TgZ(18,"p",21),t._uU(19,"Simplificaci\xf3n es organizar lo esencial en estructuras claras, reducir la complejidad y hacerlo m\xe1s f\xe1cil de comprender o resolver."),t.qZA(),t.TgZ(20,"h3",17),t._uU(21,"\u{1f50e} Explicaci\xf3n:"),t.qZA(),t.TgZ(22,"p",18),t._uU(23,"Si tienes muchas opciones para preparar el desayuno y lo haces todo a la vez, te enredas. Pero si lo simplificas en una secuencia ordenada, es m\xe1s f\xe1cil y menos propenso a errores."),t.qZA(),t.TgZ(24,"h3",17),t._uU(25,"\u{1f4dd} Ejemplo cotidiano:"),t.qZA(),t.TgZ(26,"p",18),t._uU(27,"Hacer una lista de tareas es simplificar tu d\xeda: organizas qu\xe9 hacer, en qu\xe9 orden y con qu\xe9 prioridad."),t.qZA()(),t.TgZ(28,"div",22)(29,"h2",23),t._uU(30,"\u{1f9e0} \xbfPor qu\xe9 son importantes en programaci\xf3n?"),t.qZA(),t.TgZ(31,"ul",24)(32,"li"),t._uU(33,"Permiten enfocarse en lo que realmente importa."),t.qZA(),t.TgZ(34,"li"),t._uU(35,"Ayudan a dividir tareas complejas en pasos manejables."),t.qZA(),t.TgZ(36,"li"),t._uU(37,"El c\xf3digo es m\xe1s limpio, claro y reutilizable."),t.qZA()(),t.TgZ(38,"p",18),t._uU(39,"En programaci\xf3n, abstraer y simplificar hace que los problemas grandes sean m\xe1s f\xe1ciles de entender, resolver y mantener."),t.qZA()()(),t.TgZ(40,"div",25)(41,"h2",26),t._uU(42,"\u2753 Preguntas frecuentes y sus respuestas"),t.qZA(),t.TgZ(43,"div",27)(44,"div",28)(45,"span",29),t._uU(46,"\u{1f914} \xbfLa abstracci\xf3n significa ignorar cosas?"),t.qZA(),t._UZ(47,"br"),t.TgZ(48,"span",18),t._uU(49,"S\xed, pero solo las cosas que no son necesarias para el problema que est\xe1s resolviendo. No se trata de ser descuidado, sino de ser eficiente."),t._UZ(50,"br"),t._uU(51," Si est\xe1s programando un bot\xf3n para encender una luz, no necesitas saber el color del bot\xf3n, sino si fue presionado o no."),t._UZ(52,"br")(53,"br"),t._uU(54," Abstraer es priorizar lo esencial y dejar de lado lo que no aporta a la soluci\xf3n. As\xed tomas decisiones m\xe1s claras y efectivas, tanto en programaci\xf3n como en la vida diaria."),t.qZA()(),t.TgZ(55,"div",30)(56,"span",29),t._uU(57,"\u{1f914} \xbfSimplificar es lo mismo que hacer algo m\xe1s f\xe1cil?"),t.qZA(),t._UZ(58,"br"),t.TgZ(59,"span",18),t._uU(60,"Casi. Simplificar no significa que el problema en s\xed sea f\xe1cil, sino que lo haces m\xe1s claro y estructurado, para poder resolverlo paso a paso."),t._UZ(61,"br"),t._uU(62," Por ejemplo, construir una casa es complejo, pero si lo divides en planos, cimientos, paredes y techos, puedes trabajar por fases. Eso es simplificaci\xf3n."),t._UZ(63,"br")(64,"br"),t._uU(65," Simplificar es dividir lo complejo en partes manejables, para avanzar sin sentirse abrumado y evitar errores innecesarios."),t.qZA()(),t.TgZ(66,"div",28)(67,"span",29),t._uU(68,"\u{1f914} \xbfPuedo aplicar estos conceptos en mi vida diaria?"),t.qZA(),t._UZ(69,"br"),t.TgZ(70,"span",18),t._uU(71,"\xa1Absolutamente!"),t._UZ(72,"br"),t._uU(73," Cada vez que haces una lista de mercado, organizas tu rutina o das una explicaci\xf3n breve y clara a alguien, est\xe1s abstraendo y simplificando."),t._UZ(74,"br"),t._uU(75," Al contar una historia a un ni\xf1o, no mencionas todos los detalles ni usas t\xe9rminos complejos. Usas solo lo necesario para que entienda y se mantenga interesado."),t._UZ(76,"br")(77,"br"),t._uU(78," Estos conceptos te ayudan a organizar mejor tus tareas y comunicarte de forma m\xe1s clara en cualquier situaci\xf3n cotidiana."),t.qZA()(),t.TgZ(79,"div",30)(80,"span",29),t._uU(81,"\u{1f914} \xbfQu\xe9 pasa si abstraigo o simplifico demasiado?"),t.qZA(),t._UZ(82,"br"),t.TgZ(83,"span",18),t._uU(84,"Si abstraes o simplificas en exceso, puedes perder informaci\xf3n importante que podr\xeda ser clave para resolver el problema correctamente. El reto est\xe1 en encontrar el equilibrio: eliminar lo innecesario, pero conservar lo esencial. En programaci\xf3n, abstraer demasiado puede hacer que el c\xf3digo sea dif\xedcil de entender o mantener; simplificar demasiado puede hacer que se pierdan funcionalidades importantes. Por eso, siempre revisa que lo que eliminas no sea fundamental para tu objetivo."),t.qZA()(),t.TgZ(85,"div",28)(86,"span",29),t._uU(87,"\u{1f914} \xbfC\xf3mo s\xe9 si estoy abstrayendo o simplificando correctamente?"),t.qZA(),t._UZ(88,"br"),t.TgZ(89,"span",18),t._uU(90,"La mejor se\xf1al es que puedes explicar el problema o la soluci\xf3n de forma clara y breve, y que cualquier persona pueda entender los pasos principales sin perderse en detalles. Si al aplicar tu abstracci\xf3n o simplificaci\xf3n, el resultado sigue siendo \xfatil, funcional y f\xe1cil de seguir, vas por buen camino. Si notas que surgen dudas, confusiones o que falta informaci\xf3n esencial, es momento de revisar y ajustar tu enfoque. Recuerda: la claridad y la utilidad son tus mejores indicadores."),t.qZA()()()(),t.TgZ(91,"h2",31),t._uU(92,"\u{1f9f0} Comparaciones Cotidianas"),t.qZA(),t.TgZ(93,"div",32)(94,"table",33)(95,"thead")(96,"tr",34)(97,"th",35),t._uU(98,"Situaci\xf3n Real"),t.qZA(),t.TgZ(99,"th",36),t._uU(100,"Abstracci\xf3n"),t.qZA(),t.TgZ(101,"th",37),t._uU(102,"Simplificaci\xf3n"),t.qZA()()(),t.TgZ(103,"tbody")(104,"tr",38)(105,"td",39),t._uU(106,"Preparar una maleta"),t.qZA(),t.TgZ(107,"td",39),t._uU(108,"Llevar solo lo necesario (ropa, documentos)"),t.qZA(),t.TgZ(109,"td",39),t._uU(110,"Doblar y acomodar para que todo quepa"),t.qZA()(),t.TgZ(111,"tr",40)(112,"td",39),t._uU(113,"Contar c\xf3mo llegar a un lugar"),t.qZA(),t.TgZ(114,"td",39),t._uU(115,"Dar solo los pasos relevantes"),t.qZA(),t.TgZ(116,"td",39),t._uU(117,"Ordenar las instrucciones en la mejor secuencia"),t.qZA()(),t.TgZ(118,"tr",41)(119,"td",39),t._uU(120,"Ense\xf1ar a usar una app"),t.qZA(),t.TgZ(121,"td",39),t._uU(122,"Explicar solo las funciones b\xe1sicas al inicio"),t.qZA(),t.TgZ(123,"td",39),t._uU(124,"Mostrar una pantalla con pocas opciones para no abrumar"),t.qZA()(),t.TgZ(125,"tr",42)(126,"td",39),t._uU(127,"Cocinar una receta"),t.qZA(),t.TgZ(128,"td",39),t._uU(129,"Usar solo ingredientes clave"),t.qZA(),t.TgZ(130,"td",39),t._uU(131,"Organizar los pasos para no mezclar todo sin orden"),t.qZA()(),t.TgZ(132,"tr",43)(133,"td",44),t._uU(134,"Resolver un problema en grupo"),t.qZA(),t.TgZ(135,"td",44),t._uU(136,"Identificar el problema central"),t.qZA(),t.TgZ(137,"td",44),t._uU(138,"Asignar tareas espec\xedficas a cada miembro"),t.qZA()()()()(),t.TgZ(139,"div",45)(140,"h2",46),t._uU(141,"\u2728 Frases clave para recordar"),t.qZA(),t.TgZ(142,"ul",47)(143,"li"),t._uU(144,'"No todo lo que ves es importante. Lo importante es lo que te acerca a la soluci\xf3n."'),t.qZA(),t.TgZ(145,"li"),t._uU(146,'"Si puedes explicarlo con menos pasos, lo est\xe1s entendiendo mejor."'),t.qZA(),t.TgZ(147,"li"),t._uU(148,'"La abstracci\xf3n te da claridad. La simplificaci\xf3n te da control."'),t.qZA()()()())}function Jr(u,T){if(1&u){const r=t.EpF();t.TgZ(0,"section",12)(1,"app-puzzle",48,49),t.NdJ("previousExample",function(){t.CHM(r);const a=t.oxw();return t.KtG(a.previousExample())})("nextExample",function(){t.CHM(r);const a=t.oxw();return t.KtG(a.nextExample())})("validatePuzzle",function(){t.CHM(r);const a=t.oxw();return t.KtG(a.validatePuzzle())})("blocksChange",function(a){t.CHM(r);const g=t.oxw();return t.KtG(g.currentBlocks=a)}),t.qZA()()}if(2&u){const r=t.oxw();t.xp6(1),t.Q6J("n",3)("description","Resuelve el rompecabezas colocando los bloques en la matriz.")("blocks",r.currentBlocks)("currentExample",r.currentExample)("currentExampleIndex",r.currentExampleIndex)("examples",r.examples)("validationResult",r.validationResult)}}function Qr(u,T){if(1&u){const r=t.EpF();t.TgZ(0,"section",12)(1,"app-puzzle",50,49),t.NdJ("previousExample",function(){t.CHM(r);const a=t.oxw();return t.KtG(a.previousPuzzle())})("nextExample",function(){t.CHM(r);const a=t.oxw();return t.KtG(a.nextPuzzle())})("validatePuzzle",function(){t.CHM(r);const a=t.oxw();return t.KtG(a.validatePuzzle())}),t.qZA()()}if(2&u){const r=t.oxw();t.xp6(1),t.Q6J("n",16===(null==r.currentBlockly||null==r.currentBlockly.answer?null:r.currentBlockly.answer.length)?4:3)("description",null==r.currentBlockly?null:r.currentBlockly.description)("blocks",r.blocklyBlocks)("currentExample",r.currentBlockly)("currentExampleIndex",r.currentBlocklyIndex)("examples",r.blocklyExercises)("isExercise",3===r.selectedSection)("validationResult",r.validationResult)}}const yo=function(u){return{"button-with-point":u}};let Wc=(()=>{class u{get canGoPreviousPuzzle(){return this.currentBlocklyIndex>0}get canGoNextPuzzle(){return this.currentBlocklyIndex<this.blocklyExercises.length-1}previousPuzzle(){this.currentBlocklyIndex>0&&(this.currentBlocklyIndex--,this.currentBlockly=this.blocklyExercises[this.currentBlocklyIndex],this.resetPuzzle(),this.validationResult="")}nextPuzzle(){this.currentBlocklyIndex<this.blocklyExercises.length-1&&(this.currentBlocklyIndex++,this.currentBlockly=this.blocklyExercises[this.currentBlocklyIndex],this.resetPuzzle(),this.validationResult="")}get puzzleBlocks(){return this.currentBlockly?.blocks||[]}get puzzleAnswer(){return this.currentBlockly?.answer||[]}validatePuzzle(){if(!this.puzzleComponent)return;const r=this.puzzleComponent.dropMatrix.flat().filter(g=>null!==g).map(g=>g.text),c=this.puzzleAnswer.map(g=>g.text),a=r.length===c.length&&r.every((g,f)=>g===c[f]);this.validationResult=a?"\xa1Correcto!":"Incorrecto, revisa el orden y los bloques."}constructor(r){this.http=r,this.blocklyExercises=[],this.currentBlocklyIndex=0,this.currentBlockly=null,this.selectedSection=1,this.examples=[],this.currentExampleIndex=0,this.currentExample=null,this.validationResult="",this.currentBlocks=[]}ngOnInit(){this.loadExamples(),this.loadBlocklyExercises()}loadBlocklyExercises(){this.http.get("assets/jsons-base/blockly-exercises.json").subscribe({next:r=>{this.blocklyExercises=r.abstraccion.exercises||[],this.currentBlockly=this.blocklyExercises[0]||null,this.currentBlocklyIndex=0,console.log("Blockly Abstracci\xf3n loaded:",this.blocklyExercises.length)},error:r=>{console.error("Error cargando ejercicios blockly:",r)}})}previousBlockly(){this.currentBlocklyIndex>0&&(this.currentBlocklyIndex--,this.currentBlockly=this.blocklyExercises[this.currentBlocklyIndex],this.resetPuzzle(),this.validationResult="")}nextBlockly(){this.currentBlocklyIndex<this.blocklyExercises.length-1&&(this.currentBlocklyIndex++,this.currentBlockly=this.blocklyExercises[this.currentBlocklyIndex],this.resetPuzzle(),this.validationResult="")}get canGoPreviousBlockly(){return this.currentBlocklyIndex>0}get canGoNextBlockly(){return this.currentBlocklyIndex<this.blocklyExercises.length-1}get blocklyBlocks(){return this.currentBlockly?.blocks||[]}get blocklyAnswer(){return this.currentBlockly?.answer||[]}loadExamples(){this.http.get("assets/jsons-base/modulos.json").subscribe({next:r=>{this.examples=r.abstraccion.examples,this.currentExample=this.examples[0],this.currentBlocks=this.shuffleBlocks(this.currentExample?.blocks||[]),console.log("Abstracci\xf3n examples loaded:",this.examples.length)},error:r=>{console.error("Error cargando ejemplos de abstracci\xf3n:",r)}})}previousExample(){this.currentExampleIndex>0&&(this.currentExampleIndex--,this.currentExample=this.examples[this.currentExampleIndex],this.currentBlocks=this.shuffleBlocks(this.currentExample?.blocks||[]),this.resetPuzzle(),this.validationResult="")}nextExample(){this.currentExampleIndex<this.examples.length-1&&(this.currentExampleIndex++,this.currentExample=this.examples[this.currentExampleIndex],this.currentBlocks=this.shuffleBlocks(this.currentExample?.blocks||[]),this.resetPuzzle(),this.validationResult="")}get canGoPreviousExample(){return this.currentExampleIndex>0}get canGoNextExample(){return this.currentExampleIndex<this.examples.length-1}shuffleBlocks(r){const c=[...r];for(let a=c.length-1;a>0;a--){const g=Math.floor(Math.random()*(a+1));[c[a],c[g]]=[c[g],c[a]]}return c}get currentAnswer(){return this.currentExample?.answer||[]}resetPuzzle(){setTimeout(()=>{this.puzzleComponent&&this.puzzleComponent.ngOnInit()},0)}static{this.\u0275fac=function(c){return new(c||u)(t.Y36(fe.eN))}}static{this.\u0275cmp=t.Xpm({type:u,selectors:[["app-abstraccion"]],viewQuery:function(c,a){if(1&c&&t.Gf(In,5),2&c){let g;t.iGM(g=t.CRH())&&(a.puzzleComponent=g.first)}},decls:23,vars:24,consts:[[1,"text-center","mb-6","mt-6"],[1,"text-3xl","font-bold","text-gray-800","mb-2","drop-shadow-md"],[1,"flex","items-center","justify-center","mb-1"],[1,"h-0.5","bg-gradient-to-r","from-transparent","via-red-500","to-transparent","w-96","shadow-sm"],[1,"flex","items-center","justify-center"],[1,"h-px","bg-gradient-to-r","from-transparent","via-gray-300","to-transparent","w-64","opacity-60"],[1,"flex","flex-col","items-center","mb-6"],[1,"sticky","top-0","z-20","w-auto","flex","justify-center","bg-transparent","backdrop-blur-md","py-2","rounded-xl"],[1,"flex","gap-72"],[1,"relative","px-4","py-2","rounded-lg","font-semibold","text-gray-700","hover:text-red-500","transition",3,"ngClass","click"],[1,"flex","flex-col","gap-6","items-center","w-full","px-2","md:px-0"],["class","bg-gray-500/20 backdrop-blur-md p-8 rounded-lg border border-gray-400/30 shadow-lg w-full max-w-7xl mt-2 mb-8",4,"ngIf"],[1,"bg-gray-500/20","backdrop-blur-md","p-8","rounded-lg","border","border-gray-400/30","shadow-lg","w-full","max-w-7xl","mt-2","mb-8"],[1,"flex","flex-col","gap-6","mb-8","justify-start","items-start"],[1,"text-xl","font-bold","text-red-500","mb-2","flex","items-center","gap-2"],[1,"text-gray-800","ml-8"],[1,"bg-gradient-to-br","from-red-100","via-red-50","to-white","border-l-4","border-red-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"text-lg","font-semibold","text-gray-700","mt-4","mb-2","flex","items-center","gap-2"],[1,"text-gray-700"],[1,"bg-gradient-to-br","from-blue-100","via-blue-50","to-white","border-l-4","border-blue-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"text-xl","font-bold","text-blue-500","mb-2","flex","items-center","gap-2"],[1,"text-gray-800"],[1,"bg-gradient-to-br","from-green-100","via-green-50","to-white","border-l-4","border-green-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"text-xl","font-bold","text-green-600","mb-2","flex","items-center","gap-2"],[1,"list-disc","ml-6","text-gray-800","mb-2"],[1,"bg-gradient-to-br","from-purple-100","via-purple-50","to-white","border-l-4","border-purple-400","shadow-lg","rounded-xl","p-6","w-full","mt-2","mb-2"],[1,"text-2xl","font-bold","text-purple-600","mb-2","flex","items-center","gap-2"],[1,"space-y-2"],[1,"bg-white","rounded-lg","p-3","max-w-2xl","w-[95%]","text-justify","ml-0","mt-8"],[1,"font-semibold"],[1,"bg-white","rounded-lg","p-3","max-w-2xl","w-[95%]","text-justify","ml-auto","mt-8"],[1,"text-2xl","font-bold","text-pink-600","mb-4","mt-4","flex","items-center","gap-2"],[1,"overflow-x-auto","mb-4"],[1,"min-w-full","text-sm","text-left","border-separate","border-spacing-0","rounded-xl","shadow-lg","bg-white"],[1,"bg-gradient-to-r","from-blue-500","via-cyan-400","to-green-300"],[1,"py-3","px-6","font-bold","text-white","rounded-tl-xl","text-center"],[1,"py-3","px-6","font-bold","text-white","text-center"],[1,"py-3","px-6","font-bold","text-white","rounded-tr-xl","text-center"],[1,"hover:bg-red-50","transition"],[1,"py-3","px-6","border-b","border-gray-200"],[1,"hover:bg-blue-50","transition"],[1,"hover:bg-pink-50","transition"],[1,"hover:bg-green-50","transition"],[1,"hover:bg-yellow-50","transition"],[1,"py-3","px-6"],[1,"bg-gradient-to-br","from-yellow-100","via-yellow-50","to-white","border-l-4","border-yellow-400","shadow-lg","rounded-xl","mt-6","p-6","w-full"],[1,"text-xl","font-bold","text-yellow-600","mb-2","flex","items-center","gap-2"],[1,"list-disc","ml-6","text-gray-800"],[3,"n","description","blocks","currentExample","currentExampleIndex","examples","validationResult","previousExample","nextExample","validatePuzzle","blocksChange"],["puzzleRef",""],[3,"n","description","blocks","currentExample","currentExampleIndex","examples","isExercise","validationResult","previousExample","nextExample","validatePuzzle"]],template:function(c,a){1&c&&(t.TgZ(0,"div",0)(1,"h1",1),t._uU(2,"\u{1f3af} Abstracci\xf3n y Simplificaci\xf3n"),t.qZA(),t.TgZ(3,"div",2),t._UZ(4,"div",3),t.qZA(),t.TgZ(5,"div",4),t._UZ(6,"div",5),t.qZA()(),t.TgZ(7,"div",6)(8,"nav",7)(9,"ul",8)(10,"li")(11,"button",9),t.NdJ("click",function(){return a.selectedSection=1}),t._uU(12," Teor\xeda "),t.qZA()(),t.TgZ(13,"li")(14,"button",9),t.NdJ("click",function(){return a.selectedSection=2}),t._uU(15," Ejemplos "),t.qZA()(),t.TgZ(16,"li")(17,"button",9),t.NdJ("click",function(){return a.selectedSection=3}),t._uU(18," Ejercicios "),t.qZA()()()()(),t.TgZ(19,"div",10),t.YNc(20,Kr,149,0,"section",11),t.YNc(21,Jr,3,7,"section",11),t.YNc(22,Qr,3,8,"section",11),t.qZA()),2&c&&(t.xp6(11),t.ekj("border-b-4",1===a.selectedSection)("border-red-500",1===a.selectedSection),t.Q6J("ngClass",t.VKq(18,yo,1===a.selectedSection)),t.xp6(3),t.ekj("border-b-4",2===a.selectedSection)("border-red-500",2===a.selectedSection),t.Q6J("ngClass",t.VKq(20,yo,2===a.selectedSection)),t.xp6(3),t.ekj("border-b-4",3===a.selectedSection)("border-red-500",3===a.selectedSection),t.Q6J("ngClass",t.VKq(22,yo,3===a.selectedSection)),t.xp6(3),t.Q6J("ngIf",1===a.selectedSection),t.xp6(1),t.Q6J("ngIf",2===a.selectedSection),t.xp6(1),t.Q6J("ngIf",3===a.selectedSection))},dependencies:[V.mk,V.O5,ms],styles:['.button-with-point[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:-8px;left:50%;transform:translate(-50%);width:0;height:0;border-left:8px solid transparent;border-right:8px solid transparent;border-top:8px solid #ef4444}']})}}return u})();function Ti(u,T){if(1&u&&(t.TgZ(0,"div",6)(1,"h3",32),t._uU(2),t.qZA(),t.TgZ(3,"div",33),t._UZ(4,"div",34),t.qZA()()),2&u){const r=t.oxw();t.xp6(2),t.Oqu(r.title)}}function zc(u,T){if(1&u&&(t.O4$(),t.ynx(0),t._UZ(1,"polyline",41),t.BQk()),2&u){const r=t.oxw().$implicit,c=t.oxw(2);t.xp6(1),t.uIk("points",c.getPolylinePoints(r))("stroke","#60a5fa")}}function wn(u,T){if(1&u&&(t.O4$(),t._UZ(0,"line",43)),2&u){const r=T.ngIf;t.oxw(2),t.uIk("x1",r.x1)("y1",r.y1)("x2",r.x2)("y2",r.y2)("stroke","#60a5fa")}}function jc(u,T){if(1&u&&(t.O4$(),t.ynx(0),t.YNc(1,wn,1,5,"line",42),t.BQk()),2&u){const r=t.oxw().$implicit,c=t.oxw(2);t.xp6(1),t.Q6J("ngIf",c.getLineCoords(r))}}function $s(u,T){if(1&u&&(t.O4$(),t.ynx(0),t.YNc(1,zc,2,2,"ng-container",40),t.YNc(2,jc,2,1,"ng-container",40),t.BQk()),2&u){const r=T.$implicit,c=t.oxw(2);t.xp6(1),t.Q6J("ngIf",c.isPolyline(r)),t.xp6(1),t.Q6J("ngIf",c.isLine(r))}}function An(u,T){if(1&u&&(t.O4$(),t._UZ(0,"rect",48)),2&u){const r=t.oxw().$implicit,c=t.oxw(2);t.uIk("width",c.blockWidth)("height",c.blockHeight)("fill",r.isActive&&"end"===r.step.type?"#86efac":r.isActive?"#60a5fa":c.getBlockColor(r.step.type))}}function Yc(u,T){if(1&u&&(t.O4$(),t._UZ(0,"polygon",49)),2&u){const r=t.oxw().$implicit,c=t.oxw(2);t.uIk("points",c.decisionPoints)("fill",r.isActive?"#60a5fa":c.getBlockColor(r.step.type))}}function Sn(u,T){if(1&u&&(t.O4$(),t.TgZ(0,"text",54),t._uU(1,"No"),t.qZA()),2&u){const r=t.oxw(5);t.uIk("x",r.blockWidth+32)("y",r.blockHeight/2-14)}}function Xc(u,T){if(1&u&&(t.O4$(),t.ynx(0),t.TgZ(1,"text",52),t._uU(2,"S\xed"),t.qZA(),t.YNc(3,Sn,2,2,"text",53),t.BQk()),2&u){const r=t.oxw(4);t.xp6(1),t.uIk("x",r.blockWidth/2-24)("y",r.blockHeight+18),t.xp6(2),t.Q6J("ngIf",r.lastDecisionWasNo)}}function On(u,T){if(1&u&&(t.O4$(),t.TgZ(0,"text",57),t._uU(1,"No"),t.qZA()),2&u){const r=t.oxw(5);t.uIk("x",-40)("y",r.blockHeight/2-14)}}function el(u,T){if(1&u&&(t.O4$(),t.TgZ(0,"text",55),t._uU(1,"S\xed"),t.qZA(),t.YNc(2,On,2,2,"text",56)),2&u){const r=t.oxw(4);t.uIk("x",r.blockWidth+40)("y",r.blockHeight/2-14),t.xp6(2),t.Q6J("ngIf",r.lastDecisionWasNo)}}function tl(u,T){if(1&u&&(t.O4$(),t.ynx(0),t.YNc(1,Xc,4,3,"ng-container",50),t.YNc(2,el,3,3,"ng-template",null,51,t.W1O),t.BQk()),2&u){const r=t.MAs(3),c=t.oxw(3);t.xp6(1),t.Q6J("ngIf",c.hasLoopBack())("ngIfElse",r)}}function Rn(u,T){if(1&u){const r=t.EpF();t.O4$(),t.kcU(),t.ynx(0),t.TgZ(1,"div",59)(2,"button",60),t.NdJ("click",function(){t.CHM(r);const a=t.oxw(4);return t.KtG(a.chooseBranch("yes"))}),t._uU(3,"S\xed"),t.qZA(),t.TgZ(4,"button",61),t.NdJ("click",function(){t.CHM(r);const a=t.oxw(4);return t.KtG(a.chooseBranch("no"))}),t._uU(5,"No"),t.qZA()(),t.BQk()}}function Mn(u,T){if(1&u){const r=t.EpF();t.O4$(),t.kcU(),t.TgZ(0,"div",59)(1,"button",61),t.NdJ("click",function(){t.CHM(r);const a=t.oxw(4);return t.KtG(a.chooseBranch("no"))}),t._uU(2,"No"),t.qZA(),t.TgZ(3,"button",60),t.NdJ("click",function(){t.CHM(r);const a=t.oxw(4);return t.KtG(a.chooseBranch("yes"))}),t._uU(4,"S\xed"),t.qZA()()}}function Nn(u,T){if(1&u&&(t.O4$(),t.TgZ(0,"foreignObject"),t.YNc(1,Rn,6,0,"ng-container",50),t.YNc(2,Mn,5,0,"ng-template",null,58,t.W1O),t.qZA()),2&u){const r=t.MAs(3),c=t.oxw(3);t.uIk("x",c.blockWidth/2-120)("y",c.blockHeight-90)("width",240)("height",60),t.xp6(1),t.Q6J("ngIf",c.hasLoopBack())("ngIfElse",r)}}function _s(u,T){if(1&u&&(t.O4$(),t.ynx(0),t.TgZ(1,"g"),t.YNc(2,An,1,3,"rect",44),t.YNc(3,Yc,1,2,"polygon",45),t.TgZ(4,"foreignObject"),t.kcU(),t.TgZ(5,"div",46)(6,"div",47),t._uU(7),t.qZA()()(),t.YNc(8,tl,4,2,"ng-container",40),t.YNc(9,Nn,4,6,"foreignObject",40),t.qZA(),t.BQk()),2&u){const r=T.$implicit,c=T.index,a=t.oxw(2);t.xp6(1),t.uIk("transform","translate("+r.x+","+r.y+")"),t.xp6(1),t.Q6J("ngIf","decision"!==r.step.type),t.xp6(1),t.Q6J("ngIf","decision"===r.step.type),t.xp6(1),t.uIk("x",0)("y",0)("width",a.blockWidth)("height",a.blockHeight),t.xp6(3),t.hij(" ",r.step.text," "),t.xp6(1),t.Q6J("ngIf","decision"===r.step.type&&!(c===a.svgBlocks.length-1&&r.step.id===a.currentStepId)),t.xp6(1),t.Q6J("ngIf","decision"===r.step.type&&c===a.svgBlocks.length-1&&r.step.id===a.currentStepId)}}function Kc(u,T){if(1&u&&(t.TgZ(0,"div",35),t.O4$(),t.TgZ(1,"svg",36),t.YNc(2,$s,3,2,"ng-container",37),t.TgZ(3,"defs")(4,"marker",38),t._UZ(5,"polygon",39),t.qZA()(),t.YNc(6,_s,10,10,"ng-container",37),t.qZA()()),2&u){const r=t.oxw();t.xp6(1),t.uIk("width","900")("height",r.svgHeight)("viewBox","0 0 "+(r.svgWidth+r.svgIncrease)+" "+r.svgHeight),t.xp6(1),t.Q6J("ngForOf",r.svgConnections),t.xp6(4),t.Q6J("ngForOf",r.svgBlocks)}}function qo(u,T){1&u&&(t.TgZ(0,"div",62)(1,"div",63),t._uU(2,"\u{1f680}"),t.qZA(),t.TgZ(3,"p",64),t._uU(4,"\xa1Comencemos el diagrama de flujo!"),t.qZA(),t.TgZ(5,"p",65),t._uU(6,'Presiona "Siguiente" para ver el primer paso'),t.qZA()())}function bs(u,T){if(1&u&&(t.TgZ(0,"div",66),t._uU(1," \u{1f501} Iteraciones del bucle: "),t.TgZ(2,"span",67),t._uU(3),t.qZA()()),2&u){const r=t.oxw();t.xp6(3),t.Oqu(r.loopCount)}}function Dn(u,T){if(1&u&&(t.O4$(),t.kcU(),t.TgZ(0,"div",68)(1,"div",69)(2,"div",70),t.O4$(),t.TgZ(3,"svg",71),t._UZ(4,"path",72),t.qZA(),t.kcU(),t.TgZ(5,"div")(6,"p",73),t._uU(7,"\xa1Perfecto!"),t.qZA(),t.TgZ(8,"p",74),t._uU(9),t.qZA()()()()()),2&u){const r=t.oxw();t.xp6(9),t.Oqu(r.currentMessage)}}let Ei=(()=>{class u{constructor(){this.steps=[],this.title="",this.loopCount=0,this.showSuccess=!1,this.currentMessage="",this.lastDecisionWasNo=!1,this.currentStepId=null,this.visibleSteps=[],this.comparedBlockIds=[],this.history=[],this.svgIncrease=0,this.entryTimes=0,this.svgWidth=800,this.svgHeight=300,this.blockWidth=140,this.blockHeight=60,this.blockGapY=100,this.blockGapX=220,this.decisionPoints="",this.svgConnections=[],this.svgBlocks=[]}get progressPercentage(){if(!this.steps||0===this.steps.length)return 0;const r=Array.from(new Set(this.history)).length,c=this.getStepById(this.currentStepId);return c&&"end"===c.type?100:Math.min(100,Math.round(r/this.steps.length*100))}ngOnChanges(r){r.steps&&this.steps&&this.resetSteps(),this.updateSVGLayout()}ngOnInit(){this.resetSteps(),this.updateSVGLayout()}getStepById(r){return this.steps.find(c=>c.id===r)}resetSteps(){this.steps.length>0?(this.svgIncrease=0,this.comparedBlockIds=[],this.entryTimes=0,this.currentStepId=this.steps[0].id,this.history=[this.currentStepId],this.updateVisibleSteps()):(this.currentStepId=null,this.history=[],this.visibleSteps=[])}updateVisibleSteps(){this.visibleSteps.length>0&&"end"===this.getStepById(this.currentStepId)?.type&&(this.showSuccess=!0,this.currentMessage="\xa1Diagrama de flujo completado! Has visualizado todos los pasos del proceso \u{1f389}",setTimeout(()=>{this.showSuccess=!1},3e3)),this.visibleSteps=this.history.map(r=>this.getStepById(r)).filter(Boolean),this.updateSVGLayout()}updateSVGLayout(){this.svgBlocks=[],this.svgConnections=[];let r=this.svgWidth/2-this.blockWidth/2,c=30,a=r,g=c,f=this.blockGapX,S=null;const Z={},he=this.history.length>0?this.history[this.history.length-1]:null,ae=this.hasLoopBack();for(let ve=0;ve<this.visibleSteps.length;ve++){const H=this.visibleSteps[ve],Et=ve===this.visibleSteps.length-1;if(!Z[H.id]||Et)if(Z[H.id]&&Et)a=Z[H.id].x,g=Z[H.id].y,this.svgBlocks.push({step:H,x:a,y:g,isActive:H.id===he});else if(0===ve)this.svgBlocks.push({step:H,x:r,y:c,isActive:H.id===he}),a=r,g=c,Z[H.id]={x:r,y:c},"decision"===H.type&&(S={x:r,y:c});else{const X=this.visibleSteps[ve-1];if("decision"===X.type){let re,Y,z,oe,ie,q=a,W=g+this.blockGapY;ae&&X.branches&&X.branches.yes===H.id?(q=a,W=g+this.blockGapY,re=a+this.blockWidth/2,Y=g+this.blockHeight):ae&&X.branches&&X.branches.no===H.id?(q=a+f,W=g,re=a+this.blockWidth,Y=g+this.blockHeight/2):!ae&&X.branches&&X.branches.yes===H.id?(q=a+f,re=a+this.blockWidth,Y=g+this.blockHeight/2):!ae&&X.branches&&X.branches.no===H.id?(q=a-f,re=a,Y=g+this.blockHeight/2):(re=a+this.blockWidth/2,Y=g+this.blockHeight),this.svgBlocks.push({step:H,x:q,y:W,isActive:H.id===he}),Z[H.id]={x:q,y:W},ae&&X.branches&&X.branches.yes===H.id?(z=q+this.blockWidth/2,oe=W-40,ie=[{x:re,y:Y},{x:re,y:oe},{x:z,y:oe},{x:z,y:W}]):ae&&X.branches&&X.branches.no===H.id?(z=q,oe=W+this.blockHeight/2,ie=[{x:re,y:Y},{x:z,y:Y},{x:z,y:oe}]):(z=q+this.blockWidth/2,oe=W+this.blockHeight/2,ie=[{x:re,y:Y},{x:z,y:Y},{x:z,y:oe}]),this.svgConnections.push({points:ie,isActive:H.id===he}),a=q,g=W,"decision"===H.type&&(S={x:q,y:W})}else{let q=a,W=g+this.blockGapY;this.svgBlocks.push({step:H,x:q,y:W,isActive:H.id===he}),Z[H.id]={x:q,y:W},this.svgConnections.push({x1:a+this.blockWidth/2,y1:g+this.blockHeight,x2:q+this.blockWidth/2,y2:W,isActive:H.id===he}),a=q,g=W,"decision"===H.type&&(S={x:q,y:W})}if(ae&&H.loopBack&&S){const W=g+this.blockHeight/2,Y=S.y+this.blockHeight/2,z=60,oe=[{x:a,y:W},{x:a-z,y:W},{x:a-z,y:Y},{x:S.x,y:Y}],ie=H.id,pe=this.visibleSteps.find(Be=>Be.id===H.loopBack)?.id;this.svgConnections.some(Be=>Be.isLoop&&Be.loopFromId===ie&&Be.loopToId===pe)||this.svgConnections.push({points:oe,isLoop:!0,isActive:H.id===he,loopFromId:ie,loopToId:pe})}else if(!ae&&H.loopBack&&S){const q=a+this.blockWidth/2,W=g+this.blockHeight,re=S.x+this.blockWidth/2,oe=80;let ie=W+40,pe=q,le=re;q<re?(pe=q+oe,le=re-oe):q>re&&(pe=q-oe,le=re+oe);const Be=[{x:q,y:W},{x:pe,y:ie},{x:le,y:ie},{x:re,y:S.y+this.blockHeight/2}],Pe=H.id,Se=this.visibleSteps.find(kt=>kt.id===H.loopBack)?.id;this.svgConnections.some(kt=>kt.isLoop&&kt.loopFromId===Pe&&kt.loopToId===Se)||this.svgConnections.push({points:Be,isLoop:!0,isActive:H.id===he,loopFromId:Pe,loopToId:Se})}}else if(a=Z[H.id].x,g=Z[H.id].y,ae&&H.loopBack&&S){const q=g+this.blockHeight/2,re=S.y+this.blockHeight/2,Y=60,z=[{x:a,y:q},{x:a-Y,y:q},{x:a-Y,y:re},{x:S.x,y:re}],oe=H.id,ie=this.visibleSteps.find(le=>le.id===H.loopBack)?.id;this.svgConnections.some(le=>le.isLoop&&le.loopFromId===oe&&le.loopToId===ie)||this.svgConnections.push({points:z,isLoop:!0,isActive:H.id===he,loopFromId:oe,loopToId:ie})}else if(!ae&&H.loopBack&&S){const X=a+this.blockWidth/2,q=g+this.blockHeight,W=S.x+this.blockWidth/2,z=80;let oe=q+40,ie=X,pe=W;X<W?(ie=X+z,pe=W-z):X>W&&(ie=X-z,pe=W+z);const le=[{x:X,y:q},{x:ie,y:oe},{x:pe,y:oe},{x:W,y:S.y+this.blockHeight/2}],Be=H.id,Pe=this.visibleSteps.find(ut=>ut.id===H.loopBack)?.id;this.svgConnections.some(ut=>ut.isLoop&&ut.loopFromId===Be&&ut.loopToId===Pe)||this.svgConnections.push({points:le,isLoop:!0,isActive:H.id===he,loopFromId:Be,loopToId:Pe})}}this.decisionPoints=`${this.blockWidth/2},0 ${this.blockWidth},${this.blockHeight/2} ${this.blockWidth/2},${this.blockHeight} 0,${this.blockHeight/2}`,this.svgHeight=c+this.svgBlocks.length*this.blockGapY+this.blockHeight}isPolyline(r){return!!r.points&&Array.isArray(r.points)}isLine(r){return void 0!==r.x1&&void 0!==r.y1&&void 0!==r.x2&&void 0!==r.y2}getPolylinePoints(r){return r.points&&Array.isArray(r.points)?r.points.map(c=>`${c.x},${c.y}`).join(" "):""}getLineCoords(r){return void 0!==r.x1&&void 0!==r.y1&&void 0!==r.x2&&void 0!==r.y2?{x1:r.x1,y1:r.y1,x2:r.x2,y2:r.y2}:null}getBlockColor(r){switch(r){case"decision":return"#fef3c7";case"end":case"start":return"#bbf7d0";default:return"#bfdbfe"}}previousStep(){this.history.length>1&&(this.history.pop(),this.currentStepId=this.history[this.history.length-1],this.updateVisibleSteps(),this.resetLoopCountIfNeeded(),this.lastDecisionWasNo=!1)}nextStep(){if(!this.steps||0===this.steps.length||null===this.currentStepId)return;const r=this.getStepById(this.currentStepId);if(!r||"decision"===r.type)return;let c=null;if("number"==typeof r.next?c=r.next:"number"==typeof r.loopBack&&(c=r.loopBack,this.loopCount++),!c){const a=this.steps.findIndex(g=>g.id===this.currentStepId);a<this.steps.length-1&&(c=this.steps[a+1].id)}c&&(this.currentStepId=c,this.history.push(c),this.updateVisibleSteps(),this.resetLoopCountIfNeeded())}chooseBranch(r){const c=this.getStepById(this.currentStepId);if(!c||"decision"!==c.type)return;const a=c.branches&&"number"==typeof c.branches[r]?c.branches[r]:null;a&&(this.currentStepId=a,this.history.push(a),this.updateVisibleSteps(),this.lastDecisionWasNo="no"===r,("no"===r||!this.isLoopStep(a))&&(this.loopCount=0),this.compareBlockIds(a))}compareBlockIds(r){const c=this.steps.filter(g=>"decision"===g.type);if(c.length<2)return;const a=[];for(let g=1;g<c.length;g++){const f=c[g].branches;f&&("number"==typeof f.yes&&a.push(f.yes),"number"==typeof f.no&&a.push(f.no))}this.comparedBlockIds.includes(r)||a.includes(r)&&(this.entryTimes++,this.svgIncrease+=2===this.entryTimes?200:160,console.log("si pasa ",r),console.log("si pasa ",this.svgIncrease),this.comparedBlockIds.push(r))}nextStepAvailable(){if(null===this.currentStepId)return!1;const r=this.getStepById(this.currentStepId);return!(!r||"decision"===r.type||"end"===r.type)&&("number"==typeof r.next||"number"==typeof r.loopBack||this.steps.findIndex(a=>a.id===this.currentStepId)<this.steps.length-1)}get canGoPrevious(){return this.history.length>1}get canReset(){return this.history.length>1}get progressText(){const r=this.getStepById(this.currentStepId);if(!r)return"";let c;const a=this.history.length;return c="end"===r.type?this.history.length:Math.max(this.steps.length,this.history.length),`Paso ${a} de ${c}`}resetDiagram(){this.resetSteps(),this.loopCount=0,this.updateSVGLayout()}hasLoopBack(){return this.steps.some(r=>"number"==typeof r.loopBack)}isLoopStep(r){const c=this.getStepById(r);return!!c&&"number"==typeof c.loopBack}resetLoopCountIfNeeded(){this.isLoopStep(this.currentStepId)||(this.loopCount=0)}static{this.\u0275fac=function(c){return new(c||u)}}static{this.\u0275cmp=t.Xpm({type:u,selectors:[["app-flowchart"]],inputs:{steps:"steps",title:"title"},features:[t.TTD],decls:49,vars:30,consts:[[1,"flowchart-container","w-full","h-full","flex","flex-col"],[1,"flex-1","overflow-y-auto"],["class","text-center mb-4",4,"ngIf"],["class","w-full flex justify-center items-center pb-6 overflow-x-auto",4,"ngIf"],["class","text-center text-gray-500 py-8",4,"ngIf"],[1,"mt-6","p-4","bg-gray-50","rounded-lg","border"],[1,"text-center","mb-4"],[1,"text-sm","font-bold","text-gray-700","mb-2"],[1,"flex","items-center","justify-center"],[1,"h-0.5","bg-gradient-to-r","from-transparent","via-blue-400","to-transparent","w-32"],[1,"flex","flex-col","items-center"],[1,"grid","grid-cols-2","gap-x-24","gap-y-3","text-xs","max-w-2xl"],[1,"flex","items-center","space-x-2"],[1,"w-4","h-4","bg-green-100","border","border-green-400","rounded"],[1,"w-4","h-4","bg-blue-100","border","border-blue-400","rounded"],[1,"w-4","h-4","bg-yellow-100","border","border-yellow-400","rounded","transform","rotate-45"],[1,"bg-white/90","backdrop-blur-sm","p-3","rounded-lg","border","border-gray-300","shadow-2xl","mt-1","flex-shrink-0",2,"position","sticky","bottom","15px","z-index","100"],[1,"mb-3"],[1,"flex","justify-between","items-center","mb-1"],[1,"text-xs","font-medium","text-gray-700"],[1,"text-xs","font-medium","text-green-600"],[1,"w-full","bg-gray-200","rounded-full","h-1.5"],[1,"bg-gradient-to-r","from-blue-500","to-green-500","h-1.5","rounded-full","transition-all","duration-500","ease-in-out"],["class","mt-2 text-xs text-blue-700 font-semibold text-center",4,"ngIf"],[1,"flex","justify-center","items-center","space-x-2"],[1,"w-8","h-8","text-white","rounded-full","shadow-md","hover:shadow-lg","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border","disabled:bg-gray-400","disabled:border-gray-300","disabled:hover:bg-gray-400",3,"disabled","click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[1,"px-3","py-1.5","text-xs","font-medium","text-white","bg-gray-500","rounded-md","shadow-md","hover:shadow-lg","transition-all","duration-300","ease-in-out","disabled:bg-gray-300","disabled:cursor-not-allowed",3,"disabled","click"],[1,"w-8","h-8","bg-blue-600","hover:bg-blue-700","text-white","rounded-full","shadow-md","hover:shadow-lg","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border","border-blue-800","disabled:bg-gray-400","disabled:border-gray-300","disabled:hover:bg-gray-400",3,"disabled","click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],["class","fixed inset-0 z-[9999] flex items-center justify-center bg-black bg-opacity-50",4,"ngIf"],[1,"text-lg","font-bold","text-gray-800"],[1,"flex","items-center","justify-center","mt-2"],[1,"h-0.5","bg-gradient-to-r","from-transparent","via-blue-400","to-transparent","w-64"],[1,"w-full","flex","justify-center","items-center","pb-6","overflow-x-auto"],[1,"flowchart-svg"],[4,"ngFor","ngForOf"],["id","arrowhead","markerWidth","8","markerHeight","8","refX","6","refY","4","orient","auto"],["points","0 0, 8 4, 0 8","fill","#60a5fa"],[4,"ngIf"],["stroke-width","3","fill","none","marker-end","url(#arrowhead)"],["stroke-width","3","marker-end","url(#arrowhead)",4,"ngIf"],["stroke-width","3","marker-end","url(#arrowhead)"],["rx","14","stroke","#333","stroke-width","2",4,"ngIf"],["stroke","#b45309","stroke-width","2",4,"ngIf"],[2,"width","100%","height","100%","display","flex","align-items","center","justify-content","center"],[2,"white-space","pre-line","word-break","break-word","text-align","center","font-size","13px","font-family","Inter,sans-serif","color","#222","padding","4px","line-height","1.2"],["rx","14","stroke","#333","stroke-width","2"],["stroke","#b45309","stroke-width","2"],[4,"ngIf","ngIfElse"],["normalLabels",""],["text-anchor","middle","font-size","14","fill","#22c55e","font-weight","bold"],["text-anchor","start","font-size","14","fill","#ef4444","font-weight","bold",4,"ngIf"],["text-anchor","start","font-size","14","fill","#ef4444","font-weight","bold"],["text-anchor","start","font-size","14","fill","#22c55e","font-weight","bold"],["text-anchor","end","font-size","14","fill","#ef4444","font-weight","bold",4,"ngIf"],["text-anchor","end","font-size","14","fill","#ef4444","font-weight","bold"],["normalDecisionBtns",""],[2,"display","flex","justify-content","center","align-items","center","gap","130px","width","100%"],[1,"w-12","h-12","bg-green-500","text-white","rounded-full","shadow","hover:bg-green-600","font-bold","flex","items-center","justify-center","text-lg",3,"click"],[1,"w-12","h-12","bg-red-500","text-white","rounded-full","shadow","hover:bg-red-600","font-bold","flex","items-center","justify-center","text-lg",3,"click"],[1,"text-center","text-gray-500","py-8"],[1,"text-6xl","mb-4"],[1,"text-lg","font-medium"],[1,"text-sm"],[1,"mt-2","text-xs","text-blue-700","font-semibold","text-center"],[1,"font-bold"],[1,"fixed","inset-0","z-[9999]","flex","items-center","justify-center","bg-black","bg-opacity-50"],[1,"bg-green-500","text-white","px-8","py-6","rounded-xl","shadow-2xl","transform","transition-all","duration-500","ease-in-out","max-w-md","mx-4"],[1,"flex","items-center","space-x-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","flex-shrink-0"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"font-bold","text-lg"],[1,"text-sm","opacity-90"]],template:function(c,a){1&c&&(t.TgZ(0,"div",0)(1,"div",1),t.YNc(2,Ti,5,1,"div",2),t.YNc(3,Kc,7,5,"div",3),t.YNc(4,qo,7,0,"div",4),t.TgZ(5,"div",5)(6,"div",6)(7,"h4",7),t._uU(8,"Leyenda"),t.qZA(),t.TgZ(9,"div",8),t._UZ(10,"div",9),t.qZA()(),t.TgZ(11,"div",10)(12,"div",11)(13,"div",12),t._UZ(14,"div",13),t.TgZ(15,"span"),t._uU(16,"\u{1f7e2} Inicio/Fin"),t.qZA()(),t.TgZ(17,"div",12),t._UZ(18,"div",14),t.TgZ(19,"span"),t._uU(20,"\u{1f4e6} Proceso"),t.qZA()(),t.TgZ(21,"div",12),t._UZ(22,"div",15),t.TgZ(23,"span"),t._uU(24,"\u{1f914} Decisi\xf3n"),t.qZA()(),t.TgZ(25,"div",12),t._UZ(26,"div",13),t.TgZ(27,"span"),t._uU(28,"\u2705 Final"),t.qZA()()()()()(),t.TgZ(29,"div",16)(30,"div",17)(31,"div",18)(32,"span",19),t._uU(33),t.qZA(),t.TgZ(34,"span",20),t._uU(35),t.qZA()(),t.TgZ(36,"div",21),t._UZ(37,"div",22),t.qZA(),t.YNc(38,bs,4,1,"div",23),t.qZA(),t.TgZ(39,"div",24)(40,"button",25),t.NdJ("click",function(){return a.previousStep()}),t.O4$(),t.TgZ(41,"svg",26),t._UZ(42,"path",27),t.qZA()(),t.kcU(),t.TgZ(43,"button",28),t.NdJ("click",function(){return a.resetSteps()}),t._uU(44," \u{1f504} Reiniciar "),t.qZA(),t.TgZ(45,"button",29),t.NdJ("click",function(){return a.nextStep()}),t.O4$(),t.TgZ(46,"svg",26),t._UZ(47,"path",30),t.qZA()()()(),t.YNc(48,Dn,10,1,"div",31),t.qZA()),2&c&&(t.xp6(2),t.Q6J("ngIf",a.title),t.xp6(1),t.Q6J("ngIf",a.svgBlocks.length>0),t.xp6(1),t.Q6J("ngIf",0===a.visibleSteps.length&&a.steps.length>0),t.xp6(29),t.Oqu(a.progressText),t.xp6(2),t.hij("",a.progressPercentage,"%"),t.xp6(2),t.Udp("width",a.progressPercentage,"%"),t.xp6(1),t.Q6J("ngIf",a.hasLoopBack()&&a.loopCount>0),t.xp6(2),t.Udp("background-color",a.canGoPrevious?"#f3ae22":"")("border-color",a.canGoPrevious?"#d18c00":""),t.ekj("opacity-50",!a.canGoPrevious)("cursor-not-allowed",!a.canGoPrevious),t.Q6J("disabled",!a.canGoPrevious),t.xp6(3),t.ekj("opacity-50",!a.canReset)("cursor-not-allowed",!a.canReset)("hover:bg-gray-600",a.canReset),t.Q6J("disabled",!a.canReset),t.xp6(2),t.ekj("opacity-50",!a.nextStepAvailable())("cursor-not-allowed",!a.nextStepAvailable()),t.Q6J("disabled",!a.nextStepAvailable()),t.xp6(3),t.Q6J("ngIf",a.showSuccess))},dependencies:[V.sg,V.O5],styles:[".flowchart-svg[_ngcontent-%COMP%]{max-width:900px;width:100%;height:auto;display:block;margin:0 auto;background:#f8fafc;border-radius:12px;box-shadow:0 2px 8px #00000012}.flowchart-container[_ngcontent-%COMP%]{font-family:Inter,sans-serif;display:flex;flex-direction:column;height:100%;max-height:100%}.flex-1[_ngcontent-%COMP%]{flex:1;min-height:0}.flex-shrink-0[_ngcontent-%COMP%]{flex-shrink:0}.overflow-y-auto[_ngcontent-%COMP%]{scroll-behavior:smooth}.step-container[_ngcontent-%COMP%]{position:relative;z-index:1}.step-container[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{transition:all .3s cubic-bezier(.4,0,.2,1);box-shadow:0 2px 8px #00000012}.step-container[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:hover{transform:scale(1.07);z-index:10;box-shadow:0 6px 24px #0000001f}.decision-diamond[_ngcontent-%COMP%], .w-32.h-32[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fef3c7,#fde68a);box-shadow:0 4px 12px -1px #00000014;border-radius:12px}.flow-connector[_ngcontent-%COMP%], .bg-gray-300[_ngcontent-%COMP%], .bg-gray-400[_ngcontent-%COMP%]{background:linear-gradient(to bottom,#dbeafe,#60a5fa)}@keyframes _ngcontent-%COMP%_stepAppear{0%{opacity:0;transform:translateY(-20px) scale(.8)}50%{opacity:.7;transform:translateY(-5px) scale(1.1)}to{opacity:1;transform:translateY(0) scale(1)}}.step-animation[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_stepAppear .5s cubic-bezier(.4,0,.2,1)}@keyframes _ngcontent-%COMP%_drawLine{0%{stroke-dasharray:0,100;opacity:0}to{stroke-dasharray:100,0;opacity:1}}.animate-draw-line[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_drawLine .4s ease-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:scale(.5)}to{opacity:1;transform:scale(1)}}.animate-fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-out}@keyframes _ngcontent-%COMP%_gentlePulse{0%,to{transform:scale(1);opacity:1}50%{transform:scale(1.1);opacity:.8}}.animate-pulse[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_gentlePulse 2s ease-in-out infinite}.step-nav-button[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 25px #00000026}.progress-bar[_ngcontent-%COMP%]{background:linear-gradient(90deg,#3b82f6,#10b981);background-size:200% 100%;animation:_ngcontent-%COMP%_gradientShift 3s ease infinite}@keyframes _ngcontent-%COMP%_gradientShift{0%{background-position:0% 50%}50%{background-position:100% 50%}to{background-position:0% 50%}}@media (max-width: 768px){.step-container[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{min-width:120px;padding:.5rem;font-size:.875rem}.decision-diamond[_ngcontent-%COMP%]{width:100px!important;height:100px!important}.step-nav-button[_ngcontent-%COMP%]{width:2.5rem;height:2.5rem}}.legend-item[_ngcontent-%COMP%]{transition:background-color .2s ease}.legend-item[_ngcontent-%COMP%]:hover{background-color:#3b82f61a}.flowchart-shadow[_ngcontent-%COMP%]{filter:drop-shadow(0 4px 6px rgba(0,0,0,.1))}.completion-celebration[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_celebrate .8s ease-out}@keyframes _ngcontent-%COMP%_celebrate{0%{transform:scale(1)}25%{transform:scale(1.1) rotate(5deg)}50%{transform:scale(1.2) rotate(-5deg)}75%{transform:scale(1.1) rotate(2deg)}to{transform:scale(1) rotate(0)}}.status-message[_ngcontent-%COMP%]{transition:all .5s ease-in-out}.control-panel[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);background:rgba(255,255,255,.9);border:1px solid rgba(0,0,0,.1)}.continuation-indicator[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_bounce 2s ease-in-out infinite}@keyframes _ngcontent-%COMP%_bounce{0%,20%,50%,80%,to{transform:translateY(0)}40%{transform:translateY(-5px)}60%{transform:translateY(-3px)}}"]})}}return u})();var Jc=Ee(3329);const{Variables:wa,Xml:bl,dialog:Cs,inject:Hn,svgResize:Vn}=Jc;let yl=(()=>{class u{codeToBlocksXml(r){let c="<xml>";const a=r.split(/\n|;/).map(f=>f.trim()).filter(f=>f.length>0);let g=1;for(let f of a){const Z=f.match(/^function\s+(\w+)\s*\(([^)]*)\)\s*{(.*)}$/s);if(Z){const ie=Z[1],pe=Z[2].split(",").map(Se=>Se.trim()).filter(Boolean),Pe=Z[3].trim().match(/return\s+([^;]+);?/);c+=`<block type="procedures_defreturn" id="func${g}" x="${40+40*g}" y="40">`,c+=`<field name="NAME">${ie}</field>`,c+=`<mutation${pe.length?` arguments="${pe.join(",")}"`:""}></mutation>`,c+='<statement name="STACK"></statement>',Pe&&(c+=`<value name="RETURN">${this.buildArithmeticXml(Pe[1])}</value>`),c+="</block>",g++;continue}const ae=f.match(/^(var|let|const)\s+([a-zA-Z_][a-zA-Z0-9_]*)\s*=\s*(.+)$/);if(ae){c+=`<block type="variables_set" id="assign${g}" x="${40+40*g}" y="40">`,c+=`<field name="VAR">${ae[2]}</field>`,c+=`<value name="VALUE">${this.buildArithmeticXml(ae[3])}</value>`,c+="</block>",g++;continue}const H=f.match(/^([a-zA-Z_][a-zA-Z0-9_]*)\s*=\s*(.+)$/);if(H){c+=`<block type="variables_set" id="reassign${g}" x="${40+40*g}" y="40">`,c+=`<field name="VAR">${H[1]}</field>`,c+=`<value name="VALUE">${this.buildArithmeticXml(H[2])}</value>`,c+="</block>",g++;continue}const X=f.match(/^print\((.+)\)$/);if(X){c+=`<block type="text_print" id="print${g}" x="${40+40*g}" y="40">`,c+=`<value name="TEXT">${this.buildArithmeticXml(X[1])}</value>`,c+="</block>",g++;continue}const W=f.match(/^if\s*\((.+)\)\s*{(.+)}(\s*else\s*{(.+)})?/s);if(W){c+=`<block type="controls_if" id="if${g}" x="${40+40*g}" y="40">`,c+=`<value name="IF0">${this.buildArithmeticXml(W[1])}</value>`,c+=`<statement name="DO0">${this.buildStatementXml(W[2])}</statement>`,W[4]&&(c+=`<statement name="ELSE">${this.buildStatementXml(W[4])}</statement>`),c+="</block>",g++;continue}const Y=f.match(/^for\s*\(let\s+([a-zA-Z_][a-zA-Z0-9_]*)\s*=\s*(\d+);\s*\1\s*([<>=!]+)\s*(\d+);\s*\1\s*\+=\s*(\d+)\)\s*{(.+)}/s);if(Y){c+=`<block type="controls_for" id="for${g}" x="${40+40*g}" y="40">`,c+=`<field name="VAR">${Y[1]}</field>`,c+=`<value name="FROM"><block type="math_number"><field name="NUM">${Y[2]}</field></block></value>`,c+=`<value name="TO"><block type="math_number"><field name="NUM">${Y[4]}</field></block></value>`,c+=`<value name="BY"><block type="math_number"><field name="NUM">${Y[5]}</field></block></value>`,c+=`<statement name="DO">${this.buildStatementXml(Y[6])}</statement>`,c+="</block>",g++;continue}const oe=f.match(/^while\s*\((.+)\)\s*{(.+)}/s);oe&&(c+=`<block type="controls_whileUntil" id="while${g}" x="${40+40*g}" y="40">`,c+='<field name="MODE">WHILE</field>',c+=`<value name="BOOL">${this.buildArithmeticXml(oe[1])}</value>`,c+=`<statement name="DO">${this.buildStatementXml(oe[2])}</statement>`,c+="</block>",g++)}return c+="</xml>",c}buildArithmeticXml(r){r=r.trim();const c=["+","-","*","/"];for(const g of c)if(-1!==r.indexOf(g)&&!/^".*"$/.test(r)){const f=r.split(g);if(f.length>1){let S=`<block type="math_arithmetic"><field name="OP">${this.opToBlockly(g)}</field>`;return S+=`<value name="A">${this.buildArithmeticXml(f[0])}</value>`,S+=`<value name="B">${this.buildArithmeticXml(f.slice(1).join(g))}</value>`,S+="</block>",S}}const a=["==","!=",">=","<=",">","<"];for(const g of a)if(-1!==r.indexOf(g)){const f=r.split(g);if(2===f.length){let S=`<block type="logic_compare"><field name="OP">${this.compOpToBlockly(g)}</field>`;return S+=`<value name="A">${this.buildArithmeticXml(f[0])}</value>`,S+=`<value name="B">${this.buildArithmeticXml(f[1])}</value>`,S+="</block>",S}}if(-1!==r.indexOf("&&")){const g=r.split("&&");let f='<block type="logic_operation"><field name="OP">AND</field>';return f+=`<value name="A">${this.buildArithmeticXml(g[0])}</value>`,f+=`<value name="B">${this.buildArithmeticXml(g.slice(1).join("&&"))}</value>`,f+="</block>",f}if(-1!==r.indexOf("||")){const g=r.split("||");let f='<block type="logic_operation"><field name="OP">OR</field>';return f+=`<value name="A">${this.buildArithmeticXml(g[0])}</value>`,f+=`<value name="B">${this.buildArithmeticXml(g.slice(1).join("||"))}</value>`,f+="</block>",f}if(/^".*"$/.test(r))return`<block type="text"><field name="TEXT">${r.replace(/"/g,"")}</field></block>`;if("true"===r||"false"===r)return`<block type="logic_boolean"><field name="BOOL">${r.toUpperCase()}</field></block>`;if(/^\d+$/.test(r))return`<block type="math_number"><field name="NUM">${r}</field></block>`;if(/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(r))return`<block type="variables_get"><field name="VAR">${r}</field></block>`;if(-1!==r.indexOf("+")&&/^".*"$/.test(r.split("+")[0].trim())){const g=r.split("+").map(S=>S.trim());let f=`<block type="text_join"><mutation items="${g.length}"></mutation>`;return g.forEach((S,Z)=>{f+=`<value name="ADD${Z}">${this.buildArithmeticXml(S)}</value>`}),f+="</block>",f}return""}buildStatementXml(r){const c=r.split(/;|\n/).map(g=>g.trim()).filter(g=>g.length>0);let a="";for(let g of c){const S=g.match(/^print\((.+)\)$/);if(S){a+=`<block type="text_print"><value name="TEXT">${this.buildArithmeticXml(S[1])}</value></block>`;continue}const he=g.match(/^(var|let|const)?\s*([a-zA-Z_][a-zA-Z0-9_]*)\s*=\s*(.+)$/);if(he)a+=`<block type="variables_set"><field name="VAR">${he[2]}</field><value name="VALUE">${this.buildArithmeticXml(he[3])}</value></block>`;else if(-1!==g.indexOf("+")&&/^".*"$/.test(g.split("+")[0].trim())){const ae=g.split("+").map(ve=>ve.trim());a+=`<block type="text_join"><mutation items="${ae.length}"></mutation>`,ae.forEach((ve,H)=>{a+=`<value name="ADD${H}">${this.buildArithmeticXml(ve)}</value>`}),a+="</block>"}}return a}opToBlockly(r){switch(r){case"+":default:return"ADD";case"-":return"MINUS";case"*":return"MULTIPLY";case"/":return"DIVIDE"}}compOpToBlockly(r){switch(r){case"==":default:return"EQ";case"!=":return"NEQ";case">":return"GT";case">=":return"GTE";case"<":return"LT";case"<=":return"LTE"}}constructor(){this.workspace=null}initializeWorkspace(r){const c={toolbox:this.getVariablesToolbox(),collapse:!0,comments:!0,disable:!0,maxBlocks:1/0,trashcan:!0,horizontalLayout:!1,toolboxPosition:"start",css:!0,media:"https://unpkg.com/blockly/media/",rtl:!1,scrollbars:!0,sounds:!0,oneBasedIndex:!0,grid:{spacing:20,length:3,colour:"#ccc",snap:!0},zoom:{controls:!0,wheel:!0,startScale:1,maxScale:3,minScale:.3,scaleSpeed:1.2}};return this.workspace=Hn(r,c),this.workspace&&(this.workspace.getVariableMap().createVariable("item"),console.log('Variable por defecto "item" creada')),this.workspace}getVariablesToolbox(){let r="";return r+='\n        <block type="variables_set">\n          <field name="VAR">item</field>\n        </block>\n        <block type="variables_get">\n          <field name="VAR">item</field>\n        </block>',this.workspace&&this.workspace.getAllVariables().forEach(a=>{const g=a.getName();"item"!==g&&(r+=`\n          <block type="variables_set">\n            <field name="VAR">${g}</field>\n          </block>\n          <block type="variables_get">\n            <field name="VAR">${g}</field>\n          </block>`)}),`\n    <xml xmlns="https://developers.google.com/blockly/xml" id="toolbox" style="display: none">\n      <category name="Variables" colour="#a55b5b">\n        ${r}\n        <button text="Crear variable..." callbackKey="CREATE_VARIABLE"></button>\n      </category>\n      <category name="L\xf3gica" colour="#5b80a5">\n        <block type="logic_boolean">\n          <field name="BOOL">TRUE</field>\n        </block>\n        <block type="logic_boolean">\n          <field name="BOOL">FALSE</field>\n        </block>\n        <block type="logic_compare">\n          <field name="OP">EQ</field>\n        </block>\n        <block type="logic_compare">\n          <field name="OP">NEQ</field>\n        </block>\n        <block type="logic_compare">\n          <field name="OP">GT</field>\n        </block>\n        <block type="logic_compare">\n          <field name="OP">GTE</field>\n        </block>\n        <block type="logic_compare">\n          <field name="OP">LT</field>\n        </block>\n        <block type="logic_compare">\n          <field name="OP">LTE</field>\n        </block>\n        <block type="logic_operation">\n          <field name="OP">AND</field>\n        </block>\n        <block type="logic_operation">\n          <field name="OP">OR</field>\n        </block>\n        <block type="logic_negate"></block>\n      </category>\n      <category name="Control" colour="#e1a91a">\n        <block type="controls_if"></block>\n        <block type="controls_if">\n          <mutation else="1"></mutation>\n        </block>\n        <block type="controls_if">\n          <mutation elseif="1" else="1"></mutation>\n        </block>\n      </category>\n      <category name="Bucles" colour="#5ba58c">\n        <block type="controls_repeat_ext">\n          <value name="TIMES">\n            <shadow type="math_number">\n              <field name="NUM">10</field>\n            </shadow>\n          </value>\n        </block>\n        <block type="controls_whileUntil">\n          <field name="MODE">WHILE</field>\n        </block>\n        <block type="controls_whileUntil">\n          <field name="MODE">UNTIL</field>\n        </block>\n        <block type="controls_for">\n          <field name="VAR">i</field>\n          <value name="FROM">\n            <shadow type="math_number">\n              <field name="NUM">1</field>\n            </shadow>\n          </value>\n          <value name="TO">\n            <shadow type="math_number">\n              <field name="NUM">10</field>\n            </shadow>\n          </value>\n          <value name="BY">\n            <shadow type="math_number">\n              <field name="NUM">1</field>\n            </shadow>\n          </value>\n        </block>\n        <block type="controls_forEach">\n          <field name="VAR">j</field>\n        </block>\n        <block type="controls_flow_statements">\n          <field name="FLOW">BREAK</field>\n        </block>\n        <block type="controls_flow_statements">\n          <field name="FLOW">CONTINUE</field>\n        </block>\n      </category>\n      <category name="Matem\xe1ticas" colour="#5b5ba5">\n        <block type="math_number">\n          <field name="NUM">0</field>\n        </block>\n        <block type="math_arithmetic">\n          <field name="OP">ADD</field>\n        </block>\n        <block type="math_arithmetic">\n          <field name="OP">MINUS</field>\n        </block>\n        <block type="math_arithmetic">\n          <field name="OP">MULTIPLY</field>\n        </block>\n        <block type="math_arithmetic">\n          <field name="OP">DIVIDE</field>\n        </block>\n        <block type="math_single">\n          <field name="OP">ROOT</field>\n        </block>\n        <block type="math_single">\n          <field name="OP">ABS</field>\n        </block>\n        <block type="math_single">\n          <field name="OP">NEG</field>\n        </block>\n        <block type="math_single">\n          <field name="OP">LN</field>\n        </block>\n        <block type="math_single">\n          <field name="OP">LOG10</field>\n        </block>\n        <block type="math_single">\n          <field name="OP">EXP</field>\n        </block>\n        <block type="math_single">\n          <field name="OP">POW10</field>\n        </block>\n        <block type="math_trig">\n          <field name="OP">SIN</field>\n        </block>\n        <block type="math_trig">\n          <field name="OP">COS</field>\n        </block>\n        <block type="math_trig">\n          <field name="OP">TAN</field>\n        </block>\n        <block type="math_constant">\n          <field name="CONSTANT">PI</field>\n        </block>\n        <block type="math_constant">\n          <field name="CONSTANT">E</field>\n        </block>\n        <block type="math_constant">\n          <field name="CONSTANT">GOLDEN_RATIO</field>\n        </block>\n        <block type="math_number_property">\n          <mutation divisor_input="false"></mutation>\n          <field name="PROPERTY">EVEN</field>\n        </block>\n        <block type="math_round">\n          <field name="OP">ROUND</field>\n        </block>\n        <block type="math_on_list">\n          <mutation op="SUM"></mutation>\n          <field name="OP">SUM</field>\n        </block>\n        <block type="math_modulo"></block>\n        <block type="math_constrain">\n          <value name="LOW">\n            <shadow type="math_number">\n              <field name="NUM">1</field>\n            </shadow>\n          </value>\n          <value name="HIGH">\n            <shadow type="math_number">\n              <field name="NUM">100</field>\n            </shadow>\n          </value>\n        </block>\n        <block type="math_random_int">\n          <value name="FROM">\n            <shadow type="math_number">\n              <field name="NUM">1</field>\n            </shadow>\n          </value>\n          <value name="TO">\n            <shadow type="math_number">\n              <field name="NUM">100</field>\n            </shadow>\n          </value>\n        </block>\n        <block type="math_random_float"></block>\n      </category>\n      <category name="Texto" colour="#5ba55b">\n        <block type="text">\n          <field name="TEXT"></field>\n        </block>\n        <block type="text_join">\n          <mutation items="2"></mutation>\n        </block>\n        <block type="text_append">\n          <field name="VAR">item</field>\n        </block>\n        <block type="text_length"></block>\n        <block type="text_isEmpty"></block>\n        <block type="text_indexOf">\n          <field name="END">FIRST</field>\n          <value name="VALUE">\n            <block type="variables_get">\n              <field name="VAR">texto</field>\n            </block>\n          </value>\n        </block>\n        <block type="text_charAt">\n          <mutation at="true"></mutation>\n          <field name="WHERE">FROM_START</field>\n          <value name="VALUE">\n            <block type="variables_get">\n              <field name="VAR">texto</field>\n            </block>\n          </value>\n        </block>\n        <block type="text_getSubstring">\n          <mutation at1="true" at2="true"></mutation>\n          <field name="WHERE1">FROM_START</field>\n          <field name="WHERE2">FROM_START</field>\n          <value name="STRING">\n            <block type="variables_get">\n              <field name="VAR">texto</field>\n            </block>\n          </value>\n        </block>\n        <block type="text_changeCase">\n          <field name="CASE">UPPERCASE</field>\n        </block>\n        <block type="text_trim">\n          <field name="MODE">BOTH</field>\n        </block>\n        <block type="text_print">\n          <value name="TEXT">\n            <shadow type="text">\n              <field name="TEXT">abc</field>\n            </shadow>\n          </value>\n        </block>\n        <block type="text_prompt_ext">\n          <mutation type="TEXT"></mutation>\n          <field name="TYPE">TEXT</field>\n          <value name="TEXT">\n            <shadow type="text">\n              <field name="TEXT">abc</field>\n            </shadow>\n          </value>\n        </block>\n      </category>\n      <category name="Salida" colour="#745ba5">\n        <block type="text_print">\n          <value name="TEXT">\n            <shadow type="text">\n              <field name="TEXT">abc</field>\n            </shadow>\n          </value>\n        </block>\n      </category>\n      <category name="Listas" colour="#745ba5">\n        <block type="lists_create_with">\n          <mutation items="0"></mutation>\n        </block>\n        <block type="lists_create_with">\n          <mutation items="3"></mutation>\n        </block>\n        <block type="lists_repeat">\n          <value name="NUM">\n            <shadow type="math_number">\n              <field name="NUM">5</field>\n            </shadow>\n          </value>\n        </block>\n        <block type="lists_length"></block>\n        <block type="lists_isEmpty"></block>\n        <block type="lists_indexOf">\n          <field name="END">FIRST</field>\n          <value name="VALUE">\n            <block type="variables_get">\n              <field name="VAR">lista</field>\n            </block>\n          </value>\n        </block>\n        <block type="lists_getIndex">\n          <mutation statement="false" at="true"></mutation>\n          <field name="MODE">GET</field>\n          <field name="WHERE">FROM_START</field>\n          <value name="VALUE">\n            <block type="variables_get">\n              <field name="VAR">lista</field>\n            </block>\n          </value>\n        </block>\n        <block type="lists_setIndex">\n          <mutation at="true"></mutation>\n          <field name="MODE">SET</field>\n          <field name="WHERE">FROM_START</field>\n          <value name="LIST">\n            <block type="variables_get">\n              <field name="VAR">lista</field>\n            </block>\n          </value>\n        </block>\n        <block type="lists_getSublist">\n          <mutation at1="true" at2="true"></mutation>\n          <field name="WHERE1">FROM_START</field>\n          <field name="WHERE2">FROM_START</field>\n          <value name="LIST">\n            <block type="variables_get">\n              <field name="VAR">lista</field>\n            </block>\n          </value>\n        </block>\n        <block type="lists_split">\n          <mutation mode="SPLIT"></mutation>\n          <field name="MODE">SPLIT</field>\n          <value name="DELIM">\n            <shadow type="text">\n              <field name="TEXT">,</field>\n            </shadow>\n          </value>\n        </block>\n        <block type="lists_sort">\n          <field name="TYPE">NUMERIC</field>\n          <field name="DIRECTION">1</field>\n        </block>\n      </category>\n      <category name="Funciones" colour="#9a5ba5" custom="PROCEDURE">\n      </category>\n    </xml>\n    `}generateCode(){if(!this.workspace)return"";const r=this.workspace.getTopBlocks(!0);let c="";return console.log("Bloques encontrados:",r.length),r.forEach((a,g)=>{console.log("Procesando cadena de bloques iniciando con:",a.type);let f=a,S="";for(;f;){console.log("Bloque en cadena:",f.type);const Z=this.blockToCode(f);Z&&(S&&(S+="\n"),S+=Z),f=f.getNextBlock()}S&&(c&&(c+="\n"),c+=S)}),console.log("C\xf3digo generado completo:",c),c}blockToCode(r){switch(console.log("Procesando bloque:",r.type),r.type){case"variables_set":const c=r.getFieldValue("VAR"),a=this.workspace.getVariableById(c),g=a?a.getName():c,f=r.getInputTargetBlock("VALUE"),S=f?this.getBlockValue(f):"";return console.log("Variables_set - ID:",c,"Nombre real:",g,"Valor:",S),`var ${g} = ${S};`;case"procedures_defreturn":const Z=r.getFieldValue("NAME"),ae=(r.getVars?r.getVars():[]).join(", ");let ve="";const H=r.getInputTargetBlock("STACK");if(H){let G=H;for(;G;){const J=this.blockToCode(G);J&&(ve+=(ve?"\n  ":"  ")+J),G=G.getNextBlock()}}const Et=r.getInputTargetBlock("RETURN");let X="";return Et&&(X=this.getBlockValue(Et),ve+=(ve?"\n  ":"  ")+`return ${X};`),`function ${Z}(${ae}) {\n${ve}\n}`;case"procedures_defnoreturn":const q=r.getFieldValue("NAME"),re=(r.getVars?r.getVars():[]).join(", ");let Y="";const z=r.getInputTargetBlock("STACK");if(z){let G=z;for(;G;){const J=this.blockToCode(G);J&&(Y+=(Y?"\n  ":"  ")+J),G=G.getNextBlock()}}return`function ${q}(${re}) {\n${Y}\n}`;case"procedures_callreturn":const oe=r.getFieldValue("NAME"),ie=[];if(r.inputList)for(let G=0;G<r.inputList.length;G++){const J=r.inputList[G];if(J.name&&J.connection){const Qe=J.connection.targetBlock();Qe&&ie.push(this.getBlockValue(Qe))}}return`${oe}(${ie.join(", ")})`;case"procedures_callnoreturn":const pe=r.getFieldValue("NAME"),le=[];if(r.inputList)for(let G=0;G<r.inputList.length;G++){const J=r.inputList[G];if(J.name&&J.connection){const Qe=J.connection.targetBlock();Qe&&le.push(this.getBlockValue(Qe))}}return`${pe}(${le.join(", ")});`;case"math_number":const Be=r.getFieldValue("NUM");return console.log("Math_number:",Be),Be;case"text":const Pe=r.getFieldValue("TEXT");return console.log("Text:",Pe),`"${Pe}"`;case"logic_boolean":const Se=r.getFieldValue("BOOL").toLowerCase();return console.log("Logic_boolean:",Se),Se;case"math_arithmetic":const ut=r.getFieldValue("OP"),kt=r.getInputTargetBlock("A"),Xn=r.getInputTargetBlock("B"),Ml=kt?this.getBlockValue(kt):"0",Ft=Xn?this.getBlockValue(Xn):"0";let Ut="+";switch(ut){case"ADD":Ut="+";break;case"MINUS":Ut="-";break;case"MULTIPLY":Ut="*";break;case"DIVIDE":Ut="/"}return console.log("Math_arithmetic - A:",Ml,"Op:",Ut,"B:",Ft),`${Ml} ${Ut} ${Ft}`;case"variables_get":const Ai=r.getFieldValue("VAR");return console.log("Variables_get:",Ai),Ai;case"text_join":const Ns=[];for(let G=0;G<r.inputList.length;G++){const J=r.inputList[G];if(1===J.type){const Qe=J.connection?.targetBlock();Qe&&Ns.push(this.getBlockValue(Qe))}}return console.log("Text_join - inputs:",Ns),Ns.join(" + ");case"text_print":const Nl=r.getInputTargetBlock("TEXT"),Kn=Nl?this.getBlockValue(Nl):'""';return console.log("Text_print - value:",Kn),`print(${Kn});`;case"logic_compare":const gu=r.getFieldValue("OP"),Ds=r.getInputTargetBlock("A"),Jn=r.getInputTargetBlock("B"),Qn=Ds?this.getBlockValue(Ds):"",er=Jn?this.getBlockValue(Jn):"";let Jt="==";switch(gu){case"EQ":Jt="==";break;case"NEQ":Jt="!=";break;case"LT":Jt="<";break;case"LTE":Jt="<=";break;case"GT":Jt=">";break;case"GTE":Jt=">="}return console.log("Logic_compare - A:",Qn,"Op:",Jt,"B:",er),`${Qn} ${Jt} ${er}`;case"logic_operation":const Dl=r.getFieldValue("OP"),Ll=r.getInputTargetBlock("A"),Si=r.getInputTargetBlock("B"),tr=Ll?this.getBlockValue(Ll):"",or=Si?this.getBlockValue(Si):"";let ko="&&";switch(Dl){case"AND":ko="&&";break;case"OR":ko="||"}return console.log("Logic_operation - A:",tr,"Op:",ko,"B:",or),`${tr} ${ko} ${or}`;case"logic_negate":const Bl=r.getInputTargetBlock("BOOL"),ir=Bl?this.getBlockValue(Bl):"";return console.log("Logic_negate - value:",ir),`!(${ir})`;case"controls_if":let Io="",Oi=r.getInputTargetBlock("IF0");const Ri=Oi?this.getBlockValue(Oi):"";let Ls=r.getInputTargetBlock("DO0"),Bs="";if(Ls){let G=Ls;for(;G;){const J=this.blockToCode(G);J&&(Bs+=(Bs?"\n  ":"  ")+J),G=G.getNextBlock()}}Io=`if (${Ri}) {\n${Bs}\n}`;const Pl=r.getInputTargetBlock("ELSE");if(Pl){let G="",J=Pl;for(;J;){const Qe=this.blockToCode(J);Qe&&(G+=(G?"\n  ":"  ")+Qe),J=J.getNextBlock()}Io+=` else {\n${G}\n}`}return console.log("Controls_if - condition:",Ri,"code:",Io),Io;case"controls_repeat_ext":const sr=r.getInputTargetBlock("TIMES"),Fl=sr?this.getBlockValue(sr):"10";let Ps=r.getInputTargetBlock("DO"),Mi="";if(Ps){let G=Ps;for(;G;){const J=this.blockToCode(G);J&&(Mi+=(Mi?"\n  ":"  ")+J),G=G.getNextBlock()}}const Ul=`for (let i = 0; i < ${Fl}; i++) {\n${Mi}\n}`;return console.log("Controls_repeat_ext - times:",Fl,"code:",Ul),Ul;case"controls_whileUntil":const Fs=r.getFieldValue("MODE"),Zl=r.getInputTargetBlock("BOOL"),nr=Zl?this.getBlockValue(Zl):"false";let Hl=r.getInputTargetBlock("DO"),Zt="";if(Hl){let G=Hl;for(;G;){const J=this.blockToCode(G);J&&(Zt+=(Zt?"\n  ":"  ")+J),G=G.getNextBlock()}}const rr="WHILE"===Fs?nr:`!(${nr})`,Ni=`while (${rr}) {\n${Zt}\n}`;return console.log("Controls_whileUntil - mode:",Fs,"condition:",rr),Ni;case"controls_for":const Di=r.getFieldValue("VAR"),lr=r.getInputTargetBlock("FROM"),Us=r.getInputTargetBlock("TO"),cr=r.getInputTargetBlock("BY"),ar=lr?this.getBlockValue(lr):"1",ur=Us?this.getBlockValue(Us):"10",dr=cr?this.getBlockValue(cr):"1";let hr=r.getInputTargetBlock("DO"),Zs="";if(hr){let G=hr;for(;G;){const J=this.blockToCode(G);J&&(Zs+=(Zs?"\n  ":"  ")+J),G=G.getNextBlock()}}const Gl=`for (let ${Di} = ${ar}; ${Di} <= ${ur}; ${Di} += ${dr}) {\n${Zs}\n}`;return console.log("Controls_for - var:",Di,"from:",ar,"to:",ur,"by:",dr),Gl;case"math_single":const pr=r.getFieldValue("OP"),gr=r.getInputTargetBlock("NUM"),wo=gr?this.getBlockValue(gr):"0";let Ht="";switch(pr){case"ROOT":Ht=`Math.sqrt(${wo})`;break;case"ABS":Ht=`Math.abs(${wo})`;break;case"NEG":Ht=`-(${wo})`;break;case"LN":Ht=`Math.log(${wo})`;break;case"LOG10":Ht=`Math.log10(${wo})`;break;case"EXP":Ht=`Math.exp(${wo})`;break;case"POW10":Ht=`Math.pow(10, ${wo})`}return console.log("Math_single - op:",pr,"result:",Ht),Ht;case"math_trig":const mr=r.getFieldValue("OP"),Vl=r.getInputTargetBlock("NUM"),Ko=Vl?this.getBlockValue(Vl):"0";let Qt="";switch(mr){case"SIN":Qt=`Math.sin(${Ko})`;break;case"COS":Qt=`Math.cos(${Ko})`;break;case"TAN":Qt=`Math.tan(${Ko})`;break;case"ASIN":Qt=`Math.asin(${Ko})`;break;case"ACOS":Qt=`Math.acos(${Ko})`;break;case"ATAN":Qt=`Math.atan(${Ko})`}return console.log("Math_trig - op:",mr,"result:",Qt),Qt;case"math_constant":const ql=r.getFieldValue("CONSTANT");let eo="";switch(ql){case"PI":eo="Math.PI";break;case"E":eo="Math.E";break;case"GOLDEN_RATIO":eo="1.618033988749895";break;case"SQRT2":eo="Math.SQRT2";break;case"SQRT1_2":eo="Math.SQRT1_2";break;case"INFINITY":eo="Infinity"}return console.log("Math_constant - constant:",ql,"result:",eo),eo;case"math_random_int":const $r=r.getInputTargetBlock("FROM"),_r=r.getInputTargetBlock("TO"),Hs=$r?this.getBlockValue($r):"1",br=_r?this.getBlockValue(_r):"100",Wl=`Math.floor(Math.random() * (${br} - ${Hs} + 1)) + ${Hs}`;return console.log("Math_random_int - from:",Hs,"to:",br),Wl;case"math_random_float":return console.log("Math_random_float"),"Math.random()";case"lists_create_with":const Gs=[];for(let G=0;G<r.inputList.length;G++){const J=r.inputList[G];if(1===J.type){const Qe=J.connection?.targetBlock();Qe&&Gs.push(this.getBlockValue(Qe))}}const zl=`[${Gs.join(", ")}]`;return console.log("Lists_create_with - items:",Gs),zl;case"lists_length":const Vs=r.getInputTargetBlock("VALUE"),Li=Vs?this.getBlockValue(Vs):"[]",jl=`${Li}.length`;return console.log("Lists_length - list:",Li),jl;case"text_length":const Yl=r.getInputTargetBlock("VALUE"),fr=Yl?this.getBlockValue(Yl):'""',Xl=`${fr}.length`;return console.log("Text_length - text:",fr),Xl;case"text_isEmpty":const Tr=r.getInputTargetBlock("VALUE"),Er=Tr?this.getBlockValue(Tr):'""',Kl=`${Er}.length === 0`;return console.log("Text_isEmpty - text:",Er),Kl;default:return console.log("Bloque no reconocido:",r.type),""}}getBlockValue(r){switch(console.log("getBlockValue called for block type:",r.type),r.type){case"math_number":const c=r.getFieldValue("NUM");return console.log("Math_number value:",c),c;case"text":const a=r.getFieldValue("TEXT");return console.log("Text value:",a),`"${a}"`;case"logic_boolean":const g=r.getFieldValue("BOOL").toLowerCase();return console.log("Logic_boolean value:",g),g;case"variables_get":const f=r.getFieldValue("VAR"),S=this.workspace.getVariableById(f),Z=S?S.getName():f;return console.log("Variables_get - ID:",f,"Nombre real:",Z),Z;case"math_arithmetic":const he=this.blockToCode(r);return console.log("Math_arithmetic value:",he),he;case"logic_compare":const ae=this.blockToCode(r);return console.log("Logic_compare value:",ae),ae;case"logic_operation":const ve=this.blockToCode(r);return console.log("Logic_operation value:",ve),ve;case"logic_negate":const H=this.blockToCode(r);return console.log("Logic_negate value:",H),H;case"text_join":const Et=this.blockToCode(r);return console.log("Text_join value:",Et),Et;case"math_single":const X=this.blockToCode(r);return console.log("Math_single value:",X),X;case"math_trig":const q=this.blockToCode(r);return console.log("Math_trig value:",q),q;case"math_constant":const W=this.blockToCode(r);return console.log("Math_constant value:",W),W;case"math_random_int":const re=this.blockToCode(r);return console.log("Math_random_int value:",re),re;case"math_random_float":const Y=this.blockToCode(r);return console.log("Math_random_float value:",Y),Y;case"lists_create_with":const z=this.blockToCode(r);return console.log("Lists_create_with value:",z),z;case"lists_length":const oe=this.blockToCode(r);return console.log("Lists_length value:",oe),oe;case"text_length":const ie=this.blockToCode(r);return console.log("Text_length value:",ie),ie;case"text_isEmpty":const pe=this.blockToCode(r);return console.log("Text_isEmpty value:",pe),pe;default:const le=this.blockToCode(r);return console.log("Default case - block type:",r.type,"value:",le),le}}clearWorkspace(){this.workspace&&this.workspace.clear()}getWorkspace(){return this.workspace}dispose(){this.workspace&&(this.workspace.dispose(),this.workspace=null)}validateCode(r,c){console.log("=== VALIDACI\xd3N DE C\xd3DIGO ==="),console.log("C\xf3digo generado original:",JSON.stringify(r)),console.log("C\xf3digo esperado original:",JSON.stringify(c));const a=this.normalizeForComparison(r),g=this.normalizeForComparison(c);console.log("C\xf3digo generado normalizado:",JSON.stringify(a)),console.log("C\xf3digo esperado normalizado:",JSON.stringify(g));const f=a===g;console.log("Comparaci\xf3n normalizada:",f);const S=this.flexibleCodeComparison(r,c);console.log("Comparaci\xf3n flexible:",S);const Z=f||S;return console.log("Resultado final de validaci\xf3n:",Z),console.log("=== FIN VALIDACI\xd3N ==="),Z}normalizeForComparison(r){return r.replace(/\bvar\b/g,"let").replace(/\s+/g," ").replace(/;\s*}/g," }").replace(/;\s*$/gm,"").replace(/'/g,'"').replace(/\s*([+\-*/%=<>!&|])\s*/g," $1 ").replace(/\s*([{}();,])\s*/g,"$1").trim().toLowerCase()}flexibleCodeComparison(r,c){const a=r.split("\n").map(f=>f.trim()).filter(f=>f.length>0),g=c.split("\n").map(f=>f.trim()).filter(f=>f.length>0);if(a.length!==g.length)return console.log(`Diferente n\xfamero de l\xedneas: generado ${a.length}, esperado ${g.length}`),!1;for(let f=0;f<a.length;f++){const S=this.normalizeCodeLine(a[f]),Z=this.normalizeCodeLine(g[f]);if(S!==Z)return console.log(`L\xednea ${f+1} no coincide:`),console.log("  Generada:",a[f]),console.log("  Esperada:",g[f]),console.log("  Gen normalizada:",S),console.log("  Esp normalizada:",Z),!1}return!0}normalizeCodeLine(r){return r.replace(/\bvar\b/g,"let").replace(/\s+/g," ").replace(/;$/,"").replace(/'/g,'"').replace(/\s*([=!<>]+)\s*/g," $1 ").replace(/\s*([+\-*/%])\s*/g," $1 ").trim().toLowerCase()}setupCallbacks(r){this.workspace&&this.workspace.registerButtonCallback("CREATE_VARIABLE",()=>{console.log("Bot\xf3n crear variable presionado"),r?r.showCreateVariableDialog(c=>{this.createVariable(c)}):wa.createVariableButtonHandler(this.workspace)})}createVariable(r){if(!this.workspace||!r.trim())return null;try{const c=this.workspace.getVariableMap().createVariable(r.trim());return console.log("Variable creada con nueva API:",r),setTimeout(()=>{this.refreshToolbox()},100),c}catch(c){return console.error("Error creando variable:",c),null}}refreshToolbox(){if(this.workspace)try{console.log("Refrescando toolbox con variables actuales...");const r=this.getVariablesToolbox();console.log("Nuevo toolbox XML generado"),this.workspace.updateToolbox(r),console.log("Toolbox actualizado exitosamente");const c=this.workspace.getToolbox();c&&(c.refreshSelection(),console.log("Selecci\xf3n del toolbox refrescada"))}catch(r){console.warn("Error refrescando toolbox:",r),this.fallbackRefresh()}}fallbackRefresh(){try{if(console.log("Intentando fallback refresh..."),this.workspace){const r=this.workspace.getToolbox();r&&r.refreshTheme&&r.refreshTheme(),this.workspace.render()}}catch(r){console.warn("Error en fallback refresh:",r)}}setupCustomDialogs(r){try{if(Cs&&Cs.setPrompt)Cs.setPrompt((c,a,g)=>{c.toLowerCase().includes("variable")||c.toLowerCase().includes("nombre")?r.showCreateVariableDialog(g):g(prompt(c,a))}),Cs.setConfirm((c,a)=>{if(c.toLowerCase().includes("delete")||c.toLowerCase().includes("eliminar")){const g=this.extractVariableNameFromMessage(c);r.showDeleteVariableDialog(g,()=>a(!0)),r.onCancelDeleteVariable=()=>a(!1)}else{const g=confirm(c);a(g)}});else{const c=window.prompt,a=window.confirm;window.blocklyPrompt=c,window.blocklyConfirm=a,window.prompt=(g,f)=>g&&(g.toLowerCase().includes("variable")||g.toLowerCase().includes("nombre"))?(r.showCreateVariableDialog(S=>{}),null):c(g,f),window.confirm=g=>{if(g&&(g.toLowerCase().includes("delete")||g.toLowerCase().includes("eliminar"))){const f=this.extractVariableNameFromMessage(g);return r.showDeleteVariableDialog(f,()=>{}),!1}return a(g)}}}catch(c){console.warn("No se pudieron configurar los di\xe1logos personalizados:",c)}}extractVariableNameFromMessage(r){const c=r.match(/"([^"]+)"/);return c?c[1]:"variable"}static{this.\u0275fac=function(c){return new(c||u)}}static{this.\u0275prov=t.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"})}}return u})();var Yo=Ee(95);const Ss=["blocklyDiv"];function qa(u,T){1&u&&(t.O4$(),t._UZ(0,"path",44))}function Os(u,T){1&u&&(t.O4$(),t._UZ(0,"path",45))}function xl(u,T){1&u&&(t.O4$(),t._UZ(0,"path",46))}function Rs(u,T){if(1&u&&(t.TgZ(0,"div",47),t.O4$(),t.TgZ(1,"svg",48),t._UZ(2,"circle",49)(3,"circle",50),t.qZA(),t.kcU(),t.TgZ(4,"div",51),t._uU(5),t.qZA()()),2&u){const r=t.oxw(2);t.xp6(5),t.hij("Cargando Blockly... ",r.loadingPercent,"%")}}function Wa(u,T){if(1&u){const r=t.EpF();t.TgZ(0,"img",59),t.NdJ("click",function(){t.CHM(r);const a=t.oxw(3);return t.KtG(a.showGifModal=!0)}),t.qZA()}if(2&u){const r=t.oxw(3);t.Q6J("src",r.urlgif,t.LSH)}}function za(u,T){if(1&u){const r=t.EpF();t.TgZ(0,"div",52),t.NdJ("mouseleave",function(){t.CHM(r);const a=t.oxw(2);return t.KtG(a.hideSolutionToast())}),t.TgZ(1,"div",53),t.O4$(),t.TgZ(2,"svg",54),t._UZ(3,"path",38)(4,"path",39),t.qZA(),t.kcU(),t.TgZ(5,"span",55),t.NdJ("click",function(){t.CHM(r);const a=t.oxw(2);return t.KtG(a.showGifModal=!0)}),t._uU(6,"Ejemplo de uso"),t.qZA()(),t.TgZ(7,"div",56),t.YNc(8,Wa,1,1,"img",57),t.qZA(),t.TgZ(9,"div",58),t._uU(10,"Vista previa generada autom\xe1ticamente"),t.qZA()()}if(2&u){const r=t.oxw(2);t.xp6(8),t.Q6J("ngIf",r.urlgif)}}function Co(u,T){1&u&&(t.O4$(),t.TgZ(0,"svg",34),t._UZ(1,"path",60),t.qZA())}function Cl(u,T){1&u&&(t.O4$(),t.TgZ(0,"svg",61),t._UZ(1,"circle",62)(2,"path",63),t.qZA())}function Bt(u,T){if(1&u){const r=t.EpF();t.TgZ(0,"div",3)(1,"div",4)(2,"div",5)(3,"div",6)(4,"div",7)(5,"div",8)(6,"div",9),t.O4$(),t.TgZ(7,"svg",10),t.YNc(8,qa,1,0,"path",11),t.YNc(9,Os,1,0,"path",12),t.YNc(10,xl,1,0,"path",13),t.qZA()(),t.kcU(),t.TgZ(11,"div",14),t._uU(12),t.qZA()(),t.TgZ(13,"h2",15),t._uU(14),t.qZA()(),t.TgZ(15,"p",16),t._uU(16),t.qZA(),t.TgZ(17,"div",17)(18,"h3",18),t._uU(19,"\u{1f4cb} Instrucciones:"),t.qZA(),t.TgZ(20,"p",19),t._uU(21),t.qZA()(),t._UZ(22,"div",20),t.TgZ(23,"div",21)(24,"button",22),t.NdJ("click",function(){t.CHM(r);const a=t.oxw();return t.KtG(a.onPreviousExercise())}),t.O4$(),t.TgZ(25,"svg",10),t._UZ(26,"path",23),t.qZA()(),t.kcU(),t.TgZ(27,"span",24),t._uU(28),t.qZA(),t.TgZ(29,"button",25),t.NdJ("click",function(){t.CHM(r);const a=t.oxw();return t.KtG(a.onNextExercise())}),t.O4$(),t.TgZ(30,"svg",10),t._UZ(31,"path",26),t.qZA()()()()(),t.kcU(),t.TgZ(32,"div",27),t.YNc(33,Rs,6,1,"div",28),t.TgZ(34,"div",29),t._UZ(35,"div",30,31),t.qZA(),t.TgZ(37,"div",32)(38,"div",8)(39,"button",33),t.NdJ("click",function(){t.CHM(r);const a=t.oxw();return t.KtG(a.resetWorkspace())}),t.O4$(),t.TgZ(40,"svg",34),t._UZ(41,"path",35),t.qZA()(),t.kcU(),t.TgZ(42,"div",14),t._uU(43," Reiniciar "),t.qZA()(),t.TgZ(44,"div",8)(45,"button",36),t.NdJ("mouseenter",function(){t.CHM(r);const a=t.oxw();return t.KtG(a.showHelpIdea())}),t.O4$(),t.TgZ(46,"svg",37),t._UZ(47,"path",38)(48,"path",39),t.qZA()(),t.kcU(),t.TgZ(49,"div",14),t._uU(50," ejemplo "),t.qZA()(),t.YNc(51,za,11,1,"div",40),t.TgZ(52,"div",8)(53,"button",41),t.NdJ("click",function(){t.CHM(r);const a=t.oxw();return t.KtG(a.validateSolution())}),t.YNc(54,Co,2,0,"svg",42),t.YNc(55,Cl,3,0,"svg",43),t.qZA(),t.TgZ(56,"div",14),t._uU(57," Validar "),t.qZA()()()()()()}if(2&u){const r=t.oxw();t.xp6(6),t.Udp("background-color",r.getDifficultyColor(r.currentExercise.difficulty))("border-color",r.getDifficultyBorderColor(r.currentExercise.difficulty)),t.xp6(2),t.Q6J("ngIf","easy"===r.currentExercise.difficulty),t.xp6(1),t.Q6J("ngIf","medium"===r.currentExercise.difficulty),t.xp6(1),t.Q6J("ngIf","hard"===r.currentExercise.difficulty),t.xp6(2),t.hij(" ",r.getDifficultyText(r.currentExercise.difficulty)," "),t.xp6(2),t.Oqu(r.currentExercise.title),t.xp6(2),t.Oqu(r.currentExercise.description),t.xp6(5),t.Oqu(r.currentExercise.instructions),t.xp6(3),t.Udp("background-color",r.canGoPrevious?"#f3ae22":"")("border-color",r.canGoPrevious?"#d18c00":""),t.ekj("opacity-50",!r.canGoPrevious)("cursor-not-allowed",!r.canGoPrevious),t.Q6J("disabled",!r.canGoPrevious),t.xp6(4),t.AsE(" ",r.currentExerciseIndex+1," de ",r.exercises.length," "),t.xp6(1),t.ekj("opacity-50",!r.canGoNext)("cursor-not-allowed",!r.canGoNext),t.Q6J("disabled",!r.canGoNext),t.xp6(4),t.Q6J("ngIf",r.isLoadingBlockly),t.xp6(1),t.ekj("opacity-0",r.isLoadingBlockly)("pointer-events-none",r.isLoadingBlockly),t.xp6(17),t.Q6J("ngIf",r.showSolutionToast),t.xp6(2),t.Q6J("disabled",r.isValidating),t.xp6(1),t.Q6J("ngIf",!r.isValidating),t.xp6(1),t.Q6J("ngIf",r.isValidating)}}function ja(u,T){if(1&u&&(t.TgZ(0,"div",64)(1,"div",65)(2,"div",66),t.O4$(),t.TgZ(3,"svg",67),t._UZ(4,"path",60),t.qZA(),t.kcU(),t.TgZ(5,"div")(6,"p",68),t._uU(7,"\xa1Perfecto!"),t.qZA(),t.TgZ(8,"p",69),t._uU(9),t.qZA()()()()()),2&u){const r=t.oxw();t.xp6(9),t.Oqu(r.currentMessage)}}function Ya(u,T){if(1&u&&(t.TgZ(0,"div",64)(1,"div",70)(2,"div",66),t.O4$(),t.TgZ(3,"svg",67),t._UZ(4,"path",71),t.qZA(),t.kcU(),t.TgZ(5,"div")(6,"p",68),t._uU(7,"Int\xe9ntalo de nuevo"),t.qZA(),t.TgZ(8,"p",69),t._uU(9),t.qZA()()()()()),2&u){const r=t.oxw();t.xp6(9),t.Oqu(r.currentMessage)}}function kl(u,T){if(1&u){const r=t.EpF();t.TgZ(0,"div",64)(1,"div",72)(2,"div",73)(3,"h3",74),t._uU(4,"Crear Nueva Variable"),t.qZA(),t.TgZ(5,"p",75),t._uU(6,"Ingresa el nombre para tu nueva variable"),t.qZA()(),t.TgZ(7,"div",73)(8,"label",76),t._uU(9,"Nombre de la variable"),t.qZA(),t.TgZ(10,"input",77,78),t.NdJ("ngModelChange",function(a){t.CHM(r);const g=t.oxw();return t.KtG(g.newVariableName=a)})("keyup.enter",function(){t.CHM(r);const a=t.oxw();return t.KtG(a.confirmCreateVariable())})("keyup.escape",function(){t.CHM(r);const a=t.oxw();return t.KtG(a.cancelCreateVariable())}),t.qZA()(),t.TgZ(12,"div",79)(13,"button",80),t.NdJ("click",function(){t.CHM(r);const a=t.oxw();return t.KtG(a.cancelCreateVariable())}),t._uU(14," Cancelar "),t.qZA(),t.TgZ(15,"button",81),t.NdJ("click",function(){t.CHM(r);const a=t.oxw();return t.KtG(a.confirmCreateVariable())}),t._uU(16," Crear Variable "),t.qZA()()()()}if(2&u){const r=t.oxw();t.xp6(10),t.Q6J("ngModel",r.newVariableName),t.xp6(5),t.Q6J("disabled",!(null!=r.newVariableName&&r.newVariableName.trim()))}}function Xa(u,T){if(1&u){const r=t.EpF();t.TgZ(0,"div",64)(1,"div",72)(2,"div",73)(3,"h3",74),t._uU(4,"Renombrar Variable"),t.qZA(),t.TgZ(5,"p",75),t._uU(6),t.qZA()(),t.TgZ(7,"div",73)(8,"label",76),t._uU(9,"Nuevo nombre de la variable"),t.qZA(),t.TgZ(10,"input",82,83),t.NdJ("ngModelChange",function(a){t.CHM(r);const g=t.oxw();return t.KtG(g.newVariableName=a)})("keyup.enter",function(){t.CHM(r);const a=t.oxw();return t.KtG(a.confirmRenameVariable())})("keyup.escape",function(){t.CHM(r);const a=t.oxw();return t.KtG(a.cancelRenameVariable())}),t.qZA()(),t.TgZ(12,"div",79)(13,"button",80),t.NdJ("click",function(){t.CHM(r);const a=t.oxw();return t.KtG(a.cancelRenameVariable())}),t._uU(14," Cancelar "),t.qZA(),t.TgZ(15,"button",81),t.NdJ("click",function(){t.CHM(r);const a=t.oxw();return t.KtG(a.confirmRenameVariable())}),t._uU(16," Renombrar "),t.qZA()()()()}if(2&u){const r=t.oxw();t.xp6(6),t.hij('Cambia el nombre de la variable "',r.currentVariableName,'"'),t.xp6(4),t.Q6J("ngModel",r.newVariableName),t.xp6(5),t.Q6J("disabled",!(null!=r.newVariableName&&r.newVariableName.trim()))}}function Xo(u,T){if(1&u){const r=t.EpF();t.TgZ(0,"div",64)(1,"div",72)(2,"div",73)(3,"h3",74),t._uU(4,"Eliminar Variable"),t.qZA(),t.TgZ(5,"p",75),t._uU(6),t.qZA(),t.TgZ(7,"p",84),t._uU(8,"Esta acci\xf3n no se puede deshacer"),t.qZA()(),t.TgZ(9,"div",79)(10,"button",80),t.NdJ("click",function(){t.CHM(r);const a=t.oxw();return t.KtG(a.cancelDeleteVariable())}),t._uU(11," Cancelar "),t.qZA(),t.TgZ(12,"button",85),t.NdJ("click",function(){t.CHM(r);const a=t.oxw();return t.KtG(a.confirmDeleteVariable())}),t._uU(13," Eliminar "),t.qZA()()()()}if(2&u){const r=t.oxw();t.xp6(6),t.hij('\xbfEst\xe1s seguro de que quieres eliminar la variable "',r.currentVariableName,'"? ')}}function Il(u,T){if(1&u&&(t.O4$(),t.kcU(),t._UZ(0,"img",91)),2&u){const r=t.oxw(2);t.Q6J("src",r.urlgif,t.LSH)}}function Ka(u,T){if(1&u){const r=t.EpF();t.TgZ(0,"div",86)(1,"div",87)(2,"button",88),t.NdJ("click",function(){t.CHM(r);const a=t.oxw();return t.KtG(a.showGifModal=!1)})("keydown.escape",function(){t.CHM(r);const a=t.oxw();return t.KtG(a.showGifModal=!1)}),t.O4$(),t.TgZ(3,"svg",37),t._UZ(4,"path",89),t.qZA()(),t.YNc(5,Il,1,1,"img",90),t.qZA()()}if(2&u){const r=t.oxw();t.xp6(5),t.Q6J("ngIf",r.urlgif)}}let Ms=(()=>{class u{onEscapeKey(r){this.showGifModal&&(this.showGifModal=!1,r.preventDefault())}constructor(r){this.blocklyService=r,this.isLoadingBlockly=!0,this.loadingPercent=0,this.showGifModal=!1,this.exercises=[],this.urlgif="",this.currentExerciseIndex=0,this.exerciseCompleted=new t.vpe,this.nextExercise=new t.vpe,this.previousExercise=new t.vpe,this.workspace=null,this.showSuccess=!1,this.showError=!1,this.currentMessage="",this.isValidating=!1,this.showCreateVariableModal=!1,this.showRenameVariableModal=!1,this.showDeleteVariableModal=!1,this.newVariableName="",this.currentVariableName="",this.currentVariableCallback=null,this.onCancelDeleteVariable=null,this.showSolutionToast=!1,this.solutionToastTimeout=null,this.solutionPreviewWorkspace=null}ngOnInit(){}ngAfterViewInit(){this.isLoadingBlockly=!0,this.loadingPercent=0;const r=setInterval(()=>{this.loadingPercent<90&&(this.loadingPercent+=Math.floor(10*Math.random())+1,this.loadingPercent>90&&(this.loadingPercent=90))},30);setTimeout(()=>{this.initializeBlockly(),setTimeout(()=>{this.loadingPercent=100,this.isLoadingBlockly=!1,clearInterval(r),this.workspace&&Vn(this.workspace)},400)},600)}ngOnDestroy(){this.blocklyService.dispose(),this.hideSolutionToast()}get currentExercise(){return this.exercises[this.currentExerciseIndex]||null}get canGoPrevious(){return this.currentExerciseIndex>0}get canGoNext(){return this.currentExerciseIndex<this.exercises.length-1}initializeBlockly(){this.blocklyDiv&&this.blocklyDiv.nativeElement&&(this.workspace=this.blocklyService.initializeWorkspace(this.blocklyDiv.nativeElement),this.blocklyService.setupCallbacks(this),this.blocklyService.setupCustomDialogs(this),console.log("Blockly workspace initialized with custom dialogs"),setTimeout(()=>{this.hideBlocklyScrollbars()},100),setTimeout(()=>{this.workspace&&Vn(this.workspace)},200),this.workspace&&this.workspace.addChangeListener(()=>{setTimeout(()=>{this.hideBlocklyScrollbars()},50)}))}hideBlocklyScrollbars(){const r=this.blocklyDiv?.nativeElement;r&&(r.querySelectorAll(".blocklyScrollbarHandle, .blocklyScrollbarBackground, .blocklyScrollbarVertical, .blocklyScrollbarHorizontal").forEach(g=>{g.style.display="none",g.style.visibility="hidden"}),r.querySelectorAll("*").forEach(g=>{g.style.overflow="hidden"}))}validateSolution(){this.currentExercise&&(this.isValidating=!0,this.showSuccess=!1,this.showError=!1,setTimeout(()=>{const r=this.blocklyService.generateCode();console.log("C\xf3digo generado por el usuario:",r),console.log("C\xf3digo esperado:",this.currentExercise.expectedCode);const c=this.blocklyService.validateCode(r,this.currentExercise.expectedCode);console.log("\xbfEs correcto?",c),c?(this.showSuccessMessage(),this.exerciseCompleted.emit({exerciseId:this.currentExercise.id,success:!0})):(this.showErrorMessage(),this.exerciseCompleted.emit({exerciseId:this.currentExercise.id,success:!1})),this.isValidating=!1},1e3))}generateCodeFromBlocks(){return this.blocklyService.generateCode()}compareCode(r,c){return this.blocklyService.validateCode(r,c)}showSuccessMessage(){this.showSuccess=!0,this.currentMessage="\xa1Excelente! Has completado el ejercicio correctamente. \u{1f389}",setTimeout(()=>{this.showSuccess=!1},3e3)}showErrorMessage(){this.showError=!0,this.currentMessage="La soluci\xf3n no es correcta. Revisa las instrucciones e int\xe9ntalo de nuevo. \u{1f4aa}",setTimeout(()=>{this.showError=!1},3e3)}onPreviousExercise(){this.canGoPrevious&&(this.resetWorkspace(),this.previousExercise.emit())}onNextExercise(){this.canGoNext&&(this.resetWorkspace(),this.nextExercise.emit())}resetWorkspace(){this.blocklyService.clearWorkspace(),this.showSuccess=!1,this.showError=!1,this.isValidating=!1,this.showCreateVariableModal=!1,this.showRenameVariableModal=!1,this.showDeleteVariableModal=!1,this.newVariableName="",this.currentVariableName="",this.currentVariableCallback=null,this.onCancelDeleteVariable=null,this.hideSolutionToast(),setTimeout(()=>{this.hideBlocklyScrollbars()},100),setTimeout(()=>{this.workspace&&Vn(this.workspace)},200)}getDifficultyColor(r){switch(r){case"easy":return"#10B981";case"medium":return"#F59E0B";case"hard":return"#EF4444";default:return"#6B7280"}}getDifficultyBorderColor(r){switch(r){case"easy":return"#047857";case"medium":return"#D97706";case"hard":return"#DC2626";default:return"#4B5563"}}getDifficultyText(r){switch(r){case"easy":return"F\xe1cil";case"medium":return"Intermedio";case"hard":return"Dif\xedcil";default:return"Normal"}}showCreateVariableDialog(r){this.currentVariableCallback=r,this.newVariableName="",this.showCreateVariableModal=!0,setTimeout(()=>{document.getElementById("variableNameInput")?.focus()},100)}confirmCreateVariable(){const r=this.newVariableName.trim();console.log("Intentando crear variable:",r),r&&this.currentVariableCallback?(console.log("Ejecutando callback para crear variable"),this.currentVariableCallback(r),setTimeout(()=>{console.log("Variables en workspace despu\xe9s de crear:",this.getWorkspaceVariables())},500),this.cancelCreateVariable()):console.log("No se puede crear variable - nombre vac\xedo o callback nulo")}getWorkspaceVariables(){return this.workspace?this.workspace.getAllVariables().map(r=>r.getName()):[]}cancelCreateVariable(){this.showCreateVariableModal=!1,this.newVariableName="",this.currentVariableCallback=null}showRenameVariableDialog(r,c){this.currentVariableName=r,this.currentVariableCallback=c,this.newVariableName=r,this.showRenameVariableModal=!0,setTimeout(()=>{const a=document.getElementById("renameVariableInput");a?.focus(),a?.select()},100)}confirmRenameVariable(){const r=this.newVariableName.trim();r&&this.currentVariableCallback&&(this.currentVariableCallback(r),this.cancelRenameVariable())}cancelRenameVariable(){this.showRenameVariableModal=!1,this.newVariableName="",this.currentVariableName="",this.currentVariableCallback=null}showDeleteVariableDialog(r,c){this.currentVariableName=r,this.currentVariableCallback=c,this.showDeleteVariableModal=!0}confirmDeleteVariable(){this.currentVariableCallback&&(this.currentVariableCallback(),this.cancelDeleteVariable())}cancelDeleteVariable(){this.showDeleteVariableModal=!1,this.currentVariableName="",this.currentVariableCallback=null,this.onCancelDeleteVariable&&(this.onCancelDeleteVariable(),this.onCancelDeleteVariable=null)}showHelpIdea(){this.showSolutionPreview()}showSolutionPreview(){this.currentExercise&&(this.showSolutionToast=!0,clearTimeout(this.solutionToastTimeout),this.renderSolutionBlocks(this.currentExercise.expectedCode),this.solutionToastTimeout=setTimeout(()=>{this.hideSolutionToast()},5e3))}hideSolutionToast(){this.showSolutionToast=!1,clearTimeout(this.solutionToastTimeout),this.solutionPreviewWorkspace&&(this.solutionPreviewWorkspace.dispose(),this.solutionPreviewWorkspace=null)}keepSolutionToast(){clearTimeout(this.solutionToastTimeout),this.solutionToastTimeout=setTimeout(()=>{this.hideSolutionToast()},5e3)}renderSolutionBlocks(r){setTimeout(()=>{const c=document.getElementById("solutionToastBlocklyDiv");if(c){this.solutionPreviewWorkspace&&this.solutionPreviewWorkspace.dispose();const a=this.parseExpectedCodeToBlocklyXml(r),f=(new DOMParser).parseFromString(a,"text/xml");this.solutionPreviewWorkspace=Hn(c,{readOnly:!0,scrollbars:!1,media:"media/",renderer:"zelos"}),bl.domToWorkspace(f.documentElement,this.solutionPreviewWorkspace)}},100)}parseExpectedCodeToBlocklyXml(r){return this.blocklyService.codeToBlocksXml(r)}static{this.\u0275fac=function(c){return new(c||u)(t.Y36(yl))}}static{this.\u0275cmp=t.Xpm({type:u,selectors:[["app-blockly-exercise"]],viewQuery:function(c,a){if(1&c&&t.Gf(Ss,5),2&c){let g;t.iGM(g=t.CRH())&&(a.blocklyDiv=g.first)}},hostBindings:function(c,a){1&c&&t.NdJ("keydown.escape",function(f){return a.onEscapeKey(f)},!1,t.evT)},inputs:{exercises:"exercises",urlgif:"urlgif",currentExerciseIndex:"currentExerciseIndex"},outputs:{exerciseCompleted:"exerciseCompleted",nextExercise:"nextExercise",previousExercise:"previousExercise"},decls:8,vars:7,consts:[["class","w-full",4,"ngIf"],["class","fixed inset-0 z-[9999] flex items-center justify-center bg-black bg-opacity-50",4,"ngIf"],["class","fixed inset-0 z-[999999] flex items-center justify-center bg-black bg-opacity-80","style","z-index:999999;",4,"ngIf"],[1,"w-full"],[1,"grid","grid-cols-12","gap-6","min-h-[600px]"],[1,"col-span-4","flex","items-center","justify-center","relative"],[1,"px-4","py-3","w-full","max-w-sm"],[1,"flex","items-center","space-x-3","mb-1"],[1,"relative","group"],[1,"w-8","h-8","text-white","rounded-full","shadow-lg","flex","items-center","justify-center","border-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 10V3L4 14h7v7l9-11h-7z",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17.657 18.657A8 8 0 016.343 7.343S7 9 9 10c0-2 .5-5 2.986-7C14 5 16.09 5.777 17.656 7.343A7.975 7.975 0 0120 13a7.975 7.975 0 01-2.343 5.657z",4,"ngIf"],[1,"absolute","left-1/2","transform","-translate-x-1/2","-top-8","bg-gray-800","text-white","text-xs","rounded","py-1","px-2","opacity-0","group-hover:opacity-100","transition-opacity","duration-200","whitespace-nowrap","z-10"],[1,"text-xl","font-bold","text-gray-800"],[1,"text-gray-600","text-sm","mb-2"],[1,"bg-blue-50","border-l-4","border-blue-400","p-2","rounded-r-lg","mb-4"],[1,"font-semibold","text-blue-800","mb-1","text-sm"],[1,"text-blue-700","text-sm"],[1,"border-t","border-gray-200","w-full"],[1,"flex","justify-between","items-center","pt-4"],[1,"w-10","h-10","text-white","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border-2","disabled:bg-gray-400","disabled:border-gray-300","disabled:hover:bg-gray-400",3,"disabled","click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[1,"text-sm","text-green-600","font-bold"],[1,"w-10","h-10","bg-blue-600","hover:bg-blue-700","text-white","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border-2","border-blue-800","disabled:bg-gray-400","disabled:border-gray-300","disabled:hover:bg-gray-400",3,"disabled","click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],[1,"col-span-8","relative"],["class","absolute inset-0 flex flex-col items-center justify-center bg-white bg-opacity-80 z-50",4,"ngIf"],[1,"overflow-hidden","blockly-container",2,"height","600px","overflow","hidden !important"],["id","blocklyDiv",1,"w-full","h-full","blockly-workspace",2,"margin","0","padding","0","display","block","overflow","hidden !important","scrollbar-width","none","-ms-overflow-style","none"],["blocklyDiv",""],[1,"absolute","bottom-4","left-1/2","transform","-translate-x-1/2","flex","space-x-4","z-10"],[1,"w-12","h-12","text-white","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border-2","bg-blue-600","border-blue-800","hover:bg-blue-700",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],[1,"w-12","h-12","text-white","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border-2","bg-yellow-400","border-yellow-600","hover:bg-yellow-500",3,"mouseenter"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 2a7 7 0 0 1 7 7c0 3.31-2.69 6-6 6s-6-2.69-6-6a7 7 0 0 1 7-7zm0 17v2m-4 0h8"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 21h6"],["class","fixed z-[9999] left-1/2 bottom-24 transform -translate-x-1/2 bg-white border border-yellow-400 shadow-2xl rounded-xl px-6 py-4 flex flex-col items-center","style","min-width:340px; max-width:90vw;",3,"mouseleave",4,"ngIf"],[1,"w-12","h-12","bg-green-600","hover:bg-green-700","disabled:bg-green-400","text-white","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border-2","border-green-800",3,"disabled","click"],["class","w-5 h-5","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],["class","w-5 h-5 animate-spin","fill","none","viewBox","0 0 24 24",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 10V3L4 14h7v7l9-11h-7z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17.657 18.657A8 8 0 016.343 7.343S7 9 9 10c0-2 .5-5 2.986-7C14 5 16.09 5.777 17.656 7.343A7.975 7.975 0 0120 13a7.975 7.975 0 01-2.343 5.657z"],[1,"absolute","inset-0","flex","flex-col","items-center","justify-center","bg-white","bg-opacity-80","z-50"],["viewBox","0 0 50 50",1,"animate-spin","-ml-1","mr-3","h-16","w-16","text-blue-500"],["cx","25","cy","25","r","20","fill","none","stroke","currentColor","stroke-width","6",1,"opacity-25"],["cx","25","cy","25","r","20","fill","none","stroke","#3b82f6","stroke-width","6","stroke-dasharray","90","stroke-dashoffset","60",1,"opacity-75"],[1,"mt-4","text-blue-700","font-bold","text-lg"],[1,"fixed","z-[9999]","left-1/2","bottom-24","transform","-translate-x-1/2","bg-white","border","border-yellow-400","shadow-2xl","rounded-xl","px-6","py-4","flex","flex-col","items-center",2,"min-width","340px","max-width","90vw",3,"mouseleave"],[1,"flex","items-center","mb-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-yellow-500","mr-2"],[1,"font-bold","text-yellow-700","cursor-pointer",3,"click"],[1,"gif-preview-container"],["alt","Ejemplo en GIF","class","gif-preview-img",3,"src","click",4,"ngIf"],[1,"text-xs","text-gray-500","mt-2"],["alt","Ejemplo en GIF",1,"gif-preview-img",3,"src","click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],["fill","none","viewBox","0 0 24 24",1,"w-5","h-5","animate-spin"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 0 1 8-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 0 1 4 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],[1,"fixed","inset-0","z-[9999]","flex","items-center","justify-center","bg-black","bg-opacity-50"],[1,"bg-green-500","text-white","px-8","py-6","rounded-xl","shadow-2xl","transform","transition-all","duration-500","ease-in-out","max-w-md","mx-4"],[1,"flex","items-center","space-x-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","flex-shrink-0"],[1,"font-bold","text-lg"],[1,"text-sm","opacity-90"],[1,"bg-red-500","text-white","px-8","py-6","rounded-xl","shadow-2xl","transform","transition-all","duration-500","ease-in-out","max-w-md","mx-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"bg-white","px-8","py-6","rounded-xl","shadow-2xl","transform","transition-all","duration-300","ease-in-out","max-w-md","mx-4","w-full"],[1,"mb-6"],[1,"text-xl","font-bold","text-gray-800","mb-2"],[1,"text-gray-600","text-sm"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","variableNameInput","type","text","placeholder","Ej: edad, nombre, contador...",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500","outline-none","transition-colors",3,"ngModel","ngModelChange","keyup.enter","keyup.escape"],["variableNameInput",""],[1,"flex","justify-end","space-x-3"],[1,"px-4","py-2","text-gray-600","hover:text-gray-800","hover:bg-gray-100","rounded-lg","transition-colors",3,"click"],[1,"px-6","py-2","bg-blue-600","hover:bg-blue-700","disabled:bg-gray-300","disabled:cursor-not-allowed","text-white","font-medium","rounded-lg","transition-colors",3,"disabled","click"],["id","renameVariableInput","type","text","placeholder","Nuevo nombre...",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500","outline-none","transition-colors",3,"ngModel","ngModelChange","keyup.enter","keyup.escape"],["renameVariableInput",""],[1,"text-red-600","text-xs","mt-2"],[1,"px-6","py-2","bg-red-600","hover:bg-red-700","text-white","font-medium","rounded-lg","transition-colors",3,"click"],[1,"fixed","inset-0","z-[999999]","flex","items-center","justify-center","bg-black","bg-opacity-80",2,"z-index","999999"],[1,"bg-white","rounded-xl","shadow-2xl","p-8","flex","flex-col","items-center","relative",2,"max-width","90vw","max-height","90vh","margin","auto","display","flex","align-items","center","justify-content","center"],["tabindex","0",1,"absolute","top-4","right-4","flex","items-center","justify-center","w-10","h-10","rounded-full","bg-yellow-500","hover:bg-red-600","text-white","text-2xl","font-bold","shadow","transition","duration-200","focus:outline-none","focus:ring-2","focus:ring-yellow-400",3,"click","keydown.escape"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],["alt","Ejemplo en GIF grande","style","max-width:80vw; max-height:80vh; border-radius:12px; display:block; margin:auto;",3,"src",4,"ngIf"],["alt","Ejemplo en GIF grande",2,"max-width","80vw","max-height","80vh","border-radius","12px","display","block","margin","auto",3,"src"]],template:function(c,a){1&c&&(t.YNc(0,Bt,58,36,"div",0),t.YNc(1,ja,10,1,"div",1),t.YNc(2,Ya,10,1,"div",1),t.YNc(3,kl,17,2,"div",1),t.YNc(4,Xa,17,3,"div",1),t.YNc(5,Xo,14,1,"div",1),t.ynx(6),t.YNc(7,Ka,6,1,"div",2),t.BQk()),2&c&&(t.Q6J("ngIf",a.currentExercise),t.xp6(1),t.Q6J("ngIf",a.showSuccess),t.xp6(1),t.Q6J("ngIf",a.showError),t.xp6(1),t.Q6J("ngIf",a.showCreateVariableModal),t.xp6(1),t.Q6J("ngIf",a.showRenameVariableModal),t.xp6(1),t.Q6J("ngIf",a.showDeleteVariableModal),t.xp6(2),t.Q6J("ngIf",a.showGifModal))},dependencies:[V.O5,Yo.Fj,Yo.JJ,Yo.On],styles:['.blockly-exercise-container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto}.exercise-header[_ngcontent-%COMP%]{border-bottom:1px solid #e5e7eb;padding-bottom:1rem}.blockly-workspace-container[_ngcontent-%COMP%]{position:relative}#blocklyDiv[_ngcontent-%COMP%]{position:relative;background-color:#f9fafb;border-radius:0;width:100%;height:500px}.blockly-workspace-container[_ngcontent-%COMP%]   .blocklySvg[_ngcontent-%COMP%]{border-radius:.5rem}.blockly-workspace-container[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{border-radius:.5rem}@keyframes _ngcontent-%COMP%_slideInRight{0%{transform:translate(100%);opacity:0}to{transform:translate(0);opacity:1}}@keyframes _ngcontent-%COMP%_slideOutRight{0%{transform:translate(0);opacity:1}to{transform:translate(100%);opacity:0}}.difficulty-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.05em}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:not(:disabled):hover{transform:translateY(-1px);box-shadow:0 4px 12px #00000026}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{cursor:not-allowed;opacity:.6}@media (max-width: 768px){.blockly-exercise-container[_ngcontent-%COMP%]{margin:0 1rem;padding:1rem}.action-buttons[_ngcontent-%COMP%]{flex-direction:column;gap:1rem}.action-buttons[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center}.exercise-header[_ngcontent-%COMP%]   .flex[_ngcontent-%COMP%]{flex-direction:column;gap:.5rem}}.blockly-workspace-container[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:-2px;background:linear-gradient(45deg,#3b82f6,#8b5cf6,#06b6d4);border-radius:.5rem;z-index:-1;opacity:0;transition:opacity .3s ease}.blockly-workspace-container[_ngcontent-%COMP%]:hover:before{opacity:.1}.instruction-box[_ngcontent-%COMP%]{position:relative;overflow:hidden}.instruction-box[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;right:0;height:2px;background:linear-gradient(90deg,#3b82f6,transparent)}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.animate-spin[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}.blockly-workspace-container[_ngcontent-%COMP%]   div[_ngcontent-%COMP%], .blockly-workspace-container[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%], .blockly-workspace-container[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{overflow:hidden!important;scrollbar-width:none!important;-ms-overflow-style:none!important}.blockly-workspace-container[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]::-webkit-scrollbar, .blockly-workspace-container[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]::-webkit-scrollbar, .blockly-workspace-container[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]::-webkit-scrollbar{display:none!important;width:0!important;height:0!important;background:transparent!important}div[class*=blockly][_ngcontent-%COMP%]{overflow:hidden!important}g[class*=blockly][_ngcontent-%COMP%]{overflow:hidden!important}.blocklyScrollbarHandle[_ngcontent-%COMP%], .blocklyScrollbarBackground[_ngcontent-%COMP%], .blocklyScrollbarVertical[_ngcontent-%COMP%], .blocklyScrollbarHorizontal[_ngcontent-%COMP%]{display:none!important;visibility:hidden!important}']})}}return u})();function Ja(u,T){if(1&u){const r=t.EpF();t.TgZ(0,"div",52)(1,"div",53)(2,"div",54),t._uU(3),t.TgZ(4,"span",55),t._uU(5),t.qZA(),t.TgZ(6,"h3",56),t._uU(7),t.qZA()(),t.TgZ(8,"p",57),t._uU(9),t.qZA()(),t.TgZ(10,"div",58)(11,"div",59)(12,"p",60),t._uU(13),t.qZA()(),t.TgZ(14,"button",61),t.NdJ("click",function(){const g=t.CHM(r).$implicit,f=t.oxw();return t.KtG(f.openFlowchartModal(g))}),t._uU(15," \u{1f680} Ver Diagrama de Flujo "),t.qZA()()()}if(2&u){const r=T.$implicit,c=T.index;t.xp6(3),t.hij(" #",c+1," "),t.xp6(2),t.Oqu(r.icon),t.xp6(2),t.Oqu(r.title),t.xp6(2),t.Oqu(r.description),t.xp6(4),t.Oqu(r.question)}}let Qa=(()=>{class u{constructor(r){this.http=r,this.urlGifts="",this.ejemplos=[],this.ejercicios=[],this.currentBlocklyExerciseIndex=0,this.showModal=!1,this.modalTitle="",this.modalComponentType=null,this.modalComponentInputs={}}ngOnInit(){this.cargarEjemplos(),this.cargarEjercicios()}cargarEjemplos(){this.http.get("assets/jsons-base/modulos.json").subscribe({next:r=>{this.ejemplos=r.funciones?.examples||[]},error:r=>{this.ejemplos=[]}})}cargarEjercicios(){this.http.get("assets/jsons-base/blockly-exercises.json").subscribe({next:r=>{this.ejercicios=r.funciones?.exercises||[],this.urlGifts=r.funciones?.rtlGifts||""},error:r=>{this.ejercicios=[],this.urlGifts=""}})}openFlowchartModal(r){this.modalTitle=`\u{1f9e9} Diagrama de Flujo - ${r.title}`,this.modalComponentType=Ei,this.modalComponentInputs={steps:r.steps||[],title:r.title},this.showModal=!0}closeModal(){this.showModal=!1,this.modalComponentType=null,this.modalComponentInputs={}}onBlocklyExerciseCompleted(r){console.log("Ejercicio completado:",r)}nextBlocklyExercise(){this.currentBlocklyExerciseIndex<this.ejercicios.length-1&&this.currentBlocklyExerciseIndex++}previousBlocklyExercise(){this.currentBlocklyExerciseIndex>0&&this.currentBlocklyExerciseIndex--}static{this.\u0275fac=function(c){return new(c||u)(t.Y36(fe.eN))}}static{this.\u0275cmp=t.Xpm({type:u,selectors:[["app-modularidad"]],decls:240,vars:12,consts:[[1,"text-center","mb-6","mt-6"],[1,"text-3xl","font-bold","text-gray-800","mb-2","drop-shadow-md"],[1,"flex","items-center","justify-center","mb-1"],[1,"h-0.5","bg-gradient-to-r","from-transparent","via-cyan-500","to-transparent","w-96","shadow-sm"],[1,"flex","items-center","justify-center"],[1,"h-px","bg-gradient-to-r","from-transparent","via-gray-300","to-transparent","w-64","opacity-60"],[1,"min-h-screen"],[1,"flex","flex-col","gap-6","p-4","mx-8"],[1,"bg-gray-500/20","backdrop-blur-md","p-6","rounded-lg","border","border-gray-400/30","shadow-lg"],[1,"text-xl","font-bold","mb-3","text-gray-800"],[1,"space-y-6"],[1,"w-full"],[1,"text-gray-700","leading-relaxed","text-justify","text-base",2,"text-align","justify"],[1,"bg-cyan-50","p-3","rounded","border-l-4","border-cyan-400"],[1,"text-cyan-800","text-sm","font-medium","mb-2"],[1,"text-gray-700","text-sm"],[1,"ml-2"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4","mb-6"],[1,"p-4","bg-blue-50","rounded-lg","border-l-4","border-blue-400"],[1,"text-lg","font-semibold","text-blue-600","mb-2"],[1,"bg-white","p-3","rounded","border","text-sm"],[1,"list-disc","pl-6","mb-2"],[1,"p-4","bg-teal-50","rounded-lg","border-l-4","border-teal-400"],[1,"text-lg","font-semibold","text-teal-600","mb-2"],[1,"p-4","bg-orange-50","rounded-lg","border-l-4","border-orange-400"],[1,"text-lg","font-semibold","text-orange-600","mb-2"],[1,"p-4","bg-yellow-50","rounded-lg","border-l-4","border-yellow-400"],[1,"text-lg","font-semibold","text-yellow-600","mb-2"],[1,"text-gray-700","mb-2"],[1,"bg-white","p-3","rounded","border","text-sm","space-y-2"],[1,"text-gray-700"],[1,"p-4","bg-indigo-50","rounded-lg","border-l-4","border-indigo-400"],[1,"text-lg","font-semibold","text-indigo-600","mb-2"],[1,"p-4","bg-purple-50","rounded-lg","border-l-4","border-purple-400"],[1,"text-lg","font-semibold","text-purple-600","mb-2"],[1,"text-purple-600","font-semibold"],[1,"p-4","bg-cyan-50","rounded-lg","border-l-4","border-cyan-400"],[1,"text-lg","font-semibold","text-cyan-600","mb-2"],[1,"bg-white","p-3","rounded","border","text-xs","font-mono"],[1,"list-disc","pl-6","mt-2","text-sm"],[1,"p-4","bg-green-50","rounded-lg","border-l-4","border-green-400"],[1,"text-lg","font-semibold","text-green-600","mb-2"],[1,"bg-cyan-100","p-2","rounded","mt-2","text-xs","font-mono"],[1,"text-xl","font-bold","mb-4","text-gray-800"],[1,"text-gray-700","mb-6","text-justify"],[1,"overflow-x-auto"],[1,"flex","gap-6","pb-4",2,"min-width","max-content"],["class","flex-shrink-0 bg-white/80 backdrop-blur-sm rounded-lg p-6 border border-gray-200 shadow-md hover:shadow-lg transition-shadow duration-200 flex flex-col justify-between","style","width: 350px; height: 350px;",4,"ngFor","ngForOf"],[1,"mt-8","p-4","bg-cyan-50","border","border-cyan-200","rounded-lg"],[1,"text-cyan-800","text-sm"],[3,"exercises","urlgif","currentExerciseIndex","exerciseCompleted","nextExercise","previousExercise"],[3,"isVisible","title","componentType","componentInputs","onClose"],[1,"flex-shrink-0","bg-white/80","backdrop-blur-sm","rounded-lg","p-6","border","border-gray-200","shadow-md","hover:shadow-lg","transition-shadow","duration-200","flex","flex-col","justify-between",2,"width","350px","height","350px"],[1,"flex-1","flex","flex-col"],[1,"flex","items-center","mb-4"],[1,"text-3xl","mr-3"],[1,"text-lg","font-semibold","text-gray-800","line-clamp-2","leading-tight"],[1,"text-gray-600","text-sm","mb-4","leading-relaxed","line-clamp-4","flex-1","text-justify"],[1,"mt-auto"],[1,"bg-cyan-50","p-3","rounded-lg","border-l-4","border-cyan-400","mb-4"],[1,"text-cyan-800","text-xs","font-medium","line-clamp-3"],[1,"w-full","bg-cyan-500","hover:bg-cyan-600","text-white","py-3","px-4","rounded","transition-colors","duration-200","text-sm","font-medium","shadow-md","hover:shadow-lg",3,"click"]],template:function(c,a){1&c&&(t.TgZ(0,"div",0)(1,"h1",1),t._uU(2,"\u{1f9e9} M\xf3dulo de Funciones"),t.qZA(),t.TgZ(3,"div",2),t._UZ(4,"div",3),t.qZA(),t.TgZ(5,"div",4),t._UZ(6,"div",5),t.qZA()(),t.TgZ(7,"div",6)(8,"div",7)(9,"div",8)(10,"h2",9),t._uU(11,"\u{1f9e9} \xbfQu\xe9 son las funciones?"),t.qZA(),t.TgZ(12,"div",10)(13,"div",11)(14,"p",12)(15,"strong"),t._uU(16,"Una funci\xf3n"),t.qZA(),t._uU(17," es como una peque\xf1a m\xe1quina que hace una tarea espec\xedfica dentro del programa. Le damos un nombre y dentro de ella escribimos los pasos que queremos que siga. En vez de escribir los mismos pasos una y otra vez, ponemos esos pasos dentro de la funci\xf3n y luego, cuando necesitamos que se hagan, simplemente llamamos a la funci\xf3n usando su nombre. Es como cuando grabas un mensaje de voz: lo haces una vez y puedes reproducirlo cada vez que quieras, sin tener que decirlo otra vez. "),t.qZA()(),t.TgZ(18,"div",13)(19,"p",14)(20,"strong"),t._uU(21,"Ejemplo cotidiano:"),t.qZA()(),t.TgZ(22,"p",15)(23,"b"),t._uU(24,"Pedir comida por una app:"),t.qZA(),t._uU(25," Imagina que usas una aplicaci\xf3n para pedir tu almuerzo."),t._UZ(26,"br"),t.TgZ(27,"span",16),t._uU(28,"\u2022 El pedido que env\xedas es el "),t.TgZ(29,"b"),t._uU(30,"par\xe1metro"),t.qZA(),t._uU(31," (la informaci\xf3n que das a la funci\xf3n)."),t.qZA(),t._UZ(32,"br"),t.TgZ(33,"span",16),t._uU(34,"\u2022 La app procesa tu orden siguiendo una serie de "),t.TgZ(35,"b"),t._uU(36,"instrucciones"),t.qZA(),t._uU(37," (la funci\xf3n ejecuta pasos internos)."),t.qZA(),t._UZ(38,"br"),t.TgZ(39,"span",16),t._uU(40,"\u2022 Finalmente, recibes la comida en tu casa: ese es el "),t.TgZ(41,"b"),t._uU(42,"resultado"),t.qZA(),t._uU(43," (valor de retorno de la funci\xf3n)."),t.qZA()()(),t.TgZ(44,"div",17)(45,"div",18)(46,"h3",19),t._uU(47,"\u2699\ufe0f \xbfC\xf3mo funciona una funci\xf3n?"),t.qZA(),t.TgZ(48,"div",20)(49,"ul",21)(50,"li"),t._uU(51,"Recibe datos de entrada llamados "),t.TgZ(52,"strong"),t._uU(53,"par\xe1metros"),t.qZA(),t._uU(54,"."),t.qZA(),t.TgZ(55,"li"),t._uU(56,"Ejecuta una serie de instrucciones paso a paso."),t.qZA(),t.TgZ(57,"li"),t._uU(58,"Devuelve un resultado final llamado "),t.TgZ(59,"strong"),t._uU(60,"valor de retorno"),t.qZA(),t._uU(61,"."),t.qZA()()()(),t.TgZ(62,"div",22)(63,"h3",23),t._uU(64,"\u{1f5bc}\ufe0f Analog\xeda visual"),t.qZA(),t.TgZ(65,"div",20)(66,"p"),t._uU(67,"Imagina que una funci\xf3n es como una m\xe1quina en una f\xe1brica: le das materia prima (datos), la m\xe1quina sigue un proceso (instrucciones) y te entrega un producto terminado (resultado)."),t.qZA(),t.TgZ(68,"p"),t._uU(69,"Tambi\xe9n puedes pensar en una receta de cocina: ingredientes \u2192 proceso \u2192 platillo."),t.qZA()()(),t.TgZ(70,"div",24)(71,"h3",25),t._uU(72,"\u{1f48e} Importancia de las funciones"),t.qZA(),t.TgZ(73,"div",20)(74,"ul",21)(75,"li"),t._uU(76,"Permiten dividir el c\xf3digo en partes peque\xf1as y manejables."),t.qZA(),t.TgZ(77,"li"),t._uU(78,"Facilitan la reutilizaci\xf3n: puedes usar la misma funci\xf3n en diferentes lugares."),t.qZA(),t.TgZ(79,"li"),t._uU(80,"Ayudan a evitar errores y duplicaci\xf3n de c\xf3digo."),t.qZA(),t.TgZ(81,"li"),t._uU(82,"Mejoran la legibilidad y el mantenimiento de los programas."),t.qZA(),t.TgZ(83,"li"),t._uU(84,"Son la base de la programaci\xf3n modular y estructurada."),t.qZA()()()(),t.TgZ(85,"div",26)(86,"h3",27),t._uU(87,"\u{1f305} Ejemplos en la vida cotidiana"),t.qZA(),t.TgZ(88,"div",20)(89,"p",28)(90,"strong"),t._uU(91,"\u{1f4de} Llamar por tel\xe9fono:"),t.qZA(),t._uU(92," Funci\xf3n que recibe el n\xfamero y conecta la llamada."),t.qZA(),t.TgZ(93,"p",28)(94,"strong"),t._uU(95,"\u{1f697} Usar GPS:"),t.qZA(),t._uU(96," Funci\xf3n que recibe destino y muestra la ruta."),t.qZA(),t.TgZ(97,"p",28)(98,"strong"),t._uU(99,"\u{1f9fa} Lavar ropa:"),t.qZA(),t._uU(100," Funci\xf3n que recibe ropa sucia y devuelve ropa limpia."),t.qZA(),t.TgZ(101,"p",28)(102,"strong"),t._uU(103,"\u{1f373} Cocinar:"),t.qZA(),t._uU(104," Funci\xf3n que recibe ingredientes y devuelve un platillo."),t.qZA()()(),t.TgZ(105,"div",22)(106,"h3",23),t._uU(107,"\u{1f9e0} Curiosidades y met\xe1foras"),t.qZA(),t.TgZ(108,"div",29)(109,"p",30),t._uU(110,"\u2022 Las funciones pueden llamarse a s\xed mismas (recursividad), como una mu\xf1eca rusa. "),t.qZA(),t.TgZ(111,"p",30),t._uU(112,"\u2022 En matem\xe1ticas, una funci\xf3n transforma una entrada en una salida: f(x) = x + 1. "),t.qZA(),t.TgZ(113,"p",30),t._uU(114,"\u2022 En la vida real, una receta de cocina es una funci\xf3n: ingredientes \u2192 platillo. "),t.qZA(),t.TgZ(115,"p",30),t._uU(116,"\u2022 Los videojuegos usan funciones para calcular puntajes, movimientos y efectos. "),t.qZA()()(),t.TgZ(117,"div",31)(118,"h3",32),t._uU(119,"\u{1f9ea} Curiosidades"),t.qZA(),t.TgZ(120,"div",29)(121,"p",30),t._uU(122,"\u2022 Puedes tener funciones dentro de funciones (anidadas)."),t.qZA(),t.TgZ(123,"p",30),t._uU(124,"\u2022 Las funciones pueden recibir cero, uno o muchos par\xe1metros."),t.qZA(),t.TgZ(125,"p",30),t._uU(126,"\u2022 En algunos lenguajes, las funciones pueden devolver m\xe1s de un valor (tuplas, objetos)."),t.qZA()()(),t.TgZ(127,"div",33)(128,"h3",34),t._uU(129,"\u{1f6e0}\ufe0f Elementos clave de una funci\xf3n"),t.qZA(),t.TgZ(130,"div",29)(131,"div")(132,"span",35),t._uU(133,"\u2022 Nombre:"),t.qZA(),t._uU(134," Identificador \xfanico y descriptivo."),t.qZA(),t.TgZ(135,"div")(136,"span",35),t._uU(137,"\u2022 Par\xe1metros:"),t.qZA(),t._uU(138," Datos que recibe para trabajar. "),t.qZA(),t.TgZ(139,"div")(140,"span",35),t._uU(141,"\u2022 Instrucciones:"),t.qZA(),t._uU(142," Pasos que ejecuta para cumplir su tarea."),t.qZA(),t.TgZ(143,"div")(144,"span",35),t._uU(145,"\u2022 Valor de retorno:"),t.qZA(),t._uU(146," Resultado que entrega al finalizar."),t.qZA()()(),t.TgZ(147,"div",18)(148,"h3",19),t._uU(149,"\u{1f30e} Comparaci\xf3n con la vida real"),t.qZA(),t.TgZ(150,"div",20)(151,"p",30),t._uU(152,"\u2022 Receta de cocina: funci\xf3n que recibe ingredientes y devuelve un platillo."),t.qZA(),t.TgZ(153,"p",30),t._uU(154,"\u2022 Llamar a un electricista: funci\xf3n que recibe problema y devuelve soluci\xf3n."),t.qZA(),t.TgZ(155,"p",30),t._uU(156,"\u2022 Pedir comida por app: funci\xf3n que recibe pedido y devuelve comida."),t.qZA(),t.TgZ(157,"p",30),t._uU(158,"\u2022 Usar una calculadora: funci\xf3n que recibe n\xfameros y devuelve el resultado."),t.qZA(),t.TgZ(159,"p",30),t._uU(160,"\u2022 Buscar informaci\xf3n en internet: funci\xf3n que recibe una pregunta y devuelve una respuesta."),t.qZA()()(),t.TgZ(161,"div",36)(162,"h3",37),t._uU(163,"\u{1f4cb} Sintaxis general"),t.qZA(),t.TgZ(164,"div",38)(165,"code"),t._uU(166),t._UZ(167,"br"),t._uU(168,"\xa0\xa0// instrucciones"),t._UZ(169,"br"),t._uU(170,"\xa0\xa0return valor;"),t._UZ(171,"br"),t._uU(172),t.qZA()(),t.TgZ(173,"ul",39)(174,"li")(175,"strong"),t._uU(176,"Funciones sin par\xe1metros:"),t.qZA(),t._uU(177," No reciben datos, solo ejecutan instrucciones."),t.qZA(),t.TgZ(178,"li")(179,"strong"),t._uU(180,"Funciones con par\xe1metros:"),t.qZA(),t._uU(181," Reciben uno o m\xe1s datos para trabajar."),t.qZA(),t.TgZ(182,"li")(183,"strong"),t._uU(184,"Funciones que retornan valor:"),t.qZA(),t._uU(185," Devuelven un resultado."),t.qZA(),t.TgZ(186,"li")(187,"strong"),t._uU(188,"Funciones que no retornan valor:"),t.qZA(),t._uU(189," Solo ejecutan acciones."),t.qZA()()(),t.TgZ(190,"div",40)(191,"h3",41),t._uU(192,"\u2705 Buenas pr\xe1cticas y errores comunes"),t.qZA(),t.TgZ(193,"div",20)(194,"ul",21)(195,"li"),t._uU(196,"\u2705 Usa nombres descriptivos para tus funciones."),t.qZA(),t.TgZ(197,"li"),t._uU(198,"\u274c No hagas funciones demasiado largas o con muchas responsabilidades."),t.qZA(),t.TgZ(199,"li"),t._uU(200,"\u2705 Documenta lo que hace cada funci\xf3n."),t.qZA(),t.TgZ(201,"li"),t._uU(202,"\u274c Olvidar el "),t.TgZ(203,"code"),t._uU(204,"return"),t.qZA(),t._uU(205," cuando se espera un resultado."),t.qZA(),t.TgZ(206,"li"),t._uU(207,"\u274c Confundir los par\xe1metros con las variables internas."),t.qZA(),t.TgZ(208,"li"),t._uU(209,"\u274c Usar nombres poco claros."),t.qZA()(),t.TgZ(210,"div",42)(211,"code"),t._uU(212),t._UZ(213,"br"),t._uU(214,'\xa0\xa0return "Hola, " + nombre + "!";'),t._UZ(215,"br"),t._uU(216),t._UZ(217,"br")(218,"br"),t._uU(219,'let mensaje = saludar("Ana"); // mensaje = "Hola, Ana!"'),t.qZA()()()()()()(),t.TgZ(220,"div",8)(221,"h2",43),t._uU(222,"\u{1f9ea} Ejemplos Din\xe1micos"),t.qZA(),t.TgZ(223,"p",44),t._uU(224," A continuaci\xf3n encontrar\xe1s ejemplos interactivos que demuestran c\xf3mo funcionan las funciones en situaciones cotidianas. Cada ejemplo incluye un diagrama de flujo que puedes visualizar paso a paso. "),t.qZA(),t.TgZ(225,"div",45)(226,"div",46),t.YNc(227,Ja,16,5,"div",47),t.qZA()(),t.TgZ(228,"div",48)(229,"p",49)(230,"strong"),t._uU(231,"\u{1f4a1} Consejo:"),t.qZA(),t._uU(232," Las funciones te ayudan a organizar y reutilizar tu c\xf3digo. Observa c\xf3mo cada ejemplo usa diferentes tipos de entrada y salida. "),t.qZA()()(),t.TgZ(233,"div",8)(234,"h2",43),t._uU(235,"\u{1f3af} Ejercicios Pr\xe1cticos"),t.qZA(),t.TgZ(236,"p",44),t._uU(237," Ahora es tu turno de practicar. Estos ejercicios te ayudar\xe1n a dominar las funciones usando programaci\xf3n visual con Blockly. Cada ejercicio te ense\xf1ar\xe1 un concepto espec\xedfico. "),t.qZA(),t.TgZ(238,"app-blockly-exercise",50),t.NdJ("exerciseCompleted",function(f){return a.onBlocklyExerciseCompleted(f)})("nextExercise",function(){return a.nextBlocklyExercise()})("previousExercise",function(){return a.previousBlocklyExercise()}),t.qZA()()()(),t.TgZ(239,"app-modal",51),t.NdJ("onClose",function(){return a.closeModal()}),t.qZA()),2&c&&(t.xp6(166),t.hij("function nombreFuncion(par\xe1metros) ","{",""),t.xp6(6),t.Oqu("}"),t.xp6(40),t.hij("function saludar(nombre) ","{",""),t.xp6(4),t.Oqu("}"),t.xp6(11),t.Q6J("ngForOf",a.ejemplos),t.xp6(11),t.Q6J("exercises",a.ejercicios)("urlgif",a.urlGifts)("currentExerciseIndex",a.currentBlocklyExerciseIndex),t.xp6(1),t.Q6J("isVisible",a.showModal)("title",a.modalTitle)("componentType",a.modalComponentType)("componentInputs",a.modalComponentInputs))},dependencies:[V.sg,Ms,it]})}}return u})();function eu(u,T){if(1&u){const r=t.EpF();t.TgZ(0,"div",53)(1,"div",54)(2,"div",55),t._uU(3),t.TgZ(4,"span",56),t._uU(5),t.qZA(),t.TgZ(6,"h3",57),t._uU(7),t.qZA()(),t.TgZ(8,"p",58),t._uU(9),t.qZA()(),t.TgZ(10,"div",59)(11,"div",60)(12,"p",61),t._uU(13),t.qZA()(),t.TgZ(14,"button",62),t.NdJ("click",function(){const g=t.CHM(r).$implicit,f=t.oxw();return t.KtG(f.openFlowchartModal(g))}),t._uU(15," \u{1f680} Ver Diagrama de Flujo "),t.qZA()()()}if(2&u){const r=T.$implicit,c=T.index,a=t.oxw();t.xp6(3),t.hij(" #",c+1," "),t.xp6(2),t.Oqu(a.getIconForExample(r.title)),t.xp6(2),t.Oqu(a.getCleanTitle(r.title)),t.xp6(2),t.Oqu(r.description),t.xp6(4),t.Oqu(r.question)}}let wl=(()=>{class u{constructor(r){this.http=r,this.urlGifts="",this.examples=[],this.blocklyExercises=[],this.currentBlocklyExerciseIndex=0,this.selectedSection="teoria",this.showModal=!1,this.modalTitle="",this.modalComponentType=null,this.modalComponentInputs={}}ngOnInit(){this.loadExamples(),this.loadBlocklyExercises()}loadExamples(){this.http.get("assets/jsons-base/modulos.json").subscribe({next:r=>{this.examples=r.bucles?.examples||[]},error:r=>{console.error("Error al cargar ejemplos de bucles:",r),this.examples=[]}})}loadBlocklyExercises(){this.http.get("assets/jsons-base/blockly-exercises.json").subscribe({next:r=>{this.blocklyExercises=r.bucles?.exercises||[],this.urlGifts=r.bucles?.rtlGifts||""},error:r=>{console.error("Error al cargar ejercicios de Blockly:",r),this.blocklyExercises=[],this.urlGifts=""}})}getIconForExample(r){const c=r.toLowerCase(),a={"ejercicio|flexiones|rutina":"\u{1f3c3}\u200d\u2642\ufe0f","lavado|platos|lavar":"\u{1f37d}\ufe0f","contador|numeros|pares":"\u{1f522}","estudiante|calificacion|profesor":"\u{1f4da}","ahorro|dinero|ahorrar":"\u{1f4b0}","revisi\xf3n|tareas|correos":"\u{1f3b2}"};for(const[g,f]of Object.entries(a))if(g.split("|").some(S=>c.includes(S)))return f;return"\u{1f504}"}getCleanTitle(r){return r.replace(/^(Ejemplo|Ejercicio):\s*/i,"")}openFlowchartModal(r){this.modalTitle=`\u{1f504} Diagrama de Flujo - ${this.getCleanTitle(r.title)}`,this.modalComponentType=Ei,this.modalComponentInputs={steps:r.steps||[],title:r.title},this.showModal=!0}closeModal(){this.showModal=!1,this.modalComponentType=null,this.modalComponentInputs={}}onBlocklyExerciseCompleted(r){console.log("Ejercicio completado:",r)}nextBlocklyExercise(){this.currentBlocklyExerciseIndex<this.blocklyExercises.length-1&&this.currentBlocklyExerciseIndex++}previousBlocklyExercise(){this.currentBlocklyExerciseIndex>0&&this.currentBlocklyExerciseIndex--}static{this.\u0275fac=function(c){return new(c||u)(t.Y36(fe.eN))}}static{this.\u0275cmp=t.Xpm({type:u,selectors:[["app-bucles"]],decls:183,vars:8,consts:[[1,"text-center","mb-6","mt-6"],[1,"text-3xl","font-bold","text-gray-800","mb-2","drop-shadow-md"],[1,"flex","items-center","justify-center","mb-1"],[1,"h-0.5","bg-gradient-to-r","from-transparent","via-red-500","to-transparent","w-96","shadow-sm"],[1,"flex","items-center","justify-center"],[1,"h-px","bg-gradient-to-r","from-transparent","via-gray-300","to-transparent","w-64","opacity-60"],[1,"min-h-screen"],[1,"flex","flex-col","gap-6","p-4","mx-8"],[1,"bg-gray-500/20","backdrop-blur-md","p-6","rounded-lg","border","border-gray-400/30","shadow-lg"],[1,"mb-6"],[1,"text-xl","font-bold","mb-3","text-gray-800"],[1,"text-gray-700","leading-relaxed","mb-4","text-justify"],[1,"bg-red-50","p-3","rounded","border-l-4","border-red-400","mb-4"],[1,"text-red-800","text-sm","font-medium","mb-2"],[1,"text-gray-700","text-sm"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"p-4","bg-purple-50","rounded-lg","border-l-4","border-purple-400"],[1,"text-lg","font-semibold","text-purple-600","mb-2"],[1,"bg-white","p-3","rounded","border","text-sm","space-y-2"],[1,"text-purple-600","font-semibold"],[1,"text-gray-500","italic"],[1,"p-4","bg-blue-50","rounded-lg","border-l-4","border-blue-400"],[1,"text-lg","font-semibold","text-blue-600","mb-2"],[1,"text-gray-700","text-justify","mb-3"],[1,"text-md","font-semibold","text-blue-600","mb-2"],[1,"bg-white","p-3","rounded","border","text-sm"],[1,"text-gray-700"],[1,"p-4","bg-green-50","rounded-lg","border-l-4","border-green-400"],[1,"text-lg","font-semibold","text-green-600","mb-2"],[1,"bg-white","p-3","rounded","border","text-sm","space-y-1"],[1,"text-green-600","font-medium"],[1,"p-4","bg-orange-50","rounded-lg","border-l-4","border-orange-400"],[1,"text-lg","font-semibold","text-orange-600","mb-2"],[1,"p-4","bg-teal-50","rounded-lg","border-l-4","border-teal-400"],[1,"text-lg","font-semibold","text-teal-600","mb-2"],[1,"text-teal-600","font-semibold"],[1,"p-4","bg-red-50","rounded-lg","border-l-4","border-red-400"],[1,"text-lg","font-semibold","text-red-600","mb-2"],[1,"p-4","bg-yellow-50","rounded-lg","border-l-4","border-yellow-400"],[1,"text-lg","font-semibold","text-yellow-600","mb-2"],[1,"text-gray-700","mb-2"],[1,"p-4","bg-indigo-50","rounded-lg","border-l-4","border-indigo-400"],[1,"text-lg","font-semibold","text-indigo-600","mb-2"],[1,"text-xl","font-bold","mb-4","text-gray-800"],[1,"text-gray-700","mb-6","text-justify"],[1,"overflow-x-auto"],[1,"flex","gap-6","pb-4",2,"min-width","max-content"],["class","flex-shrink-0 bg-white/80 backdrop-blur-sm rounded-lg p-6 border border-gray-200 shadow-md hover:shadow-lg transition-shadow duration-200 flex flex-col justify-between","style","width: 350px; height: 350px;",4,"ngFor","ngForOf"],[1,"mt-8","p-4","bg-red-50","border","border-red-200","rounded-lg"],[1,"text-red-800","text-sm"],[1,"bg-gray-500/20","backdrop-blur-md","p-6","rounded-lg","border","border-gray-400/35","shadow-lg"],[3,"exercises","currentExerciseIndex","urlgif","exerciseCompleted","nextExercise","previousExercise"],[3,"isVisible","title","componentType","componentInputs","onClose"],[1,"flex-shrink-0","bg-white/80","backdrop-blur-sm","rounded-lg","p-6","border","border-gray-200","shadow-md","hover:shadow-lg","transition-shadow","duration-200","flex","flex-col","justify-between",2,"width","350px","height","350px"],[1,"flex-1","flex","flex-col"],[1,"flex","items-center","mb-4"],[1,"text-3xl","mr-3"],[1,"text-lg","font-semibold","text-gray-800","line-clamp-2","leading-tight"],[1,"text-gray-600","text-sm","mb-4","leading-relaxed","line-clamp-4","flex-1"],[1,"mt-auto"],[1,"bg-red-50","p-3","rounded-lg","border-l-4","border-red-400","mb-4"],[1,"text-red-800","text-xs","font-medium","line-clamp-3"],[1,"w-full","bg-red-500","hover:bg-red-600","text-white","py-3","px-4","rounded","transition-colors","duration-200","text-sm","font-medium","shadow-md","hover:shadow-lg",3,"click"]],template:function(c,a){1&c&&(t.TgZ(0,"div",0)(1,"h1",1),t._uU(2,"\u{1f504} Estructuras de Control: Bucles"),t.qZA(),t.TgZ(3,"div",2),t._UZ(4,"div",3),t.qZA(),t.TgZ(5,"div",4),t._UZ(6,"div",5),t.qZA()(),t.TgZ(7,"div",6)(8,"div",7)(9,"div",8)(10,"div",9)(11,"h2",10),t._uU(12,"\u{1f501} \xbfQu\xe9 son los bucles o ciclos?"),t.qZA(),t.TgZ(13,"p",11),t._uU(14," Los bucles son estructuras de control que permiten repetir un conjunto de instrucciones m\xfaltiples veces de forma autom\xe1tica, evitando tener que escribir el mismo c\xf3digo una y otra vez. "),t.qZA(),t.TgZ(15,"p",11),t._uU(16," Es como tener un asistente que hace la misma tarea tantas veces como le indiques, o hasta que se cumpla cierta condici\xf3n. "),t.qZA(),t.TgZ(17,"div",12)(18,"p",13)(19,"strong"),t._uU(20,"Ejemplo:"),t.qZA()(),t.TgZ(21,"p",14),t._uU(22,'En lugar de escribir "Imprimir Hola" 100 veces...'),t.qZA(),t.TgZ(23,"p",14),t._uU(24,'Usas un bucle: "Repetir 100 veces: Imprimir Hola"'),t.qZA()()(),t.TgZ(25,"div",9)(26,"div",15)(27,"div",16)(28,"h3",17),t._uU(29,"\u{1f3af} Tipos principales de bucles"),t.qZA(),t.TgZ(30,"div",18)(31,"div")(32,"span",19),t._uU(33,"\u2022 For (Para):"),t.qZA(),t._uU(34,' Se usa cuando sabes exactamente cu\xe1ntas veces quieres repetir algo. Ejemplo: "Haz ejercicio 20 veces".'),t.qZA(),t.TgZ(35,"div")(36,"span",19),t._uU(37,"\u2022 While (Mientras):"),t.qZA(),t._uU(38,' Se repite mientras una condici\xf3n sea verdadera. Ejemplo: "Estudia mientras no entiendas el tema".'),t.qZA(),t.TgZ(39,"div")(40,"span",19),t._uU(41,"\u2022 Do-While (Hacer-Mientras):"),t.qZA(),t._uU(42," Hace algo al menos una vez, luego verifica si debe continuar. "),t.TgZ(43,"span",20),t._uU(44,"(Nota: este tipo de bucle no existe en todos los lenguajes, por ejemplo, en Python no est\xe1 disponible)."),t.qZA()()()(),t.TgZ(45,"div",21)(46,"h3",22),t._uU(47,'\u{1f300} \xbfPor qu\xe9 se llaman "bucles"?'),t.qZA(),t.TgZ(48,"p",23),t._uU(49," Se llaman bucles porque repiten un bloque de instrucciones varias veces, volviendo al inicio del bloque hasta que se cumpla una condici\xf3n o se alcance un n\xfamero determinado de repeticiones. "),t.qZA(),t.TgZ(50,"h4",24),t._uU(51,"\u{1f504} Visualizaci\xf3n"),t.qZA(),t.TgZ(52,"div",25)(53,"p",26),t._uU(54,"Piensa en una pista circular donde un corredor da vueltas:"),t.qZA(),t.TgZ(55,"p",26),t._uU(56,"Vuelta 1 \u2192 Vuelta 2 \u2192 Vuelta 3... hasta completar todas."),t.qZA()()(),t.TgZ(57,"div",27)(58,"h3",28),t._uU(59,"\u{1f3e0} Met\xe1fora: Tareas dom\xe9sticas"),t.qZA(),t.TgZ(60,"p",23),t._uU(61,' Imagina que tu mam\xe1 te dice: "Lava todos los platos sucios" '),t.qZA(),t.TgZ(62,"div",29)(63,"p",26)(64,"strong"),t._uU(65,"Paso 1:"),t.qZA(),t._uU(66," Tomar un plato"),t.qZA(),t.TgZ(67,"p",26)(68,"strong"),t._uU(69,"Paso 2:"),t.qZA(),t._uU(70," Lavarlo con jab\xf3n"),t.qZA(),t.TgZ(71,"p",26)(72,"strong"),t._uU(73,"Paso 3:"),t.qZA(),t._uU(74," Enjuagarlo"),t.qZA(),t.TgZ(75,"p",26)(76,"strong"),t._uU(77,"Paso 4:"),t.qZA(),t._uU(78," \xbfQuedan m\xe1s platos? Si s\xed \u2192 volver al Paso 1"),t.qZA(),t.TgZ(79,"p",30),t._uU(80,"\xa1Eso es exactamente un bucle while!"),t.qZA()()(),t.TgZ(81,"div",31)(82,"h3",32),t._uU(83,"\u26a1 \xbfCu\xe1ndo usar bucles?"),t.qZA(),t.TgZ(84,"p",23),t._uU(85," Los bucles son perfectos cuando necesitas: "),t.qZA(),t.TgZ(86,"div",25),t._uU(87," \u2022 Procesar listas de elementos (estudiantes, productos, etc.)"),t._UZ(88,"br"),t._uU(89," \u2022 Repetir c\xe1lculos matem\xe1ticos"),t._UZ(90,"br"),t._uU(91," \u2022 Validar datos hasta que sean correctos"),t._UZ(92,"br"),t._uU(93," \u2022 Crear patrones o secuencias"),t._UZ(94,"br"),t._uU(95," \u2022 Automatizar tareas repetitivas "),t.qZA()(),t.TgZ(96,"div",33)(97,"h3",34),t._uU(98,"\u{1f527} Elementos de un bucle"),t.qZA(),t.TgZ(99,"div",18)(100,"div")(101,"span",35),t._uU(102,"\u2022 Inicializaci\xf3n:"),t.qZA(),t._uU(103," Preparar variables (contador = 0)"),t.qZA(),t.TgZ(104,"div")(105,"span",35),t._uU(106,"\u2022 Condici\xf3n:"),t.qZA(),t._uU(107," \xbfCu\xe1ndo parar? (contador < 10)"),t.qZA(),t.TgZ(108,"div")(109,"span",35),t._uU(110,"\u2022 Cuerpo:"),t.qZA(),t._uU(111," Qu\xe9 hacer en cada repetici\xf3n"),t.qZA(),t.TgZ(112,"div")(113,"span",35),t._uU(114,"\u2022 Actualizaci\xf3n:"),t.qZA(),t._uU(115," Cambiar variables (contador + 1)"),t.qZA()()(),t.TgZ(116,"div",36)(117,"h3",37),t._uU(118,"\u{1f48e} Importancia de los bucles"),t.qZA(),t.TgZ(119,"p",23),t._uU(120," Los bucles son fundamentales porque: "),t.qZA(),t.TgZ(121,"div",25),t._uU(122," \u2022 Ahorran tiempo y l\xedneas de c\xf3digo"),t._UZ(123,"br"),t._uU(124," \u2022 Reducen errores de escritura repetitiva"),t._UZ(125,"br"),t._uU(126," \u2022 Permiten procesar grandes cantidades de datos"),t._UZ(127,"br"),t._uU(128," \u2022 Hacen el c\xf3digo m\xe1s legible y mantenible"),t._UZ(129,"br"),t._uU(130," \u2022 Son la base de la automatizaci\xf3n "),t.qZA()(),t.TgZ(131,"div",38)(132,"h3",39),t._uU(133,"\u{1f305} Ejemplos en la vida cotidiana"),t.qZA(),t.TgZ(134,"div",25)(135,"p",40)(136,"strong"),t._uU(137,"\u{1f3c3}\u200d\u2642\ufe0f Ejercicio:"),t.qZA(),t._uU(138,' "Haz 20 flexiones"'),t.qZA(),t.TgZ(139,"p",40)(140,"strong"),t._uU(141,"\u{1f4da} Estudiar:"),t.qZA(),t._uU(142,' "Repasa hasta entender el tema"'),t.qZA(),t.TgZ(143,"p",40)(144,"strong"),t._uU(145,"\u{1f373} Cocinar:"),t.qZA(),t._uU(146,' "Revuelve la sopa cada 5 minutos hasta que est\xe9 lista"'),t.qZA(),t.TgZ(147,"p",26)(148,"strong"),t._uU(149,"\u{1f3b5} M\xfasica:"),t.qZA(),t._uU(150,' "Reproduce esta canci\xf3n en modo repetir"'),t.qZA()()(),t.TgZ(151,"div",41)(152,"h3",42),t._uU(153,"\u{1f9ea} Curiosidades sobre bucles"),t.qZA(),t.TgZ(154,"div",18)(155,"p",26),t._uU(156,'\u2022 Un bucle infinito puede "colgar" un programa si no tiene condici\xf3n de parada'),t.qZA(),t.TgZ(157,"p",26),t._uU(158,"\u2022 Los bucles anidados (un bucle dentro de otro) pueden crear patrones complejos"),t.qZA(),t.TgZ(159,"p",26),t._uU(160,'\u2022 En algunos lenguajes, puedes "romper" un bucle con la palabra "break"'),t.qZA(),t.TgZ(161,"p",26),t._uU(162,"\u2022 Los videojuegos usan un bucle principal que se ejecuta 60 veces por segundo"),t.qZA()()()()()(),t.TgZ(163,"div",8)(164,"h2",43),t._uU(165,"\u{1f9ea} Ejemplos Din\xe1micos"),t.qZA(),t.TgZ(166,"p",44),t._uU(167," A continuaci\xf3n encontrar\xe1s ejemplos interactivos que demuestran c\xf3mo funcionan los bucles en situaciones cotidianas. Cada ejemplo incluye un diagrama de flujo que puedes visualizar paso a paso. "),t.qZA(),t.TgZ(168,"div",45)(169,"div",46),t.YNc(170,eu,16,5,"div",47),t.qZA()(),t.TgZ(171,"div",48)(172,"p",49)(173,"strong"),t._uU(174,"\u{1f4a1} Consejo:"),t.qZA(),t._uU(175," Los bucles son herramientas poderosas que automatizan tareas repetitivas. Observa c\xf3mo cada ejemplo usa diferentes tipos de repetici\xf3n seg\xfan la situaci\xf3n. "),t.qZA()()(),t.TgZ(176,"div",50)(177,"h2",43),t._uU(178,"\u{1f3af} Ejercicios Pr\xe1cticos"),t.qZA(),t.TgZ(179,"p",44),t._uU(180," Ahora es tu turno de practicar. Estos ejercicios te ayudar\xe1n a dominar los bucles usando programaci\xf3n visual con Blockly. Cada ejercicio te ense\xf1ar\xe1 un concepto espec\xedfico. "),t.qZA(),t.TgZ(181,"app-blockly-exercise",51),t.NdJ("exerciseCompleted",function(f){return a.onBlocklyExerciseCompleted(f)})("nextExercise",function(){return a.nextBlocklyExercise()})("previousExercise",function(){return a.previousBlocklyExercise()}),t.qZA()()()(),t.TgZ(182,"app-modal",52),t.NdJ("onClose",function(){return a.closeModal()}),t.qZA()),2&c&&(t.xp6(170),t.Q6J("ngForOf",a.examples),t.xp6(11),t.Q6J("exercises",a.blocklyExercises)("currentExerciseIndex",a.currentBlocklyExerciseIndex)("urlgif",a.urlGifts),t.xp6(1),t.Q6J("isVisible",a.showModal)("title",a.modalTitle)("componentType",a.modalComponentType)("componentInputs",a.modalComponentInputs))},dependencies:[V.sg,Ms,it]})}}return u})();function tu(u,T){if(1&u){const r=t.EpF();t.TgZ(0,"div",51)(1,"div",52)(2,"h3",53),t._uU(3),t.TgZ(4,"span",54),t._uU(5),t.qZA(),t._uU(6),t.qZA(),t.TgZ(7,"p",55),t._uU(8),t.qZA()(),t.TgZ(9,"div",56)(10,"p",57),t._uU(11),t.qZA()(),t.TgZ(12,"button",58),t.NdJ("click",function(){const g=t.CHM(r).$implicit,f=t.oxw();return t.KtG(f.openFlowchartModal(g))}),t._uU(13," \u{1f680} Ver Diagrama de Flujo "),t.qZA()()}if(2&u){const r=T.$implicit,c=T.index,a=t.oxw();t.xp6(3),t.hij(" #",c+1," "),t.xp6(2),t.Oqu(a.getIconForExample(r.title)),t.xp6(1),t.hij(" ",a.getCleanTitle(r.title)," "),t.xp6(2),t.hij(" ",r.description," "),t.xp6(3),t.Oqu(r.question)}}let ou=(()=>{class u{constructor(r){this.http=r,this.urlGifts="",this.examples=[],this.showModal=!1,this.modalTitle="",this.modalComponentType=null,this.modalComponentInputs={},this.blocklyExercises=[],this.currentBlocklyExerciseIndex=0,this.completedExercises=new Set}ngOnInit(){this.loadExamples(),this.loadBlocklyExercises()}loadExamples(){this.http.get("assets/jsons-base/modulos.json").subscribe({next:r=>{this.examples=r.condicionales.examples||[]},error:r=>{console.error("Error loading examples:",r)}})}loadBlocklyExercises(){this.http.get("assets/jsons-base/blockly-exercises.json").subscribe({next:r=>{r.condicionales&&r.condicionales.exercises&&(this.blocklyExercises=r.condicionales.exercises,this.urlGifts=r.condicionales?.rtlGifts||"",console.log("Blockly exercises loaded:",this.blocklyExercises.length))},error:r=>{console.error("Error cargando ejercicios de Blockly:",r),this.urlGifts=""}})}getIconForExample(r){return r.includes("parque")||r.includes("Carlos")?"\u{1f333}":r.includes("tienda")||r.includes("Ana")?"\u{1f457}":r.includes("bicicleta")||r.includes("Luis")?"\u{1f6b4}\u200d\u2642\ufe0f":r.includes("t\xe9")||r.includes("Sof\xeda")?"\u{1f375}":r.includes("reuni\xf3n")||r.includes("Pedro")?"\u{1f4bc}":r.includes("comida")||r.includes("Mariana")?"\u{1f35e}":r.includes("videojuego")||r.includes("Javier")?"\u{1f3ae}":"\u{1f504}"}getCleanTitle(r){return r.replace(/^Ejemplo \d+:\s*/,"")}get currentBlocklyExercise(){return this.blocklyExercises[this.currentBlocklyExerciseIndex]||null}onBlocklyExerciseCompleted(r){r.success&&(this.completedExercises.add(r.exerciseId),console.log("Ejercicio completado:",r.exerciseId))}nextBlocklyExercise(){this.currentBlocklyExerciseIndex<this.blocklyExercises.length-1&&this.currentBlocklyExerciseIndex++}previousBlocklyExercise(){this.currentBlocklyExerciseIndex>0&&this.currentBlocklyExerciseIndex--}openFlowchartModal(r){this.modalTitle=`\u{1f504} Diagrama de Flujo - ${this.getCleanTitle(r.title)}`,this.modalComponentType=Ei,this.modalComponentInputs={steps:r.steps||[],title:r.title},this.showModal=!0}closeModal(){this.showModal=!1,this.modalTitle="",this.modalComponentType=null,this.modalComponentInputs={}}static{this.\u0275fac=function(c){return new(c||u)(t.Y36(fe.eN))}}static{this.\u0275cmp=t.Xpm({type:u,selectors:[["app-condicionales"]],decls:140,vars:8,consts:[[1,"text-center","mb-6","mt-6"],[1,"text-3xl","font-bold","text-gray-800","mb-2","drop-shadow-md"],[1,"flex","items-center","justify-center","mb-1"],[1,"h-0.5","bg-gradient-to-r","from-transparent","via-blue-500","to-transparent","w-96","shadow-sm"],[1,"flex","items-center","justify-center"],[1,"h-px","bg-gradient-to-r","from-transparent","via-gray-300","to-transparent","w-64","opacity-60"],[1,"min-h-screen"],[1,"flex","flex-col","gap-6","p-4","mx-8"],[1,"bg-gray-500/20","backdrop-blur-md","p-6","rounded-lg","border","border-gray-400/30","shadow-lg"],[1,"mb-6"],[1,"text-xl","font-bold","mb-3","text-gray-800"],[1,"text-gray-700","leading-relaxed","mb-4","text-justify"],[1,"bg-blue-50","p-3","rounded","border-l-4","border-blue-400","mb-4"],[1,"text-blue-800","text-sm","font-medium","mb-2"],[1,"text-gray-700","text-sm"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"p-4","bg-teal-50","rounded-lg","border-l-4","border-teal-400"],[1,"text-lg","font-semibold","text-teal-600","mb-2"],[1,"bg-white","p-3","rounded","border","text-sm","space-y-2"],[1,"text-teal-600","font-semibold"],[1,"p-4","bg-blue-50","rounded-lg","border-l-4","border-blue-400"],[1,"text-lg","font-semibold","text-blue-600","mb-2"],[1,"text-gray-700","text-justify","mb-3"],[1,"text-md","font-semibold","text-blue-600","mb-2"],[1,"bg-white","p-3","rounded","border","text-sm"],[1,"text-gray-700","mb-2"],[1,"text-gray-700"],[1,"p-4","bg-purple-50","rounded-lg","border-l-4","border-purple-400"],[1,"text-lg","font-semibold","text-purple-600","mb-2"],[1,"bg-white","p-3","rounded","border","text-sm","space-y-1"],[1,"text-gray-700","mt-2"],[1,"p-4","bg-orange-50","rounded-lg","border-l-4","border-orange-400"],[1,"text-lg","font-semibold","text-orange-600","mb-2"],[1,"p-4","bg-red-50","rounded-lg","border-l-4","border-red-400"],[1,"text-lg","font-semibold","text-red-600","mb-2"],[1,"p-4","bg-indigo-50","rounded-lg","border-l-4","border-indigo-400"],[1,"text-lg","font-semibold","text-indigo-600","mb-2"],[1,"bg-white","p-3","rounded","border","font-mono","text-sm"],[1,"text-blue-600"],[1,"text-red-600"],[1,"text-purple-600"],[1,"text-green-600"],[1,"text-xl","font-bold","mb-4","text-gray-800"],[1,"text-gray-700","mb-6","text-justify"],[1,"overflow-x-auto"],[1,"flex","gap-6","pb-4",2,"min-width","max-content"],["class","bg-white/60 backdrop-blur-sm p-6 rounded-lg shadow-md border border-gray-300/50 flex flex-col flex-shrink-0","style","width: 300px; height: 300px;",4,"ngFor","ngForOf"],[1,"mt-8","p-4","bg-blue-50","border","border-blue-200","rounded-lg"],[1,"text-blue-800","text-sm"],[3,"exercises","currentExerciseIndex","urlgif","exerciseCompleted","nextExercise","previousExercise"],[3,"isVisible","title","componentType","componentInputs","onClose"],[1,"bg-white/60","backdrop-blur-sm","p-6","rounded-lg","shadow-md","border","border-gray-300/50","flex","flex-col","flex-shrink-0",2,"width","300px","height","300px"],[1,"flex-grow","overflow-hidden"],[1,"font-bold","text-lg","text-gray-800","mb-3","line-clamp-2","flex","items-center"],[1,"text-2xl","mr-2"],[1,"text-sm","text-gray-600","text-justify","mb-4","line-clamp-3"],[1,"mb-4","p-2","bg-blue-50","rounded","border-l-4","border-blue-400"],[1,"text-blue-800","text-xs","font-medium","line-clamp-2"],[1,"w-full","bg-blue-500","hover:bg-blue-600","text-white","py-2","px-4","rounded","transition-colors","duration-200","text-sm","font-medium",3,"click"]],template:function(c,a){1&c&&(t.TgZ(0,"div",0)(1,"h1",1),t._uU(2,"\u{1f500} Estructuras Condicionales"),t.qZA(),t.TgZ(3,"div",2),t._UZ(4,"div",3),t.qZA(),t.TgZ(5,"div",4),t._UZ(6,"div",5),t.qZA()(),t.TgZ(7,"div",6)(8,"div",7)(9,"div",8)(10,"div",9)(11,"h2",10),t._uU(12,"\u{1f9e0} \xbfQu\xe9 es una estructura condicional?"),t.qZA(),t.TgZ(13,"p",11),t._uU(14," En programaci\xf3n, una estructura condicional es una instrucci\xf3n que permite que el programa tome decisiones dependiendo de si una condici\xf3n es verdadera o falsa. "),t.qZA(),t.TgZ(15,"p",11),t._uU(16," Es como si el programa se encontrara con una pregunta y, seg\xfan la respuesta, sigue un camino u otro. "),t.qZA(),t.TgZ(17,"div",12)(18,"p",13)(19,"strong"),t._uU(20,"Ejemplo:"),t.qZA()(),t.TgZ(21,"p",14),t._uU(22,"Si tienes hambre \u2192 comes."),t.qZA(),t.TgZ(23,"p",14),t._uU(24,"Si no tienes hambre \u2192 no comes."),t.qZA()()(),t.TgZ(25,"div",9)(26,"div",15)(27,"div",16)(28,"h3",17),t._uU(29,"\u{1f527} Elementos fundamentales de una estructura condicional"),t.qZA(),t.TgZ(30,"div",18)(31,"div")(32,"span",19),t._uU(33,"\u2022 Condici\xf3n:"),t.qZA(),t._uU(34," Es una comparaci\xf3n o evaluaci\xf3n que puede dar como resultado verdadero o falso. Ejemplo: edad >= 18 (\xbfEs la edad mayor o igual a 18?)"),t.qZA(),t.TgZ(35,"div")(36,"span",19),t._uU(37,"\u2022 Bloque verdadero:"),t.qZA(),t._uU(38," Son las instrucciones que se ejecutan si la condici\xf3n se cumple (es verdadera)."),t.qZA(),t.TgZ(39,"div")(40,"span",19),t._uU(41,"\u2022 Bloque falso:"),t.qZA(),t._uU(42," Son las instrucciones que se ejecutan si la condici\xf3n no se cumple (es falsa)."),t.qZA(),t.TgZ(43,"div")(44,"span",19),t._uU(45,"\u2022 Camino alternativo:"),t.qZA(),t._uU(46," Algunas estructuras condicionales permiten evaluar m\xe1s de una condici\xf3n con else if o condicionales anidados."),t.qZA()()(),t.TgZ(47,"div",20)(48,"h3",21),t._uU(49,'\u{1f393} \xbfPor qu\xe9 se llaman "condicionales"?'),t.qZA(),t.TgZ(50,"p",22),t._uU(51," Porque la ejecuci\xf3n del c\xf3digo depende de una condici\xf3n que se debe cumplir. Si la condici\xf3n es verdadera, el programa hace una cosa. Si es falsa, hace otra o no hace nada. "),t.qZA(),t.TgZ(52,"h4",23),t._uU(53,"\u{1f4cd} Ejemplo en la vida real"),t.qZA(),t.TgZ(54,"div",24)(55,"p",25),t._uU(56,"Si en el sem\xe1foro hay luz verde \u2192 avanzas."),t.qZA(),t.TgZ(57,"p",26),t._uU(58,"Si no hay luz verde (amarilla o roja) \u2192 te detienes o esperas."),t.qZA()()(),t.TgZ(59,"div",27)(60,"h3",28),t._uU(61,"\u{1f4e6} Met\xe1fora: Camino con bifurcaciones"),t.qZA(),t.TgZ(62,"p",22),t._uU(63," Imagina que vas caminando y llegas a una bifurcaci\xf3n con dos letreros: "),t.qZA(),t.TgZ(64,"div",29)(65,"p",26),t._uU(66,'Uno dice "Si est\xe1 soleado \u2192 sigue por aqu\xed hacia el parque".'),t.qZA(),t.TgZ(67,"p",26),t._uU(68,'Otro dice "Si est\xe1 lloviendo \u2192 sigue por aqu\xed hacia el caf\xe9".'),t.qZA(),t.TgZ(69,"p",30),t._uU(70,"En ese punto, observas el clima (condici\xf3n) y tomas el camino seg\xfan el resultado. El programa eval\xfaa la condici\xf3n y ejecuta la ruta de instrucciones correspondiente, como en el ejemplo anterior."),t.qZA()()(),t.TgZ(71,"div",31)(72,"h3",32),t._uU(73,"\u{1f5a5} \xbfD\xf3nde se usan los condicionales?"),t.qZA(),t.TgZ(74,"p",22),t._uU(75," Los condicionales est\xe1n en casi todo tipo de programa: "),t.qZA(),t.TgZ(76,"div",24),t._uU(77," \u2022 Verificar permisos de acceso."),t._UZ(78,"br"),t._uU(79," \u2022 Decidir si un usuario ve cierta informaci\xf3n."),t._UZ(80,"br"),t._uU(81," \u2022 Ejecutar una acci\xf3n solo si hay datos disponibles."),t._UZ(82,"br"),t._uU(83," \u2022 Determinar qu\xe9 mensaje mostrar dependiendo de una respuesta."),t._UZ(84,"br"),t._uU(85," \u2022 Controlar el flujo de un videojuego (ganar, perder, seguir). "),t.qZA()(),t.TgZ(86,"div",33)(87,"h3",34),t._uU(88,"\u{1f9e0} Importancia de las estructuras condicionales"),t.qZA(),t.TgZ(89,"p",22),t._uU(90," Las estructuras condicionales son esenciales porque: "),t.qZA(),t.TgZ(91,"div",24),t._uU(92," \u2022 Permiten adaptar el comportamiento del programa a diferentes situaciones."),t._UZ(93,"br"),t._uU(94," \u2022 Son la base para tomar decisiones complejas."),t._UZ(95,"br"),t._uU(96," \u2022 Combinadas con variables, bucles y funciones, hacen que el programa sea flexible e interactivo. "),t.qZA()(),t.TgZ(97,"div",35)(98,"h3",36),t._uU(99,"\u{1f9ea} Curiosidades"),t.qZA(),t.TgZ(100,"p",22),t._uU(101," Algunos lenguajes permiten "),t.TgZ(102,"b"),t._uU(103,"expresiones condicionales"),t.qZA(),t._uU(104," en una sola l\xednea, como en Python: "),t.qZA(),t.TgZ(105,"div",37)(106,"span",38),t._uU(107,"mensaje"),t.qZA(),t._uU(108," = "),t.TgZ(109,"span",39),t._uU(110,'"Mayor de edad"'),t.qZA(),t.TgZ(111,"span",40),t._uU(112," if"),t.qZA(),t._uU(113," edad >= "),t.TgZ(114,"span",41),t._uU(115,"18"),t.qZA(),t.TgZ(116,"span",40),t._uU(117,"else"),t.qZA(),t.TgZ(118,"span",39),t._uU(119,'"Menor de edad"'),t.qZA()()()()()(),t.TgZ(120,"div",8)(121,"h2",42),t._uU(122,"\u{1f9ea} Ejemplos Din\xe1micos"),t.qZA(),t.TgZ(123,"p",43),t._uU(124," A continuaci\xf3n encontrar\xe1s ejemplos interactivos que demuestran c\xf3mo funcionan las estructuras condicionales en situaciones cotidianas. Cada ejemplo incluye un diagrama de flujo que puedes visualizar paso a paso. "),t.qZA(),t.TgZ(125,"div",44)(126,"div",45),t.YNc(127,tu,14,5,"div",46),t.qZA()(),t.TgZ(128,"div",47)(129,"p",48)(130,"strong"),t._uU(131,"\u{1f4a1} Consejo:"),t.qZA(),t._uU(132," Las estructuras condicionales son la base para crear programas que tomen decisiones inteligentes. Observa c\xf3mo cada ejemplo eval\xfaa una condici\xf3n y toma diferentes caminos seg\xfan el resultado. "),t.qZA()()(),t.TgZ(133,"div",8)(134,"h2",42),t._uU(135,"\u{1f3af} Ejercicios Pr\xe1cticos"),t.qZA(),t.TgZ(136,"p",43),t._uU(137," Ahora es tu turno de practicar. Estos ejercicios te ayudar\xe1n a dominar las estructuras condicionales usando programaci\xf3n visual con Blockly. Cada ejercicio te ense\xf1ar\xe1 un concepto espec\xedfico. "),t.qZA(),t.TgZ(138,"app-blockly-exercise",49),t.NdJ("exerciseCompleted",function(f){return a.onBlocklyExerciseCompleted(f)})("nextExercise",function(){return a.nextBlocklyExercise()})("previousExercise",function(){return a.previousBlocklyExercise()}),t.qZA()()()(),t.TgZ(139,"app-modal",50),t.NdJ("onClose",function(){return a.closeModal()}),t.qZA()),2&c&&(t.xp6(127),t.Q6J("ngForOf",a.examples),t.xp6(11),t.Q6J("exercises",a.blocklyExercises)("currentExerciseIndex",a.currentBlocklyExerciseIndex)("urlgif",a.urlGifts),t.xp6(1),t.Q6J("isVisible",a.showModal)("title",a.modalTitle)("componentType",a.modalComponentType)("componentInputs",a.modalComponentInputs))},dependencies:[V.sg,Ms,it],styles:[".line-clamp-2[_ngcontent-%COMP%]{display:-webkit-box;-webkit-line-clamp:2;line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}.line-clamp-3[_ngcontent-%COMP%]{display:-webkit-box;-webkit-line-clamp:3;line-clamp:3;-webkit-box-orient:vertical;overflow:hidden}.bg-white\\/60[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 16px #00000026;transition:all .2s ease-in-out}"]})}}return u})();const Wn=["flowchartRef"];function iu(u,T){1&u&&(t.TgZ(0,"h2",63),t._uU(1,"\u{1f4a1} Ejemplos Din\xe1micos"),t.qZA())}function su(u,T){1&u&&(t.TgZ(0,"h2",63),t._uU(1,"\u{1f3af} Ejercicios de Pr\xe1ctica"),t.qZA())}function Al(u,T){if(1&u){const r=t.EpF();t.TgZ(0,"div",18)(1,"h4",73),t._uU(2),t.qZA(),t.TgZ(3,"p",74),t._uU(4),t.qZA(),t.TgZ(5,"div",75)(6,"p",76),t._uU(7),t.qZA()(),t.TgZ(8,"div",77)(9,"button",78),t.NdJ("click",function(){t.CHM(r);const a=t.oxw(2);return t.KtG(a.previousExample())}),t.O4$(),t.TgZ(10,"svg",79),t._UZ(11,"path",80),t.qZA()(),t.kcU(),t.TgZ(12,"span",81),t._uU(13),t.qZA(),t.TgZ(14,"button",82),t.NdJ("click",function(){t.CHM(r);const a=t.oxw(2);return t.KtG(a.nextExample())}),t.O4$(),t.TgZ(15,"svg",79),t._UZ(16,"path",83),t.qZA()()()()}if(2&u){const r=t.oxw(2);t.xp6(2),t.Oqu(r.currentExample.title),t.xp6(2),t.Oqu(r.currentExample.description),t.xp6(3),t.Oqu(r.currentExample.question),t.xp6(2),t.Udp("background-color",r.canGoPreviousExample?"#f3ae22":"")("border-color",r.canGoPreviousExample?"#d18c00":""),t.ekj("opacity-50",!r.canGoPreviousExample)("cursor-not-allowed",!r.canGoPreviousExample),t.Q6J("disabled",!r.canGoPreviousExample),t.xp6(4),t.AsE(" ",r.currentExampleIndex+1," de ",r.examples.length," "),t.xp6(1),t.ekj("opacity-50",!r.canGoNextExample)("cursor-not-allowed",!r.canGoNextExample),t.Q6J("disabled",!r.canGoNextExample)}}function Pt(u,T){1&u&&(t.TgZ(0,"div",84)(1,"p"),t._uU(2,"Cargando ejemplos..."),t.qZA()())}function nu(u,T){if(1&u&&(t.TgZ(0,"div",85),t._UZ(1,"app-flowchart",86,87),t.qZA()),2&u){const r=t.oxw(2);t.xp6(1),t.Q6J("steps",r.currentExampleSteps)("title",r.currentExample.title)}}function ru(u,T){1&u&&(t.TgZ(0,"div",88)(1,"p",89),t._uU(2,"Selecciona un ejemplo para ver su diagrama de flujo"),t.qZA()())}function wi(u,T){1&u&&(t.TgZ(0,"div",88)(1,"p",89),t._uU(2,"No hay pasos disponibles para este ejemplo"),t.qZA()())}function lu(u,T){if(1&u&&(t.TgZ(0,"div",64)(1,"div",65)(2,"div",66),t.YNc(3,Al,17,19,"div",67),t.YNc(4,Pt,3,0,"div",68),t.qZA(),t.TgZ(5,"div",69)(6,"h3",70),t._uU(7,"\u{1f504} Paso a Paso"),t.qZA(),t.YNc(8,nu,3,2,"div",71),t.YNc(9,ru,3,0,"div",72),t.YNc(10,wi,3,0,"div",72),t.qZA()()()),2&u){const r=t.oxw();t.xp6(3),t.Q6J("ngIf",r.currentExample),t.xp6(1),t.Q6J("ngIf",!r.currentExample),t.xp6(4),t.Q6J("ngIf",r.currentExample&&r.currentExampleSteps.length>0),t.xp6(1),t.Q6J("ngIf",!r.currentExample),t.xp6(1),t.Q6J("ngIf",r.currentExample&&0===r.currentExampleSteps.length)}}function Sl(u,T){if(1&u){const r=t.EpF();t.TgZ(0,"div",64)(1,"app-blockly-exercise",90),t.NdJ("exerciseCompleted",function(a){t.CHM(r);const g=t.oxw();return t.KtG(g.onExerciseCompleted(a))})("nextExercise",function(){t.CHM(r);const a=t.oxw();return t.KtG(a.onNextBlocklyExercise())})("previousExercise",function(){t.CHM(r);const a=t.oxw();return t.KtG(a.onPreviousBlocklyExercise())}),t.qZA()()}if(2&u){const r=t.oxw();t.xp6(1),t.Q6J("exercises",r.blocklyExercises)("currentExerciseIndex",r.currentBlocklyExerciseIndex)("urlgif",r.urlGifts)}}function zn(u,T){1&u&&(t.TgZ(0,"div",91)(1,"div",92),t._uU(2,"\u{1f3af}"),t.qZA(),t.TgZ(3,"h2",93),t._uU(4,"Selecciona una opci\xf3n"),t.qZA(),t.TgZ(5,"p",94),t._uU(6,"Elige entre ejemplos o ejercicios para comenzar"),t.qZA()())}let cu=(()=>{class u{constructor(r){this.http=r,this.urlGifts="",this.activeSection="examples",this.examples=[],this.currentExampleIndex=0,this.currentExample=null,this.blocklyExercises=[],this.currentBlocklyExerciseIndex=0,this.completedExercises=new Set}ngOnInit(){this.loadExamples(),this.loadBlocklyExercises()}loadExamples(){this.http.get("assets/jsons-base/modulos.json").subscribe({next:r=>{this.examples=r.variables.examples,this.currentExample=this.examples[0],console.log("Variables examples loaded:",this.examples.length)},error:r=>{console.error("Error cargando ejemplos de variables:",r)}})}loadBlocklyExercises(){this.http.get("assets/jsons-base/blockly-exercises.json").subscribe({next:r=>{r.variables&&r.variables.exercises&&(this.blocklyExercises=r.variables.exercises,this.urlGifts=r.variables?.rtlGifts||"",console.log("Blockly exercises loaded:",this.blocklyExercises.length))},error:r=>{console.error("Error cargando ejercicios de Blockly:",r),this.urlGifts=""}})}showExamples(){this.activeSection="examples"}showPractice(){this.activeSection="practice"}previousExample(){this.currentExampleIndex>0&&(this.currentExampleIndex--,this.currentExample=this.examples[this.currentExampleIndex],this.resetFlowchart())}nextExample(){this.currentExampleIndex<this.examples.length-1&&(this.currentExampleIndex++,this.currentExample=this.examples[this.currentExampleIndex],this.resetFlowchart())}resetFlowchart(){setTimeout(()=>{this.flowchartComponent&&this.flowchartComponent.resetSteps()},0)}get canGoPreviousExample(){return this.currentExampleIndex>0}get canGoNextExample(){return this.currentExampleIndex<this.examples.length-1}get currentExampleSteps(){return this.currentExample?.steps||[]}onExerciseCompleted(r){r.success&&(this.completedExercises.add(r.exerciseId),console.log("Ejercicio completado:",r.exerciseId))}onNextBlocklyExercise(){this.currentBlocklyExerciseIndex++}onPreviousBlocklyExercise(){this.currentBlocklyExerciseIndex>0&&this.currentBlocklyExerciseIndex--}static{this.\u0275fac=function(c){return new(c||u)(t.Y36(fe.eN))}}static{this.\u0275cmp=t.Xpm({type:u,selectors:[["app-concepto-variables"]],viewQuery:function(c,a){if(1&c&&t.Gf(Wn,5),2&c){let g;t.iGM(g=t.CRH())&&(a.flowchartComponent=g.first)}},decls:192,vars:29,consts:[[1,"text-center","mb-8","mt-6"],[1,"text-3xl","font-bold","text-gray-800","mb-2","drop-shadow-md"],[1,"flex","items-center","justify-center","mb-1"],[1,"h-0.5","bg-gradient-to-r","from-transparent","via-blue-500","to-transparent","w-96","shadow-sm"],[1,"flex","items-center","justify-center"],[1,"h-px","bg-gradient-to-r","from-transparent","via-gray-300","to-transparent","w-64","opacity-60"],[1,"min-h-screen"],[1,"flex","flex-col","gap-6","p-4","mx-8"],[1,"bg-gray-500/20","backdrop-blur-md","p-6","rounded-lg","border","border-gray-400/30","shadow-lg"],[1,"mb-6"],[1,"text-xl","font-bold","mb-3","text-gray-800"],[1,"text-gray-700","leading-relaxed","mb-4","text-justify"],[1,"p-4","bg-teal-50","rounded-lg","border-l-4","border-teal-400"],[1,"text-lg","font-semibold","text-teal-600","mb-2"],[1,"text-gray-700","text-justify","mb-3"],[1,"bg-white","p-3","rounded","border","text-sm","space-y-2"],[1,"text-teal-600","font-semibold"],[1,"text-xl","font-bold","mb-5","text-gray-800"],[1,"space-y-4"],[1,"p-4","bg-blue-50","rounded-lg","border-l-4","border-blue-400"],[1,"text-lg","font-semibold","text-blue-600","mb-2"],[1,"text-gray-700","text-justify","mb-2","text-sm"],[1,"bg-white","p-3","rounded","border","font-mono","text-sm"],[1,"text-blue-600"],[1,"text-green-600"],[1,"text-gray-500"],[1,"p-4","bg-green-50","rounded-lg","border-l-4","border-green-400"],[1,"text-lg","font-semibold","text-green-600","mb-2"],[1,"bg-white","p-3","rounded","border","text-sm"],[1,"p-4","bg-yellow-50","rounded-lg","border-l-4","border-yellow-400"],[1,"text-lg","font-semibold","text-yellow-600","mb-2"],[1,"bg-white","p-3","rounded","border","overflow-x-auto"],[1,"w-full","text-sm"],[1,"bg-gray-50"],[1,"px-3","py-2","text-left","font-semibold","text-gray-700","border-b"],[1,"border-b"],[1,"px-3","py-2","font-mono","text-blue-600"],[1,"px-3","py-2","text-gray-700"],[1,"px-3","py-2","font-mono","text-red-600"],[1,"px-3","py-2","font-mono","text-green-600"],[1,"px-3","py-2","font-mono","text-orange-600"],[1,"px-3","py-2","font-mono","text-indigo-600"],[1,"p-4","bg-purple-50","rounded-lg","border-l-4","border-purple-400"],[1,"text-lg","font-semibold","text-purple-600","mb-2"],[1,"p-4","bg-red-50","rounded-lg","border-l-4","border-red-400"],[1,"text-lg","font-semibold","text-red-600","mb-2"],[1,"p-4","bg-indigo-50","rounded-lg","border-l-4","border-indigo-400"],[1,"text-lg","font-semibold","text-indigo-600","mb-2"],[1,"text-purple-600"],[1,"text-red-600"],["class","text-xl font-bold text-gray-800",4,"ngIf"],[1,"flex","min-h-[600px]","items-center"],[1,"flex","flex-col","items-center","justify-center","space-y-4","mr-6"],[1,"relative","group"],[1,"w-14","h-14","text-white","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border-2",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"],[1,"absolute","left-16","top-1/2","transform","-translate-y-1/2","bg-gray-800","text-white","text-xs","rounded","py-1","px-2","opacity-0","group-hover:opacity-100","transition-opacity","duration-200","whitespace-nowrap","z-10"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"],[1,"flex-1","flex","items-center","justify-center"],["class","w-full",4,"ngIf"],["class","text-center w-full",4,"ngIf"],[1,"pb-8"],[1,"text-xl","font-bold","text-gray-800"],[1,"w-full"],[1,"grid","grid-cols-2","gap-4","w-full","items-center"],[1,"min-h-[400px]","flex","flex-col","justify-center"],["class","space-y-4",4,"ngIf"],["class","text-center text-gray-500",4,"ngIf"],[1,"min-h-[400px]"],[1,"text-lg","font-semibold","text-gray-800","mb-4"],["class","min-h-[350px]",4,"ngIf"],["class","text-center text-gray-500 mt-8",4,"ngIf"],[1,"text-base","font-semibold","text-blue-600"],[1,"text-gray-700","text-justify","leading-relaxed","text-sm"],[1,"bg-blue-50","p-3","rounded-lg","border-l-4","border-blue-400"],[1,"text-blue-800","font-medium","text-sm"],[1,"flex","justify-between","items-center","pt-4","border-t","border-gray-200"],[1,"w-10","h-10","text-white","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border-2","disabled:bg-gray-400","disabled:border-gray-300","disabled:hover:bg-gray-400",3,"disabled","click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[1,"text-sm","text-green-600","font-bold"],[1,"w-10","h-10","bg-blue-600","hover:bg-blue-700","text-white","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border-2","border-blue-800","disabled:bg-gray-400","disabled:border-gray-300","disabled:hover:bg-gray-400",3,"disabled","click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],[1,"text-center","text-gray-500"],[1,"min-h-[350px]"],[3,"steps","title"],["flowchartRef",""],[1,"text-center","text-gray-500","mt-8"],[1,"text-sm"],[3,"exercises","currentExerciseIndex","urlgif","exerciseCompleted","nextExercise","previousExercise"],[1,"text-center","w-full"],[1,"text-6xl","mb-4"],[1,"text-xl","font-bold","mb-2","text-gray-800"],[1,"text-gray-600"]],template:function(c,a){1&c&&(t.TgZ(0,"div",0)(1,"h1",1),t._uU(2,"\u{1f4e6} Concepto de Variables en programaci\xf3n"),t.qZA(),t.TgZ(3,"div",2),t._UZ(4,"div",3),t.qZA(),t.TgZ(5,"div",4),t._UZ(6,"div",5),t.qZA()(),t.TgZ(7,"div",6)(8,"div",7)(9,"div",8)(10,"div",9)(11,"h2",10),t._uU(12,"\u{1f9e0} \xbfQu\xe9 es una variable?"),t.qZA(),t.TgZ(13,"p",11),t._uU(14," En programaci\xf3n, una variable es un espacio de memoria reservado para guardar datos que pueden cambiar durante la ejecuci\xf3n de un programa. Estos datos pueden ser n\xfameros, textos, valores booleanos (verdadero/falso), objetos u otros tipos de informaci\xf3n.. "),t.qZA(),t.TgZ(15,"div",12)(16,"h3",13),t._uU(17,"\u{1f527} Elementos fundamentales de una variable"),t.qZA(),t.TgZ(18,"p",14),t._uU(19," Una variable tiene tres elementos fundamentales: "),t.qZA(),t.TgZ(20,"div",15)(21,"div")(22,"span",16),t._uU(23,"\u2022 Nombre:"),t.qZA(),t._uU(24," El nombre es el identificador \xfanico de la variable, similar a una etiqueta que permite acceder a su contenido."),t.qZA(),t.TgZ(25,"div")(26,"span",16),t._uU(27,"\u2022 Tipo de dato:"),t.qZA(),t._uU(28," Define el tipo de informaci\xf3n que la variable puede almacenar. Ejemplos: entero, cadena (string), decimal, booleano."),t.qZA(),t.TgZ(29,"div")(30,"span",16),t._uU(31,"\u2022 Valor:"),t.qZA(),t._uU(32," Informaci\xf3n almacenada en la variable."),t.qZA()()()(),t.TgZ(33,"div",9)(34,"h2",17),t._uU(35,"\u{1f393} \xbfPor qu\xe9 se llaman variables?"),t.qZA(),t.TgZ(36,"div",18)(37,"div",19)(38,"h3",20),t._uU(39,"\u{1f504} El valor de una variable puede cambiar"),t.qZA(),t.TgZ(40,"p",14),t._uU(41," Se llaman variables porque, a diferencia de las constantes, su valor puede modificarse durante la ejecuci\xf3n del programa. "),t.qZA(),t.TgZ(42,"p",21),t._uU(43," Ejemplo en pseudoc\xf3digo: "),t.qZA(),t.TgZ(44,"div",22)(45,"span",23),t._uU(46,"edad"),t.qZA(),t._uU(47," = "),t.TgZ(48,"span",24),t._uU(49,"15"),t.qZA(),t._UZ(50,"br"),t.TgZ(51,"span",25),t._uU(52,"# M\xe1s tarde en el programa..."),t.qZA(),t._UZ(53,"br"),t.TgZ(54,"span",23),t._uU(55,"edad"),t.qZA(),t._uU(56," = "),t.TgZ(57,"span",24),t._uU(58,"16"),t.qZA()()(),t.TgZ(59,"div",26)(60,"h3",27),t._uU(61,"\u{1f4e6} Met\xe1fora: Caja con etiqueta"),t.qZA(),t.TgZ(62,"p",14),t._uU(63,' Imagina que tienes una caja con una etiqueta que dice "Nombre". Dentro puedes guardar un papel que diga "Camila". '),t.qZA(),t.TgZ(64,"div",28)(65,"span",24),t._uU(66,"La caja"),t.qZA(),t._uU(67," = la variable."),t._UZ(68,"br"),t.TgZ(69,"span",24),t._uU(70,"La etiqueta"),t.qZA(),t._uU(71," = el nombre."),t._UZ(72,"br"),t.TgZ(73,"span",24),t._uU(74,"El papel dentro"),t.qZA(),t._uU(75," = el valor. "),t.qZA()(),t.TgZ(76,"div",29)(77,"h3",30),t._uU(78,"\u{1f9fe} Ejemplo con distintos tipos de variables"),t.qZA(),t.TgZ(79,"div",31)(80,"table",32)(81,"thead",33)(82,"tr")(83,"th",34),t._uU(84,"Variable"),t.qZA(),t.TgZ(85,"th",34),t._uU(86,"Tipo"),t.qZA(),t.TgZ(87,"th",34),t._uU(88,"Valor"),t.qZA()()(),t.TgZ(89,"tbody")(90,"tr",35)(91,"td",36),t._uU(92,"nombre"),t.qZA(),t.TgZ(93,"td",37),t._uU(94,"Texto"),t.qZA(),t.TgZ(95,"td",38),t._uU(96,'"Luc\xeda"'),t.qZA()(),t.TgZ(97,"tr",35)(98,"td",36),t._uU(99,"edad"),t.qZA(),t.TgZ(100,"td",37),t._uU(101,"N\xfamero"),t.qZA(),t.TgZ(102,"td",39),t._uU(103,"21"),t.qZA()(),t.TgZ(104,"tr",35)(105,"td",36),t._uU(106,"altura"),t.qZA(),t.TgZ(107,"td",37),t._uU(108,"Decimal"),t.qZA(),t.TgZ(109,"td",40),t._uU(110,"1.65"),t.qZA()(),t.TgZ(111,"tr")(112,"td",36),t._uU(113,"es_estudiante"),t.qZA(),t.TgZ(114,"td",37),t._uU(115,"Booleano"),t.qZA(),t.TgZ(116,"td",41),t._uU(117,"true"),t.qZA()()()()()(),t.TgZ(118,"div",42)(119,"h3",43),t._uU(120,"\u{1f5a5} \xbfD\xf3nde se usan las variables?"),t.qZA(),t.TgZ(121,"p",14),t._uU(122," Las variables se usan en casi todo dentro de un programa: "),t.qZA(),t.TgZ(123,"div",28),t._uU(124," \u2022 Con el fin de mostrar informaci\xf3n al usuario"),t._UZ(125,"br"),t._uU(126," \u2022 A fin de hacer c\xe1lculos"),t._UZ(127,"br"),t._uU(128," \u2022 Con el prop\xf3sito de guardar respuestas del usuario"),t._UZ(129,"br"),t._uU(130," \u2022 Para poder controlar decisiones"),t._UZ(131,"br"),t._uU(132," \u2022 A manera de contar cosas (ej: puntuaci\xf3n) "),t.qZA()(),t.TgZ(133,"div",44)(134,"h3",45),t._uU(135,"\u{1f9e0} Importancia de las variables"),t.qZA(),t.TgZ(136,"p",14),t._uU(137," Las variables son una herramienta esencial en la mayor\xeda de los lenguajes de programaci\xf3n, ya que permiten almacenar y manipular informaci\xf3n durante la ejecuci\xf3n de un programa. Aunque no todos los programas o lenguajes requieren variables, su uso facilita la creaci\xf3n de programas m\xe1s complejos y flexibles. "),t.qZA(),t.TgZ(138,"div",28),t._uU(139," \u2022 Condiciones (if)"),t._UZ(140,"br"),t._uU(141," \u2022 Bucles o iteraciones (for, while)"),t._UZ(142,"br"),t._uU(143," \u2022 Funciones (para enviar y recibir datos)"),t._UZ(144,"br"),t._uU(145," \u2022 Entrada y salida de datos "),t.qZA()(),t.TgZ(146,"div",46)(147,"h3",47),t._uU(148,"\u{1f9ea} Curiosidades"),t.qZA(),t.TgZ(149,"p",14),t._uU(150," En Python no necesitas indicar el tipo (din\xe1mico). En Java/C++ s\xed (est\xe1tico): "),t.qZA(),t.TgZ(151,"div",22)(152,"span",48),t._uU(153,"int "),t.qZA(),t.TgZ(154,"span",23),t._uU(155,"edad"),t.qZA(),t._uU(156," = "),t.TgZ(157,"span",24),t._uU(158,"20"),t.qZA(),t._uU(159,";"),t._UZ(160,"br"),t.TgZ(161,"span",48),t._uU(162,"String "),t.qZA(),t.TgZ(163,"span",23),t._uU(164,"nombre"),t.qZA(),t._uU(165," = "),t.TgZ(166,"span",49),t._uU(167,'"Ana"'),t.qZA(),t._uU(168,"; "),t.qZA()()()()(),t.TgZ(169,"div",8)(170,"div",9),t.YNc(171,iu,2,0,"h2",50),t.YNc(172,su,2,0,"h2",50),t.qZA(),t.TgZ(173,"div",51)(174,"div",52)(175,"div",53)(176,"button",54),t.NdJ("click",function(){return a.showExamples()}),t.O4$(),t.TgZ(177,"svg",55),t._UZ(178,"path",56),t.qZA()(),t.kcU(),t.TgZ(179,"div",57),t._uU(180," Ejemplos "),t.qZA()(),t.TgZ(181,"div",53)(182,"button",54),t.NdJ("click",function(){return a.showPractice()}),t.O4$(),t.TgZ(183,"svg",55),t._UZ(184,"path",58),t.qZA()(),t.kcU(),t.TgZ(185,"div",57),t._uU(186," Ejercicios "),t.qZA()()(),t.TgZ(187,"div",59),t.YNc(188,lu,11,5,"div",60),t.YNc(189,Sl,2,3,"div",60),t.YNc(190,zn,7,0,"div",61),t.qZA()()()(),t._UZ(191,"div",62),t.qZA()),2&c&&(t.xp6(171),t.Q6J("ngIf","examples"===a.activeSection),t.xp6(1),t.Q6J("ngIf","practice"===a.activeSection),t.xp6(4),t.ekj("bg-green-600","examples"===a.activeSection)("bg-blue-600","examples"!==a.activeSection)("hover:bg-green-700","examples"===a.activeSection)("hover:bg-blue-700","examples"!==a.activeSection)("border-green-800","examples"===a.activeSection)("border-blue-800","examples"!==a.activeSection),t.xp6(6),t.Udp("background-color","practice"!==a.activeSection?"#f3ae22":"")("border-color","practice"!==a.activeSection?"#d18c00":""),t.ekj("bg-green-600","practice"===a.activeSection)("hover:bg-green-700","practice"===a.activeSection)("hover:bg-yellow-600","practice"!==a.activeSection)("border-green-800","practice"===a.activeSection),t.xp6(6),t.Q6J("ngIf","examples"===a.activeSection),t.xp6(1),t.Q6J("ngIf","practice"===a.activeSection),t.xp6(1),t.Q6J("ngIf",!a.activeSection))},dependencies:[V.O5,Ei,Ms]})}}return u})();const au=["flowchartRef"];function uu(u,T){if(1&u){const r=t.EpF();t.TgZ(0,"div",38)(1,"h3",39),t._uU(2),t.qZA(),t.TgZ(3,"p",40),t._uU(4),t.qZA(),t.TgZ(5,"div",41)(6,"a",42),t.NdJ("click",function(){const g=t.CHM(r).$implicit,f=t.oxw();return t.KtG(f.goToModule(g.url))}),t._uU(7," Ir al m\xf3dulo "),t.qZA()()()}if(2&u){const r=T.$implicit;t.xp6(2),t.Oqu(r.title),t.xp6(2),t.Oqu(r.description)}}function Ol(u,T){if(1&u){const r=t.EpF();t.TgZ(0,"div",43)(1,"h3",44),t._uU(2),t.qZA(),t.TgZ(3,"p",45),t._uU(4),t.qZA(),t.TgZ(5,"div",46)(6,"p",47),t._uU(7),t.qZA()(),t.TgZ(8,"div",48)(9,"button",49),t.NdJ("click",function(){t.CHM(r);const a=t.oxw();return t.KtG(a.previousExample())}),t.O4$(),t.TgZ(10,"svg",50),t._UZ(11,"path",51),t.qZA()(),t.kcU(),t.TgZ(12,"span",52),t._uU(13),t.qZA(),t.TgZ(14,"button",53),t.NdJ("click",function(){t.CHM(r);const a=t.oxw();return t.KtG(a.nextExample())}),t.O4$(),t.TgZ(15,"svg",50),t._UZ(16,"path",54),t.qZA()()()()}if(2&u){const r=t.oxw();t.xp6(2),t.Oqu(r.currentExample.title),t.xp6(2),t.Oqu(r.currentExample.description),t.xp6(3),t.Oqu(r.currentExample.question),t.xp6(2),t.Udp("background-color",r.canGoPreviousExample?"#f3ae22":"")("border-color",r.canGoPreviousExample?"#d18c00":""),t.ekj("opacity-50",!r.canGoPreviousExample)("cursor-not-allowed",!r.canGoPreviousExample),t.Q6J("disabled",!r.canGoPreviousExample),t.xp6(4),t.AsE(" ",r.currentExampleIndex+1," de ",r.examples.length," "),t.xp6(1),t.ekj("opacity-50",!r.canGoNextExample)("cursor-not-allowed",!r.canGoNextExample),t.Q6J("disabled",!r.canGoNextExample)}}function jn(u,T){1&u&&(t.TgZ(0,"div",55)(1,"p"),t._uU(2,"Cargando ejemplos..."),t.qZA()())}function Rl(u,T){if(1&u&&(t.TgZ(0,"div",56),t._UZ(1,"app-flowchart",57,58),t.qZA()),2&u){const r=t.oxw();t.xp6(1),t.Q6J("steps",r.currentExampleSteps)("title",r.currentExample.title)}}function Yn(u,T){1&u&&(t.TgZ(0,"div",59)(1,"p"),t._uU(2,"Selecciona un ejemplo de la secci\xf3n anterior para ver su diagrama de flujo"),t.qZA()())}function du(u,T){1&u&&(t.TgZ(0,"div",59)(1,"p"),t._uU(2,"No hay pasos disponibles para este ejemplo"),t.qZA()())}const hu=[{path:"",children:[{path:"inicio",component:qe},{path:"introduccion",component:(()=>{class u{constructor(r,c){this.http=r,this.navigationService=c,this.moduleCards=[],this.allModules=[],this.currentModuleIndex=0,this.examples=[],this.currentExampleIndex=0,this.currentExample=null}ngOnInit(){this.loadModules(),this.loadExamples()}loadModules(){this.http.get("assets/jsons-base/start-page.json").subscribe({next:r=>{this.allModules=r.cards,this.moduleCards=r.cards,this.currentModuleIndex=0,console.log("Modules loaded:",this.allModules.length,"Current index:",this.currentModuleIndex)},error:r=>{console.error("Error cargando m\xf3dulos:",r)}})}loadExamples(){this.http.get("assets/jsons-base/modulos.json").subscribe({next:r=>{this.examples=r.introduccion.examples,this.currentExample=this.examples[0],console.log("Examples loaded:",this.examples.length)},error:r=>{console.error("Error cargando ejemplos:",r)}})}previousExample(){this.currentExampleIndex>0&&(this.currentExampleIndex--,this.currentExample=this.examples[this.currentExampleIndex],this.resetFlowchart())}nextExample(){this.currentExampleIndex<this.examples.length-1&&(this.currentExampleIndex++,this.currentExample=this.examples[this.currentExampleIndex],this.resetFlowchart())}resetFlowchart(){setTimeout(()=>{this.flowchartComponent&&this.flowchartComponent.resetSteps()},0)}get canGoPreviousExample(){return this.currentExampleIndex>0}get canGoNextExample(){return this.currentExampleIndex<this.examples.length-1}get currentExampleSteps(){return this.currentExample?.steps||[]}get flowchartTitle(){return this.currentExample?`Diagrama de Flujo: ${this.currentExample.title}`:""}goToModule(r){this.navigationService.navigateTo(r)}static{this.\u0275fac=function(c){return new(c||u)(t.Y36(fe.eN),t.Y36(D))}}static{this.\u0275cmp=t.Xpm({type:u,selectors:[["app-introduccion"]],viewQuery:function(c,a){if(1&c&&t.Gf(au,5),2&c){let g;t.iGM(g=t.CRH())&&(a.flowchartComponent=g.first)}},decls:125,vars:6,consts:[[1,"text-center","mb-6","mt-6"],[1,"text-3xl","font-bold","text-gray-800","mb-2","drop-shadow-md"],[1,"flex","items-center","justify-center","mb-1"],[1,"h-0.5","bg-gradient-to-r","from-transparent","via-blue-500","to-transparent","w-96","shadow-sm"],[1,"flex","items-center","justify-center"],[1,"h-px","bg-gradient-to-r","from-transparent","via-gray-300","to-transparent","w-64","opacity-60"],[1,"min-h-screen"],[1,"flex","flex-col","gap-6","p-4","mx-8"],[1,"bg-gray-500/20","backdrop-blur-md","p-6","rounded-lg","border","border-gray-400/30","shadow-lg"],[1,"mb-0"],[1,"p-8","flex","flex-col","gap-4"],[1,"text-2xl","font-bold","mb-2","text-blue-800","flex","items-center","gap-2"],[1,"text-gray-800","leading-relaxed","text-lg"],[1,"font-semibold","text-blue-700"],[1,"bg-white/80","border-l-4","border-blue-300","rounded-lg","p-4","shadow","flex","flex-col","gap-2"],[1,"bg-yellow-50","border-l-4","border-yellow-400","rounded-lg","p-4","shadow","flex","flex-col","gap-2"],[1,"font-semibold","text-yellow-700"],[1,"list-decimal","list-inside","ml-4","text-gray-700"],[1,"text-gray-700"],[1,"bg-green-50","border-l-4","border-green-400","rounded-lg","p-4","shadow","flex","flex-col","gap-2"],[1,"font-semibold","text-green-700"],[1,"list-disc","list-inside","ml-4","text-gray-700"],[1,"mb-8"],[1,"text-2xl","font-bold","mb-2","text-purple-800","flex","items-center","gap-2"],[1,"list-disc","list-inside","text-gray-800","space-y-2","text-lg"],[1,"bg-white/80","border-l-4","border-purple-300","rounded-lg","p-4","shadow","flex","flex-col","gap-2","mt-4"],[1,"font-semibold","text-purple-700"],[1,"text-xl","font-bold","mb-4","text-gray-800"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-6"],["class","p-3 rounded-md border-l-8 shadow-lg","style","background: linear-gradient(135deg, #e0f2fe 0%, #f0f9ff 100%); border-image: linear-gradient(180deg, #3b82f6 0%, #06b6d4 100%) 1 100%; border-left-width: 8px;",4,"ngFor","ngForOf"],[1,"grid","grid-cols-2","gap-6"],[1,"bg-gray-500/20","backdrop-blur-md","p-6","rounded-lg","border","border-gray-400/30","shadow-lg","flex","flex-col"],[1,"text-xl","font-bold","mb-5"],["class","flex-1 flex flex-col justify-center space-y-4",4,"ngIf"],["class","flex-1 flex items-center justify-center text-gray-500",4,"ngIf"],["class","min-h-[400px]",4,"ngIf"],["class","text-center text-gray-500 mt-8",4,"ngIf"],[1,"pb-8"],[1,"p-3","rounded-md","border-l-8","shadow-lg",2,"background","linear-gradient(135deg, #e0f2fe 0%, #f0f9ff 100%)","border-image","linear-gradient(180deg, #3b82f6 0%, #06b6d4 100%) 1 100%","border-left-width","8px"],[1,"font-bold","text-blue-700"],[1,"text-sm","text-gray-600","text-justify","m-0","p-0"],[1,"flex","justify-end"],[1,"text-sm","text-blue-600","hover:text-blue-800","underline","cursor-pointer",3,"click"],[1,"flex-1","flex","flex-col","justify-center","space-y-4"],[1,"text-lg","font-semibold","text-blue-600"],[1,"text-gray-700","text-justify","leading-relaxed"],[1,"bg-blue-50","p-4","rounded-lg","border-l-4","border-blue-400"],[1,"text-blue-800","font-medium"],[1,"flex","justify-between","items-center","mt-6","pt-4","border-t","border-gray-200"],[1,"w-12","h-12","text-white","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border-2","disabled:bg-gray-400","disabled:border-gray-300","disabled:hover:bg-gray-400",3,"disabled","click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[1,"text-sm","text-green-600","font-bold"],[1,"w-12","h-12","bg-blue-600","hover:bg-blue-700","text-white","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border-2","border-blue-800","disabled:bg-gray-400","disabled:border-gray-300","disabled:hover:bg-gray-400",3,"disabled","click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],[1,"flex-1","flex","items-center","justify-center","text-gray-500"],[1,"min-h-[400px]"],[3,"steps","title"],["flowchartRef",""],[1,"text-center","text-gray-500","mt-8"]],template:function(c,a){1&c&&(t.TgZ(0,"div",0)(1,"h1",1),t._uU(2,"\u{1f4d8} Introducci\xf3n a la L\xf3gica de Programaci\xf3n"),t.qZA(),t.TgZ(3,"div",2),t._UZ(4,"div",3),t.qZA(),t.TgZ(5,"div",4),t._UZ(6,"div",5),t.qZA()(),t.TgZ(7,"div",6)(8,"div",7)(9,"div",8)(10,"div",9)(11,"div",10)(12,"h2",11),t._uU(13,"\u{1f9e0} \xbfQu\xe9 es la L\xf3gica de Programaci\xf3n?"),t.qZA(),t.TgZ(14,"p",12)(15,"span",13),t._uU(16,"La l\xf3gica de programaci\xf3n"),t.qZA(),t._uU(17," es el conjunto de principios, reglas y procesos mentales que se utilizan para resolver problemas mediante instrucciones precisas y ordenadas que una computadora puede entender. Es el fundamento sobre el cual se construyen los programas inform\xe1ticos. "),t.qZA(),t.TgZ(18,"div",14)(19,"span",13),t._uU(20,"\u{1f50e} En otras palabras:"),t.qZA(),t.TgZ(21,"span"),t._uU(22,"La l\xf3gica de programaci\xf3n es como una "),t.TgZ(23,"b"),t._uU(24,"receta de cocina"),t.qZA(),t._uU(25,": define los pasos exactos que debes seguir para lograr un resultado. Si sigues la receta correctamente, obtendr\xe1s el platillo deseado; si te saltas pasos o los haces en desorden, el resultado ser\xe1 diferente o fallar\xe1."),t.qZA()(),t.TgZ(26,"div",15)(27,"span",16),t._uU(28,"\u2615 Ejemplo cotidiano:"),t.qZA(),t.TgZ(29,"span"),t._uU(30,"Imagina que quieres preparar un caf\xe9:"),t.qZA(),t.TgZ(31,"ol",17)(32,"li"),t._uU(33,"Calienta agua."),t.qZA(),t.TgZ(34,"li"),t._uU(35,"Coloca caf\xe9 en una taza."),t.qZA(),t.TgZ(36,"li"),t._uU(37,"Vierte el agua caliente en la taza."),t.qZA(),t.TgZ(38,"li"),t._uU(39,"Mezcla y agrega az\xfacar si lo deseas."),t.qZA()(),t.TgZ(40,"span",18),t._uU(41,"Cada paso debe hacerse en orden. Si intentas mezclar antes de poner el agua, no funcionar\xe1. As\xed funciona la l\xf3gica en programaci\xf3n: cada instrucci\xf3n debe estar en el lugar correcto."),t.qZA()(),t.TgZ(42,"div",19)(43,"span",20),t._uU(44,"\u{1f9e9} Tipos de l\xf3gica en programaci\xf3n:"),t.qZA(),t.TgZ(45,"ul",21)(46,"li")(47,"b"),t._uU(48,"Secuencial:"),t.qZA(),t._uU(49," Las instrucciones se ejecutan una tras otra, en orden."),t.qZA(),t.TgZ(50,"li")(51,"b"),t._uU(52,"Condicional:"),t.qZA(),t._uU(53," Se toman decisiones seg\xfan ciertas condiciones (por ejemplo, \u201csi llueve, lleva paraguas\u201d)."),t.qZA(),t.TgZ(54,"li")(55,"b"),t._uU(56,"Repetitiva (bucles):"),t.qZA(),t._uU(57," Se repiten acciones mientras se cumpla una condici\xf3n (por ejemplo, \u201crepite hasta que la taza est\xe9 llena\u201d)."),t.qZA()()()()(),t.TgZ(58,"div",22)(59,"div",10)(60,"h2",23),t._uU(61,"\u{1f9e9} \xbfPor qu\xe9 es importante aprender l\xf3gica de programaci\xf3n?"),t.qZA(),t.TgZ(62,"ul",24)(63,"li"),t._uU(64,"Permite pensar de forma estructurada y ordenada."),t.qZA(),t.TgZ(65,"li"),t._uU(66,"Facilita el an\xe1lisis y resoluci\xf3n de problemas."),t.qZA(),t.TgZ(67,"li"),t._uU(68,"Es esencial para aprender cualquier lenguaje de programaci\xf3n."),t.qZA(),t.TgZ(69,"li"),t._uU(70,"Desarrolla el pensamiento algor\xedtmico: pensar paso a paso como una m\xe1quina."),t.qZA(),t.TgZ(71,"li"),t._uU(72,"Ayuda a dividir problemas grandes en partes peque\xf1as y manejables."),t.qZA(),t.TgZ(73,"li"),t._uU(74,"Fomenta la creatividad para encontrar diferentes soluciones a un mismo problema."),t.qZA(),t.TgZ(75,"li"),t._uU(76,"Es \xfatil no solo en inform\xe1tica, sino en la vida diaria (organizar tareas, planificar actividades, etc.)."),t.qZA()(),t.TgZ(77,"div",25)(78,"span",26),t._uU(79,"\u{1f6a6} Ejemplo de l\xf3gica aplicada a la vida diaria:"),t.qZA(),t.TgZ(80,"span"),t._uU(81,"Para cruzar la calle de forma segura:"),t.qZA(),t.TgZ(82,"ol",17)(83,"li"),t._uU(84,"Ac\xe9rcate a la acera y detente antes de la calle."),t.qZA(),t.TgZ(85,"li"),t._uU(86,"Mira primero a la izquierda."),t.qZA(),t.TgZ(87,"li"),t._uU(88,"Luego mira a la derecha."),t.qZA(),t.TgZ(89,"li"),t._uU(90,"Vuelve a mirar a la izquierda para asegurarte."),t.qZA(),t.TgZ(91,"li"),t._uU(92,"Observa si el sem\xe1foro para peatones est\xe1 en verde (si hay sem\xe1foro)."),t.qZA(),t.TgZ(93,"li"),t._uU(94,"Si el sem\xe1foro est\xe1 en rojo para peatones, espera."),t.qZA(),t.TgZ(95,"li"),t._uU(96,"Si no hay sem\xe1foro, verifica que no vengan autos ni bicicletas por ning\xfan lado."),t.qZA(),t.TgZ(97,"li"),t._uU(98,"Si no viene ning\xfan veh\xedculo, cruza la calle caminando, sin correr."),t.qZA(),t.TgZ(99,"li"),t._uU(100,"Mientras cruzas, sigue mirando a ambos lados por si aparece un veh\xedculo inesperado."),t.qZA(),t.TgZ(101,"li"),t._uU(102,"Si aparece un auto mientras cruzas, detente en un lugar seguro o retrocede si es necesario."),t.qZA(),t.TgZ(103,"li"),t._uU(104,"Llega a la acera del otro lado y contin\xfaa tu camino."),t.qZA()(),t.TgZ(105,"span",18),t._uU(106,"Como ves, este proceso paso a paso es un algoritmo de la vida real, igual que los que se usan en programaci\xf3n para tomar decisiones y garantizar la seguridad."),t.qZA()()()(),t.TgZ(107,"div")(108,"h2",27),t._uU(109,"\u{1f504} Conceptos Fundamentales y M\xf3dulos del Aplicativo"),t.qZA(),t.TgZ(110,"div",28),t.YNc(111,uu,8,2,"div",29),t.qZA()()(),t.TgZ(112,"div",30)(113,"div",31)(114,"h2",32),t._uU(115,"\u{1f373} Ejemplos Pr\xe1cticos de Pensamiento Algor\xedtmico"),t.qZA(),t.YNc(116,Ol,17,19,"div",33),t.YNc(117,jn,3,0,"div",34),t.qZA(),t.TgZ(118,"div",8)(119,"h2",27),t._uU(120,"\u{1f504} Diagrama de Flujo"),t.qZA(),t.YNc(121,Rl,3,2,"div",35),t.YNc(122,Yn,3,0,"div",36),t.YNc(123,du,3,0,"div",36),t.qZA()()(),t._UZ(124,"div",37),t.qZA()),2&c&&(t.xp6(111),t.Q6J("ngForOf",a.moduleCards),t.xp6(5),t.Q6J("ngIf",a.currentExample),t.xp6(1),t.Q6J("ngIf",!a.currentExample),t.xp6(4),t.Q6J("ngIf",a.currentExample&&a.currentExampleSteps.length>0),t.xp6(1),t.Q6J("ngIf",!a.currentExample),t.xp6(1),t.Q6J("ngIf",a.currentExample&&0===a.currentExampleSteps.length))},dependencies:[V.sg,V.O5,Ei]})}}return u})()},{path:"concepto-variables",component:cu},{path:"condicionales",component:ou},{path:"bucles",component:wl},{path:"modularidad",component:Qa},{path:"abstraccion",component:Wc},{path:"pensamiento-logico",component:Hc},{path:"toma-de-decisiones",component:Go},{path:"solucion-creativa",component:Zo},{path:"**",redirectTo:"inicio"}]}];let pu=(()=>{class u{static{this.\u0275fac=function(c){return new(c||u)}}static{this.\u0275mod=t.oAB({type:u})}static{this.\u0275inj=t.cJS({imports:[Je.Bz.forChild(hu),V.ez,Je.Bz]})}}return u})();var P=Ee(2773),at=Ee(6208);let He=(()=>{class u{static{this.\u0275fac=function(c){return new(c||u)}}static{this.\u0275mod=t.oAB({type:u})}static{this.\u0275inj=t.cJS({imports:[V.ez,pu,P.W,at.m]})}}return u})()},7519:function(ci,po){var Ee,Je;void 0!==(Je="function"==typeof(Ee=function(){var D,p,mt,Bo,Po,$t,Rt,go,Ve,ts,it,qe,fe,mo,ai,U,lt,ne,Fo,_t,$o,Uo,ct,Ne,_o,ui,zt,os,jt,is,hn,pn,gn,di,ss,hi,mn,$n,pi,Zo,Ho,_n,bn,fn,ns,Tn,En,vn,Ze,L,yn,gi,rs,mi,$i,_e,We,Go,ls,B,cs,I,R,_i,te,bi,ce,d,m,b,y,O,Ce,Mt,xn,Vo,as,Nt,bo,fi,Gr,Vr,bt,us,fo,Hc,To,ds,Cn,Eo,hs,Gc,kn,Vc,ps,ft,Dt,qr,gs,qc,Wr,Lt,vo,zr,jr,Yr,Xr,ms,In,Kr,Jr,Qr,yo,Wc,Ti,zc,wn,jc,$s,An,Yc,Sn,Xc,On,el,tl,Rn,Mn,Nn,_s,Kc,qo,bs,Dn,Ei,Jc,Gd,Yt,De,fs,Qc,Xt,Wo,Vd,ea,ol,ta,qd,oa,Ln,Wd,il,zd,sl,jd,Yd,Xd,vi,ia,nl,ze,rl,sa,ll,cl,Kd,na,ra,Jd,al,yi,ul,Qd,la,ca,eh,th,xi,oh,Bn,Ts,Es,Tt,ih,sh,nh,rh,lh,ch,ah,aa,zo,vs,ua,uh,dh,hh,ph,gh,mh,$h,_h,bh,da,fh,jo,dl,Th,ys,hl,ha,pa,pl,gl,ga,Eh,ma,$a,_a,ba,fa,Ta,Ea,vh,Pn,va,ml,$l,Kt,ya,xa,Fn,Ca,ka,yh,_l,Ia,wa,xh,Ch,kh,Ih,xs,Aa,Sa,Un,bl,wh,Ah,Oa,Ra,xo,Ma,Na,Sh,Oh,Rh,Mh,Da,Cs,La,Nh,Ci,Zn,fl,Tl,ki,Ba,El,Hn,Ae,Dh,ks,Is,Lh,Pa,vl,ws,Fa,Ii,Gn,Ua,Za,Bh,Ph,Fh,Ha,Uh,Ga,As,Zh,Vn,Hh,Gh,qn,Va,yl,Yo,Ss,qa,Os,xl,Rs,Wa,za,Co,Cl,Bt,ja,Ya,kl,Xa,Xo,Il,Ka,Ms,Ja,Qa,eu,wl,tu,ou,Wn,iu,su,Al,Pt,nu,ru,wi,lu,Sl,zn,cu,au,uu,Ol,jn,Rl,Yn,du,Vh,hu,pu,P,at,He,u,T,r,c,a,g,f,S,Z,he,ae,ve,H,Et,X,q,W,re,Y,z,oe,ie,pe,le,Be,Pe,Se,ut,kt,Xn,Ml,Ft,Ut,Ai,Ns,Nl,Kn,gu,Ds,Jn,Qn,er,Jt,Dl,Ll,Si,tr,or,ko,Bl,ir,Io,Oi,Ri,Ls,Bs,Pl,sr,Fl,Ps,Mi,Ul,Fs,Zl,nr,Hl,Zt,rr,Ni,Di,lr,Us,cr,ar,ur,dr,hr,Zs,Gl,pr,gr,wo,Ht,mr,Vl,Ko,Qt,ql,eo,$r,_r,Hs,br,Wl,Gs,zl,Vs,Li,jl,Yl,fr,Xl,Tr,Er,Kl,G,J,Qe,qh,Wh,tm,om,im,zh,jh,Yh,Xh,sm,C,t={};D=function(e,o,i,s){if(!(e instanceof w)&&"string"!=typeof e||""===`${e}`.trim())throw Error('Invalid type "'+e+'". The type must be a non-empty string or a Blockly.registry.Type.');if(e=`${e}`.toLowerCase(),"string"!=typeof o||""===o.trim())throw Error('Invalid name "'+o+'". The name must be a non-empty string.');const n=o.toLowerCase();if(!i)throw Error("Can not register a null value");let l=Bi[e],h=mu[e];if(l||(l=Bi[e]=Object.create(null),h=mu[e]=Object.create(null)),p(e,i),!s&&l[n]&&l[n]!==i)throw Error('Name "'+n+'" with type "'+e+'" already registered.');l[n]=i,h[n]=o},p=function(e,o){if(e===String(w.FIELD)&&"function"!=typeof o.fromJson)throw Error('Type "'+e+'" must have a fromJson function')},mt=function(e,o){e=`${e}`.toLowerCase(),o=o.toLowerCase();const i=Bi[e];i&&i[o]?(delete Bi[e][o],delete mu[e][o]):console.warn("Unable to unregister ["+o+"]["+e+"] from the registry.")},Bo=function(e,o,i){e=`${e}`.toLowerCase(),o=o.toLowerCase();const s=Bi[e];if(!s||!s[o]){if(o="Unable to find ["+o+"]["+e+"] in the registry.",i)throw Error(o+" You must require or register a "+e+" plugin.");return console.warn(o),null}return s[o]},Po=function(e,o){return e=`${e}`.toLowerCase(),o=o.toLowerCase(),!!(e=Bi[e])&&!!e[o]},$t=function(e,o,i){return Bo(e,o,i)},Rt=function(e,o,i){return Bo(e,o,i)},go=function(e,o,i){e=`${e}`.toLowerCase();var s=Bi[e];if(!s){if(s=`Unable to find [${e}] in the registry.`,i)throw Error(`${s} You must require or register a ${e} plugin.`);return console.warn(s),null}if(!o)return s;e=mu[e],i=Object.create(null);for(const n of Object.keys(s))i[e[n]]=s[n];return i},Ve=function(e,o,i){return"function"==typeof(o=o.plugins[String(e)]||vt)?o:$t(e,o,i)},ts=function(e,o){it(),_u=setTimeout(function(){o&&o.handleRightClick(e)},E_)},it=function(){_u&&(clearTimeout(_u),_u=0)},qe=function(){$u=null},fe=function(e){return!e.type.startsWith("pointer")||e instanceof PointerEvent&&ai(e)},mo=function(e){return`${e.pointerId}`},ai=function(e){const o=mo(e);return $u?$u===o:"pointerdown"===e.type&&($u=o,!0)},U=function(e,o,i,s,n){function l($){(n||fe($))&&(i?s.call(i,$):s($))}const h=[];if(o in qs)for(let $=0;$<qs[o].length;$++){const k=qs[o][$];e.addEventListener(k,l,!1),h.push([e,k,l])}else e.addEventListener(o,l,!1),h.push([e,o,l]);return h},lt=function(e,o,i,s){function n(h){i?s.call(i,h):s(h)}const l=[];if(o in qs)for(let h=0;h<qs[o].length;h++){const $=qs[o][h];e.addEventListener($,n,!1),l.push([e,$,n])}else e.addEventListener(o,n,!1),l.push([e,o,n]);return l},ne=function(e){const o=e[e.length-1][2];for(;e.length;){const[i,s,n]=e.pop();i.removeEventListener(s,n,!1)}return o},Fo=function(e){if(e.target instanceof HTMLElement){if(e.target.isContentEditable||"true"===e.target.getAttribute("data-is-text-input"))return!0;if(e.target instanceof HTMLInputElement)return"text"===(e=e.target).type||"number"===e.type||"email"===e.type||"password"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type;if(e.target instanceof HTMLTextAreaElement)return!0}return!1},_t=function(e){return!(!e.ctrlKey||!ep)||2===e.button},$o=function(e,o,i){const s=o.createSVGPoint();return s.x=e.clientX,s.y=e.clientY,i||(i=o.getScreenCTM().inverse()),s.matrixTransform(i)},Uo=function(e){switch(e.deltaMode){default:return{x:e.deltaX,y:e.deltaY};case 1:return{x:e.deltaX*_m,y:e.deltaY*_m};case 2:return{x:e.deltaX*bm,y:e.deltaY*bm}}},ct=function(){return"blockly-"+(C_++).toString(36)},Ne=function(){return op.genUid()},_o=function(e){return e.type===E.BLOCK_CREATE},ui=function(e){return e.type===E.BLOCK_DELETE},zt=function(e){return e.type===E.BLOCK_CHANGE},os=function(e){return e.type===E.BLOCK_FIELD_INTERMEDIATE_CHANGE},jt=function(e){return e.type===E.BLOCK_MOVE},is=function(e){return e.type===E.VAR_CREATE},hn=function(e){return e.type===E.VAR_DELETE},pn=function(e){return e.type===E.VAR_RENAME},gn=function(e){return e.type===E.BLOCK_DRAG},di=function(e){return e.type===E.SELECTED},ss=function(e){return e.type===E.CLICK},hi=function(e){return e.type===E.BUBBLE_OPEN},mn=function(e){return e.type===E.TRASHCAN_OPEN},$n=function(e){return e.type===E.TOOLBOX_ITEM_SELECT},pi=function(e){return e.type===E.THEME_CHANGE},Zo=function(e){return e.type===E.VIEWPORT_CHANGE},Ho=function(e){return e.type===E.COMMENT_CREATE},_n=function(e){return e.type===E.COMMENT_DELETE},bn=function(e){return e.type===E.COMMENT_CHANGE},fn=function(e){return e.type===E.COMMENT_MOVE},ns=function(e){return e.type===E.COMMENT_RESIZE},Tn=function(e){return e.type===E.COMMENT_DRAG},En=function(e){return e.type===E.COMMENT_COLLAPSE},vn=function(e){return e.type===E.FINISHED_LOADING},t.setRecordUndo$$module$build$src$core$events$utils=function(e){Jl=e},Ze=function(){return Jl},L=function(e){rp.fireInternal(e)},yn=function(e){if(_e()){if(!ei.length)try{requestAnimationFrame(()=>{setTimeout(gi,0)})}catch{setTimeout(gi,0)}rs(e)}},gi=function(){const e=mi(ei);ei.length=0;for(const o of e){if(!o.workspaceId)continue;let i;null==(i=bo(o.workspaceId))||i.fireChangeListener(o)}},rs=function(e){if(zt(e)&&"mutation"===e.element){let o;for(o=ei.length;o>0;o--){const i=ei[o-1];if(i.group!==e.group||i.workspaceId!==e.workspaceId||!jt(i)||i.newParentId!==e.blockId)break}ei.splice(o,0,e)}else ei.push(e)},mi=function(e){const o=[];for(const i of e)if(e=o[o.length-1],!i.isNull())if(e&&e.workspaceId===i.workspaceId&&e.group===i.group)if(jt(i)&&jt(e)&&i.blockId===e.blockId){if(e.newParentId=i.newParentId,e.newInputName=i.newInputName,e.newCoordinate=i.newCoordinate,e.reason||i.reason){let s,n;e.reason=Array.from(new Set((null!=(s=e.reason)?s:[]).concat(null!=(n=i.reason)?n:[])))}}else zt(i)&&zt(e)&&i.blockId===e.blockId&&i.element===e.element&&i.name===e.name?e.newValue=i.newValue:Zo(i)&&Zo(e)?(e.viewTop=i.viewTop,e.viewLeft=i.viewLeft,e.scale=i.scale,e.oldScale=i.oldScale):ss(i)&&hi(e)||o.push(i);else o.push(i);return o.filter(i=>!i.isNull())},$i=function(){for(let o,e=0;o=ei[e];e++)o.recordUndo=!1},t.disable$$module$build$src$core$events$utils=function(){sp++},t.enable$$module$build$src$core$events$utils=function(){sp--},_e=function(){return 0===sp},t.getGroup$$module$build$src$core$events$utils=function(){return Tm},t.setGroup$$module$build$src$core$events$utils=function(e){rp.setGroupInternal(e)},We=function(e){Tm="boolean"==typeof e?e?Ne():"":e},Go=function(e){const o=[];e=e.getDescendants(!1);for(let s,i=0;s=e[i];i++)o[i]=s.id;return o},ls=function(e,o){const i=B(e.type);if(!i)throw Error("Unknown event type.");return i.fromJson(e,o)},B=function(e){const o=$t(w.EVENT,e);if(!o)throw Error(`Event type ${e} not found in registry.`);return o},cs=function(e){if((jt(e)||_o(e))&&e.workspaceId){var o=bo(e.workspaceId);if(!e.blockId)throw Error("Encountered a blockEvent without a proper blockId");if(e=o.getBlockById(e.blockId)){const i=Jl;try{Jl=!1;const s=e.getParent();if(s&&!s.hasDisabledReason(np)){const n=e.getDescendants(!1);for(let h,l=0;h=n[l];l++)h.setDisabledReason(!1,np)}else if((e.outputConnection||e.previousConnection)&&!o.isDragging())do{e.setDisabledReason(!0,np),e=e.getNextBlock()}while(e)}finally{Jl=i}}}},I=function(e,o,i){e=document.createElementNS(Ql,`${e}`);for(const s in o)e.setAttribute(s,`${o[s]}`);return i&&i.appendChild(e),e},R=function(e,o){return!(o=o.split(" ")).every(i=>e.classList.contains(i))&&(e.classList.add(...o),!0)},_i=function(e,o){e.classList.remove(...o.split(" "))},te=function(e,o){return!(o=o.split(" ")).every(i=>!e.classList.contains(i))&&(e.classList.remove(...o),!0)},bi=function(e,o){return e.classList.contains(o)},ce=function(e){return e&&e.parentNode?e.parentNode.removeChild(e):null},d=function(e,o){const i=o.nextSibling;if(!(o=o.parentNode))throw Error("Reference node has no parent.");i?o.insertBefore(e,i):o.appendChild(e)},m=function(e,o){e.style.transform=o,e.style["-webkit-transform"]=o},b=function(){lp++,to||(to=Object.create(null))},y=function(){--lp||(to=null)},O=function(e){const o=e.textContent+"\n"+e.className.baseVal;var i;return to&&(i=to[o])||(i=window.getComputedStyle(e),i=Mt(e,i.fontSize,i.fontWeight,i.fontFamily),to&&(to[o]=i)),i},Ce=function(e,o,i,s){return Mt(e,o+"pt",i,s)},Mt=function(e,o,i,s){const n=e.textContent;var l;return e=n+"\n"+e.className.baseVal,to&&(l=to[e])||(ec||((l=document.createElement("canvas")).className="blocklyComputeCanvas",document.body.appendChild(l),ec=l.getContext("2d")),n&&ec?(ec.font=i+" "+o+" "+s,l=ec.measureText(n).width):l=0,to&&(to[e]=l)),l},xn=function(e,o,i,s){const n=document.createElement("span");n.style.font=i+" "+o+" "+s,n.textContent=e,(e=document.createElement("div")).style.width="1px",e.style.height="0",(o=document.createElement("div")).style.display="flex",o.style.position="fixed",o.style.top="0",o.style.left="0",o.appendChild(n),o.appendChild(e),document.body.appendChild(o),i={height:0,baseline:0};try{o.style.alignItems="baseline",i.baseline=e.offsetTop-n.offsetTop,o.style.alignItems="flex-end",i.height=e.offsetTop-n.offsetTop}finally{document.body.removeChild(o)}return i},t.getFocusManager$$module$build$src$core$focus_manager=function(){return tt.getFocusManager()},Vo=function(e){return e&&"function"==typeof e.getFocusableElement&&"function"==typeof e.getFocusableTree&&"function"==typeof e.onNodeFocus&&"function"==typeof e.onNodeBlur&&"function"==typeof e.canBeFocused},as=function(e){return Vo(e)&&"string"==typeof e.id&&"object"==typeof e.workspace&&"function"==typeof e.select&&"function"==typeof e.unselect},Nt=function(e,o){for(const i in o)e[i]=null!==o[i]&&Array.isArray(o[i])?Nt(e[i]||[],o[i]):null!==o[i]&&"object"==typeof o[i]?Nt(e[i]||Object.create(null),o[i]):o[i];return e},bo=function(e){return tc[e]||null},fi=function(){const e=[];for(const o in tc)e.push(tc[o]);return e},Gr=function(e){tc[e.id]=e},Vr=function(e){delete tc[e.id]},bt=function(){return ym},us=function(e){ym=e},fo=function(){const e=t.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode();return e&&as(e)?e:null},Hc=function(e){t.getFocusManager$$module$build$src$core$focus_manager().focusNode(e)},To=function(e){const o=fo();let i,s,n,l;const h=new(B(E.SELECTED))(null!=(i=o?.id)?i:null,null!=(s=e?.id)?s:null,null!=(l=null!=(n=e?.workspace.id)?n:o?.workspace.id)?l:"");L(h)},ds=function(){return xm},Cn=function(e){xm=e},Eo=function(e){for(;e.options.parentWorkspace;)e=e.options.parentWorkspace;const o=e.getParentSvg(),i=e.getCachedParentSvgSize();var s=o.parentElement;if(s instanceof HTMLElement){var n=s.offsetWidth;s=s.offsetHeight,i.width!==n&&(o.setAttribute("width",n+"px"),e.setCachedParentSvgSize(n,null)),i.height!==s&&(o.setAttribute("height",s+"px"),e.setCachedParentSvgSize(null,s)),e.resize()}},hs=function(e,o){const i=Object.create(null),s=e.getDescendants(!0);o&&(e=e.getNextBlock())&&(e=s.indexOf(e),s.splice(e,s.length-e));for(let l,n=0;l=s[n];n++)i[l.type]?i[l.type]++:i[l.type]=1;return i},Gc=function(e){return function(){this.jsonInit(e)}},kn=function(e){Cm.defineBlocksWithJsonArrayInternal(e)},Vc=function(e){t.defineBlocks$$module$build$src$core$common(t.createBlockDefinitionsFromJsonArray$$module$build$src$core$common(e))},t.createBlockDefinitionsFromJsonArray$$module$build$src$core$common=function(e){const o={};for(let i=0;i<e.length;i++){const s=e[i];if(!s){console.warn(`Block definition #${i} in JSON array is ${s}. Skipping`);continue}const n=s.type;n?o[n]={init:Gc(s)}:console.warn(`Block definition #${i} in JSON array is missing a type attribute. Skipping.`)}return o},t.defineBlocks$$module$build$src$core$common=function(e){for(const o of Object.keys(e)){const i=e[o];o in ye&&console.warn(`Block definition "${o}" overwrites previous definition.`),ye[o]=i}},ps=function(e){let o=bt();const i=t.getFocusManager$$module$build$src$core$focus_manager().getFocusedTree();for(const s of fi())if(i===s){o=s;break}!Fo(e)&&o&&(!o.rendered||o.isFlyout||o.isVisible())&&be.registry.onKeyDown(o,e)},ft=function(e,o){return-1!==(o=e.indexOf(o))&&(e.splice(o,1),!0)},Dt=function(e){if(cp)throw Error("CSS already injected");ap+="\n"+e},qr=function(e,o){cp||(cp=!0,e&&(e=o.replace(/[\\/]$/,""),o=ap.replace(/<<<PATH>>>/g,e),ap="",(e=document.createElement("style")).id="blockly-common-style",o=document.createTextNode(o),e.appendChild(o),document.head.insertBefore(e,document.head.firstChild)))},gs=function(e){return Am.getSizeInternal(e)},qc=function(e){if("none"!==Lt(e,"display"))return Wr(e);const o=e.style,i=o.display,s=o.visibility,n=o.position;o.visibility="hidden",o.position="absolute",o.display="inline";const l=e.offsetWidth;return e=e.offsetHeight,o.display=i,o.position=n,o.visibility=s,new ee(l,e)},Wr=function(e){return new ee(e.offsetWidth,e.offsetHeight)},Lt=function(e,o){return(e=window.getComputedStyle(e))[o]||e.getPropertyValue(o)},vo=function(e){const o=new A(0,0);e=e.getBoundingClientRect();var i=document.documentElement;return i=new A(window.pageXOffset||i.scrollLeft,window.pageYOffset||i.scrollTop),o.x=e.left+i.x,o.y=e.top+i.y,o},zr=function(){const e=document.body,o=document.documentElement;return new A(e.scrollLeft||o.scrollLeft,e.scrollTop||o.scrollTop)},jr=function(e){const o=parseFloat(Lt(e,"borderLeftWidth")),i=parseFloat(Lt(e,"borderRightWidth")),s=parseFloat(Lt(e,"borderTopWidth"));return e=parseFloat(Lt(e,"borderBottomWidth")),new Q(s,e,o,i)},Yr=function(e,o,i){e=Xr(e,o,i),o.scrollLeft=e.x,o.scrollTop=e.y},Xr=function(e,o,i){var s=vo(e),n=vo(o),l=jr(o);const h=s.x-n.x-l.left;return s=s.y-n.y-l.top,n=Wr(e),e=o.clientWidth-n.width,n=o.clientHeight-n.height,l=o.scrollLeft,o=o.scrollTop,i?(l+=h-e/2,o+=s-n/2):(l+=Math.min(h,Math.max(h-e,0)),o+=Math.min(s,Math.max(s-n,0))),new A(l,o)},ms=function(e){const o=new A(0,0);var i=e.x&&e.getAttribute("x");const s=e.y&&e.getAttribute("y");return i&&(o.x=parseInt(i)),s&&(o.y=parseInt(s)),(i=(i=e.getAttribute("transform"))&&i.match(Sm))&&(o.x+=Number(i[1]),i[3]&&(o.y+=Number(i[3]))),(e=e.getAttribute("style"))&&e.includes("translate")&&(e=e.match(Om))&&(o.x+=Number(e[1]),e[3]&&(o.y+=Number(e[3]))),o},In=function(e){let o=0,i=0;for(;e;){const s=ms(e);if(o+=s.x,i+=s.y,(" "+(e.getAttribute("class")||"")+" ").includes(" injectionDiv "))break;e=e.parentNode}return new A(o,i)},Kr=function(){const e=zr();return new Q(e.y,document.documentElement.clientHeight+e.y,e.x,document.documentElement.clientWidth+e.x)},Jr=function(){const e=document.documentElement,o=window;return new A(o.pageXOffset||e.scrollLeft,o.pageYOffset||e.scrollTop)},Qr=function(e,o){var i=o.x;o=o.y;const s=e.getInjectionDiv().getBoundingClientRect();return i=new A(i-s.left,o-s.top),o=e.getOriginOffsetInPixels(),A.difference(i,o).scale(1/e.scale)},yo=function(e,o){var i=o.scale(e.scale);o=i.x,i=i.y;const s=e.getInjectionDiv().getBoundingClientRect();return e=e.getOriginOffsetInPixels(),new A(o+s.left+e.x,i+s.top+e.y)},Wc=function(e){({document:xu=xu,DOMParser:ic=ic,XMLSerializer:sc=sc}=e),yu=new ic,dp=new sc},t.createElement$$module$build$src$core$utils$xml=function(e){return xu.createElementNS(Rm,e)},t.createTextNode$$module$build$src$core$utils$xml=function(e){return xu.createTextNode(e)},t.textToDom$$module$build$src$core$utils$xml=function(e){let o=yu.parseFromString(e,"text/xml");if(o&&o.documentElement&&!o.getElementsByTagName("parsererror").length)return o.documentElement;if((o=yu.parseFromString(e,"text/html"))&&o.body.firstChild&&"xml"===o.body.firstChild.nodeName.toLowerCase())return o.body.firstChild;throw Error(`DOMParser was unable to parse: ${e}`)},Ti=function(e){return zc(dp.serializeToString(e))},zc=function(e){return e.replace(U_,o=>`&#${o.charCodeAt(0)};`)},wn=function(e){return e?((e instanceof Element||"string"==typeof e)&&(e=tl(e),e=Xc(e)),jc(e),e):null},jc=function(e){const o=e.kind;if(e=e.contents,o&&o!==Mm&&o!==hp)throw Error("Invalid toolbox kind "+o+". Please supply either "+Mm+" or "+hp);if(!e)throw Error("Toolbox must have a contents attribute.")},$s=function(e){return e?e.contents?e.contents:Array.isArray(e)&&e.length>0&&!e[0].nodeType?e:On(e):[]},An=function(e){return Nm.hasCategoriesInternal(e)},Yc=function(e){if(!e)return!1;const o=e.kind;return o?o===hp:!!e.contents.filter(i=>"CATEGORY"===i.kind.toUpperCase()).length},Sn=function(e){return!(!e||!e.contents||!e.contents.filter(function(o){return"CATEGORY"===o.kind.toUpperCase()}).length)},Xc=function(e){const o={contents:On(e)};return e instanceof Node&&el(e,o),o},On=function(e){const o=[];let i=e.childNodes;i||(i=e);for(let n,s=0;n=i[s];s++){if(!n.tagName)continue;e={};const l=n.tagName.toUpperCase();e.kind=l,"BLOCK"===l?e.blockxml=n:n.childNodes&&n.childNodes.length>0&&(e.contents=On(n)),el(n,e),o.push(e)}return o},el=function(e,o){for(let i=0;i<e.attributes.length;i++){const s=e.attributes[i];s.nodeName.includes("css-")?(o.cssconfig=o.cssconfig||{},o.cssconfig[s.nodeName.replace("css-","")]=s.value):o[s.nodeName]=s.value}},tl=function(e){let o=null;if(e)if("string"==typeof e){if(o=t.textToDom$$module$build$src$core$utils$xml(e),"xml"!==o.nodeName.toLowerCase())throw TypeError("Toolbox should be an <xml> document.")}else e instanceof Element&&(o=e);return o},Rn=function(e,o,i,s,n,l){const h=l.scrollbar&&l.scrollbar.canScrollVertically();return e.horizontal===nc.LEFT?(i=n.absoluteMetrics.left+i,h&&l.RTL&&(i+=Oe.scrollbarThickness)):(i=n.absoluteMetrics.left+n.viewMetrics.width-o.width-i,h&&!l.RTL&&(i-=Oe.scrollbarThickness)),e.vertical===Ui.TOP?e=n.absoluteMetrics.top+s:(e=n.absoluteMetrics.top+n.viewMetrics.height-o.height-s,l.scrollbar&&l.scrollbar.canScrollHorizontally()&&(e-=Oe.scrollbarThickness)),new Q(e,e+o.height,i,i+o.width)},Mn=function(e,o){return{horizontal:o.toolboxMetrics.position===j.LEFT||e.horizontalLayout&&!e.RTL?nc.RIGHT:nc.LEFT,vertical:o.toolboxMetrics.position===j.BOTTOM?Ui.TOP:Ui.BOTTOM}},Nn=function(e,o,i,s){const n=e.left,l=e.right-e.left,h=e.bottom-e.top;for(let $=0;$<s.length;$++){const k=s[$];e.intersects(k)&&(e=new Q(e=i===Ys.UP?k.top-h-o:k.bottom+o,e+h,n,n+l),$=-1)}return e},_s=function(e,o){D(w.SERIALIZER,e,o)},Kc=function(e){mt(w.SERIALIZER,e)},qo=function(e,{addCoordinates:o=!1,saveIds:i=!0}={}){const s=e.workspace,n=Object.create(null);return n.height=e.getSize().height,n.width=e.getSize().width,i&&(n.id=e.id),o&&(o=e.getRelativeToSurfaceXY(),n.x=s.RTL?s.getWidth()-o.x:o.x,n.y=o.y),e.getText()&&(n.text=e.getText()),e.isCollapsed()&&(n.collapsed=!0),e.isOwnEditable()||(n.editable=!1),e.isOwnMovable()||(n.movable=!1),e.isOwnDeletable()||(n.deletable=!1),n},bs=function(e,o,{recordUndo:i=!1}={}){const s=Ze();if(t.setRecordUndo$$module$build$src$core$events$utils(i),i=o.newComment(e.id),void 0!==e.text&&i.setText(e.text),void 0!==e.x||void 0!==e.y){const l=i.getRelativeToSurfaceXY();let h,$=null!=(h=e.x)?h:l.x;var n;$=o.RTL?o.getWidth()-$:$,o=null!=(n=e.y)?n:l.y,i.moveTo(new A($,o))}if(void 0!==e.width||e.height){let l,h;n=i.getSize(),i.setSize(new ee(null!=(l=e.width)?l:n.width,null!=(h=e.height)?h:n.height))}return void 0!==e.collapsed&&i.setCollapsed(e.collapsed),void 0!==e.editable&&i.setEditable(e.editable),void 0!==e.movable&&i.setMovable(e.movable),void 0!==e.deletable&&i.setDeletable(e.deletable),t.setRecordUndo$$module$build$src$core$events$utils(s),i},Dn=function(e,o){D(w.PASTER,e,o)},Ei=function(e){mt(w.PASTER,e)},Jc=function(e){const o=e.workspace,i=e.getRelativeToSurfaceXY(),s=new A(0,0),n=o.getTopComments(!1).filter(l=>l.id!==e.id).map(l=>l.getRelativeToSurfaceXY());for(;Gd(A.sum(i,s),n);)s.translate(o.RTL?-30:30,30);e.moveTo(A.sum(i,s))},Gd=function(e,o){return o.some(i=>Math.abs(i.x-e.x)<=1&&Math.abs(i.y-e.y)<=1)},Yt=function(e,o){e.setAttribute(W_,o)},De=function(e,o,i){Array.isArray(i)&&(i=i.join(" ")),e.setAttribute(q_+o,`${i}`)},fs=function(e){return e&&"function"==typeof e.saveState&&"function"==typeof e.loadState},Qc=function(e){return ea(e),Vd()?(ol(),Promise.resolve()):(xr||(xr=new Promise(o=>{Tp=o,Um=window.requestAnimationFrame(()=>{ol(),o()})})),xr)},Xt=function(){return xr||Promise.resolve()},Wo=function(e){e||window.cancelAnimationFrame(Um),ol(e),!e&&Tp&&Tp()},Vd=function(){return pm},ea=function(e){bp.add(e),fp.set(e,t.getGroup$$module$build$src$core$events$utils());const o=e.getParent();o?ea(o):Iu.add(e)},ol=function(e){const o=e?new Set([e]):new Set([...Iu].map(l=>l.workspace)),i=[...Iu].filter(qd).filter(l=>o.has(l.workspace));for(var s of i)oa(s);for(const l of o)l.resizeContents();for(var n of i)s=n.getRelativeToSurfaceXY(),n.updateComponentLocations(s);for(const l of i)n=t.getGroup$$module$build$src$core$events$utils(),(s=fp.get(l))&&t.setGroup$$module$build$src$core$events$utils(s),l.bumpNeighbours(),t.setGroup$$module$build$src$core$events$utils(n);for(const l of i)ta(l);e||(xr=null)},ta=function(e){Iu.delete(e),bp.delete(e),fp.delete(e);for(const o of e.getChildren(!1))ta(o)},qd=function(e){return!e.isDisposed()&&!e.getParent()},oa=function(e){if(bp.has(e)&&e.initialized){for(const o of e.getChildren(!1))oa(o);e.renderEfficiently()}},Ln=function(e,o){qm(e,o)},Wd=function(e=Vm){qm=e},il=function(e,o){zm(e,o)},zd=function(e=Wm){zm=e},sl=function(e,o,i){Ym(e,o,i)},jd=function(e=jm){Ym=e},Yd=function(e,o){Km(e,o)},Xd=function(e=Xm){Km=e},vi=function(e){return e&&"function"==typeof e.getProcedureDef},ia=function(e){return e&&"function"==typeof e.getProcedureCall&&"function"==typeof e.renameProcedure},nl=function(e){return void 0!==e.getVariableModel},ze=function(e,o,i,s){e=e+" was deprecated in "+o+" and will be deleted in "+i+".",s&&(e+="\nUse "+s+" instead."),Qm.has(e)||(Qm.add(e),console.warn(e))},t.allUsedVarModels$$module$build$src$core$variables=function(e){e=e.getAllBlocks(!1);const o=new Set;for(let i=0;i<e.length;i++){const s=e[i].getVarModels();if(s)for(let n=0;n<s.length;n++){const l=s[n];l.getId()&&o.add(l)}}return Array.from(o.values())},t.allDeveloperVariables$$module$build$src$core$variables=function(e){e=e.getAllBlocks(!1);const o=new Set;for(let n,s=0;n=e[s];s++){var i=n.getDeveloperVariables;if(i){i=i();for(let l=0;l<i.length;l++)o.add(i[l])}}return Array.from(o.values())},rl=function(e){return sa(e,!1)},sa=function(e,o=!0){return ye.variables_set||ye.variables_get||console.warn("There are no variable blocks, but there is a variable category."),o?(ze("The XML return value of Blockly.Variables.flyoutCategory()","v12","v13","the same method, but handle a return type of FlyoutItemInfo[] (JSON) instead."),Kd(e)):(e.registerButtonCallback("CREATE_VARIABLE",function(i){yi(i.getTargetWorkspace())}),[{kind:"button",text:"%{BKY_NEW_VARIABLE}",callbackkey:"CREATE_VARIABLE"},...cl(e,e.getVariableMap().getVariablesOfType(""),!0)])},ll=function(e){return{VAR:{name:e.getName(),type:e.getType()}}},cl=function(e,o,i,s="variables_get",n="variables_set"){i&&(i=ye.math_change),e=[];const l=o.slice(-1)[0];return l&&(ye[n]&&e.push({kind:"block",type:n,gap:i?8:24,fields:ll(l)}),i&&e.push({kind:"block",type:"math_change",gap:ye[s]?20:8,fields:ll(l),inputs:{DELTA:{shadow:{type:"math_number",fields:{NUM:1}}}}})),ye[s]&&e.push(...o.sort(Ts).map(h=>({kind:"block",type:s,gap:8,fields:ll(h)}))),e},Kd=function(e){let o=[];const i=document.createElement("button");return i.setAttribute("text","%{BKY_NEW_VARIABLE}"),i.setAttribute("callbackKey","CREATE_VARIABLE"),e.registerButtonCallback("CREATE_VARIABLE",function(s){yi(s.getTargetWorkspace())}),o.push(i),e=na(e),o.concat(e)},na=function(e){const o=[];if((e=e.getVariableMap().getVariablesOfType("")).length>0){var i=e[e.length-1];if(ye.variables_set){var s=t.createElement$$module$build$src$core$utils$xml("block");s.setAttribute("type","variables_set"),s.setAttribute("gap",ye.math_change?"8":"24"),s.appendChild(xi(i)),o.push(s)}if(ye.math_change&&((s=t.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","math_change"),s.setAttribute("gap",ye.variables_get?"20":"8"),s.appendChild(xi(i)),i=t.textToDom$$module$build$src$core$utils$xml('<value name="DELTA"><shadow type="math_number"><field name="NUM">1</field></shadow></value>'),s.appendChild(i),o.push(s)),ye.variables_get){e.sort(Ts);for(let l,n=0;l=e[n];n++)(i=t.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","variables_get"),i.setAttribute("gap","8"),i.appendChild(xi(l)),o.push(i)}}return o},ra=function(e){return t$.generateUniqueNameInternal(e)},Jd=function(e){return al(vp.charAt(0),e.getVariableMap().getAllVariables().map(o=>o.getName()))},al=function(e,o){if(!o.length)return e;const i=vp;let s="",n=i.indexOf(e);for(;;){let l=!1;for(let h=0;h<o.length;h++)if(o[h].toLowerCase()===e){l=!0;break}if(!l)break;n++,n===i.length&&(n=0,s=`${Number(s)+1}`),e=i.charAt(n)+s}return e},yi=function(e,o,i){const n=i||"";!function s(l){ul(t.Msg$$module$build$src$core$msg.NEW_VARIABLE_TITLE,l,function(h){if(h){var $=la(h,e);if($){if($.getType()===n)var k=t.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS.replace("%1",$.getName());else k=(k=t.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE).replace("%1",$.getName()).replace("%2",$.getType());Ln(k,function(){s(h)})}else e.getVariableMap().createVariable(h,n),o&&o(h)}else o&&o(null)})}("")},t.renameVariable$$module$build$src$core$variables=function(e,o,i){!function s(n){const l=t.Msg$$module$build$src$core$msg.RENAME_VARIABLE_TITLE.replace("%1",o.getName());ul(l,n,function(h){if(h){var $=Qd(h,o.getType(),e),k=ca(o.getName(),h,e);if($||k){var F="";$?F=t.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE.replace("%1",$.getName()).replace("%2",$.getType()):k&&(F=t.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_A_PARAMETER.replace("%1",h).replace("%2",k)),Ln(F,function(){s(h)})}else e.getVariableMap().renameVariable(o,h),i&&i(h)}else i&&i(null)})}("")},ul=function(e,o,i){sl(e,o,function(s){s&&((s=s.replace(/[\s\xa0]+/g," ").trim())===t.Msg$$module$build$src$core$msg.RENAME_VARIABLE||s===t.Msg$$module$build$src$core$msg.NEW_VARIABLE)&&(s=null),i(s)})},Qd=function(e,o,i){i=i.getVariableMap().getAllVariables(),e=e.toLowerCase();for(let n,s=0;n=i[s];s++)if(n.getName().toLowerCase()===e&&n.getType()!==o)return n;return null},la=function(e,o){o=o.getVariableMap().getAllVariables(),e=e.toLowerCase();for(let s,i=0;s=o[i];i++)if(s.getName().toLowerCase()===e)return s;return null},ca=function(e,o,i){return i.getProcedureMap().getProcedures().length?eh(e,o,i):th(e,o,i)},eh=function(e,o,i){e=e.toLowerCase(),o=o.toLowerCase(),i=i.getProcedureMap().getProcedures();for(const n of i){var s=n.getParameters().filter(nl).map(l=>l.getVariableModel().getName());if(s&&(i=s.some(l=>l.toLowerCase()===e),s=s.some(l=>l.toLowerCase()===o),i&&s))return n.getName()}return null},th=function(e,o,i){e=e.toLowerCase(),o=o.toLowerCase(),i=i.getAllBlocks(!1);for(const n of i){if(!vi(n))continue;var s=(i=n.getProcedureDef())[1];const l=s.some(h=>h.toLowerCase()===e);if(s=s.some(h=>h.toLowerCase()===o),l&&s)return i[0]}return null},xi=function(e){const o=t.createElement$$module$build$src$core$utils$xml("field");return o.setAttribute("name","VAR"),o.setAttribute("id",e.getId()),o.setAttribute("variabletype",e.getType()),e=t.createTextNode$$module$build$src$core$utils$xml(e.getName()),o.appendChild(e),o},t.getOrCreateVariablePackage$$module$build$src$core$variables=function(e,o,i,s){let n=t.getVariable$$module$build$src$core$variables(e,o,i,s);return n||(n=oh(e,o,i,s)),n},t.getVariable$$module$build$src$core$variables=function(e,o,i,s){const n=e.getPotentialVariableMap();let l=null;if(o&&(l=e.getVariableById(o),!l&&n&&(l=n.getVariableById(o)),l))return l;if(i){if(void 0===s)throw Error("Tried to look up a variable by name without a type");l=e.getVariable(i,s),!l&&n&&(l=n.getVariable(i,s))}return l},oh=function(e,o,i,s){const n=e.getVariableMap(),l=e.getPotentialVariableMap();return i||(i=ra(e.isFlyout?e.targetWorkspace:e)),l?l.createVariable(i,s,o??void 0):n.createVariable(i,s,o)},Bn=function(e,o){e=e.getAllVariables();const i=[];if(o.length!==e.length)for(let s=0;s<e.length;s++){const n=e[s];o.includes(n)||i.push(n)}return i},Ts=function(e,o){return e.getName().localeCompare(o.getName(),void 0,{sensitivity:"base"})},Es=function(e,o){const i=[];e=e.getAllBlocks(!1);for(let s=0;s<e.length;s++){const n=e[s].getVarModels();if(n)for(let l=0;l<n.length;l++)n[l].getId()===o&&i.push(e[s])}return i},t.deleteVariable$$module$build$src$core$variables=function(e,o,i){var s=o.getName();const n=Es(e,o.getId());for(let l=n.length-1;l>=0;l--){const h=n[l];if("procedures_defnoreturn"===h.type||"procedures_defreturn"===h.type)return i=String(h.getFieldValue("NAME")),s=t.Msg$$module$build$src$core$msg.CANNOT_DELETE_VARIABLE_PROCEDURE.replace("%1",s).replace("%2",i),void Ln(s);h===i&&n.splice(l,1)}i&&n.length||n.length>1?(s=t.Msg$$module$build$src$core$msg.DELETE_VARIABLE_CONFIRMATION.replace("%1",String(n.length+(i&&!i.workspace.isFlyout?1:0))).replace("%2",s),il(s,l=>{l&&o&&e.getVariableMap().deleteVariable(o)})):e.getVariableMap().deleteVariable(o)},Tt=function(e,{addCoordinates:o=!1,addInputBlocks:i=!0,addNextBlocks:s=!0,doFullSerialization:n=!0,saveIds:l=!0}={}){if(e.isInsertionMarker())return null;const h={type:e.type,id:l?e.id:void 0};return o&&sh(e,h),ih(e,h),nh(e,h,n),rh(e,h,n),lh(e,h,n),i&&ch(e,h,n,l),s&&ah(e,h,n,l),h},ih=function(e,o){e.isCollapsed()&&(o.collapsed=!0),e.isEnabled()||(o.disabledReasons=Array.from(e.getDisabledReasons())),e.isOwnDeletable()||(o.deletable=!1),e.isOwnMovable()||(o.movable=!1),e.isOwnEditable()||(o.editable=!1),void 0!==e.inputsInline&&e.inputsInline!==e.inputsInlineDefault&&(o.inline=e.inputsInline),e.data&&(o.data=e.data)},sh=function(e,o){const i=e.workspace;e=e.getRelativeToSurfaceXY(),o.x=Math.round(i.RTL?i.getWidth()-e.x:e.x),o.y=Math.round(e.y)},nh=function(e,o,i){e.saveExtraState?null!==(e=e.saveExtraState(i))&&(o.extraState=e):e.mutationToDom&&null!==(e=e.mutationToDom())&&(o.extraState=Bt(e).replace(' xmlns="https://developers.google.com/blockly/xml"',""))},rh=function(e,o,i){const s=Object.create(null);for(const n of e.getIcons())fs(n)&&(e=n.saveState(i))&&(s[n.getType().toString()]=e);Object.keys(s).length&&(o.icons=s)},lh=function(e,o,i){const s=Object.create(null);for(const n of e.getFields())n.isSerializable()&&(s[n.name]=n.saveState(i));Object.keys(s).length&&(o.fields=s)},ch=function(e,o,i,s){const n=Object.create(null);for(let l=0;l<e.inputList.length;l++){const h=e.inputList[l];if(!h.connection)continue;const $=aa(h.connection,i,s);$&&(n[h.name]=$)}Object.keys(n).length&&(o.inputs=n)},ah=function(e,o,i,s){e.nextConnection&&(e=aa(e.nextConnection,i,s))&&(o.next=e)},aa=function(e,o,i){const s=e.getShadowState(!0);if(e=e.targetBlock(),!s&&!e)return null;const n=Object.create(null);return s&&(n.shadow=s),e&&!e.isShadow()&&(n.block=Tt(e,{doFullSerialization:o,saveIds:i})),n},zo=function(e,o,{recordUndo:i=!1}={}){return e=vs(e,o,{recordUndo:i}),o.rendered&&Wo(),e},vs=function(e,o,{parentConnection:i,isShadow:s=!1,recordUndo:n=!1}={}){const l=Ze();t.setRecordUndo$$module$build$src$core$events$utils(n),(n=t.getGroup$$module$build$src$core$events$utils())||t.setGroup$$module$build$src$core$events$utils(!0),t.disable$$module$build$src$core$events$utils();const h=o.getAllVariables();let $;try{$=ua(e,o,{parentConnection:i,isShadow:s})}finally{t.enable$$module$build$src$core$events$utils()}if(uh(o,h),_e()&&L(new(B(E.BLOCK_CREATE))($)),t.setGroup$$module$build$src$core$events$utils(n),t.setRecordUndo$$module$build$src$core$events$utils(l),o.rendered){const k=$;setTimeout(()=>{k.disposed||k.setConnectionTracking(!0)},1)}return $},ua=function(e,o,{parentConnection:i,isShadow:s=!1}={}){if(!e.type)throw new o$(e);const n=o.newBlock(e.type,e.id);return n.setShadow(s),dh(n,e),hh(n,e),ph(n,e),gh(i,n,e),mh(n,e),$h(n,e),_h(n,e),bh(n,e),fh(n,o.rendered),n},uh=function(e,o){if(_e())for(e=Bn(e,o),o=0;o<e.length;o++){const i=e[o];L(new(B(E.VAR_CREATE))(i))}},dh=function(e,o){let i=void 0===o.x?0:o.x;o=void 0===o.y?0:o.y;const s=e.workspace;i=s.RTL?s.getWidth()-i:i,e.moveBy(i,o)},hh=function(e,o){if(o.collapsed&&e.setCollapsed(!0),!1===o.deletable&&e.setDeletable(!1),!1===o.movable&&e.setMovable(!1),!1===o.editable&&e.setEditable(!1),!1===o.enabled&&e.setDisabledReason(!0,Gt),Array.isArray(o.disabledReasons))for(const i of o.disabledReasons)e.setDisabledReason(!0,i);void 0!==o.inline&&e.setInputsInline(o.inline),void 0!==o.data&&(e.data=o.data)},ph=function(e,o){o.extraState&&(e.loadExtraState?e.loadExtraState(o.extraState):e.domToMutation&&e.domToMutation(t.textToDom$$module$build$src$core$utils$xml(o.extraState)))},gh=function(e,o,i){if(e){if(e.getSourceBlock().isShadow()&&!o.isShadow())throw new s$(i);if(e.type===t.inputTypes$$module$build$src$core$inputs$input_types.VALUE){var s=o.outputConnection;if(!s)throw new dc("output",o,i)}else if(!(s=o.previousConnection))throw new dc("previous",o,i);if(!e.connect(s)){const n=o.workspace.connectionChecker;throw new i$(n.getErrorMessage(n.canConnectWithReason(s,e,!1),s,e),e.type===t.inputTypes$$module$build$src$core$inputs$input_types.VALUE?"output connection":"previous connection",o,i)}}},mh=function(e,o){if(o.icons){var i=Object.keys(o.icons);for(const n of i){i=o.icons[n];var s=e.getIcon(n);if(!s){if(!(s=$t(w.ICON,n,!1)))throw new n$(n,e,o);s=new s(e),e.addIcon(s)}fs(s)&&s.loadState(i)}}},$h=function(e,o){if(o.fields){var i=Object.keys(o.fields);for(let s=0;s<i.length;s++){const n=i[s],l=o.fields[n],h=e.getField(n);h?h.loadState(l):console.warn(`Ignoring non-existant field ${n} in block ${e.type}`)}}},_h=function(e,o){if(o.inputs){var i=Object.keys(o.inputs);for(let s=0;s<i.length;s++){const n=i[s],l=e.getInput(n);if(!l||!l.connection)throw new dc(n,e,o);da(l.connection,o.inputs[n])}}},bh=function(e,o){if(o.next){if(!e.nextConnection)throw new dc("next",e,o);da(e.nextConnection,o.next)}},da=function(e,o){o.shadow&&e.setShadowState(o.shadow),o.block&&ua(o.block,e.getSourceBlock().workspace,{parentConnection:e})},fh=function(e,o){if(o){e.setConnectionTracking(!1),e.initSvg(),e.queueRender();for(const i of e.getIcons())i.onLocationChange(e.getRelativeToSurfaceXY())}else e.initModel()},jo=function(e){return"function"==typeof e.bubbleIsVisible&&"function"==typeof e.setBubbleVisible&&"function"==typeof e.getBubble},dl=function(e){return e*Math.PI/180},Th=function(e){return 180*e/Math.PI},ys=function(e,o,i){if(i<e){const s=i;i=e,e=s}return Math.max(e,Math.min(o,i))},hl=function(){document.querySelector(".blocklyDropDownDiv")||((Re=document.createElement("div")).className="blocklyDropDownDiv",Re.tabIndex=-1,(ds()||document.body).appendChild(Re),(gc=document.createElement("div")).className="blocklyDropDownContent",Re.appendChild(gc),Mu=U(gc,"keydown",null,ps),(Qs=document.createElement("div")).className="blocklyDropDownArrow",Re.appendChild(Qs),Re.style.opacity="0",Re.style.transition="transform "+Ou+"s, opacity "+Ou+"s")},ha=function(e){kp=e},pa=function(){return Vi},pl=function(){return gc},gl=function(){Mu&&(ne(Mu),Mu=null),Re.remove(),hl()},ga=function(e,o){Re.style.backgroundColor=e,Re.style.borderColor=o},Eh=function(e,o,i,s,n=!0){return ba($a(o),e,n,i,s)},ma=function(e,o,i,s=!0){return u$=!0,ba(_a(e),e,s,o,i)},$a=function(e){var o=e.getSvgRoot();const i=e.workspace.scale,s=e.height*i;return e=e.width*i,o=vo(o),new Q(o.y,o.y+s,o.x,o.x+e)},_a=function(e){return e=e.getScaledBBox(),new Q(e.top,e.bottom,e.left,e.right)},ba=function(e,o,i,s,n){const l=e.left+(e.right-e.left)/2,h=e.bottom;e=e.top,n&&(e+=n);let $=(n=o.getSourceBlock()).workspace;for(;$.options.parentWorkspace;)$=$.options.parentWorkspace;return ha($.getParentSvg().parentNode),fa(o,n.RTL,l,h,l,e,i,s)},fa=function(e,o,i,s,n,l,h,$){return Vi=e,Js=$||null,Re.style.direction=o?"rtl":"ltr",e=bt(),c$=e.getRenderer().getClassName(),a$=e.getTheme().getClassName(),R(Re,c$),R(Re,a$),i=ya(i,s,n,l),h&&(Ru=t.getFocusManager$$module$build$src$core$focus_manager().takeEphemeralFocus(Re)),i},Ta=function(e,o,i,s){return{initialX:(e=Pn(e,i.left,i.right,s.width)).divX,initialY:o,finalX:e.divX,finalY:o+xp,arrowX:e.arrowX,arrowY:-(pc/2+yp),arrowAtTop:!0,arrowVisible:!0}},Ea=function(e,o,i,s){return{initialX:(e=Pn(e,i.left,i.right,s.width)).divX,initialY:o-s.height,finalX:e.divX,finalY:o-s.height-xp,arrowX:e.arrowX,arrowY:s.height-2*yp-pc/2,arrowAtTop:!1,arrowVisible:!0}},vh=function(e,o,i){return{initialX:(e=Pn(e,o.left,o.right,i.width)).divX,initialY:0,finalX:e.divX,finalY:0,arrowAtTop:null,arrowX:null,arrowY:null,arrowVisible:!1}},Pn=function(e,o,i,s){return o=ys(o,e-s/2,i-s),{arrowX:e=ys(i=l$,e=e-pc/2-o,s-i-pc),divX:o}},va=function(){return!!Vi},ml=function(e,o){return Vi===e&&(o?Kt():$l(),!0)},$l=function(){Re.style.transform="translate(0, 0)",Re.style.opacity="0",Cp=setTimeout(function(){Kt()},1e3*Ou),Js&&(Js(),Js=null)},Kt=function(){va()&&(Cp&&clearTimeout(Cp),Js&&(Js(),Js=null),gl(),Vi=null,bt().markFocused(),Ru&&(Ru(),Ru=null))},ya=function(e,o,i,s){(e=Nu.getPositionMetrics(e,o,i,s)).arrowVisible?(o=e.arrowX,i=e.arrowY,s=e.arrowAtTop?45:225,Qs.style.display="",Qs.style.transform=`translate(${o}px, ${i}px) rotate(${s}deg)`,Qs.setAttribute("class","blocklyDropDownArrow")):Qs.style.display="none",o=Math.floor(e.initialX),i=Math.floor(e.initialY),s=Math.floor(e.finalX);const n=Math.floor(e.finalY);return Re.style.left=o+"px",Re.style.top=i+"px",Re.style.display="block",Re.style.opacity="1",Re.style.transform="translate("+(s-o)+"px,"+(n-i)+"px)",!!e.arrowAtTop},xa=function(){if(Vi){var e=Vi.getSourceBlock();const o=(e=u$?_a(Vi):$a(e)).left+(e.right-e.left)/2;ya(o,e.bottom,o,e.top)}else $l()},Fn=function(e){return e.length?e.reduce(function(o,i){return o.length<i.length?o:i}).length:0},Ca=function(e,o){if(!e.length)return 0;if(1===e.length)return e[0].length;let s,i=0;for(o=o||Fn(e),s=0;s<o;s++){for(var n=e[0][s],l=1;l<e.length;l++)if(n!==e[l][s])return i;" "===n&&(i=s+1)}for(n=1;n<e.length;n++)if((l=e[n][s])&&" "!==l)return i;return o},ka=function(e,o){if(!e.length)return 0;if(1===e.length)return e[0].length;let s,i=0;for(o=o||Fn(e),s=0;s<o;s++){for(var n=e[0].substr(-s-1,1),l=1;l<e.length;l++)if(n!==e[l].substr(-s-1,1))return i;" "===n&&(i=s+1)}for(n=1;n<e.length;n++)if((l=e[n].charAt(e[n].length-s-1))&&" "!==l)return i;return o},t.wrap$$module$build$src$core$utils$string=function(e,o){e=e.split("\n");for(let i=0;i<e.length;i++)e[i]=yh(e[i],o);return e.join("\n")},yh=function(e,o){if(e.length<=o)return e;const i=e.trim().split(/\s+/);for(var s=0;s<i.length;s++)i[s].length>o&&(o=i[s].length);var n=-1/0;let l,h=1;do{s=n,l=e,e=[],n=i.length/h;let $=1;for(let k=0;k<i.length-1;k++)$<(k+1.5)/n?($++,e[k]=!0):e[k]=!1;e=Ia(i,e,o),n=_l(i,e,o),e=wa(i,e),h++}while(n>s);return l},_l=function(e,o,i){const s=[0],n=[];for(var l=0;l<e.length;l++)s[s.length-1]+=e[l].length,!0===o[l]?(s.push(0),n.push(e[l].charAt(e[l].length-1))):!1===o[l]&&s[s.length-1]++;for(e=Math.max(...s),o=0,l=0;l<s.length;l++)o-=2*Math.pow(Math.abs(i-s[l]),1.5),o-=Math.pow(e-s[l],1.5),".?!".includes(n[l])?o+=i/3:",;)]}".includes(n[l])&&(o+=i/4);return s.length>1&&s[s.length-1]<=s[s.length-2]&&(o+=.5),o},Ia=function(e,o,i){let n,s=_l(e,o,i);for(let l=0;l<o.length-1;l++){if(o[l]===o[l+1])continue;const h=[].concat(o);h[l]=!h[l],h[l+1]=!h[l+1];const $=_l(e,h,i);$>s&&(s=$,n=h)}return n?Ia(e,n,i):o},wa=function(e,o){const i=[];for(let s=0;s<e.length;s++)i.push(e[s]),void 0!==o[s]&&i.push(o[s]?"\n":" ");return i.join("")},t.isNumber$$module$build$src$core$utils$string=function(e){return/^\s*-?\d+(\.\d+)?\s*$/.test(e)},xh=function(e){Du=e},Ch=function(){return Du},kh=function(){return mc},Ih=function(){return Ge},xs=function(e){if(e=Aa(e)){for(e=e.tooltip;"function"==typeof e;)e=e();if("string"!=typeof e)throw Error("Tooltip function must return a string.");return e}return""},Aa=function(e){for(;e&&e.tooltip;){if("string"==typeof e.tooltip||"function"==typeof e.tooltip)return e;e=e.tooltip}return null},Sa=function(){document.querySelector(".blocklyTooltipDiv")||((Ge=document.createElement("div")).className="blocklyTooltipDiv",(ds()||document.body).appendChild(Ge))},Un=function(e){e.mouseOverWrapper_=lt(e,"pointerover",null,wh),e.mouseOutWrapper_=lt(e,"pointerout",null,Ah),e.addEventListener("pointermove",Oa,!1)},bl=function(e){e&&(ne(e.mouseOverWrapper_),ne(e.mouseOutWrapper_),e.removeEventListener("pointermove",Oa))},wh=function(e){Ir||(e=Aa(e.currentTarget),Vt!==e&&(xo(),$c=null,Vt=e),clearTimeout(h$))},Ah=function(e){Ir||(h$=setTimeout(function(){$c=Vt=null,xo()},1),clearTimeout(en),en=0)},Oa=function(e){if(Vt&&Vt.tooltip&&!Ir)if(mc){const o=Ip-e.pageX;e=wp-e.pageY,Math.sqrt(o*o+e*e)>p$&&xo()}else $c!==Vt&&(clearTimeout(en),Ip=e.pageX,wp=e.pageY,en=setTimeout(Mh,g$))},Ra=function(){$c=Vt=null,xo()},xo=function(){mc&&(mc=!1,Ge&&(Ge.style.display="none")),en&&(clearTimeout(en),en=0)},Ma=function(){xo(),Ir=!0},Na=function(){Ir=!1},Sh=function(){Ge&&Vt&&("function"==typeof Du?Du(Ge,Vt):Oh())},Oh=function(){var e=xs(Vt);e=(e=t.wrap$$module$build$src$core$utils$string(e,d$)).split("\n");for(let o=0;o<e.length;o++){const i=document.createElement("div");i.appendChild(document.createTextNode(e[o])),Ge.appendChild(i)}},Rh=function(e){const o=document.documentElement.clientWidth,i=document.documentElement.clientHeight;let s=Ip;s=e?s-(Ap+Ge.offsetWidth):s+Ap;let n=wp+Sp;return n+Ge.offsetHeight>i+window.scrollY&&(n-=Ge.offsetHeight+2*Sp),e?s=Math.max(Lu-window.scrollX,s):s+Ge.offsetWidth>o+window.scrollX-2*Lu&&(s=o-Ge.offsetWidth-2*Lu),{x:s,y:n}},Mh=function(){if(!Ir&&($c=Vt,Ge)){Ge.textContent="",Sh();var e=Vt.RTL;Ge.style.direction=e?"rtl":"ltr",Ge.style.display="block",mc=!0;var{x:o,y:i}=Rh(e);Ge.style.left=o+"px",Ge.style.top=i+"px"}},Da=function(){return Op},Cs=function(e){Op=e},La=function(){return Rp},Nh=function(e){Rp=e},Ci=function(e){e=`${e}`.toLowerCase().trim();var o=m$[e];if(o||(o="0x"===e.substring(0,2)?"#"+e.substring(2):e,/^#[0-9a-f]{6}$/.test(o="#"===o[0]?o:"#"+o)))return o;if(/^#[0-9a-f]{3}$/.test(o))return["#",o[1],o[1],o[2],o[2],o[3],o[3]].join("");var i=e.match(/^(?:rgb)?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/);return i&&(e=Number(i[1]),o=Number(i[2]),i=Number(i[3]),e>=0&&e<256&&o>=0&&o<256&&i>=0&&i<256)?Zn(e,o,i):null},Zn=function(e,o,i){return o=e<<16|o<<8|i,e<16?"#"+(16777216|o).toString(16).substr(1):"#"+o.toString(16)},fl=function(e){return(e=Ci(e))?[(e=parseInt(e.substr(1),16))>>16,e>>8&255,255&e]:[0,0,0]},Tl=function(e,o,i){let s=0,n=0,l=0;if(0===o)l=n=s=i;else{const h=Math.floor(e/60),$=e/60-h;e=i*(1-o);const k=i*(1-o*$);switch(o=i*(1-o*(1-$)),h){case 1:s=k,n=i,l=e;break;case 2:s=e,n=i,l=o;break;case 3:s=e,n=k,l=i;break;case 4:s=o,n=e,l=i;break;case 5:s=i,n=e,l=k;break;case 6:case 0:s=i,n=o,l=e}}return Zn(Math.floor(s),Math.floor(n),Math.floor(l))},ki=function(e,o,i){return(e=Ci(e))&&(o=Ci(o))?(e=fl(e),o=fl(o),Zn(Math.round(o[0]+i*(e[0]-o[0])),Math.round(o[1]+i*(e[1]-o[1])),Math.round(o[2]+i*(e[2]-o[2])))):null},Ba=function(e){return Tl(e,Op,255*Rp)},El=function(e,o,i){const s=[];var n=e.split("");n.push("");var l=0;e=[];let h=null;for(let F=0;F<n.length;F++){var $=n[F];if(0===l)if("%"===$)(l=e.join(""))&&s.push(l),e.length=0,l=1;else if(i&&"\n"===$){const we=e.join("");we&&s.push(we),e.length=0,s.push($)}else e.push($);else if(1===l)"%"===$?(e.push($),l=0):o&&"0"<=$&&$<="9"?(l=2,h=$,($=e.join(""))&&s.push($),e.length=0):"{"===$?l=3:(e.push("%",$),l=0);else if(2===l)if("0"<=$&&$<="9")h+=$;else{var k=void 0;s.push(parseInt(null!=(k=h)?k:"",10)),F--,l=0}else 3===l&&(""===$?(e.splice(0,0,"%{"),F--,l=0):"}"!==$?e.push($):(l=e.join(""),/[A-Z]\w*/i.test(l)&&($=($=l.toUpperCase()).startsWith("BKY_")?$.substring(4):null)&&$ in t.Msg$$module$build$src$core$msg?"string"==typeof(l=t.Msg$$module$build$src$core$msg[$])?Array.prototype.push.apply(s,El(l,o,i)):s.push(o?`${l}`:l):s.push("%{"+l+"}"),l=e.length=0))}for((o=e.join(""))&&s.push(o),k=[],e.length=0,n=0;n<s.length;n++)"string"!=typeof s[n]||i&&"\n"===s[n]?((o=e.join(""))&&k.push(o),e.length=0,k.push(s[n])):e.push(s[n]);return(o=e.join(""))&&k.push(o),e.length=0,k},Hn=function(e){return El(e,!0,!0)},Ae=function(e){return"string"!=typeof e?e:(e=El(e,!1,!1)).length?String(e[0]):""},Dh=function(e){let o=!0;const i=t.Msg$$module$build$src$core$msg,s=e.match(/%{BKY_[A-Z]\w*}/gi);if(s)for(let n=0;n<s.length;n++)void 0===i[s[n].toUpperCase().slice(6,-1)]&&(console.warn("No message string for "+s[n]+" in "+e),o=!1);return o},ks=function(e){const o="string"==typeof e?Ae(e):e;var i=Number(o);if(!isNaN(i)&&0<=i&&i<=360)return{hue:i,hex:Tl(i,Da(),255*La())};if(i=Ci(o))return{hue:null,hex:i};throw i='Invalid colour: "'+o+'"',e!==o&&(i+=' (from "'+e+'")'),Error(i)},Is=function(){return St},Lh=function(e){if(St=e,null===e){let o;null==(o=document.querySelector("."+Mp))||o.remove()}},Pa=function(){const e=ds()||document.body,o=document.querySelector("div."+Mp);o?St=o:((St=document.createElement("div")).className=Mp,St.tabIndex=-1),U(St,"keydown",null,ps),e.appendChild(St)},vl=function(e,o,i,s,n=!0){if(ws(),wr=e,Bu=i,i=St){if(i.style.direction=o?"rtl":"ltr",i.style.display="block",!s&&e instanceof ue){let $;s=null==($=e.getSourceBlock())?void 0:$.workspace}var l,h;_$=null!=(l=s)?l:null,e=null!=(h=s)?h:bt(),Ar=e.getRenderer().getClassName(),Sr=e.getTheme().getClassName(),Ar&&R(i,Ar),Sr&&R(i,Sr),n&&(Pu=t.getFocusManager$$module$build$src$core$focus_manager().takeEphemeralFocus(i))}},ws=function(){if(Fa()){wr=null;var e=St;e&&(e.style.display="none",e.style.left="",e.style.top="",Bu&&(Bu(),Bu=null),e.textContent="",Ar&&(te(e,Ar),Ar=""),Sr&&(te(e,Sr),Sr=""),bt().markFocused(),Pu&&(Pu(),Pu=null))}},Fa=function(){return!!wr},Ii=function(e){wr===e&&ws()},Gn=function(e){let o=null===_$,i=e;for(;!o&&i;){if(i===e){o=!0;break}i=e.options.parentWorkspace}o&&ws()},Ua=function(e,o,i){St.style.left=e+"px",St.style.top=o+"px",St.style.height=i+"px"},Za=function(e,o,i,s){const n=Ph(e,o,i);e=Bh(e,o,i,s),n<0?Ua(e,0,i.height+n):Ua(e,n,i.height)},Bh=function(e,o,i,s){return s?Math.min(Math.max(o.right-i.width,e.left),e.right-i.width):Math.max(Math.min(o.left,e.right-i.width),e.left)},Ph=function(e,o,i){return o.bottom+i.height>=e.bottom?o.top-i.height:o.bottom},Fh=function(e){return!(null==e||!e.repositionForWindowResize)},Ha=function(){Fh(wr)&&wr.repositionForWindowResize()||ws()},Uh=function(){return Fu},Ga=function(e){Fu=e},As=function(e,o,i,s,n){if(vl(b$,i,Va,s),o.length){n||(e instanceof PointerEvent?n=new A(e.clientX,e.clientY):(console.warn("Context menu opened with keyboard but no location given"),n=new A(0,0)));var l=Zh(o,i,e,n);Uu=l,Vn(l,i,n),setTimeout(function(){l.focus()},1),Fu=null}else qn()},Zh=function(e,o,i,s){const n=new ku;n.setRole(wt.MENU);for(let l=0;l<e.length;l++){const h=e[l];if(h.separator){n.addChild(new _p);continue}const $=new cc(h.text);$.setRightToLeft(o),$.setRole(wt.MENUITEM),n.addChild($),$.setEnabled(h.enabled),h.enabled&&$.onAction(function(k,F){qn(),requestAnimationFrame(()=>{setTimeout(()=>{h.callback(h.scope,i,F,s)},0)})},{})}return n},Vn=function(e,o,i){const s=Kr();i=new Q(i.y+s.top,i.y+s.top,i.x+s.left,i.x+s.left),Hh(e);const n=e.getSize();o&&(i.left+=n.width,i.right+=n.width,s.left+=n.width,s.right+=n.width),Za(s,i,n,o),e.focus()},Hh=function(e){var o=Is();if(!o)throw Error("Attempting to create a context menu when widget div is null");o=e.render(o),R(o,"blocklyContextMenu"),U(o,"contextmenu",null,Gh),e.focus()},Gh=function(e){e.preventDefault(),e.stopPropagation()},qn=function(){Ii(b$),Fu=null},Va=function(){Uu&&(Uu.dispose(),Uu=null)},t.callbackFactory$$module$build$src$core$contextmenu=function(e,o){return()=>{let i;t.disable$$module$build$src$core$events$utils();try{i=o instanceof Element?Xo(o,e.workspace):vs(o,e.workspace);const s=e.getRelativeToSurfaceXY();s.x=e.RTL?s.x-t.config$$module$build$src$core$config.snapRadius:s.x+t.config$$module$build$src$core$config.snapRadius,s.y+=2*t.config$$module$build$src$core$config.snapRadius,i.moveBy(s.x,s.y)}finally{t.enable$$module$build$src$core$events$utils()}return _e()&&!i.isShadow()&&L(new(B(E.BLOCK_CREATE))(i)),t.getFocusManager$$module$build$src$core$focus_manager().focusNode(i),i}},yl=function(e,o){return(o=$o(o,e.getParentSvg(),e.getInverseScreenCTM())).x/=e.scale,o.y/=e.scale,o},Yo=function(e,o,i){o=yl(e,o),T$.set(e,A.difference(i,o))},Ss=function(e,o){if(o=yl(e,o),!(e=T$.get(e)))throw Error("Drag not initialized");return A.sum(e,o)},qa=function(e,o=!1){const i=t.createElement$$module$build$src$core$utils$xml("xml");var s=xl(t.allUsedVarModels$$module$build$src$core$variables(e));s.hasChildNodes()&&i.appendChild(s);for(const n of e.getTopComments())i.appendChild(Os(n,o));for(e=e.getTopBlocks(!0),s=0;s<e.length;s++)i.appendChild(Rs(e[s],o));return i},Os=function(e,o=!1){const i=t.createElement$$module$build$src$core$utils$xml("comment");o||i.setAttribute("id",e.id),o=e.workspace;const s=e.getRelativeToSurfaceXY();return s.x=o.RTL?o.getWidth()-s.x:s.x,i.setAttribute("x",`${s.x}`),i.setAttribute("y",`${s.y}`),i.setAttribute("w",`${e.getSize().width}`),i.setAttribute("h",`${e.getSize().height}`),e.getText()&&(i.textContent=e.getText()),e.isCollapsed()&&i.setAttribute("collapsed","true"),e.isOwnEditable()||i.setAttribute("editable","false"),e.isOwnMovable()||i.setAttribute("movable","false"),e.isOwnDeletable()||i.setAttribute("deletable","false"),i},xl=function(e){const o=t.createElement$$module$build$src$core$utils$xml("variables");for(let i=0;i<e.length;i++){const s=e[i],n=t.createElement$$module$build$src$core$utils$xml("variable");n.appendChild(t.createTextNode$$module$build$src$core$utils$xml(s.getName())),s.getType()&&n.setAttribute("type",s.getType()),n.id=s.getId(),o.appendChild(n)}return o},Rs=function(e,o){if(e.isInsertionMarker()&&!(e=e.getChildren(!1)[0]))return new DocumentFragment;let i=0;if(e.workspace.RTL&&(i=e.workspace.getWidth()),o=Co(e,o),Al(o)){const s=e.getRelativeToSurfaceXY();o.setAttribute("x",String(Math.round(e.workspace.RTL?i-s.x:s.x))),o.setAttribute("y",String(Math.round(s.y)))}return o},Wa=function(e){if(e.isSerializable()){const o=t.createElement$$module$build$src$core$utils$xml("field");return o.setAttribute("name",e.name||""),e.toXml(o)}return null},za=function(e,o){for(const i of e.getFields())(e=Wa(i))&&o.appendChild(e)},Co=function(e,o){if(e.isInsertionMarker())return(o=e.getChildren(!1)[0])?Co(o):new DocumentFragment;const i=t.createElement$$module$build$src$core$utils$xml(e.isShadow()?"shadow":"block");if(i.setAttribute("type",e.type),o||(i.id=e.id),e.mutationToDom){var s=e.mutationToDom();s&&(s.hasChildNodes()||s.hasAttributes())&&i.appendChild(s)}if(za(e,i),s=e.getCommentText()){var n=e.getIcon(Ue.COMMENT),l=n.getBubbleSize(),h=n.bubbleIsVisible();n=n.getBubbleLocation();var $=t.createElement$$module$build$src$core$utils$xml("comment");$.appendChild(t.createTextNode$$module$build$src$core$utils$xml(s)),$.setAttribute("pinned",`${h}`),$.setAttribute("h",`${l.height}`),$.setAttribute("w",`${l.width}`),n&&($.setAttribute("x",`${e.workspace.RTL?e.workspace.getWidth()-(n.x+l.width):n.x}`),$.setAttribute("y",`${n.y}`)),i.appendChild($)}for(e.data&&((s=t.createElement$$module$build$src$core$utils$xml("data")).appendChild(t.createTextNode$$module$build$src$core$utils$xml(e.data)),i.appendChild(s)),s=0;s<e.inputList.length;s++){var k=void 0;h=!0,(l=e.inputList[s]).type!==t.inputTypes$$module$build$src$core$inputs$input_types.DUMMY&&l.type!==t.inputTypes$$module$build$src$core$inputs$input_types.END_ROW&&(n=l.connection.targetBlock(),l.type===t.inputTypes$$module$build$src$core$inputs$input_types.VALUE?k=t.createElement$$module$build$src$core$utils$xml("value"):l.type===t.inputTypes$$module$build$src$core$inputs$input_types.STATEMENT&&(k=t.createElement$$module$build$src$core$utils$xml("statement")),!($=l.connection.getShadowDom())||n&&n.isShadow()||k.appendChild(Cl($,o)),n&&(n=Co(n,o)).nodeType===ti.ELEMENT_NODE&&(k.appendChild(n),h=!1),k.setAttribute("name",l.name),h||i.appendChild(k))}let F;return void 0!==e.inputsInline&&e.inputsInline!==e.inputsInlineDefault&&i.setAttribute("inline",String(e.inputsInline)),e.isCollapsed()&&i.setAttribute("collapsed","true"),e.isEnabled()||i.setAttribute("disabled-reasons",Array.from(e.getDisabledReasons()).map(encodeURIComponent).join(",")),e.isOwnDeletable()||i.setAttribute("deletable","false"),e.isOwnMovable()||i.setAttribute("movable","false"),e.isOwnEditable()||i.setAttribute("editable","false"),(k=e.getNextBlock())&&(s=Co(k,o)).nodeType===ti.ELEMENT_NODE&&(F=t.createElement$$module$build$src$core$utils$xml("next"),F.appendChild(s),i.appendChild(F)),!(e=e.nextConnection&&e.nextConnection.getShadowDom())||k&&k.isShadow()||F.appendChild(Cl(e,o)),i},Cl=function(e,o){let s,i=e=e.cloneNode(!0);for(;i;)if(o&&"shadow"===i.nodeName&&i.removeAttribute("id"),i.firstChild)i=i.firstChild;else{for(;i&&!i.nextSibling;){let n;s=i,i=i.parentNode,s.nodeType===ti.TEXT_NODE&&""===s.data.trim()&&(null==(n=i)?void 0:n.firstChild)!==s&&ce(s)}i&&(s=i,i=i.nextSibling,s.nodeType===ti.TEXT_NODE&&""===s.data.trim()&&ce(s))}return e},Bt=function(e){return Ti(e).replace(/<(\w+)([^<]*)\/>/g,"<$1$2></$1>")},ja=function(e){e=Bt(e).split("<");let o="";for(let i=1;i<e.length;i++){const s=e[i];"/"===s[0]&&(o=o.substring(2)),e[i]=o+"<"+s,"/"!==s[0]&&"/>"!==s.slice(-2)&&(o+="  ")}return(e=(e=e.join("\n")).replace(/(<(\w+)\b[^>]*>[^\n]*)\n *<\/\2>/g,"$1</$2>")).replace(/^\n/,"")},Ya=function(e,o){return o.setResizesEnabled(!1),o.clear(),e=t.domToWorkspace$$module$build$src$core$xml(e,o),o.setResizesEnabled(!0),e},t.domToWorkspace$$module$build$src$core$xml=function(e,o){let i=0;o.RTL&&(i=o.getWidth());const s=[];b();const n=t.getGroup$$module$build$src$core$events$utils();n||t.setGroup$$module$build$src$core$events$utils(!0),o.setResizesEnabled&&o.setResizesEnabled(!1);let l=!0;try{for(let $,h=0;$=e.childNodes[h];h++){const k=$.nodeName.toLowerCase(),F=$;if("block"===k||"shadow"===k&&!Ze()){const we=Xo(F,o);let Te;s.push(we.id);const rt=parseInt(null!=(Te=F.getAttribute("x"))?Te:"10",10);let li;const Lo=parseInt(null!=(li=F.getAttribute("y"))?li:"10",10);isNaN(rt)||isNaN(Lo)||we.moveBy(o.RTL?i-rt:rt,Lo,["create"]),l=!1}else{if("shadow"===k)throw TypeError("Shadow block cannot be a top-level block.");if("comment"===k)kl(F,o);else if("variables"===k){if(!l)throw Error("'variables' tag must exist once before block and shadow tag elements in the workspace XML, but it was found in another location.");Il(F,o),l=!1}}}}finally{t.setGroup$$module$build$src$core$events$utils(n),o.setResizesEnabled&&o.setResizesEnabled(!0),o.rendered&&Wo(),y()}return L(new(B(E.FINISHED_LOADING))(o)),s},kl=function(e,o){var i;const s=null!=(i=e.getAttribute("id"))?i:void 0;var n,l;let h;var $;let k;return(i=o.rendered?new so(o,s):new fc(o,s)).setText(null!=(n=e.textContent)?n:""),n=parseInt(null!=(l=e.getAttribute("x"))?l:"",10),l=parseInt(null!=(h=e.getAttribute("y"))?h:"",10),isNaN(n)||isNaN(l)||(n=o.RTL?o.getWidth()-n:n,i.moveTo(new A(n,l))),o=parseInt(null!=($=e.getAttribute("w"))?$:"",10),$=parseInt(null!=(k=e.getAttribute("h"))?k:"",10),isNaN(o)||isNaN($)||i.setSize(new ee(o,$)),"true"===e.getAttribute("collapsed")&&i.setCollapsed(!0),"false"===e.getAttribute("editable")&&i.setEditable(!1),"false"===e.getAttribute("movable")&&i.setMovable(!1),"false"===e.getAttribute("deletable")&&i.setDeletable(!1),i},Xa=function(e,o){if(!o.getBlocksBoundingBox)return t.domToWorkspace$$module$build$src$core$xml(e,o);var i=o.getBlocksBoundingBox();if(e=t.domToWorkspace$$module$build$src$core$xml(e,o),i&&i.top!==i.bottom){var s=i.bottom;i=o.RTL?i.right:i.left;var n=1/0;let l=-1/0,h=1/0;for(let $=0;$<e.length;$++){const k=o.getBlockById(e[$]).getRelativeToSurfaceXY();k.y<h&&(h=k.y),k.x<n&&(n=k.x),k.x>l&&(l=k.x)}for(s=s-h+10,i=o.RTL?i-l:i-n,n=0;n<e.length;n++)o.getBlockById(e[n]).moveBy(i,s,["create"])}return e},t.domToBlock$$module$build$src$core$xml=function(e,o){return e=Xo(e,o),o.rendered&&Wo(),e},Xo=function(e,o){t.disable$$module$build$src$core$events$utils();var i=o.getAllVariables();let s;try{if(s=Wn(e,o),o.rendered){const n=s,l=s.getDescendants(!1);n.setConnectionTracking(!1);for(let h=l.length-1;h>=0;h--)l[h].initSvg();for(let h=l.length-1;h>=0;h--)l[h].queueRender();setTimeout(function(){n.disposed||n.setConnectionTracking(!0)},1),o.resizeContents()}else{const n=s.getDescendants(!1);for(let l=n.length-1;l>=0;l--)n[l].initModel()}}finally{t.enable$$module$build$src$core$events$utils()}if(_e()){for(e=Bn(o,i),o=0;o<e.length;o++)i=e[o],L(new(B(E.VAR_CREATE))(i));L(new(B(E.BLOCK_CREATE))(s))}return s},Il=function(e,o){for(let s=0;s<e.children.length;s++){var i=e.children[s];const n=i.getAttribute("type"),l=i.getAttribute("id");if(!(i=i.textContent))break;let h;o.getVariableMap().createVariable(i,null!=(h=n)?h:void 0,l)}},Ka=function(e){const o={mutation:[],comment:[],data:[],field:[],input:[],next:[]};for(let i=0;i<e.children.length;i++){const s=e.children[i];if(s.nodeType!==ti.TEXT_NODE)switch(s.nodeName.toLowerCase()){case"mutation":o.mutation.push(s);break;case"comment":o.comment.push(s);break;case"data":o.data.push(s);break;case"title":case"field":o.field.push(s);break;case"value":case"statement":o.input.push(s);break;case"next":o.next.push(s);break;default:console.warn("Ignoring unknown tag: "+s.nodeName)}}return o},Ms=function(e,o){let i=!1;for(let s=0;s<e.length;s++)o.domToMutation&&(o.domToMutation(e[s]),o.initSvg&&(i=!0));return i},Ja=function(e,o){for(let i=0;i<e.length;i++){const s=e[i],n=s.textContent,l="true"===s.getAttribute("pinned");let h;const $=parseInt(null!=(h=s.getAttribute("w"))?h:"50",10);let k;const F=parseInt(null!=(k=s.getAttribute("h"))?k:"50",10);let we,rt,Te=parseInt(null!=(we=s.getAttribute("x"))?we:"",10);const li=parseInt(null!=(rt=s.getAttribute("y"))?rt:"",10);o.setCommentText(n);const Lo=o.getIcon(Ue.COMMENT);isNaN($)||isNaN(F)||Lo.setBubbleSize(new ee($,F)),Lo.setBubbleVisible(l),setTimeout(()=>{isNaN(Te)||isNaN(li)||(Te=o.workspace.RTL?o.workspace.getWidth()-(Te+$):Te,Lo.setBubbleLocation(new A(Te,li))),Lo.setBubbleVisible(l)},1)}},Qa=function(e,o){for(let i=0;i<e.length;i++)o.data=e[i].textContent},eu=function(e,o){for(let i=0;i<e.length;i++){const s=e[i],n=s.getAttribute("name");n?iu(o,n,s):console.warn(`Ignoring unnamed field in block ${o.type}`)}},wl=function(e){let o=null,i=null;for(let s=0;s<e.childNodes.length;s++){const n=e.childNodes[s];Al(n)&&("block"===n.nodeName.toLowerCase()?o=n:"shadow"===n.nodeName.toLowerCase()&&(i=n))}return{childBlockElement:o,childShadowElement:i}},tu=function(e,o,i,s){for(let l=0;l<e.length;l++){var n=e[l];const h=n.getAttribute("name"),$=h?i.getInput(h):null;if(!$){console.warn("Ignoring non-existent input "+h+" in block "+s);break}if((n=wl(n)).childBlockElement){if(!$.connection)throw TypeError("Input connection does not exist.");Wn(n.childBlockElement,o,$.connection,!1)}if(n.childShadowElement){let k;null==(k=$.connection)||k.setShadowDom(n.childShadowElement)}}},ou=function(e,o,i){for(let s=0;s<e.length;s++){const n=wl(e[s]);if(n.childBlockElement){if(!i.nextConnection)throw TypeError("Next statement does not exist.");if(i.nextConnection.isConnected())throw TypeError("Next statement is already connected.");Wn(n.childBlockElement,o,i.nextConnection,!0)}n.childShadowElement&&i.nextConnection&&i.nextConnection.setShadowDom(n.childShadowElement)}},Wn=function(e,o,i,s){var n;const l=e.getAttribute("type");if(!l)throw TypeError("Block type unspecified: "+e.outerHTML);var h=null!=(n=e.getAttribute("id"))?n:void 0;n=o.newBlock(l,h),h=Ka(e);const $=Ms(h.mutation,n);if(Ja(h.comment,n),Qa(h.data,n),i)if(s){if(!n.previousConnection)throw TypeError("Next block does not have previous statement.");i.connect(n.previousConnection)}else if(n.outputConnection)i.connect(n.outputConnection);else{if(!n.previousConnection)throw TypeError("Child block does not have output or previous statement.");i.connect(n.previousConnection)}if(eu(h.field,n),tu(h.input,o,n,l),ou(h.next,o,n),$&&n.initSvg(),(o=e.getAttribute("inline"))&&n.setInputsInline("true"===o),(o=e.getAttribute("disabled"))&&n.setDisabledReason("true"===o||"disabled"===o,Gt),null!==(o=e.getAttribute("disabled-reasons")))for(var k of o.split(","))n.setDisabledReason(!0,decodeURIComponent(k));if((k=e.getAttribute("deletable"))&&n.setDeletable("true"===k),(k=e.getAttribute("movable"))&&n.setMovable("true"===k),(k=e.getAttribute("editable"))&&n.setEditable("true"===k),(k=e.getAttribute("collapsed"))&&n.setCollapsed("true"===k),"shadow"===e.nodeName.toLowerCase()){for(e=n.getChildren(!1),k=0;k<e.length;k++)if(!e[k].isShadow())throw TypeError("Shadow block not allowed non-shadow child.");n.setShadow(!0)}return n},iu=function(e,o,i){const s=e.getField(o);s?s.fromXml(i):console.warn("Ignoring non-existent field "+o+" in block "+e.type)},su=function(e){for(let o=0;o<e.childNodes.length;o++){const i=e.childNodes[o];if("next"===i.nodeName.toLowerCase()){e.removeChild(i);break}}},Al=function(e){return e.nodeType===ti.ELEMENT_NODE},Pt=function(e,o){D(w.FIELD,e,o)},nu=function(e){mt(w.FIELD,e)},t.fromJson$$module$build$src$core$field_registry=function(e){return v$.fromJsonInternal(e)},ru=function(e){const o=Rt(w.FIELD,e.type);return o?o.fromJson(e):(console.warn("Blockly could not create a field of type "+e.type+". The field is probably not being registered. This could be because the file is not loaded, the field does not register itself (Issue #1584), or the registration is not being reached."),null)},wi=function(e){return e&&"object"==typeof e&&"src"in e&&"string"==typeof e.src&&"alt"in e&&"string"==typeof e.alt&&"width"in e&&"number"==typeof e.width&&"height"in e&&"number"==typeof e.height},t.register$$module$build$src$core$extensions=function(e,o){if("string"!=typeof e||""===e.trim())throw Error('Error: Invalid extension name "'+e+'"');if(Mr[e])throw Error('Error: Extension "'+e+'" is already registered.');if("function"!=typeof o)throw Error('Error: Extension "'+e+'" must be a function');Mr[e]=o},t.registerMixin$$module$build$src$core$extensions=function(e,o){if(!o||"object"!=typeof o)throw Error('Error: Mixin "'+e+'" must be a object');t.register$$module$build$src$core$extensions(e,function(){this.mixin(o)})},t.registerMutator$$module$build$src$core$extensions=function(e,o,i,s){const n='Error when registering mutator "'+e+'": ';Rl(n,o);const l=Ol(o,n);if(i&&"function"!=typeof i)throw Error(n+'Extension "'+e+'" is not a function');t.register$$module$build$src$core$extensions(e,function(){l&&this.setMutator(new t.MutatorIcon$$module$build$src$core$icons$mutator_icon(s||[],this)),this.mixin(o),i&&i.apply(this)})},lu=function(e){Sl(e)?delete Mr[e]:console.warn('No extension mapping for name "'+e+'" found to unregister')},Sl=function(e){return!!Mr[e]},zn=function(e,o,i){const s=Mr[e];if("function"!=typeof s)throw Error('Error: Extension "'+e+'" not found.');let n;if(i?cu(e,o):n=Yn(o),s.apply(o),i)Rl('Error after applying mutator "'+e+'": ',o);else if(!du(n,o))throw Error('Error when applying extension "'+e+'": mutation properties changed when applying a non-mutator extension.')},cu=function(e,o){if(Yn(o).length)throw Error('Error: tried to apply mutation "'+e+'" to a block that already has mutator functions.  Block id: '+o.id)},au=function(e,o){return jn(e.mutationToDom,e.domToMutation,o+" mutationToDom/domToMutation")},uu=function(e,o){return jn(e.saveExtraState,e.loadExtraState,o+" saveExtraState/loadExtraState")},Ol=function(e,o){return jn(e.compose,e.decompose,o+" compose/decompose")},jn=function(e,o,i){if(e&&o){if("function"!=typeof e||"function"!=typeof o)throw Error(i+" must be a function");return!0}if(!e&&!o)return!1;throw Error(i+"Must have both or neither functions")},Rl=function(e,o){const i=au(o,e),s=uu(o,e);if(!i&&!s)throw Error(e+"Mutations must contain either XML hooks, or JSON hooks, or both");Ol(o,e)},Yn=function(e){const o=[];return void 0!==e.domToMutation&&o.push(e.domToMutation),void 0!==e.mutationToDom&&o.push(e.mutationToDom),void 0!==e.saveExtraState&&o.push(e.saveExtraState),void 0!==e.loadExtraState&&o.push(e.loadExtraState),void 0!==e.compose&&o.push(e.compose),void 0!==e.decompose&&o.push(e.decompose),o},du=function(e,o){if((o=Yn(o)).length!==e.length)return!1;for(let i=0;i<o.length;i++)if(e[i]!==o[i])return!1;return!0},Vh=function(e){if("object"!=typeof document)throw Error("runAfterPageLoad() requires browser document.");if("complete"===document.readyState)e();else{const o=setInterval(function(){"complete"===document.readyState&&(clearInterval(o),e())},10)}},t.buildTooltipForDropdown$$module$build$src$core$extensions=function(e,o){const i=[];return function(){i.includes(this.type)||(hu(this,e,o),i.push(this.type)),this.setTooltip(function(){const s=String(this.getFieldValue(e));return Ae(o[s])}.bind(this))}},hu=function(e,o,i){var s=e.getField(o);if(s instanceof ot&&!s.isOptionListDynamic()){s=s.getOptions();for(const n of s)n!==ot.SEPARATOR&&([,s]=n,void 0===i[s]&&console.warn(`No tooltip mapping for value ${s} of field ${o} of block type ${e.type}.`))}},t.buildTooltipWithFieldText$$module$build$src$core$extensions=function(e,o){return function(){this.setTooltip(function(){const i=this.getField(o);return Ae(e).replace("%1",i?i.getText():"")}.bind(this))}},pu=function(){const e=this.tooltip;this.setTooltip(function(){const o=this.getParent();return o&&o.getInputsInline()&&o.tooltip||e}.bind(this))},P=function(e,o){return" "+e+","+o+" "},at=function(e,o){return" "+e+o.join("")},He=function(e,o){return" M "+e+","+o+" "},u=function(e,o){return" m "+e+","+o+" "},T=function(e,o){return" l "+e+","+o+" "},r=function(e){return" l"+e.join("")},c=function(e,o){return" "+e+" "+o+" "},a=function(e,o,i,s){return e+" "+i+" "+i+" "+o+s},g=function(e,o){if(!e||!o)throw Error("Cannot connect null connections.");e.targetConnection=o,o.targetConnection=e},f=function(e,o){let i=null;o=o.outputConnection;const s=o?.getConnectionChecker();for(let l,n=0;l=e.inputList[n];n++){const h=l.connection;let $;if(h&&null!=($=s)&&$.canConnect(o,h,!1)){if(i)return null;i=h}}return i},S=function(e,o){let i;for(;i=f(e,o);)if(!(e=i.targetBlock())||e.isShadow())return i;return null},Z=function(e){return Vo(e)&&"function"==typeof e.getType&&"function"==typeof e.initView&&"function"==typeof e.dispose&&"function"==typeof e.getWeight&&"function"==typeof e.getSize&&"function"==typeof e.applyColour&&"function"==typeof e.hideForInsertionMarker&&"function"==typeof e.updateEditable&&"function"==typeof e.updateCollapsed&&"function"==typeof e.isShownWhenCollapsed&&"function"==typeof e.setOffsetInBlock&&"function"==typeof e.onLocationChange&&"function"==typeof e.onClick},he=function(e){return Z(e)&&jo(e)&&fs(e)&&"function"==typeof e.setText&&"function"==typeof e.getText&&"function"==typeof e.setBubbleSize&&"function"==typeof e.getBubbleSize&&"function"==typeof e.setBubbleLocation&&"function"==typeof e.getBubbleLocation&&e.getType()===Ue.COMMENT},ae=function(e){if(!(e.getDescendants(!1).length>100)){var o=e.workspace,i=e.getSvgRoot();o.getAudioManager().play("delete");var l,s=e.getRelativeToSurfaceXY(),n=i.cloneNode(!0);n.setAttribute("transform","translate("+s.x+","+s.y+")"),null==(l=o.getLayerManager())||l.appendToAnimationLayer({getSvgRoot:()=>n}),ve(n,{x:s.x,y:s.y,width:e.width,height:e.height},o.RTL,new Date)}},ve=function(e,o,i,s){const n=((new Date).getTime()-s.getTime())/150;n>1?ce(e):(e.setAttribute("transform","translate("+(o.x+(i?-1:1)*o.width/2*n)+","+(o.y+o.height/2*n)+") scale("+(1-n)+")"),setTimeout(ve,10,e,o,i,s))},H=function(e){var o=e.workspace;const i=o.scale;if(o.getAudioManager().play("click"),!(i<1)){var s=o.getSvgXY(e.getSvgRoot());e.outputConnection?(s.x+=(e.RTL?3:-3)*i,s.y+=13*i):e.previousConnection&&(s.x+=(e.RTL?-23:23)*i,s.y+=3*i);var n=I(v.CIRCLE,{cx:s.x,cy:s.y,r:0,fill:"none",stroke:"#888","stroke-width":10},o.getParentSvg());e=I(v.ANIMATE,{id:"animationCircle",begin:"indefinite",attributeName:"r",dur:"150ms",from:0,to:25*i},n),o=I(v.ANIMATE,{id:"animationOpacity",begin:"indefinite",attributeName:"opacity",dur:"150ms",from:1,to:0},n),e.beginElement(),o.beginElement(),setTimeout(()=>{ce(n)},150)}},Et=function(e){if(q(),e.workspace.getAudioManager().play("disconnect"),!(e.workspace.scale<1)){var o=e.getHeightWidth().height;o=Math.atan(10/o)/Math.PI*180,e.RTL||(o*=-1),yc=e,X(e,o,new Date,0)}},X=function(e,o,i,s){const n=[.66,1,.66,0,-.66,-1,-.66,0];let l="";i.getTime()+200>(new Date).getTime()&&(l=`skewX(${Math.round(n[s%n.length]*o)})`,Qu=setTimeout(X,15,e,o,i,s+1)),e.getSvgRoot().setAttribute("transform",`${e.getTranslation()} ${l}`)},q=function(){yc&&(Qu&&(clearTimeout(Qu),Qu=null),yc.getSvgRoot().setAttribute("transform",yc.getTranslation()),yc=null)},W=function(e,o){const i=e.workspace,s=t.config$$module$build$src$core$config.snapRadius,n=A.difference(o,e.getRelativeToSurfaceXY()),l=new A(0,0),h=i.getAllBlocks(!1).filter($=>$.id!=e.id).map($=>$.getRelativeToSurfaceXY());for(;re(A.sum(o,l),h)||Y(e,A.sum(n,l),s);)l.translate(i.RTL?-s:s,2*s);e.moveTo(A.sum(o,l))},re=function(e,o){return o.some(i=>Math.abs(i.x-e.x)<=1&&Math.abs(i.y-e.y)<=1)},Y=function(e,o,i){return e.getConnections_(!1).some(s=>!!s.closest(i,o).connection)},z=function(e,o,i){const s=i.getBoundingRectangle(),n=s.right-s.left,l=ys(o.top,s.top,o.top+o.height-(s.bottom-s.top))-s.top;let h=o.left;return o=o.left+o.width-n,e.RTL?h=Math.min(o,h):o=Math.max(h,o),!(!(e=ys(h,s.left,o)-s.left)&&!l||(i.moveBy(e,l,["inbounds"]),0))},oe=function(e){return o=>{var s,i=e.getMetricsManager();if(i.hasFixedEdges()&&!e.isDragging())if(tp.includes(null!=(s=o.type)?s:"")){s=i.getScrollMetrics(!0);const n=ie(e,o);n&&(i=t.getGroup$$module$build$src$core$events$utils()||!1,t.setGroup$$module$build$src$core$events$utils(o.group),z(e,s,n)&&!o.group&&console.warn("Moved object in bounds but there was no event group. This may break undo."),t.setGroup$$module$build$src$core$events$utils(i))}else Zo(o)&&o.scale&&o.oldScale&&o.scale>o.oldScale&&pe(e)}},ie=function(e,o){let i=null;switch(o.type){case E.BLOCK_CREATE:case E.BLOCK_MOVE:(i=e.getBlockById(o.blockId))&&(i=i.getRootBlock());break;case E.COMMENT_CREATE:case E.COMMENT_MOVE:case E.COMMENT_RESIZE:i=e.getCommentById(o.commentId)}return i},pe=function(e){var o=e.getMetricsManager();if(o.hasFixedEdges()&&!e.isDragging()){o=o.getScrollMetrics(!0);var i=e.getTopBoundedElements();for(let n,s=0;n=i[s];s++)z(e,o,n)}},le=function(e){return e&&"function"==typeof e.isDeletable&&"function"==typeof e.dispose&&"function"==typeof e.setDeleteStyle},Be=function(e,o){const i=e.getIcons();for(const s of e.inputList){if(!s.isVisible())continue;let n;if(i.push(...s.fieldRow),null!=(n=s.connection)&&n.targetBlock())if(e=s.connection.targetBlock(),s.connection.type!==N.NEXT_STATEMENT||o)i.push(e);else{let l;(e=null==(l=e.lastConnectionInStack(!1))?void 0:l.getSourceBlock())&&i.push(e)}else{let l;(null==(l=s.connection)?void 0:l.type)===N.INPUT_VALUE&&i.push(s.connection)}}return i},Pe=function(e,o){const i=e.workspace.getTopBoundedElements(!0).filter(n=>Vo(n));let s=null;if((e=i.indexOf(e instanceof $e?e.getRootBlock():e)+o)>=0&&e<i.length?s=i[e]:e<0?s=i[i.length-1]:e>=i.length&&(s=i[0]),o<0&&s instanceof $e){let n,l;return null!=(l=null==(n=s.lastConnectionInStack(!1))?void 0:n.getSourceBlock())?l:s}return s},Se=function(e,o){var i;let s;const n=e instanceof $e?null!=(s=null==(i=e.outputConnection)?void 0:i.targetBlock())?s:e.getSurroundParent():e.getSourceBlock();return n instanceof $e&&-1!==(e=(i=Be(n,o>0)).indexOf(e))&&(o=e+o)>=0&&o<i.length?i[o]:null},ut=function(e){return e&&"function"==typeof e.getRelativeToSurfaceXY&&"function"==typeof e.isMovable&&"function"==typeof e.startDrag&&"function"==typeof e.drag&&"function"==typeof e.endDrag&&"function"==typeof e.revertDrag},kt=function(e){return e&&"function"==typeof e.autoHide},Xn=function(e,o){D(w.ICON,e.toString(),o)},Ml=function(e){mt(w.ICON,e)},Ft=function(e){return"function"==typeof e.getProcedureModel&&"function"==typeof e.doProcedureUpdate&&"function"==typeof e.isProcedureDef},Ut=function(e){return e&&"function"==typeof e.startPublishing&&"function"==typeof e.stopPublishing},Ai=function(e){const o=e.getProcedureMap().getProcedures().filter(s=>!s.getReturnTypes()).map(s=>[s.getName(),s.getParameters().map(n=>n.getName()),!1]);e.getBlocksByType("procedures_defnoreturn",!1).forEach(s=>{!Ft(s)&&vi(s)&&o.push(s.getProcedureDef())});const i=e.getProcedureMap().getProcedures().filter(s=>!!s.getReturnTypes()).map(s=>[s.getName(),s.getParameters().map(n=>n.getName()),!0]);return e.getBlocksByType("procedures_defreturn",!1).forEach(s=>{!Ft(s)&&vi(s)&&i.push(s.getProcedureDef())}),o.sort(Ns),i.sort(Ns),[o,i]},Ns=function(e,o){return e[0].localeCompare(o[0],void 0,{sensitivity:"base"})},t.findLegalName$$module$build$src$core$procedures=function(e,o){if(o.isInFlyout)return e;for(e=e||t.Msg$$module$build$src$core$msg.UNNAMED_KEY||"unnamed";!Nl(e,o.workspace,o);){const i=e.match(/^(.*?)(\d+)$/);e=i?i[1]+(parseInt(i[2])+1):e+"2"}return e},Nl=function(e,o,i){return!Kn(e,o,i)},Kn=function(e,o,i){for(const s of o.getAllBlocks(!1))if(s!==i&&vi(s)&&t.Names$$module$build$src$core$names.equals(s.getProcedureDef()[0],e))return!0;i=i&&Ft(i)?i?.getProcedureModel():void 0;for(const s of o.getProcedureMap().getProcedures())if(s!==i&&t.Names$$module$build$src$core$names.equals(s.getName(),e))return!0;return!1},t.rename$$module$build$src$core$procedures=function(e){var o=this.getSourceBlock();if(!o)throw new Me;e=e.trim();const i=t.findLegalName$$module$build$src$core$procedures(e,o);Ft(o)&&!o.isInsertionMarker()&&o.getProcedureModel().setName(i);const s=this.getValue();if(s!==e&&s!==i)for(e=o.workspace.getAllBlocks(!1),o=0;o<e.length;o++){const n=e[o];n.renameProcedure&&n.renameProcedure(s,i)}return i},gu=function(e){function o(l,h){for(let k=0;k<l.length;k++){var $=l[k][0];const F=l[k][1],we=t.createElement$$module$build$src$core$utils$xml("block");we.setAttribute("type",h),we.setAttribute("gap","16");const Te=t.createElement$$module$build$src$core$utils$xml("mutation");for(Te.setAttribute("name",$),we.appendChild(Te),$=0;$<F.length;$++){const rt=t.createElement$$module$build$src$core$utils$xml("arg");rt.setAttribute("name",F[$]),Te.appendChild(rt)}i.push(we)}}const i=[];if(ye.procedures_defnoreturn){var s=t.createElement$$module$build$src$core$utils$xml("block");s.setAttribute("type","procedures_defnoreturn"),s.setAttribute("gap","16");var n=t.createElement$$module$build$src$core$utils$xml("field");n.setAttribute("name","NAME"),n.appendChild(t.createTextNode$$module$build$src$core$utils$xml(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_PROCEDURE)),s.appendChild(n),i.push(s)}return ye.procedures_defreturn&&((s=t.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","procedures_defreturn"),s.setAttribute("gap","16"),(n=t.createElement$$module$build$src$core$utils$xml("field")).setAttribute("name","NAME"),n.appendChild(t.createTextNode$$module$build$src$core$utils$xml(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_PROCEDURE)),s.appendChild(n),i.push(s)),ye.procedures_ifreturn&&((s=t.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","procedures_ifreturn"),s.setAttribute("gap","16"),i.push(s)),i.length&&i[i.length-1].setAttribute("gap","24"),o((e=Ai(e))[0],"procedures_callnoreturn"),o(e[1],"procedures_callreturn"),i},Ds=function(e){return Jn(e,!1)},Jn=function(e,o=!0){function i(n,l){for(const[h,$]of n)s.push({kind:"block",type:l,gap:16,extraState:{name:h,params:$}})}if(o)return ze("The XML return value of Blockly.Procedures.flyoutCategory()","v12","v13","the same method, but handle a return type of FlyoutItemInfo[] (JSON) instead."),gu(e);const s=[];return ye.procedures_defnoreturn&&s.push({kind:"block",type:"procedures_defnoreturn",gap:16,fields:{NAME:t.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_PROCEDURE}}),ye.procedures_defreturn&&s.push({kind:"block",type:"procedures_defreturn",gap:16,fields:{NAME:t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_PROCEDURE}}),ye.procedures_ifreturn&&s.push({kind:"block",type:"procedures_ifreturn",gap:16}),s.length&&(s[s.length-1].gap=24),i((e=Ai(e))[0],"procedures_callnoreturn"),i(e[1],"procedures_callreturn"),s},Qn=function(e){var o=[],i=e.getBlocksByType("procedures_mutatorarg",!1);for(let h,l=0;h=i[l];l++)o.push(h.getFieldValue("NAME"));i=t.createElement$$module$build$src$core$utils$xml("xml");const s=t.createElement$$module$build$src$core$utils$xml("block");s.setAttribute("type","procedures_mutatorarg");const n=t.createElement$$module$build$src$core$utils$xml("field");n.setAttribute("name","NAME"),o=al(t.DEFAULT_ARG$$module$build$src$core$procedures,o),o=t.createTextNode$$module$build$src$core$utils$xml(o),n.appendChild(o),s.appendChild(n),i.appendChild(s),e.updateToolbox(i)},er=function(e){if(hi(e)&&"mutator"===e.bubbleType&&e.isOpen&&e.blockId){var o=(e=bo(e.workspaceId).getBlockById(e.blockId)).type;("procedures_defnoreturn"===o||"procedures_defreturn"===o)&&(e=e.getIcon(t.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE).getWorkspace(),Qn(e),e.addChangeListener(Jt))}},Jt=function(e){(_o(e)||ui(e)||zt(e)||os(e))&&(e=bo(e.workspaceId),Qn(e))},Dl=function(e,o){return o.getAllBlocks(!1).filter(i=>Ll(i,e)||ia(i)&&t.Names$$module$build$src$core$names.equals(i.getProcedureCall(),e))},Ll=function(e,o){return Ft(e)&&!e.isProcedureDef()&&e.getProcedureModel()&&t.Names$$module$build$src$core$names.equals(e.getProcedureModel().getName(),o)},t.mutateCallers$$module$build$src$core$procedures=function(e){const o=Ze();var i=e.getProcedureDef()[0];const s=e.mutationToDom(!0);e=Dl(i,e.workspace);for(let h,l=0;h=e[l];l++){i=(i=h.mutationToDom())&&Ti(i),h.domToMutation&&h.domToMutation(s);var n=h.mutationToDom();i!==(n=n&&Ti(n))&&(t.setRecordUndo$$module$build$src$core$events$utils(!1),L(new(B(E.BLOCK_CHANGE))(h,"mutation",null,i,n)),t.setRecordUndo$$module$build$src$core$events$utils(o))}},t.getDefinition$$module$build$src$core$procedures=function(e,o){for(const i of o.getAllBlocks(!1))if(Ft(i)&&i.isProcedureDef()&&t.Names$$module$build$src$core$names.equals(i.getProcedureModel().getName(),e)||vi(i)&&t.Names$$module$build$src$core$names.equals(i.getProcedureDef()[0],e))return i;return null},Si=function(e){return e.isDynamic},tr=function(e){return void 0!==e.pathDown&&void 0!==e.pathUp},or=function(e){return void 0!==e.pathLeft&&void 0!==e.pathRight},ko=function(e,o){D(w.RENDERER,e,o)},Bl=function(e){mt(w.RENDERER,e)},ir=function(e,o,i){return(e=new($t(w.RENDERER,e))(e)).init(o,i),e},Io=function(e){yi(e.getTargetWorkspace(),void 0,"String")},Oi=function(e){yi(e.getTargetWorkspace(),void 0,"Number")},Ri=function(e){yi(e.getTargetWorkspace(),void 0,"Colour")},Ls=function(e){return Bs(e,!1)},Bs=function(e,o=!0){return ye.variables_set_dynamic||ye.variables_get_dynamic||console.warn("There are no dynamic variable blocks, but there is a dynamic variable category."),o?(ze("The XML return value of Blockly.VariablesDynamic.flyoutCategory()","v12","v13","the same method, but handle a return type of FlyoutItemInfo[] (JSON) instead."),Pl(e)):(e.registerButtonCallback("CREATE_VARIABLE_STRING",Io),e.registerButtonCallback("CREATE_VARIABLE_NUMBER",Oi),e.registerButtonCallback("CREATE_VARIABLE_COLOUR",Ri),[{kind:"button",text:t.Msg$$module$build$src$core$msg.NEW_STRING_VARIABLE,callbackkey:"CREATE_VARIABLE_STRING"},{kind:"button",text:t.Msg$$module$build$src$core$msg.NEW_NUMBER_VARIABLE,callbackkey:"CREATE_VARIABLE_NUMBER"},{kind:"button",text:t.Msg$$module$build$src$core$msg.NEW_COLOUR_VARIABLE,callbackkey:"CREATE_VARIABLE_COLOUR"},...cl(e,e.getVariableMap().getAllVariables(),!1,"variables_get_dynamic","variables_set_dynamic")])},Pl=function(e){let o=[],i=document.createElement("button");return i.setAttribute("text",t.Msg$$module$build$src$core$msg.NEW_STRING_VARIABLE),i.setAttribute("callbackKey","CREATE_VARIABLE_STRING"),o.push(i),i=document.createElement("button"),i.setAttribute("text",t.Msg$$module$build$src$core$msg.NEW_NUMBER_VARIABLE),i.setAttribute("callbackKey","CREATE_VARIABLE_NUMBER"),o.push(i),i=document.createElement("button"),i.setAttribute("text",t.Msg$$module$build$src$core$msg.NEW_COLOUR_VARIABLE),i.setAttribute("callbackKey","CREATE_VARIABLE_COLOUR"),o.push(i),e.registerButtonCallback("CREATE_VARIABLE_STRING",Io),e.registerButtonCallback("CREATE_VARIABLE_NUMBER",Oi),e.registerButtonCallback("CREATE_VARIABLE_COLOUR",Ri),e=sr(e),o.concat(e)},sr=function(e){const o=[];if((e=e.getVariableMap().getAllVariables()).length>0){if(ye.variables_set_dynamic){var i=e[e.length-1];const s=t.createElement$$module$build$src$core$utils$xml("block");s.setAttribute("type","variables_set_dynamic"),s.setAttribute("gap","24"),s.appendChild(xi(i)),o.push(s)}if(ye.variables_get_dynamic){e.sort(Ts);for(let n,s=0;n=e[s];s++)(i=t.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","variables_get_dynamic"),i.setAttribute("gap","8"),i.appendChild(xi(n)),o.push(i)}}return o},Fl=function(e){e.resizeContents()},Ps=function(e,o){const i=e.toCopyData();return Bc=i,Pc=as(e)&&e.workspace instanceof nt?e.workspace:null,yd=o,i},Mi=function(){return Bc},Ul=function(e){Bc=e},Fs=function(){return Pc},Zl=function(e){Pc=e},nr=function(){return yd},Hl=function(e){yd=e},Zt=function(e,o,i){return e&&o?rr(e,o,i):Bc&&Pc?rr(Bc,Pc,yd):null},rr=function(e,o,i){let s,n,l;return o=o.isMutator?o:null!=(s=o.options.parentWorkspace)?s:o,null!=(l=null==(n=Rt(w.PASTER,e.paster,!1))?void 0:n.paste(e,o,i))?l:null},Ni=function(e){return e&&"function"==typeof e.toCopyData},Di=function(){be.registry.register({name:ri.ESCAPE,preconditionFn:e=>!e.isReadOnly(),callback:e=>(e.hideChaff(),!0),keyCodes:[me.ESC]})},lr=function(){be.registry.register({name:ri.DELETE,preconditionFn:(e,o)=>(o=o.focusedNode,!e.isReadOnly()&&null!=o&&le(o)&&o.isDeletable()&&!e.isDragging()&&!t.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()),callback:(e,o,i,s)=>(o.preventDefault(),(e=s.focusedNode)instanceof $e?e.checkAndDelete():le(e)&&e.isDeletable()&&(t.setGroup$$module$build$src$core$events$utils(!0),e.dispose(),t.setGroup$$module$build$src$core$events$utils(!1)),!0),keyCodes:[me.DELETE,me.BACKSPACE]})},Us=function(e){return!!(Ni(e)&&le(e)&&ut(e))&&(e.isCopyable?e.isCopyable():e instanceof $e||e instanceof so?e.isOwnDeletable()&&e.isOwnMovable():e.isDeletable()&&e.isMovable())},cr=function(e){return Us(e)&&le(e)&&e.isDeletable()},ar=function(){const e=be.registry.createSerializedKey(me.C,[me.CTRL]),o=be.registry.createSerializedKey(me.C,[me.META]);be.registry.register({name:ri.COPY,preconditionFn:(i,s)=>(i=i.isFlyout?i.targetWorkspace:i,!!(s=s.focusedNode)&&!!i&&!i.isDragging()&&!t.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()&&Us(s)),callback:(i,s,n,l)=>(s.preventDefault(),!!((s=l.focusedNode)&&Ni(s)&&Us(s)&&(i=i.isFlyout?i.targetWorkspace:i,i))&&(s.workspace.isFlyout||i.hideChaff(),i=ut(s)&&s.workspace==i?s.getRelativeToSurfaceXY():void 0,!!Ps(s,i))),keyCodes:[e,o]})},ur=function(){const e=be.registry.createSerializedKey(me.X,[me.CTRL]),o=be.registry.createSerializedKey(me.X,[me.META]);be.registry.register({name:ri.CUT,preconditionFn:(i,s)=>!!(s=s.focusedNode)&&!i.isReadOnly()&&!i.isDragging()&&!t.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()&&cr(s),callback:(i,s,n,l)=>!!((i=l.focusedNode)&&cr(i)&&Ni(i))&&(s=ut(i)?i.getRelativeToSurfaceXY():void 0,s=Ps(i,s),i instanceof $e?i.checkAndDelete():le(i)&&i.dispose(),!!s),keyCodes:[e,o]})},dr=function(){const e=be.registry.createSerializedKey(me.V,[me.CTRL]),o=be.registry.createSerializedKey(me.V,[me.META]);be.registry.register({name:ri.PASTE,preconditionFn(){var i=Fs();return!(!i||!i.rendered||(i=i.isFlyout?i.targetWorkspace:i,!Mi()||!i||i.isReadOnly()||i.isDragging()||t.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()))},callback(i,s){if(!(i=Mi()))return!1;var n=Fs();if(!n||!(n=n.isFlyout?n.targetWorkspace:n)||n.isReadOnly())return!1;if(s instanceof PointerEvent)return s=Qr(n,new A(s.clientX,s.clientY)),!!Zt(i,n,s);if(!(s=nr()))return!!Zt(i,n);const{left:l,top:h,width:$,height:k}=n.getMetricsManager().getViewMetrics(!0);return new Q(h,h+k,l,l+$).contains(s.x,s.y)?!!Zt(i,n):(s=new A(l+$/2,h+k/2),!!Zt(i,n,s))},keyCodes:[e,o]})},hr=function(){const e=be.registry.createSerializedKey(me.Z,[me.CTRL]),o=be.registry.createSerializedKey(me.Z,[me.META]);be.registry.register({name:ri.UNDO,preconditionFn:i=>!i.isReadOnly()&&!i.isDragging()&&!t.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken(),callback:(i,s)=>(i.hideChaff(),i.undo(!1),s.preventDefault(),!0),keyCodes:[e,o]})},Zs=function(){const e=be.registry.createSerializedKey(me.Z,[me.CTRL,me.SHIFT]),o=be.registry.createSerializedKey(me.Z,[me.META,me.SHIFT]),i=be.registry.createSerializedKey(me.Y,[me.CTRL]);be.registry.register({name:ri.REDO,preconditionFn:s=>!s.isDragging()&&!s.isReadOnly()&&!t.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken(),callback:(s,n)=>(s.hideChaff(),s.undo(!0),n.preventDefault(),!0),keyCodes:[e,o,i]})},Gl=function(){Di(),lr(),ar(),ur(),dr(),hr(),Zs()},pr=function(e){const o=e.saveState();return e.getParameters().length&&(o.parameters=e.getParameters().map(i=>i.saveState())),o},gr=function(e,o,i,s){if(e=e.loadState(i,s),!i.parameters)return e;for(const[n,l]of i.parameters.entries())e.insertParameter(o.loadState(l,s),n);return e},wo=function(e){const o=Object.create(null),i=go(w.SERIALIZER,!0);for(const s in i){let n;const l=null==(n=i[s])?void 0:n.save(e);l&&(o[s]=l)}return o},Ht=function(e,o,{recordUndo:i=!1}={}){var s=go(w.SERIALIZER,!0);if(s){s=Object.entries(s).sort((l,h)=>h[1].priority-l[1].priority);var n=Ze();t.setRecordUndo$$module$build$src$core$events$utils(i),(i=t.getGroup$$module$build$src$core$events$utils())||t.setGroup$$module$build$src$core$events$utils(!0),b(),o instanceof nt&&o.setResizesEnabled(!1);for(const[,l]of s.reverse()){let h;null==(h=l)||h.clear(o)}for(const[l,h]of s.reverse())if(e[l]){let $;null==($=h)||$.load(e[l],o)}o instanceof nt&&o.setResizesEnabled(!0),y(),L(new(B(E.FINISHED_LOADING))(o)),t.setGroup$$module$build$src$core$events$utils(i),t.setRecordUndo$$module$build$src$core$events$utils(n)}},mr=function(e,o){let i=null;var s;if(i="string"==typeof e?document.getElementById(e)||document.querySelector(e):e,!document.contains(i)&&document!==(null==(s=i)?void 0:s.ownerDocument))throw Error("Error: container is not in current document");e=new no(o||{}),s=document.createElement("div"),R(s,"injectionDiv"),null!=o&&o.rtl&&R(s,"blocklyRTL"),i.appendChild(s),o=Vl(s,e);const n=Ko(s,o,e);return Qt(n),us(n),Eo(n),s.addEventListener("focusin",function(){us(n)}),U(s,"keydown",null,ps),n},Vl=function(e,o){e.setAttribute("dir","LTR"),qr(o.hasCss,o.pathToMedia);const i=I(v.SVG,{xmlns:Ql,"xmlns:html":Ao,"xmlns:xlink":It,version:"1.1",class:"blocklySvg"},e),s=I(v.DEFS,{},i),n=String(Math.random()).substring(2);return o.gridPattern=sd.createDom(n,o.gridOptions,s,e),i},Ko=function(e,o,i){i.parentWorkspace=null;const s=(i=new nt(i)).options;i.scale=s.zoomOptions.startScale,o.appendChild(i.createDom("blocklyMainBackground",e));var n=i.getRenderer().getClassName();return n&&R(e,n),(n=i.getTheme().getClassName())&&R(e,n),!s.hasCategories&&s.languageTree&&(e=i.addFlyout(v.SVG),d(e,o)),s.hasTrashcan&&i.addTrashcan(),s.zoomOptions&&s.zoomOptions.controls&&i.addZoomControls(),i.getThemeManager().subscribe(o,"workspaceBackgroundColour","background-color"),i.translate(0,0),i.addChangeListener(oe(i)),Eo(i),Pa(),hl(),Sa(),i},Qt=function(e){const o=e.options;var i=e.getParentSvg();if(U(i.parentNode,"contextmenu",null,function(s){Fo(s)||s.preventDefault()}),i=U(window,"resize",null,function(){xo(),e.hideComponents(!0),xa(),Ha(),Eo(e),pe(e)}),e.setResizeHandlerWrapper(i),ql(),o.languageTree){i=e.getToolbox();const s=e.getFlyout(!0);i?i.init():s&&(s.init(e),s.show(o.languageTree),"function"==typeof s.scrollToStart&&s.scrollToStart())}o.hasTrashcan&&e.trashcan.init(),o.zoomOptions&&o.zoomOptions.controls&&e.zoomControls_.init(),o.moveOptions&&o.moveOptions.scrollbars?(e.scrollbar=new id(e,!0===o.moveOptions.scrollbars||!!o.moveOptions.scrollbars.horizontal,!0===o.moveOptions.scrollbars||!!o.moveOptions.scrollbars.vertical,"blocklyMainWorkspaceScrollbar"),e.scrollbar.resize()):e.setMetrics({x:.5,y:.5}),o.hasSounds&&eo(o.pathToMedia,e)},ql=function(){H$||(U(document,"scroll",null,function(){const e=fi();for(let i,o=0;i=e[o];o++)i instanceof nt&&i.updateInverseScreenCTM()}),lt(document,"touchend",null,it),lt(document,"touchcancel",null,it)),H$=!0},eo=function(e,o){function i(){for(;n.length;){const l=n.pop();l&&ne(l)}s.preload()}const s=o.getAudioManager();s.load([e+"click.mp3",e+"click.wav",e+"click.ogg"],"click"),s.load([e+"disconnect.wav",e+"disconnect.mp3",e+"disconnect.ogg"],"disconnect"),s.load([e+"delete.mp3",e+"delete.ogg",e+"delete.wav"],"delete");const n=[];n.push(U(document,"pointermove",null,i,!0)),n.push(U(document,"touchstart",null,i,!0))},$r=function(){K.registry.register({displayText:()=>t.Msg$$module$build$src$core$msg.UNDO,preconditionFn:e=>e.workspace.getUndoStack().length>0?"enabled":"disabled",callback(e){e.workspace.undo(!1)},scopeType:K.ScopeType.WORKSPACE,id:"undoWorkspace",weight:1})},_r=function(){K.registry.register({displayText:()=>t.Msg$$module$build$src$core$msg.REDO,preconditionFn:e=>e.workspace.getRedoStack().length>0?"enabled":"disabled",callback(e){e.workspace.undo(!0)},scopeType:K.ScopeType.WORKSPACE,id:"redoWorkspace",weight:2})},Hs=function(){K.registry.register({displayText:()=>t.Msg$$module$build$src$core$msg.CLEAN_UP,preconditionFn:e=>e.workspace.isMovable()?e.workspace.getTopBlocks(!1).length>1?"enabled":"disabled":"hidden",callback(e){e.workspace.cleanUp()},scopeType:K.ScopeType.WORKSPACE,id:"cleanWorkspace",weight:3})},br=function(e,o){function i(l){n--,l.setCollapsed(e),0===n&&t.setGroup$$module$build$src$core$events$utils(!1)}let s=0,n=0;t.setGroup$$module$build$src$core$events$utils(!0);for(let l=0;l<o.length;l++){let h=o[l];for(;h;)n++,setTimeout(i.bind(null,h),s),h=h.getNextBlock(),s+=10}},Wl=function(){K.registry.register({displayText:()=>t.Msg$$module$build$src$core$msg.COLLAPSE_ALL,preconditionFn(e){if(e.workspace.options.collapse){e=e.workspace.getTopBlocks(!1);for(let o=0;o<e.length;o++){let i=e[o];for(;i;){if(!i.isCollapsed())return"enabled";i=i.getNextBlock()}}return"disabled"}return"hidden"},callback(e){br(!0,e.workspace.getTopBlocks(!0))},scopeType:K.ScopeType.WORKSPACE,id:"collapseWorkspace",weight:4})},Gs=function(){K.registry.register({displayText:()=>t.Msg$$module$build$src$core$msg.EXPAND_ALL,preconditionFn(e){if(e.workspace.options.collapse){e=e.workspace.getTopBlocks(!1);for(let o=0;o<e.length;o++){let i=e[o];for(;i;){if(i.isCollapsed())return"enabled";i=i.getNextBlock()}}return"disabled"}return"hidden"},callback(e){br(!1,e.workspace.getTopBlocks(!0))},scopeType:K.ScopeType.WORKSPACE,id:"expandWorkspace",weight:5})},zl=function(e,o){if(e.isDeletable())Array.prototype.push.apply(o,e.getDescendants(!1));else{e=e.getChildren(!1);for(let i=0;i<e.length;i++)zl(e[i],o)}},Vs=function(e){const o=[];e=e.getTopBlocks(!0);for(let i=0;i<e.length;i++)zl(e[i],o);return o},Li=function(e,o){o?t.setGroup$$module$build$src$core$events$utils(o):(t.setGroup$$module$build$src$core$events$utils(!0),o=t.getGroup$$module$build$src$core$events$utils());const i=e.shift();i&&(i.isDeadOrDying()?Li(e,o):(i.dispose(!1,!0),setTimeout(Li,10,e,o))),t.setGroup$$module$build$src$core$events$utils(!1)},jl=function(){K.registry.register({displayText:e=>e.workspace?1===(e=Vs(e.workspace).length)?t.Msg$$module$build$src$core$msg.DELETE_BLOCK:t.Msg$$module$build$src$core$msg.DELETE_X_BLOCKS.replace("%1",`${e}`):"",preconditionFn:e=>e.workspace&&Vs(e.workspace).length>0?"enabled":"disabled",callback(e){if(e.workspace){e.workspace.cancelCurrentGesture();var o=Vs(e.workspace);o.length<2?Li(o):il(t.Msg$$module$build$src$core$msg.DELETE_ALL_BLOCKS.replace("%1",String(o.length)),function(i){i&&Li(o)})}},scopeType:K.ScopeType.WORKSPACE,id:"workspaceDelete",weight:6})},Yl=function(){$r(),_r(),Hs(),Wl(),Gs(),jl()},fr=function(){K.registry.register({displayText:()=>t.Msg$$module$build$src$core$msg.DUPLICATE_BLOCK,preconditionFn:e=>!(e=e.block).isInFlyout&&e.isDeletable()&&e.isMovable()?e.isDuplicatable()?"enabled":"disabled":"hidden",callback(e){if(e.block){var o=e.block.toCopyData();o&&Zt(o,e.block.workspace)}},scopeType:K.ScopeType.BLOCK,id:"blockDuplicate",weight:1})},Xl=function(){K.registry.register({displayText:e=>e.block.hasIcon(Ro.TYPE)?t.Msg$$module$build$src$core$msg.REMOVE_COMMENT:t.Msg$$module$build$src$core$msg.ADD_COMMENT,preconditionFn:e=>!(e=e.block).isInFlyout&&e.workspace.options.comments&&!e.isCollapsed()&&e.isEditable()?"enabled":"hidden",callback(e){(e=e.block).hasIcon(Ro.TYPE)?e.setCommentText(null):e.setCommentText("")},scopeType:K.ScopeType.BLOCK,id:"blockComment",weight:2})},Tr=function(){K.registry.register({displayText:e=>e.block.getInputsInline()?t.Msg$$module$build$src$core$msg.EXTERNAL_INPUTS:t.Msg$$module$build$src$core$msg.INLINE_INPUTS,preconditionFn(e){if(!(e=e.block).isInFlyout&&e.isMovable()&&!e.isCollapsed())for(let o=1;o<e.inputList.length;o++)if(!(e.inputList[o-1]instanceof Fc||e.inputList[o]instanceof Fc))return"enabled";return"hidden"},callback(e){e.block.setInputsInline(!e.block.getInputsInline())},scopeType:K.ScopeType.BLOCK,id:"blockInline",weight:3})},Er=function(){K.registry.register({displayText:e=>e.block.isCollapsed()?t.Msg$$module$build$src$core$msg.EXPAND_BLOCK:t.Msg$$module$build$src$core$msg.COLLAPSE_BLOCK,preconditionFn:e=>!(e=e.block).isInFlyout&&e.isMovable()&&e.workspace.options.collapse?"enabled":"hidden",callback(e){e.block.setCollapsed(!e.block.isCollapsed())},scopeType:K.ScopeType.BLOCK,id:"blockCollapseExpand",weight:4})},Kl=function(){K.registry.register({displayText:e=>e.block.hasDisabledReason(Gt)?t.Msg$$module$build$src$core$msg.ENABLE_BLOCK:t.Msg$$module$build$src$core$msg.DISABLE_BLOCK,preconditionFn(e){if(!(e=e.block).isInFlyout&&e.workspace.options.disable&&e.isEditable()){var o=e.getDisabledReasons();return o=o.size>(o.has(Gt)?1:0),e.getInheritedDisabled()||o?"disabled":"enabled"}return"hidden"},callback(e){e=e.block;const o=t.getGroup$$module$build$src$core$events$utils();o||t.setGroup$$module$build$src$core$events$utils(!0),e.setDisabledReason(!e.hasDisabledReason(Gt),Gt),t.setGroup$$module$build$src$core$events$utils(o)},scopeType:K.ScopeType.BLOCK,id:"blockDisable",weight:5})},G=function(){K.registry.register({displayText(e){var o=e.block;return e=o.getDescendants(!1).length,(o=o.getNextBlock())&&(e-=o.getDescendants(!1).length),1===e?t.Msg$$module$build$src$core$msg.DELETE_BLOCK:t.Msg$$module$build$src$core$msg.DELETE_X_BLOCKS.replace("%1",`${e}`)},preconditionFn:e=>!e.block.isInFlyout&&e.block.isDeletable()?"enabled":"hidden",callback(e){e.block&&e.block.checkAndDelete()},scopeType:K.ScopeType.BLOCK,id:"blockDelete",weight:6})},J=function(){K.registry.register({displayText:()=>t.Msg$$module$build$src$core$msg.HELP,preconditionFn:e=>("function"==typeof(e=e.block).helpUrl?e.helpUrl():e.helpUrl)?"enabled":"hidden",callback(e){e.block.showHelp()},scopeType:K.ScopeType.BLOCK,id:"blockHelp",weight:7})},Qe=function(){K.registry.register({displayText:()=>t.Msg$$module$build$src$core$msg.REMOVE_COMMENT,preconditionFn(e){let o;return null!=(o=e.comment)&&o.isDeletable()?"enabled":"hidden"},callback(e){let o;t.setGroup$$module$build$src$core$events$utils(!0),null==(o=e.comment)||o.dispose(),t.setGroup$$module$build$src$core$events$utils(!1)},scopeType:K.ScopeType.COMMENT,id:"commentDelete",weight:6})},qh=function(){K.registry.register({displayText:()=>t.Msg$$module$build$src$core$msg.DUPLICATE_COMMENT,preconditionFn(e){let o;return null!=(o=e.comment)&&o.isMovable()?"enabled":"hidden"},callback(e){if(e.comment){var o=e.comment.toCopyData();o&&Zt(o,e.comment.workspace)}},scopeType:K.ScopeType.COMMENT,id:"commentDuplicate",weight:1})},Wh=function(){K.registry.register({displayText:()=>t.Msg$$module$build$src$core$msg.ADD_COMMENT,preconditionFn:e=>{let o;return null!=(o=e.workspace)&&o.isMutator?"hidden":"enabled"},callback:(e,o,i,s)=>{(e=e.workspace)&&(t.setGroup$$module$build$src$core$events$utils(!0),(o=new so(e)).setPlaceholderText(t.Msg$$module$build$src$core$msg.WORKSPACE_COMMENT_DEFAULT_TEXT),o.moveTo(tm(new A(s.x,s.y),e)),t.getFocusManager$$module$build$src$core$focus_manager().focusNode(o),t.setGroup$$module$build$src$core$events$utils(!1))},scopeType:K.ScopeType.WORKSPACE,id:"commentCreate",weight:8})},tm=function(e,o){var i=o.getInjectionDiv().getBoundingClientRect();return e=new A(e.x-i.left,e.y-i.top),i=o.getOriginOffsetInPixels(),(e=A.difference(e,i)).scale(1/o.scale),e},om=function(){fr(),Xl(),Tr(),Er(),Kl(),G(),J()},im=function(){qh(),Qe(),Wh()},zh=function(){Yl(),om()},jh=function(e){return e&&"function"==typeof e.paste},Yh=function(e){return e&&"function"==typeof e.getSvgRoot},Xh=function(e){return e.isSelectable()},sm=function(e){bt().hideChaff(e)},(C=C||{}).scope={},C.ASSUME_ES5=!1,C.ASSUME_ES6=!1,C.ASSUME_ES2020=!1,C.ASSUME_NO_NATIVE_MAP=!1,C.ASSUME_NO_NATIVE_SET=!1,C.ISOLATE_POLYFILLS=!1,C.FORCE_POLYFILL_PROMISE=!1,C.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1,C.INSTRUMENT_ASYNC_CONTEXT=!0,C.objectCreate=C.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(e){var o=function(){};return o.prototype=e,new o},C.defineProperty=C.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(e,o,i){return e==Array.prototype||e==Object.prototype||(e[o]=i.value),e},C.getGlobal=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var o=0;o<e.length;++o){var i=e[o];if(i&&i.Math==Math)return i}throw Error("Cannot find global object")},C.global=C.ASSUME_ES2020?globalThis:C.getGlobal(this),C.IS_SYMBOL_NATIVE="function"==typeof Symbol&&"symbol"==typeof Symbol("x"),C.TRUST_ES6_POLYFILLS=!C.ISOLATE_POLYFILLS||C.IS_SYMBOL_NATIVE,C.polyfills={},C.propertyToPolyfillSymbol={},C.POLYFILL_PREFIX="$jscp$",C.polyfill=function(e,o,i,s){o&&(C.ISOLATE_POLYFILLS?C.polyfillIsolated(e,o,i,s):C.polyfillUnisolated(e,o,i,s))},C.polyfillUnisolated=function(e,o,i,s){for(i=C.global,e=e.split("."),s=0;s<e.length-1;s++){var n=e[s];if(!(n in i))return;i=i[n]}(o=o(s=i[e=e[e.length-1]]))!=s&&null!=o&&C.defineProperty(i,e,{configurable:!0,writable:!0,value:o})},C.polyfillIsolated=function(e,o,i,s){var n=e.split(".");s=n[0],s=!(e=1===n.length)&&s in C.polyfills?C.polyfills:C.global;for(var l=0;l<n.length-1;l++){var h=n[l];if(!(h in s))return;s=s[h]}n=n[n.length-1],null!=(o=o(i=C.IS_SYMBOL_NATIVE&&"es6"===i?s[n]:null))&&(e?C.defineProperty(C.polyfills,n,{configurable:!0,writable:!0,value:o}):o!==i&&(void 0===C.propertyToPolyfillSymbol[n]&&(i=1e9*Math.random()>>>0,C.propertyToPolyfillSymbol[n]=C.IS_SYMBOL_NATIVE?C.global.Symbol(n):C.POLYFILL_PREFIX+i+"$"+n),C.defineProperty(s,C.propertyToPolyfillSymbol[n],{configurable:!0,writable:!0,value:o})))},C.getConstructImplementation=function(){if(C.TRUST_ES6_POLYFILLS&&typeof Reflect<"u"&&Reflect.construct){if(function e(){function i(){}return new i,Reflect.construct(i,[],function(){}),new i instanceof i}())return Reflect.construct;var o=Reflect.construct;return function(i,s,n){return i=o(i,s),n&&Reflect.setPrototypeOf(i,n.prototype),i}}return function(i,s,n){return void 0===n&&(n=i),n=C.objectCreate(n.prototype||Object.prototype),Function.prototype.apply.call(i,n,s)||n}},C.construct=C.getConstructImplementation(),C.underscoreProtoCanBeSet=function(){var o={};try{return o.__proto__={a:!0},o.a}catch{}return!1},C.setPrototypeOf=C.ASSUME_ES6||C.TRUST_ES6_POLYFILLS&&"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:C.underscoreProtoCanBeSet()?function(e,o){if(e.__proto__=o,e.__proto__!==o)throw new TypeError(e+" is not extensible");return e}:null,C.inherits=function(e,o){if(e.prototype=C.objectCreate(o.prototype),e.prototype.constructor=e,C.ASSUME_ES6||C.setPrototypeOf){var i=C.setPrototypeOf;i(e,o)}else for(i in o)if("prototype"!=i)if(Object.defineProperties){var s=Object.getOwnPropertyDescriptor(o,i);s&&Object.defineProperty(e,i,s)}else e[i]=o[i];e.superClass_=o.prototype},C.arrayIteratorImpl=function(e){var o=0;return function(){return o<e.length?{done:!1,value:e[o++]}:{done:!0}}},C.arrayIterator=function(e){return{next:C.arrayIteratorImpl(e)}},C.makeIterator=function(e){var o=typeof Symbol<"u"&&Symbol.iterator&&e[Symbol.iterator];if(o)return o.call(e);if("number"==typeof e.length)return C.arrayIterator(e);throw Error(String(e)+" is not an iterable or ArrayLike")},C.arrayFromIterator=function(e){for(var o,i=[];!(o=e.next()).done;)i.push(o.value);return i},C.arrayFromIterable=function(e){return e instanceof Array?e:C.arrayFromIterator(C.makeIterator(e))},C.generator={},C.generator.ensureIteratorResultIsObject_=function(e){if(!(e instanceof Object))throw new TypeError("Iterator result "+e+" is not an object")},C.generator.Context=function(){this.isRunning_=!1,this.yieldAllIterator_=null,this.yieldResult=void 0,this.nextAddress=1,this.finallyAddress_=this.catchAddress_=0,this.finallyContexts_=this.abruptCompletion_=null},C.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0},C.generator.Context.prototype.stop_=function(){this.isRunning_=!1},C.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_},C.generator.Context.prototype.next_=function(e){this.yieldResult=e},C.generator.Context.prototype.throw_=function(e){this.abruptCompletion_={exception:e,isException:!0},this.jumpToErrorHandler_()},C.generator.Context.prototype.return=function(e){this.abruptCompletion_={return:e},this.nextAddress=this.finallyAddress_},C.generator.Context.prototype.jumpThroughFinallyBlocks=function(e){this.abruptCompletion_={jumpTo:e},this.nextAddress=this.finallyAddress_},C.generator.Context.prototype.yield=function(e,o){return this.nextAddress=o,{value:e}},C.generator.Context.prototype.yieldAll=function(e,o){var i=(e=C.makeIterator(e)).next();if(C.generator.ensureIteratorResultIsObject_(i),!i.done)return this.yieldAllIterator_=e,this.yield(i.value,o);this.yieldResult=i.value,this.nextAddress=o},C.generator.Context.prototype.jumpTo=function(e){this.nextAddress=e},C.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0},C.generator.Context.prototype.setCatchFinallyBlocks=function(e,o){this.catchAddress_=e,null!=o&&(this.finallyAddress_=o)},C.generator.Context.prototype.setFinallyBlock=function(e){this.catchAddress_=0,this.finallyAddress_=e||0},C.generator.Context.prototype.leaveTryBlock=function(e,o){this.nextAddress=e,this.catchAddress_=o||0},C.generator.Context.prototype.enterCatchBlock=function(e){return this.catchAddress_=e||0,e=this.abruptCompletion_.exception,this.abruptCompletion_=null,e},C.generator.Context.prototype.enterFinallyBlock=function(e,o,i){i?this.finallyContexts_[i]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_],this.catchAddress_=e||0,this.finallyAddress_=o||0},C.generator.Context.prototype.leaveFinallyBlock=function(e,o){if(o=this.finallyContexts_.splice(o||0)[0],o=this.abruptCompletion_=this.abruptCompletion_||o){if(o.isException)return this.jumpToErrorHandler_();null!=o.jumpTo&&this.finallyAddress_<o.jumpTo?(this.nextAddress=o.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=e},C.generator.Context.prototype.forIn=function(e){return new C.generator.Context.PropertyIterator(e)},C.generator.Context.PropertyIterator=function(e){for(var o in this.object_=e,this.properties_=[],e)this.properties_.push(o);this.properties_.reverse()},C.generator.Context.PropertyIterator.prototype.getNext=function(){for(;this.properties_.length>0;){var e=this.properties_.pop();if(e in this.object_)return e}return null},C.generator.Engine_=function(e){this.context_=new C.generator.Context,this.program_=e},C.generator.Engine_.prototype.next_=function(e){return this.context_.start_(),this.context_.yieldAllIterator_?this.yieldAllStep_(this.context_.yieldAllIterator_.next,e,this.context_.next_):(this.context_.next_(e),this.nextStep_())},C.generator.Engine_.prototype.return_=function(e){this.context_.start_();var o=this.context_.yieldAllIterator_;return o?this.yieldAllStep_("return"in o?o.return:function(i){return{value:i,done:!0}},e,this.context_.return):(this.context_.return(e),this.nextStep_())},C.generator.Engine_.prototype.throw_=function(e){return this.context_.start_(),this.context_.yieldAllIterator_?this.yieldAllStep_(this.context_.yieldAllIterator_.throw,e,this.context_.next_):(this.context_.throw_(e),this.nextStep_())},C.generator.Engine_.prototype.yieldAllStep_=function(e,o,i){try{var s=e.call(this.context_.yieldAllIterator_,o);if(C.generator.ensureIteratorResultIsObject_(s),!s.done)return this.context_.stop_(),s;var n=s.value}catch(l){return this.context_.yieldAllIterator_=null,this.context_.throw_(l),this.nextStep_()}return this.context_.yieldAllIterator_=null,i.call(this.context_,n),this.nextStep_()},C.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var e=this.program_(this.context_);if(e)return this.context_.stop_(),{value:e.value,done:!1}}catch(o){this.context_.yieldResult=void 0,this.context_.throw_(o)}if(this.context_.stop_(),this.context_.abruptCompletion_){if(e=this.context_.abruptCompletion_,this.context_.abruptCompletion_=null,e.isException)throw e.exception;return{value:e.return,done:!0}}return{value:void 0,done:!0}},C.generator.Generator_=function(e){this.next=function(o){return e.next_(o)},this.throw=function(o){return e.throw_(o)},this.return=function(o){return e.return_(o)},this[Symbol.iterator]=function(){return this}},C.generator.createGenerator=function(e,o){return o=new C.generator.Generator_(new C.generator.Engine_(o)),C.setPrototypeOf&&e.prototype&&C.setPrototypeOf(o,e.prototype),o},C.asyncExecutePromiseGenerator=function(e){function o(s){return e.next(s)}function i(s){return e.throw(s)}return new Promise(function(s,n){!function l(h){h.done?s(h.value):Promise.resolve(h.value).then(o,i).then(l,n)}(e.next())})},C.asyncExecutePromiseGeneratorFunction=function(e){return C.asyncExecutePromiseGenerator(e())},C.asyncExecutePromiseGeneratorProgram=function(e){return C.asyncExecutePromiseGenerator(new C.generator.Generator_(new C.generator.Engine_(e)))},C.polyfill("globalThis",function(e){return e||C.global},"es_2020","es3"),C.polyfill("Array.prototype.includes",function(e){return e||function(o,i){var s=this;s instanceof String&&(s=String(s));var n=s.length;for((i=i||0)<0&&(i=Math.max(i+n,0));i<n;i++){var l=s[i];if(l===o||Object.is(l,o))return!0}return!1}},"es7","es3"),C.checkEs6ConformanceViaProxy=function(){try{var e={},o=Object.create(new C.global.Proxy(e,{get:function(i,s,n){return i==e&&"q"==s&&n==o}}));return!0===o.q}catch{return!1}},C.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1,C.ES6_CONFORMANCE=C.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&C.checkEs6ConformanceViaProxy(),C.initSymbol=function(){},C.iteratorPrototype=function(e){return(e={next:e})[Symbol.iterator]=function(){return this},e},C.owns=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},C.MapEntry=function(){},C.polyfill("Set.prototype.difference",function(e){return e||function(o){C.checkIsSetInstance(this),C.checkIsSetLike(o);var i=C.getSmallerAndLargerSets(this,o);o=new Set(this);var s=i.smallerSetIterator;i=i.largerSet;for(var n=s.next();!n.done;)i.has(n.value)&&o.delete(n.value),n=s.next();return o}},"es_next","es6"),C.checkIsSetLike=function(e){if("object"!=typeof e||null===e||"number"!=typeof e.size||e.size<0||"function"!=typeof e.keys||"function"!=typeof e.has)throw new TypeError("Argument must be set-like")},C.checkIsValidIterator=function(e){if("object"!=typeof e||null===e||"function"!=typeof e.next)throw new TypeError("Invalid iterator.");return e},C.getSmallerAndLargerSets=function(e,o){return e.size<=o.size?{smallerSetIterator:e.keys(),largerSet:o}:{smallerSetIterator:C.checkIsValidIterator(o.keys()),largerSet:e}},C.checkIsSetInstance=function(e){if(!(e instanceof Set))throw new TypeError("Method must be called on an instance of Set.")},C.iteratorFromArray=function(e,o){if(C.ASSUME_ES6)return e[Symbol.iterator]();e instanceof String&&(e+="");var i=0,s=!1,n={next:function(){if(!s&&i<e.length){var l=i++;return{value:o(l,e[l]),done:!1}}return s=!0,{done:!0,value:void 0}}};return n[Symbol.iterator]=function(){return n},n},C.polyfill("Array.prototype.values",function(e){return e||function(){return C.iteratorFromArray(this,function(o,i){return i})}},"es8","es3"),C.polyfill("Array.prototype.flatMap",function(e){return e||function(o,i){var s=[];return Array.prototype.forEach.call(this,function(n,l){n=o.call(i,n,l,this),Array.isArray(n)?s.push.apply(s,n):s.push(n)}),s}},"es9","es5"),C.polyfill("Array.prototype.flat",function(e){return e||function(o){o=void 0===o?1:o;var i=[];return Array.prototype.forEach.call(this,function(s){Array.isArray(s)&&o>0?(s=Array.prototype.flat.call(s,o-1),i.push.apply(i,s)):i.push(s)}),i}},"es9","es5"),C.polyfill("Object.entries",function(e){return e||function(o){var s,i=[];for(s in o)C.owns(o,s)&&i.push([s,o[s]]);return i}},"es8","es3"),C.polyfill("Object.values",function(e){return e||function(o){var s,i=[];for(s in o)C.owns(o,s)&&i.push(o[s]);return i}},"es8","es3");var Bi=Object.create(null),T_={typeMap:Bi},mu=Object.create(null),vt="default",w=class{constructor(e){this.name=e}toString(){return this.name}};w.CONNECTION_CHECKER=new w("connectionChecker"),w.CONNECTION_PREVIEWER=new w("connectionPreviewer"),w.CURSOR=new w("cursor"),w.EVENT=new w("event"),w.FIELD=new w("field"),w.INPUT=new w("input"),w.RENDERER=new w("renderer"),w.TOOLBOX=new w("toolbox"),w.THEME=new w("theme"),w.TOOLBOX_ITEM=new w("toolboxItem"),w.FLYOUTS_VERTICAL_TOOLBOX=new w("flyoutsVerticalToolbox"),w.FLYOUTS_HORIZONTAL_TOOLBOX=new w("flyoutsHorizontalToolbox"),w.FLYOUT_INFLATER=new w("flyoutInflater"),w.METRICS_MANAGER=new w("metricsManager"),w.BLOCK_DRAGGER=new w("blockDragger"),w.SERIALIZER=new w("serializer"),w.ICON=new w("icon"),w.PASTER=new w("paster"),w.VARIABLE_MODEL=new w("variableModel"),w.VARIABLE_MAP=new w("variableMap");var Jo={DEFAULT:vt,TEST_ONLY:T_};Jo.Type=w,Jo.getAllItems=go,Jo.getClass=$t,Jo.getClassFromOptions=Ve,Jo.getObject=Rt,Jo.hasItem=Po,Jo.register=D,Jo.unregister=mt;var Kh,lm,cm,am,bu,fu,Jh,um,dm,hm,ye=Object.create(null),E_=750,rm="ontouchstart"in globalThis||!!(globalThis.document&&document.documentElement&&"ontouchstart"in document.documentElement)||!(!globalThis.navigator||!globalThis.navigator.maxTouchPoints&&!globalThis.navigator.msMaxTouchPoints),$u=null,qs={mousedown:["pointerdown"],mouseenter:["pointerenter"],mouseleave:["pointerleave"],mousemove:["pointermove"],mouseout:["pointerout"],mouseover:["pointerover"],mouseup:["pointerup","pointercancel"],touchend:["pointerup"],touchcancel:["pointercancel"]},_u=0,Ws={TOUCH_ENABLED:rm,TOUCH_MAP:qs};Ws.checkTouchIdentifier=ai,Ws.clearTouchIdentifier=qe,Ws.getTouchIdentifierFromEvent=mo,Ws.longStart=ts,Ws.longStop=it,Ws.shouldHandleEvent=fe,function(e){function o(s){return i.includes(s.toUpperCase())}const i=(Kh=e).toUpperCase();lm=o("JavaFX"),cm=o("WebKit"),am=o("Gecko")&&!cm,bu=o("Android"),e=globalThis.navigator&&globalThis.navigator.maxTouchPoints,fu=o("iPad")||o("Macintosh")&&e>0,Jh=o("iPhone")&&!fu,um=o("Macintosh"),dm=fu||bu&&!o("Mobile")||o("Silk"),hm=!dm&&(Jh||bu)}(globalThis.navigator&&globalThis.navigator.userAgent||"");var pm=lm,gm=am,Qh=bu,Tu=fu,mm=Jh,ep=um,$m=hm,y_={ANDROID:Qh,GECKO:gm,IPAD:Tu,IPHONE:mm,JavaFx:pm,MAC:ep,MOBILE:$m,raw:Kh},_m=40,bm=125,Qo={};Qo.bind=lt,Qo.conditionalBind=U,Qo.getScrollDeltaPixels=Uo,Qo.isRightButton=_t,Qo.isTargetInput=Fo,Qo.mouseToSvg=$o,Qo.unbind=ne;var E=function(e){return e.BLOCK_CREATE="create",e.BLOCK_DELETE="delete",e.BLOCK_CHANGE="change",e.BLOCK_FIELD_INTERMEDIATE_CHANGE="block_field_intermediate_change",e.BLOCK_MOVE="move",e.VAR_CREATE="var_create",e.VAR_DELETE="var_delete",e.VAR_RENAME="var_rename",e.VAR_TYPE_CHANGE="var_type_change",e.UI="ui",e.BLOCK_DRAG="drag",e.SELECTED="selected",e.CLICK="click",e.MARKER_MOVE="marker_move",e.BUBBLE_OPEN="bubble_open",e.TRASHCAN_OPEN="trashcan_open",e.TOOLBOX_ITEM_SELECT="toolbox_item_select",e.THEME_CHANGE="theme_change",e.VIEWPORT_CHANGE="viewport_change",e.COMMENT_CREATE="comment_create",e.COMMENT_DELETE="comment_delete",e.COMMENT_CHANGE="comment_change",e.COMMENT_MOVE="comment_move",e.COMMENT_RESIZE="comment_resize",e.COMMENT_DRAG="comment_drag",e.COMMENT_COLLAPSE="comment_collapse",e.FINISHED_LOADING="finished_loading",e}(E||{}),tp=[E.BLOCK_CREATE,E.BLOCK_MOVE,E.COMMENT_CREATE,E.COMMENT_MOVE];({BUMP_EVENTS:tp}).EventType=E;var fm="!#$%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",op={genUid:()=>{const o=[];for(let i=0;i<20;i++)o[i]=fm.charAt(88*Math.random());return o.join("")}},C_=0,ip={TEST_ONLY:op};ip.genUid=Ne,ip.getNextUniqueId=ct;var ke={};ke.isBlockChange=zt,ke.isBlockCreate=_o,ke.isBlockDelete=ui,ke.isBlockDrag=gn,ke.isBlockFieldIntermediateChange=os,ke.isBlockMove=jt,ke.isBubbleOpen=hi,ke.isClick=ss,ke.isCommentChange=bn,ke.isCommentCollapse=En,ke.isCommentCreate=Ho,ke.isCommentDelete=_n,ke.isCommentDrag=Tn,ke.isCommentMove=fn,ke.isCommentResize=ns,ke.isFinishedLoading=vn,ke.isSelected=di,ke.isThemeChange=pi,ke.isToolboxItemSelect=$n,ke.isTrashcanOpen=mn,ke.isVarCreate=is,ke.isVarDelete=hn,ke.isVarRename=pn,ke.isViewportChange=Zo;var Tm="",Jl=!0,sp=0,np="ORPHANED_BLOCK",ei=[],rp={FIRE_QUEUE:ei,enqueueEvent:rs,fireNow:gi,fireInternal:yn,setGroupInternal:We},yt={TEST_ONLY:rp};yt.clearPendingUndo=$i,yt.disable=t.disable$$module$build$src$core$events$utils,yt.disableOrphans=cs,yt.enable=t.enable$$module$build$src$core$events$utils,yt.filter=mi,yt.fire=L,yt.fromJson=ls,yt.get=B,yt.getDescendantIds=Go,yt.getGroup=t.getGroup$$module$build$src$core$events$utils,yt.getRecordUndo=Ze,yt.isEnabled=_e,yt.setGroup=t.setGroup$$module$build$src$core$events$utils,yt.setRecordUndo=t.setRecordUndo$$module$build$src$core$events$utils;var ti,e,Ql="http://www.w3.org/2000/svg",Ao="http://www.w3.org/1999/xhtml",It="http://www.w3.org/1999/xlink";(e=ti||(ti={}))[e.ELEMENT_NODE=1]="ELEMENT_NODE",e[e.TEXT_NODE=3]="TEXT_NODE",e[e.COMMENT_NODE=8]="COMMENT_NODE";var to=null,lp=0,ec=null,et={HTML_NS:Ao};et.NodeType=ti,et.SVG_NS=Ql,et.XLINK_NS=It,et.addClass=R,et.createSvgElement=I,et.getFastTextWidth=Ce,et.getFastTextWidthWithSizeString=Mt,et.getTextWidth=O,et.hasClass=bi,et.insertAfter=d,et.measureFontMetrics=xn,et.removeClass=te,et.removeClasses=_i,et.removeNode=ce,et.setCssTransform=m,et.startTextWidthCache=b,et.stopTextWidthCache=y;var je=class{static findFocusedNode(e){var o=e.getRootFocusableNode();if(!o.canBeFocused())return null;var i=o.getFocusableElement();return bi(i,je.ACTIVE_CLASS_NAME)||bi(i,je.PASSIVE_CSS_CLASS_NAME)||((o=i.querySelector(this.ACTIVE_FOCUS_NODE_CSS_SELECTOR))instanceof HTMLElement||o instanceof SVGElement)&&(o=je.findFocusableNodeFor(o,e))?o:((i=i.querySelector(this.PASSIVE_FOCUS_NODE_CSS_SELECTOR))instanceof HTMLElement||i instanceof SVGElement)&&(e=je.findFocusableNodeFor(i,e))?e:null}static findFocusableNodeFor(e,o){if(!e.id||"null"===e.id||-1!==o.getNestedTrees().map(n=>je.findFocusableNodeFor(e,n)).findIndex(n=>!!n))return null;var s,i=o.getRootFocusableNode();return i.canBeFocused()&&e===i.getFocusableElement()||(i=null!=(s=o.lookUpFocusableNode(e.id))?s:null)?i:(s=e.parentElement,!i&&s?je.findFocusableNodeFor(s,o):null)}};je.ACTIVE_CLASS_NAME="blocklyActiveFocus",je.PASSIVE_CSS_CLASS_NAME="blocklyPassiveFocus",je.ACTIVE_FOCUS_NODE_CSS_SELECTOR=`.${je.ACTIVE_CLASS_NAME}`,je.PASSIVE_FOCUS_NODE_CSS_SELECTOR=`.${je.PASSIVE_CSS_CLASS_NAME}`;var tt=class{constructor(e){this.previouslyFocusedNode=this.focusedNode=null,this.registeredTrees=[],this.isUpdatingFocusedNode=this.recentlyLostAllFocus=this.lockFocusStateChanges=this.currentlyHoldsEphemeralFocus=!1;const o=i=>{if(!this.isUpdatingFocusedNode){this.recentlyLostAllFocus=!i;var s=null;if(i instanceof HTMLElement||i instanceof SVGElement)for(var n of this.registeredTrees)if(s=je.findFocusableNodeFor(i,n.tree))break;if(s&&s.canBeFocused()){let l;i=s.getFocusableTree(),n=null==(l=this.focusedNode)?void 0:l.getFocusableTree(),s===i.getRootFocusableNode()&&i!==n?this.focusTree(i):this.focusNode(s)}else this.defocusCurrentFocusedNode()}};e("focusin",i=>{i instanceof FocusEvent&&o(document.activeElement)}),e("focusout",i=>{i instanceof FocusEvent&&o(i.relatedTarget)})}registerTree(e,o=!1){if(this.ensureManagerIsUnlocked(),this.isRegistered(e))throw Error(`Attempted to re-register already registered tree: ${e}.`);this.registeredTrees.push(new class{constructor(e,o){this.tree=e,this.rootShouldBeAutoTabbable=o}}(e,o));const i=e.getRootFocusableNode().getFocusableElement();if(!i.id||"null"===i.id)throw Error(`Attempting to register a tree with a root element that has an invalid ID: ${e}.`);o&&(i.tabIndex=0)}isRegistered(e){return!!this.lookUpRegistration(e)}lookUpRegistration(e){let o;return null!=(o=this.registeredTrees.find(i=>i.tree===e))?o:null}unregisterTree(e){if(this.ensureManagerIsUnlocked(),!this.isRegistered(e))throw Error(`Attempted to unregister not registered tree: ${e}.`);var o=this.registeredTrees.findIndex(n=>n.tree===e);const i=this.registeredTrees[o];this.registeredTrees.splice(o,1),o=je.findFocusedNode(e);const s=e.getRootFocusableNode();o&&this.removeHighlight(o),this.focusedNode!==o&&this.focusedNode!==s||this.updateFocusedNode(null),this.removeHighlight(s),i.rootShouldBeAutoTabbable&&e.getRootFocusableNode().getFocusableElement().removeAttribute("tabindex")}getFocusedTree(){let e,o;return null!=(o=null==(e=this.focusedNode)?void 0:e.getFocusableTree())?o:null}getFocusedNode(){return this.focusedNode}focusTree(e){if(this.ensureManagerIsUnlocked(),!this.isRegistered(e))throw Error(`Attempted to focus unregistered tree: ${e}.`);const o=je.findFocusedNode(e),i=e.getRestoredFocusableNode(o);let s;e=e.getRootFocusableNode(),this.focusNode(null!=(s=i??o)?s:e)}focusNode(e){this.ensureManagerIsUnlocked();const o=!this.currentlyHoldsEphemeralFocus;o&&(this.isUpdatingFocusedNode=!0);var i,s=(null==(i=this.focusedNode)?void 0:i.getFocusableElement())!==document.activeElement;if(this.focusedNode!==e||s)if(e.canBeFocused()){if(i=e.getFocusableTree(),!this.isRegistered(i))throw Error(`Attempted to focus unregistered node: ${e}.`);(s=e.getFocusableElement()).id&&"null"!==s.id||console.warn("Trying to focus a node that has an invalid ID.");var n=je.findFocusableNodeFor(s,i);s=je.findFocusedNode(i);var h,l=e;n!==e&&(l=i.getRestoredFocusableNode(s),e=i.getRootFocusableNode(),l=null!=(h=l??s)?h:e),e=this.focusedNode,h=e?.getFocusableTree(),e&&this.passivelyFocusNode(e,i),i=i.getRootFocusableNode(),s&&this.removeHighlight(s),i!==l&&this.removeHighlight(i),this.currentlyHoldsEphemeralFocus||this.activelyFocusNode(l,h??null),this.updateFocusedNode(l)}else console.warn("Trying to focus a node that can't be focused.");o&&(this.isUpdatingFocusedNode=!1)}takeEphemeralFocus(e){if(this.ensureManagerIsUnlocked(),this.currentlyHoldsEphemeralFocus)throw Error(`Attempted to take ephemeral focus when it's already held, with new element: ${e}.`);this.currentlyHoldsEphemeralFocus=!0,this.focusedNode&&this.passivelyFocusNode(this.focusedNode,null),e.focus();let o=!1;return()=>{if(o)throw Error(`Attempted to finish ephemeral focus twice for element: ${e}.`);if(o=!0,this.currentlyHoldsEphemeralFocus=!1,this.focusedNode){this.activelyFocusNode(this.focusedNode,null);const i=this.focusedNode;setTimeout(()=>{!this.focusedNode&&this.previouslyFocusedNode===i&&this.recentlyLostAllFocus&&this.focusNode(i)},0)}}}ephemeralFocusTaken(){return this.currentlyHoldsEphemeralFocus}ensureManagerIsUnlocked(){if(this.lockFocusStateChanges)throw Error("FocusManager state changes cannot happen in a tree/node focus/blur callback.")}updateFocusedNode(e){this.previouslyFocusedNode=this.focusedNode,this.focusedNode=e}defocusCurrentFocusedNode(){this.focusedNode&&!this.currentlyHoldsEphemeralFocus&&(this.passivelyFocusNode(this.focusedNode,null),this.updateFocusedNode(null))}activelyFocusNode(e,o){this.lockFocusStateChanges=!0;const i=e.getFocusableTree(),s=e.getFocusableElement();let n;const l=null==(n=this.lookUpRegistration(i))?void 0:n.rootShouldBeAutoTabbable;i!==o&&(i.onTreeFocus(e,o),l&&(i.getRootFocusableNode().getFocusableElement().tabIndex=-1)),e.onNodeFocus(),this.lockFocusStateChanges=!1,l&&e===i.getRootFocusableNode()||s.hasAttribute("tabindex")||(s.tabIndex=-1),this.setNodeToVisualActiveFocus(e),s.focus()}passivelyFocusNode(e,o){this.lockFocusStateChanges=!0;const i=e.getFocusableTree();if(i!==o){let s;i.onTreeBlur(o),null!=(s=this.lookUpRegistration(i))&&s.rootShouldBeAutoTabbable&&(i.getRootFocusableNode().getFocusableElement().tabIndex=0)}e.onNodeBlur(),this.lockFocusStateChanges=!1,i!==o&&this.setNodeToVisualPassiveFocus(e)}setNodeToVisualActiveFocus(e){e=e.getFocusableElement(),R(e,tt.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME),te(e,tt.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME)}setNodeToVisualPassiveFocus(e){e=e.getFocusableElement(),te(e,tt.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME),R(e,tt.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME)}removeHighlight(e){e=e.getFocusableElement(),te(e,tt.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME),te(e,tt.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME)}static getFocusManager(){return tt.focusManager||(tt.focusManager=new tt(document.addEventListener)),tt.focusManager}};tt.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME="blocklyActiveFocus",tt.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME="blocklyPassiveFocus",tt.focusManager=null;var Em={};Em.FocusManager=tt,Em.getFocusManager=t.getFocusManager$$module$build$src$core$focus_manager;var vm={};vm.deepMerge=Nt;var be=class{constructor(){this.shortcuts=new Map,this.keyMap=new Map,this.reset()}reset(){this.shortcuts.clear(),this.keyMap.clear()}register(e,o){if(this.shortcuts.get(e.name)&&!o)throw Error(`Shortcut named "${e.name}" already exists.`);if(this.shortcuts.set(e.name,e),null!=(o=e.keyCodes)&&o.length)for(const i of o)this.addKeyMapping(i,e.name,!!e.allowCollision)}unregister(e){return this.shortcuts.get(e)?(this.removeAllKeyMappings(e),this.shortcuts.delete(e),!0):(console.warn(`Keyboard shortcut named "${e}" not found.`),!1)}addKeyMapping(e,o,i){const s=this.keyMap.get(e=`${e}`);if(s&&!i)throw Error(`Shortcut named "${o}" collides with shortcuts "${s}"`);s&&i?s.unshift(o):this.keyMap.set(e,[o])}removeKeyMapping(e,o,i){const s=this.keyMap.get(e);if(!s)return i||console.warn(`No keyboard shortcut named "${o}" registered with key code "${e}"`),!1;const n=s.indexOf(o);return n>-1?(s.splice(n,1),0===s.length&&this.keyMap.delete(e),!0):(i||console.warn(`No keyboard shortcut named "${o}" registered with key code "${e}"`),!1)}removeAllKeyMappings(e){for(const o of this.keyMap.keys())this.removeKeyMapping(o,e,!0)}setKeyMap(e){this.keyMap.clear();for(const o in e)this.keyMap.set(o,e[o])}getKeyMap(){const e=Object.create(null);for(const[o,i]of this.keyMap)e[o]=i;return e}getRegistry(){const e=Object.create(null);for(const[o,i]of this.shortcuts)e[o]=i;return Nt(Object.create(null),e)}onKeyDown(e,o){var i=this.serializeKeyEvent(o);if(!(i=this.getShortcutNamesByKeyCode(i)))return!1;for(const s of i){let n,l,h,$;if((i=this.shortcuts.get(s))&&(!i.preconditionFn||i.preconditionFn(e,{focusedNode:null!=(n=t.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode())?n:void 0}))&&null!=(h=(l=i).callback)&&h.call(l,e,o,i,{focusedNode:null!=($=t.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode())?$:void 0}))return!0}return!1}getShortcutNamesByKeyCode(e){let o;return(null==(o=this.keyMap.get(e))?void 0:o.slice())||[]}getKeyCodesByShortcutName(e){const o=[];for(const[i,s]of this.keyMap)s.indexOf(e)>-1&&o.push(i);return o}serializeKeyEvent(e){let o="";for(const i in be.modifierKeys)e.getModifierState(i)&&(""!==o&&(o+="+"),o+=i);return""!==o&&e.keyCode?o+="+"+e.keyCode:e.keyCode&&(o=String(e.keyCode)),o}checkModifiers(e){for(const o of e)if(!(o in be.modifierKeys))throw Error(o+" is not a valid modifier key.")}createSerializedKey(e,o){let i="";if(o){this.checkModifiers(o);for(const s in be.modifierKeys)o.includes(be.modifierKeys[s])&&(""!==i&&(i+="+"),i+=s)}return""!==i&&e?i+="+"+e:e&&(i=`${e}`),i}};be.registry=new be,function(e){(e=e.modifierKeys||(e.modifierKeys={}))[e.Shift=16]="Shift",e[e.Control=17]="Control",e[e.Alt=18]="Alt",e[e.Meta=91]="Meta"}(be||(be={}));var ym,xm,tc=Object.create(null),oc=[],Cm={defineBlocksWithJsonArrayInternal:Vc},Ye={TEST_ONLY:Cm};Ye.createBlockDefinitionsFromJsonArray=t.createBlockDefinitionsFromJsonArray$$module$build$src$core$common,Ye.defineBlocks=t.defineBlocks$$module$build$src$core$common,Ye.defineBlocksWithJsonArray=kn,Ye.draggingConnections=oc,Ye.fireSelectedEvent=To,Ye.getAllWorkspaces=fi,Ye.getBlockTypeCounts=hs,Ye.getMainWorkspace=bt,Ye.getParentContainer=ds,Ye.getSelected=fo,Ye.getWorkspaceById=bo,Ye.globalShortcutHandler=ps,Ye.registerWorkspace=Gr,Ye.setMainWorkspace=us,Ye.setParentContainer=Cn,Ye.setSelected=Hc,Ye.svgResize=Eo,Ye.unregisterWorkpace=Vr;var vu,zs=class{constructor(){this.workspaceId=void 0,this.isUiEvent=!1,this.type="",this.group=t.getGroup$$module$build$src$core$events$utils(),this.recordUndo=Ze()}toJson(){return{type:this.type,group:this.group}}static fromJson(e,o,i){return i.isBlank=!1,i.group=e.group||"",i.workspaceId=o.id,i}isNull(){return!1}run(e){}getEventWorkspace_(){let e;if(this.workspaceId&&(e=bo(this.workspaceId)),!e)throw Error("Workspace is null. Event must have been generated from real Blockly events.");return e}},oo=class extends zs{constructor(e){super(),this.recordUndo=!1,this.isUiEvent=!0,this.isBlank=typeof e>"u",this.workspaceId=e||""}},Eu=class extends oo{constructor(e,o,i){null===(o=e?e.workspace.id:o)&&(o=void 0),super(o),this.type=E.CLICK,this.blockId=e?e.id:void 0,this.targetType=i}toJson(){const e=super.toJson();if(!this.targetType)throw Error("The click target type is undefined. Either pass a block to the constructor, or call fromJson");return e.targetType=this.targetType,e.blockId=this.blockId,e}static fromJson(e,o,i){return(o=super.fromJson(e,o,i??new Eu)).targetType=e.targetType,o.blockId=e.blockId,o}};(function(e){e.BLOCK="block",e.WORKSPACE="workspace",e.ZOOM_CONTROLS="zoom_controls"})(vu||(vu={})),D(w.EVENT,E.CLICK,Eu);var km={};km.Click=Eu,km.ClickTarget=vu;var Im={};Im.removeElem=ft;var oi=class{constructor(e){this.name=e}toString(){return this.name}};oi.POSITIONABLE=new oi("positionable"),oi.DRAG_TARGET=new oi("drag_target"),oi.DELETE_AREA=new oi("delete_area"),oi.AUTOHIDEABLE=new oi("autohideable");var xe=class{constructor(){this.componentData=new Map,this.capabilityToComponentIds=new Map}addComponent(e,o){const i=e.component.id;var s;if(!o&&this.componentData.has(i))throw Error('Plugin "'+i+'" with capabilities "'+(null==(s=this.componentData.get(i))?void 0:s.capabilities)+'" already added.');for(this.componentData.set(i,e),o=[],s=0;s<e.capabilities.length;s++){const n=String(e.capabilities[s]).toLowerCase();if(o.push(n),this.capabilityToComponentIds.has(n)){let l;null==(l=this.capabilityToComponentIds.get(n))||l.push(i)}else this.capabilityToComponentIds.set(n,[i])}this.componentData.get(i).capabilities=o}removeComponent(e){const o=this.componentData.get(e);if(o){for(let i=0;i<o.capabilities.length;i++){const s=String(o.capabilities[i]).toLowerCase();ft(this.capabilityToComponentIds.get(s),e)}this.componentData.delete(e)}}addCapability(e,o){if(!this.getComponent(e))throw Error('Cannot add capability, "'+o+'". Plugin "'+e+'" has not been added to the ComponentManager');var i,s;this.hasCapability(e,o)?console.warn('Plugin "'+e+'already has capability "'+o+'"'):(o=`${o}`.toLowerCase(),null==(i=this.componentData.get(e))||i.capabilities.push(o),null==(s=this.capabilityToComponentIds.get(o))||s.push(e))}removeCapability(e,o){if(!this.getComponent(e))throw Error('Cannot remove capability, "'+o+'". Plugin "'+e+'" has not been added to the ComponentManager');this.hasCapability(e,o)?(o=`${o}`.toLowerCase(),ft(this.componentData.get(e).capabilities,o),ft(this.capabilityToComponentIds.get(o),e)):console.warn('Plugin "'+e+"doesn't have capability \""+o+'" to remove')}hasCapability(e,o){return o=`${o}`.toLowerCase(),this.componentData.has(e)&&this.componentData.get(e).capabilities.includes(o)}getComponent(e){let o;return null==(o=this.componentData.get(e))?void 0:o.component}getComponents(e,o){if(e=`${e}`.toLowerCase(),!(e=this.capabilityToComponentIds.get(e)))return[];const i=[];if(o){const s=[];e.forEach(n=>{s.push(this.componentData.get(n))}),s.sort(function(n,l){return n.weight-l.weight}),s.forEach(function(n){i.push(n.component)})}else e.forEach(s=>{i.push(this.componentData.get(s).component)});return i}};xe.Capability=oi,function(e){(e=e.ComponentWeight||(e.ComponentWeight={}))[e.TOOLBOX_WEIGHT=0]="TOOLBOX_WEIGHT",e[e.FLYOUT_WEIGHT=1]="FLYOUT_WEIGHT",e[e.TRASHCAN_WEIGHT=2]="TRASHCAN_WEIGHT",e[e.ZOOM_CONTROLS_WEIGHT=3]="ZOOM_CONTROLS_WEIGHT"}(xe||(xe={}));var M_=xe.ComponentWeight,wm={};wm.ComponentManager=xe,wm.ComponentWeight=M_;var cp=!1,ap='\n.blocklySvg {\n  background-color: #fff;\n  outline: none;\n  overflow: hidden;  /* IE overflows by default. */\n  position: absolute;\n  display: block;\n}\n\n.blocklyWidgetDiv {\n  display: none;\n  position: absolute;\n  z-index: 99999;  /* big value for bootstrap3 compatibility */\n}\n\n.injectionDiv {\n  height: 100%;\n  position: relative;\n  overflow: hidden;  /* So blocks in drag surface disappear at edges */\n  touch-action: none;\n  user-select: none;\n  -webkit-user-select: none;\n}\n\n.blocklyBlockCanvas.blocklyCanvasTransitioning,\n.blocklyBubbleCanvas.blocklyCanvasTransitioning {\n  transition: transform .5s;\n}\n\n.blocklyEmboss {\n  filter: var(--blocklyEmbossFilter);\n}\n\n.blocklyTooltipDiv {\n  background-color: #ffffc7;\n  border: 1px solid #ddc;\n  box-shadow: 4px 4px 20px 1px rgba(0,0,0,.15);\n  color: #000;\n  display: none;\n  font: 9pt sans-serif;\n  opacity: .9;\n  padding: 2px;\n  position: absolute;\n  z-index: 100000;  /* big value for bootstrap3 compatibility */\n}\n\n.blocklyDropDownDiv {\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1000;\n  display: none;\n  border: 1px solid;\n  border-color: #dadce0;\n  background-color: #fff;\n  border-radius: 2px;\n  padding: 4px;\n  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownDiv:focus {\n  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownContent {\n  max-height: 300px;  /* @todo: spec for maximum height. */\n}\n\n.blocklyDropDownArrow {\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 16px;\n  height: 16px;\n  z-index: -1;\n  background-color: inherit;\n  border-color: inherit;\n  border-top: 1px solid;\n  border-left: 1px solid;\n  border-top-left-radius: 4px;\n  border-color: inherit;\n}\n\n.blocklyHighlighted>.blocklyPath {\n  filter: var(--blocklyEmbossFilter);\n}\n\n.blocklyHighlightedConnectionPath {\n  fill: none;\n  stroke: #fc3;\n  stroke-width: 4px;\n}\n\n.blocklyPathLight {\n  fill: none;\n  stroke-linecap: round;\n  stroke-width: 1;\n}\n\n.blocklySelected>.blocklyPathLight {\n  display: none;\n}\n\n.blocklyDraggable {\n  cursor: grab;\n  cursor: -webkit-grab;\n}\n\n.blocklyDragging {\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n  /* Drag surface disables events to not block the toolbox, so we have to\n   * reenable them here for the cursor values to work. */\n  pointer-events: auto;\n}\n\n  /* Changes cursor on mouse down. Not effective in Firefox because of\n     https://bugzilla.mozilla.org/show_bug.cgi?id=771241 */\n.blocklyDraggable:active {\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n}\n\n.blocklyDragging.blocklyDraggingDelete {\n  cursor: url("<<<PATH>>>/handdelete.cur"), auto;\n}\n\n.blocklyDragging>.blocklyPath,\n.blocklyDragging>.blocklyPathLight {\n  fill-opacity: .8;\n  stroke-opacity: .8;\n}\n\n.blocklyDragging>.blocklyPathDark {\n  display: none;\n}\n\n.blocklyDisabledPattern>.blocklyPath {\n  fill: var(--blocklyDisabledPattern);\n  fill-opacity: .5;\n  stroke-opacity: .5;\n}\n\n.blocklyDisabled>.blocklyPathLight,\n.blocklyDisabled>.blocklyPathDark {\n  display: none;\n}\n\n.blocklyInsertionMarker>.blocklyPath,\n.blocklyInsertionMarker>.blocklyPathLight,\n.blocklyInsertionMarker>.blocklyPathDark {\n  fill-opacity: .2;\n  stroke: none;\n}\n\n.blocklyNonEditableField>text {\n  pointer-events: none;\n}\n\n.blocklyFlyout {\n  position: absolute;\n  z-index: 20;\n}\n\n.blocklyText text {\n  cursor: default;\n}\n\n/*\n  Don\'t allow users to select text.  It gets annoying when trying to\n  drag a block and selected text moves instead.\n*/\n.blocklySvg text {\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n  cursor: inherit;\n}\n\n.blocklyIconGroup {\n  cursor: default;\n}\n\n.blocklyIconGroup:not(:hover),\n.blocklyIconGroupReadonly {\n  opacity: .6;\n}\n\n.blocklyIconShape {\n  fill: #00f;\n  stroke: #fff;\n  stroke-width: 1px;\n}\n\n.blocklyIconSymbol {\n  fill: #fff;\n}\n\n.blocklyMinimalBody {\n  margin: 0;\n  padding: 0;\n  height: 100%;\n}\n\n.blocklyHtmlInput {\n  border: none;\n  border-radius: 4px;\n  height: 100%;\n  margin: 0;\n  outline: none;\n  padding: 0;\n  width: 100%;\n  text-align: center;\n  display: block;\n  box-sizing: border-box;\n}\n\n/* Remove the increase and decrease arrows on the field number editor */\ninput.blocklyHtmlInput[type=number]::-webkit-inner-spin-button,\ninput.blocklyHtmlInput[type=number]::-webkit-outer-spin-button {\n  -webkit-appearance: none;\n  margin: 0;\n}\n\ninput[type=number] {\n  -moz-appearance: textfield;\n}\n\n.blocklyMainBackground {\n  stroke-width: 1;\n  stroke: #c6c6c6;  /* Equates to #ddd due to border being off-pixel. */\n}\n\n.blocklyMutatorBackground {\n  fill: #fff;\n  stroke: #ddd;\n  stroke-width: 1;\n}\n\n.blocklyFlyoutBackground {\n  fill: #ddd;\n  fill-opacity: .8;\n}\n\n.blocklyMainWorkspaceScrollbar {\n  z-index: 20;\n}\n\n.blocklyFlyoutScrollbar {\n  z-index: 30;\n}\n\n.blocklyScrollbarHorizontal,\n.blocklyScrollbarVertical {\n  position: absolute;\n  outline: none;\n}\n\n.blocklyScrollbarBackground {\n  opacity: 0;\n  pointer-events: none;\n}\n\n.blocklyScrollbarHandle {\n  fill: #ccc;\n}\n\n.blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,\n.blocklyScrollbarHandle:hover {\n  fill: #bbb;\n}\n\n/* Darken flyout scrollbars due to being on a grey background. */\n/* By contrast, workspace scrollbars are on a white background. */\n.blocklyFlyout .blocklyScrollbarHandle {\n  fill: #bbb;\n}\n\n.blocklyFlyout .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,\n.blocklyFlyout .blocklyScrollbarHandle:hover {\n  fill: #aaa;\n}\n\n.blocklyInvalidInput {\n  background: #faa;\n}\n\n.blocklyVerticalMarker {\n  stroke-width: 3px;\n  fill: rgba(255,255,255,.5);\n  pointer-events: none;\n}\n\n.blocklyComputeCanvas {\n  position: absolute;\n  width: 0;\n  height: 0;\n}\n\n.blocklyNoPointerEvents {\n  pointer-events: none;\n}\n\n.blocklyContextMenu {\n  border-radius: 4px;\n  max-height: 100%;\n}\n\n.blocklyDropdownMenu {\n  border-radius: 2px;\n  padding: 0 !important;\n}\n\n.blocklyDropdownMenu .blocklyMenuItem {\n  /* 28px on the left for icon or checkbox. */\n  padding-left: 28px;\n}\n\n/* BiDi override for the resting state. */\n.blocklyDropdownMenu .blocklyMenuItemRtl {\n  /* Flip left/right padding for BiDi. */\n  padding-left: 5px;\n  padding-right: 28px;\n}\n\n.blocklyWidgetDiv .blocklyMenu {\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n  background: #fff;\n  border: 1px solid transparent;\n  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);\n  font: normal 13px Arial, sans-serif;\n  margin: 0;\n  outline: none;\n  padding: 4px 0;\n  position: absolute;\n  overflow-y: auto;\n  overflow-x: hidden;\n  max-height: 100%;\n  z-index: 20000;  /* Arbitrary, but some apps depend on it... */\n}\n\n.blocklyWidgetDiv .blocklyMenu:focus {\n  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownDiv .blocklyMenu {\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n  background: inherit;  /* Compatibility with gapi, reset from goog-menu */\n  border: inherit;  /* Compatibility with gapi, reset from goog-menu */\n  font: normal 13px "Helvetica Neue", Helvetica, sans-serif;\n  outline: none;\n  overflow-y: auto;\n  overflow-x: hidden;\n  max-height: 100%;\n  z-index: 20000;  /* Arbitrary, but some apps depend on it... */\n}\n\n/* State: resting. */\n.blocklyMenuItem {\n  border: none;\n  color: #000;\n  cursor: pointer;\n  list-style: none;\n  margin: 0;\n  /* 7em on the right for shortcut. */\n  min-width: 7em;\n  padding: 6px 15px;\n  white-space: nowrap;\n}\n\n/* State: disabled. */\n.blocklyMenuItemDisabled {\n  color: #ccc;\n  cursor: inherit;\n}\n\n/* State: hover. */\n.blocklyMenuItemHighlight {\n  background-color: rgba(0,0,0,.1);\n}\n\n/* State: selected/checked. */\n.blocklyMenuItemCheckbox {\n  height: 16px;\n  position: absolute;\n  width: 16px;\n}\n\n.blocklyMenuItemSelected .blocklyMenuItemCheckbox {\n  background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px;\n  float: left;\n  margin-left: -24px;\n  position: static;  /* Scroll with the menu. */\n}\n\n.blocklyMenuItemRtl .blocklyMenuItemCheckbox {\n  float: right;\n  margin-right: -24px;\n}\n\n.blocklyMenuSeparator {\n  background-color: #ccc;\n  height: 1px;\n  border: 0;\n  margin-left: 4px;\n  margin-right: 4px;\n}\n\n.blocklyBlockDragSurface, .blocklyAnimationLayer {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  overflow: visible !important;\n  z-index: 80;\n  pointer-events: none;\n}\n\n.blocklyField {\n  cursor: default;\n}\n\n.blocklyInputField {\n  cursor: text;\n}\n\n.blocklyDragging .blocklyField,\n.blocklyDragging .blocklyIconGroup {\n  cursor: grabbing;\n}\n\n.blocklyActiveFocus:is(\n  .blocklyFlyout,\n  .blocklyWorkspace,\n  .blocklyField,\n  .blocklyPath,\n  .blocklyHighlightedConnectionPath,\n  .blocklyComment,\n  .blocklyBubble,\n  .blocklyIconGroup,\n  .blocklyTextarea\n) {\n  outline: none;\n}\n',up={};up.inject=qr,up.register=Dt;var A=class{constructor(e,o){this.x=e,this.y=o}clone(){return new A(this.x,this.y)}scale(e){return this.x*=e,this.y*=e,this}translate(e,o){return this.x+=e,this.y+=o,this}static equals(e,o){return e===o||!(!e||!o)&&e.x===o.x&&e.y===o.y}static distance(e,o){const i=e.x-o.x;return e=e.y-o.y,Math.sqrt(i*i+e*e)}static magnitude(e){return Math.sqrt(e.x*e.x+e.y*e.y)}static difference(e,o){return new A(e.x-o.x,e.y-o.y)}static sum(e,o){return new A(e.x+o.x,e.y+o.y)}},v=class{constructor(e){this.tagName=e}toString(){return this.tagName}};v.ANIMATE=new v("animate"),v.CIRCLE=new v("circle"),v.CLIPPATH=new v("clipPath"),v.DEFS=new v("defs"),v.FECOMPOSITE=new v("feComposite"),v.FECOMPONENTTRANSFER=new v("feComponentTransfer"),v.FEFLOOD=new v("feFlood"),v.FEFUNCA=new v("feFuncA"),v.FEGAUSSIANBLUR=new v("feGaussianBlur"),v.FEPOINTLIGHT=new v("fePointLight"),v.FESPECULARLIGHTING=new v("feSpecularLighting"),v.FILTER=new v("filter"),v.FOREIGNOBJECT=new v("foreignObject"),v.G=new v("g"),v.IMAGE=new v("image"),v.LINE=new v("line"),v.PATH=new v("path"),v.PATTERN=new v("pattern"),v.POLYGON=new v("polygon"),v.RECT=new v("rect"),v.SVG=new v("svg"),v.TEXT=new v("text"),v.TSPAN=new v("tspan");var Q=class{constructor(e,o,i,s){this.top=e,this.bottom=o,this.left=i,this.right=s}static from(e){return new Q(e.y,e.y+e.height,e.x,e.x+e.width)}clone(){return new Q(this.top,this.bottom,this.left,this.right)}getHeight(){return this.bottom-this.top}getWidth(){return this.right-this.left}getOrigin(){return new A(this.left,this.top)}contains(e,o){return e>=this.left&&e<=this.right&&o>=this.top&&o<=this.bottom}intersects(e){return this.left<=e.right&&this.right>=e.left&&this.bottom>=e.top&&this.top<=e.bottom}static equals(e,o){return e===o||!(!e||!o)&&e.top===o.top&&e.bottom===o.bottom&&e.left===o.left&&e.right===o.right}static createFromPoint(e,o,i){const s=e.x;return new Q(e=e.y,e+i,s,s+o)}},ee=class{constructor(e,o){this.width=e,this.height=o}static equals(e,o){return e===o||!(!e||!o)&&e.width===o.width&&e.height===o.height}static max(e,o){return new ee(Math.max(e.width,o.width),Math.max(e.height,o.height))}static min(e,o){return new ee(Math.min(e.width,o.width),Math.min(e.height,o.height))}},Am={getSizeInternal:qc},Pi={TEST_ONLY:Am};Pi.getBorderBox=jr,Pi.getComputedStyle=Lt,Pi.getContainerOffsetToScrollInto=Xr,Pi.getPageOffset=vo,Pi.getSize=gs,Pi.getViewportPageOffset=zr,Pi.scrollIntoContainerView=Yr;var Sm=/translate\(\s*([-+\d.e]+)([ ,]\s*([-+\d.e]+)\s*)?/,Om=/transform:\s*translate(?:3d)?\(\s*([-+\d.e]+)\s*px([ ,]\s*([-+\d.e]+)\s*px)?/,js={TEST_ONLY:{XY_REGEX:Sm,XY_STYLE_REGEX:Om}};js.getDocumentScroll=Jr,js.getInjectionDivXY=In,js.getRelativeXY=ms,js.getViewportBBox=Kr,js.screenToWsCoordinates=Qr,js.wsToScreenCoordinates=yo;var Oe=class{constructor(e,o,i,s,n){this.workspace=e,this.horizontal=o,this.oldHostMetrics=null,this.ratio=1,this.origin=new A(0,0),this.startDragHandle=this.handlePosition=this.handleLength=this.scrollbarLength=this.startDragMouse=0,this.containerVisible=this.isHandleVisible=!0,this.position=new A(0,0),this.onMouseMoveWrapper_=this.onMouseUpWrapper_=null,this.pair=i||!1,this.margin=void 0!==n?n:Oe.DEFAULT_SCROLLBAR_MARGIN,e="blocklyScrollbar"+(this.horizontal?"Horizontal":"Vertical"),s&&(e+=" "+s),this.outerSvg=I(v.SVG,{class:e}),s=I(v.G,{},this.outerSvg),this.svgBackground=I(v.RECT,{class:"blocklyScrollbarBackground"},s),e=Math.floor((Oe.scrollbarThickness-5)/2),this.svgHandle=I(v.RECT,{class:"blocklyScrollbarHandle",rx:e,ry:e},s),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarColour","fill"),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarOpacity","fill-opacity"),d(this.outerSvg,this.workspace.getParentSvg()),this.setInitialThickness(),o?(this.lengthAttribute_="width",this.positionAttribute_="x"):(this.lengthAttribute_="height",this.positionAttribute_="y"),this.onMouseDownBarWrapper_=U(this.svgBackground,"pointerdown",this,this.onMouseDownBar),this.onMouseDownHandleWrapper_=U(this.svgHandle,"pointerdown",this,this.onMouseDownHandle)}setInitialThickness(){const e=Oe.scrollbarThickness;this.horizontal?(this.svgBackground.setAttribute("height",String(e)),this.outerSvg.setAttribute("height",String(e)),this.svgHandle.setAttribute("height",String(e-5)),this.svgHandle.setAttribute("y","2.5")):(this.svgBackground.setAttribute("width",String(e)),this.outerSvg.setAttribute("width",String(e)),this.svgHandle.setAttribute("width",String(e-5)),this.svgHandle.setAttribute("x","2.5"))}dispose(){this.cleanUp(),ne(this.onMouseDownBarWrapper_),ne(this.onMouseDownHandleWrapper_),ce(this.outerSvg),this.workspace.getThemeManager().unsubscribe(this.svgHandle)}constrainHandleLength(e){return e<=0||isNaN(e)?0:Math.min(e,this.scrollbarLength)}setHandleLength(e){this.handleLength=e,this.svgHandle.setAttribute(this.lengthAttribute_,String(this.handleLength))}constrainHandlePosition(e){return e<=0||isNaN(e)?0:Math.min(e,this.scrollbarLength-this.handleLength)}setHandlePosition(e){this.handlePosition=e,this.svgHandle.setAttribute(this.positionAttribute_,String(this.handlePosition))}setScrollbarLength(e){this.scrollbarLength=e,this.outerSvg.setAttribute(this.lengthAttribute_,String(this.scrollbarLength)),this.svgBackground.setAttribute(this.lengthAttribute_,String(this.scrollbarLength))}setPosition(e,o){this.position.x=e,this.position.y=o,m(this.outerSvg,"translate("+(this.position.x+this.origin.x)+"px,"+(this.position.y+this.origin.y)+"px)")}resize(e){!e&&!(e=this.workspace.getMetrics())||this.oldHostMetrics&&Oe.metricsAreEquivalent(e,this.oldHostMetrics)||(this.horizontal?this.resizeHorizontal(e):this.resizeVertical(e),this.oldHostMetrics=e,this.updateMetrics())}requiresViewResize(e){return!this.oldHostMetrics||this.oldHostMetrics.viewWidth!==e.viewWidth||this.oldHostMetrics.viewHeight!==e.viewHeight||this.oldHostMetrics.absoluteLeft!==e.absoluteLeft||this.oldHostMetrics.absoluteTop!==e.absoluteTop}resizeHorizontal(e){this.requiresViewResize(e)?this.resizeViewHorizontal(e):this.resizeContentHorizontal(e)}resizeViewHorizontal(e){var o=e.viewWidth-2*this.margin;this.pair&&(o-=Oe.scrollbarThickness),this.setScrollbarLength(Math.max(0,o)),o=e.absoluteLeft+this.margin,this.pair&&this.workspace.RTL&&(o+=Oe.scrollbarThickness),this.setPosition(o,e.absoluteTop+e.viewHeight-Oe.scrollbarThickness-this.margin),this.resizeContentHorizontal(e)}resizeContentHorizontal(e){if(e.viewWidth>=e.scrollWidth)this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(!1);else{this.pair||this.setVisible(!0);var o=this.scrollbarLength*e.viewWidth/e.scrollWidth;o=this.constrainHandleLength(o),this.setHandleLength(o);var i=this.scrollbarLength-this.handleLength;e=this.constrainHandlePosition(e=(e.viewLeft-e.scrollLeft)/(o=e.scrollWidth-e.viewWidth)*i),this.setHandlePosition(e),this.ratio=i/o}}resizeVertical(e){this.requiresViewResize(e)?this.resizeViewVertical(e):this.resizeContentVertical(e)}resizeViewVertical(e){let o=e.viewHeight-2*this.margin;this.pair&&(o-=Oe.scrollbarThickness),this.setScrollbarLength(Math.max(0,o)),this.setPosition(this.workspace.RTL?e.absoluteLeft+this.margin:e.absoluteLeft+e.viewWidth-Oe.scrollbarThickness-this.margin,e.absoluteTop+this.margin),this.resizeContentVertical(e)}resizeContentVertical(e){if(e.viewHeight>=e.scrollHeight)this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(!1);else{this.pair||this.setVisible(!0);var o=this.scrollbarLength*e.viewHeight/e.scrollHeight;o=this.constrainHandleLength(o),this.setHandleLength(o);var i=this.scrollbarLength-this.handleLength;e=this.constrainHandlePosition(e=(e.viewTop-e.scrollTop)/(o=e.scrollHeight-e.viewHeight)*i),this.setHandlePosition(e),this.ratio=i/o}}isVisible(){return this.isHandleVisible}setContainerVisible(e){const o=e!==this.containerVisible;this.containerVisible=e,o&&this.updateDisplay_()}setVisible(e){if(this.pair)throw Error("Unable to toggle visibility of paired scrollbars.");this.setVisibleInternal(e)}setVisibleInternal(e){const o=e!==this.isVisible();this.isHandleVisible=e,o&&this.updateDisplay_()}updateDisplay_(){this.containerVisible&&this.isVisible()?this.outerSvg.setAttribute("display","block"):this.outerSvg.setAttribute("display","none")}onMouseDownBar(e){if(this.workspace.markFocused(),qe(),this.cleanUp(),_t(e))e.stopPropagation();else{var o=$o(e,this.workspace.getParentSvg(),this.workspace.getInverseScreenCTM());o=this.horizontal?o.x:o.y;var i=In(this.svgHandle),s=this.handlePosition,n=.95*this.handleLength;o<=(i=this.horizontal?i.x:i.y)?s-=n:o>=i+this.handleLength&&(s+=n),this.setHandlePosition(this.constrainHandlePosition(s)),this.updateMetrics(),e.stopPropagation(),e.preventDefault()}}onMouseDownHandle(e){this.workspace.markFocused(),this.cleanUp(),_t(e)?e.stopPropagation():(this.startDragHandle=this.handlePosition,this.startDragMouse=this.horizontal?e.clientX:e.clientY,this.onMouseUpWrapper_=U(document,"pointerup",this,this.onMouseUpHandle),this.onMouseMoveWrapper_=U(document,"pointermove",this,this.onMouseMoveHandle),e.stopPropagation(),e.preventDefault())}onMouseMoveHandle(e){this.setHandlePosition(this.constrainHandlePosition(this.startDragHandle+((this.horizontal?e.clientX:e.clientY)-this.startDragMouse))),this.updateMetrics()}onMouseUpHandle(){qe(),this.cleanUp()}cleanUp(){this.workspace.hideChaff(!0),this.onMouseUpWrapper_&&(ne(this.onMouseUpWrapper_),this.onMouseUpWrapper_=null),this.onMouseMoveWrapper_&&(ne(this.onMouseMoveWrapper_),this.onMouseMoveWrapper_=null)}getRatio_(){let e=this.handlePosition/(this.scrollbarLength-this.handleLength);return isNaN(e)&&(e=0),e}updateMetrics(){const e=this.getRatio_();this.workspace.setMetrics(this.horizontal?{x:e}:{y:e})}set(e,o){this.setHandlePosition(this.constrainHandlePosition(e*this.ratio)),(o||void 0===o)&&this.updateMetrics()}setOrigin(e,o){this.origin=new A(e,o)}static metricsAreEquivalent(e,o){return e.viewWidth===o.viewWidth&&e.viewHeight===o.viewHeight&&e.viewLeft===o.viewLeft&&e.viewTop===o.viewTop&&e.absoluteTop===o.absoluteTop&&e.absoluteLeft===o.absoluteLeft&&e.scrollWidth===o.scrollWidth&&e.scrollHeight===o.scrollHeight&&e.scrollLeft===o.scrollLeft&&e.scrollTop===o.scrollTop}};Oe.scrollbarThickness=rm?25:15,Oe.DEFAULT_SCROLLBAR_MARGIN=.5;var yu={parseFromString:function(){throw Error("DOMParser was not found in the global scope and was not properly injected using injectDependencies")}},dp={serializeToString:function(){throw Error("XMLSerializer was not foundin the global scope and was not properly injected using injectDependencies")}},{document:xu,DOMParser:ic,XMLSerializer:sc}=globalThis;ic&&(yu=new ic),sc&&(dp=new sc);var Rm="https://developers.google.com/blockly/xml",U_=/[\x00-\x09\x0B\x0C\x0E-\x1F]/g,vr={NAME_SPACE:Rm};vr.createElement=t.createElement$$module$build$src$core$utils$xml,vr.createTextNode=t.createTextNode$$module$build$src$core$utils$xml,vr.domToText=Ti,vr.injectDependencies=Wc,vr.textToDom=t.textToDom$$module$build$src$core$utils$xml;var j,hp="categoryToolbox",Mm="flyoutToolbox";!function(e){e[e.TOP=0]="TOP",e[e.BOTTOM=1]="BOTTOM",e[e.LEFT=2]="LEFT",e[e.RIGHT=3]="RIGHT"}(j||(j={}));var Nm={hasCategoriesInternal:Yc},Fi={};Fi.Position=j,Fi.TEST_ONLY=Nm,Fi.convertFlyoutDefToJsonArray=$s,Fi.convertToolboxDefToJson=wn,Fi.hasCategories=An,Fi.isCategoryCollapsible=Sn,Fi.parseToolboxTree=tl;var Ui=function(e){return e[e.TOP=0]="TOP",e[e.BOTTOM=1]="BOTTOM",e}(Ui||{}),nc=function(e){return e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT",e}(nc||{}),Ys=function(e){return e[e.UP=0]="UP",e[e.DOWN=1]="DOWN",e}(Ys||{}),Xs={};Xs.bumpDirection=Ys,Xs.bumpPositionRect=Nn,Xs.getCornerOppositeToolbox=Mn,Xs.getStartPositionRect=Rn,Xs.horizontalPosition=nc,Xs.verticalPosition=Ui;var dt_width=96,dt_height=124,dt_url="sprites.png",pp=class{constructor(e){this.workspace=e,this.id="zoomControls",this.boundEvents=[],this.zoomResetGroup=this.zoomOutGroup=this.zoomInGroup=null,this.HEIGHT=this.WIDTH=32,this.SMALL_SPACING=2,this.LARGE_SPACING=11,this.MARGIN_HORIZONTAL=this.MARGIN_VERTICAL=20,this.svgGroup=null,this.top=this.left=0,this.initialized=!1}createDom(){this.svgGroup=I(v.G,{});const e=String(Math.random()).substring(2);return this.createZoomOutSvg(e),this.createZoomInSvg(e),this.workspace.isMovable()&&this.createZoomResetSvg(e),this.svgGroup}init(){this.workspace.getComponentManager().addComponent({component:this,weight:xe.ComponentWeight.ZOOM_CONTROLS_WEIGHT,capabilities:[xe.Capability.POSITIONABLE]}),this.initialized=!0}dispose(){this.workspace.getComponentManager().removeComponent("zoomControls"),this.svgGroup&&ce(this.svgGroup);for(const e of this.boundEvents)ne(e);this.boundEvents.length=0}getBoundingRectangle(){let e=this.SMALL_SPACING+2*this.HEIGHT;return this.zoomResetGroup&&(e+=this.LARGE_SPACING+this.HEIGHT),new Q(this.top,this.top+e,this.left,this.left+this.WIDTH)}position(e,o){if(this.initialized){var h,i=Mn(this.workspace,e),s=this.SMALL_SPACING+2*this.HEIGHT;if(this.zoomResetGroup&&(s+=this.LARGE_SPACING+this.HEIGHT),e=Rn(i,new ee(this.WIDTH,s),this.MARGIN_HORIZONTAL,this.MARGIN_VERTICAL,e,this.workspace),o=Nn(e,this.MARGIN_VERTICAL,(i=i.vertical)===Ui.TOP?Ys.DOWN:Ys.UP,o),i===Ui.TOP){var l,n=this.SMALL_SPACING+this.HEIGHT;null==(l=this.zoomInGroup)||l.setAttribute("transform","translate(0, "+n+")"),this.zoomResetGroup&&this.zoomResetGroup.setAttribute("transform","translate(0, "+(n+this.LARGE_SPACING+this.HEIGHT)+")")}else{let $;l=this.zoomResetGroup?this.LARGE_SPACING+this.HEIGHT:0,null==($=this.zoomInGroup)||$.setAttribute("transform","translate(0, "+l+")"),l=l+this.SMALL_SPACING+this.HEIGHT,null==(n=this.zoomOutGroup)||n.setAttribute("transform","translate(0, "+l+")")}this.top=o.top,this.left=o.left,null==(h=this.svgGroup)||h.setAttribute("transform","translate("+this.left+","+this.top+")")}}createZoomOutSvg(e){this.zoomOutGroup=I(v.G,{class:"blocklyZoom blocklyZoomOut"},this.svgGroup);const o=I(v.CLIPPATH,{id:"blocklyZoomoutClipPath"+e},this.zoomOutGroup);I(v.RECT,{width:32,height:32},o),I(v.IMAGE,{width:dt_width,height:dt_height,x:-64,y:-92,"clip-path":"url(#blocklyZoomoutClipPath"+e+")"},this.zoomOutGroup).setAttributeNS(It,"xlink:href",this.workspace.options.pathToMedia+dt_url),this.boundEvents.push(U(this.zoomOutGroup,"pointerdown",null,this.zoom.bind(this,-1)))}createZoomInSvg(e){this.zoomInGroup=I(v.G,{class:"blocklyZoom blocklyZoomIn"},this.svgGroup);const o=I(v.CLIPPATH,{id:"blocklyZoominClipPath"+e},this.zoomInGroup);I(v.RECT,{width:32,height:32},o),I(v.IMAGE,{width:dt_width,height:dt_height,x:-32,y:-92,"clip-path":"url(#blocklyZoominClipPath"+e+")"},this.zoomInGroup).setAttributeNS(It,"xlink:href",this.workspace.options.pathToMedia+dt_url),this.boundEvents.push(U(this.zoomInGroup,"pointerdown",null,this.zoom.bind(this,1)))}zoom(e,o){this.workspace.markFocused(),this.workspace.zoomCenter(e),this.fireZoomEvent(),qe(),o.stopPropagation(),o.preventDefault()}createZoomResetSvg(e){this.zoomResetGroup=I(v.G,{class:"blocklyZoom blocklyZoomReset"},this.svgGroup);const o=I(v.CLIPPATH,{id:"blocklyZoomresetClipPath"+e},this.zoomResetGroup);I(v.RECT,{width:32,height:32},o),I(v.IMAGE,{width:dt_width,height:dt_height,y:-92,"clip-path":"url(#blocklyZoomresetClipPath"+e+")"},this.zoomResetGroup).setAttributeNS(It,"xlink:href",this.workspace.options.pathToMedia+dt_url),this.boundEvents.push(U(this.zoomResetGroup,"pointerdown",null,this.resetZoom.bind(this)))}resetZoom(e){this.workspace.markFocused();const o=Math.log(this.workspace.options.zoomOptions.startScale/this.workspace.scale)/Math.log(this.workspace.options.zoomOptions.scaleSpeed);this.workspace.beginCanvasTransition(),this.workspace.zoomCenter(o),this.workspace.scrollCenter(),setTimeout(this.workspace.endCanvasTransition.bind(this.workspace),500),this.fireZoomEvent(),qe(),e.stopPropagation(),e.preventDefault()}fireZoomEvent(){const e=new(B(E.CLICK))(null,this.workspace.id,"zoom_controls");L(e)}};Dt("\n.blocklyZoom>image, .blocklyZoom>svg>image {\n  opacity: .4;\n}\n\n.blocklyZoom>image:hover, .blocklyZoom>svg>image:hover {\n  opacity: .6;\n}\n\n.blocklyZoom>image:active, .blocklyZoom>svg>image:active {\n  opacity: .8;\n}\n");var H_={BLOCKS:50,PROCEDURES:75,VARIABLES:100,WORKSPACE_COMMENTS:25},gp={};gp.register=_s,gp.unregister=Kc;var Fm=class{constructor(){this.priority=25}save(e){const o=[];for(const i of e.getTopComments())(e=qo(i,{addCoordinates:!0,saveIds:!0}))&&o.push(e);return o.length?o:null}load(e,o){for(const i of e)bs(i,o,{recordUndo:Ze()})}clear(e){for(const o of e.getTopComments())o.dispose()}};_s("workspaceComments",new Fm);var Cu={};Cu.WorkspaceCommentSerializer=Fm,Cu.append=bs,Cu.save=qo;var mp={};mp.register=Dn,mp.unregister=Ei;var rc=class{paste(e,o,i){let s;e=e.commentState,i&&(e.x=i.x,e.y=i.y),t.disable$$module$build$src$core$events$utils();try{s=bs(e,o),Jc(s)}finally{t.enable$$module$build$src$core$events$utils()}return s?(_e()&&L(new(B(E.COMMENT_CREATE))(s)),t.getFocusManager$$module$build$src$core$focus_manager().focusNode(s),s):null}};rc.TYPE="workspace-comment",Dn(rc.TYPE,new rc),t.config$$module$build$src$core$config={dragRadius:5,flyoutDragRadius:10,snapRadius:28,connectingSnapRadius:28,currentConnectionPreference:8,bumpDelay:250};var wt,q_="aria-",W_="role";!function(e){e.GRID="grid",e.GRIDCELL="gridcell",e.GROUP="group",e.LISTBOX="listbox",e.MENU="menu",e.MENUITEM="menuitem",e.MENUITEMCHECKBOX="menuitemcheckbox",e.OPTION="option",e.PRESENTATION="presentation",e.ROW="row",e.TREE="tree",e.TREEITEM="treeitem",e.SEPARATOR="separator",e.STATUS="status"}(wt||(wt={}));var Fe=function(e){return e.ACTIVEDESCENDANT="activedescendant",e.COLCOUNT="colcount",e.DISABLED="disabled",e.EXPANDED="expanded",e.INVALID="invalid",e.LABEL="label",e.LABELLEDBY="labelledby",e.LEVEL="level",e.ORIENTATION="orientation",e.POSINSET="posinset",e.ROWCOUNT="rowcount",e.SELECTED="selected",e.SETSIZE="setsize",e.VALUEMAX="valuemax",e.VALUEMIN="valuemin",e.LIVE="live",e.HIDDEN="hidden",e}(Fe||{}),lc={};lc.Role=wt,lc.State=Fe,lc.setRole=Yt,lc.setState=De;var cc=class{constructor(e,o){this.content=e,this.opt_value=o,this.enabled=!0,this.element=null,this.rightToLeft=!1,this.roleName=null,this.highlight=this.checked=this.checkable=!1,this.actionHandler=null}createDom(){const e=document.createElement("div");e.id=ct(),this.element=e,e.className="blocklyMenuItem "+(this.enabled?"":"blocklyMenuItemDisabled ")+(this.checked?"blocklyMenuItemSelected ":"")+(this.highlight?"blocklyMenuItemHighlight ":"")+(this.rightToLeft?"blocklyMenuItemRtl ":"");const o=document.createElement("div");if(o.className="blocklyMenuItemContent",this.checkable){var i=document.createElement("div");i.className="blocklyMenuItemCheckbox ",o.appendChild(i)}return i=this.content,"string"==typeof this.content&&(i=document.createTextNode(this.content)),o.appendChild(i),e.appendChild(o),this.roleName&&Yt(e,this.roleName),De(e,Fe.SELECTED,this.checkable&&this.checked||!1),De(e,Fe.DISABLED,!this.enabled),e}dispose(){this.element=null}getElement(){return this.element}getId(){return this.element.id}getValue(){let e;return null!=(e=this.opt_value)?e:null}setRightToLeft(e){this.rightToLeft=e}setRole(e){this.roleName=e}setCheckable(e){this.checkable=e}setChecked(e){this.checked=e}setHighlighted(e){this.highlight=e;const o=this.getElement();o&&this.isEnabled()&&(e?R(o,"blocklyMenuItemHighlight"):te(o,"blocklyMenuItemHighlight"))}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}performAction(e){this.isEnabled()&&this.actionHandler&&this.actionHandler(this,e)}onAction(e,o){this.actionHandler=e.bind(o)}},ku=class{constructor(){this.menuItems=[],this.roleName=this.element=this.onKeyDownHandler=this.pointerLeaveHandler=this.pointerEnterHandler=this.clickHandler=this.pointerMoveHandler=this.highlightedItem=this.openingCoords=null}addChild(e){this.menuItems.push(e)}render(e){const o=document.createElement("div");o.className="blocklyMenu",o.tabIndex=0,this.roleName&&Yt(o,this.roleName),this.element=o;for(let s,i=0;s=this.menuItems[i];i++)o.appendChild(s.createDom());return this.pointerMoveHandler=U(o,"pointermove",this,this.handlePointerMove,!0),this.clickHandler=U(o,"pointerup",this,this.handleClick,!0),this.pointerEnterHandler=U(o,"pointerenter",this,this.handlePointerEnter,!0),this.pointerLeaveHandler=U(o,"pointerleave",this,this.handlePointerLeave,!0),this.onKeyDownHandler=U(o,"keydown",this,this.handleKeyEvent),e.appendChild(o),o}getElement(){return this.element}focus(){const e=this.getElement();e&&e.focus({preventScroll:!0})}blur(){const e=this.getElement();e&&e.blur()}setRole(e){this.roleName=e}dispose(){this.pointerMoveHandler&&(ne(this.pointerMoveHandler),this.pointerMoveHandler=null),this.clickHandler&&(ne(this.clickHandler),this.clickHandler=null),this.pointerEnterHandler&&(ne(this.pointerEnterHandler),this.pointerEnterHandler=null),this.pointerLeaveHandler&&(ne(this.pointerLeaveHandler),this.pointerLeaveHandler=null),this.onKeyDownHandler&&(ne(this.onKeyDownHandler),this.onKeyDownHandler=null);for(let o,e=0;o=this.menuItems[e];e++)o.dispose();this.element=null}getMenuItem(e){const o=this.getElement();for(;e&&e!==o;){if(e.classList.contains("blocklyMenuItem")){const i=this.getMenuItems();for(let n,s=0;n=i[s];s++)if(n.getElement()===e)return n}e=e.parentElement}return null}setHighlighted(e){var o=this.highlightedItem;if(o&&(o.setHighlighted(!1),this.highlightedItem=null),e){e.setHighlighted(!0),this.highlightedItem=e,o=this.getElement();const i=e.getElement();o&&i&&(Yr(i,o),De(o,Fe.ACTIVEDESCENDANT,e.getId()))}}highlightNext(){const e=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(e,1)}highlightPrevious(){const e=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(e<0?this.menuItems.length:e,-1)}highlightFirst(){this.highlightHelper(-1,1)}highlightLast(){this.highlightHelper(this.menuItems.length,-1)}highlightHelper(e,o){let i;e+=o;const s=this.getMenuItems();for(;i=s[e];){if(i.isEnabled()){this.setHighlighted(i);break}e+=o}}handlePointerMove(e){0!==Math.max(Math.abs(e.movementX),Math.abs(e.movementY))&&(e=this.getMenuItem(e.target))&&(e.isEnabled()?this.highlightedItem!==e&&this.setHighlighted(e):this.setHighlighted(null))}handleClick(e){var o=this.openingCoords;if(this.openingCoords=null,o&&"number"==typeof e.clientX){const i=new A(e.clientX,e.clientY);if(A.distance(o,i)<1)return}(o=this.getMenuItem(e.target))&&o.performAction(e)}handlePointerEnter(e){this.focus()}handlePointerLeave(e){this.getElement()&&this.setHighlighted(null)}handleKeyEvent(e){if(this.menuItems.length&&!(e.shiftKey||e.ctrlKey||e.metaKey||e.altKey)){var o=this.highlightedItem;switch(e.key){case"Enter":case" ":o&&o.performAction(e);break;case"ArrowUp":this.highlightPrevious();break;case"ArrowDown":this.highlightNext();break;case"PageUp":case"Home":this.highlightFirst();break;case"PageDown":case"End":this.highlightLast();break;default:return}e.preventDefault(),e.stopPropagation()}}getSize(){const e=this.getElement(),o=gs(e);return o.height=e.scrollHeight,o}getMenuItems(){return this.menuItems.filter(e=>e instanceof cc)}},_p=class{constructor(){this.element=null}createDom(){return this.element=document.createElement("hr"),this.element.className="blocklyMenuSeparator",Yt(this.element,wt.SEPARATOR),this.element}dispose(){let e;null==(e=this.element)||e.remove(),this.element=null}},yr="_TEMP_COLLAPSED_INPUT",ac="_TEMP_COLLAPSED_FIELD",Gt="MANUALLY_DISABLED",X_={COLLAPSED_FIELD_NAME:ac,COLLAPSED_INPUT_NAME:yr,MANUALLY_DISABLED:Gt};!function(e){e[e.VALUE=1]="VALUE",e[e.STATEMENT=3]="STATEMENT",e[e.DUMMY=5]="DUMMY",e[e.CUSTOM=6]="CUSTOM",e[e.END_ROW=7]="END_ROW"}(t.inputTypes$$module$build$src$core$inputs$input_types||(t.inputTypes$$module$build$src$core$inputs$input_types={}));var Ep,Zm,Iu=new Set,bp=new WeakSet,fp=new WeakMap,xr=null,Tp=null,Um=0,wu={};wu.finishQueuedRenders=Xt,wu.queueRender=Qc,wu.triggerQueuedRenders=Wo,t.Msg$$module$build$src$core$msg=Object.create(null),Ep=function(e){Object.keys(e).forEach(function(o){t.Msg$$module$build$src$core$msg[o]=e[o]})},Zm={Msg:t.Msg$$module$build$src$core$msg,setLocale:Ep};var uc="blocklyToast",Hm="blocklyToastMessage",Gm="blocklyToastCloseButton",Zi=class{static show(e,o){if(o.oncePerSession&&o.id){if(this.shownIds.has(o.id))return;this.shownIds.add(o.id)}this.hide(e);const i=this.createDom(e,o);requestAnimationFrame(()=>{i.style.bottom="2rem"})}static createDom(e,o){const{message:i,duration:s=5,assertiveness:n=Zi.Assertiveness.POLITE}=o,l=document.createElement("div");e.getInjectionDiv().appendChild(l),l.dataset.toastId=o.id,l.className=uc,Yt(l,wt.STATUS),De(l,Fe.LIVE,n),(o=l.appendChild(document.createElement("div"))).className=Hm,o.innerText=i,(o=l.appendChild(document.createElement("button"))).className=Gm,De(o,Fe.LABEL,t.Msg$$module$build$src$core$msg.CLOSE);var h=I(v.SVG,{width:24,height:24,viewBox:"0 0 24 24",fill:"none"},o);let $;return De(h,Fe.HIDDEN,!0),I(v.RECT,{x:19.7782,y:2.80762,width:2,height:24,transform:"rotate(45, 19.7782, 2.80762)",fill:"black"},h),I(v.RECT,{x:2.80762,y:4.22183,width:2,height:24,transform:"rotate(-45, 2.80762, 4.22183)",fill:"black"},h),o.addEventListener("click",()=>{l.remove(),e.markFocused()}),o=()=>{$=setTimeout(()=>l.remove(),1e3*s)},l.addEventListener("focusin",h=()=>clearTimeout($)),l.addEventListener("focusout",o),l.addEventListener("mouseenter",h),l.addEventListener("mousemove",h),l.addEventListener("mouseleave",o),o(),l}static hide(e,o){(e=e.getInjectionDiv().querySelector(`.${uc}`))instanceof HTMLElement&&(!o||o===e.dataset.toastId)&&e.remove()}};Zi.shownIds=new Set,function(e){(e=e.Assertiveness||(e.Assertiveness={})).ASSERTIVE="assertive",e.POLITE="polite"}(Zi||(Zi={})),Dt(`\n.${uc} {\n  font-size: 1.2rem;\n  position: absolute;\n  bottom: -10rem;\n  right: 2rem;\n  padding: 1rem;\n  color: black;\n  background-color: white;\n  border: 2px solid black;\n  border-radius: 0.4rem;\n  z-index: 999;\n  display: flex;\n  align-items: center;\n  gap: 0.8rem;\n  line-height: 1.5;\n  transition: bottom 0.3s ease-out;\n}\n\n.${uc} .${Hm} {\n  maxWidth: 18rem;\n}\n\n.${uc} .${Gm} {\n  margin: 0;\n  padding: 0.2rem;\n  background-color: transparent;\n  color: black;\n  border: none;\n  cursor: pointer;\n}\n`);var Vm=function(e,o){window.alert(e),o&&o()},qm=Vm,Wm=function(e,o){o(window.confirm(e))},zm=Wm,jm=function(e,o,i){i(window.prompt(e,o))},Ym=jm,Xm=Zi.show.bind(Zi),Km=Xm,ii={};ii.alert=Ln,ii.confirm=il,ii.prompt=sl,ii.setAlert=Wd,ii.setConfirm=zd,ii.setPrompt=jd,ii.setToast=Xd,ii.toast=Yd;var Jm={};Jm.isLegacyProcedureCallBlock=ia,Jm.isLegacyProcedureDefBlock=vi;var Qm=new Set,e$={};e$.warn=ze;var Au="VARIABLE",vp="ijkmnopqrstuvwxyzabcdefgh",t$={generateUniqueNameInternal:Jd},Le={CATEGORY_NAME:Au,TEST_ONLY:t$,VAR_LETTER_OPTIONS:vp};Le.allDeveloperVariables=t.allDeveloperVariables$$module$build$src$core$variables,Le.allUsedVarModels=t.allUsedVarModels$$module$build$src$core$variables,Le.compareByName=Ts,Le.createVariableButtonHandler=yi,Le.deleteVariable=t.deleteVariable$$module$build$src$core$variables,Le.flyoutCategory=sa,Le.flyoutCategoryBlocks=na,Le.generateUniqueName=ra,Le.generateUniqueNameFromOptions=al,Le.generateVariableFieldDom=xi,Le.getAddedVariables=Bn,Le.getOrCreateVariablePackage=t.getOrCreateVariablePackage$$module$build$src$core$variables,Le.getVariable=t.getVariable$$module$build$src$core$variables,Le.getVariableUsesById=Es,Le.internalFlyoutCategory=rl,Le.jsonFlyoutCategoryBlocks=cl,Le.nameUsedWithAnyType=la,Le.nameUsedWithConflictingParam=ca,Le.promptName=ul,Le.renameVariable=t.renameVariable$$module$build$src$core$variables;var Cr=class extends Error{},o$=class extends Cr{constructor(e){super("Expected to find a 'type' property, defining the block type"),this.state=e}},dc=class extends Cr{constructor(e,o,i){super(`The block ${o.toDevString()} is missing a(n) ${e}\nconnection`),this.block=o,this.state=i}},i$=class extends Cr{constructor(e,o,i,s){super(`The block ${i.toDevString()} could not connect its\n${o} to its parent, because: ${e}`),this.childBlock=i,this.childState=s}},s$=class extends Cr{constructor(e){super("Encountered a real block which is defined as a child of a shadow\nblock. It is an invariant of Blockly that shadow blocks only have shadow\nchildren"),this.state=e}},n$=class extends Cr{constructor(e,o,i){super(`Cannot add an icon of type '${e}' to the block ${o.toDevString()}, because there is no icon registered with type '${e}'. Make sure that all of your icons have been registered.`),this.block=o,this.state=i}},Ks={};Ks.BadConnectionCheck=i$,Ks.DeserializationError=Cr,Ks.MissingBlockType=o$,Ks.MissingConnection=dc,Ks.RealChildOfShadow=s$,Ks.UnregisteredIcon=n$;var r$=class{constructor(){this.priority=50}save(e){const o=[];for(const i of e.getTopBlocks(!1))(e=Tt(i,{addCoordinates:!0,doFullSerialization:!1}))&&o.push(e);return o.length?{languageVersion:0,blocks:o}:null}load(e,o){e=e.blocks;for(const i of e)zo(i,o,{recordUndo:Ze()})}clear(e){for(const o of e.getTopBlocks(!1))o.dispose(!1)}};_s("blocks",new r$);var hc={};hc.BlockSerializer=r$,hc.append=zo,hc.appendInternal=vs,hc.save=Tt;var Ue=class{constructor(e){this.name=e}toString(){return this.name}equals(e){return this.name===e.toString()}};Ue.MUTATOR=new Ue("mutator"),Ue.WARNING=new Ue("warning"),Ue.COMMENT=new Ue("comment");var Hi=class extends zs{constructor(e){super(),this.isBlank=!e,e&&(this.blockId=e.id,this.workspaceId=e.workspace.id)}toJson(){const e=super.toJson();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");return e.blockId=this.blockId,e}static fromJson(e,o,i){return(o=super.fromJson(e,o,i??new Hi)).blockId=e.blockId,o}},Gi=class extends Hi{constructor(e,o,i,s,n){super(e),this.type=E.BLOCK_CHANGE,e&&(this.element=o,this.name=i||void 0,this.oldValue=s,this.newValue=n)}toJson(){const e=super.toJson();if(!this.element)throw Error("The changed element is undefined. Either pass an element to the constructor, or call fromJson");return e.element=this.element,e.name=this.name,e.oldValue=this.oldValue,e.newValue=this.newValue,this.disabledReason&&(e.disabledReason=this.disabledReason),e}static fromJson(e,o,i){return(o=super.fromJson(e,o,i??new Gi)).element=e.element,o.name=e.name,o.oldValue=e.oldValue,o.newValue=e.newValue,void 0!==e.disabledReason&&(o.disabledReason=e.disabledReason),o}setDisabledReason(e){if("disabled"!==this.element)throw Error('Cannot set the disabled reason for a BlockChange event if the element is not "disabled".');this.disabledReason=e}isNull(){return this.oldValue===this.newValue}run(e){var o=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");if(!(o=o.getBlockById(this.blockId)))throw Error("The associated block is undefined. Either pass a block to the constructor, or call fromJson");const i=o.getIcon(Ue.MUTATOR);switch(i&&jo(i)&&i.bubbleIsVisible()&&i.setBubbleVisible(!1),e=e?this.newValue:this.oldValue,this.element){case"field":(o=o.getField(this.name))?o.setValue(e):console.warn("Can't set non-existent field: "+this.name);break;case"comment":o.setCommentText(e||null);break;case"collapsed":o.setCollapsed(!!e);break;case"disabled":var s;o.setDisabledReason(!!e,null!=(s=this.disabledReason)?s:Gt);break;case"inline":o.setInputsInline(!!e);break;case"mutation":s=Gi.getExtraBlockState_(o),o.loadExtraState?o.loadExtraState(JSON.parse(e||"{}")):o.domToMutation&&o.domToMutation(t.textToDom$$module$build$src$core$utils$xml(e||"<mutation/>")),L(new Gi(o,"mutation",null,s,e));break;default:console.warn("Unknown change type: "+this.element)}}static getExtraBlockState_(e){return e.saveExtraState?(e=e.saveExtraState(!0))?JSON.stringify(e):"":e.mutationToDom&&(e=e.mutationToDom())?Bt(e):""}};D(w.EVENT,E.BLOCK_CHANGE,Gi);var Su={};Su.clamp=ys,Su.toDegrees=Th,Su.toRadians=dl;var Re,gc,Qs,pc=16,yp=1,l$=12,xp=16,Ou=.25,Cp=null,Js=null,c$="",a$="",kp=null,Vi=null,u$=null,Ru=null,Mu=null,Nu={getBoundsInfo:function(){const e=vo(kp),o=gs(kp);return{left:e.x,right:e.x+o.width,top:e.y,bottom:e.y+o.height,width:o.width,height:o.height}},getPositionMetrics:function(e,o,i,s){const n=Nu.getBoundsInfo(),l=gs(Re);return o+l.height<n.bottom?Ta(e,o,n,l):s-l.height>n.top?Ea(i,s,n,l):o+l.height<document.documentElement.clientHeight?Ta(e,o,n,l):s-l.height>document.documentElement.clientTop?Ea(i,s,n,l):vh(e,n,l)}},st={ANIMATION_TIME:Ou,ARROW_HORIZONTAL_PADDING:l$,ARROW_SIZE:pc,BORDER_SIZE:yp,PADDING_Y:xp,TEST_ONLY:Nu};st.clearContent=gl,st.createDom=hl,st.getContentDiv=pl,st.getOwner=pa,st.getPositionX=Pn,st.hide=$l,st.hideIfOwner=ml,st.hideWithoutAnimation=Kt,st.isVisible=va,st.repositionForWindowResize=xa,st.setBoundsElement=ha,st.setColour=ga,st.show=fa,st.showPositionedByBlock=Eh,st.showPositionedByField=ma;var kr={};kr.commonWordPrefix=Ca,kr.commonWordSuffix=ka,kr.isNumber=t.isNumber$$module$build$src$core$utils$string,kr.shortestStringLength=Fn,kr.wrap=t.wrap$$module$build$src$core$utils$string;var Du=void 0,mc=!1,Ir=!1,d$=50,h$=0,en=0,Ip=0,wp=0,Vt=null,$c=null,Ap=0,Sp=10,p$=10,g$=750,Lu=5,Ge=null,At={HOVER_MS:g$,LIMIT:d$,MARGINS:Lu,OFFSET_X:Ap,OFFSET_Y:Sp,RADIUS_OK:p$};At.bindMouseEvents=Un,At.block=Ma,At.createDom=Sa,At.dispose=Ra,At.getCustomTooltip=Ch,At.getDiv=Ih,At.getTooltipOfObject=xs,At.hide=xo,At.isVisible=kh,At.setCustomTooltip=xh,At.unbindMouseEvents=bl,At.unblock=Na;var Op=.45,Rp=.65,m$={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00"},qt={};qt.blend=ki,qt.getHsvSaturation=Da,qt.getHsvValue=La,qt.hexToRgb=fl,qt.hsvToHex=Tl,qt.hueToHex=Ba,qt.names=m$,qt.parse=Ci,qt.rgbToHex=Zn,qt.setHsvSaturation=Cs,qt.setHsvValue=Nh;var _c={};_c.checkMessageReferences=Dh,_c.parseBlockColour=ks,_c.replaceMessageReferences=Ae,_c.tokenizeInterpolation=Hn;var ue=class{get size_(){return this.size}set size_(e){this.size=e}constructor(e,o,i){this.DEFAULT_VALUE=null,this.name=void 0,this.tooltip=this.validator_=null,this.size=new ee(0,0),this.constants_=this.mouseDownWrapper=this.textContent_=this.textElement_=this.borderRect_=this.fieldGroup_=null,this.disposed=!1,this.maxDisplayLength=50,this.sourceBlock_=null,this.enabled_=this.visible_=this.isDirty_=!0,this.suffixField=this.prefixField=this.clickTarget_=null,this.EDITABLE=!0,this.SERIALIZABLE=!1,this.id_=null,this.value_="DEFAULT_VALUE"in new.target.prototype?new.target.prototype.DEFAULT_VALUE:this.DEFAULT_VALUE,this.size_=new ee(0,0),e!==ue.SKIP_SETUP&&(i&&this.configure_(i),this.setValue(e),o&&this.setValidator(o))}configure_(e){e.tooltip&&this.setTooltip(Ae(e.tooltip))}setSourceBlock(e){if(this.sourceBlock_)throw Error("Field already bound to a block");if(this.sourceBlock_=e,e.id.includes("_field"))throw Error(`Field ID indicator is contained in block ID. This may cause problems with focus: ${e.id}.`);this.id_=`${e.id}_field_${ct()}`}getConstants(){return!this.constants_&&this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&this.sourceBlock_.workspace.rendered&&(this.constants_=this.sourceBlock_.workspace.getRenderer().getConstants()),this.constants_}getSourceBlock(){return this.sourceBlock_}init(){if(!this.fieldGroup_){var e=this.id_;if(!e)throw Error("Expected ID to be defined prior to init.");this.fieldGroup_=I(v.G,{id:e}),this.isVisible()||(this.fieldGroup_.style.display="none"),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.initView(),this.updateEditable(),this.setTooltip(this.tooltip),this.bindEvents_(),this.initModel(),this.applyColour()}}initView(){this.createBorderRect_(),this.createTextElement_(),this.fieldGroup_&&R(this.fieldGroup_,"blocklyField")}initModel(){}isFullBlockField(){return!this.borderRect_}createBorderRect_(){this.borderRect_=I(v.RECT,{rx:this.getConstants().FIELD_BORDER_RECT_RADIUS,ry:this.getConstants().FIELD_BORDER_RECT_RADIUS,x:0,y:0,height:this.size_.height,width:this.size_.width,class:"blocklyFieldRect"},this.fieldGroup_)}createTextElement_(){this.textElement_=I(v.TEXT,{class:"blocklyText blocklyFieldText"},this.fieldGroup_),this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.textElement_.setAttribute("dominant-baseline","central"),this.textContent_=document.createTextNode(""),this.textElement_.appendChild(this.textContent_)}bindEvents_(){const e=this.getClickTarget_();if(!e)throw Error("A click target has not been set.");Un(e),this.mouseDownWrapper=U(e,"pointerdown",this,this.onMouseDown_)}fromXml(e){this.setValue(e.textContent)}toXml(e){return e.textContent=this.getValue(),e}saveState(e){return null!==(e=this.saveLegacyState(ue))?e:this.getValue()}loadState(e){this.loadLegacyState(ue,e)||this.setValue(e)}saveLegacyState(e){return e.prototype.saveState===this.saveState&&e.prototype.toXml!==this.toXml?((e=t.createElement$$module$build$src$core$utils$xml("field")).setAttribute("name",this.name||""),Ti(this.toXml(e)).replace(' xmlns="https://developers.google.com/blockly/xml"',"")):null}loadLegacyState(e,o){return e.prototype.loadState===this.loadState&&e.prototype.fromXml!==this.fromXml&&(this.fromXml(t.textToDom$$module$build$src$core$utils$xml(o)),!0)}dispose(){let e;ml(this),Ii(this),null!=(e=this.getSourceBlock())&&e.isDeadOrDying()||ce(this.fieldGroup_),this.disposed=!0}updateEditable(){const e=this.fieldGroup_,o=this.getSourceBlock();this.EDITABLE&&e&&o&&(this.enabled_&&o.isEditable()?(R(e,"blocklyEditableField"),te(e,"blocklyNonEditableField")):(R(e,"blocklyNonEditableField"),te(e,"blocklyEditableField")))}setEnabled(e){this.enabled_=e,this.updateEditable()}isEnabled(){return this.enabled_}isClickable(){return this.enabled_&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()&&this.showEditor_!==ue.prototype.showEditor_}isClickableInFlyout(e){return!e}isCurrentlyEditable(){return this.enabled_&&this.EDITABLE&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()}isSerializable(){let e=!1;return this.name&&(this.SERIALIZABLE?e=!0:this.EDITABLE&&(console.warn("Detected an editable field that was not serializable. Please define SERIALIZABLE property as true on all editable custom fields. Proceeding with serialization."),e=!0)),e}isVisible(){return this.visible_}setVisible(e){if(this.visible_!==e){this.visible_=e;var o=this.fieldGroup_;o&&(o.style.display=e?"block":"none")}}setValidator(e){this.validator_=e}getValidator(){return this.validator_}getSvgRoot(){return this.fieldGroup_}getBorderRect(){if(!this.borderRect_)throw Error(`The border rectangle is ${this.borderRect_}.`);return this.borderRect_}getTextElement(){if(!this.textElement_)throw Error(`The text element is ${this.textElement_}.`);return this.textElement_}getTextContent(){if(!this.textContent_)throw Error(`The text content is ${this.textContent_}.`);return this.textContent_}applyColour(){}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_()}showEditor(e){this.isClickable()&&this.showEditor_(e)}showEditor_(e){}repositionForWindowResize(){return!1}updateSize_(e){const o=this.getConstants();let i=2*(e=void 0!==e?e:this.isFullBlockField()?0:this.getConstants().FIELD_BORDER_RECT_X_PADDING),s=o.FIELD_TEXT_HEIGHT,n=0;this.textElement_&&(n=O(this.textElement_),i+=n),this.isFullBlockField()||(s=Math.max(s,o.FIELD_BORDER_RECT_HEIGHT)),this.size_.height=s,this.size_.width=i,this.positionTextElement_(e,n),this.positionBorderRect_()}positionTextElement_(e,o){if(this.textElement_){var n,i=this.getConstants(),s=this.size_.height/2;this.textElement_.setAttribute("x",String(null!=(n=this.getSourceBlock())&&n.RTL?this.size_.width-o-e:e)),this.textElement_.setAttribute("y",String(i.FIELD_TEXT_BASELINE_CENTER?s:s-i.FIELD_TEXT_HEIGHT/2+i.FIELD_TEXT_BASELINE))}}positionBorderRect_(){this.borderRect_&&(this.borderRect_.setAttribute("width",String(this.size_.width)),this.borderRect_.setAttribute("height",String(this.size_.height)),this.borderRect_.setAttribute("rx",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)),this.borderRect_.setAttribute("ry",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)))}getSize(){return this.isVisible()?(this.isDirty_&&(this.render_(),this.isDirty_=!1),this.size_):new ee(0,0)}getScaledBBox(){let e;var o=this.getSourceBlock();if(!o)throw new Me;if(this.isFullBlockField()){var i=this.sourceBlock_.getHeightWidth();const s=o.workspace.scale;e=this.getAbsoluteXY_(),o=(i.width+1)*s,i=(i.height+1)*s,gm?(e.x+=1.5*s,e.y+=1.5*s):(e.x-=.5*s,e.y-=.5*s)}else i=this.borderRect_.getBoundingClientRect(),e=vo(this.borderRect_),o=i.width,i=i.height;return new Q(e.y,e.y+i,e.x,e.x+o)}onLocationChange(e){}getDisplayText_(){let e=this.getText();return e.length>this.maxDisplayLength&&(e=e.substring(0,this.maxDisplayLength-2)+"\u2026"),e=e.replace(/\s/g,ue.NBSP),this.sourceBlock_&&this.sourceBlock_.RTL&&(e+="\u200f"),e}getText(){const e=this.getText_();return String(null!==e?e:this.getValue())}getText_(){return null}markDirty(){this.isDirty_=!0,this.constants_=null}forceRerender(){this.isDirty_=!0,this.sourceBlock_&&this.sourceBlock_.rendered&&this.sourceBlock_.queueRender()}setValue(e,o=!0){if(null!==e){var i=t.getGroup$$module$build$src$core$events$utils();i||t.setGroup$$module$build$src$core$events$utils(!0);try{const k=this.doClassValidation_(e),F=this.processValidation(e,k,o);if(!(F instanceof Error)){var s,n=null==(s=this.getValidator())?void 0:s.call(this,F),l=this.processValidation(F,n,o);if(!(l instanceof Error)){var h=this.sourceBlock_;if(!h||!h.disposed){var $=this.getValue();$===l?this.doValueUpdate_(l):(this.doValueUpdate_(l),o&&h&&_e()&&L(new(B(E.BLOCK_CHANGE))(h,"field",this.name||null,$,l)),this.isDirty_&&this.forceRerender())}}}}finally{t.setGroup$$module$build$src$core$events$utils(i)}}}processValidation(e,o,i){return null===o?(this.doValueInvalid_(e,i),this.isDirty_&&this.forceRerender(),Error()):void 0===o?e:o}getValue(){return this.value_}doClassValidation_(e){return e??null}doValueUpdate_(e){this.value_=e,this.isDirty_=!0}doValueInvalid_(e,o){}onMouseDown_(e){this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&(e=this.sourceBlock_.workspace.getGesture(e))&&e.setStartField(this)}setTooltip(e){e||""===e||(e=this.sourceBlock_);const o=this.getClickTarget_();o?o.tooltip=e:this.tooltip=e}getTooltip(){const e=this.getClickTarget_();return xs(e||{tooltip:this.tooltip})}getClickTarget_(){return this.clickTarget_||this.getSvgRoot()}getAbsoluteXY_(){return vo(this.getClickTarget_())}referencesVariables(){return!1}refreshVariableName(){}getParentInput(){let e=null;const o=this.getSourceBlock();if(!o)throw new Me;const i=o.inputList;for(let s=0;s<o.inputList.length;s++){const n=i[s],l=n.fieldRow;for(let h=0;h<l.length;h++)if(l[h]===this){e=n;break}}return e}getFlipRtl(){return!1}onShortcut(e){return!1}getFocusableElement(){if(!this.fieldGroup_)throw Error("This field currently has no representative DOM element.");return this.fieldGroup_}getFocusableTree(){const e=this.getSourceBlock();if(!e)throw new Me;return e.workspace}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}static fromJson(e){throw Error("Attempted to instantiate a field from the registry that hasn't defined a 'fromJson' method.")}};ue.NBSP="\xa0",ue.SKIP_SETUP=Symbol("SKIP_SETUP");var Me=class extends Error{constructor(){super("The field has not yet been attached to its input. Call appendField to attach it.")}},$$={};$$.Field=ue,$$.UnattachedFieldError=Me;var St,wr=null,_$=null,Bu=null,Mp="blocklyWidgetDiv",Ar="",Sr="",Pu=null,io={};io.createDom=Pa,io.getDiv=Is,io.hide=ws,io.hideIfOwner=Ii,io.hideIfOwnerIsInWorkspace=Gn,io.isVisible=Fa,io.positionWithAnchor=Za,io.repositionForWindowResize=Ha,io.show=vl,io.testOnly_setDiv=Lh;var Fu=null,b$={},Uu=null,tn={};tn.callbackFactory=t.callbackFactory$$module$build$src$core$contextmenu,tn.dispose=Va,tn.getCurrentBlock=Uh,tn.hide=qn,tn.setCurrentBlock=Ga,tn.show=As;var K=class{constructor(){this.registeredItems=new Map,this.reset()}reset(){this.registeredItems.clear()}register(e){if(this.registeredItems.has(e.id))throw Error('Menu item with ID "'+e.id+'" is already registered.');this.registeredItems.set(e.id,e)}unregister(e){if(!this.registeredItems.has(e))throw Error('Menu item with ID "'+e+'" not found.');this.registeredItems.delete(e)}getItem(e){let o;return null!=(o=this.registeredItems.get(e))?o:null}getContextMenuOptions(e,o){const i=[];for(const s of this.registeredItems.values()){if(s.scopeType&&(s.scopeType===Zu.BLOCK&&!e.block||s.scopeType===Zu.COMMENT&&!e.comment||s.scopeType===Zu.WORKSPACE&&!e.workspace))continue;let n;if(n={scope:e,weight:s.weight},s.separator)n=Object.assign({},n,{separator:!0});else{const l=s.preconditionFn(e,o);if("hidden"===l)continue;const h="function"==typeof s.displayText?s.displayText(e):s.displayText;n=Object.assign({},n,{text:h,callback:s.callback,enabled:"enabled"===l})}i.push(n)}return i.sort(function(s,n){return s.weight-n.weight}),i}};!function(e){var o=e.ScopeType||(e.ScopeType={});o.BLOCK="block",o.WORKSPACE="workspace",o.COMMENT="comment",e.registry=new e}(K||(K={}));var Zu=K.ScopeType,f$={};f$.ContextMenuRegistry=K,f$.ScopeType=Zu;var nb={BLOCK:50,BUBBLE:100},Np=class{constructor(e){this.comment=e,this.startLoc=null,this.workspace=e.workspace}isMovable(){return this.comment.isOwnMovable()&&!this.comment.isDeadOrDying()&&!this.workspace.isReadOnly()}startDrag(){let e;this.fireDragStartEvent(),this.startLoc=this.comment.getRelativeToSurfaceXY(),this.workspace.setResizesEnabled(!1),null==(e=this.workspace.getLayerManager())||e.moveToDragLayer(this.comment),this.comment.setDragging(!0)}drag(e){this.comment.moveDuringDrag(e)}endDrag(){let e;this.fireDragEndEvent(),this.fireMoveEvent(),null==(e=this.workspace.getLayerManager())||e.moveOffDragLayer(this.comment,50),this.comment.setDragging(!1),this.comment.snapToGrid(),this.workspace.setResizesEnabled(!0)}fireDragStartEvent(){const e=new(B(E.COMMENT_DRAG))(this.comment,!0);L(e)}fireDragEndEvent(){const e=new(B(E.COMMENT_DRAG))(this.comment,!1);L(e)}fireMoveEvent(){if(!this.comment.isDeadOrDying()){var e=new(B(E.COMMENT_MOVE))(this.comment);e.setReason(["drag"]),e.oldCoordinate_=this.startLoc,e.recordNew(),L(e)}}revertDrag(){this.startLoc&&this.comment.moveDuringDrag(this.startLoc)}},T$=new WeakMap,E$={};E$.move=Ss,E$.start=Yo;var bc=class{constructor(e,o,i){this.id=e,this.workspace=o,this.container=i}isVisible(){return this.icon.checkVisibility()}getParentComment(){const e=this.workspace.getCommentById(this.id);if(!e)throw Error(`Comment bar button ${this.id} has no corresponding comment`);return e}getSize(e=!1){var o=this.icon.getBBox();return o=Q.from(o),e&&(e=this.getMargin(),o.left-=e,o.top-=e,o.bottom+=e,o.right+=e),o}getMargin(){return(this.container.getBBox().height-this.icon.getBBox().height)/2}getFocusableElement(){return this.icon}getFocusableTree(){return this.workspace}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return this.isVisible()}},Dp="_collapse_bar_button",Lp=class extends bc{constructor(e,o,i){super(e,o,i),this.id=e,this.workspace=o,this.container=i,this.icon=I(v.IMAGE,{class:"blocklyFoldoutIcon",href:`${this.workspace.options.pathToMedia}foldout-icon.svg`,id:`${this.id}${Dp}`},this.container),this.bindId=U(this.icon,"pointerdown",this,this.performAction.bind(this))}dispose(){ne(this.bindId)}reposition(){const e=this.getMargin();this.icon.setAttribute("y",`${e}`),this.icon.setAttribute("x",`${e}`)}performAction(e){qe();const o=this.getParentComment();o.view.bringToFront(),e&&e instanceof PointerEvent&&_t(e)||(o.setCollapsed(!o.isCollapsed()),this.workspace.hideChaff()),e.stopPropagation()}};({COMMENT_COLLAPSE_BAR_BUTTON_FOCUS_IDENTIFIER:Dp}).CollapseCommentBarButton=Lp;var Gu="_comment_textarea_",Bp=class{constructor(e,o,i){this.workspace=e,this.onFinishEditing=i,this.textChangeListeners=[],this.text="",this.foreignObject=I(v.FOREIGNOBJECT,{class:"blocklyCommentForeignObject"}),(e=document.createElementNS(Ao,"body")).setAttribute("xmlns",Ao),e.className="blocklyMinimalBody",this.textArea=document.createElementNS(Ao,"textarea"),this.textArea.setAttribute("tabindex","-1"),R(this.textArea,"blocklyCommentText"),R(this.textArea,"blocklyTextarea"),R(this.textArea,"blocklyText"),e.appendChild(this.textArea),this.foreignObject.appendChild(e),o&&(this.id=o+Gu,this.textArea.setAttribute("id",this.id)),U(this.textArea,"change",this,this.onTextChange),U(this.textArea,"pointerdown",this,s=>{s.stopPropagation(),t.getFocusManager$$module$build$src$core$focus_manager().focusNode(this),qe()}),U(this.textArea,"keydown",this,this.handleKeyDown)}getDom(){return this.foreignObject}getText(){return this.text}setText(e){this.textArea.value=e,this.onTextChange()}onTextChange(){const e=this.text;this.text=this.textArea.value;for(let o=this.textChangeListeners.length-1;o>=0;o--)this.textChangeListeners[o](e,this.text)}handleKeyDown(e){("Escape"===e.key||"Enter"===e.key&&(e.ctrlKey||e.metaKey))&&(this.onFinishEditing&&this.onFinishEditing(),e.stopPropagation())}addTextChangeListener(e){this.textChangeListeners.push(e)}removeTextChangeListener(e){this.textChangeListeners.splice(this.textChangeListeners.indexOf(e),1)}setPlaceholderText(e){this.textArea.placeholder=e}setEditable(e){e?this.textArea.removeAttribute("readonly"):this.textArea.setAttribute("readonly","true")}updateSize(e,o){this.foreignObject.setAttribute("height",""+(e.height-o.height)),this.foreignObject.setAttribute("width",`${e.width}`),this.foreignObject.setAttribute("y",`${o.height}`),this.workspace.RTL&&this.foreignObject.setAttribute("x",""+-e.width)}getFocusableElement(){return this.textArea}getFocusableTree(){return this.workspace}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!!this.id}};({COMMENT_EDITOR_FOCUS_IDENTIFIER:Gu}).CommentEditor=Bp;var Pp="_delete_bar_button",Fp=class extends bc{constructor(e,o,i){super(e,o,i),this.id=e,this.workspace=o,this.container=i,this.icon=I(v.IMAGE,{class:"blocklyDeleteIcon",href:`${this.workspace.options.pathToMedia}delete-icon.svg`,id:`${this.id}${Pp}`},i),this.bindId=U(this.icon,"pointerdown",this,this.performAction.bind(this))}dispose(){ne(this.bindId)}reposition(){const e=this.getMargin();this.icon.setAttribute("x","0");const o=this.container.getBBox();this.icon.setAttribute("y",`${e}`),this.icon.setAttribute("x",""+(o.width-this.getSize(!0).getWidth()))}performAction(e){qe(),e&&e instanceof PointerEvent&&_t(e)?e.stopPropagation():(this.getParentComment().dispose(),e?.stopPropagation(),t.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.workspace))}};({COMMENT_DELETE_BAR_BUTTON_FOCUS_IDENTIFIER:Pp}).DeleteCommentBarButton=Fp;var Or=class{constructor(e,o){let i;this.workspace=e,this.commentId=o,this.collapsed=!1,this.editable=!0,this.location=new A(0,0),this.sizeChangeListeners=[],this.disposeListeners=[],this.collapseChangeListeners=[],this.resizePointerMoveListener=this.resizePointerUpListener=null,this.disposed=this.disposing=!1,this.svgRoot=I(v.G,{class:"blocklyComment blocklyEditable blocklyDraggable"}),this.highlightRect=this.createHighlightRect(this.svgRoot),({topBarGroup:this.topBarGroup,topBarBackground:this.topBarBackground,deleteButton:this.deleteButton,foldoutButton:this.foldoutButton,textPreview:this.textPreview,textPreviewNode:this.textPreviewNode}=this.createTopBar(this.svgRoot)),this.commentEditor=this.createTextArea(),this.resizeHandle=this.createResizeHandle(this.svgRoot,e),null==(i=e.getLayerManager())||i.append(this,50),this.size=Or.defaultCommentSize,this.setSizeWithoutFiringEvents(this.size),this.moveTo(new A(0,0))}createHighlightRect(e){return I(v.RECT,{class:"blocklyCommentHighlight"},e)}createTopBar(e){e=I(v.G,{class:"blocklyCommentTopbar"},e);const o=I(v.RECT,{class:"blocklyCommentTopbarBackground"},e),i=new Fp(this.commentId,this.workspace,e),s=new Lp(this.commentId,this.workspace,e),n=I(v.TEXT,{class:"blocklyCommentPreview blocklyCommentText blocklyText"},e),l=document.createTextNode("");return n.appendChild(l),{topBarGroup:e,topBarBackground:o,deleteButton:i,foldoutButton:s,textPreview:n,textPreviewNode:l}}createTextArea(){const e=new Bp(this.workspace,this.commentId,()=>this.svgRoot.focus());return this.svgRoot.appendChild(e.getDom()),e.addTextChangeListener((o,i)=>{this.updateTextPreview(i),this.setSize(this.size)}),e}getEditorFocusableNode(){return this.commentEditor}createResizeHandle(e,o){return e=I(v.IMAGE,{class:"blocklyResizeHandle",href:`${o.options.pathToMedia}resize-handle.svg`},e),U(e,"pointerdown",this,this.onResizePointerDown),e}getSvgRoot(){return this.svgRoot}getSize(){return this.collapsed?this.topBarBackground.getBBox():this.size}setSizeWithoutFiringEvents(e){const o=this.topBarBackground.getBBox(),i=this.textPreview.getBBox(),s=this.resizeHandle.getBBox();this.size=e=ee.max(e,this.calcMinSize(o)),this.svgRoot.setAttribute("height",`${e.height}`),this.svgRoot.setAttribute("width",`${e.width}`),this.updateHighlightRect(e),this.updateTopBarSize(e),this.commentEditor.updateSize(e,o),this.deleteButton.reposition(),this.foldoutButton.reposition(),this.updateTextPreviewSize(e,o,i),this.updateResizeHandlePosition(e,s)}setSize(e){const o=this.preResizeSize||this.size;this.setSizeWithoutFiringEvents(e),this.onSizeChange(o,this.size)}calcMinSize(e){var o;this.updateTextPreview(null!=(o=this.commentEditor.getText())?o:"");let i=o=O(this.textPreview);return this.foldoutButton.isVisible()?i+=this.foldoutButton.getSize(!0).getWidth():o&&(i+=4),this.deleteButton.isVisible()?i+=this.deleteButton.getSize(!0).getWidth():o&&(i+=4),new ee(i,e.height+20)}updateHighlightRect(e){this.highlightRect.setAttribute("height",`${e.height}`),this.highlightRect.setAttribute("width",`${e.width}`),this.workspace.RTL&&this.highlightRect.setAttribute("x",""+-e.width)}updateTopBarSize(e){this.topBarBackground.setAttribute("width",`${e.width}`)}updateTextPreviewSize(e,o,i){o=(o.height-i.height)/2;const s=this.foldoutButton.getSize(!0),n=this.deleteButton.getSize(!0);e=e.width-s.getWidth()-n.getWidth(),this.textPreview.setAttribute("x",`${s.getWidth()}`),this.textPreview.setAttribute("y",`${o+i.height/2}`),this.textPreview.setAttribute("width",`${e}`)}updateResizeHandlePosition(e,o){this.resizeHandle.setAttribute("y",""+(e.height-o.height)),this.resizeHandle.setAttribute("x",""+(e.width-o.width))}onSizeChange(e,o){for(let i=this.sizeChangeListeners.length-1;i>=0;i--)this.sizeChangeListeners[i](e,o)}addSizeChangeListener(e){this.sizeChangeListeners.push(e)}removeSizeChangeListener(e){this.sizeChangeListeners.splice(this.sizeChangeListeners.indexOf(e),1)}onResizePointerDown(e){this.isEditable()&&(this.bringToFront(),_t(e)||(this.preResizeSize=this.getSize(),Yo(this.workspace,e,new A(this.workspace.RTL?-this.getSize().width:this.getSize().width,this.getSize().height)),this.resizePointerUpListener=U(document,"pointerup",this,this.onResizePointerUp),this.resizePointerMoveListener=U(document,"pointermove",this,this.onResizePointerMove),this.workspace.hideChaff()),e.stopPropagation())}onResizePointerUp(e){qe(),this.resizePointerUpListener&&(ne(this.resizePointerUpListener),this.resizePointerUpListener=null),this.resizePointerMoveListener&&(ne(this.resizePointerMoveListener),this.resizePointerMoveListener=null),this.setSize(this.size),this.preResizeSize=void 0}onResizePointerMove(e){e=Ss(this.workspace,e),this.setSizeWithoutFiringEvents(new ee(this.workspace.RTL?-e.x:e.x,e.y))}isCollapsed(){return this.collapsed}setCollapsed(e){(this.collapsed=e)?R(this.svgRoot,"blocklyCollapsed"):te(this.svgRoot,"blocklyCollapsed"),this.setSizeWithoutFiringEvents(this.size),this.onCollapse()}onCollapse(){for(let e=this.collapseChangeListeners.length-1;e>=0;e--)this.collapseChangeListeners[e](this.collapsed)}addOnCollapseListener(e){this.collapseChangeListeners.push(e)}removeOnCollapseListener(e){this.collapseChangeListeners.splice(this.collapseChangeListeners.indexOf(e),1)}isEditable(){return this.editable}setEditable(e){(this.editable=e)?(R(this.svgRoot,"blocklyEditable"),te(this.svgRoot,"blocklyReadonly")):(te(this.svgRoot,"blocklyEditable"),R(this.svgRoot,"blocklyReadonly")),this.commentEditor.setEditable(e)}getRelativeToSurfaceXY(){return this.location}moveTo(e){this.location=e,this.svgRoot.setAttribute("transform",`translate(${e.x}, ${e.y})`)}getText(){return this.commentEditor.getText()}setText(e){this.commentEditor.setText(e)}setPlaceholderText(e){this.commentEditor.setPlaceholderText(e)}addTextChangeListener(e){this.commentEditor.addTextChangeListener(e)}removeTextChangeListener(e){this.commentEditor.removeTextChangeListener(e)}updateTextPreview(e){this.textPreviewNode.textContent=this.truncateText(e)}truncateText(e){return e.length>=12?`${e.substring(0,9)}...`:e}bringToFront(){const e=this.svgRoot.parentNode,o=e.childNodes;o[o.length-1]!==this.svgRoot&&e.appendChild(this.svgRoot)}onDeleteDown(e){qe(),_t(e)||this.dispose(),e.stopPropagation()}dispose(){this.disposing=!0,this.foldoutButton.dispose(),this.deleteButton.dispose(),ce(this.svgRoot);for(let e=this.disposeListeners.length-1;e>=0;e--)this.disposeListeners[e]();this.disposed=!0}isDisposed(){return this.disposed}isDeadOrDying(){return this.disposing||this.disposed}addDisposeListener(e){this.disposeListeners.push(e)}removeDisposeListener(e){this.disposeListeners.splice(this.disposeListeners.indexOf(e),1)}getCommentBarButtons(){return[this.foldoutButton,this.deleteButton]}};Or.defaultCommentSize=new ee(120,100),Dt("\n.injectionDiv {\n  --commentFillColour: #FFFCC7;\n  --commentBorderColour: #F2E49B;\n}\n\n.blocklyComment .blocklyTextarea {\n  background-color: var(--commentFillColour);\n  border: 1px solid var(--commentBorderColour);\n  box-sizing: border-box;\n  display: block;\n  outline: 0;\n  padding: 5px;\n  resize: none;\n  width: 100%;\n  height: 100%;\n}\n\n.blocklyReadonly.blocklyComment .blocklyTextarea {\n  cursor: inherit;\n}\n\n.blocklyDeleteIcon {\n  width: 20px;\n  height: 20px;\n  display: none;\n  cursor: pointer;\n}\n\n.blocklyFoldoutIcon {\n  width: 20px;\n  height: 20px;\n  transform-origin: 12px 12px;\n  cursor: pointer;\n}\n.blocklyResizeHandle {\n  width: 12px;\n  height: 12px;\n  cursor: se-resize;\n}\n.blocklyReadonly.blocklyComment .blocklyResizeHandle {\n  cursor: inherit;\n}\n\n.blocklyCommentTopbarBackground {\n  fill: var(--commentBorderColour);\n  height: 24px;\n}\n\n.blocklyComment .blocklyCommentPreview.blocklyText {\n  fill: #000;\n  dominant-baseline: middle;\n  visibility: hidden;\n}\n\n.blocklyCollapsed.blocklyComment .blocklyCommentPreview {\n  visibility: visible;\n}\n\n.blocklyCollapsed.blocklyComment .blocklyCommentForeignObject,\n.blocklyCollapsed.blocklyComment .blocklyResizeHandle {\n  display: none;\n}\n\n.blocklyCollapsed.blocklyComment .blocklyFoldoutIcon {\n  transform: rotate(-90deg);\n}\n\n.blocklyRTL .blocklyCommentTopbar {\n  transform: scale(-1, 1);\n}\n\n.blocklyRTL .blocklyCommentForeignObject {\n  direction: rtl;\n}\n\n.blocklyRTL .blocklyCommentPreview {\n  /* Revert the scale and control RTL using direction instead. */\n  transform: scale(-1, 1);\n  direction: rtl;\n}\n\n.blocklyRTL .blocklyResizeHandle {\n  transform: scale(-1, 1);\n  cursor: sw-resize;\n}\n\n.blocklyCommentHighlight {\n  fill: none;\n}\n\n.blocklyCommentText.blocklyActiveFocus {\n  border-color: #fc3;\n  border-width: 2px;\n}\n\n.blocklySelected .blocklyCommentHighlight {\n  stroke: #fc3;\n  stroke-width: 3px;\n}\n\n.blocklyCollapsed.blocklySelected .blocklyCommentHighlight {\n  stroke: none;\n}\n\n.blocklyCollapsed.blocklySelected .blocklyCommentTopbarBackground {\n  stroke: #fc3;\n  stroke-width: 3px;\n}\n");var fc=class{constructor(e,o){this.workspace=e,this.text="",this.collapsed=!1,this.deletable=this.movable=this.editable=!0,this.location=new A(0,0),this.disposing=this.disposed=!1,this.id=o&&!e.getCommentById(o)?o:Ne(),this.size=Or.defaultCommentSize,e.addTopComment(this),this.fireCreateEvent()}fireCreateEvent(){_e()&&L(new(B(E.COMMENT_CREATE))(this))}fireDeleteEvent(){_e()&&L(new(B(E.COMMENT_DELETE))(this))}fireChangeEvent(e,o){_e()&&L(new(B(E.COMMENT_CHANGE))(this,e,o))}fireCollapseEvent(e){_e()&&L(new(B(E.COMMENT_COLLAPSE))(this,e))}setText(e){const o=this.text;this.text=e,this.fireChangeEvent(o,e)}getText(){return this.text}setSize(e){const o=new(B(E.COMMENT_RESIZE))(this);this.size=e,o.recordCurrentSizeAsNewSize(),L(o)}getSize(){return this.size}setCollapsed(e){this.collapsed=e,this.fireCollapseEvent(e)}isCollapsed(){return this.collapsed}setEditable(e){this.editable=e}isEditable(){return this.isOwnEditable()&&!this.workspace.isReadOnly()}isOwnEditable(){return this.editable}setMovable(e){this.movable=e}isMovable(){return this.isOwnMovable()&&!this.workspace.isReadOnly()&&!this.workspace.isFlyout}isOwnMovable(){return this.movable}setDeletable(e){this.deletable=e}isDeletable(){return this.isOwnDeletable()&&!this.isDeadOrDying()&&!this.workspace.isReadOnly()&&!this.workspace.isFlyout}isOwnDeletable(){return this.deletable}moveTo(e,o){const i=new(B(E.COMMENT_MOVE))(this);o&&i.setReason(o),this.location=e,i.recordNew(),L(i)}getRelativeToSurfaceXY(){return this.location}dispose(){this.disposing=!0,this.fireDeleteEvent(),this.workspace.removeTopComment(this),this.disposed=!0}isDisposed(){return this.disposed}isDeadOrDying(){return this.disposing||this.disposed}},so=class extends fc{constructor(e,o){super(e,o),this.dragStrategy=new Np(this),this.workspace=e,this.view=new Or(e,this.id),this.view.setSize(this.getSize()),this.view.setEditable(this.isEditable()),this.view.getSvgRoot().setAttribute("data-id",this.id),this.view.getSvgRoot().setAttribute("id",this.id),this.addModelUpdateBindings(),U(this.view.getSvgRoot(),"pointerdown",this,this.startGesture),U(this.view.getSvgRoot(),"wheel",this,i=>{i.stopPropagation()})}addModelUpdateBindings(){this.view.addTextChangeListener((e,o)=>{super.setText(o)}),this.view.addSizeChangeListener((e,o)=>{super.setSize(o)}),this.view.addOnCollapseListener(()=>{super.setCollapsed(this.view.isCollapsed())}),this.view.addDisposeListener(()=>{this.isDeadOrDying()||this.dispose()})}setText(e){this.view.setText(e)}setPlaceholderText(e){this.view.setPlaceholderText(e)}setSize(e){this.view.setSize(e)}setCollapsed(e){this.view.setCollapsed(e)}setEditable(e){super.setEditable(e),this.view.setEditable(this.isEditable())}getSvgRoot(){return this.view.getSvgRoot()}getSize(){return super.getSize()}getBoundingRectangle(){const e=this.getRelativeToSurfaceXY();var o,i;const s=null!=(i=null==(o=this.view)?void 0:o.getSize())?i:this.getSize();return this.workspace.RTL?(o=e.x-s.width,i=e.x):(o=e.x,i=e.x+s.width),new Q(e.y,e.y+s.height,o,i)}moveBy(e,o,i){const s=this.getRelativeToSurfaceXY();e=new A(s.x+e,s.y+o),this.moveTo(e,i)}moveTo(e,o){super.moveTo(e,o),this.view.moveTo(e)}moveDuringDrag(e){this.location=e,this.view.moveTo(e)}setDragging(e){e?R(this.getSvgRoot(),"blocklyDragging"):te(this.getSvgRoot(),"blocklyDragging")}dispose(){this.disposing=!0;const e=t.getFocusManager$$module$build$src$core$focus_manager();e.getFocusedNode()===this&&setTimeout(()=>e.focusTree(this.workspace),0),this.view.isDeadOrDying()||this.view.dispose(),super.dispose()}startGesture(e){const o=this.workspace.getGesture(e);o&&(o.handleCommentStart(e,this),t.getFocusManager$$module$build$src$core$focus_manager().focusNode(this))}setDeleteStyle(e){e?R(this.getSvgRoot(),"blocklyDraggingDelete"):te(this.getSvgRoot(),"blocklyDraggingDelete")}isCopyable(){return this.isOwnMovable()&&this.isOwnDeletable()}isMovable(){return this.dragStrategy.isMovable()}startDrag(){this.dragStrategy.startDrag()}drag(e){this.dragStrategy.drag(e)}endDrag(){this.dragStrategy.endDrag()}revertDrag(){this.dragStrategy.revertDrag()}select(){R(this.getSvgRoot(),"blocklySelected"),To(this)}unselect(){te(this.getSvgRoot(),"blocklySelected"),To(null)}toCopyData(){return{paster:rc.TYPE,commentState:qo(this,{addCoordinates:!0})}}showContextMenu(e){const o=K.registry.getContextMenuOptions({comment:this,focusedNode:this},e);let i;i=e instanceof PointerEvent?new A(e.clientX,e.clientY):yo(this.workspace,this.getRelativeToSurfaceXY()).translate(10,10),As(e,o,this.workspace.RTL,this.workspace,i)}snapToGrid(){if(!this.isDeadOrDying()){var e=this.workspace.getGrid();if(null!=e&&e.shouldSnap()){var o=this.getRelativeToSurfaceXY();(e=e.alignXY(o))!==o&&this.moveTo(e,["snap"])}}}getEditorFocusableNode(){return this.view.getEditorFocusableNode()}getFocusableElement(){return this.getSvgRoot()}getFocusableTree(){return this.workspace}onNodeFocus(){let e;this.select(),null==(e=this.workspace.getLayerManager())||e.append(this,50)}onNodeBlur(){this.unselect()}canBeFocused(){return!0}},ht={};ht.appendDomToWorkspace=Xa,ht.blockToDom=Co,ht.blockToDomWithXY=Rs,ht.clearWorkspaceAndLoadFromXml=Ya,ht.deleteNext=su,ht.domToBlock=t.domToBlock$$module$build$src$core$xml,ht.domToBlockInternal=Xo,ht.domToPrettyText=ja,ht.domToText=Bt,ht.domToVariables=Il,ht.domToWorkspace=t.domToWorkspace$$module$build$src$core$xml,ht.loadWorkspaceComment=kl,ht.saveWorkspaceComment=Os,ht.variablesToDom=xl,ht.workspaceToDom=qa;var Vu=class extends Hi{constructor(e){super(e),this.type=E.BLOCK_CREATE,e&&(e.isShadow()&&(this.recordUndo=!1),this.xml=Rs(e),this.ids=Go(e),this.json=Tt(e,{addCoordinates:!0}))}toJson(){const e=super.toJson();if(!this.xml)throw Error("The block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.xml=Bt(this.xml),e.ids=this.ids,e.json=this.json,this.recordUndo||(e.recordUndo=this.recordUndo),e}static fromJson(e,o,i){return(o=super.fromJson(e,o,i??new Vu)).xml=t.textToDom$$module$build$src$core$utils$xml(e.xml),o.ids=e.ids,o.json=e.json,void 0!==e.recordUndo&&(o.recordUndo=e.recordUndo),o}run(e){const o=this.getEventWorkspace_();if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!gb(o,this.ids))if(e)zo(this.json,o);else for(e=0;e<this.ids.length;e++){const i=this.ids[e],s=o.getBlockById(i);s?s.dispose(!1):i===this.blockId&&console.warn("Can't uncreate non-existent block: "+i)}}},gb=function(e,o){return o.map(i=>e.getBlockById(i)).filter(i=>i&&i.isShadow()).length===o.length};D(w.EVENT,E.BLOCK_CREATE,Vu);var qu=class extends oo{constructor(e,o){super(o),this.type=E.THEME_CHANGE,this.themeName=e}toJson(){const e=super.toJson();if(!this.themeName)throw Error("The theme name is undefined. Either pass a theme name to the constructor, or call fromJson");return e.themeName=this.themeName,e}static fromJson(e,o,i){return(o=super.fromJson(e,o,i??new qu)).themeName=e.themeName,o}};D(w.EVENT,E.THEME_CHANGE,qu);var Wu=class extends oo{constructor(e,o,i,s,n){super(s),this.type=E.VIEWPORT_CHANGE,this.viewTop=e,this.viewLeft=o,this.scale=i,this.oldScale=n}toJson(){const e=super.toJson();if(void 0===this.viewTop)throw Error("The view top is undefined. Either pass a value to the constructor, or call fromJson");if(void 0===this.viewLeft)throw Error("The view left is undefined. Either pass a value to the constructor, or call fromJson");if(void 0===this.scale)throw Error("The scale is undefined. Either pass a value to the constructor, or call fromJson");if(void 0===this.oldScale)throw Error("The old scale is undefined. Either pass a value to the constructor, or call fromJson");return e.viewTop=this.viewTop,e.viewLeft=this.viewLeft,e.scale=this.scale,e.oldScale=this.oldScale,e}static fromJson(e,o,i){return(o=super.fromJson(e,o,i??new Wu)).viewTop=e.viewTop,o.viewLeft=e.viewLeft,o.scale=e.scale,o.oldScale=e.oldScale,o}};D(w.EVENT,E.VIEWPORT_CHANGE,Wu);var N=function(e){return e[e.INPUT_VALUE=1]="INPUT_VALUE",e[e.OUTPUT_VALUE=2]="OUTPUT_VALUE",e[e.NEXT_STATEMENT=3]="NEXT_STATEMENT",e[e.PREVIOUS_STATEMENT=4]="PREVIOUS_STATEMENT",e}(N||{}),on=class{constructor(e){this.connectionChecker=e,this.connections=[]}addConnection(e,o){o=this.calculateIndexForYPos(o),this.connections.splice(o,0,e)}findIndexOfConnection(e,o){if(!this.connections.length)return-1;const i=this.calculateIndexForYPos(o);if(i>=this.connections.length)return-1;o=e.y;let s=i;for(;s>=0&&this.connections[s].y===o;){if(this.connections[s]===e)return s;s--}for(s=i;s<this.connections.length&&this.connections[s].y===o;){if(this.connections[s]===e)return s;s++}return-1}calculateIndexForYPos(e){if(!this.connections.length)return 0;let o=0,i=this.connections.length;for(;o<i;){const s=Math.floor((o+i)/2);if(this.connections[s].y<e)o=s+1;else{if(!(this.connections[s].y>e)){o=s;break}i=s}}return o}removeConnection(e,o){if(-1===(e=this.findIndexOfConnection(e,o)))throw Error("Unable to find connection in connectionDB.");this.connections.splice(e,1)}getNeighbours(e,o){function i(F){const we=n-s[F].x,Te=l-s[F].y;return Math.sqrt(we*we+Te*Te)<=o&&k.push(s[F]),Te<o}const s=this.connections,n=e.x,l=e.y;e=0;let h=s.length-2,$=h;for(;e<$;)s[$].y<l?e=$:h=$,$=Math.floor((e+h)/2);const k=[];if(h=e=$,s.length){for(;e>=0&&i(e);)e--;do{h++}while(h<s.length&&i(h))}return k}isInYRange(e,o,i){return Math.abs(this.connections[e].y-o)<=i}searchForClosest(e,o,i){if(!this.connections.length)return{connection:null,radius:o};const s=e.y,n=e.x;e.x=n+i.x,e.y=s+i.y;var l=this.calculateIndexForYPos(e.y);i=null;let $,h=o,k=l-1;for(;k>=0&&this.isInYRange(k,e.y,o);)$=this.connections[k],this.connectionChecker.canConnect(e,$,!0,h)&&(i=$,h=$.distanceFrom(e)),k--;for(;l<this.connections.length&&this.isInYRange(l,e.y,o);)$=this.connections[l],this.connectionChecker.canConnect(e,$,!0,h)&&(i=$,h=$.distanceFrom(e)),l++;return e.x=n,e.y=s,{connection:i,radius:h}}static init(e){const o=[];return o[N.INPUT_VALUE]=new on(e),o[N.OUTPUT_VALUE]=new on(e),o[N.NEXT_STATEMENT]=new on(e),o[N.PREVIOUS_STATEMENT]=new on(e),o}},zu=class extends oo{constructor(e,o,i){super(i),this.type=E.SELECTED,this.oldElementId=e??void 0,this.newElementId=o??void 0}toJson(){const e=super.toJson();return e.oldElementId=this.oldElementId,e.newElementId=this.newElementId,e}static fromJson(e,o,i){return(o=super.fromJson(e,o,i??new zu)).oldElementId=e.oldElementId,o.newElementId=e.newElementId,o}};D(w.EVENT,E.SELECTED,zu);var ju=class extends Hi{constructor(e){if(super(e),this.type=E.BLOCK_DELETE,e){if(e.getParent())throw Error("Connected blocks cannot be deleted.");e.isShadow()&&(this.recordUndo=!1),this.oldXml=Rs(e),this.ids=Go(e),this.wasShadow=e.isShadow(),this.oldJson=Tt(e,{addCoordinates:!0})}}toJson(){const e=super.toJson();if(!this.oldXml)throw Error("The old block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(void 0===this.wasShadow)throw Error("Whether the block was a shadow is undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.oldXml=Bt(this.oldXml),e.ids=this.ids,e.wasShadow=this.wasShadow,e.oldJson=this.oldJson,this.recordUndo||(e.recordUndo=this.recordUndo),e}static fromJson(e,o,i){return(o=super.fromJson(e,o,i??new ju)).oldXml=t.textToDom$$module$build$src$core$utils$xml(e.oldXml),o.ids=e.ids,o.wasShadow=e.wasShadow||"shadow"===o.oldXml.tagName.toLowerCase(),o.oldJson=e.oldJson,void 0!==e.recordUndo&&(o.recordUndo=e.recordUndo),o}run(e){const o=this.getEventWorkspace_();if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(e)for(e=0;e<this.ids.length;e++){const i=this.ids[e],s=o.getBlockById(i);s?s.dispose(!1):i===this.blockId&&console.warn("Can't delete non-existent block: "+i)}else zo(this.oldJson,o)}};D(w.EVENT,E.BLOCK_DELETE,ju);var v$={fromJsonInternal:ru},Yu={TEST_ONLY:v$};Yu.fromJson=t.fromJson$$module$build$src$core$field_registry,Yu.register=Pt,Yu.unregister=nu;var ot=class extends ue{constructor(e,o,i){super(ue.SKIP_SETUP),this.svgArrow=this.arrow=this.imageElement=this.menu_=this.selectedMenuItem=null,this.SERIALIZABLE=!0,this.clickTarget_=this.suffixField=this.prefixField=this.generatedOptions=null,e!==ue.SKIP_SETUP&&(this.setOptions(e),i&&this.configure_(i),o&&this.setValidator(o))}fromXml(e){this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(e.textContent)}loadState(e){this.loadLegacyState(ot,e)||(this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(e))}initView(){this.shouldAddBorderRect_()?this.createBorderRect_():this.clickTarget_=this.sourceBlock_.getSvgRoot(),this.createTextElement_(),this.imageElement=I(v.IMAGE,{},this.fieldGroup_),this.getConstants().FIELD_DROPDOWN_SVG_ARROW?this.createSVGArrow_():this.createTextArrow_(),this.borderRect_&&R(this.borderRect_,"blocklyDropdownRect"),this.fieldGroup_&&(R(this.fieldGroup_,"blocklyField"),R(this.fieldGroup_,"blocklyDropdownField"))}shouldAddBorderRect_(){let e;return!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW&&!(null!=(e=this.getSourceBlock())&&e.isShadow())}createTextArrow_(){let e,o;this.arrow=I(v.TSPAN,{},this.textElement_),this.arrow.appendChild(document.createTextNode(null!=(e=this.getSourceBlock())&&e.RTL?ot.ARROW_CHAR+" ":" "+ot.ARROW_CHAR)),this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.arrow.setAttribute("dominant-baseline","central"),null!=(o=this.getSourceBlock())&&o.RTL?this.getTextElement().insertBefore(this.arrow,this.textContent_):this.getTextElement().appendChild(this.arrow)}createSVGArrow_(){this.svgArrow=I(v.IMAGE,{height:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px",width:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px"},this.fieldGroup_),this.svgArrow.setAttributeNS(It,"xlink:href",this.getConstants().FIELD_DROPDOWN_SVG_ARROW_DATAURI)}showEditor_(e){var o=this.getSourceBlock();if(!o)throw new Me;this.dropdownCreate(),this.menu_&&(this.menu_.openingCoords=e&&"number"==typeof e.clientX?new A(e.clientX,e.clientY):null,gl(),e=this.menu_.render(pl()),R(e,"blocklyDropdownMenu"),this.getConstants().FIELD_DROPDOWN_COLOURED_DIV&&(o=o.getColour(),e=this.sourceBlock_.getColourTertiary(),ga(o,e)),ma(this,this.dropdownDispose_.bind(this)),pl().style.height=`${this.menu_.getSize().height}px`,this.menu_.focus(),this.selectedMenuItem&&this.menu_.setHighlighted(this.selectedMenuItem),this.applyColour())}dropdownCreate(){const e=this.getSourceBlock();if(!e)throw new Me;const o=new ku;o.setRole(wt.LISTBOX),this.menu_=o;const i=this.getOptions(!1);this.selectedMenuItem=null;for(let n=0;n<i.length;n++){var s=i[n];if(s===ot.SEPARATOR){o.addChild(new _p);continue}const[l,h]=s;wi(l)?((s=new Image(l.width,l.height)).src=l.src,s.alt=l.alt):s=l,(s=new cc(s,h)).setRole(wt.OPTION),s.setRightToLeft(e.RTL),s.setCheckable(!0),o.addChild(s),s.setChecked(h===this.value_),h===this.value_&&(this.selectedMenuItem=s),s.onAction(this.handleMenuActionEvent,this)}}dropdownDispose_(){this.menu_&&this.menu_.dispose(),this.selectedMenuItem=this.menu_=null,this.applyColour()}handleMenuActionEvent(e){ml(this,!0),this.onItemSelected_(this.menu_,e)}onItemSelected_(e,o){this.setValue(o.getValue())}isOptionListDynamic(){return"function"==typeof this.menuGenerator_}getOptions(e){if(!this.menuGenerator_)throw TypeError("A menu generator was never defined.");return Array.isArray(this.menuGenerator_)?this.menuGenerator_:(e&&this.generatedOptions||(this.generatedOptions=this.menuGenerator_(),this.validateOptions(this.generatedOptions)),this.generatedOptions)}setOptions(e){Array.isArray(e)?(this.validateOptions(e),e=this.trimOptions(e),this.menuGenerator_=e.options,this.prefixField=e.prefix||null,this.suffixField=e.suffix||null):this.menuGenerator_=e,this.selectedOption=this.getOptions(!1)[0],this.setValue(this.selectedOption[1])}doClassValidation_(e){return this.getOptions(!0).some(o=>o[1]===e)?e:(this.sourceBlock_&&console.warn("Cannot set the dropdown's value to an unavailable option. Block type: "+this.sourceBlock_.type+", Field name: "+this.name+", Value: "+e),null)}doValueUpdate_(e){super.doValueUpdate_(e),e=this.getOptions(!0);for(let i,o=0;i=e[o];o++)i[1]===this.value_&&(this.selectedOption=i)}applyColour(){const e=this.sourceBlock_;this.borderRect_&&(this.borderRect_.setAttribute("stroke",e.getColourTertiary()),this.borderRect_.setAttribute("fill",this.menu_?e.getColourTertiary():"transparent")),e&&this.arrow&&(this.arrow.style.fill=e.isShadow()?e.getColourSecondary():e.getColour())}render_(){this.getTextContent().nodeValue="",this.imageElement.style.display="none";const e=this.selectedOption&&this.selectedOption[0];wi(e)?this.renderSelectedImage(e):this.renderSelectedText(),this.positionBorderRect_()}renderSelectedImage(e){const o=this.getSourceBlock();if(!o)throw new Me;this.imageElement.style.display="",this.imageElement.setAttributeNS(It,"xlink:href",e.src),this.imageElement.setAttribute("height",String(e.height)),this.imageElement.setAttribute("width",String(e.width));const i=Number(e.height);e=Number(e.width);var s=!!this.borderRect_;const n=Math.max(s?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,i+ot.IMAGE_Y_PADDING);let l;s=s?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,l=this.svgArrow?this.positionSVGArrow(e+s,n/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2):O(this.arrow),this.size_.width=e+l+2*s,this.size_.height=n;let h=0;o.RTL?this.imageElement.setAttribute("x",`${s+l}`):(h=e+l,this.getTextElement().setAttribute("text-anchor","end"),this.imageElement.setAttribute("x",`${s}`)),this.imageElement.setAttribute("y",String(n/2-i/2)),this.positionTextElement_(h+s,e+l)}renderSelectedText(){this.getTextContent().nodeValue=this.getDisplayText_();var e=this.getTextElement();R(e,"blocklyDropdownText"),e.setAttribute("text-anchor","start");var o=!!this.borderRect_;e=Math.max(o?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,this.getConstants().FIELD_TEXT_HEIGHT);const i=O(this.getTextElement());o=o?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;let s=0;this.svgArrow&&(s=this.positionSVGArrow(i+o,e/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2)),this.size_.width=i+s+2*o,this.size_.height=e,this.positionTextElement_(o,i)}positionSVGArrow(e,o){if(!this.svgArrow)return 0;const i=this.getSourceBlock();if(!i)throw new Me;const s=this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,n=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_PADDING,l=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE;return this.svgArrow.setAttribute("transform","translate("+(i.RTL?s:e+n)+","+o+")"),l+n}getText_(){if(!this.selectedOption)return null;const e=this.selectedOption[0];if(wi(e))return e.alt;if(typeof HTMLElement<"u"&&e instanceof HTMLElement){let o,i;return null!=(i=null!=(o=e.title)?o:e.ariaLabel)?i:e.innerText}return"string"==typeof e?e:(console.warn("Can't get text for existing dropdown option. If you're using HTMLElement dropdown options in node, ensure you're using jsdom-global or similar."),null)}static fromJson(e){if(!e.options)throw Error("options are required for the dropdown field. The options property must be assigned an array of [humanReadableValue, languageNeutralValue] tuples.");return new this(e.options,void 0,e)}trimOptions(e){let o=!1;const i=e.map(h=>{if(h===ot.SEPARATOR)return h;const[$,k]=h;return"string"==typeof $?[Ae($),k]:(o=!0,[wi($)?Object.assign({},$,{alt:Ae($.alt)}):Object.assign({},$),k])});if(o||e.length<2)return{options:i};var s=i.map(([h])=>h),n=Fn(s);e=Ca(s,n);const l=ka(s,n);return!e&&!l||n<=e+l?{options:i}:(n=e?s[0].substring(0,e-1):void 0,s=l?s[0].substr(1-l):void 0,{options:this.applyTrim(i,e,l),prefix:n,suffix:s})}applyTrim(e,o,i){return e.map(([s,n])=>[s.substring(o,s.length-i),n])}validateOptions(e){if(!Array.isArray(e))throw TypeError("FieldDropdown options must be an array.");if(!e.length)throw TypeError("FieldDropdown options must not be an empty array.");let o=!1;for(let i=0;i<e.length;i++){const s=e[i];Array.isArray(s)||s===ot.SEPARATOR?"string"!=typeof s[1]?(o=!0,console.error(`Invalid option[${i}]: Each FieldDropdown option id must be a string. \n          Found ${s[1]} in: ${s}`)):!s[0]||"string"==typeof s[0]||wi(s[0])||typeof HTMLElement<"u"&&s[0]instanceof HTMLElement||(o=!0,console.error(`Invalid option[${i}]: Each FieldDropdown option must have a string \n          label, image description, or HTML element. Found ${s[0]} in: ${s}`)):(o=!0,console.error(`Invalid option[${i}]: Each FieldDropdown option must be an array or\n          the string literal 'separator'. Found: ${s}`))}if(o)throw TypeError("Found invalid FieldDropdown options.")}};ot.SEPARATOR="separator",ot.ARROW_CHAR="\u25be",ot.IMAGE_Y_OFFSET=5,ot.IMAGE_Y_PADDING=2*ot.IMAGE_Y_OFFSET,Pt("field_dropdown",ot);var Ot,Wi=class{constructor(e,o,i,s){this.name=e,this.startHats=!1,this.blockStyles=o||Object.create(null),this.categoryStyles=i||Object.create(null),this.componentStyles=s||Object.create(null),this.fontStyle=Object.create(null),D(w.THEME,e,this,!0)}getClassName(){return this.name+"-theme"}setBlockStyle(e,o){this.blockStyles[e]=o}setCategoryStyle(e,o){this.categoryStyles[e]=o}getComponentStyle(e){if(!(e=this.componentStyles[e]))return null;if("string"==typeof e){const o=this.getComponentStyle(e);if(o)return o}return`${e}`}setComponentStyle(e,o){this.componentStyles[e]=o}setFontStyle(e){this.fontStyle=e}setStartHats(e){this.startHats=e}static defineTheme(e,o){e=e.toLowerCase();const i=new Wi(e);let s=o.base;if(s){if("string"==typeof s){let n;s=null!=(n=Rt(w.THEME,s))?n:void 0}s instanceof Wi&&(Nt(i,s),i.name=e)}return Nt(i.blockStyles,o.blockStyles),Nt(i.categoryStyles,o.categoryStyles),Nt(i.componentStyles,o.componentStyles),Nt(i.fontStyle,o.fontStyle),null!==o.startHats&&(i.startHats=o.startHats),i}},Tc=new Wi("classic",{colour_blocks:{colourPrimary:"20"},list_blocks:{colourPrimary:"260"},logic_blocks:{colourPrimary:"210"},loop_blocks:{colourPrimary:"120"},math_blocks:{colourPrimary:"230"},procedure_blocks:{colourPrimary:"290"},text_blocks:{colourPrimary:"160"},variable_blocks:{colourPrimary:"330"},variable_dynamic_blocks:{colourPrimary:"310"},hat_blocks:{colourPrimary:"330",hat:"cap"}},{colour_category:{colour:"20"},list_category:{colour:"260"},logic_category:{colour:"210"},loop_category:{colour:"120"},math_category:{colour:"230"},procedure_category:{colour:"290"},text_category:{colour:"160"},variable_category:{colour:"330"},variable_dynamic_category:{colour:"310"}}),no=class{constructor(e){this.gridPattern=null,this.getMetrics=this.setMetrics=void 0;let o=null,i=!1;var s=!1,n=!1,l=!1,h=!1,$=!1;const k=!!e.readOnly;var F;k||(o=wn(null!=(F=e.toolbox)?F:null),i=An(o),s=void 0===(s=e.trashcan)?i:s,n=void 0===(n=e.collapse)?i:n,l=void 0===(l=e.comments)?i:l,h=void 0===(h=e.disable)?i:h,$=void 0===($=e.sounds)||$),F=e.maxTrashcanContents,s?void 0===F&&(F=32):F=0;const we=!!e.rtl;let Te=e.horizontalLayout;void 0===Te&&(Te=!1);var rt="end"!==e.toolboxPosition;rt=Te?rt?j.TOP:j.BOTTOM:rt===we?j.RIGHT:j.LEFT;let li=e.css;void 0===li&&(li=!0);let Lo="https://blockly-demo.appspot.com/static/media/";e.media&&(Lo=e.media.endsWith("/")?e.media:e.media+"/");const $_=e.oneBasedIndex,WE=e.renderer||"geras",zE=e.plugins||{};let __,b_,f_,em=e.modalInputs;void 0===em&&(em=!0),this.RTL=we,this.oneBasedIndex=void 0===$_||$_,this.collapse=n,this.comments=l,this.disable=h,this.readOnly=k,this.maxBlocks=e.maxBlocks||1/0,this.maxInstances=null!=(__=e.maxInstances)?__:null,this.modalInputs=em,this.pathToMedia=Lo,this.hasCategories=i,this.moveOptions=no.parseMoveOptions(e,i),this.hasScrollbars=!!this.moveOptions.scrollbars,this.hasTrashcan=s,this.maxTrashcanContents=F,this.hasSounds=$,this.hasCss=li,this.horizontalLayout=Te,this.languageTree=o,this.gridOptions=no.parseGridOptions(e),this.zoomOptions=no.parseZoomOptions(e),this.toolboxPosition=rt,this.theme=no.parseThemeOptions(e),this.renderer=WE,this.rendererOverrides=null!=(b_=e.rendererOverrides)?b_:null,this.parentWorkspace=null!=(f_=e.parentWorkspace)?f_:null,this.plugins=zE}static parseMoveOptions(e,o){const i=e.move||{},s={};return void 0===i.scrollbars&&void 0===e.scrollbars?s.scrollbars=o:"object"==typeof i.scrollbars?(s.scrollbars={horizontal:!!i.scrollbars.horizontal,vertical:!!i.scrollbars.vertical},s.scrollbars.horizontal&&s.scrollbars.vertical?s.scrollbars=!0:s.scrollbars.horizontal||s.scrollbars.vertical||(s.scrollbars=!1)):s.scrollbars=!!i.scrollbars||!!e.scrollbars,s.wheel=s.scrollbars&&void 0!==i.wheel?!!i.wheel:"object"==typeof s.scrollbars,s.drag=!(!s.scrollbars||void 0!==i.drag&&!i.drag),s}static parseZoomOptions(e){const o={};return o.controls=void 0!==(e=e.zoom||{}).controls&&!!e.controls,o.wheel=void 0!==e.wheel&&!!e.wheel,o.startScale=void 0===e.startScale?1:Number(e.startScale),o.maxScale=void 0===e.maxScale?3:Number(e.maxScale),o.minScale=void 0===e.minScale?.3:Number(e.minScale),o.scaleSpeed=void 0===e.scaleSpeed?1.2:Number(e.scaleSpeed),o.pinch=void 0===e.pinch?o.wheel||o.controls:!!e.pinch,o}static parseGridOptions(e){e=e.grid||{};const o={};return o.spacing=Number(e.spacing)||0,o.colour=e.colour||"#888",o.length=void 0===e.length?1:Number(e.length),o.snap=o.spacing>0&&!!e.snap,o}static parseThemeOptions(e){return"string"==typeof(e=e.theme||Tc)?Rt(w.THEME,e):e instanceof Wi?e:Wi.defineTheme(e.name||"builtin"+ct(),e)}},Up=class{constructor(e,o){this.bubble=e,this.workspace=o,this.startLoc=null}isMovable(){return!0}startDrag(){let e;this.startLoc=this.bubble.getRelativeToSurfaceXY(),this.workspace.setResizesEnabled(!1),null==(e=this.workspace.getLayerManager())||e.moveToDragLayer(this.bubble),this.bubble.setDragging&&this.bubble.setDragging(!0)}drag(e){this.bubble.moveDuringDrag(e)}endDrag(){let e;this.workspace.setResizesEnabled(!0),null==(e=this.workspace.getLayerManager())||e.moveOffDragLayer(this.bubble,100),this.bubble.setDragging(!1)}revertDrag(){this.startLoc&&this.bubble.moveDuringDrag(this.startLoc)}},de=class{constructor(e,o,i,s){this.workspace=e,this.anchor=o,this.ownerRect=i,this.size=new ee(0,0),this.colour="#ffffff",this.disposed=!1,this.relativeLeft=this.relativeTop=0,this.dragStrategy=new Up(this,this.workspace),this.id=ct(),this.svgRoot=I(v.G,{class:"blocklyBubble"},e.getBubbleCanvas()),e=I(v.G,{class:"blocklyEmboss"},this.svgRoot),this.tail=I(v.PATH,{class:"blocklyBubbleTail"},e),this.background=I(v.RECT,{class:"blocklyDraggable",x:0,y:0,rx:Ot.BORDER_WIDTH,ry:Ot.BORDER_WIDTH},e),this.contentContainer=I(v.G,{},this.svgRoot),this.focusableElement=s??this.svgRoot,this.focusableElement.setAttribute("id",this.id),U(this.background,"pointerdown",this,this.onMouseDown)}dispose(){ce(this.svgRoot),this.disposed=!0}setAnchorLocation(e,o=!1){this.anchor=e,o?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor(),this.renderTail()}setPositionRelativeToAnchor(e,o){this.relativeLeft=e,this.relativeTop=o,this.positionRelativeToAnchor(),this.renderTail()}getSize(){return this.size}setSize(e,o=!1){e.width=Math.max(e.width,Ot.MIN_SIZE),e.height=Math.max(e.height,Ot.MIN_SIZE),this.size=e,this.background.setAttribute("width",`${e.width}`),this.background.setAttribute("height",`${e.height}`),o?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor(),this.renderTail()}getColour(){return this.colour}setColour(e){this.colour=e,this.tail.setAttribute("fill",e),this.background.setAttribute("fill",e)}onMouseDown(e){let o;null==(o=this.workspace.getGesture(e))||o.handleBubbleStart(e,this),t.getFocusManager$$module$build$src$core$focus_manager().focusNode(this)}positionRelativeToAnchor(){let e=this.anchor.x;e=this.workspace.RTL?e-(this.relativeLeft+this.size.width):e+this.relativeLeft,this.moveTo(e,this.relativeTop+this.anchor.y)}moveTo(e,o){this.svgRoot.setAttribute("transform",`translate(${e}, ${o})`)}positionByRect(e=new Q(0,0,0,0)){var o=this.workspace.getMetricsManager().getViewMetrics(!0),i=this.getOptimalRelativeLeft(o),s=this.getOptimalRelativeTop(o);const n={x:i,y:-this.size.height-this.workspace.getRenderer().getConstants().MIN_BLOCK_HEIGHT},l={x:-this.size.width-30,y:s};s={x:e.getWidth(),y:s};var h={x:i,y:e.getHeight()};i=e.getWidth()<e.getHeight()?s:h,e=e.getWidth()<e.getHeight()?h:s,s=this.getOverlap(n,o),h=this.getOverlap(l,o);const $=this.getOverlap(i,o);o=this.getOverlap(e,o),s===(o=Math.max(s,h,$,o))?(this.relativeLeft=n.x,this.relativeTop=n.y):h===o?(this.relativeLeft=l.x,this.relativeTop=l.y):$===o?(this.relativeLeft=i.x,this.relativeTop=i.y):(this.relativeLeft=e.x,this.relativeTop=e.y),this.positionRelativeToAnchor()}getOverlap(e,o){var i=this.workspace.RTL?this.anchor.x-e.x-this.size.width:e.x+this.anchor.x;return e=e.y+this.anchor.y,Math.max(0,Math.min(1,(Math.min(i+this.size.width,o.left+o.width)-Math.max(i,o.left))*(Math.min(e+this.size.height,o.top+o.height)-Math.max(e,o.top))/(this.size.width*this.size.height)))}getOptimalRelativeLeft(e){let o=-this.size.width/4;if(this.size.width>e.width)return o;if(e=this.getWorkspaceViewRect(e),this.workspace.RTL){var i=this.anchor.x-o;i-this.size.width<e.left?o=-(e.left-this.anchor.x+this.size.width):i>e.right&&(o=-(e.right-this.anchor.x))}else(i=o+this.anchor.x)<e.left?o=e.left-this.anchor.x:i+this.size.width>e.right&&(o=e.right-this.anchor.x-this.size.width);return o}getOptimalRelativeTop(e){let o=-this.size.height/4;if(this.size.height>e.height)return o;const i=this.anchor.y+o,s=i+this.size.height;return i<(e=this.getWorkspaceViewRect(e)).top?o=e.top-this.anchor.y:s>e.bottom&&(o=e.bottom-this.anchor.y-this.size.height),o}getWorkspaceViewRect(e){const o=e.top;let i=e.top+e.height,s=e.left;return e=e.left+e.width,i-=this.getScrollbarThickness(),this.workspace.RTL?s-=this.getScrollbarThickness():e-=this.getScrollbarThickness(),new Q(o,i,s,e)}getScrollbarThickness(){return Oe.scrollbarThickness/this.workspace.scale}renderTail(){const e=[];var o=this.size.width/2,i=this.size.height/2,s=-this.relativeLeft,n=-this.relativeTop;if(o===s&&i===n)e.push("M "+o+","+i);else{n-=i,s-=o,this.workspace.RTL&&(s*=-1);var l=Math.sqrt(n*n+s*s),h=Math.acos(s/l);n<0&&(h=2*Math.PI-h);var $=h+Math.PI/2;$>2*Math.PI&&($-=2*Math.PI);var k=Math.sin($);const we=Math.cos($);let Te=(this.size.width+this.size.height)/Ot.TAIL_THICKNESS;Te=Math.min(Te,this.size.width,this.size.height)/4,s=o+($=1-Ot.ANCHOR_RADIUS/l)*s,n=i+$*n,$=o+Te*we;const rt=i+Te*k;o-=Te*we,i-=Te*k,(k=h+(k=dl(this.workspace.RTL?-Ot.TAIL_ANGLE:Ot.TAIL_ANGLE)))>2*Math.PI&&(k-=2*Math.PI),h=Math.sin(k)*l/Ot.TAIL_BEND,l=Math.cos(k)*l/Ot.TAIL_BEND,e.push("M"+$+","+rt),e.push("C"+($+l)+","+(rt+h)+" "+s+","+n+" "+s+","+n),e.push("C"+s+","+n+" "+(o+l)+","+(i+h)+" "+o+","+i)}let F;e.push("z"),null==(F=this.tail)||F.setAttribute("d",e.join(" "))}bringToFront(){let e;const o=null==(e=this.svgRoot)?void 0:e.parentNode;return!(!this.svgRoot||o?.lastChild===this.svgRoot||(o?.appendChild(this.svgRoot),0))}getRelativeToSurfaceXY(){return new A(this.workspace.RTL?-this.relativeLeft+this.anchor.x-this.size.width:this.anchor.x+this.relativeLeft,this.anchor.y+this.relativeTop)}getSvgRoot(){return this.svgRoot}moveDuringDrag(e){this.moveTo(e.x,e.y),this.relativeLeft=this.workspace.RTL?this.anchor.x-e.x-this.size.width:e.x-this.anchor.x,this.relativeTop=e.y-this.anchor.y,this.renderTail()}setDragging(e){}setDeleteStyle(e){}isDeletable(){return!1}showContextMenu(e){}isMovable(){return!0}startDrag(){this.dragStrategy.startDrag()}drag(e){this.dragStrategy.drag(e)}endDrag(){this.dragStrategy.endDrag()}revertDrag(){this.dragStrategy.revertDrag()}select(){To(this)}unselect(){To(null)}getFocusableElement(){return this.focusableElement}getFocusableTree(){return this.workspace}onNodeFocus(){this.select(),this.bringToFront()}onNodeBlur(){this.unselect()}canBeFocused(){return!0}};Ot=de,de.BORDER_WIDTH=6,de.DOUBLE_BORDER=2*Ot.BORDER_WIDTH,de.MIN_SIZE=Ot.DOUBLE_BORDER,de.TAIL_THICKNESS=1,de.TAIL_ANGLE=20,de.TAIL_BEND=4,de.ANCHOR_RADIUS=8;var So=class extends de{constructor(e,o,i,s){let n,l;super(o,i,s),this.workspace=o,this.anchor=i,this.ownerRect=s,this.autoLayout=!0,o=new no(e),this.validateWorkspaceOptions(o),this.svgDialog=I(v.SVG,{x:de.BORDER_WIDTH,y:de.BORDER_WIDTH},this.contentContainer),e.parentWorkspace=this.workspace,this.miniWorkspace=this.newWorkspaceSvg(new no(e)),this.miniWorkspace.internalIsMutator=!0,e=this.miniWorkspace.createDom("blocklyMutatorBackground"),this.svgDialog.appendChild(e),o.languageTree&&(e.insertBefore(this.miniWorkspace.addFlyout(v.G),this.miniWorkspace.getCanvas()),e=this.miniWorkspace.getFlyout(),e?.init(this.miniWorkspace),e?.show(o.languageTree)),R(this.svgRoot,"blocklyMiniWorkspaceBubble"),this.miniWorkspace.addChangeListener(this.onWorkspaceChange.bind(this)),null==(n=this.miniWorkspace.getFlyout())||null==(l=n.getWorkspace())||l.addChangeListener(this.onWorkspaceChange.bind(this)),this.updateBubbleSize()}dispose(){this.miniWorkspace.dispose(),super.dispose()}getWorkspace(){return this.miniWorkspace}addWorkspaceChangeListener(e){this.miniWorkspace.addChangeListener(e)}validateWorkspaceOptions(e){if(e.hasCategories)throw Error("The miniworkspace bubble does not support toolboxes with categories");if(e.hasTrashcan)throw Error("The miniworkspace bubble does not support trashcans");if(e.zoomOptions.controls||e.zoomOptions.wheel||e.zoomOptions.pinch)throw Error("The miniworkspace bubble does not support zooming");if(e.moveOptions.scrollbars||e.moveOptions.wheel||e.moveOptions.drag)throw Error("The miniworkspace bubble does not scrolling/moving the workspace");if(e.horizontalLayout)throw Error("The miniworkspace bubble does not support horizontal layouts")}onWorkspaceChange(){this.bumpBlocksIntoBounds(),this.updateBubbleSize()}bumpBlocksIntoBounds(){if(!this.miniWorkspace.isDragging()||this.miniWorkspace.keyboardMoveInProgress)for(const e of this.miniWorkspace.getTopBlocks(!1)){const o=e.getRelativeToSurfaceXY();if(o.y<20&&e.moveBy(0,20-o.y),e.RTL){let i=-20;const s=this.miniWorkspace.getFlyout();s&&(i-=s.getWidth()),o.x>i&&e.moveBy(i-o.x,0)}else o.x<20&&e.moveBy(20-o.x,0)}}updateBubbleSize(){if(!this.miniWorkspace.isDragging()||this.miniWorkspace.keyboardMoveInProgress){this.autoLayout&&(this.autoLayout=!this.miniWorkspace.keyboardMoveInProgress);var e=this.getSize(),o=this.calculateWorkspaceSize();Math.abs(e.width-o.width)<So.MINIMUM_VIEW_CHANGE&&Math.abs(e.height-o.height)<So.MINIMUM_VIEW_CHANGE||(this.svgDialog.setAttribute("width",`${o.width}px`),this.svgDialog.setAttribute("height",`${o.height}px`),this.miniWorkspace.setCachedParentSvgSize(o.width,o.height),this.miniWorkspace.RTL&&this.miniWorkspace.getCanvas().setAttribute("transform",`translate(${o.width}, 0)`),this.setSize(new ee(o.width+de.DOUBLE_BORDER,o.height+de.DOUBLE_BORDER),this.autoLayout),this.miniWorkspace.resize(),this.miniWorkspace.recordDragTargets())}}calculateWorkspaceSize(){var e=this.miniWorkspace.getCanvas().getBBox();let o=e.width+So.MARGIN;e=e.height+So.MARGIN;const i=this.miniWorkspace.getFlyout();if(i){const s=i.getWorkspace().getMetricsManager().getScrollMetrics();e=Math.max(e,s.height+20),o+=i.getWidth()}return new ee(o,e)}updateBlockStyles(){for(var e of this.miniWorkspace.getAllBlocks(!1))e.setStyle(e.getStyleName());let o;if(e=null==(o=this.miniWorkspace.getFlyout())?void 0:o.getWorkspace())for(const i of e.getAllBlocks(!1))i.setStyle(i.getStyleName())}moveDuringDrag(e){super.moveDuringDrag(e),this.autoLayout=!1}moveTo(e,o){super.moveTo(e,o),this.miniWorkspace.recordDragTargets()}newWorkspaceSvg(e){throw Error("The implementation of newWorkspaceSvg should be monkey-patched in by blockly.ts")}};So.MINIMUM_VIEW_CHANGE=10,So.MARGIN=3*de.DOUBLE_BORDER;var Rr=class{constructor(e){this.sourceBlock=e,this.offsetInBlock=new A(0,0),this.workspaceLocation=new A(0,0),this.svgRoot=null,this.tooltip=e,this.id=ct()}getType(){throw Error("Icons must implement getType")}initView(e){if(!this.svgRoot){var o=this.sourceBlock;this.svgRoot=I(v.G,{class:"blocklyIconGroup",id:this.id}),o.getSvgRoot().appendChild(this.svgRoot),this.updateSvgRootOffset(),U(this.svgRoot,"pointerdown",this,e),this.svgRoot.tooltip=this,Un(this.svgRoot)}}dispose(){bl(this.svgRoot),ce(this.svgRoot)}getWeight(){return-1}getSize(){return new ee(0,0)}setTooltip(e){this.tooltip=e??this.sourceBlock}getTooltip(){return this.tooltip}applyColour(){}updateEditable(){}updateCollapsed(){this.svgRoot&&(this.svgRoot.style.display=this.sourceBlock.isCollapsed()?"none":"block",jo(this)&&this.setBubbleVisible(!1))}hideForInsertionMarker(){this.svgRoot&&(this.svgRoot.style.display="none")}isShownWhenCollapsed(){return!1}setOffsetInBlock(e){this.offsetInBlock=e,this.updateSvgRootOffset()}updateSvgRootOffset(){let e;null==(e=this.svgRoot)||e.setAttribute("transform",`translate(${this.offsetInBlock.x}, ${this.offsetInBlock.y})`)}onLocationChange(e){this.workspaceLocation=A.sum(e,this.offsetInBlock)}onClick(){}isClickableInFlyout(e){return!0}getFocusableElement(){const e=this.svgRoot;if(!e)throw Error("Attempting to focus uninitialized icon.");return e}getFocusableTree(){return this.sourceBlock.workspace}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}getSourceBlock(){return this.sourceBlock}};t.MutatorIcon$$module$build$src$core$icons$mutator_icon=class extends Rr{constructor(e,o){super(o),this.flyoutBlockTypes=e,this.sourceBlock=o,this.saveConnectionsListener=this.updateWorkspacePid=this.rootBlock=this.miniWorkspaceBubble=null}getType(){return t.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE}initView(e){this.svgRoot||(super.initView(e),I(v.RECT,{class:"blocklyIconShape",rx:"4",ry:"4",height:"16",width:"16"},this.svgRoot),I(v.PATH,{class:"blocklyIconSymbol",d:"m4.203,7.296 0,1.368 -0.92,0.677 -0.11,0.41 0.9,1.559 0.41,0.11 1.043,-0.457 1.187,0.683 0.127,1.134 0.3,0.3 1.8,0 0.3,-0.299 0.127,-1.138 1.185,-0.682 1.046,0.458 0.409,-0.11 0.9,-1.559 -0.11,-0.41 -0.92,-0.677 0,-1.366 0.92,-0.677 0.11,-0.41 -0.9,-1.559 -0.409,-0.109 -1.046,0.458 -1.185,-0.682 -0.127,-1.138 -0.3,-0.299 -1.8,0 -0.3,0.3 -0.126,1.135 -1.187,0.682 -1.043,-0.457 -0.41,0.11 -0.899,1.559 0.108,0.409z"},this.svgRoot),I(v.CIRCLE,{class:"blocklyIconShape",r:"2.7",cx:"8",cy:"8"},this.svgRoot),R(this.svgRoot,"blocklyMutatorIcon"))}dispose(){let e;super.dispose(),null==(e=this.miniWorkspaceBubble)||e.dispose()}getWeight(){return t.MutatorIcon$$module$build$src$core$icons$mutator_icon.WEIGHT}getSize(){return new ee(17,17)}applyColour(){let e,o;super.applyColour(),null==(e=this.miniWorkspaceBubble)||e.setColour(this.sourceBlock.getColour()),null==(o=this.miniWorkspaceBubble)||o.updateBlockStyles()}updateCollapsed(){super.updateCollapsed(),this.sourceBlock.isCollapsed()&&this.setBubbleVisible(!1)}onLocationChange(e){let o;super.onLocationChange(e),null==(o=this.miniWorkspaceBubble)||o.setAnchorLocation(this.getAnchorLocation())}onClick(){super.onClick(),this.sourceBlock.isEditable()&&this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}bubbleIsVisible(){return!!this.miniWorkspaceBubble}setBubbleVisible(e){const o=this;return(0,C.asyncExecutePromiseGeneratorFunction)(function*(){if(o.bubbleIsVisible()!==e){if(yield Xt(),e){let i;o.miniWorkspaceBubble=new So(o.getMiniWorkspaceConfig(),o.sourceBlock.workspace,o.getAnchorLocation(),o.getBubbleOwnerRect()),o.applyColour(),o.createRootBlock(),o.addSaveConnectionsListener(),null==(i=o.miniWorkspaceBubble)||i.addWorkspaceChangeListener(o.createMiniWorkspaceChangeListener())}else{let i;null==(i=o.miniWorkspaceBubble)||i.dispose(),o.miniWorkspaceBubble=null,o.saveConnectionsListener&&o.sourceBlock.workspace.removeChangeListener(o.saveConnectionsListener),o.saveConnectionsListener=null}L(new(B(E.BUBBLE_OPEN))(o.sourceBlock,e,"mutator"))}})}getBubble(){return this.miniWorkspaceBubble}getMiniWorkspaceConfig(){let e;const o={disable:!1,media:this.sourceBlock.workspace.options.pathToMedia,rtl:this.sourceBlock.RTL,renderer:this.sourceBlock.workspace.options.renderer,rendererOverrides:null!=(e=this.sourceBlock.workspace.options.rendererOverrides)?e:void 0};return this.flyoutBlockTypes.length&&(o.toolbox={kind:"flyoutToolbox",contents:this.flyoutBlockTypes.map(i=>({kind:"block",type:i}))}),o}getAnchorLocation(){return A.sum(this.workspaceLocation,new A(8.5,8.5))}getBubbleOwnerRect(){const e=this.sourceBlock.getSvgRoot().getBBox();return new Q(e.y,e.y+e.height,e.x,e.x+e.width)}createRootBlock(){if(!this.sourceBlock.decompose)throw Error("Blocks with mutator icons must include a decompose method");for(var e of(this.rootBlock=this.sourceBlock.decompose(this.miniWorkspaceBubble.getWorkspace()),this.rootBlock.getDescendants(!1)))e.queueRender();let o,i,s,n;this.rootBlock.setMovable(!1),this.rootBlock.setDeletable(!1),e=null!=(n=null==(o=this.miniWorkspaceBubble)||null==(i=o.getWorkspace())||null==(s=i.getFlyout())?void 0:s.getWidth())?n:0,this.rootBlock.moveBy(this.rootBlock.RTL?-(e+16):16,16)}addSaveConnectionsListener(){this.sourceBlock.saveConnections&&this.rootBlock&&(this.saveConnectionsListener=()=>{this.sourceBlock.saveConnections&&this.rootBlock&&this.sourceBlock.saveConnections(this.rootBlock)},this.saveConnectionsListener(),this.sourceBlock.workspace.addChangeListener(this.saveConnectionsListener))}createMiniWorkspaceChangeListener(){return e=>{t.MutatorIcon$$module$build$src$core$icons$mutator_icon.isIgnorableMutatorEvent(e)||this.updateWorkspacePid||(this.updateWorkspacePid=setTimeout(()=>{this.updateWorkspacePid=null,this.recomposeSourceBlock()},0))}}static isIgnorableMutatorEvent(e){return e.isUiEvent||_o(e)||zt(e)&&"disabled"===e.element}recomposeSourceBlock(){if(this.rootBlock){if(!this.sourceBlock.compose)throw Error("Blocks with mutator icons must include a compose method");var e=t.getGroup$$module$build$src$core$events$utils();e||t.setGroup$$module$build$src$core$events$utils(!0);var o=Gi.getExtraBlockState_(this.sourceBlock);this.sourceBlock.compose(this.rootBlock);var i=Gi.getExtraBlockState_(this.sourceBlock);o!==i&&L(new(B(E.BLOCK_CHANGE))(this.sourceBlock,"mutation",null,o,i)),t.setGroup$$module$build$src$core$events$utils(e)}}getWorkspace(){let e;return null==(e=this.miniWorkspaceBubble)?void 0:e.getWorkspace()}},t.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE=Ue.MUTATOR,t.MutatorIcon$$module$build$src$core$icons$mutator_icon.WEIGHT=1;var Mr=Object.create(null),Rb={allExtensions:Mr};t.register$$module$build$src$core$extensions("parent_tooltip_when_inline",pu);var ro={TEST_ONLY:Rb};ro.apply=zn,ro.buildTooltipForDropdown=t.buildTooltipForDropdown$$module$build$src$core$extensions,ro.buildTooltipWithFieldText=t.buildTooltipWithFieldText$$module$build$src$core$extensions,ro.isRegistered=Sl,ro.register=t.register$$module$build$src$core$extensions,ro.registerMixin=t.registerMixin$$module$build$src$core$extensions,ro.registerMutator=t.registerMutator$$module$build$src$core$extensions,ro.runAfterPageLoad=Vh,ro.unregister=lu;var me=function(e){return e[e.WIN_KEY_FF_LINUX=0]="WIN_KEY_FF_LINUX",e[e.MAC_ENTER=3]="MAC_ENTER",e[e.BACKSPACE=8]="BACKSPACE",e[e.TAB=9]="TAB",e[e.NUM_CENTER=12]="NUM_CENTER",e[e.ENTER=13]="ENTER",e[e.SHIFT=16]="SHIFT",e[e.CTRL=17]="CTRL",e[e.ALT=18]="ALT",e[e.PAUSE=19]="PAUSE",e[e.CAPS_LOCK=20]="CAPS_LOCK",e[e.ESC=27]="ESC",e[e.SPACE=32]="SPACE",e[e.PAGE_UP=33]="PAGE_UP",e[e.PAGE_DOWN=34]="PAGE_DOWN",e[e.END=35]="END",e[e.HOME=36]="HOME",e[e.LEFT=37]="LEFT",e[e.UP=38]="UP",e[e.RIGHT=39]="RIGHT",e[e.DOWN=40]="DOWN",e[e.PLUS_SIGN=43]="PLUS_SIGN",e[e.PRINT_SCREEN=44]="PRINT_SCREEN",e[e.INSERT=45]="INSERT",e[e.DELETE=46]="DELETE",e[e.ZERO=48]="ZERO",e[e.ONE=49]="ONE",e[e.TWO=50]="TWO",e[e.THREE=51]="THREE",e[e.FOUR=52]="FOUR",e[e.FIVE=53]="FIVE",e[e.SIX=54]="SIX",e[e.SEVEN=55]="SEVEN",e[e.EIGHT=56]="EIGHT",e[e.NINE=57]="NINE",e[e.FF_SEMICOLON=59]="FF_SEMICOLON",e[e.FF_EQUALS=61]="FF_EQUALS",e[e.FF_DASH=173]="FF_DASH",e[e.FF_HASH=163]="FF_HASH",e[e.QUESTION_MARK=63]="QUESTION_MARK",e[e.AT_SIGN=64]="AT_SIGN",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.META=91]="META",e[e.WIN_KEY_RIGHT=92]="WIN_KEY_RIGHT",e[e.CONTEXT_MENU=93]="CONTEXT_MENU",e[e.NUM_ZERO=96]="NUM_ZERO",e[e.NUM_ONE=97]="NUM_ONE",e[e.NUM_TWO=98]="NUM_TWO",e[e.NUM_THREE=99]="NUM_THREE",e[e.NUM_FOUR=100]="NUM_FOUR",e[e.NUM_FIVE=101]="NUM_FIVE",e[e.NUM_SIX=102]="NUM_SIX",e[e.NUM_SEVEN=103]="NUM_SEVEN",e[e.NUM_EIGHT=104]="NUM_EIGHT",e[e.NUM_NINE=105]="NUM_NINE",e[e.NUM_MULTIPLY=106]="NUM_MULTIPLY",e[e.NUM_PLUS=107]="NUM_PLUS",e[e.NUM_MINUS=109]="NUM_MINUS",e[e.NUM_PERIOD=110]="NUM_PERIOD",e[e.NUM_DIVISION=111]="NUM_DIVISION",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.NUMLOCK=144]="NUMLOCK",e[e.SCROLL_LOCK=145]="SCROLL_LOCK",e[e.FIRST_MEDIA_KEY=166]="FIRST_MEDIA_KEY",e[e.LAST_MEDIA_KEY=183]="LAST_MEDIA_KEY",e[e.SEMICOLON=186]="SEMICOLON",e[e.DASH=189]="DASH",e[e.EQUALS=187]="EQUALS",e[e.COMMA=188]="COMMA",e[e.PERIOD=190]="PERIOD",e[e.SLASH=191]="SLASH",e[e.APOSTROPHE=192]="APOSTROPHE",e[e.TILDE=192]="TILDE",e[e.SINGLE_QUOTE=222]="SINGLE_QUOTE",e[e.OPEN_SQUARE_BRACKET=219]="OPEN_SQUARE_BRACKET",e[e.BACKSLASH=220]="BACKSLASH",e[e.CLOSE_SQUARE_BRACKET=221]="CLOSE_SQUARE_BRACKET",e[e.WIN_KEY=224]="WIN_KEY",e[e.MAC_FF_META=224]="MAC_FF_META",e[e.MAC_WK_CMD_LEFT=91]="MAC_WK_CMD_LEFT",e[e.MAC_WK_CMD_RIGHT=93]="MAC_WK_CMD_RIGHT",e[e.WIN_IME=229]="WIN_IME",e[e.VK_NONAME=252]="VK_NONAME",e[e.PHANTOM=255]="PHANTOM",e}(me||{}),si={};si.arc=a,si.curve=at,si.line=r,si.lineOnAxis=c,si.lineTo=T,si.moveBy=u,si.moveTo=He,si.point=P;var Ie={};Ie.Coordinate=A,Ie.KeyCodes=me,Ie.Rect=Q,Ie.Size=ee,Ie.Svg=v,Ie.aria=lc,Ie.array=Im,Ie.browserEvents=Qo,Ie.colour=qt,Ie.deprecation=e$,Ie.dom=et,Ie.extensions=ro,Ie.idGenerator=ip,Ie.math=Su,Ie.object=vm,Ie.parsing=_c,Ie.string=kr,Ie.style=Pi,Ie.svgMath=js,Ie.svgPaths=si,Ie.toolbox=Fi,Ie.userAgent=y_,Ie.xml=vr;var se=class{constructor(e,o){if(this.type=o,this.targetConnection=null,this.disposed=!1,this.shadowDom=this.check=null,this.y=this.x=0,this.shadowState=null,this.sourceBlock_=e,e.id.includes("_connection"))throw Error(`Connection ID indicator is contained in block ID. This will cause problems with focus: ${e.id}.`);this.id=`${e.id}_connection_${ct()}`}connect_(e){const o=N.INPUT_VALUE,i=this.getSourceBlock();var s=e.getSourceBlock();let n,l;if(e.isConnected()&&e.disconnectInternal(!1),this.isConnected()){const h=this.stashShadowState(),$=this.targetBlock();$.isShadow()?$.dispose(!1):(this.disconnectInternal(),n=$),this.applyShadowState(h)}_e()&&(l=new(B(E.BLOCK_MOVE))(s),l.setReason(["connect"])),g(this,e),s.setParent(i),l&&(l.recordNew(),L(l)),n&&(e=this.type===o?n.outputConnection:n.previousConnection)&&((s=se.getConnectionForOrphanedConnection(s,e))?e.connect(s):e.onFailedConnect(this))}dispose(){if(this.isConnected()){this.isSuperior()&&this.setShadowStateInternal();const e=this.targetBlock();e&&!e.isDeadOrDying()&&e.unplug()}this.disposed=!0}getSourceBlock(){return this.sourceBlock_}isSuperior(){return this.type===N.INPUT_VALUE||this.type===N.NEXT_STATEMENT}isConnected(){return!!this.targetConnection}getConnectionChecker(){return this.sourceBlock_.workspace.connectionChecker}onFailedConnect(e){}connect(e){if(this.targetConnection===e)return!0;if(this.getConnectionChecker().canConnect(this,e,!1)){const o=t.getGroup$$module$build$src$core$events$utils();o||t.setGroup$$module$build$src$core$events$utils(!0),this.isSuperior()?this.connect_(e):e.connect_(this),t.setGroup$$module$build$src$core$events$utils(o)}return this.isConnected()}disconnect(){this.disconnectInternal()}disconnectInternal(e=!0){const{parentConnection:o,childConnection:i}=this.getParentAndChildConnections();if(!o||!i)throw Error("Source connection not connected.");const s=t.getGroup$$module$build$src$core$events$utils();let n;s||t.setGroup$$module$build$src$core$events$utils(!0),_e()&&(n=new(B(E.BLOCK_MOVE))(i.getSourceBlock()),n.setReason(["disconnect"]));const l=this.targetConnection;l&&(l.targetConnection=null),this.targetConnection=null,e&&i.getSourceBlock().setParent(null),n&&(n.recordNew(),L(n)),i.getSourceBlock().isShadow()||o.respawnShadow_(),t.setGroup$$module$build$src$core$events$utils(s)}getParentAndChildConnections(){return this.targetConnection?this.isSuperior()?{parentConnection:this,childConnection:this.targetConnection}:{parentConnection:this.targetConnection,childConnection:this}:{}}respawnShadow_(){this.createShadowBlock(!0)}reconnect(e,o){return!(this.getSourceBlock().isDeadOrDying()||(o=null==(i=e.getInput(o))?void 0:i.connection,(i=this.targetBlock())&&i!==e||!o||o.targetConnection===this||(o.isConnected()&&o.disconnect(),o.connect(this),0)));var i}targetBlock(){if(this.isConnected()){let e,o;return null!=(o=null==(e=this.targetConnection)?void 0:e.getSourceBlock())?o:null}return null}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()}setCheck(e){return e?(Array.isArray(e)||(e=[e]),this.check=e,this.onCheckChanged_()):this.check=null,this}getCheck(){return this.check}setShadowDom(e){this.setShadowStateInternal({shadowDom:e})}getShadowDom(e){return e&&this.targetBlock().isShadow()?Co(this.targetBlock()):this.shadowDom}setShadowState(e){this.setShadowStateInternal({shadowState:e})}getShadowState(e){return e&&this.targetBlock()&&this.targetBlock().isShadow()?Tt(this.targetBlock()):this.shadowState}neighbours(e){return[]}getParentInput(){let e=null;const o=this.sourceBlock_.inputList;for(let i=0;i<o.length;i++)if(o[i].connection===this){e=o[i];break}return e}toString(){const e=this.sourceBlock_;if(!e)return"Orphan Connection";if(e.outputConnection===this)var o="Output Connection of ";else if(e.previousConnection===this)o="Previous Connection of ";else if(e.nextConnection===this)o="Next Connection of ";else{o=null;for(let s,i=0;s=e.inputList[i];i++)if(s.connection===this){o=s;break}if(!o)return console.warn("Connection not actually connected to sourceBlock_"),"Orphan Connection";o='Input "'+o.name+'" connection on '}return o+e.toDevString()}stashShadowState(){const e=this.getShadowDom(!0),o=this.getShadowState(!0);return this.shadowState=this.shadowDom=null,{shadowDom:e,shadowState:o}}applyShadowState({shadowDom:e,shadowState:o}){this.shadowDom=e,this.shadowState=o}setShadowStateInternal({shadowDom:e=null,shadowState:o=null}={}){this.shadowDom=e,this.shadowState=o,this.getSourceBlock().isDeadOrDying()||((e=this.targetBlock())?e.isShadow()?(e.dispose(!1),this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow(this.targetBlock())):(e=this.createShadowBlock(!1),this.serializeShadow(e),e&&e.dispose(!1)):(this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow(this.targetBlock())))}createShadowBlock(e){var o=this.getSourceBlock();const i=this.getShadowState(),s=this.getShadowDom();if(o.isDeadOrDying()||!i&&!s)return null;if(i)return vs(i,o.workspace,{parentConnection:e?this:void 0,isShadow:!0,recordUndo:!1});if(s){if(o=Xo(s,o.workspace),e)if(this.type===N.INPUT_VALUE){if(!o.outputConnection)throw Error("Shadow block is missing an output connection");if(!this.connect(o.outputConnection))throw Error("Could not connect shadow block to connection")}else{if(this.type!==N.NEXT_STATEMENT)throw Error("Cannot connect a shadow block to a previous/output connection");if(!o.previousConnection)throw Error("Shadow block is missing previous connection");if(!this.connect(o.previousConnection))throw Error("Could not connect shadow block to connection")}return o}return null}serializeShadow(e){e&&(this.shadowDom=Co(e),this.shadowState=Tt(e))}static getConnectionForOrphanedConnection(e,o){if(o.type===N.OUTPUT_VALUE)return S(e,o.getSourceBlock());e=e.lastConnectionInStack(!0);const i=o.getConnectionChecker();return e&&i.canConnect(o,e,!1)?e:null}};se.CAN_CONNECT=0,se.REASON_SELF_CONNECTION=1,se.REASON_WRONG_TYPE=2,se.REASON_TARGET_NULL=3,se.REASON_CHECKS_FAILED=4,se.REASON_DIFFERENT_WORKSPACES=5,se.REASON_SHADOW_PARENT=6,se.REASON_DRAG_CHECKS_FAILED=7,se.REASON_PREVIOUS_AND_OUTPUT=8;var y$=class extends Error{constructor(e){super(`Tried to append an icon of type ${e.getType()} when an icon of that type already exists on the block. Use getIcon to access the existing icon.`),this.icon=e}},x$={};x$.DuplicateIconType=y$,function(e){e[e.LEFT=-1]="LEFT",e[e.CENTRE=0]="CENTRE",e[e.RIGHT=1]="RIGHT"}(t.Align$$module$build$src$core$inputs$align||(t.Align$$module$build$src$core$inputs$align={}));var zi=class extends ue{constructor(e,o,i){super(ue.SKIP_SETUP),this.class=null,this.EDITABLE=!1,this.maxDisplayLength=1/0,e!==ue.SKIP_SETUP&&(i?this.configure_(i):this.class=o||null,this.setValue(e))}configure_(e){super.configure_(e),e.class&&(this.class=e.class)}initView(){this.createTextElement_(),this.class&&R(this.getTextElement(),this.class),this.fieldGroup_&&R(this.fieldGroup_,"blocklyLabelField")}doClassValidation_(e){return null==e?null:`${e}`}setClass(e){this.textElement_&&(this.class&&te(this.textElement_,this.class),e&&R(this.textElement_,e)),this.class=e}static fromJson(e){return new this(Ae(e.text),void 0,e)}};Pt("field_label",zi),zi.prototype.DEFAULT_VALUE="";var ni=[];ni[N.INPUT_VALUE]=N.OUTPUT_VALUE,ni[N.OUTPUT_VALUE]=N.INPUT_VALUE,ni[N.NEXT_STATEMENT]=N.PREVIOUS_STATEMENT,ni[N.PREVIOUS_STATEMENT]=N.NEXT_STATEMENT;var Ec="RENAME_VARIABLE_ID",vc="DELETE_VARIABLE_ID",Xe=class extends se{constructor(e,o){super(e,o),this.highlighted=!1,this.targetConnection=null,this.db=e.workspace.connectionDBList[o],this.dbOpposite=e.workspace.connectionDBList[ni[o]],this.offsetInBlock=new A(0,0),this.trackedState=Xe.TrackedState.WILL_TRACK}dispose(){let e,o;super.dispose(),this.trackedState===Xe.TrackedState.TRACKED&&this.db.removeConnection(this,this.y),null==(o=(e=this.sourceBlock_.pathObject).removeConnectionHighlight)||o.call(e,this)}getSourceBlock(){return super.getSourceBlock()}targetBlock(){return super.targetBlock()}distanceFrom(e){const o=this.x-e.x;return e=this.y-e.y,Math.sqrt(o*o+e*e)}bumpAwayFrom(e,o=!1){if(!this.sourceBlock_.workspace.isDragging()){var i=t.config$$module$build$src$core$config.snapRadius+Math.floor(10*Math.random()),s=t.config$$module$build$src$core$config.snapRadius+Math.floor(10*Math.random()),n=e.sourceBlock_.getRootBlock(),l=this.sourceBlock_.getRootBlock();if(!n.isInFlyout&&!l.isInFlyout){var h=!0;if(l.isMovable())n.isMovable()&&o&&(s=-s);else{if(!n.isMovable())return;h=!1,i=-i,s=-s}(n=h?l:n).RTL&&(i=-i),n.moveBy((o=h?e:this).x+i-(e=h?this:e).x,o.y+s-e.y,["bump"])}}}moveTo(e,o){let i=!1;return this.trackedState===Xe.TrackedState.WILL_TRACK?(this.db.addConnection(this,o),this.trackedState=Xe.TrackedState.TRACKED,i=!0):this.trackedState===Xe.TrackedState.TRACKED&&(this.db.removeConnection(this,this.y),this.db.addConnection(this,o),i=!0),this.x=e,this.y=o,i}moveBy(e,o){return this.moveTo(this.x+e,this.y+o)}moveToOffset(e){return this.moveTo(e.x+this.offsetInBlock.x,e.y+this.offsetInBlock.y)}setOffsetInBlock(e,o){this.offsetInBlock.x=e,this.offsetInBlock.y=o}getOffsetInBlock(){return this.offsetInBlock}tightenEfficiently(){var e=this.targetConnection;const o=this.targetBlock();e&&o&&(e=A.difference(this.offsetInBlock,e.offsetInBlock),o.translate(e.x,e.y))}closest(e,o){return this.dbOpposite.searchForClosest(this,e,o)}highlight(){this.highlighted=!0;const e=this.findHighlightSvg();e&&(e.style.display="")}unhighlight(){this.highlighted=!1;const e=this.findHighlightSvg();e&&(e.style.display="none")}isHighlighted(){return this.highlighted}setTracking(e){e&&this.trackedState===Xe.TrackedState.TRACKED||!e&&this.trackedState===Xe.TrackedState.UNTRACKED||this.sourceBlock_.isInFlyout||(e?(this.db.addConnection(this,this.y),this.trackedState=Xe.TrackedState.TRACKED):(this.trackedState===Xe.TrackedState.TRACKED&&this.db.removeConnection(this,this.y),this.trackedState=Xe.TrackedState.UNTRACKED))}stopTrackingAll(){if(this.setTracking(!1),this.targetConnection){const e=this.targetBlock().getDescendants(!1);for(let o=0;o<e.length;o++){const i=e[o],s=i.getConnections_(!0);for(let n=0;n<s.length;n++)s[n].setTracking(!1);for(const n of i.getIcons())jo(n)&&n.setBubbleVisible(!1)}}}startTrackingAll(){this.setTracking(!0);let e=[];if(this.type!==N.INPUT_VALUE&&this.type!==N.NEXT_STATEMENT)return e;const o=this.targetBlock();if(o){let i;o.isCollapsed()?(i=[],o.outputConnection&&i.push(o.outputConnection),o.nextConnection&&i.push(o.nextConnection),o.previousConnection&&i.push(o.previousConnection)):i=o.getConnections_(!0);for(let s=0;s<i.length;s++)e.push(...i[s].startTrackingAll());e.length||(e=[o])}return e}onFailedConnect(e){const o=this.getSourceBlock();if(Ze()){const i=t.getGroup$$module$build$src$core$events$utils();setTimeout(function(){o.isDisposed()||o.getParent()||(t.setGroup$$module$build$src$core$events$utils(i),this.bumpAwayFrom(e),t.setGroup$$module$build$src$core$events$utils(!1))}.bind(this),t.config$$module$build$src$core$config.bumpDelay)}}disconnectInternal(e=!0){const{parentConnection:o,childConnection:i}=this.getParentAndChildConnections();if(o&&i){var s=t.getGroup$$module$build$src$core$events$utils();s||t.setGroup$$module$build$src$core$events$utils(!0);var n=o.getSourceBlock(),l=i.getSourceBlock();super.disconnectInternal(e),n.queueRender(),l.updateDisabled(),l.queueRender(),l.getSvgRoot().style.display="block",t.setGroup$$module$build$src$core$events$utils(s)}}respawnShadow_(){super.respawnShadow_();const e=this.targetBlock();e&&(e.initSvg(),e.queueRender())}neighbours(e){return this.dbOpposite.getNeighbours(this,e)}connect_(e){super.connect_(e);var o=this.getSourceBlock();e=e.getSourceBlock(),o.updateDisabled(),e.updateDisabled(),e.queueRender(),(o=o.getInputWithBlock(e))&&(o=o.isVisible(),e.getSvgRoot().style.display=o?"block":"none")}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()}setCheck(e){return super.setCheck(e),this.sourceBlock_.queueRender(),this}showContextMenu(e){const o=K.registry.getContextMenuOptions({focusedNode:this},e);if(o.length){var i=this.getSourceBlock(),s=i.workspace;if(e instanceof PointerEvent)var n=new A(e.clientX,e.clientY);else n=new A(this.x,this.y),n=yo(s,n).translate(i.RTL?-5:5,5);As(e,o,i.RTL,s,n)}}getFocusableElement(){const e=this.findHighlightSvg();if(e)return e;throw Error("No highlight SVG found corresponding to this connection.")}getFocusableTree(){return this.getSourceBlock().workspace}onNodeFocus(){this.highlight()}onNodeBlur(){this.unhighlight()}canBeFocused(){return!0}findHighlightSvg(){return document.getElementById(this.id)}};!function(e){(e=e.TrackedState||(e.TrackedState={}))[e.WILL_TRACK=-1]="WILL_TRACK",e[e.UNTRACKED=0]="UNTRACKED",e[e.TRACKED=1]="TRACKED"}(Xe||(Xe={}));var Bb=Xe.TrackedState,k$={};k$.RenderedConnection=Xe,k$.TrackedState=Bb;var sn=class{constructor(e,o){this.name=e,this.sourceBlock=o,this.fieldRow=[],this.align=t.Align$$module$build$src$core$inputs$align.LEFT,this.visible=!0,this.type=t.inputTypes$$module$build$src$core$inputs$input_types.CUSTOM,this.connection=null}getSourceBlock(){return this.sourceBlock}appendField(e,o){return this.insertFieldAt(this.fieldRow.length,e,o),this}insertFieldAt(e,o,i){if(e<0||e>this.fieldRow.length)throw Error("index "+e+" out of bounds.");return(o||""===o&&i)&&("string"==typeof o&&(o=t.fromJson$$module$build$src$core$field_registry({type:"field_label",text:o})),o.setSourceBlock(this.sourceBlock),this.sourceBlock.initialized&&this.initField(o),o.name=i,o.setVisible(this.isVisible()),o.prefixField&&(e=this.insertFieldAt(e,o.prefixField)),this.fieldRow.splice(e,0,o),e++,o.suffixField&&(e=this.insertFieldAt(e,o.suffixField)),this.sourceBlock.rendered&&this.sourceBlock.queueRender()),e}removeField(e,o){for(let s,i=0;s=this.fieldRow[i];i++)if(s.name===e)return s.dispose(),this.fieldRow.splice(i,1),this.sourceBlock.rendered&&this.sourceBlock.queueRender(),!0;if(o)return!1;throw Error('Field "'+e+'" not found.')}isVisible(){return this.visible}setVisible(e){let o=[];if(this.visible===e)return o;this.visible=e;for(let s,i=0;s=this.fieldRow[i];i++)s.setVisible(e);if(this.connection&&this.connection instanceof Xe){e?o=this.connection.startTrackingAll():this.connection.stopTrackingAll();const i=this.connection.targetBlock();i&&(i.getSvgRoot().style.display=e?"block":"none")}return o}markDirty(){for(let o,e=0;o=this.fieldRow[e];e++)o.markDirty()}setCheck(e){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setCheck(e),this}setAlign(e){return this.align=e,this.sourceBlock.rendered&&this.sourceBlock.queueRender(),this}setShadowDom(e){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setShadowDom(e),this}getShadowDom(){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.getShadowDom()}init(){for(const e of this.fieldRow)e.init()}initModel(){for(const e of this.fieldRow)e.initModel()}initField(e){this.sourceBlock.rendered?e.init():e.initModel()}dispose(){for(let o,e=0;o=this.fieldRow[e];e++)o.dispose();this.connection&&this.connection.dispose()}makeConnection(e){return this.sourceBlock.makeConnection_(e)}},lo=class extends sn{constructor(e,o){super(e,o),this.name=e,this.type=t.inputTypes$$module$build$src$core$inputs$input_types.DUMMY}},Oo=class extends sn{constructor(e,o){super(e,o),this.name=e,this.type=t.inputTypes$$module$build$src$core$inputs$input_types.END_ROW}},xt=class extends sn{constructor(e,o){if(!e)throw Error("Statement inputs must have a non-empty name");super(e,o),this.name=e,this.type=t.inputTypes$$module$build$src$core$inputs$input_types.STATEMENT,this.connection=this.makeConnection(N.NEXT_STATEMENT)}};t.ValueInput$$module$build$src$core$inputs$value_input=class extends sn{constructor(e,o){if(!e)throw Error("Value inputs must have a non-empty name");super(e,o),this.name=e,this.type=t.inputTypes$$module$build$src$core$inputs$input_types.VALUE,this.connection=this.makeConnection(N.INPUT_VALUE)}};var nn=class{constructor(e,o,i){if(this.data=null,this.disposed=!1,this.hue=null,this.colour_="#000000",this.styleName_="",this.suppressPrefixSuffix=!1,this.previousConnection=this.nextConnection=this.outputConnection=null,this.inputList=[],this.icons=[],this.disabledReasons=new Set,this.tooltip="",this.contextMenu=!0,this.parentBlock_=null,this.childBlocks_=[],this.editable=this.movable=this.deletable=!0,this.collapsed_=this.shadow=!1,this.outputShape_=null,this.rendered=this.isInsertionMarker_=this.initialized=this.disposing=!1,this.onchangeWrapper=this.helpUrl=null,this.statementInputCount=0,this.workspace=e,this.id=i&&!e.getBlockById(i)?i:Ne(),e.setBlockById(this.id,this),this.xy=new A(0,0),this.isInFlyout=e.isFlyout,this.isInMutator=e.isMutator,this.RTL=e.RTL,o){if(this.type=o,!(i=ye[o])||"object"!=typeof i)throw TypeError("Invalid block definition for type: "+o);Object.assign(this,i)}e.addTopBlock(this),e.addTypedBlock(this),new.target===nn&&this.doInit_()}doInit_(){const e=t.getGroup$$module$build$src$core$events$utils();e||t.setGroup$$module$build$src$core$events$utils(!0);const o=Ze();try{"function"==typeof this.init&&(t.setRecordUndo$$module$build$src$core$events$utils(!1),this.init(),t.setRecordUndo$$module$build$src$core$events$utils(o)),_e()&&L(new(B(E.BLOCK_CREATE))(this))}finally{t.setGroup$$module$build$src$core$events$utils(e),t.setRecordUndo$$module$build$src$core$events$utils(o)}this.inputsInlineDefault=this.inputsInline,"function"==typeof this.onchange&&this.setOnChange(this.onchange)}dispose(e=!1){this.disposing=!0,this.onchangeWrapper&&this.workspace.removeChangeListener(this.onchangeWrapper),this.unplug(e),_e()&&L(new(B(E.BLOCK_DELETE))(this)),this.workspace.removeTopBlock(this),this.disposeInternal()}disposeInternal(){this.disposing=!0,this.onchangeWrapper&&this.workspace.removeChangeListener(this.onchangeWrapper),this.workspace.removeTypedBlock(this),this.workspace.removeBlockById(this.id),"function"==typeof this.destroy&&this.destroy(),this.childBlocks_.forEach(e=>e.disposeInternal()),this.inputList.forEach(e=>e.dispose()),this.inputList.length=0,this.getConnections_(!0).forEach(e=>e.dispose()),this.disposed=!0}isDeadOrDying(){return this.disposing||this.disposed}initModel(){if(!this.initialized){for(const e of this.inputList)e.initModel();this.initialized=!0}}unplug(e){this.outputConnection&&this.unplugFromRow(e),this.previousConnection&&this.unplugFromStack(e)}unplugFromRow(e){let i,o=null;null!=(i=this.outputConnection)&&i.isConnected()&&(o=this.outputConnection.targetConnection,this.outputConnection.disconnect()),o&&e&&(e=this.getOnlyValueConnection())&&e.isConnected()&&!e.targetBlock().isShadow()&&(e=e.targetConnection,e?.disconnect(),this.workspace.connectionChecker.canConnect(e,o,!1)?o.connect(e):e?.onFailedConnect(o))}getOnlyValueConnection(){let e=null;for(let o=0;o<this.inputList.length;o++){const i=this.inputList[o].connection;if(i&&i.type===N.INPUT_VALUE&&i.targetConnection){if(e)return null;e=i}}return e}unplugFromStack(e){let o=null;var i;if(null!=(i=this.previousConnection)&&i.isConnected()&&(o=this.previousConnection.targetConnection,this.previousConnection.disconnect()),i=this.getNextBlock(),e&&i&&!i.isShadow()){let s,n;e=null!=(n=null==(s=this.nextConnection)?void 0:s.targetConnection)?n:null,e?.disconnect(),o&&this.workspace.connectionChecker.canConnect(o,e,!1)&&o.connect(e)}}getConnections_(e){e=[],this.outputConnection&&e.push(this.outputConnection),this.previousConnection&&e.push(this.previousConnection),this.nextConnection&&e.push(this.nextConnection);for(let i,o=0;i=this.inputList[o];o++)i.connection&&e.push(i.connection);return e}lastConnectionInStack(e){let o=this.nextConnection;for(;o;){const i=o.targetBlock();if(!i||e&&i.isShadow())return o;o=i.nextConnection}return null}bumpNeighbours(){}getParent(){return this.parentBlock_}getInputWithBlock(e){for(let i,o=0;i=this.inputList[o];o++)if(i.connection&&i.connection.targetBlock()===e)return i;return null}getSurroundParent(){let o,e=this;do{if(o=e,e=e.getParent(),!e)return null}while(e.getNextBlock()===o);return e}getNextBlock(){return this.nextConnection&&this.nextConnection.targetBlock()}getPreviousBlock(){return this.previousConnection&&this.previousConnection.targetBlock()}getRootBlock(){let e,o=this;do{e=o,o=e.parentBlock_}while(o);return e}getTopStackBlock(){let o,e=this;do{o=e.getPreviousBlock()}while(o&&o.getNextBlock()===e&&(e=o));return e}getChildren(e){if(!e)return this.childBlocks_;e=[];for(let s,i=0;s=this.inputList[i];i++)if(s.connection){var o=s.connection.targetBlock();o&&e.push(o)}return(o=this.getNextBlock())&&e.push(o),e}setParent(e){if(e!==this.parentBlock_){var o=this.previousConnection&&this.previousConnection.targetBlock()||this.outputConnection&&this.outputConnection.targetBlock(),i=!!o;if(i&&e&&o!==e)throw Error("Block connected to superior one that is not new parent.");if(!i&&e)throw Error("Block not connected to new parent.");if(i&&!e)throw Error("Cannot set parent to null while block is still connected to superior block.");this.parentBlock_?ft(this.parentBlock_.childBlocks_,this):this.workspace.removeTopBlock(this),(this.parentBlock_=e)?e.childBlocks_.push(this):this.workspace.addTopBlock(this)}}getDescendants(e){const o=[this],i=this.getChildren(e);for(let s,n=0;s=i[n];n++)o.push(...s.getDescendants(e));return o}isDeletable(){return this.deletable&&!this.isInFlyout&&!this.shadow&&!this.isDeadOrDying()&&!this.workspace.isReadOnly()}isOwnDeletable(){return this.deletable}setDeletable(e){this.deletable=e}isMovable(){return this.movable&&!this.isInFlyout&&!this.shadow&&!this.isDeadOrDying()&&!this.workspace.isReadOnly()}isOwnMovable(){return this.movable}setMovable(e){this.movable=e}isDuplicatable(){return!this.workspace.hasBlockLimits()||this.workspace.isCapacityAvailable(hs(this,!0))}isShadow(){return this.shadow}setShadow(e){this.shadow=e}isInsertionMarker(){return this.isInsertionMarker_}setInsertionMarker(e){this.isInsertionMarker_=e}isEditable(){return this.editable&&!this.isDeadOrDying()&&!this.workspace.isReadOnly()}isOwnEditable(){return this.editable}setEditable(e){this.editable=e;for(const o of this.getFields())o.updateEditable()}isDisposed(){return this.disposed}isSimpleReporter(){if(!this.outputConnection)return!1;for(const e of this.inputList)if(e.connection||e.fieldRow.length>1)return!1;return!0}getMatchingConnection(e,o){const i=this.getConnections_(!0);if(e=e.getConnections_(!0),i.length!==e.length)throw Error("Connection lists did not match in length.");for(let s=0;s<e.length;s++)if(e[s]===o)return i[s];return null}setHelpUrl(e){this.helpUrl=e}setTooltip(e){this.tooltip=e}getTooltip(){return xs(this)}getColour(){return this.colour_}getStyleName(){return this.styleName_}getHue(){return this.hue}setColour(e){e=ks(e),this.hue=e.hue,this.colour_=e.hex}setStyle(e){this.styleName_=e}setOnChange(e){if(e&&"function"!=typeof e)throw Error("onchange must be a function.");this.onchangeWrapper&&this.workspace.removeChangeListener(this.onchangeWrapper),this.onchange=e,this.onchangeWrapper=e.bind(this),this.workspace.addChangeListener(this.onchangeWrapper)}getField(e){if("string"!=typeof e)throw TypeError("Block.prototype.getField expects a string with the field name but received "+(void 0===e?"nothing":e+" of type "+typeof e)+" instead");for(const o of this.getFields())if(o.name===e)return o;return null}*getFields(){for(const e of this.inputList)for(const o of e.fieldRow)yield o}getVars(){const e=[];for(const o of this.getFields())o.referencesVariables()&&e.push(o.getValue());return e}getVarModels(){const e=[];for(const o of this.getFields())if(o.referencesVariables()){const i=this.workspace.getVariableById(o.getValue());i&&e.push(i)}return e}updateVarName(e){for(const o of this.getFields())o.referencesVariables()&&e.getId()===o.getValue()&&o.refreshVariableName()}renameVarById(e,o){for(const i of this.getFields())i.referencesVariables()&&e===i.getValue()&&i.setValue(o)}getFieldValue(e){return(e=this.getField(e))?e.getValue():null}setFieldValue(e,o){const i=this.getField(o);if(!i)throw Error('Field "'+o+'" not found.');i.setValue(e)}setPreviousStatement(e,o){if(e)void 0===o&&(o=null),this.previousConnection||(this.previousConnection=this.makeConnection_(N.PREVIOUS_STATEMENT)),this.previousConnection.setCheck(o);else if(this.previousConnection){if(this.previousConnection.isConnected())throw Error("Must disconnect previous statement before removing connection.");this.previousConnection.dispose(),this.previousConnection=null}}setNextStatement(e,o){if(e)void 0===o&&(o=null),this.nextConnection||(this.nextConnection=this.makeConnection_(N.NEXT_STATEMENT)),this.nextConnection.setCheck(o);else if(this.nextConnection){if(this.nextConnection.isConnected())throw Error("Must disconnect next statement before removing connection.");this.nextConnection.dispose(),this.nextConnection=null}}setOutput(e,o){if(e)void 0===o&&(o=null),this.outputConnection||(this.outputConnection=this.makeConnection_(N.OUTPUT_VALUE)),this.outputConnection.setCheck(o);else if(this.outputConnection){if(this.outputConnection.isConnected())throw Error("Must disconnect output value before removing connection.");this.outputConnection.dispose(),this.outputConnection=null}}setInputsInline(e){this.inputsInline!==e&&(L(new(B(E.BLOCK_CHANGE))(this,"inline",null,this.inputsInline,e)),this.inputsInline=e)}getInputsInline(){if(void 0!==this.inputsInline)return this.inputsInline;for(var e=1;e<this.inputList.length;e++)if(this.inputList[e-1]instanceof lo&&this.inputList[e]instanceof lo)return!1;for(e=1;e<this.inputList.length;e++)if(this.inputList[e-1]instanceof t.ValueInput$$module$build$src$core$inputs$value_input&&this.inputList[e]instanceof lo)return!0;for(e=0;e<this.inputList.length;e++)if(this.inputList[e]instanceof Oo)return!0;return!1}setOutputShape(e){this.outputShape_=e}getOutputShape(){return this.outputShape_}isEnabled(){return 0===this.disabledReasons.size}setDisabledReason(e,o){e||this.workspace.options.disable||!this.hasDisabledReason(Gt)||o==Gt||this.setDisabledReason(!1,Gt),this.disabledReasons.has(o)!==e&&(e?this.disabledReasons.add(o):this.disabledReasons.delete(o),(e=new(B(E.BLOCK_CHANGE))(this,"disabled",null,!e,e)).setDisabledReason(o),L(e))}getInheritedDisabled(){let e=this.getSurroundParent();for(;e;){if(!e.isEnabled())return!0;e=e.getSurroundParent()}return!1}hasDisabledReason(e){return this.disabledReasons.has(e)}getDisabledReasons(){return this.disabledReasons}isCollapsed(){return this.collapsed_}setCollapsed(e){this.collapsed_!==e&&(L(new(B(E.BLOCK_CHANGE))(this,"collapsed",null,this.collapsed_,e)),this.collapsed_=e)}toString(e,o){o=this.toTokens(o);for(let s=2;s<o.length;s++)"("===o[s-2]&&")"===o[s]&&(o[s-2]=o[s-1],o.splice(s-1,2));let i="";return o=(o=o.reduce((s,n)=>(s=s+("("===i||")"===n?"":" ")+n,i=n[n.length-1],s),"")).trim()||"???",e&&o.length>e&&(o=o.substring(0,e-3)+"..."),o}toTokens(e="?"){const o=[];for(const s of this.inputList)if(s.name!=yr){for(const n of s.fieldRow)o.push(n.getText());if(s.connection){const n=s.connection.targetBlock();if(n){var i=s.connection;let l=i.getCheck();!l&&i.targetConnection&&(l=i.targetConnection.getCheck()),(i=!!l&&(l.includes("Boolean")||l.includes("Number")))&&o.push("("),o.push(...n.toTokens(e)),i&&o.push(")")}else o.push(e)}}return o}appendValueInput(e){return this.appendInput(new t.ValueInput$$module$build$src$core$inputs$value_input(e,this))}appendStatementInput(e){return this.statementInputCount++,this.appendInput(new xt(e,this))}appendDummyInput(e=""){return this.appendInput(new lo(e,this))}appendEndRowInput(e=""){return this.appendInput(new Oo(e,this))}appendInput(e){return this.inputList.push(e),e}appendInputFromRegistry(e,o){return(e=$t(w.INPUT,e,!1))?this.appendInput(new e(o,this)):null}jsonInit(e){var o=e.type?'Block "'+e.type+'": ':"";if(e.output&&e.previousStatement)throw Error(o+"Must not have both an output and a previousStatement.");for(var i=0;e["args"+i];){if(void 0===e["message"+i])throw Error(o+`args${i} must have a corresponding message (message${i}).`);i++}if(e.style&&e.style.hat&&(this.hat=e.style.hat,e.style=null),e.style&&e.colour)throw Error(o+"Must not have both a colour and a style.");for(e.style?this.jsonInitStyle(e,o):this.jsonInitColour(e,o),i=0;void 0!==e["message"+i];)this.interpolate(e["message"+i],e["args"+i]||[],e["implicitAlign"+i]||e["lastDummyAlign"+i],o),i++;if(void 0!==e.inputsInline&&(t.disable$$module$build$src$core$events$utils(),this.setInputsInline(e.inputsInline),t.enable$$module$build$src$core$events$utils()),void 0!==e.output&&this.setOutput(!0,e.output),void 0!==e.outputShape&&this.setOutputShape(e.outputShape),void 0!==e.previousStatement&&this.setPreviousStatement(!0,e.previousStatement),void 0!==e.nextStatement&&this.setNextStatement(!0,e.nextStatement),void 0!==e.tooltip&&(i=Ae(e.tooltip),this.setTooltip(i)),void 0!==e.enableContextMenu&&(this.contextMenu=!!e.enableContextMenu),void 0!==e.suppressPrefixSuffix&&(this.suppressPrefixSuffix=!!e.suppressPrefixSuffix),void 0!==e.helpUrl&&(i=Ae(e.helpUrl),this.setHelpUrl(i)),"string"==typeof e.extensions&&(console.warn(o+"JSON attribute 'extensions' should be an array of strings. Found raw string in JSON for '"+e.type+"' block."),e.extensions=[e.extensions]),void 0!==e.mutator&&zn(e.mutator,this,!0),e=e.extensions,Array.isArray(e))for(o=0;o<e.length;o++)zn(e[o],this,!1)}jsonInitColour(e,o){if("colour"in e)if(void 0===e.colour)console.warn(o+"Undefined colour value.");else{e=e.colour;try{this.setColour(e)}catch{console.warn(o+"Illegal colour value: ",e)}}}jsonInitStyle(e,o){e=e.style;try{this.setStyle(e)}catch{console.warn(o+"Style does not exist: ",e)}}mixin(e,o){if(void 0!==o&&"boolean"!=typeof o)throw Error("opt_disableCheck must be a boolean if provided");if(!o){o=[];for(const i in e)void 0!==this[i]&&o.push(i);if(o.length)throw Error("Mixin will overwrite block members: "+JSON.stringify(o))}Object.assign(this,e)}interpolate(e,o,i,s){e=Hn(e),this.validateTokens(e,o.length),o=this.interpolateArguments(e,o,i),i=[];for(let l,n=0;l=o[n];n++)if(this.isInputKeyword(l.type)){if(e=this.inputFromJson(l,s)){for(let $,h=0;$=i[h];h++)e.appendField($[0],$[1]);i.length=0}}else(e=this.fieldFromJson(l))&&i.push([e,l.name])}validateTokens(e,o){const i=[];let s=0;for(let n=0;n<e.length;n++){const l=e[n];if("number"==typeof l){if(l<1||l>o)throw Error('Block "'+this.type+'": Message index %'+l+" out of range.");if(i[l])throw Error('Block "'+this.type+'": Message index %'+l+" duplicated.");i[l]=!0,s++}}if(s!==o)throw Error('Block "'+this.type+'": Message does not reference all '+o+" arg(s).")}interpolateArguments(e,o,i){const s=[];for(let l=0;l<e.length;l++){var n=e[l];if("number"==typeof n&&(n=o[n-1]),"string"==typeof n)if("\n"===n)n={type:"input_end_row"},i&&(n.align=i);else if(!(n=this.stringToFieldJson(n)))continue;s.push(n)}return(e=s.length)&&!this.isInputKeyword(s[e-1].type)&&(e={type:"input_dummy"},i&&(e.align=i),s.push(e)),s}fieldFromJson(e){const o=t.fromJson$$module$build$src$core$field_registry(e);return!o&&e.alt?"string"==typeof e.alt?(e=this.stringToFieldJson(e.alt))?this.fieldFromJson(e):null:this.fieldFromJson(e.alt):o}inputFromJson(e,o){var i={LEFT:t.Align$$module$build$src$core$inputs$align.LEFT,RIGHT:t.Align$$module$build$src$core$inputs$align.RIGHT,CENTRE:t.Align$$module$build$src$core$inputs$align.CENTRE,CENTER:t.Align$$module$build$src$core$inputs$align.CENTRE};let s;switch(e.type){case"input_value":s=this.appendValueInput(e.name);break;case"input_statement":s=this.appendStatementInput(e.name);break;case"input_dummy":s=this.appendDummyInput(e.name);break;case"input_end_row":s=this.appendEndRowInput(e.name);break;default:s=this.appendInputFromRegistry(e.type,e.name)}return s?(e.check&&s.setCheck(e.check),e.align&&(void 0===(i=i[e.align.toUpperCase()])?console.warn(o+"Illegal align value: ",e.align):s.setAlign(i)),s):null}isInputKeyword(e){return"input_value"===e||"input_statement"===e||"input_dummy"===e||"input_end_row"===e||Po(w.INPUT,e)}stringToFieldJson(e){return(e=e.trim())?{type:"field_label",text:e}:null}moveInputBefore(e,o){if(e!==o){var i=-1,s=o?-1:this.inputList.length;for(let l,n=0;l=this.inputList[n];n++)if(l.name===e){if(i=n,-1!==s)break}else if(o&&l.name===o&&(s=n,-1!==i))break;if(-1===i)throw Error('Named input "'+e+'" not found.');if(-1===s)throw Error('Reference input "'+o+'" not found.');this.moveNumberedInputBefore(i,s)}}moveNumberedInputBefore(e,o){if(e===o)throw Error("Can't move input to itself.");if(e>=this.inputList.length)throw RangeError("Input index "+e+" out of bounds.");if(o>this.inputList.length)throw RangeError("Reference input "+o+" out of bounds.");const i=this.inputList[e];this.inputList.splice(e,1),e<o&&o--,this.inputList.splice(o,0,i)}removeInput(e,o){for(let s,i=0;s=this.inputList[i];i++)if(s.name===e)return s instanceof xt&&this.statementInputCount--,s.dispose(),this.inputList.splice(i,1),!0;if(o)return!1;throw Error("Input not found: "+e)}getInput(e){for(let i,o=0;i=this.inputList[o];o++)if(i.name===e)return i;return null}getInputTargetBlock(e){return(e=this.getInput(e))&&e.connection&&e.connection.targetBlock()}getCommentText(){let e,o;return null!=(o=null==(e=this.getIcon(Ue.COMMENT))?void 0:e.getText())?o:null}setCommentText(e){var o;let i;const s=null!=(i=null==(o=this.getIcon(Ue.COMMENT))?void 0:o.getText())?i:null;if(s!==e){if(null!==e){if(!(o=this.getIcon(Ue.COMMENT))){if(!(o=$t(w.ICON,Ue.COMMENT.toString(),!1)))throw Error("No comment icon class is registered, so a comment cannot be set");if(o=new o(this),!he(o))throw Error("The class registered as a comment icon does not conform to the ICommentIcon interface");o=this.addIcon(o)}t.disable$$module$build$src$core$events$utils(),o.setText(e),t.enable$$module$build$src$core$events$utils()}else this.removeIcon(Ue.COMMENT);L(new(B(E.BLOCK_CHANGE))(this,"comment",null,s,e))}}setWarningText(e,o){}setMutator(e){}addIcon(e){if(this.hasIcon(e.getType()))throw new y$(e);return this.icons.push(e),this.icons.sort((o,i)=>o.getWeight()-i.getWeight()),e}removeIcon(e){if(!this.hasIcon(e))return!1;let o;return null==(o=this.getIcon(e))||o.dispose(),this.icons=this.icons.filter(i=>!i.getType().equals(e)),!0}hasIcon(e){return this.icons.some(o=>o.getType().equals(e))}getIcon(e){return this.icons.find(e instanceof Ue?o=>o.getType().equals(e):o=>o.getType().toString()===e)}getIcons(){return[...this.icons]}getRelativeToSurfaceXY(){return this.xy}moveBy(e,o,i){if(this.parentBlock_)throw Error("Block has parent");const s=new(B(E.BLOCK_MOVE))(this);i&&s.setReason(i),this.xy.translate(e,o),s.recordNew(),L(s)}makeConnection_(e){return new se(this,e)}allInputsFilled(e){if(void 0===e&&(e=!0),!e&&this.isShadow())return!1;for(let s,i=0;s=this.inputList[i];i++)if(s.connection){var o=s.connection.targetBlock();if(!o||!o.allInputsFilled(e))return!1}return!(o=this.getNextBlock())||o.allInputsFilled(e)}toDevString(){let e=this.type?'"'+this.type+'" block':"Block";return this.id&&(e+=' (id="'+this.id+'")'),e}};nn.COLLAPSED_INPUT_NAME=yr,nn.COLLAPSED_FIELD_NAME=ac;var Qu=null,yc=null,xc={};xc.connectionUiEffect=H,xc.disconnectUiEffect=Et,xc.disconnectUiStop=q,xc.disposeUiEffect=ae;var Nr=class{paste(e,o,i){if(!o.isCapacityAvailable(e.typeCounts))return null;let s;i&&(e.blockState.x=i.x,e.blockState.y=i.y),i=i||new A(e.blockState.x||0,e.blockState.y||0),t.disable$$module$build$src$core$events$utils();try{s=zo(e.blockState,o),W(s,i)}finally{t.enable$$module$build$src$core$events$utils()}if(!s)return s;_e()&&!s.isShadow()&&L(new(B(E.BLOCK_CREATE))(s));const n=s;return Xt().then(()=>t.getFocusManager$$module$build$src$core$focus_manager().focusNode(n)),s}};Nr.TYPE="block",Dn(Nr.TYPE,new Nr);var w$={};w$.BlockPaster=Nr,w$.moveBlockToNotConflict=W;var ed={};ed.bumpIntoBounds=z,ed.bumpIntoBoundsHandler=oe,ed.bumpTopObjectsIntoBounds=pe;var Zp=class{constructor(e){this.block=e,this.connectionPreviewer=this.connectionCandidate=this.startLoc=this.startChildConn=this.startParentConn=null,this.dragging=!1,this.dragOffset=new A(0,0),this.originalEventGroup="",this.workspace=e.workspace}isMovable(){if(this.block.isShadow()){let e,o;return null!=(o=null==(e=this.block.getParent())?void 0:e.isMovable())&&o}return this.block.isOwnMovable()&&!this.block.isDeadOrDying()&&!this.workspace.isReadOnly()&&!this.block.isInFlyout}startDrag(e){var o;this.block.isShadow()?this.startDraggingShadow(e):(this.dragging=!0,this.fireDragStartEvent(),this.startLoc=this.block.getRelativeToSurfaceXY(),this.connectionCandidate=null,this.connectionPreviewer=new(Ve(w.CONNECTION_PREVIEWER,this.workspace.options))(this.block),b(),this.workspace.setResizesEnabled(!1),q(),e=this.shouldHealStack(e),this.shouldDisconnect(e)&&this.disconnectBlock(e),this.block.setDragging(!0),null==(o=this.workspace.getLayerManager())||o.moveToDragLayer(this.block))}shouldHealStack(e){return!!e&&(e.altKey||e.ctrlKey||e.metaKey)}startDraggingShadow(e){const o=this.block.getParent();if(!o)throw Error("Tried to drag a shadow block with no parent. Shadow blocks should always have parents.");this.dragOffset=A.difference(o.getRelativeToSurfaceXY(),this.block.getRelativeToSurfaceXY()),o.startDrag(e)}shouldDisconnect(e){return!!(this.block.getParent()||e&&this.block.nextConnection&&this.block.nextConnection.targetBlock())}disconnectBlock(e){let o,i,s;if(this.startParentConn=null!=(s=null==(o=this.block.outputConnection)?void 0:o.targetConnection)?s:null==(i=this.block.previousConnection)?void 0:i.targetConnection,e){let n;this.startChildConn=null==(n=this.block.nextConnection)?void 0:n.targetConnection}this.block.unplug(e),Et(this.block)}fireDragStartEvent(){const e=new(B(E.BLOCK_DRAG))(this.block,!0,this.block.getDescendants(!1));L(e)}fireDragEndEvent(){const e=new(B(E.BLOCK_DRAG))(this.block,!1,this.block.getDescendants(!1));L(e)}fireMoveEvent(){if(!this.block.isDeadOrDying()){var e=new(B(E.BLOCK_MOVE))(this.block);e.setReason(["drag"]),e.oldCoordinate=this.startLoc,e.recordNew(),L(e)}}drag(e){if(this.block.isShadow()){let o;null==(o=this.block.getParent())||o.drag(A.sum(e,this.dragOffset))}else this.block.moveDuringDrag(e),this.updateConnectionPreview(this.block,A.difference(e,this.startLoc))}updateConnectionPreview(e,o){var i=this.connectionCandidate;const s=this.getConnectionCandidate(e,o);if(s){this.connectionCandidate=o=i&&this.currCandidateIsBetter(i,o,s)?i:s;var h,{local:n,neighbour:l}=o;if(o=n.type===N.OUTPUT_VALUE||n.type===N.PREVIOUS_STATEMENT,i=l.isConnected()&&!(null!=(h=l.targetBlock())&&h.isInsertionMarker()),o&&i&&!this.orphanCanConnectAtEnd(e,l.targetBlock(),n.type)){let k;null==(k=this.connectionPreviewer)||k.previewReplacement(n,l,l.targetBlock())}else{var $;null==($=this.connectionPreviewer)||$.previewConnection(n,l)}}else{let k;null==(k=this.connectionPreviewer)||k.hidePreview(),this.connectionCandidate=null}}orphanCanConnectAtEnd(e,o,i){return!!se.getConnectionForOrphanedConnection(e,i===N.OUTPUT_VALUE?o.outputConnection:o.previousConnection)}currCandidateIsBetter(e,o,i){const{local:s,neighbour:n}=e;e=new A(s.x,s.y);const l=new A(n.x,n.y);return o=A.distance(A.sum(e,o),l),i.distance>o-t.config$$module$build$src$core$config.currentConnectionPreference}getConnectionCandidate(e,o){e=this.getLocalConnections(e);let i=this.getSearchRadius(),s=null;for(const n of e){const{connection:l,radius:h}=n.closest(i,o);l&&(s={local:n,neighbour:l,distance:h},i=h)}return s}getSearchRadius(){return this.connectionCandidate?t.config$$module$build$src$core$config.connectingSnapRadius:t.config$$module$build$src$core$config.snapRadius}getLocalConnections(e){const o=e.getConnections_(!1),i=e.lastConnectionInStack(!0);return i&&i!==e.nextConnection&&o.push(i),o}endDrag(e){if(this.block.isShadow()){let i;null==(i=this.block.getParent())||i.endDrag(e)}else{var o;if(this.originalEventGroup=t.getGroup$$module$build$src$core$events$utils(),this.fireDragEndEvent(),this.fireMoveEvent(),y(),q(),null==(o=this.connectionPreviewer)||o.hidePreview(),!this.block.isDeadOrDying()&&this.dragging){let i;null==(i=this.workspace.getLayerManager())||i.moveOffDragLayer(this.block,50),this.block.setDragging(!1)}this.connectionCandidate?(this.applyConnections(this.connectionCandidate),this.disposeStep()):this.block.queueRender().then(()=>this.disposeStep())}}disposeStep(){const e=t.getGroup$$module$build$src$core$events$utils();let o;t.setGroup$$module$build$src$core$events$utils(this.originalEventGroup),this.block.snapToGrid(),null==(o=this.connectionPreviewer)||o.dispose(),this.workspace.setResizesEnabled(!0),t.setGroup$$module$build$src$core$events$utils(e)}applyConnections(e){const{local:o,neighbour:i}=e;o.connect(i);const s=o.isSuperior()?i:o,n=this.block.getRootBlock();Xt().then(()=>{H(s.getSourceBlock()),setTimeout(()=>{n.bringToFront()},0)})}revertDrag(){if(this.block.isShadow()){let i;null==(i=this.block.getParent())||i.revertDrag()}else{var e,o;if(null==(e=this.connectionPreviewer)||e.hidePreview(),this.connectionCandidate=null,null==(o=this.startChildConn)||o.connect(this.block.nextConnection),this.startParentConn)switch(this.startParentConn.type){case N.INPUT_VALUE:this.startParentConn.connect(this.block.outputConnection);break;case N.NEXT_STATEMENT:this.startParentConn.connect(this.block.previousConnection)}else{let i;this.block.moveTo(this.startLoc,["drag"]),null==(i=this.workspace.getLayerManager())||i.moveOffDragLayer(this.block,50),z(this.workspace,this.workspace.getMetricsManager().getScrollMetrics(!0),this.block)}this.startParentConn=this.startChildConn=null,this.block.setDragging(!1),this.dragging=!1}}},Hp=class extends de{constructor(e,o,i,s){super(o,i,s),this.text=e,this.workspace=o,this.anchor=i,this.ownerRect=s,this.paragraph=this.stringToSvg(e,this.contentContainer),this.updateBubbleSize(),R(this.svgRoot,"blocklyTextBubble")}getText(){return this.text}setText(e){this.text=e,ce(this.paragraph),this.paragraph=this.stringToSvg(e,this.contentContainer),this.updateBubbleSize()}stringToSvg(e,o){return o=this.createParagraph(o),e=this.createTextFragments(o,e),this.workspace.RTL&&this.rightAlignTextFragments(o.getBBox().width,e),o}createParagraph(e){return I(v.G,{class:"blocklyText blocklyBubbleText blocklyNoPointerEvents",transform:`translate(0,${de.BORDER_WIDTH})`,style:"direction: "+(this.workspace.RTL?"rtl":"ltr")},e)}createTextFragments(e,o){let i=1;return o.split("\n").map(s=>{const n=I(v.TEXT,{y:`${i}em`,x:de.BORDER_WIDTH},e);return s=document.createTextNode(s),n.appendChild(s),i+=1,n})}rightAlignTextFragments(e,o){for(const i of o)i.setAttribute("text-anchor","start"),i.setAttribute("x",`${e+de.BORDER_WIDTH}`)}updateBubbleSize(){const e=this.paragraph.getBBox();this.setSize(new ee(e.width+2*de.BORDER_WIDTH,e.height+2*de.BORDER_WIDTH),!0)}},co=class extends Rr{constructor(e){super(e),this.sourceBlock=e,this.textMap=new Map,this.textBubble=null}getType(){return co.TYPE}initView(e){this.svgRoot||(super.initView(e),I(v.PATH,{class:"blocklyIconShape",d:"M2,15Q-1,15 0.5,12L6.5,1.7Q8,-1 9.5,1.7L15.5,12Q17,15 14,15z"},this.svgRoot),I(v.PATH,{class:"blocklyIconSymbol",d:"m7,4.8v3.16l0.27,2.27h1.46l0.27,-2.27v-3.16z"},this.svgRoot),I(v.RECT,{class:"blocklyIconSymbol",x:"7",y:"11",height:"2",width:"2"},this.svgRoot),R(this.svgRoot,"blocklyWarningIcon"))}dispose(){let e;super.dispose(),null==(e=this.textBubble)||e.dispose()}getWeight(){return co.WEIGHT}getSize(){return new ee(17,17)}applyColour(){let e;super.applyColour(),null==(e=this.textBubble)||e.setColour(this.sourceBlock.getColour())}updateCollapsed(){}isShownWhenCollapsed(){return!0}onLocationChange(e){let o;super.onLocationChange(e),null==(o=this.textBubble)||o.setAnchorLocation(this.getAnchorLocation())}addMessage(e,o){if(this.textMap.get(o)===e)return this;let i;return e?this.textMap.set(o,e):this.textMap.delete(o),null==(i=this.textBubble)||i.setText(this.getText()),this}getText(){return[...this.textMap.values()].join("\n")}onClick(){super.onClick(),this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}bubbleIsVisible(){return!!this.textBubble}setBubbleVisible(e){const o=this;return(0,C.asyncExecutePromiseGeneratorFunction)(function*(){if(o.bubbleIsVisible()!==e){if(yield Xt(),e)o.textBubble=new Hp(o.getText(),o.sourceBlock.workspace,o.getAnchorLocation(),o.getBubbleOwnerRect()),o.applyColour();else{let i;null==(i=o.textBubble)||i.dispose(),o.textBubble=null}L(new(B(E.BUBBLE_OPEN))(o.sourceBlock,e,"warning"))}})}getBubble(){return this.textBubble}getAnchorLocation(){return A.sum(this.workspaceLocation,new A(8.5,8.5))}getBubbleOwnerRect(){const e=this.sourceBlock.getSvgRoot().getBBox();return new Q(e.y,e.y+e.height,e.x,e.x+e.width)}};co.TYPE=Ue.WARNING,co.WEIGHT=2;var $e=class extends nn{constructor(e,o,i){if(super(e,o,i),this.childlessWidth=this.width=this.height=0,this.warningTextDb=new Map,this.mutator=null,this.rendered=!0,this.visuallyDisabled=!1,this.translation="",this.dragging=!1,this.relativeCoords=new A(0,0),this.dragStrategy=new Zp(this),!e.rendered)throw TypeError("Cannot create a rendered block in a headless workspace");this.workspace=e,this.svgGroup=I(v.G,{}),o&&R(this.svgGroup,o),this.style=e.getRenderer().getConstants().getBlockStyle(null),this.pathObject=e.getRenderer().makePathObject(this.svgGroup,this.style),(e=this.pathObject.svgPath).tooltip=this,Un(e),this.svgGroup.setAttribute("data-id",this.id),e.id=ct(),this.doInit_()}initSvg(){if(!this.initialized){for(var e of this.inputList)e.init();for(const o of this.getIcons())o.initView(this.createIconPointerDownListener(o)),o.updateEditable();this.applyColour(),this.pathObject.updateMovable(this.isMovable()||this.isInFlyout),(e=this.getSvgRoot())&&U(e,"pointerdown",this,this.onMouseDown),e.parentNode||this.workspace.getCanvas().appendChild(e),this.initialized=!0}}getColourSecondary(){return this.style.colourSecondary}getColourTertiary(){return this.style.colourTertiary}select(){this.addSelect(),To(this)}unselect(){this.removeSelect(),To(null)}setParent(e){var o=this.parentBlock_;if(e!==o){b(),super.setParent(e),y();var i=this.getSvgRoot();if(!this.workspace.isClearing&&i){var l,s=this.getRelativeToSurfaceXY(),n=t.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode(),h=this.getSvgRoot().contains(null!=(l=n?.getFocusableElement())?l:null);e?(e.getSvgRoot().appendChild(i),h&&n&&t.getFocusManager$$module$build$src$core$focus_manager().focusNode(n)):o&&(e=this.workspace.getCanvas().querySelector(".blocklyDragging"),o=e?.parentElement,o===(l=this.workspace.getCanvas())?l.insertBefore(i,e):(l.appendChild(i),h&&n&&t.getFocusManager$$module$build$src$core$focus_manager().focusNode(n)),this.translate(s.x,s.y)),this.applyColour()}}}getRelativeToSurfaceXY(){const e=this.workspace.getLayerManager();if(!e)throw Error("Cannot calculate position because the workspace has not been appended");let o=0,i=0,s=this.getSvgRoot();if(s)do{const n=ms(s);o+=n.x,i+=n.y,s=s.parentNode}while(s&&!e.hasLayer(s));return new A(o,i)}moveBy(e,o,i){if(this.parentBlock_)throw Error("Block has parent");const s=_e();let n=null;s&&(n=new(B(E.BLOCK_MOVE))(this),i&&n.setReason(i)),e=new A(e,o),o=this.getRelativeToSurfaceXY(),e=A.sum(o,e),this.translate(e.x,e.y),this.updateComponentLocations(e),s&&n&&(n.recordNew(),L(n)),this.workspace.resizeContents()}translate(e,o){this.translation=`translate(${e}, ${o})`,this.relativeCoords=new A(e,o),this.getSvgRoot().setAttribute("transform",this.getTranslation())}getTranslation(){return this.translation}moveTo(e,o){const i=this.getRelativeToSurfaceXY();this.moveBy(e.x-i.x,e.y-i.y,o)}moveDuringDrag(e){this.translate(e.x,e.y),this.getSvgRoot().setAttribute("transform",this.getTranslation()),this.updateComponentLocations(e)}snapToGrid(){if(!this.isDeadOrDying()&&!this.getParent()&&!this.isInFlyout){var e=this.workspace.getGrid();if(null!=e&&e.shouldSnap()){var o=this.getRelativeToSurfaceXY();(e=e.alignXY(o))!==o&&this.moveTo(e,["snap"])}}}getBoundingRectangle(){return this.getBoundingRectangleWithDimensions(this.getHeightWidth())}getBoundingRectangleWithoutChildren(){return this.getBoundingRectangleWithDimensions({height:this.height,width:this.childlessWidth})}getBoundingRectangleWithDimensions(e){const o=this.getRelativeToSurfaceXY();let i,s;return this.RTL?(i=o.x-e.width,s=o.x):(i=o.x,s=o.x+e.width),new Q(o.y,o.y+e.height,i,s)}markDirty(){this.pathObject.constants=this.workspace.getRenderer().getConstants();for(let o,e=0;o=this.inputList[e];e++)o.markDirty()}setCollapsed(e){this.collapsed_!==e&&(super.setCollapsed(e),this.updateCollapsed())}childHasWarning(){const e=this.getChildren(!1);for(const o of e)if(o.getIcon(co.TYPE)||o.childHasWarning())return!0;return!1}updateCollapsed(){var e=this.isCollapsed();const o=yr,i=ac;for(let l,n=0;l=this.inputList[n];n++)l.name!==o&&l.setVisible(!e);for(var s of this.getIcons())s.updateCollapsed();e?(R(this.svgGroup,"blocklyCollapsed"),this.childHasWarning()&&this.setWarningText(t.Msg$$module$build$src$core$msg.COLLAPSED_WARNINGS_WARNING,$e.COLLAPSED_WARNING_ID),e=this.toString(30),(s=this.getField(i))?s.setValue(e):(this.getInput(o)||this.appendDummyInput(o)).appendField(new zi(e),i)):(this.updateDisabled(),this.removeInput(o),te(this.svgGroup,"blocklyCollapsed"),this.setWarningText(null,$e.COLLAPSED_WARNING_ID))}onMouseDown(e){if(!this.workspace.isReadOnly()){var o=this.workspace.getGesture(e);o&&o.handleBlockStart(e,this)}}showHelp(){const e="function"==typeof this.helpUrl?this.helpUrl():this.helpUrl;e&&window.open(e)}generateContextMenu(e){return this.workspace.isReadOnly()||!this.contextMenu?null:(e=K.registry.getContextMenuOptions({block:this,focusedNode:this},e),this.customContextMenu&&this.customContextMenu(e),e)}calculateContextMenuLocation(e){if(e instanceof PointerEvent)return new A(e.clientX,e.clientY);let o,i;e=yo(this.workspace,this.getRelativeToSurfaceXY());const s=null==(o=this.inputList.filter(n=>n.isVisible()).flatMap(n=>n.fieldRow).find(n=>n.isVisible()))||null==(i=o.getSvgRoot())?void 0:i.getBoundingClientRect();return new A(this.RTL?e.x-5:e.x+5,(s&&s.height?s.y+s.height:e.y+this.height)+5)}showContextMenu(e){const o=this.generateContextMenu(e),i=this.calculateContextMenuLocation(e);o&&o.length&&(As(e,o,this.RTL,this.workspace,i),Ga(this))}updateComponentLocations(e){this.dragging||this.updateConnectionLocations(e),this.updateIconLocations(e),this.updateFieldLocations(e);for(const o of this.getChildren(!1))o.updateComponentLocations(A.sum(e,o.relativeCoords))}updateConnectionLocations(e){for(const o of this.getConnections_(!1))o.moveToOffset(e)}updateIconLocations(e){for(const o of this.getIcons())o.onLocationChange(e)}updateFieldLocations(e){for(const o of this.inputList)for(const i of o.fieldRow)i.onLocationChange(e)}addClass(e){R(this.svgGroup,e)}removeClass(e){te(this.svgGroup,e)}setDragging(e){(this.dragging=e)?(this.translation="",oc.push(...this.getConnections_(!0)),this.addClass("blocklyDragging")):(oc.length=0,this.removeClass("blocklyDragging"));for(let o=0;o<this.childBlocks_.length;o++)this.childBlocks_[o].setDragging(e)}setMovable(e){super.setMovable(e),this.pathObject.updateMovable(e)}setEditable(e){super.setEditable(e),e?te(this.svgGroup,"blocklyNotEditable"):R(this.svgGroup,"blocklyNotEditable"),e=this.getIcons();for(let o=0;o<e.length;o++)e[o].updateEditable()}setShadow(e){super.setShadow(e),this.applyColour()}setInsertionMarker(e){this.isInsertionMarker_!==e&&(this.isInsertionMarker_=e)&&(this.setColour(this.workspace.getRenderer().getConstants().INSERTION_MARKER_COLOUR),this.pathObject.updateInsertionMarker(!0))}getSvgRoot(){return this.svgGroup}dispose(e,o){this.disposing=!0,Ra(),qn();const i=t.getFocusManager$$module$build$src$core$focus_manager();var s,n;if(this.getSvgRoot().contains(null!=(n=null==(s=i.getFocusedNode())?void 0:s.getFocusableElement())?n:null)){if(!(s=this.getParent())){let l;if(n=null!=(l=this.outputConnection)?l:this.previousConnection){let h;s=null==(h=n.closest(0,new A(0,0)).connection)?void 0:h.getSourceBlock()}}s?i.focusNode(s):setTimeout(()=>i.focusTree(this.workspace),0)}o&&(this.unplug(e),ae(this)),super.dispose(!!e),ce(this.svgGroup)}disposeInternal(){this.disposing=!0,super.disposeInternal(),t.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode()===this&&this.workspace.cancelCurrentGesture(),[...this.warningTextDb.values()].forEach(e=>clearTimeout(e)),this.warningTextDb.clear(),this.getIcons().forEach(e=>e.dispose())}checkAndDelete(){this.workspace.isFlyout||(t.setGroup$$module$build$src$core$events$utils(!0),this.workspace.hideChaff(),this.dispose(!this.outputConnection,!0),t.setGroup$$module$build$src$core$events$utils(!1))}toCopyData(){return this.isInsertionMarker_?null:{paster:Nr.TYPE,blockState:Tt(this,{addCoordinates:!0,addNextBlocks:!1}),typeCounts:hs(this,!0)}}applyColour(){var e,o;for(null==(o=(e=this.pathObject).applyColour)||o.call(e,this),e=this.getIcons(),o=0;o<e.length;o++)e[o].applyColour();for(const i of this.getFields())i.applyColour()}updateDisabled(){const e=!this.isEnabled()||this.getInheritedDisabled();if(this.visuallyDisabled===e){let o;null==(o=this.getNextBlock())||o.updateDisabled()}else{this.applyColour(),this.visuallyDisabled=e;for(const o of this.getChildren(!1))o.updateDisabled()}}setWarningText(e,o=""){if(o)this.warningTextDb.has(o)&&(clearTimeout(this.warningTextDb.get(o)),this.warningTextDb.delete(o));else{for(var i of this.warningTextDb.values())clearTimeout(i);this.warningTextDb.clear()}if(this.workspace.isDragging())this.warningTextDb.set(o,setTimeout(()=>{this.isDeadOrDying()||(this.warningTextDb.delete(o),this.setWarningText(e,o))},100));else if(this.isInFlyout&&(e=null),i=this.getIcon(co.TYPE),e){let s=this.getSurroundParent(),n=null;for(;s;)s.isCollapsed()&&(n=s),s=s.getSurroundParent();n&&n.setWarningText(t.Msg$$module$build$src$core$msg.COLLAPSED_WARNINGS_WARNING,$e.COLLAPSED_WARNING_ID),i?i.addMessage(e,o):this.addIcon(new co(this).addMessage(e,o))}else i&&(o?(i.addMessage("",o),i.getText()||this.removeIcon(co.TYPE)):this.removeIcon(co.TYPE))}setMutator(e){this.removeIcon(t.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE),e&&this.addIcon(e)}addIcon(e){return super.addIcon(e),e instanceof t.MutatorIcon$$module$build$src$core$icons$mutator_icon&&(this.mutator=e),e.initView(this.createIconPointerDownListener(e)),e.applyColour(),e.updateEditable(),this.queueRender(),e}createIconPointerDownListener(e){return o=>{this.isDeadOrDying()||(o=this.workspace.getGesture(o))&&o.setStartIcon(e)}}removeIcon(e){const o=super.removeIcon(e);return e.equals(t.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE)&&(this.mutator=null),this.queueRender(),o}setDisabledReason(e,o){const i=this.isEnabled();super.setDisabledReason(e,o),this.isEnabled()===i||this.getInheritedDisabled()||this.updateDisabled()}setDeletable(e){super.setDeletable(e),e?te(this.svgGroup,"blocklyNotDeletable"):R(this.svgGroup,"blocklyNotDeletable")}setHighlighted(e){this.pathObject.updateHighlighted(e)}addSelect(){this.pathObject.updateSelected(!0)}removeSelect(){this.pathObject.updateSelected(!1)}setDeleteStyle(e){this.pathObject.updateDraggingDelete(e)}getColour(){return this.style.colourPrimary}setColour(e){let o,i;super.setColour(e),e=this.workspace.getRenderer().getConstants().getBlockStyleForColour(this.colour_),null==(i=(o=this.pathObject).setStyle)||i.call(o,e.style),this.style=e.style,this.styleName_=e.name,this.applyColour()}setStyle(e){const o=this.workspace.getRenderer().getConstants().getBlockStyle(e);if(this.styleName_&&te(this.svgGroup,this.styleName_),!o)throw Error("Invalid style name: "+e);{let i,s;this.hat=o.hat,null==(s=(i=this.pathObject).setStyle)||s.call(i,o),this.colour_=o.colourPrimary,this.style=o,this.applyColour(),R(this.svgGroup,e),this.styleName_=e}}getStyle(){return this.style}bringToFront(e=!1){const o=t.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode();let i=this;if(!i.isDeadOrDying()){do{const s=i.getSvgRoot(),n=s.parentNode,l=n.childNodes;if(l[l.length-1]!==s&&n.appendChild(s),e)break;i=i.getParent()}while(i);o&&t.getFocusManager$$module$build$src$core$focus_manager().focusNode(o)}}setPreviousStatement(e,o){super.setPreviousStatement(e,o),this.queueRender()}setNextStatement(e,o){super.setNextStatement(e,o),this.queueRender()}setOutput(e,o){super.setOutput(e,o),this.queueRender()}setInputsInline(e){super.setInputsInline(e),this.queueRender()}removeInput(e,o){return e=super.removeInput(e,o),this.queueRender(),e}moveNumberedInputBefore(e,o){super.moveNumberedInputBefore(e,o),this.queueRender()}appendInput(e){return super.appendInput(e),this.queueRender(),e}setConnectionTracking(e){if(this.previousConnection&&this.previousConnection.setTracking(e),this.outputConnection&&this.outputConnection.setTracking(e),this.nextConnection){this.nextConnection.setTracking(e);var o=this.nextConnection.targetBlock();o&&o.setConnectionTracking(e)}if(!this.collapsed_)for(o=0;o<this.inputList.length;o++){var i=this.inputList[o].connection;i&&(i.setTracking(e),(i=i.targetBlock())&&i.setConnectionTracking(e))}}getConnections_(e){const o=[];if(this.outputConnection&&o.push(this.outputConnection),this.previousConnection&&o.push(this.previousConnection),this.nextConnection&&o.push(this.nextConnection),e||!this.collapsed_)for(let s,i=0;s=this.inputList[i];i++)s.connection&&o.push(s.connection);return o}lastConnectionInStack(e){return super.lastConnectionInStack(e)}getMatchingConnection(e,o){return super.getMatchingConnection(e,o)}makeConnection_(e){return new Xe(this,e)}getNextBlock(){return super.getNextBlock()}getPreviousBlock(){return super.getPreviousBlock()}bumpNeighbours(){const e=this.getRootBlock();if(!(this.isDeadOrDying()||this.workspace.isDragging()||e.isInFlyout))for(const o of this.getConnections_(!1)){if(o.isSuperior()){let i;null==(i=o.targetBlock())||i.bumpNeighbours()}for(const i of o.neighbours(t.config$$module$build$src$core$config.snapRadius))i.getSourceBlock().getRootBlock()!==e&&(o.isConnected()&&i.isConnected()||(o.isSuperior()?i.bumpAwayFrom(o,!1):o.bumpAwayFrom(i,!0)))}}scheduleSnapAndBump(){this.snapToGrid(),this.bumpNeighbours()}positionNearConnection(e,o,i){if(e.type===N.NEXT_STATEMENT||e.type===N.INPUT_VALUE){let s=o.x;o=o.y,s+=i.x-e.getOffsetInBlock().x,o+=i.y-e.getOffsetInBlock().y,this.moveBy(s,o)}}getChildren(e){return super.getChildren(e)}queueRender(){return Qc(this)}render(){this.queueRender(),Wo()}renderEfficiently(){b(),this.isCollapsed()&&this.updateCollapsed(),this.isEnabled()||this.updateDisabled(),this.workspace.getRenderer().render(this),this.tightenChildrenEfficiently(),y()}tightenChildrenEfficiently(){for(const e of this.inputList){const o=e.connection;o&&o.tightenEfficiently()}this.nextConnection&&this.nextConnection.tightenEfficiently()}getHeightWidth(){let e=this.height,o=this.width;var i=this.getNextBlock();if(i){i=i.getHeightWidth();const s=this.workspace.getRenderer().getConstants().NOTCH_HEIGHT;e+=i.height-s,o=Math.max(o,i.width)}return{height:e,width:o}}fadeForReplacement(e){this.pathObject.updateReplacementFade(e)}highlightShapeForInput(e,o){this.pathObject.updateShapeForInputHighlight(e,o)}getDragStrategy(){return this.dragStrategy}setDragStrategy(e){this.dragStrategy=e}isCopyable(){return this.isOwnDeletable()&&this.isOwnMovable()}isMovable(){return this.dragStrategy.isMovable()}startDrag(e){this.dragStrategy.startDrag(e)}drag(e,o){this.dragStrategy.drag(e,o)}endDrag(e){this.dragStrategy.endDrag(e)}revertDrag(){this.dragStrategy.revertDrag()}toFlyoutInfo(){const e=Object.assign({},{kind:"BLOCK"},Tt(this)),o=new Set(["id","height","width","pinned","enabled"]),i=function(s){for(const n in s)o.has(n)?delete s[n]:"object"==typeof s[n]&&i(s[n])};return i(e),[e]}jsonInit(e){super.jsonInit(e),e.classes&&this.addClass(Array.isArray(e.classes)?e.classes.join(" "):e.classes)}getFocusableElement(){return this.pathObject.svgPath}getFocusableTree(){return this.workspace}onNodeFocus(){this.select()}onNodeBlur(){this.unselect()}canBeFocused(){return!0}};$e.INLINE=-1,$e.COLLAPSED_WARNING_ID="TEMP_COLLAPSED_WARNING_";var Vp=class{constructor(){}onDragEnter(e){}onDragOver(e){}onDragExit(e){}onDrop(e){}getClientRect(){return null}shouldPreventMove(e){return!1}},Cc=class extends Vp{constructor(){super(),this.wouldDelete_=!1}wouldDelete(e){return e instanceof $e?(e=!e.getParent()&&e.isDeletable(),this.updateWouldDelete_(e)):this.updateWouldDelete_(le(e)&&e.isDeletable()),this.wouldDelete_}updateWouldDelete_(e){this.wouldDelete_=e}},rn=class{constructor(e,o){this.element=e,this.type=o}getElement(){return this.element}getType(){return this.type}},td=class{constructor(e){this.workspace_=e}getDimensionsPx_(e){let o=0,i=0;return e&&(o=e.getWidth(),i=e.getHeight()),new ee(o,i)}getFlyoutMetrics(e){return{width:(e=this.getDimensionsPx_(this.workspace_.getFlyout(e))).width,height:e.height,position:this.workspace_.toolboxPosition}}getToolboxMetrics(){const e=this.getDimensionsPx_(this.workspace_.getToolbox());return{width:e.width,height:e.height,position:this.workspace_.toolboxPosition}}getSvgMetrics(){return this.workspace_.getCachedParentSvgSize()}getAbsoluteMetrics(){let e=0,o=0;const i=this.getToolboxMetrics(),s=this.getFlyoutMetrics(),n=!!this.workspace_.getToolbox();var l;const h=!(null!=(l=this.workspace_.getFlyout())&&l.autoClose);return(l=n?i.position:s.position)===j.LEFT&&(n&&(e+=i.width),h&&(e+=s.width)),l===j.TOP&&(n&&(o+=i.height),h&&(o+=s.height)),{top:o,left:e}}getViewMetrics(e){e=e?this.workspace_.scale:1;const o=this.getSvgMetrics(),i=this.getToolboxMetrics(),s=this.getFlyoutMetrics(),n=!!this.workspace_.getToolbox();var l;const h=!(null!=(l=this.workspace_.getFlyout())&&l.autoClose),$=(l=n?i.position:s.position)===j.LEFT||l===j.RIGHT;return(l===j.TOP||l===j.BOTTOM)&&(n&&(o.height-=i.height),h&&(o.height-=s.height)),$&&(n&&(o.width-=i.width),h&&(o.width-=s.width)),{height:o.height/e,width:o.width/e,top:-this.workspace_.scrollY/e,left:-this.workspace_.scrollX/e}}getContentMetrics(e){e=e?1:this.workspace_.scale;const o=this.workspace_.getBlocksBoundingBox();return{height:(o.bottom-o.top)*e,width:(o.right-o.left)*e,top:o.top*e,left:o.left*e}}hasFixedEdges(){return!this.workspace_.isMovableHorizontally()||!this.workspace_.isMovableVertically()}getComputedFixedEdges_(e){if(!this.hasFixedEdges())return{};const o=this.workspace_.isMovableHorizontally(),i=this.workspace_.isMovableVertically();e=e||this.getViewMetrics(!1);const s={};return i||(s.top=e.top,s.bottom=e.top+e.height),o||(s.left=e.left,s.right=e.left+e.width),s}getPaddedContent_(e,o){const i=o.top+o.height,s=o.left+o.width,n=e.width,l=n/2,h=(e=e.height)/2;return{top:Math.min(o.top-h,i-e),bottom:Math.max(i+h,o.top+e),left:Math.min(o.left-l,s-n),right:Math.max(s+l,o.left+n)}}getScrollMetrics(e,o,i){e=e?this.workspace_.scale:1,o=o||this.getViewMetrics(!1);var s=i||this.getContentMetrics();i=this.getComputedFixedEdges_(o),o=this.getPaddedContent_(o,s);const n=void 0!==i.left?i.left:o.left;return{top:(s=void 0!==i.top?i.top:o.top)/e,left:n/e,width:((void 0!==i.right?i.right:o.right)-n)/e,height:((void 0!==i.bottom?i.bottom:o.bottom)-s)/e}}getUiMetrics(){return{viewMetrics:this.getViewMetrics(),absoluteMetrics:this.getAbsoluteMetrics(),toolboxMetrics:this.getToolboxMetrics()}}getMetrics(){const e=this.getToolboxMetrics(),o=this.getFlyoutMetrics(!0),i=this.getSvgMetrics(),s=this.getAbsoluteMetrics(),n=this.getViewMetrics(),l=this.getContentMetrics(),h=this.getScrollMetrics(!1,n,l);return{contentHeight:l.height,contentWidth:l.width,contentTop:l.top,contentLeft:l.left,scrollHeight:h.height,scrollWidth:h.width,scrollTop:h.top,scrollLeft:h.left,viewHeight:n.height,viewWidth:n.width,viewTop:n.top,viewLeft:n.left,absoluteTop:s.top,absoluteLeft:s.left,svgHeight:i.height,svgWidth:i.width,toolboxWidth:e.width,toolboxHeight:e.height,toolboxPosition:e.position,flyoutWidth:o.width,flyoutHeight:o.height}}};D(w.METRICS_MANAGER,vt,td);var qp=class extends td{constructor(e,o){super(e),this.flyout_=o}getBoundingBox(){let e;try{e=this.workspace_.getCanvas().getBBox()}catch{e={height:0,y:0,width:0,x:0}}return e}getContentMetrics(e){const o=this.getBoundingBox();return{height:o.height*(e=e?1:this.workspace_.scale),width:o.width*e,top:o.y*e,left:o.x*e}}getScrollMetrics(e,o,i){return{height:((o=i||this.getContentMetrics()).height+2*(i=this.flyout_.MARGIN*this.workspace_.scale))/(e=e?this.workspace_.scale:1),width:(o.width+o.left+i)/e,top:0,left:0}}},pt=class{constructor(e,o,i,s){let n;this.workspace=e,this.targetWorkspace=o,this.isFlyoutLabel=s,this.height=this.width=0,this.cursorSvg=this.svgText=null,this.text=i.text,this.position=new A(0,0),this.callbackKey=i.callbackKey||i.callbackkey,this.cssClass=i["web-class"]||null,this.info=i,e=this.isFlyoutLabel?"blocklyFlyoutLabel":"blocklyFlyoutButton",this.cssClass&&(e+=" "+this.cssClass),this.id=ct(),this.svgGroup=I(v.G,{id:this.id,class:e},this.workspace.getCanvas()),this.isFlyoutLabel||(n=I(v.RECT,{class:"blocklyFlyoutButtonShadow",rx:pt.BORDER_RADIUS,ry:pt.BORDER_RADIUS,x:1,y:1},this.svgGroup)),e=I(v.RECT,{class:this.isFlyoutLabel?"blocklyFlyoutLabelBackground":"blocklyFlyoutButtonBackground",rx:pt.BORDER_RADIUS,ry:pt.BORDER_RADIUS},this.svgGroup),o=I(v.TEXT,{class:this.isFlyoutLabel?"blocklyFlyoutLabelText":"blocklyText",x:0,y:0,"text-anchor":"middle"},this.svgGroup),i=Ae(this.text),this.workspace.RTL&&(i+="\u200f"),o.textContent=i,this.isFlyoutLabel&&(this.svgText=o,this.workspace.getThemeManager().subscribe(this.svgText,"flyoutForegroundColour","fill")),s=Lt(o,"fontSize");const l=Lt(o,"fontWeight"),h=Lt(o,"fontFamily");if(this.width=Mt(o,s,l,h),i=xn(i,s,l,h),this.height=this.height||i.height,!this.isFlyoutLabel){let $,k;this.width+=2*pt.TEXT_MARGIN_X,this.height+=2*pt.TEXT_MARGIN_Y,null==($=n)||$.setAttribute("width",String(this.width)),null==(k=n)||k.setAttribute("height",String(this.height))}e.setAttribute("width",String(this.width)),e.setAttribute("height",String(this.height)),o.setAttribute("x",String(this.width/2)),o.setAttribute("y",String(this.height/2-i.height/2+i.baseline)),this.updateTransform(),this.onMouseDownWrapper=U(this.svgGroup,"pointerdown",this,this.onMouseDown),this.onMouseUpWrapper=U(this.svgGroup,"pointerup",this,this.onMouseUp)}createDom(){return this.svgGroup}show(){this.updateTransform(),this.svgGroup.setAttribute("display","block")}updateTransform(){this.svgGroup.setAttribute("transform","translate("+this.position.x+","+this.position.y+")")}moveTo(e,o){this.position.x=e,this.position.y=o,this.updateTransform()}moveBy(e,o,i){this.moveTo(this.position.x+e,this.position.y+o)}isLabel(){return this.isFlyoutLabel}getPosition(){return this.position}getBoundingRectangle(){return new Q(this.position.y,this.position.y+this.height,this.position.x,this.position.x+this.width)}getButtonText(){return this.text}getTargetWorkspace(){return this.targetWorkspace}getWorkspace(){return this.workspace}dispose(){ne(this.onMouseDownWrapper),ne(this.onMouseUpWrapper),this.svgGroup&&ce(this.svgGroup),this.svgText&&this.workspace.getThemeManager().unsubscribe(this.svgText)}setCursorSvg(e){e?this.svgGroup&&(this.svgGroup.appendChild(e),this.cursorSvg=e):this.cursorSvg=null}onMouseUp(e){(e=this.targetWorkspace.getGesture(e))&&e.cancel(),this.isFlyoutLabel&&this.callbackKey?console.warn("Labels should not have callbacks. Label text: "+this.text):this.isFlyoutLabel||this.callbackKey&&this.targetWorkspace.getButtonCallback(this.callbackKey)?this.isFlyoutLabel||(e=this.targetWorkspace.getButtonCallback(this.callbackKey))&&e(this):console.warn("Buttons should have callbacks. Button text: "+this.text)}onMouseDown(e){const o=this.targetWorkspace.getGesture(e),i=this.targetWorkspace.getFlyout();o&&i&&o.handleFlyoutStart(e,i)}getSvgRoot(){return this.svgGroup}getFocusableElement(){return this.svgGroup}getFocusableTree(){return this.workspace}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}};pt.TEXT_MARGIN_X=5,pt.TEXT_MARGIN_Y=2,pt.BORDER_RADIUS=4,Dt("\n.blocklyFlyoutButton {\n  fill: #888;\n  cursor: default;\n}\n\n.blocklyFlyoutButtonShadow {\n  fill: #666;\n}\n\n.blocklyFlyoutButton:hover {\n  fill: #aaa;\n}\n\n.blocklyFlyoutLabel {\n  cursor: default;\n}\n\n.blocklyFlyoutLabelBackground {\n  opacity: 0;\n}\n");var Wp=class{getFirstChild(e){return null}getParent(e){return e.getWorkspace()}getNextSibling(e){return null}getPreviousSibling(e){return null}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof pt}},zp=class{constructor(e,o){this.policy=e,this.flyout=o}getFirstChild(e){return null}getParent(e){return this.policy.getParent(e)}getNextSibling(e){const o=this.flyout.getContents();if(!o)return null;let i=o.findIndex(s=>s.getElement()===e);return-1===i?null:(i++,i>=o.length&&(i=0),o[i].getElement())}getPreviousSibling(e){const o=this.flyout.getContents();if(!o)return null;let i=o.findIndex(s=>s.getElement()===e);return-1===i?null:(i--,i<0&&(i=o.length-1),o[i].getElement())}isNavigable(e){return this.policy.isNavigable(e)}isApplicable(e){return this.policy.isApplicable(e)}},kc=class{constructor(e,o){this.gap=e,this.axis=o,this.y=this.x=0}getBoundingRectangle(){switch(this.axis){case"x":return new Q(this.y,this.y,this.x,this.x+this.gap);case"y":return new Q(this.y,this.y+this.gap,this.x,this.x)}}moveBy(e,o,i){this.x+=e,this.y+=o}isNavigable(){return!1}getFocusableElement(){throw Error("Cannot be focused")}getFocusableTree(){throw Error("Cannot be focused")}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!1}},jp=class{getFirstChild(e){return null}getParent(e){return null}getNextSibling(e){return null}getPreviousSibling(e){return null}isNavigable(e){return!1}isApplicable(e){return e instanceof kc}},Yp=class{getFirstChild(e){return Be(e,!0)[0]}getParent(e){var o;if(null!=(o=e.previousConnection)&&o.targetBlock()){if(o=e.getSurroundParent())return o}else{let i;if(null!=(i=e.outputConnection)&&i.targetBlock())return e.outputConnection.targetBlock()}return e.workspace}getNextSibling(e){let o,i;if(null!=(o=e.nextConnection)&&o.targetBlock()){let s;return null==(s=e.nextConnection)?void 0:s.targetBlock()}return null!=(i=e.outputConnection)&&i.targetBlock()?Se(e,1):e.getSurroundParent()?Se(e.getTopStackBlock(),1):this.getParent(e)instanceof nt?Pe(e,1):null}getPreviousSibling(e){let o,i;if(null!=(o=e.previousConnection)&&o.targetBlock()){let s;return null==(s=e.previousConnection)?void 0:s.targetBlock()}return null!=(i=e.outputConnection)&&i.targetBlock()?Se(e,-1):this.getParent(e)instanceof nt?Pe(e,-1):null}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof $e}},Xp={};Xp.BlockNavigationPolicy=Yp,Xp.navigateBlock=Se,Xp.navigateStacks=Pe;var A$=class{getFirstChild(e){return null}getParent(e){return e.getParentComment()}getNextSibling(e){const o=e.getParentComment().view.getCommentBarButtons();return(e=o.indexOf(e))>=0&&e+1<o.length?o[e+1]:null}getPreviousSibling(e){const o=e.getParentComment().view.getCommentBarButtons();return(e=o.indexOf(e))>0?o[e-1]:null}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof bc}},Kp=class{getFirstChild(e){return e.getParentInput()?e.targetConnection:null}getParent(e){return e.getSourceBlock()}getNextSibling(e){if(e.getParentInput())return Se(e,1);if(e.type===N.NEXT_STATEMENT){const i=e.targetConnection;var o=e.getSourceBlock();if(!i&&o.getRootBlock().lastConnectionInStack(!1)===e){let s;return e=o.workspace.getTopBlocks(!0),(o=e.indexOf(o.getRootBlock())+1)>=e.length&&(o=0),null!=(s=this.getParentConnection(o=e[o]))?s:o}return i}return e.getSourceBlock()}getPreviousSibling(e){if(e.getParentInput())return Se(e,-1);if(e.type===N.PREVIOUS_STATEMENT||e.type===N.OUTPUT_VALUE){const i=e.targetConnection&&!e.targetConnection.getParentInput()?e.targetConnection:null;var o=e.getSourceBlock();if(!i&&this.getParentConnection(o.getRootBlock())===e){let s;return e=o.workspace.getTopBlocks(!0),(o=e.indexOf(o.getRootBlock())-1)<0&&(o=e.length-1),null!=(s=(o=e[o]).lastConnectionInStack(!1))?s:o}return i}return e.type===N.NEXT_STATEMENT?e.getSourceBlock():null}getParentConnection(e){let o;return!e.outputConnection||null!=(o=e.previousConnection)&&o.isConnected()?e.previousConnection:e.outputConnection}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof Xe}},Jp=class{getFirstChild(e){return null}getParent(e){return e.getSourceBlock()}getNextSibling(e){return Se(e,1)}getPreviousSibling(e){return Se(e,-1)}isNavigable(e){let o;return e.canBeFocused()&&e.isVisible()&&(e.isClickable()||e.isCurrentlyEditable())&&!(null!=(o=e.getSourceBlock())&&o.isSimpleReporter()&&e.isFullBlockField())&&e.getParentInput().isVisible()}isApplicable(e){return e instanceof ue}},S$=class{getFirstChild(e){if(e instanceof t.MutatorIcon$$module$build$src$core$icons$mutator_icon&&e.bubbleIsVisible()&&t.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode()===e){let o,i;return null!=(i=null==(o=e.getBubble())?void 0:o.getWorkspace())?i:null}return null}getParent(e){return e.getSourceBlock()}getNextSibling(e){return Se(e,1)}getPreviousSibling(e){return Se(e,-1)}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof Rr}},O$=class{getFirstChild(e){return e.view.getCommentBarButtons()[0]}getParent(e){return e.workspace}getNextSibling(e){return Pe(e,1)}getPreviousSibling(e){return Pe(e,-1)}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof so}},Qp=class{getFirstChild(e){return(e=e.getTopBlocks(!0)).length?e[0]:null}getParent(e){return null}getNextSibling(e){return null}getPreviousSibling(e){return null}isNavigable(e){return e.canBeFocused()&&!e.isMutator}isApplicable(e){return e instanceof nt}},od=class{constructor(){this.rules=[new Yp,new Jp,new Kp,new Qp,new S$,new O$,new A$]}addNavigationPolicy(e){this.rules.push(e)}get(e){return this.rules.find(o=>o.isApplicable(e))}getFirstChild(e){let o;const i=null==(o=this.get(e))?void 0:o.getFirstChild(e);if(!i)return null;let s;return null!=(s=this.get(i))&&s.isNavigable(i)?i:this.getFirstChild(i)||this.getNextSibling(i)}getParent(e){let o;const i=null==(o=this.get(e))?void 0:o.getParent(e);if(!i)return null;let s;return null!=(s=this.get(i))&&s.isNavigable(i)?i:this.getParent(i)}getNextSibling(e){let o;const i=null==(o=this.get(e))?void 0:o.getNextSibling(e);if(!i)return null;let s;return null!=(s=this.get(i))&&s.isNavigable(i)?i:this.getNextSibling(i)}getPreviousSibling(e){let o;const i=null==(o=this.get(e))?void 0:o.getPreviousSibling(e);if(!i)return null;let s;return null!=(s=this.get(i))&&s.isNavigable(i)?i:this.getPreviousSibling(i)}},eg=class extends od{constructor(e){super(),this.rules.push(new Wp,new jp),this.rules=this.rules.map(o=>new zp(o,e))}},id=class{constructor(e,o,i,s,n){this.workspace=e,this.oldHostMetrics=this.corner_=this.vScroll=this.hScroll=null,i=void 0===i||i;const l=(o=void 0===o||o)&&i;o&&(this.hScroll=new Oe(e,!0,l,s,n)),i&&(this.vScroll=new Oe(e,!1,l,s,n)),l&&(this.corner_=I(v.RECT,{height:Oe.scrollbarThickness,width:Oe.scrollbarThickness,class:"blocklyScrollbarBackground"}),d(this.corner_,e.getBubbleCanvas()))}dispose(){ce(this.corner_),this.oldHostMetrics=this.corner_=null,this.hScroll&&(this.hScroll.dispose(),this.hScroll=null),this.vScroll&&(this.vScroll.dispose(),this.vScroll=null)}resize(){const e=this.workspace.getMetrics();if(e){var o=!1,i=!1;if(this.oldHostMetrics&&this.oldHostMetrics.viewWidth===e.viewWidth&&this.oldHostMetrics.viewHeight===e.viewHeight&&this.oldHostMetrics.absoluteTop===e.absoluteTop&&this.oldHostMetrics.absoluteLeft===e.absoluteLeft?(this.oldHostMetrics&&this.oldHostMetrics.scrollWidth===e.scrollWidth&&this.oldHostMetrics.viewLeft===e.viewLeft&&this.oldHostMetrics.scrollLeft===e.scrollLeft||(o=!0),this.oldHostMetrics&&this.oldHostMetrics.scrollHeight===e.scrollHeight&&this.oldHostMetrics.viewTop===e.viewTop&&this.oldHostMetrics.scrollTop===e.scrollTop||(i=!0)):i=o=!0,o||i){try{t.disable$$module$build$src$core$events$utils(),this.hScroll&&o&&this.hScroll.resize(e),this.vScroll&&i&&this.vScroll.resize(e)}finally{t.enable$$module$build$src$core$events$utils()}this.workspace.maybeFireViewportChangeEvent()}if(this.hScroll&&this.vScroll){if(!this.oldHostMetrics||this.oldHostMetrics.viewWidth!==e.viewWidth||this.oldHostMetrics.absoluteLeft!==e.absoluteLeft){let s;null==(s=this.corner_)||s.setAttribute("x",String(this.vScroll.position.x))}if(!this.oldHostMetrics||this.oldHostMetrics.viewHeight!==e.viewHeight||this.oldHostMetrics.absoluteTop!==e.absoluteTop){let s;null==(s=this.corner_)||s.setAttribute("y",String(this.hScroll.position.y))}}this.oldHostMetrics=e}}canScrollHorizontally(){return!!this.hScroll}canScrollVertically(){return!!this.vScroll}setOrigin(e,o){this.hScroll&&this.hScroll.setOrigin(e,o),this.vScroll&&this.vScroll.setOrigin(e,o)}set(e,o,i){this.hScroll&&this.hScroll.set(e,!1),this.vScroll&&this.vScroll.set(o,!1),(i||void 0===i)&&(e={},this.hScroll&&(e.x=this.hScroll.getRatio_()),this.vScroll&&(e.y=this.vScroll.getRatio_()),this.workspace.setMetrics(e))}setX(e){this.hScroll&&this.hScroll.set(e,!0)}setY(e){this.vScroll&&this.vScroll.set(e,!0)}setContainerVisible(e){this.hScroll&&this.hScroll.setContainerVisible(e),this.vScroll&&this.vScroll.setContainerVisible(e)}isVisible(){let e=!1;return this.hScroll&&(e=this.hScroll.isVisible()),this.vScroll&&(e=e||this.vScroll.isVisible()),e}setVisible(e){this.hScroll&&this.hScroll.setVisibleInternal(e),this.vScroll&&this.vScroll.setVisibleInternal(e)}resizeContent(e){this.hScroll&&this.hScroll.resizeContentHorizontal(e),this.vScroll&&this.vScroll.resizeContentVertical(e)}resizeView(e){this.hScroll&&this.hScroll.resizeViewHorizontal(e),this.vScroll&&this.vScroll.resizeViewVertical(e)}},ln="sep",tg=class{load(e,o){return e=new kc(0,o.horizontalLayout?"x":"y"),new rn(e,ln)}gapForItem(e,o){let i;return null!=(i=parseInt(String(e.gap)))?i:o}disposeItem(e){}getType(){return ln}};D(w.FLYOUT_INFLATER,ln,tg),{SEPARATOR_TYPE:ln}.SeparatorFlyoutInflater=tg;var Ic=class extends Cc{constructor(e){super(),this.horizontalLayout=!1,this.boundEvents=[],this.reflowWrapper=null,this.contents=[],this.autoClose=!0,this.visible=!1,this.containerVisible=!0,this.CORNER_RADIUS=8,this.SCROLLBAR_MARGIN=2.5,this.height_=this.width_=0,this.dragAngleRange_=70,this.svgGroup_=this.svgBackground_=null,this.inflaters=new Map,e.setMetrics=this.setMetrics_.bind(this),this.workspace_=new nt(e),this.workspace_.setMetricsManager(new qp(this.workspace_,this)),this.workspace_.internalIsFlyout=!0,this.workspace_.setVisible(this.visible),this.workspace_.setNavigator(new eg(this)),this.id=Ne(),this.RTL=!!e.RTL,this.toolboxPosition_=e.toolboxPosition,this.tabWidth_=this.workspace_.getRenderer().getConstants().TAB_WIDTH,this.MARGIN=this.CORNER_RADIUS,this.GAP_X=3*this.MARGIN,this.GAP_Y=3*this.MARGIN}createDom(e){return this.svgGroup_=I(e,{class:"blocklyFlyout"}),this.svgGroup_.style.display="none",this.svgBackground_=I(v.PATH,{class:"blocklyFlyoutBackground"},this.svgGroup_),this.svgGroup_.appendChild(this.workspace_.createDom()),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutBackgroundColour","fill"),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutOpacity","fill-opacity"),this.svgGroup_}init(e){this.targetWorkspace=e,this.workspace_.targetWorkspace=e,this.workspace_.scrollbar=new id(this.workspace_,this.horizontalLayout,!this.horizontalLayout,"blocklyFlyoutScrollbar",this.SCROLLBAR_MARGIN),this.hide(),this.boundEvents.push(U(this.svgGroup_,"wheel",this,this.wheel_)),this.boundEvents.push(U(this.svgBackground_,"pointerdown",this,this.onMouseDown)),this.workspace_.getGesture=this.targetWorkspace.getGesture.bind(this.targetWorkspace),this.workspace_.setVariableMap(this.targetWorkspace.getVariableMap()),this.workspace_.createPotentialVariableMap(),e.getComponentManager().addComponent({component:this,weight:xe.ComponentWeight.FLYOUT_WEIGHT,capabilities:[xe.Capability.AUTOHIDEABLE,xe.Capability.DELETE_AREA,xe.Capability.DRAG_TARGET]})}dispose(){this.hide(),this.targetWorkspace.getComponentManager().removeComponent(this.id);for(const e of this.boundEvents)ne(e);this.boundEvents.length=0,this.workspace_&&(this.workspace_.getThemeManager().unsubscribe(this.svgBackground_),this.workspace_.dispose()),this.svgGroup_&&ce(this.svgGroup_)}getWidth(){return this.width_}getHeight(){return this.height_}getFlyoutScale(){return this.targetWorkspace.scale}getWorkspace(){return this.workspace_}setAutoClose(e){this.autoClose=e,this.targetWorkspace.recordDragTargets(),this.targetWorkspace.resizeContents()}autoHide(e){!e&&this.targetWorkspace.getFlyout(!0)===this&&this.autoClose&&this.hide()}getTargetWorkspace(){return this.targetWorkspace}isVisible(){return this.visible}setVisible(e){const o=e!==this.isVisible();this.visible=e,o&&(this.autoClose||this.targetWorkspace.recordDragTargets(),this.updateDisplay())}setContainerVisible(e){const o=e!==this.containerVisible;this.containerVisible=e,o&&this.updateDisplay()}getContents(){return this.contents}setContents(e){this.contents=e}updateDisplay(){let e,o;e=!!this.containerVisible&&this.isVisible(),this.svgGroup_&&(this.svgGroup_.style.display=e?"block":"none"),null==(o=this.workspace_.scrollbar)||o.setContainerVisible(e)}positionAt_(e,o,i,s){let n,l;null==(n=this.svgGroup_)||n.setAttribute("width",`${e}`),null==(l=this.svgGroup_)||l.setAttribute("height",`${o}`),this.workspace_.setCachedParentSvgSize(e,o),this.svgGroup_&&m(this.svgGroup_,"translate("+i+"px,"+s+"px)"),(e=this.workspace_.scrollbar)&&(e.setOrigin(i,s),e.resize(),e.hScroll&&e.hScroll.setPosition(e.hScroll.position.x,e.hScroll.position.y),e.vScroll&&e.vScroll.setPosition(e.vScroll.position.x,e.vScroll.position.y))}hide(){this.isVisible()&&(this.setVisible(!1),this.reflowWrapper&&(this.workspace_.removeChangeListener(this.reflowWrapper),this.reflowWrapper=null))}show(e){this.workspace_.setResizesEnabled(!1),this.hide(),this.clearOldBlocks(),"string"==typeof e&&(e=this.getDynamicCategoryContents(e)),this.setVisible(!0),e=$s(e),e=this.createFlyoutInfo(e),Wo(this.workspace_),this.setContents(e),this.layout_(e),this.horizontalLayout?this.height_=0:this.width_=0,this.reflow(),this.workspace_.setResizesEnabled(!0),this.reflowWrapper=o=>{o.type!==E.BLOCK_CHANGE&&o.type!==E.BLOCK_FIELD_INTERMEDIATE_CHANGE||this.reflow()},this.workspace_.addChangeListener(this.reflowWrapper)}createFlyoutInfo(e){const o=[],i=this.horizontalLayout?this.GAP_X:this.GAP_Y;for(const s of e)"custom"in s&&(e=this.getDynamicCategoryContents(s.custom),e=$s(e),o.push(...this.createFlyoutInfo(e))),e=s.kind.toLowerCase(),(e=this.getInflaterForType(e))&&(o.push(e.load(s,this)),(e=e.gapForItem(s,i))&&o.push(new rn(new kc(e,this.horizontalLayout?"x":"y"),ln)));return this.normalizeSeparators(o)}normalizeSeparators(e){for(let o=e.length-1;o>0;o--){const i=e[o].getType().toLowerCase(),s=e[o-1].getType().toLowerCase();i===ln&&s===ln&&e.splice(o-1,1)}return e}getDynamicCategoryContents(e){if("function"!=typeof(e=this.workspace_.targetWorkspace.getToolboxCategoryCallback(e)))throw TypeError("Couldn't find a callback function when opening a toolbox category.");return e(this.workspace_.targetWorkspace)}clearOldBlocks(){let e;this.getContents().forEach(o=>{let i;null==(i=this.getInflaterForType(o.getType()))||i.disposeItem(o)}),null==(e=this.workspace_.getPotentialVariableMap())||e.clear()}onMouseDown(e){const o=this.targetWorkspace.getGesture(e);o&&o.handleFlyoutStart(e,this)}isBlockCreatable(e){return e.isEnabled()&&!this.getTargetWorkspace().isReadOnly()}createBlock(e){let o=null;t.disable$$module$build$src$core$events$utils();var i=this.targetWorkspace.getAllVariables();this.targetWorkspace.setResizesEnabled(!1);try{o=this.placeNewBlock(e)}finally{t.enable$$module$build$src$core$events$utils()}if(this.targetWorkspace.hideChaff(),e=Bn(this.targetWorkspace,i),_e()){for(t.setGroup$$module$build$src$core$events$utils(!0),i=0;i<e.length;i++){const s=e[i];L(new(B(E.VAR_CREATE))(s))}L(new(B(E.BLOCK_CREATE))(o))}return this.autoClose&&this.hide(),o}reflow(){this.reflowWrapper&&this.workspace_.removeChangeListener(this.reflowWrapper),this.reflowInternal_(),this.reflowWrapper&&this.workspace_.addChangeListener(this.reflowWrapper)}isScrollable(){return!!this.workspace_.scrollbar&&this.workspace_.scrollbar.isVisible()}placeNewBlock(e){var o=this.targetWorkspace;if(!e.getSvgRoot())throw Error("oldBlock is not rendered");const i=this.serializeBlock(e);return o.setResizesEnabled(!1),o=zo(i,o),this.positionNewBlock(e,o),o}serializeBlock(e){return Tt(e)}positionNewBlock(e,o){const i=this.targetWorkspace;var s=i.getOriginOffsetInPixels(),n=this.workspace_.getOriginOffsetInPixels();(e=e.getRelativeToSurfaceXY()).scale(this.workspace_.scale),n=A.sum(n,e),(s=A.difference(n,s)).scale(1/i.scale),o.moveTo(new A(s.x,s.y))}getInflaterForType(e){var o;return this.inflaters.has(e)?null!=(o=this.inflaters.get(e))?o:null:(o=$t(w.FLYOUT_INFLATER,e))?(o=new o,this.inflaters.set(e,o),o):null}getFocusableElement(){throw Error("Flyouts are not directly focusable.")}getFocusableTree(){throw Error("Flyouts are not directly focusable.")}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!1}getRootFocusableNode(){throw Error("Flyouts are not directly focusable.")}getRestoredFocusableNode(e){throw Error("Flyouts are not directly focusable.")}getNestedTrees(){throw Error("Flyouts are not directly focusable.")}lookUpFocusableNode(e){throw Error("Flyouts are not directly focusable.")}onTreeFocus(e,o){}onTreeBlur(e){throw Error("Flyouts are not directly focusable.")}},og=class{constructor(){this.isActive=!1,this.activeClassName="blocklyKeyboardNavigation"}setIsActive(e=!0){this.isActive=e,this.updateActiveVisualization()}getIsActive(){return this.isActive}updateActiveVisualization(){this.isActive?document.body.classList.add(this.activeClassName):document.body.classList.remove(this.activeClassName)}},wc=new og,R$={};R$.KeyboardNavigationController=og,R$.keyboardNavigationController=wc;var ig=class{constructor(e){this.workspace=e,this.horizontalScrollEnabled=this.workspace.isMovableHorizontally(),this.verticalScrollEnabled=this.workspace.isMovableVertically(),this.startScrollXY_=new A(e.scrollX,e.scrollY)}dispose(){this.workspace=null}startDrag(){}endDrag(e){this.drag(e)}drag(e){if(e=A.sum(this.startScrollXY_,e),this.horizontalScrollEnabled&&this.verticalScrollEnabled)this.workspace.scroll(e.x,e.y);else if(this.horizontalScrollEnabled)this.workspace.scroll(e.x,this.workspace.scrollY);else{if(!this.verticalScrollEnabled)throw new TypeError("Invalid state.");this.workspace.scroll(this.workspace.scrollX,e.y)}}},Ac=class{constructor(e,o){this.creatorWorkspace=o,this.mouseDownXY=new A(0,0),this.startWorkspace_=this.targetBlock=this.startComment=this.startBlock=this.startIcon=this.startField=this.startBubble=null,this.hasExceededDragRadius=!1,this.boundEvents=[],this.workspaceDragger=this.dragger=null,this.dragging=!1,this.flyout=null,this.multiTouch=this.isEnding_=this.gestureHasStarted=this.calledUpdateIsDragging=!1,this.cachedPoints=new Map,this.startDistance=this.previousScale=0,this.currentDropdownOwner=this.isPinchZoomEnabled=null,this.mostRecentEvent=e,this.currentDragDeltaXY=new A(0,0)}dispose(){qe(),Na(),this.creatorWorkspace.clearGesture();for(const e of this.boundEvents)ne(e);this.boundEvents.length=0,this.workspaceDragger&&this.workspaceDragger.dispose()}updateFromEvent(e){const o=new A(e.clientX,e.clientY);this.updateDragDelta(o)&&(this.updateIsDragging(e),it()),this.mostRecentEvent=e}updateDragDelta(e){return this.currentDragDeltaXY=A.difference(e,this.mouseDownXY),!this.hasExceededDragRadius&&(this.hasExceededDragRadius=A.magnitude(this.currentDragDeltaXY)>(this.flyout?t.config$$module$build$src$core$config.flyoutDragRadius:t.config$$module$build$src$core$config.dragRadius))}updateIsDraggingFromFlyout(){let e;if(!this.targetBlock||null==(e=this.flyout)||!e.isBlockCreatable(this.targetBlock))return!1;if(!this.flyout.targetWorkspace)throw Error("Cannot update dragging from the flyout because the ' +\n          'flyout's target workspace is undefined");return!(this.flyout.isScrollable()&&!this.flyout.isDragTowardWorkspace(this.currentDragDeltaXY)||(this.startWorkspace_=this.flyout.targetWorkspace,this.startWorkspace_.updateScreenCalculationsIfScrolled(),t.getGroup$$module$build$src$core$events$utils()||t.setGroup$$module$build$src$core$events$utils(!0),this.startBlock=null,this.targetBlock=this.flyout.createBlock(this.targetBlock),t.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.targetBlock),0))}updateIsDraggingWorkspace(){if(!this.startWorkspace_)throw Error("Cannot update dragging the workspace because the start workspace is undefined");(this.flyout?this.flyout.isScrollable():this.startWorkspace_&&this.startWorkspace_.isDraggable())&&(this.dragging=!0,this.workspaceDragger=new ig(this.startWorkspace_),this.workspaceDragger.startDrag())}updateIsDragging(e){if(!this.startWorkspace_)throw Error("Cannot update dragging because the start workspace is undefined");if(this.calledUpdateIsDragging)throw Error("updateIsDragging_ should only be called once per gesture.");this.calledUpdateIsDragging=!0,this.flyout&&this.updateIsDraggingFromFlyout();const o=fo();o&&ut(o)&&o.isMovable()?(this.dragging=!0,this.dragger=this.createDragger(o,this.startWorkspace_),this.dragger.onDragStart(e),this.dragger.onDrag(e,this.currentDragDeltaXY)):this.updateIsDraggingWorkspace()}createDragger(e,o){return new(Ve(w.BLOCK_DRAGGER,this.creatorWorkspace.options,!0))(e,o)}doStart(e){if(!this.startWorkspace_)throw Error("Cannot start the touch gesture becauase the start workspace is undefined");this.isPinchZoomEnabled=this.startWorkspace_.options.zoomOptions&&this.startWorkspace_.options.zoomOptions.pinch,Fo(e)?this.cancel():(this.gestureHasStarted=!0,q(),this.startWorkspace_.updateScreenCalculationsIfScrolled(),this.startWorkspace_.isMutator&&this.startWorkspace_.resize(),this.currentDropdownOwner=pa(),this.startWorkspace_.hideChaff(!!this.flyout),this.startWorkspace_.markFocused(),this.mostRecentEvent=e,Ma(),_t(e)?this.handleRightClick(e):("pointerdown"===e.type.toLowerCase()&&"mouse"!==e.pointerType&&ts(e,this),this.mouseDownXY=new A(e.clientX,e.clientY),this.bindMouseEvents(e),this.isEnding_||this.handleTouchStart(e)))}bindMouseEvents(e){this.boundEvents.push(U(document,"pointerdown",null,this.handleStart.bind(this),!0)),this.boundEvents.push(U(document,"pointermove",null,this.handleMove.bind(this),!0)),this.boundEvents.push(U(document,"pointerup",null,this.handleUp.bind(this),!0)),e.preventDefault(),e.stopPropagation()}handleStart(e){this.isDragging()||(this.handleTouchStart(e),this.isMultiTouch()&&it())}handleMove(e){this.isDragging()&&fe(e)||!this.isMultiTouch()?(this.updateFromEvent(e),this.workspaceDragger?this.workspaceDragger.drag(this.currentDragDeltaXY):this.dragger&&this.dragger.onDrag(this.mostRecentEvent,this.currentDragDeltaXY),e.preventDefault(),e.stopPropagation()):this.isMultiTouch()&&(this.handleTouchMove(e),it())}handleUp(e){if(this.isDragging()||this.handleTouchEnd(e),!this.isMultiTouch()||this.isDragging()){if(!fe(e))return;if(this.updateFromEvent(e),it(),this.isEnding_)return void console.log("Trying to end a gesture recursively.");this.isEnding_=!0,this.dragger?(wc.setIsActive(!1),this.dragger.onDragEnd(e,this.currentDragDeltaXY)):this.workspaceDragger?(wc.setIsActive(!1),this.workspaceDragger.endDrag(this.currentDragDeltaXY)):this.isBubbleClick()||this.isCommentClick()||(this.isFieldClick()?this.doFieldClick():this.isIconClick()?this.doIconClick():this.isBlockClick()?this.doBlockClick():this.isWorkspaceClick()&&this.doWorkspaceClick(e))}e.preventDefault(),e.stopPropagation(),this.dispose()}handleTouchStart(e){var o=mo(e);this.cachedPoints.set(o,this.getTouchPoint(e));var i=Array.from(this.cachedPoints.keys());2===i.length&&(o=this.cachedPoints.get(i[0]),i=this.cachedPoints.get(i[1]),this.startDistance=A.distance(o,i),this.multiTouch=!0,e.preventDefault())}handleTouchMove(e){const o=mo(e);this.cachedPoints.set(o,this.getTouchPoint(e)),this.isPinchZoomEnabled&&2===this.cachedPoints.size?this.handlePinch(e):(this.updateFromEvent(e),this.workspaceDragger?this.workspaceDragger.drag(this.currentDragDeltaXY):this.dragger&&this.dragger.onDrag(this.mostRecentEvent,this.currentDragDeltaXY),e.preventDefault(),e.stopPropagation())}handlePinch(e){var o=Array.from(this.cachedPoints.keys()),i=this.cachedPoints.get(o[0]);if(o=this.cachedPoints.get(o[1]),i=A.distance(i,o)/this.startDistance,this.previousScale>0&&this.previousScale<1/0){if(o=(o=i-this.previousScale)>0?5*o:6*o,!this.startWorkspace_)throw Error("Cannot handle a pinch because the start workspace is undefined");const s=this.startWorkspace_,n=$o(e,s.getParentSvg(),s.getInverseScreenCTM());s.zoom(n.x,n.y,o)}this.previousScale=i,e.preventDefault()}handleTouchEnd(e){e=mo(e),this.cachedPoints.has(e)&&this.cachedPoints.delete(e),this.cachedPoints.size<2&&(this.cachedPoints.clear(),this.previousScale=0)}getTouchPoint(e){return this.startWorkspace_?new A(e.pageX,e.pageY):null}isMultiTouch(){return this.multiTouch}cancel(){this.isEnding_||(it(),this.dragger?this.dragger.onDragEnd(this.mostRecentEvent,this.currentDragDeltaXY):this.workspaceDragger&&this.workspaceDragger.endDrag(this.currentDragDeltaXY),this.dispose())}handleRightClick(e){this.targetBlock?(this.bringBlockToFront(),this.targetBlock.workspace.hideChaff(!!this.flyout),this.targetBlock.showContextMenu(e)):this.startBubble?this.startBubble.showContextMenu(e):this.startComment?(this.startComment.workspace.hideChaff(),this.startComment.showContextMenu(e)):this.startWorkspace_&&!this.flyout&&(this.startWorkspace_.hideChaff(),t.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.startWorkspace_),this.startWorkspace_.showContextMenu(e)),e.preventDefault(),e.stopPropagation(),wc.setIsActive(!1),this.dispose()}handleWsStart(e,o){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleWsStart, but the gesture had already been started.");this.setStartWorkspace(o),this.mostRecentEvent=e,this.startBlock||this.startBubble||this.startComment?this.startBlock&&t.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.startBlock):t.getFocusManager$$module$build$src$core$focus_manager().focusNode(o),this.doStart(e)}fireWorkspaceClick(e){L(new(B(E.CLICK))(null,e.id,"workspace"))}handleFlyoutStart(e,o){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleFlyoutStart, but the gesture had already been started.");this.setStartFlyout(o),this.handleWsStart(e,o.getWorkspace())}handleBlockStart(e,o){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleBlockStart, but the gesture had already been started.");this.setStartBlock(o),this.mostRecentEvent=e}handleBubbleStart(e,o){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleBubbleStart, but the gesture had already been started.");this.setStartBubble(o),this.mostRecentEvent=e}handleCommentStart(e,o){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleCommentStart, but the gesture had already been started.");this.setStartComment(o),this.mostRecentEvent=e}doFieldClick(){if(!this.startField)throw Error("Cannot do a field click because the start field is undefined");this.bringBlockToFront(),this.currentDropdownOwner!==this.startField&&this.startField.showEditor(this.mostRecentEvent)}doIconClick(){if(!this.startIcon)throw Error("Cannot do an icon click because the start icon is undefined");this.bringBlockToFront(),this.startIcon.onClick()}doBlockClick(){if(this.flyout&&this.flyout.autoClose){if(!this.targetBlock)throw Error("Cannot do a block click because the target block is undefined");if(this.flyout.isBlockCreatable(this.targetBlock)){t.getGroup$$module$build$src$core$events$utils()||t.setGroup$$module$build$src$core$events$utils(!0);var e=this.flyout.createBlock(this.targetBlock);e.snapToGrid(),e.bumpNeighbours(),t.getFocusManager$$module$build$src$core$focus_manager().focusNode(e)}}else{if(!this.startWorkspace_)throw Error("Cannot do a block click because the start workspace is undefined");e=new(B(E.CLICK))(this.startBlock,this.startWorkspace_.id,"block"),L(e)}this.bringBlockToFront(),t.setGroup$$module$build$src$core$events$utils(!1)}doWorkspaceClick(e){this.fireWorkspaceClick(this.startWorkspace_||this.creatorWorkspace)}bringBlockToFront(){this.targetBlock&&!this.flyout&&(t.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.targetBlock),this.targetBlock.bringToFront())}setStartField(e){if(this.gestureHasStarted)throw Error("Tried to call gesture.setStartField, but the gesture had already been started.");this.startField||(this.startField=e)}setStartIcon(e){if(this.gestureHasStarted)throw Error("Tried to call gesture.setStartIcon, but the gesture had already been started.");this.startIcon||(this.startIcon=e)}setStartBubble(e){this.startBubble||(this.startBubble=e)}setStartComment(e){this.startComment||(this.startComment=e)}setStartBlock(e){this.startBlock||this.startBubble||(this.startBlock=e,e.isInFlyout&&e!==e.getRootBlock()?this.setTargetBlock(e.getRootBlock()):this.setTargetBlock(e))}setTargetBlock(e){e.isShadow()?this.setTargetBlock(e.getParent()):(this.targetBlock=e,t.getFocusManager$$module$build$src$core$focus_manager().focusNode(e))}setStartWorkspace(e){this.startWorkspace_||(this.startWorkspace_=e)}setStartFlyout(e){this.flyout||(this.flyout=e)}isBubbleClick(){return!!this.startBubble&&!this.hasExceededDragRadius}isCommentClick(){return!!this.startComment&&!this.hasExceededDragRadius}isBlockClick(){return!(!this.startBlock||this.hasExceededDragRadius||this.isFieldClick()||this.isIconClick())}isFieldClick(){return!!this.startField&&this.startField.isClickable()&&!this.hasExceededDragRadius&&(!this.flyout||this.startField.isClickableInFlyout(this.flyout.autoClose))}isIconClick(){if(!this.startIcon)return!1;const e=!this.flyout||!this.startIcon.isClickableInFlyout||this.startIcon.isClickableInFlyout(this.flyout.autoClose);return!this.hasExceededDragRadius&&e}isWorkspaceClick(){return!(this.startBlock||this.startBubble||this.startField||this.hasExceededDragRadius)}getCurrentDragger(){let e,o;return null!=(o=null!=(e=this.workspaceDragger)?e:this.dragger)?o:null}isDragging(){return this.dragging}hasStarted(){return this.gestureHasStarted}static inProgress(){const e=fi();for(let i,o=0;i=e[o];o++)if(i.currentGesture_)return!0;return!1}},sd=class{constructor(e,o){let i,s,n;this.pattern=e,this.scale=1,this.spacing=null!=(i=o.spacing)?i:0,this.length=null!=(s=o.length)?s:1,this.line2=(this.line1=e.firstChild)&&this.line1.nextSibling,this.snapToGrid=null!=(n=o.snap)&&n}setSpacing(e){this.spacing=e,this.update(this.scale)}getSpacing(){return this.spacing}setLength(e){this.length=e,this.update(this.scale)}getLength(){return this.length}setSnapToGrid(e){this.snapToGrid=e}shouldSnap(){return this.snapToGrid}getPatternId(){return this.pattern.id}update(e){this.scale=e;var o=this.spacing*e;this.pattern.setAttribute("width",`${o}`),this.pattern.setAttribute("height",`${o}`);let i=(o=Math.floor(this.spacing/2)+.5)-this.length/2,s=o+this.length/2;i*=e,s*=e,this.setLineAttributes(this.line1,e,i,s,o*=e,o),this.setLineAttributes(this.line2,e,o,o,i,s)}setLineAttributes(e,o,i,s,n,l){e&&(e.setAttribute("stroke-width",`${o}`),e.setAttribute("x1",`${i}`),e.setAttribute("y1",`${n}`),e.setAttribute("x2",`${s}`),e.setAttribute("y2",`${l}`))}moveTo(e,o){this.pattern.setAttribute("x",`${e}`),this.pattern.setAttribute("y",`${o}`)}alignXY(e){var o=this.getSpacing();const i=o/2,s=Math.round(Math.round((e.x-i)/o)*o+i);return o=Math.round(Math.round((e.y-i)/o)*o+i),s===e.x&&o===e.y?e:new A(s,o)}static createDom(e,o,i,s){let n,l;if(e=I(v.PATTERN,{id:"blocklyGridPattern"+e,patternUnits:"userSpaceOnUse"},i),(null!=(n=o.length)?n:1)>0&&(null!=(l=o.spacing)?l:0)>0){let h;I(v.LINE,{stroke:o.colour},e),null!=(h=o.length)&&h&&I(v.LINE,{stroke:o.colour},e)}else I(v.LINE,{},e);return s&&s.style.setProperty("--blocklyGridPattern",`url(#${e.id})`),e}},sg=class{constructor(){this.curNode=this.colour=null,this.type="marker"}getCurNode(){return this.curNode}setCurNode(e){this.curNode=e}dispose(){this.curNode=null}getSourceBlockFromNode(e){return e instanceof $e?e:e instanceof ue||e instanceof Xe?e.getSourceBlock():null}getSourceBlock(){return this.getSourceBlockFromNode(this.getCurNode())}},nd=class extends sg{constructor(e){super(),this.workspace=e,this.type="cursor",this.potentialNodes=null}next(){var e=this.getCurNode();return e?((e=this.getNextNode(e,o=>{let i;return o instanceof $e&&!(null!=(i=o.outputConnection)&&i.targetBlock())||o instanceof so},!0))&&this.setCurNode(e),e):null}in(){var e=this.getCurNode();return e?((e=this.getNextNode(e,()=>!0,!0))&&this.setCurNode(e),e):null}prev(){var e=this.getCurNode();return e?((e=this.getPreviousNode(e,o=>{let i;return o instanceof $e&&!(null!=(i=o.outputConnection)&&i.targetBlock())||o instanceof so},!0))&&this.setCurNode(e),e):null}out(){var e=this.getCurNode();return e?((e=this.getPreviousNode(e,()=>!0,!0))&&this.setCurNode(e),e):null}atEndOfLine(){var e=this.getCurNode();return!!e&&this.getNextNode(e,()=>!0,!0)===this.getNextNode(e,i=>{let s;return i instanceof $e&&!(null!=(s=i.outputConnection)&&s.targetBlock())},!0)}getNextNodeImpl(e,o,i=new Set){if(!e||i.has(e))return null;let s=this.workspace.getNavigator().getFirstChild(e)||this.workspace.getNavigator().getNextSibling(e);for(var n=e;n&&!s&&(n=this.workspace.getNavigator().getParent(n));)s=this.workspace.getNavigator().getNextSibling(n);return o(s)?s:s?(i.add(e),this.getNextNodeImpl(s,o,i)):null}getNextNode(e,o,i){return!e||!i&&this.getLastNode()===e?null:this.getNextNodeImpl(e,o)}getPreviousNodeImpl(e,o,i=new Set){if(!e||i.has(e))return null;const s=this.getRightMostChild(this.workspace.getNavigator().getPreviousSibling(e),e)||this.workspace.getNavigator().getParent(e);return o(s)?s:s?(i.add(e),this.getPreviousNodeImpl(s,o,i)):null}getPreviousNode(e,o,i){return!e||!i&&this.getFirstNode()===e?null:this.getPreviousNodeImpl(e,o)}getRightMostChild(e,o){if(!e)return e;let i=this.workspace.getNavigator().getFirstChild(e);if(!i||i===o)return e;for(e=i;e&&e!==o;e=this.workspace.getNavigator().getNextSibling(i))i=e;return this.getRightMostChild(i,o)}preDelete(e){var i,o=this.getCurNode();let s,n;o=o?[o]:[];const l=null!=(n=null==(i=e.previousConnection)?void 0:i.targetConnection)?n:null==(s=e.outputConnection)?void 0:s.targetConnection;l&&o.push(l),(i=e.getNextBlock())&&o.push(i),(e=e.getParent())&&o.push(e),o.push(this.workspace),this.potentialNodes=o}postDelete(){const e=this.potentialNodes;if(this.potentialNodes=null,!e)throw Error("must call preDelete first");for(const o of e){let i;if(null==(i=this.getSourceBlockFromNode(o))||!i.disposed)return void this.setCurNode(o)}throw Error("no valid nodes in this.potentialNodes")}getCurNode(){return t.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode()}setCurNode(e){t.getFocusManager$$module$build$src$core$focus_manager().focusNode(e),e instanceof $e?e.workspace.scrollBoundsIntoView(e.getBoundingRectangleWithoutChildren()):e instanceof ue?(e=e.getSourceBlock()).workspace.scrollBoundsIntoView(e.getBoundingRectangleWithoutChildren()):e instanceof so&&e.workspace.scrollBoundsIntoView(e.getBoundingRectangle())}getFirstNode(){return this.workspace.getNavigator().getFirstChild(this.workspace)}getLastNode(){const e=this.getFirstNode();return this.getPreviousNode(e,()=>!0,!0)}};D(w.CURSOR,vt,nd);var rd=class{constructor(e){this.workspace=e,this.markers=new Map,this.cursor=new nd(this.workspace)}registerMarker(e,o){this.markers.has(e)&&this.unregisterMarker(e),this.markers.set(e,o)}unregisterMarker(e){const o=this.markers.get(e);if(!o)throw Error("Marker with ID "+e+" does not exist. Can only unregister markers that exist.");o.dispose(),this.markers.delete(e)}getCursor(){return this.cursor}getMarker(e){return this.markers.get(e)||null}setCursor(e){this.cursor=e}dispose(){const e=Object.keys(this.markers);for(let i,o=0;i=e[o];o++)this.unregisterMarker(i);this.markers.clear(),this.cursor.dispose()}};rd.LOCAL_MARKER="local_marker_1";var ld=class extends de{constructor(e,o,i){super(e,o,i,ld.createTextArea()),this.workspace=e,this.anchor=o,this.ownerRect=i,this.resizePointerMoveListener=this.resizePointerUpListener=null,this.textChangeListeners=[],this.sizeChangeListeners=[],this.locationChangeListeners=[],this.text="",this.DEFAULT_SIZE=new ee(160+de.DOUBLE_BORDER,80+de.DOUBLE_BORDER),this.MIN_SIZE=new ee(45+de.DOUBLE_BORDER,20+de.DOUBLE_BORDER),this.editable=!0,R(this.svgRoot,"blocklyTextInputBubble"),this.textArea=this.getFocusableElement(),this.inputRoot=this.createEditor(this.contentContainer,this.textArea),this.resizeGroup=this.createResizeHandle(this.svgRoot,e),this.setSize(this.DEFAULT_SIZE,!0)}getText(){return this.text}setText(e){this.text=e,this.textArea.value=e,this.onTextChange()}setEditable(e){(this.editable=e)?this.textArea.removeAttribute("readonly"):this.textArea.setAttribute("readonly","")}isEditable(){return this.editable}addTextChangeListener(e){this.textChangeListeners.push(e)}addSizeChangeListener(e){this.sizeChangeListeners.push(e)}addLocationChangeListener(e){this.locationChangeListeners.push(e)}static createTextArea(){const e=document.createElementNS(Ao,"textarea");return e.className="blocklyTextarea blocklyText",e}createEditor(e,o){e=I(v.FOREIGNOBJECT,{x:de.BORDER_WIDTH,y:de.BORDER_WIDTH},e);const i=document.createElementNS(Ao,"body");return i.setAttribute("xmlns",Ao),i.className="blocklyMinimalBody",o.setAttribute("dir",this.workspace.RTL?"RTL":"LTR"),i.appendChild(o),e.appendChild(i),this.bindTextAreaEvents(o),e}bindTextAreaEvents(e){U(e,"wheel",this,o=>{o.stopPropagation()}),U(e,"pointerdown",this,o=>{o.stopPropagation(),qe()}),U(e,"change",this,this.onTextChange)}createResizeHandle(e,o){return e=I(v.IMAGE,{class:"blocklyResizeHandle",href:`${o.options.pathToMedia}resize-handle.svg`},e),U(e,"pointerdown",this,this.onResizePointerDown),e}setSize(e,o=!1){e.width=Math.max(e.width,this.MIN_SIZE.width),e.height=Math.max(e.height,this.MIN_SIZE.height);const i=e.width-de.DOUBLE_BORDER,s=e.height-de.DOUBLE_BORDER;this.inputRoot.setAttribute("width",`${i}`),this.inputRoot.setAttribute("height",`${s}`),this.resizeGroup.setAttribute("y",`${s}`),this.resizeGroup.setAttribute("x",this.workspace.RTL?""+-de.DOUBLE_BORDER:`${i}`),super.setSize(e,o),this.onSizeChange()}getSize(){return super.getSize()}moveDuringDrag(e){super.moveDuringDrag(e),this.onLocationChange()}setPositionRelativeToAnchor(e,o){super.setPositionRelativeToAnchor(e,o),this.onLocationChange()}positionByRect(e=new Q(0,0,0,0)){super.positionByRect(e),this.onLocationChange()}onResizePointerDown(e){this.bringToFront(),_t(e)||(Yo(this.workspace,e,new A(this.workspace.RTL?-this.getSize().width:this.getSize().width,this.getSize().height)),this.resizePointerUpListener=U(document,"pointerup",this,this.onResizePointerUp),this.resizePointerMoveListener=U(document,"pointermove",this,this.onResizePointerMove),this.workspace.hideChaff()),e.stopPropagation()}onResizePointerUp(e){qe(),this.resizePointerUpListener&&(ne(this.resizePointerUpListener),this.resizePointerUpListener=null),this.resizePointerMoveListener&&(ne(this.resizePointerMoveListener),this.resizePointerMoveListener=null)}onResizePointerMove(e){e=Ss(this.workspace,e),this.setSize(new ee(this.workspace.RTL?-e.x:e.x,e.y),!1),this.onSizeChange()}onTextChange(){this.text=this.textArea.value;for(const e of this.textChangeListeners)e()}onSizeChange(){for(const e of this.sizeChangeListeners)e()}onLocationChange(){for(const e of this.locationChangeListeners)e()}};Dt("\n.blocklyTextInputBubble .blocklyTextarea {\n  background-color: var(--commentFillColour);\n  border: 0;\n  box-sizing: border-box;\n  display: block;\n  outline: 0;\n  padding: 5px;\n  resize: none;\n  width: 100%;\n  height: 100%;\n}\n");var ng={};ng.register=Xn,ng.unregister=Ml;var Ro=class extends Rr{constructor(e){super(e),this.sourceBlock=e,this.textInputBubble=null,this.text="",this.bubbleSize=new ee(160,80),this.bubbleVisiblity=!1}getType(){return Ro.TYPE}initView(e){this.svgRoot||(super.initView(e),I(v.CIRCLE,{class:"blocklyIconShape",r:"8",cx:"8",cy:"8"},this.svgRoot),I(v.PATH,{class:"blocklyIconSymbol",d:"m6.8,10h2c0.003,-0.617 0.271,-0.962 0.633,-1.266 2.875,-2.4050.607,-5.534 -3.765,-3.874v1.7c3.12,-1.657 3.698,0.118 2.336,1.25-1.201,0.998 -1.201,1.528 -1.204,2.19z"},this.svgRoot),I(v.RECT,{class:"blocklyIconSymbol",x:"6.8",y:"10.78",height:"2",width:"2"},this.svgRoot),R(this.svgRoot,"blocklyCommentIcon"))}dispose(){let e;super.dispose(),null==(e=this.textInputBubble)||e.dispose()}getWeight(){return Ro.WEIGHT}getSize(){return new ee(17,17)}applyColour(){super.applyColour();const e=this.sourceBlock.getColour();let o;null==(o=this.textInputBubble)||o.setColour(e)}updateEditable(){const e=this,o=()=>super.updateEditable;return(0,C.asyncExecutePromiseGeneratorFunction)(function*(){o().call(e),e.bubbleIsVisible()&&(yield e.setBubbleVisible(!1),yield e.setBubbleVisible(!0))})}onLocationChange(e){const o=this.workspaceLocation;let i;super.onLocationChange(e),this.bubbleLocation&&(e=A.difference(this.workspaceLocation,o),this.bubbleLocation=A.sum(this.bubbleLocation,e)),e=this.getAnchorLocation(),null==(i=this.textInputBubble)||i.setAnchorLocation(e)}setText(e){const o=this.text;let i;L(new(B(E.BLOCK_CHANGE))(this.sourceBlock,"comment",null,o,e)),this.text=e,null==(i=this.textInputBubble)||i.setText(this.text)}getText(){return this.text}setBubbleSize(e){let o;this.bubbleSize=e,null==(o=this.textInputBubble)||o.setSize(this.bubbleSize,!0)}getBubbleSize(){return this.bubbleSize}setBubbleLocation(e){let o;this.bubbleLocation=e,null==(o=this.textInputBubble)||o.moveDuringDrag(e)}getBubbleLocation(){return this.bubbleLocation}saveState(){if(this.text){const e={text:this.text,pinned:this.bubbleIsVisible(),height:this.bubbleSize.height,width:this.bubbleSize.width},o=this.getBubbleLocation();return o&&(e.x=this.sourceBlock.workspace.RTL?this.sourceBlock.workspace.getWidth()-(o.x+this.bubbleSize.width):o.x,e.y=o.y),e}return null}loadState(e){let o,i,s,n;this.text=null!=(o=e.text)?o:"",this.bubbleSize=new ee(null!=(i=e.width)?i:160,null!=(s=e.height)?s:80),this.bubbleVisiblity=null!=(n=e.pinned)&&n,this.setBubbleVisible(this.bubbleVisiblity);let l=e.x;const h=e.y;Xt().then(()=>{l&&h&&(l=this.sourceBlock.workspace.RTL?this.sourceBlock.workspace.getWidth()-(l+this.bubbleSize.width):l,this.setBubbleLocation(new A(l,h)))})}onClick(){super.onClick(),this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}onTextChange(){if(this.textInputBubble){var e=this.textInputBubble.getText();this.text!==e&&(L(new(B(E.BLOCK_CHANGE))(this.sourceBlock,"comment",null,this.text,e)),this.text=e)}}onSizeChange(){this.textInputBubble&&(this.bubbleSize=this.textInputBubble.getSize())}onBubbleLocationChange(){this.textInputBubble&&(this.bubbleLocation=this.textInputBubble.getRelativeToSurfaceXY())}bubbleIsVisible(){return this.bubbleVisiblity}setBubbleVisible(e){const o=this;return(0,C.asyncExecutePromiseGeneratorFunction)(function*(){o.bubbleVisiblity!==e&&(o.bubbleVisiblity=e,yield Xt(),!o.sourceBlock.rendered||o.sourceBlock.isInFlyout||o.sourceBlock.isInsertionMarker()||(e?(o.sourceBlock.isEditable()?o.showEditableBubble():o.showNonEditableBubble(),o.applyColour()):o.hideBubble(),L(new(B(E.BUBBLE_OPEN))(o.sourceBlock,e,"comment"))))})}getBubble(){return this.textInputBubble}showEditableBubble(){let e,o;this.createBubble(),null==(e=this.textInputBubble)||e.addTextChangeListener(()=>this.onTextChange()),null==(o=this.textInputBubble)||o.addSizeChangeListener(()=>this.onSizeChange())}showNonEditableBubble(){let e;this.createBubble(),null==(e=this.textInputBubble)||e.setEditable(!1)}createBubble(){this.textInputBubble=new ld(this.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect()),this.textInputBubble.setText(this.getText()),this.textInputBubble.setSize(this.bubbleSize,!0),this.bubbleLocation&&this.textInputBubble.moveDuringDrag(this.bubbleLocation),this.textInputBubble.addTextChangeListener(()=>this.onTextChange()),this.textInputBubble.addSizeChangeListener(()=>this.onSizeChange()),this.textInputBubble.addLocationChangeListener(()=>this.onBubbleLocationChange())}hideBubble(){let e;null==(e=this.textInputBubble)||e.dispose(),this.textInputBubble=null}getAnchorLocation(){return A.sum(this.workspaceLocation,new A(8.5,8.5))}getBubbleOwnerRect(){return this.sourceBlock.getBoundingRectangleWithoutChildren()}};Ro.TYPE=Ue.COMMENT,Ro.WEIGHT=3,Xn(Ro.TYPE,Ro);var ji={};ji.CommentIcon=Ro,ji.Icon=Rr,ji.IconType=Ue,ji.MutatorIcon=t.MutatorIcon$$module$build$src$core$icons$mutator_icon,ji.WarningIcon=co,ji.exceptions=x$,ji.registry=ng,t.Names$$module$build$src$core$names=class{constructor(e,o){this.db=new Map,this.dbReverse=new Set,this.variableMap=null,this.variablePrefix=o||"",this.reservedWords=new Set(e?e.split(","):[])}reset(){this.db.clear(),this.dbReverse.clear(),this.variableMap=null}setVariableMap(e){this.variableMap=e}getNameForUserVariable(e){return this.variableMap?(e=this.variableMap.getVariableById(e))?e.getName():null:(console.warn("Deprecated call to Names.prototype.getName without defining a variable map. To fix, add the following code in your generator's init() function:\nBlockly.YourGeneratorName.nameDB_.setVariableMap(workspace.getVariableMap());"),null)}populateVariables(e){e=t.allUsedVarModels$$module$build$src$core$variables(e);for(let o=0;o<e.length;o++)this.getName(e[o].getId(),t.NameType$$module$build$src$core$names.VARIABLE)}populateProcedures(e){throw Error("The implementation of populateProcedures should be monkey-patched in by blockly.ts")}getName(e,o){let i=e;o===t.NameType$$module$build$src$core$names.VARIABLE&&(e=this.getNameForUserVariable(e))&&(i=e),e=i.toLowerCase();const s=o===t.NameType$$module$build$src$core$names.VARIABLE||o===t.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix:"";this.db.has(o)||this.db.set(o,new Map);const n=this.db.get(o);return n.has(e)?s+n.get(e):(o=this.getDistinctName(i,o),n.set(e,o.substr(s.length)),o)}getUserNames(e){let o;return(e=null==(o=this.db.get(e))?void 0:o.keys())?Array.from(e):[]}getDistinctName(e,o){e=this.safeName(e);let s,n,l,i=null;for(;this.dbReverse.has(e+(null!=(s=i)?s:""))||this.reservedWords.has(e+(null!=(n=i)?n:""));)i=i?i+1:2;return e+=null!=(l=i)?l:"",this.dbReverse.add(e),(o===t.NameType$$module$build$src$core$names.VARIABLE||o===t.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix:"")+e}safeName(e){return e?(e=encodeURI(e.replace(/ /g,"_")).replace(/[^\w]/g,"_"),"0123456789".includes(e[0])&&(e="my_"+e)):e=t.Msg$$module$build$src$core$msg.UNNAMED_KEY||"unnamed",e}static equals(e,o){return e.toLowerCase()===o.toLowerCase()}},function(e){(e=e.NameType||(e.NameType={})).DEVELOPER_VARIABLE="DEVELOPER_VARIABLE",e.VARIABLE="VARIABLE",e.PROCEDURE="PROCEDURE"}(t.Names$$module$build$src$core$names||(t.Names$$module$build$src$core$names={})),t.NameType$$module$build$src$core$names=t.Names$$module$build$src$core$names.NameType,t.Names$$module$build$src$core$names.DEVELOPER_VARIABLE_TYPE=t.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE,{NameType:t.NameType$$module$build$src$core$names}.Names=t.Names$$module$build$src$core$names;var Sc,gt,lg=class extends Map{constructor(){super()}set(e,o){return this.get(e)===o||(super.set(e,o),Ut(o)&&o.startPublishing()),this}delete(e){const o=this.get(e);return(e=super.delete(e))&&(Ut(o)&&o.stopPublishing(),e)}clear(){if(this.size)for(const e of this.keys())this.delete(e)}add(e){return this.set(e.getId(),e)}getProcedures(){return[...this.values()]}};Sc="PROCEDURE",t.DEFAULT_ARG$$module$build$src$core$procedures="x",(gt={CATEGORY_NAME:Sc,DEFAULT_ARG:t.DEFAULT_ARG$$module$build$src$core$procedures}).ObservableProcedureMap=lg,gt.allProcedures=Ai,gt.findLegalName=t.findLegalName$$module$build$src$core$procedures,gt.flyoutCategory=Jn,gt.getCallers=Dl,gt.getDefinition=t.getDefinition$$module$build$src$core$procedures,gt.internalFlyoutCategory=Ds,gt.isNameUsed=Kn,gt.isProcedureBlock=Ft,gt.mutateCallers=t.mutateCallers$$module$build$src$core$procedures,gt.mutatorOpenListener=er,gt.rename=t.rename$$module$build$src$core$procedures;var _=new class{constructor(){this.NONE=0,this.FIELD=1,this.HAT=2,this.ICON=4,this.SPACER=8,this.BETWEEN_ROW_SPACER=16,this.IN_ROW_SPACER=32,this.EXTERNAL_VALUE_INPUT=64,this.INPUT=128,this.INLINE_INPUT=256,this.STATEMENT_INPUT=512,this.CONNECTION=1024,this.PREVIOUS_CONNECTION=2048,this.NEXT_CONNECTION=4096,this.OUTPUT_CONNECTION=8192,this.CORNER=16384,this.LEFT_SQUARE_CORNER=32768,this.LEFT_ROUND_CORNER=65536,this.RIGHT_SQUARE_CORNER=131072,this.RIGHT_ROUND_CORNER=262144,this.JAGGED_EDGE=524288,this.ROW=1048576,this.TOP_ROW=2097152,this.BOTTOM_ROW=4194304,this.INPUT_ROW=8388608,this.LEFT_CORNER=this.LEFT_SQUARE_CORNER|this.LEFT_ROUND_CORNER,this.RIGHT_CORNER=this.RIGHT_SQUARE_CORNER|this.RIGHT_ROUND_CORNER,this.nextTypeValue_=16777216}getType(e){return Object.prototype.hasOwnProperty.call(this,e)||(this[e]=this.nextTypeValue_,this.nextTypeValue_<<=1),this[e]}isField(e){return(e.type&this.FIELD)>=1}isHat(e){return(e.type&this.HAT)>=1}isIcon(e){return(e.type&this.ICON)>=1}isSpacer(e){return(e.type&this.SPACER)>=1}isInRowSpacer(e){return(e.type&this.IN_ROW_SPACER)>=1}isSpacerRow(e){return(e.type&this.BETWEEN_ROW_SPACER)>=1}isInput(e){return(e.type&this.INPUT)>=1}isExternalInput(e){return(e.type&this.EXTERNAL_VALUE_INPUT)>=1}isInlineInput(e){return(e.type&this.INLINE_INPUT)>=1}isStatementInput(e){return(e.type&this.STATEMENT_INPUT)>=1}isPreviousConnection(e){return(e.type&this.PREVIOUS_CONNECTION)>=1}isNextConnection(e){return(e.type&this.NEXT_CONNECTION)>=1}isPreviousOrNextConnection(e){return this.isPreviousConnection(e)||this.isNextConnection(e)}isRoundCorner(e){return(e.type&this.LEFT_ROUND_CORNER)>=1||(e.type&this.RIGHT_ROUND_CORNER)>=1}isLeftRoundedCorner(e){return this.isRoundCorner(e)&&(e.type&this.LEFT_ROUND_CORNER)>=1}isRightRoundedCorner(e){return this.isRoundCorner(e)&&(e.type&this.RIGHT_ROUND_CORNER)>=1}isLeftSquareCorner(e){return(e.type&this.LEFT_SQUARE_CORNER)>=1}isRightSquareCorner(e){return(e.type&this.RIGHT_SQUARE_CORNER)>=1}isCorner(e){return(e.type&this.CORNER)>=1}isJaggedEdge(e){return(e.type&this.JAGGED_EDGE)>=1}isRow(e){return(e.type&this.ROW)>=1}isBetweenRowSpacer(e){return(e.type&this.BETWEEN_ROW_SPACER)>=1}isTopRow(e){return(e.type&this.TOP_ROW)>=1}isBottomRow(e){return(e.type&this.BOTTOM_ROW)>=1}isTopOrBottomRow(e){return this.isTopRow(e)||this.isBottomRow(e)}isInputRow(e){return(e.type&this.INPUT_ROW)>=1}},ao=class{constructor(e){this.centerline=this.xPos=this.height=this.width=0,this.constants_=e,this.type=_.NONE,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}},Dr=class{constructor(e){this.elements=[],this.xPos=this.yPos=this.widthWithConnectedBlocks=this.minWidth=this.minHeight=this.width=this.height=0,this.hasStatement=this.hasExternalInput=!1,this.statementEdge=0,this.hasJaggedEdge=this.hasDummyInput=this.hasInlineInput=!1,this.align=null,this.constants_=e,this.type=_.ROW,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}getLastInput(){for(let e=this.elements.length-1;e>=0;e--){const o=this.elements[e];if(_.isInput(o))return o}return null}measure(){throw Error("Unexpected attempt to measure a base Row.")}startsWithElemSpacer(){return!0}endsWithElemSpacer(){return!0}getFirstSpacer(){for(let e=0;e<this.elements.length;e++){const o=this.elements[e];if(_.isInRowSpacer(o))return o}return null}getLastSpacer(){for(let e=this.elements.length-1;e>=0;e--){const o=this.elements[e];if(_.isInRowSpacer(o))return o}return null}},cd=class extends Dr{constructor(e){super(e),this.hasNextConnection=!1,this.connection=null,this.baseline=this.descenderHeight=0,this.type|=_.BOTTOM_ROW}hasLeftSquareCorner(e){return!!e.outputConnection||!!e.getNextBlock()}hasRightSquareCorner(e){return!0}measure(){let e=0,o=0,i=0;for(let s=0;s<this.elements.length;s++){const n=this.elements[s];o+=n.width,_.isSpacer(n)||(_.isNextConnection(n)?i=Math.max(i,n.height):e=Math.max(e,n.height))}this.width=Math.max(this.minWidth,o),this.height=Math.max(this.minHeight,e)+i,this.descenderHeight=i,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return!1}endsWithElemSpacer(){return!1}},Yi=class extends ao{constructor(e,o){super(e),this.connectionModel=o,this.type|=_.CONNECTION,this.shape=this.constants_.shapeFor(o),this.isDynamicShape="isDynamic"in this.shape&&this.shape.isDynamic,this.highlighted=o.isHighlighted()}},Oc=class extends Yi{constructor(e,o){super(e,o.connection),this.input=o,this.connectionOffsetY=this.connectionOffsetX=0,this.type|=_.INPUT,this.align=o.align,(this.connectedBlock=o.connection&&o.connection.targetBlock()?o.connection.targetBlock():null)?(e=this.connectedBlock.getHeightWidth(),this.connectedBlockWidth=e.width,this.connectedBlockHeight=e.height):this.connectedBlockHeight=this.connectedBlockWidth=0}},ad=class extends Oc{constructor(e,o){super(e,o),this.height=0,this.type|=_.EXTERNAL_VALUE_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight-this.constants_.TAB_OFFSET_FROM_TOP-this.constants_.MEDIUM_PADDING:this.shape.height,this.width=this.shape.width+this.constants_.EXTERNAL_VALUE_INPUT_PADDING,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP,this.connectionHeight=this.shape.height,this.connectionWidth=this.shape.width}},ud=class extends ao{constructor(e,o,i){super(e),this.field=o,this.parentInput=i,this.isEditable=o.EDITABLE,this.flipRtl=o.getFlipRtl(),this.type|=_.FIELD,e=this.field.getSize(),this.height=e.height,this.width=e.width}},cg=class extends ao{constructor(e){super(e),this.type|=_.HAT,this.height=this.constants_.START_HAT.height,this.width=this.constants_.START_HAT.width,this.ascenderHeight=this.height}},ag=class extends ao{constructor(e,o){super(e),this.icon=o,this.flipRtl=!1,this.type|=_.ICON,e=o.getSize(),this.height=e.height,this.width=e.width}},Ct=class extends ao{constructor(e,o){super(e),this.type|=_.SPACER|_.IN_ROW_SPACER,this.width=o,this.height=this.constants_.SPACER_DEFAULT_HEIGHT}},dd=class extends Oc{constructor(e,o){super(e,o),this.type|=_.INLINE_INPUT,this.connectedBlock?(this.width=this.connectedBlockWidth,this.height=this.connectedBlockHeight):(this.height=this.constants_.EMPTY_INLINE_INPUT_HEIGHT,this.width=this.constants_.EMPTY_INLINE_INPUT_PADDING),this.connectionHeight=this.isDynamicShape?this.shape.height(this.height):this.shape.height,this.connectionWidth=this.isDynamicShape?this.shape.width(this.height):this.shape.width,this.connectedBlock||(this.width+=this.connectionWidth*(this.isDynamicShape?2:1)),this.connectionOffsetY="connectionOffsetY"in this.shape?this.shape.connectionOffsetY(this.connectionHeight):this.constants_.TAB_OFFSET_FROM_TOP,this.connectionOffsetX="connectionOffsetX"in this.shape?this.shape.connectionOffsetX(this.connectionWidth):0}},hd=class extends Dr{constructor(e){super(e),this.connectedBlockWidths=0,this.type|=_.INPUT_ROW}measure(){this.width=this.minWidth,this.height=this.minHeight;let e=0;for(let o=0;o<this.elements.length;o++){const i=this.elements[o];this.width+=i.width,_.isInput(i)&&(_.isStatementInput(i)?e+=i.connectedBlockWidth:_.isExternalInput(i)&&0!==i.connectedBlockWidth&&(e+=i.connectedBlockWidth-i.connectionWidth)),_.isSpacer(i)||(this.height=Math.max(this.height,i.height))}this.connectedBlockWidths=e,this.widthWithConnectedBlocks=this.width+e}endsWithElemSpacer(){return!this.hasExternalInput&&!this.hasStatement}},ug=class extends ao{constructor(e){super(e),this.type|=_.JAGGED_EDGE,this.height=this.constants_.JAGGED_TEETH.height,this.width=this.constants_.JAGGED_TEETH.width}},dg=class extends Yi{constructor(e,o){super(e,o),this.type|=_.NEXT_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},hg=class extends Yi{constructor(e,o){super(e,o),this.connectionOffsetX=0,this.type|=_.OUTPUT_CONNECTION,this.height=this.isDynamicShape?0:this.shape.height,this.startX=this.width=this.isDynamicShape?0:this.shape.width,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP}},pg=class extends Yi{constructor(e,o){super(e,o),this.type|=_.PREVIOUS_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},Lr=class extends ao{constructor(e,o){super(e),this.type=(o&&"left"!==o?_.RIGHT_ROUND_CORNER:_.LEFT_ROUND_CORNER)|_.CORNER,this.width=this.constants_.CORNER_RADIUS,this.height=this.constants_.CORNER_RADIUS/2}},pd=class extends Dr{constructor(e,o,i){super(e),this.height=o,this.width=i,this.precedesStatement=this.followsStatement=!1,this.widthWithConnectedBlocks=0,this.type|=_.SPACER|_.BETWEEN_ROW_SPACER,this.elements=[new Ct(this.constants_,i)]}measure(){}},Br=class extends ao{constructor(e,o){super(e),this.type=(o&&"left"!==o?_.RIGHT_SQUARE_CORNER:_.LEFT_SQUARE_CORNER)|_.CORNER,this.width=this.height=this.constants_.NO_PADDING}},Rc=class extends Oc{constructor(e,o){super(e,o),this.type|=_.STATEMENT_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight+this.constants_.STATEMENT_BOTTOM_SPACER:this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT,this.width=this.constants_.STATEMENT_INPUT_NOTCH_OFFSET+this.shape.width}},gd=class extends Dr{constructor(e){super(e),this.ascenderHeight=this.capline=0,this.hasPreviousConnection=!1,this.connection=null,this.type|=_.TOP_ROW}hasLeftSquareCorner(e){const o=(e.hat?"cap"===e.hat:this.constants_.ADD_START_HATS)&&!e.outputConnection&&!e.previousConnection,i=e.getPreviousBlock();return!!e.outputConnection||o||!!i&&i.getNextBlock()===e}hasRightSquareCorner(e){return!0}measure(){let e=0,o=0,i=0;for(let s=0;s<this.elements.length;s++){const n=this.elements[s];o+=n.width,_.isSpacer(n)||(_.isHat(n)?i=Math.max(i,n.ascenderHeight):e=Math.max(e,n.height))}this.width=Math.max(this.minWidth,o),this.height=Math.max(this.minHeight,e)+i,this.capline=this.ascenderHeight=i,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return!1}endsWithElemSpacer(){return!1}},Mc=class{constructor(){this.NO_PADDING=0,this.SMALL_PADDING=3,this.MEDIUM_PADDING=5,this.MEDIUM_LARGE_PADDING=8,this.LARGE_PADDING=10,this.TAB_HEIGHT=15,this.TAB_OFFSET_FROM_TOP=5,this.TAB_VERTICAL_OVERLAP=2.5,this.TAB_WIDTH=8,this.NOTCH_WIDTH=15,this.NOTCH_HEIGHT=4,this.MIN_BLOCK_WIDTH=12,this.EMPTY_BLOCK_SPACER_HEIGHT=16,this.CORNER_RADIUS=8,this.NOTCH_OFFSET_LEFT=15,this.STATEMENT_BOTTOM_SPACER=0,this.STATEMENT_INPUT_PADDING_LEFT=20,this.BETWEEN_STATEMENT_PADDING_Y=4,this.ADD_START_HATS=!1,this.START_HAT_HEIGHT=15,this.START_HAT_WIDTH=100,this.SPACER_DEFAULT_HEIGHT=15,this.MIN_BLOCK_HEIGHT=24,this.EMPTY_INLINE_INPUT_PADDING=14.5,this.EXTERNAL_VALUE_INPUT_PADDING=2,this.JAGGED_TEETH_HEIGHT=12,this.JAGGED_TEETH_WIDTH=6,this.FIELD_TEXT_FONTSIZE=11,this.FIELD_TEXT_FONTWEIGHT="normal",this.FIELD_TEXT_FONTFAMILY="sans-serif",this.FIELD_TEXT_BASELINE=this.FIELD_TEXT_HEIGHT=-1,this.FIELD_BORDER_RECT_RADIUS=4,this.FIELD_BORDER_RECT_HEIGHT=16,this.FIELD_BORDER_RECT_X_PADDING=5,this.FIELD_BORDER_RECT_Y_PADDING=3,this.FIELD_BORDER_RECT_COLOUR="#fff",this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!1,this.FIELD_DROPDOWN_SVG_ARROW_SIZE=12,this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=!1,this.FIELD_COLOUR_DEFAULT_WIDTH=26,this.defs=null,this.embossFilterId="",this.embossFilter=null,this.disabledPatternId="",this.disabledPattern=null,this.debugFilterId="",this.cssNode=this.debugFilter=null,this.CURSOR_COLOUR="#cc0a0a",this.MARKER_COLOUR="#4286f4",this.CURSOR_WS_WIDTH=100,this.WS_CURSOR_HEIGHT=5,this.CURSOR_STACK_PADDING=10,this.CURSOR_BLOCK_PADDING=2,this.CURSOR_STROKE_WIDTH=4,this.FULL_BLOCK_FIELDS=!1,this.INSERTION_MARKER_COLOUR="#000000",this.INSERTION_MARKER_OPACITY=.2,this.SHAPES={PUZZLE:1,NOTCH:2},this.TALL_INPUT_FIELD_OFFSET_Y=this.MEDIUM_PADDING,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=this.DUMMY_INPUT_MIN_HEIGHT=this.TAB_HEIGHT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT,this.TOP_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.EMPTY_INLINE_INPUT_HEIGHT=this.TAB_HEIGHT+11,this.EMPTY_STATEMENT_INPUT_HEIGHT=this.MIN_BLOCK_HEIGHT,this.START_POINT=u(0,0),this.FIELD_TEXT_BASELINE_CENTER=!0,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_DROPDOWN_SVG_ARROW_DATAURI="data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMi43MSIgaGVpZ2h0PSI4Ljc5IiB2aWV3Qm94PSIwIDAgMTIuNzEgOC43OSI+PHRpdGxlPmRyb3Bkb3duLWFycm93PC90aXRsZT48ZyBvcGFjaXR5PSIwLjEiPjxwYXRoIGQ9Ik0xMi43MSwyLjQ0QTIuNDEsMi40MSwwLDAsMSwxMiw0LjE2TDguMDgsOC4wOGEyLjQ1LDIuNDUsMCwwLDEtMy40NSwwTDAuNzIsNC4xNkEyLjQyLDIuNDIsMCwwLDEsMCwyLjQ0LDIuNDgsMi40OCwwLDAsMSwuNzEuNzFDMSwwLjQ3LDEuNDMsMCw2LjM2LDBTMTEuNzUsMC40NiwxMiwuNzFBMi40NCwyLjQ0LDAsMCwxLDEyLjcxLDIuNDRaIiBmaWxsPSIjMjMxZjIwIi8+PC9nPjxwYXRoIGQ9Ik02LjM2LDcuNzlhMS40MywxLjQzLDAsMCwxLTEtLjQyTDEuNDIsMy40NWExLjQ0LDEuNDQsMCwwLDEsMC0yYzAuNTYtLjU2LDkuMzEtMC41Niw5Ljg3LDBhMS40NCwxLjQ0LDAsMCwxLDAsMkw3LjM3LDcuMzdBMS40MywxLjQzLDAsMCwxLDYuMzYsNy43OVoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=",this.FIELD_COLOUR_DEFAULT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_CHECKBOX_X_OFFSET=this.FIELD_BORDER_RECT_X_PADDING-3,this.randomIdentifier=String(Math.random()).substring(2)}init(){this.JAGGED_TEETH=this.makeJaggedTeeth(),this.NOTCH=this.makeNotch(),this.START_HAT=this.makeStartHat(),this.PUZZLE_TAB=this.makePuzzleTab(),this.INSIDE_CORNERS=this.makeInsideCorners(),this.OUTSIDE_CORNERS=this.makeOutsideCorners()}setTheme(e){this.blockStyles=Object.create(null);const o=e.blockStyles;for(const i in o)this.blockStyles[i]=this.validatedBlockStyle_(o[i]);this.setDynamicProperties_(e)}setDynamicProperties_(e){this.setFontConstants_(e),this.setComponentConstants_(e),this.ADD_START_HATS=void 0!==e.startHats?e.startHats:this.ADD_START_HATS}setFontConstants_(e){e.fontStyle&&e.fontStyle.family&&(this.FIELD_TEXT_FONTFAMILY=e.fontStyle.family),e.fontStyle&&e.fontStyle.weight&&(this.FIELD_TEXT_FONTWEIGHT=e.fontStyle.weight),e.fontStyle&&e.fontStyle.size&&(this.FIELD_TEXT_FONTSIZE=e.fontStyle.size),e=xn("Hg",this.FIELD_TEXT_FONTSIZE+"pt",this.FIELD_TEXT_FONTWEIGHT,this.FIELD_TEXT_FONTFAMILY),this.FIELD_TEXT_HEIGHT=e.height,this.FIELD_TEXT_BASELINE=e.baseline}setComponentConstants_(e){this.CURSOR_COLOUR=e.getComponentStyle("cursorColour")||this.CURSOR_COLOUR,this.MARKER_COLOUR=e.getComponentStyle("markerColour")||this.MARKER_COLOUR,this.INSERTION_MARKER_COLOUR=e.getComponentStyle("insertionMarkerColour")||this.INSERTION_MARKER_COLOUR,this.INSERTION_MARKER_OPACITY=Number(e.getComponentStyle("insertionMarkerOpacity"))||this.INSERTION_MARKER_OPACITY}getBlockStyleForColour(e){const o="auto_"+e;return this.blockStyles[o]||(this.blockStyles[o]=this.createBlockStyle_(e)),{style:this.blockStyles[o],name:o}}getBlockStyle(e){return this.blockStyles[e||""]||(e&&e.startsWith("auto_")?this.getBlockStyleForColour(e.substring(5)).style:this.createBlockStyle_("#000000"))}createBlockStyle_(e){return this.validatedBlockStyle_({colourPrimary:e})}validatedBlockStyle_(e){const o={};return e&&Object.assign(o,e),e=ks(o.colourPrimary||"#000"),o.colourPrimary=e.hex,o.colourSecondary=o.colourSecondary?ks(o.colourSecondary).hex:this.generateSecondaryColour_(o.colourPrimary),o.colourTertiary=o.colourTertiary?ks(o.colourTertiary).hex:this.generateTertiaryColour_(o.colourPrimary),o.hat=o.hat||"",o}generateSecondaryColour_(e){return ki("#fff",e,.6)||e}generateTertiaryColour_(e){return ki("#fff",e,.3)||e}dispose(){this.embossFilter&&ce(this.embossFilter),this.disabledPattern&&ce(this.disabledPattern),this.debugFilter&&ce(this.debugFilter),this.cssNode=null}makeJaggedTeeth(){const e=this.JAGGED_TEETH_HEIGHT,o=this.JAGGED_TEETH_WIDTH;return{height:e,width:o,path:r([P(o,e/4),P(2*-o,e/2),P(o,e/4)])}}makeStartHat(){const e=this.START_HAT_HEIGHT,o=this.START_HAT_WIDTH;return{height:.75*e,width:o,path:at("c",[P(30,-e),P(70,-e),P(o,0)])}}makePuzzleTab(){function e(l){const h=-(l=l?-1:1);var $=i/2;const k=$+2.5,F=$+.5,we=P(-o,l*$);return $=P(o,l*$),at("c",[P(0,l*k),P(-o,h*F),we])+at("s",[P(o,2.5*h),$])}const o=this.TAB_WIDTH,i=this.TAB_HEIGHT,s=e(!0),n=e(!1);return{type:this.SHAPES.PUZZLE,width:o,height:i,pathDown:n,pathUp:s}}makeNotch(){function e(h){return r([P(h*s,i),P(3*h,0),P(h*s,-i)])}const o=this.NOTCH_WIDTH,i=this.NOTCH_HEIGHT,s=(o-3)/2,n=e(1),l=e(-1);return{type:this.SHAPES.NOTCH,width:o,height:i,pathLeft:n,pathRight:l}}makeInsideCorners(){const e=this.CORNER_RADIUS;return{width:e,height:e,pathTop:a("a","0 0,0",e,P(-e,e)),pathBottom:a("a","0 0,0",e,P(e,e))}}makeOutsideCorners(){const e=this.CORNER_RADIUS,o=u(0,e)+a("a","0 0,1",e,P(e,-e)),i=a("a","0 0,1",e,P(e,e)),s=a("a","0 0,1",e,P(-e,-e));return{topLeft:o,topRight:i,bottomRight:a("a","0 0,1",e,P(-e,e)),bottomLeft:s,rightHeight:e}}shapeFor(e){switch(e.type){case N.INPUT_VALUE:case N.OUTPUT_VALUE:return this.PUZZLE_TAB;case N.PREVIOUS_STATEMENT:case N.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown connection type")}}createDom(e,o,i,s){this.injectCSS_(o,i),this.defs=I(v.DEFS,{},e),e=I(v.FILTER,{id:"blocklyEmbossFilter"+this.randomIdentifier},this.defs),I(v.FEGAUSSIANBLUR,{in:"SourceAlpha",stdDeviation:1,result:"blur"},e),o=I(v.FESPECULARLIGHTING,{in:"blur",surfaceScale:1,specularConstant:.5,specularExponent:10,"lighting-color":"white",result:"specOut"},e),I(v.FEPOINTLIGHT,{x:-5e3,y:-1e4,z:2e4},o),I(v.FECOMPOSITE,{in:"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"},e),I(v.FECOMPOSITE,{in:"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:0,k2:1,k3:1,k4:0},e),this.embossFilterId=e.id,this.embossFilter=e,e=I(v.PATTERN,{id:"blocklyDisabledPattern"+this.randomIdentifier,patternUnits:"userSpaceOnUse",width:10,height:10},this.defs),I(v.RECT,{width:10,height:10,fill:"#aaa"},e),I(v.PATH,{d:"M 0 0 L 10 10 M 10 0 L 0 10",stroke:"#cc0"},e),this.disabledPatternId=e.id,this.disabledPattern=e,this.createDebugFilter(),s&&(s.style.setProperty("--blocklyEmbossFilter",`url(#${this.embossFilterId})`),s.style.setProperty("--blocklyDisabledPattern",`url(#${this.disabledPatternId})`),s.style.setProperty("--blocklyDebugFilter",`url(#${this.debugFilterId})`))}createDebugFilter(){if(!this.debugFilter){const e=I(v.FILTER,{id:"blocklyDebugFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},this.defs),o=I(v.FECOMPONENTTRANSFER,{result:"outBlur"},e);I(v.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},o),I(v.FEFLOOD,{"flood-color":"#ff0000","flood-opacity":.5,result:"outColor"},e),I(v.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},e),this.debugFilterId=e.id,this.debugFilter=e}}injectCSS_(e,o){o=this.getCSS_(o),e="blockly-renderer-style-"+e,this.cssNode=document.getElementById(e);const i=o.join("\n");this.cssNode?this.cssNode.firstChild.textContent=i:((o=document.createElement("style")).id=e,e=document.createTextNode(i),o.appendChild(e),document.head.insertBefore(o,document.head.firstChild),this.cssNode=o)}getCSS_(e){return[`${e} .blocklyText, `,`${e} .blocklyFlyoutLabelText {`,`font: ${this.FIELD_TEXT_FONTWEIGHT} ${this.FIELD_TEXT_FONTSIZE}pt ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${e} .blocklyText {`,"fill: #fff;","}",`${e} .blocklyNonEditableField>rect,`,`${e} .blocklyEditableField>rect {`,`fill: ${this.FIELD_BORDER_RECT_COLOUR};`,"fill-opacity: .6;","stroke: none;","}",`${e} .blocklyNonEditableField>text,`,`${e} .blocklyEditableField>text {`,"fill: #000;","}",`${e} .blocklyFlyoutLabelText {`,"fill: #000;","}",`${e} .blocklyText.blocklyBubbleText {`,"fill: #000;","}",`${e} .blocklyEditableField:not(.blocklyEditing):hover>rect {`,"stroke: #fff;","stroke-width: 2;","}",`${e} .blocklyHtmlInput {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,`font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,"}",`${e} .blocklySelected>.blocklyPath {`,"stroke: #fc3;","stroke-width: 3px;","}",`${e} .blocklyHighlightedConnectionPath {`,"stroke: #fc3;","}",`${e} .blocklyReplaceable .blocklyPath {`,"fill-opacity: .5;","}",`${e} .blocklyReplaceable .blocklyPathLight,`,`${e} .blocklyReplaceable .blocklyPathDark {`,"display: none;","}",`${e} .blocklyInsertionMarker>.blocklyPath {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"]}},md={};md.ConstantProvider=Mc,md.isDynamicShape=Si,md.isNotch=or,md.isPuzzleTab=tr;var Nc=class{constructor(e,o){this.inlinePath_=this.outlinePath_="",this.block_=e,this.info_=o,this.topLeft_=e.getRelativeToSurfaceXY(),this.constants_=o.getRenderer().getConstants()}draw(){this.drawOutline_(),this.drawInternals_(),this.updateConnectionHighlights(),this.block_.pathObject.setPath(this.outlinePath_+"\n"+this.inlinePath_),this.info_.RTL&&this.block_.pathObject.flipRTL(),this.recordSizeOnBlock_()}recordSizeOnBlock_(){this.block_.height=this.info_.height,this.block_.width=this.info_.widthWithChildren,this.block_.childlessWidth=this.info_.width}drawOutline_(){this.drawTop_();for(let e=1;e<this.info_.rows.length-1;e++){const o=this.info_.rows[e];o.hasJaggedEdge?this.drawJaggedEdge_(o):o.hasStatement?this.drawStatementInput_(o):o.hasExternalInput?this.drawValueInput_(o):this.drawRightSideRow_(o)}this.drawBottom_(),this.drawLeft_()}drawTop_(){const e=this.info_.topRow,o=e.elements;this.positionPreviousConnection_(),this.outlinePath_+=u(e.xPos,this.info_.startY);for(let s,i=0;s=o[i];i++)_.isLeftRoundedCorner(s)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topLeft:_.isRightRoundedCorner(s)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topRight:_.isPreviousConnection(s)?this.outlinePath_+=s.shape.pathLeft:_.isHat(s)?this.outlinePath_+=this.constants_.START_HAT.path:_.isSpacer(s)&&(this.outlinePath_+=c("h",s.width));this.outlinePath_+=c("v",e.height)}drawJaggedEdge_(e){this.outlinePath_+=this.constants_.JAGGED_TEETH.path+c("v",e.height-this.constants_.JAGGED_TEETH.height)}drawValueInput_(e){const o=e.getLastInput();this.positionExternalValueConnection_(e);const i=Si(o.shape)?o.shape.pathDown(o.height):o.shape.pathDown;this.outlinePath_+=c("H",o.xPos+o.width)+i+c("v",e.height-o.connectionHeight)}drawStatementInput_(e){var o=e.getLastInput();if(o){var i=o.xPos+o.notchOffset+o.shape.width;o=o.shape.pathRight+c("h",-(o.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop;var s=e.height-2*this.constants_.INSIDE_CORNERS.height;this.outlinePath_+=c("H",i)+o+c("v",s)+this.constants_.INSIDE_CORNERS.pathBottom+c("H",e.xPos+e.width),this.positionStatementInputConnection_(e)}}drawRightSideRow_(e){this.outlinePath_+=c("V",e.yPos+e.height)}drawBottom_(){const e=this.info_.bottomRow,o=e.elements;this.positionNextConnection_();let i=0,s="";for(let l,n=o.length-1;l=o[n];n--)_.isNextConnection(l)?s+=l.shape.pathRight:_.isLeftSquareCorner(l)?s+=c("H",e.xPos):_.isLeftRoundedCorner(l)?s+=this.constants_.OUTSIDE_CORNERS.bottomLeft:_.isRightRoundedCorner(l)?(s+=this.constants_.OUTSIDE_CORNERS.bottomRight,i=this.constants_.OUTSIDE_CORNERS.rightHeight):_.isSpacer(l)&&(s+=c("h",-1*l.width));this.outlinePath_+=c("V",e.baseline-i),this.outlinePath_+=s}drawLeft_(){var e=this.info_.outputConnection;if(this.positionOutputConnection_(),e){const o=e.connectionOffsetY+e.height;e=Si(e.shape)?e.shape.pathUp(e.height):e.shape.pathUp,this.outlinePath_+=c("V",o)+e}this.outlinePath_+="z"}drawInternals_(){for(let o,e=0;o=this.info_.rows[e];e++)for(let s,i=0;s=o.elements[i];i++)_.isInlineInput(s)?this.drawInlineInput_(s):(_.isIcon(s)||_.isField(s))&&this.layoutField_(s)}layoutField_(e){const o=e.centerline-e.height/2;let i=e.xPos;var s="";this.info_.RTL&&(i=-(i+e.width),e.flipRtl&&(i+=e.width,s="scale(-1 1)")),_.isIcon(e)?((s=e.icon).setOffsetInBlock(new A(i,o)),this.info_.isInsertionMarker&&s.hideForInsertionMarker()):((e=e.field.getSvgRoot()).setAttribute("transform","translate("+i+","+o+")"+s),this.info_.isInsertionMarker&&e.setAttribute("display","none"))}drawInlineInput_(e){const o=e.width,i=e.height,s=e.connectionOffsetY,n=e.connectionHeight+s;this.inlinePath_+=He(e.xPos+e.connectionWidth,e.centerline-i/2)+c("v",s)+e.shape.pathDown+c("v",i-n)+c("h",o-e.connectionWidth)+c("v",-i)+"z",this.positionInlineInputConnection_(e)}positionInlineInputConnection_(e){if(e.connectionModel){let i=e.xPos+e.connectionWidth+e.connectionOffsetX;this.info_.RTL&&(i*=-1),e.connectionModel.setOffsetInBlock(i,e.centerline-e.height/2+e.connectionOffsetY)}}positionStatementInputConnection_(e){const o=e.getLastInput();if(null!=o&&o.connectionModel){let i=e.xPos+e.statementEdge+o.notchOffset;this.info_.RTL&&(i*=-1),o.connectionModel.setOffsetInBlock(i,e.yPos)}}positionExternalValueConnection_(e){const o=e.getLastInput();if(o&&o.connectionModel){let i=e.xPos+e.width;this.info_.RTL&&(i*=-1),o.connectionModel.setOffsetInBlock(i,e.yPos)}}positionPreviousConnection_(){const e=this.info_.topRow;if(e.connection){const o=e.xPos+e.notchOffset;e.connection.connectionModel.setOffsetInBlock(this.info_.RTL?-o:o,0)}}positionNextConnection_(){const e=this.info_.bottomRow;if(e.connection){const o=e.connection,i=o.xPos;o.connectionModel.setOffsetInBlock(this.info_.RTL?-i:i,e.baseline)}}positionOutputConnection_(){if(this.info_.outputConnection){const e=this.info_.startX+this.info_.outputConnection.connectionOffsetX;this.block_.outputConnection.setOffsetInBlock(this.info_.RTL?-e:e,this.info_.outputConnection.connectionOffsetY)}}updateConnectionHighlights(){for(const e of this.info_.rows)for(const o of e.elements){if(!(o instanceof Yi))continue;const i=this.drawConnectionHighlightPath(o);i&&(i.style.display=o.highlighted?"":"none")}}drawConnectionHighlightPath(e){const o=e.connectionModel;e=o.type===N.INPUT_VALUE||o.type===N.OUTPUT_VALUE?this.getExpressionConnectionHighlightPath(e):this.getStatementConnectionHighlightPath(e);const i=o.getSourceBlock();let s,n;return null==(n=(s=i.pathObject).addConnectionHighlight)?void 0:n.call(s,o,e,o.getOffsetInBlock(),i.RTL)}getExpressionConnectionHighlightPath(e){let o="";return Si(e.shape)?o=e.shape.pathDown(e.height):tr(e.shape)&&(o=e.shape.pathDown),u(0,-(e=this.constants_.TAB_OFFSET_FROM_TOP))+c("v",e)+o+c("v",e)}getStatementConnectionHighlightPath(e){if(!or(e.shape))throw Error("Statement connections should have notch shapes");const o=this.constants_.NOTCH_OFFSET_LEFT-this.constants_.CORNER_RADIUS;return u(-o,0)+c("h",o)+e.shape.pathLeft+c("h",o)}},Pr=class{constructor(e,o){this.statementEdge=this.width=this.widthWithChildren=this.height=0,this.rows=[],this.inputRows=[],this.startY=this.startX=0,this.renderer_=e,this.block_=o,this.constants_=this.renderer_.getConstants(),this.outputConnection=o.outputConnection?new hg(this.constants_,o.outputConnection):null,this.isInline=o.getInputsInline()&&!o.isCollapsed(),this.isCollapsed=o.isCollapsed(),this.isInsertionMarker=o.isInsertionMarker(),this.RTL=o.RTL,this.topRow=new gd(this.constants_),this.bottomRow=new cd(this.constants_)}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}createRows_(){this.populateTopRow_(),this.rows.push(this.topRow);let e=new hd(this.constants_);this.inputRows.push(e);var o=this.block_.getIcons();for(let s,i=0;s=o[i];i++){const n=new ag(this.constants_,s);this.isCollapsed&&!s.isShownWhenCollapsed()||e.elements.push(n)}o=void 0;for(let s,i=0;s=this.block_.inputList[i];i++)if(s.isVisible()){this.shouldStartNewRow_(s,o)&&(this.rows.push(e),e=new hd(this.constants_),this.inputRows.push(e));for(let l,n=0;l=s.fieldRow[n];n++)e.elements.push(new ud(this.constants_,l,s));this.addInput_(s,e),o=s}this.isCollapsed&&(e.hasJaggedEdge=!0,e.elements.push(new ug(this.constants_))),(e.elements.length||e.hasDummyInput)&&this.rows.push(e),this.populateBottomRow_(),this.rows.push(this.bottomRow)}populateTopRow_(){var e=!!this.block_.previousConnection;const o=(this.block_.hat?"cap"===this.block_.hat:this.constants_.ADD_START_HATS)&&!this.outputConnection&&!e;let i=this.topRow.hasLeftSquareCorner(this.block_)?Br:Lr;this.topRow.elements.push(new i(this.constants_)),o?(e=new cg(this.constants_),this.topRow.elements.push(e)):e&&(this.topRow.hasPreviousConnection=!0,this.topRow.connection=new pg(this.constants_,this.block_.previousConnection),this.topRow.elements.push(this.topRow.connection)),this.topRow.minHeight=this.block_.inputList.length&&this.block_.inputList[0]instanceof xt&&!this.block_.isCollapsed()?this.constants_.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT:this.constants_.TOP_ROW_MIN_HEIGHT,i=this.topRow.hasRightSquareCorner(this.block_)?Br:Lr,this.topRow.elements.push(new i(this.constants_,"right"))}populateBottomRow_(){this.bottomRow.hasNextConnection=!!this.block_.nextConnection,this.bottomRow.minHeight=this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1]instanceof xt?this.constants_.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT:this.constants_.BOTTOM_ROW_MIN_HEIGHT,this.bottomRow.hasLeftSquareCorner(this.block_)?this.bottomRow.elements.push(new Br(this.constants_)):this.bottomRow.elements.push(new Lr(this.constants_)),this.bottomRow.hasNextConnection&&(this.bottomRow.connection=new dg(this.constants_,this.block_.nextConnection),this.bottomRow.elements.push(this.bottomRow.connection)),this.bottomRow.hasRightSquareCorner(this.block_)?this.bottomRow.elements.push(new Br(this.constants_,"right")):this.bottomRow.elements.push(new Lr(this.constants_,"right"))}addInput_(e,o){this.isInline&&e instanceof t.ValueInput$$module$build$src$core$inputs$value_input?(o.elements.push(new dd(this.constants_,e)),o.hasInlineInput=!0):e instanceof xt?(o.elements.push(new Rc(this.constants_,e)),o.hasStatement=!0):e instanceof t.ValueInput$$module$build$src$core$inputs$value_input?(o.elements.push(new ad(this.constants_,e)),o.hasExternalInput=!0):(e instanceof lo||e instanceof Oo)&&(o.minHeight=Math.max(o.minHeight,e.getSourceBlock()&&e.getSourceBlock().isShadow()?this.constants_.DUMMY_INPUT_SHADOW_MIN_HEIGHT:this.constants_.DUMMY_INPUT_MIN_HEIGHT),o.hasDummyInput=!0),null===o.align&&(o.align=e.align)}shouldStartNewRow_(e,o){return!!o&&(o instanceof Oo||e instanceof xt||o instanceof xt||(e instanceof t.ValueInput$$module$build$src$core$inputs$value_input||e instanceof lo||o instanceof t.ValueInput$$module$build$src$core$inputs$value_input)&&!this.isInline)}addElemSpacing_(){for(let o,e=0;o=this.rows[e];e++){const i=o.elements;if(o.elements=[],o.startsWithElemSpacer()&&o.elements.push(new Ct(this.constants_,this.getInRowSpacing_(null,i[0]))),i.length){for(let s=0;s<i.length-1;s++){o.elements.push(i[s]);const n=this.getInRowSpacing_(i[s],i[s+1]);o.elements.push(new Ct(this.constants_,n))}o.elements.push(i[i.length-1]),o.endsWithElemSpacer()&&o.elements.push(new Ct(this.constants_,this.getInRowSpacing_(i[i.length-1],null)))}}}getInRowSpacing_(e,o){if(!e&&o&&_.isStatementInput(o))return this.constants_.STATEMENT_INPUT_PADDING_LEFT;if(e&&_.isInput(e)&&!o){if(_.isExternalInput(e))return this.constants_.NO_PADDING;if(_.isInlineInput(e))return this.constants_.LARGE_PADDING;if(_.isStatementInput(e))return this.constants_.NO_PADDING}return e&&_.isLeftSquareCorner(e)&&o&&(_.isPreviousConnection(o)||_.isNextConnection(o))?o.notchOffset:e&&_.isLeftRoundedCorner(e)&&o&&(_.isPreviousConnection(o)||_.isNextConnection(o))?o.notchOffset-this.constants_.CORNER_RADIUS:e&&_.isField(e)&&0===e.width?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING}computeBounds_(){let e=0,o=0,i=0;for(let l,n=0;l=this.rows[n];n++){if(l.measure(),o=Math.max(o,l.width),l.hasStatement){var s=l.getLastInput();let h,$;s=l.width-(null!=($=null==(h=s)?void 0:h.width)?$:0),e=Math.max(e,s)}i=Math.max(i,l.widthWithConnectedBlocks)}this.statementEdge=e,this.width=o;for(let l,n=0;l=this.rows[n];n++)l.hasStatement&&(l.statementEdge=this.statementEdge);this.widthWithChildren=Math.max(o,i),this.outputConnection&&(this.startX=this.outputConnection.width,this.width+=this.outputConnection.width,this.widthWithChildren+=this.outputConnection.width)}alignRowElements_(){for(let i,o=0;i=this.rows[o];o++)if(i.hasStatement)this.alignStatementRow_(i);else{var e=i.width;(e=this.getDesiredRowWidth_(i)-e)>0&&this.addAlignmentPadding_(i,e),_.isTopOrBottomRow(i)&&(i.widthWithConnectedBlocks=i.width)}}getDesiredRowWidth_(e){return this.width-this.startX}addAlignmentPadding_(e,o){const i=e.getFirstSpacer(),s=e.getLastSpacer();if((e.hasExternalInput||e.hasStatement)&&(e.widthWithConnectedBlocks+=o),e.align===t.Align$$module$build$src$core$inputs$align.LEFT&&s)s.width+=o;else if(e.align===t.Align$$module$build$src$core$inputs$align.CENTRE&&i&&s)i.width+=o/2,s.width+=o/2;else if(e.align===t.Align$$module$build$src$core$inputs$align.RIGHT&&i)i.width+=o;else{if(!s)return;s.width+=o}e.width+=o}alignStatementRow_(e){const o=e.getLastInput();if(o){var i=e.width-o.width,s=this.statementEdge;(i=s-i)>0&&this.addAlignmentPadding_(e,i),i=e.width,s=this.getDesiredRowWidth_(e),o.width+=s-i,o.height=Math.max(o.height,e.height),e.width+=s-i,e.widthWithConnectedBlocks=Math.max(e.width,this.statementEdge+e.connectedBlockWidths)}}addRowSpacing_(){const e=this.rows;this.rows=[];for(let o=0;o<e.length;o++)this.rows.push(e[o]),o!==e.length-1&&this.rows.push(this.makeSpacerRow_(e[o],e[o+1]))}makeSpacerRow_(e,o){var i=this.getSpacerRowHeight_(e,o);const s=this.getSpacerRowWidth_(e,o);return i=new pd(this.constants_,i,s),e.hasStatement&&(i.followsStatement=!0),o.hasStatement&&(i.precedesStatement=!0),i}getSpacerRowWidth_(e,o){return this.width-this.startX}getSpacerRowHeight_(e,o){return this.constants_.MEDIUM_PADDING}getElemCenterline_(e,o){return _.isSpacer(o)?e.yPos+o.height/2:_.isBottomRow(e)?(e=e.yPos+e.height-e.descenderHeight,_.isNextConnection(o)?e+o.height/2:e-o.height/2):_.isTopRow(e)?_.isHat(o)?e.capline-o.height/2:e.capline+o.height/2:e.yPos+e.height/2}recordElemPositions_(e){let o=e.xPos;for(let s,i=0;s=e.elements[i];i++)_.isSpacer(s)&&(s.height=e.height),s.xPos=o,s.centerline=this.getElemCenterline_(e,s),o+=s.width}finalize_(){let e=0,o=0;for(let s,i=0;s=this.rows[i];i++)s.yPos=o,s.xPos=this.startX,o+=s.height,e=Math.max(e,s.widthWithConnectedBlocks),this.recordElemPositions_(s);if(this.outputConnection&&this.block_.nextConnection){const i=this.block_.nextConnection.targetBlock();i&&(e=Math.max(e,i.getHeightWidth().width))}this.widthWithChildren=e+this.startX,this.height=o,this.startY=this.topRow.capline,this.bottomRow.baseline=o-this.bottomRow.descenderHeight}getMeasureableForConnection(e){let o;if((null==(o=this.outputConnection)?void 0:o.connectionModel)===e)return this.outputConnection;for(const i of this.rows)for(const s of i.elements)if(s instanceof Yi&&s.connectionModel===e)return s;return null}},Dc=class{constructor(e,o,i){this.connectionHighlights=new WeakMap,this.highlightOffsets=new WeakMap,this.constants=i,this.style=o,this.svgRoot=e,this.svgPath=I(v.PATH,{class:"blocklyPath"},this.svgRoot),this.setClass_("blocklyBlock",!0)}setPath(e){this.svgPath.setAttribute("d",e)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)")}applyColour(e){this.svgPath.setAttribute("stroke",this.style.colourTertiary),this.svgPath.setAttribute("fill",this.style.colourPrimary),this.updateShadow_(e.isShadow()),this.updateDisabled_(!e.isEnabled()||e.getInheritedDisabled())}setStyle(e){this.style=e}setClass_(e,o){e&&(o?R(this.svgRoot,e):te(this.svgRoot,e))}updateHighlighted(e){this.setClass_("blocklyHighlighted",!!e)}updateShadow_(e){e?(this.setClass_("blocklyShadow",!0),this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary)):this.setClass_("blocklyShadow",!1)}updateDisabled_(e){this.setClass_("blocklyDisabled",e),this.setClass_("blocklyDisabledPattern",e)}updateSelected(e){this.setClass_("blocklySelected",e)}updateDraggingDelete(e){this.setClass_("blocklyDraggingDelete",e)}updateInsertionMarker(e){this.setClass_("blocklyInsertionMarker",e)}updateMovable(e){this.setClass_("blocklyDraggable",e)}updateReplacementFade(e){this.setClass_("blocklyReplaceable",e)}updateShapeForInputHighlight(e,o){}addConnectionHighlight(e,o,i,s){return i=`translate(${i.x}, ${i.y})`+(s?" scale(-1 1)":""),(s=this.connectionHighlights.get(e))?(s.setAttribute("d",o),s.setAttribute("transform",i),s):(o=I(v.PATH,{id:e.id,class:"blocklyHighlightedConnectionPath",style:"display: none;",d:o,transform:i},this.svgRoot),this.connectionHighlights.set(e,o),o)}removeConnectionHighlight(e){const o=this.connectionHighlights.get(e);o&&(ce(o),this.connectionHighlights.delete(e))}},Lc=class{constructor(e){this.overrides=null,this.name=e}getClassName(){return this.name+"-renderer"}init(e,o){this.constants_=this.makeConstants_(),o&&(this.overrides=o,Object.assign(this.constants_,o)),this.constants_.setTheme(e),this.constants_.init()}createDom(e,o,i){this.constants_.createDom(e,this.name+"-"+o.name,"."+this.getClassName()+"."+o.getClassName(),i)}refreshDom(e,o,i){const s=this.getConstants();s.dispose(),this.constants_=this.makeConstants_(),this.overrides&&Object.assign(this.constants_,this.overrides),this.constants_.randomIdentifier=s.randomIdentifier,this.constants_.setTheme(o),this.constants_.init(),this.createDom(e,o,i)}dispose(){this.constants_&&this.constants_.dispose()}makeConstants_(){return new Mc}makeRenderInfo_(e){return new Pr(this,e)}makeDrawer_(e,o){return new Nc(e,o)}makePathObject(e,o){return new Dc(e,o,this.constants_)}getConstants(){return this.constants_}shouldHighlightConnection(e){return!0}orphanCanConnectAtEnd(e,o,i){return!!se.getConnectionForOrphanedConnection(e,i===N.OUTPUT_VALUE?o.outputConnection:o.previousConnection)}render(e){const o=this.makeRenderInfo_(e);o.measure(),this.makeDrawer_(e,o).draw()}},ge={};ge.BottomRow=cd,ge.Connection=Yi,ge.ConstantProvider=Mc,ge.Drawer=Nc,ge.ExternalValueInput=ad,ge.Field=ud,ge.Hat=cg,ge.Icon=ag,ge.InRowSpacer=Ct,ge.InlineInput=dd,ge.InputConnection=Oc,ge.InputRow=hd,ge.JaggedEdge=ug,ge.Measurable=ao,ge.NextConnection=dg,ge.OutputConnection=hg,ge.PathObject=Dc,ge.PreviousConnection=pg,ge.RenderInfo=Pr,ge.Renderer=Lc,ge.RoundCorner=Lr,ge.Row=Dr,ge.SpacerRow=pd,ge.SquareCorner=Br,ge.StatementInput=Rc,ge.TopRow=gd,ge.Types=_,ge.init=ir,ge.register=ko,ge.unregister=Bl;var gg=class{constructor(e,o){this.workspace=e,this.theme=o,this.subscribedWorkspaces=[],this.componentDB=new Map}getTheme(){return this.theme}setTheme(e){var o=this.theme;this.theme=e,(e=this.workspace.getInjectionDiv())&&(o&&(o=o.getClassName())&&te(e,o),(o=this.theme.getClassName())&&R(e,o));for(let s,i=0;s=this.subscribedWorkspaces[i];i++)s.refreshTheme();for(const[i,s]of this.componentDB)for(const n of s){e=n.element,o=n.propertyName;const l=this.theme&&this.theme.getComponentStyle(i);e.style.setProperty(o,l||"")}for(const i of this.subscribedWorkspaces)i.hideChaff()}subscribeWorkspace(e){this.subscribedWorkspaces.push(e)}unsubscribeWorkspace(e){if(!ft(this.subscribedWorkspaces,e))throw Error("Cannot unsubscribe a workspace that hasn't been subscribed.")}subscribe(e,o,i){this.componentDB.has(o)||this.componentDB.set(o,[]),this.componentDB.get(o).push({element:e,propertyName:i}),o=this.theme&&this.theme.getComponentStyle(o),e.style.setProperty(i,o||"")}unsubscribe(e){if(e)for(const[o,i]of this.componentDB){for(let s=i.length-1;s>=0;s--)i[s].element===e&&i.splice(s,1);i.length||this.componentDB.delete(o)}}dispose(){this.subscribedWorkspaces.length=0,this.componentDB.clear()}},$d="VARIABLE_DYNAMIC",Xi={CATEGORY_NAME:$d};Xi.flyoutCategory=Bs,Xi.flyoutCategoryBlocks=sr,Xi.internalFlyoutCategory=Ls,Xi.onCreateVariableButtonClick_Colour=Ri,Xi.onCreateVariableButtonClick_Number=Oi,Xi.onCreateVariableButtonClick_String=Io;var mg=class{canConnect(e,o,i,s){return this.canConnectWithReason(e,o,i,s)===se.CAN_CONNECT}canConnectWithReason(e,o,i,s){const n=this.doSafetyChecks(e,o);return n!==se.CAN_CONNECT?n:this.doTypeChecks(e,o)?i&&!this.doDragChecks(e,o,s||0)?se.REASON_DRAG_CHECKS_FAILED:se.CAN_CONNECT:se.REASON_CHECKS_FAILED}getErrorMessage(e,o,i){switch(e){case se.REASON_SELF_CONNECTION:return"Attempted to connect a block to itself.";case se.REASON_DIFFERENT_WORKSPACES:return"Blocks not on same workspace.";case se.REASON_WRONG_TYPE:return"Attempt to connect incompatible types.";case se.REASON_TARGET_NULL:return"Target connection is null.";case se.REASON_CHECKS_FAILED:return"Connection checks failed. "+o+" expected "+o.getCheck()+", found "+i.getCheck();case se.REASON_SHADOW_PARENT:return"Connecting non-shadow to shadow block.";case se.REASON_DRAG_CHECKS_FAILED:return"Drag checks failed.";case se.REASON_PREVIOUS_AND_OUTPUT:return"Block would have an output and a previous connection.";default:return"Unknown connection failure: this should never happen!"}}doSafetyChecks(e,o){if(!e||!o)return se.REASON_TARGET_NULL;let i,s,n;return e.isSuperior()?(i=e.getSourceBlock(),s=o.getSourceBlock(),n=o):(s=e.getSourceBlock(),i=o.getSourceBlock(),n=e,e=o),i===s?se.REASON_SELF_CONNECTION:n.type!==ni[e.type]?se.REASON_WRONG_TYPE:i.workspace!==s.workspace?se.REASON_DIFFERENT_WORKSPACES:i.isShadow()&&!s.isShadow()?se.REASON_SHADOW_PARENT:n.type===N.OUTPUT_VALUE&&s.previousConnection&&s.previousConnection.isConnected()||n.type===N.PREVIOUS_STATEMENT&&s.outputConnection&&s.outputConnection.isConnected()?se.REASON_PREVIOUS_AND_OUTPUT:se.CAN_CONNECT}doTypeChecks(e,o){if(e=e.getCheck(),o=o.getCheck(),!e||!o)return!0;for(let i=0;i<e.length;i++)if(o.includes(e[i]))return!0;return!1}doDragChecks(e,o,i){if(e.distanceFrom(o)>i||o.getSourceBlock().isInsertionMarker())return!1;switch(o.type){case N.PREVIOUS_STATEMENT:return this.canConnectToPrevious_(e,o);case N.OUTPUT_VALUE:if(o.isConnected()&&!o.targetBlock().isInsertionMarker()||e.isConnected())return!1;break;case N.INPUT_VALUE:if(o.isConnected()&&!o.targetBlock().isMovable()&&!o.targetBlock().isShadow())return!1;break;case N.NEXT_STATEMENT:if(o.isConnected()&&!e.getSourceBlock().nextConnection&&!o.targetBlock().isShadow()&&o.targetBlock().nextConnection||o.targetBlock()&&!o.targetBlock().isMovable()&&!o.targetBlock().isShadow())return!1;break;default:return!1}return!oc.includes(o)}canConnectToPrevious_(e,o){return!(e.targetConnection||oc.includes(o)||o.targetConnection&&(!(e=o.targetBlock()).isInsertionMarker()||e.getPreviousBlock()))}};D(w.CONNECTION_CHECKER,vt,mg);var cn=class{get isFlyout(){return this.internalIsFlyout}get isMutator(){return this.internalIsMutator}constructor(e){this.isClearing=this.internalIsMutator=this.internalIsFlyout=this.rendered=!1,this.MAX_UNDO=1024,this.connectionDBList=[],this.topBlocks=[],this.topComments=[],this.commentDB=new Map,this.listeners=[],this.undoStack_=[],this.redoStack_=[],this.blockDB=new Map,this.typedBlocksDB=new Map,this.procedureMap=new lg,this.readOnly=!1,this.potentialVariableMap=null,this.id=Ne(),Gr(this),this.options=e||new no({}),this.RTL=!!this.options.RTL,this.horizontalLayout=!!this.options.horizontalLayout,this.toolboxPosition=this.options.toolboxPosition,this.connectionChecker=new(Ve(w.CONNECTION_CHECKER,this.options,!0))(this),this.variableMap=new(this.getVariableMapClass())(this),this.setIsReadOnly(this.options.readOnly)}dispose(){this.listeners.length=0,this.clear(),Vr(this)}sortObjects(e,o){const i=s=>({getBoundingRectangle:()=>{const n=s.getRelativeToSurfaceXY();return new Q(n.y,n.y,n.x,n.x)},moveBy:()=>{}});return this.sortByOrigin(i(e),i(o))}sortByOrigin(e,o){const i=Math.sin(dl(cn.SCAN_ANGLE))*(this.RTL?-1:1);return e=e.getBoundingRectangle().getOrigin(),o=o.getBoundingRectangle().getOrigin(),e.y+i*e.x-(o.y+i*o.x)}addTopBlock(e){this.topBlocks.push(e)}removeTopBlock(e){if(!ft(this.topBlocks,e))throw Error("Block not present in workspace's list of top-most blocks.")}getTopBlocks(e=!1){const o=[].concat(this.topBlocks);return e&&o.length>1&&o.sort(this.sortObjects.bind(this)),o}addTypedBlock(e){this.typedBlocksDB.has(e.type)||this.typedBlocksDB.set(e.type,[]),this.typedBlocksDB.get(e.type).push(e)}removeTypedBlock(e){ft(this.typedBlocksDB.get(e.type),e),this.typedBlocksDB.get(e.type).length||this.typedBlocksDB.delete(e.type)}getBlocksByType(e,o=!1){return this.typedBlocksDB.has(e)?(e=this.typedBlocksDB.get(e).slice(0),o&&e&&e.length>1&&e.sort(this.sortObjects.bind(this)),e.filter(i=>!i.isInsertionMarker())):[]}addTopComment(e){this.topComments.push(e),this.commentDB.has(e.id)&&console.warn('Overriding an existing comment on this workspace, with id "'+e.id+'"'),this.commentDB.set(e.id,e)}removeTopComment(e){if(!ft(this.topComments,e))throw Error("Comment not present in workspace's list of top-most comments.");this.commentDB.delete(e.id)}getTopComments(e=!1){const o=[].concat(this.topComments);return e&&o.length>1&&o.sort(this.sortObjects.bind(this)),o}getAllBlocks(e=!1){if(e){var o=this.getTopBlocks(!0);e=[];for(let i=0;i<o.length;i++)e.push(...o[i].getDescendants(!0))}else for(e=this.getTopBlocks(!1),o=0;o<e.length;o++)e.push(...e[o].getChildren(!1));return e.filter(i=>!i.isInsertionMarker())}clear(){this.isClearing=!0;try{const e=t.getGroup$$module$build$src$core$events$utils();for(e||t.setGroup$$module$build$src$core$events$utils(!0);this.topBlocks.length;)this.topBlocks[0].dispose(!1);for(;this.topComments.length;)this.topComments[this.topComments.length-1].dispose();t.setGroup$$module$build$src$core$events$utils(e),this.isFlyout||this.variableMap.clear(),this.potentialVariableMap&&this.potentialVariableMap.clear()}finally{this.isClearing=!1}}renameVariableById(e,o){ze("Blockly.Workspace.renameVariableById","v12","v13","Blockly.Workspace.getVariableMap().renameVariable"),(e=this.variableMap.getVariableById(e))&&this.variableMap.renameVariable(e,o)}createVariable(e,o,i){return ze("Blockly.Workspace.createVariable","v12","v13","Blockly.Workspace.getVariableMap().createVariable"),this.variableMap.createVariable(e,o??void 0,i??void 0)}getVariableUsesById(e){return ze("Blockly.Workspace.getVariableUsesById","v12","v13","Blockly.Workspace.getVariableMap().getVariableUsesById"),Es(this,e)}deleteVariableById(e){ze("Blockly.Workspace.deleteVariableById","v12","v13","Blockly.Workspace.getVariableMap().deleteVariable");const o=this.variableMap.getVariableById(e);o?t.deleteVariable$$module$build$src$core$variables(this,o):console.warn(`Can't delete non-existent variable: ${e}`)}getVariable(e,o){return ze("Blockly.Workspace.getVariable","v12","v13","Blockly.Workspace.getVariableMap().getVariable"),this.variableMap.getVariable(e,o)}getVariableById(e){return ze("Blockly.Workspace.getVariableById","v12","v13","Blockly.Workspace.getVariableMap().getVariableById"),this.variableMap.getVariableById(e)}getVariablesOfType(e){return ze("Blockly.Workspace.getVariablesOfType","v12","v13","Blockly.Workspace.getVariableMap().getVariablesOfType"),this.variableMap.getVariablesOfType(e??"")}getAllVariables(){return ze("Blockly.Workspace.getAllVariables","v12","v13","Blockly.Workspace.getVariableMap().getAllVariables"),this.variableMap.getAllVariables()}getAllVariableNames(){return ze("Blockly.Workspace.getAllVariableNames","v12","v13","Blockly.Workspace.getVariableMap().getAllVariables"),this.variableMap.getAllVariables().map(e=>e.getName())}getWidth(){return 0}newBlock(e,o){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}newComment(e){throw Error("The implementation of newComment should be monkey-patched in by blockly.ts")}remainingCapacity(){return isNaN(this.options.maxBlocks)?1/0:this.options.maxBlocks-this.getAllBlocks(!1).length}remainingCapacityOfType(e){return this.options.maxInstances?(void 0!==this.options.maxInstances[e]?this.options.maxInstances[e]:1/0)-this.getBlocksByType(e,!1).length:1/0}isCapacityAvailable(e){if(!this.hasBlockLimits())return!0;let o=0;for(const i in e){if(e[i]>this.remainingCapacityOfType(i))return!1;o+=e[i]}return!(o>this.remainingCapacity())}hasBlockLimits(){return this.options.maxBlocks!==1/0||!!this.options.maxInstances}getUndoStack(){return this.undoStack_}getRedoStack(){return this.redoStack_}undo(e){var o=e?this.redoStack_:this.undoStack_,i=e?this.undoStack_:this.redoStack_;const s=o.pop();if(s){for(var n=[s];o.length&&s.group&&s.group===o[o.length-1].group;){const l=o.pop();l&&n.push(l)}for(o=0;o<n.length;o++)i.push(n[o]);t.setRecordUndo$$module$build$src$core$events$utils(!1);try{for(i=0;i<n.length;i++)n[i].run(e)}finally{t.setRecordUndo$$module$build$src$core$events$utils(!0)}}}clearUndo(){this.undoStack_.length=0,this.redoStack_.length=0,$i()}addChangeListener(e){return this.listeners.push(e),e}removeChangeListener(e){ft(this.listeners,e)}fireChangeListener(e){if(e.recordUndo)for(this.undoStack_.push(e),this.redoStack_.length=0;this.undoStack_.length>this.MAX_UNDO&&this.MAX_UNDO>=0;)this.undoStack_.shift();for(let o=0;o<this.listeners.length;o++)(0,this.listeners[o])(e)}getBlockById(e){return this.blockDB.get(e)||null}setBlockById(e,o){this.blockDB.set(e,o)}removeBlockById(e){this.blockDB.delete(e)}getCommentById(e){let o;return null!=(o=this.commentDB.get(e))?o:null}allInputsFilled(e){const o=this.getTopBlocks(!1);for(let i=0;i<o.length;i++)if(!o[i].allInputsFilled(e))return!1;return!0}getPotentialVariableMap(){return this.potentialVariableMap}createPotentialVariableMap(){this.potentialVariableMap=new(this.getVariableMapClass())(this,!0)}getVariableMap(){return this.variableMap}setVariableMap(e){this.variableMap=e}getProcedureMap(){return this.procedureMap}getRootWorkspace(){let e=null;const o=this.options.parentWorkspace;return this.isFlyout?o&&o.options&&(e=o.options.parentWorkspace):o&&(e=o),e}static getById(e){return bo(e)}static getAll(){return fi()}getVariableMapClass(){const e=Ve(w.VARIABLE_MAP,this.options,!0);if(!e)throw Error("No variable map is registered.");return e}isReadOnly(){return this.readOnly}setIsReadOnly(e){this.readOnly=e,this.options.readOnly=e}};cn.SCAN_ANGLE=3;var $g=class{constructor(e){this.parentWorkspace=e,this.sounds=new Map,this.lastSound=null,this.muted=!1}dispose(){this.sounds.clear()}load(e,o){if(e.length){try{var i=new globalThis.Audio}catch{return}for(let n=0;n<e.length;n++){const l=e[n],h=l.match(/\.(\w+)$/);if(h&&i.canPlayType("audio/"+h[1])){var s=new globalThis.Audio(l);break}}s&&this.sounds.set(o,s)}}preload(){for(const e of this.sounds.values()){e.volume=.01;const o=e.play();if(void 0!==o?o.then(e.pause).catch(function(){}):e.pause(),Tu||mm)break}}play(e,o){if(!this.muted){var i=this.sounds.get(e);i?(e=new Date,null!==this.lastSound&&e.getTime()-this.lastSound.getTime()<100||(this.lastSound=e,(i=Tu||Qh?i:i.cloneNode()).volume=void 0===o?1:o,i.play())):this.parentWorkspace&&this.parentWorkspace.getAudioManager().play(e,o)}}setMuted(e){this.muted=e}getMuted(){return this.muted}},nt=class extends cn{constructor(e){let o;super(e),this.resizeHandlerWrapper=null,this.resizesEnabled=this.visible=this.rendered=!0,this.startScrollY=this.startScrollX=this.scrollY=this.scrollX=0,this.oldScale=this.scale=1,this.oldLeft=this.oldTop=0,this.inverseScreenCTM=this.targetWorkspace=this.dummyWheelListener=this.configureContextMenu=this.lastRecordedPageScroll=this.injectionDiv=this.currentGesture_=this.toolbox=this.flyout=this.scrollbar=this.trashcan=null,this.inverseScreenCTMDirty=!0,this.highlightedBlocks=[],this.toolboxCategoryCallbacks=new Map,this.flyoutButtonCallbacks=new Map,this.cachedParentSvg=null,this.keyboardMoveInProgress=this.keyboardAccessibilityMode=!1,this.topBoundedElements=[],this.dragTargetAreas=[],this.zoomControls_=this.layerManager=null,this.navigator=new od,this.metricsManager=new(Ve(w.METRICS_MANAGER,e,!0))(this),this.getMetrics=e.getMetrics||this.metricsManager.getMetrics.bind(this.metricsManager),this.setMetrics=e.setMetrics||nt.setTopLevelWorkspaceMetrics,this.componentManager=new xe,this.connectionDBList=on.init(this.connectionChecker),this.audioManager=new $g(e.parentWorkspace),this.grid=this.options.gridPattern?new sd(this.options.gridPattern,e.gridOptions):null,this.markerManager=new rd(this),Le&&rl&&this.registerToolboxCategoryCallback(Au,rl),Xi&&Ls&&this.registerToolboxCategoryCallback($d,Ls),gt&&Ds&&(this.registerToolboxCategoryCallback(Sc,Ds),this.addChangeListener(er)),this.addChangeListener(this.variableChangeCallback.bind(this)),this.themeManager_=this.options.parentWorkspace?this.options.parentWorkspace.getThemeManager():new gg(this,this.options.theme||Tc),this.themeManager_.subscribeWorkspace(this),this.renderer=ir(this.options.renderer||"geras",this.getTheme(),null!=(o=this.options.rendererOverrides)?o:void 0),this.cachedParentSvgSize=new ee(0,0)}getMarkerManager(){return this.markerManager}getMetricsManager(){return this.metricsManager}setMetricsManager(e){this.metricsManager=e,this.getMetrics=this.metricsManager.getMetrics.bind(this.metricsManager)}getComponentManager(){return this.componentManager}getMarker(e){return this.markerManager.getMarker(e)}getCursor(){return this.markerManager.getCursor()}getRenderer(){return this.renderer}getThemeManager(){return this.themeManager_}getTheme(){return this.themeManager_.getTheme()}setTheme(e){e||(e=Tc),this.themeManager_.setTheme(e)}refreshTheme(){if(this.svgGroup_){var e=null===this.options.parentWorkspace;this.renderer.refreshDom(this.svgGroup_,this.getTheme(),e?this.getInjectionDiv():void 0)}this.updateBlockStyles(this.getAllBlocks(!1).filter(o=>!!o.getStyleName())),this.refreshToolboxSelection(),this.toolbox&&this.toolbox.refreshTheme(),this.isVisible()&&this.setVisible(!0),e=new(B(E.THEME_CHANGE))(this.getTheme().name,this.id),L(e)}updateBlockStyles(e){for(let i,o=0;i=e[o];o++){const s=i.getStyleName();s&&i.setStyle(s)}}getInverseScreenCTM(){if(this.inverseScreenCTMDirty){const e=this.getParentSvg().getScreenCTM();e&&(this.inverseScreenCTM=e.inverse(),this.inverseScreenCTMDirty=!1)}return this.inverseScreenCTM}updateInverseScreenCTM(){this.inverseScreenCTMDirty=!0}isVisible(){return this.visible}getSvgXY(e){let o=0,i=0,s=1;(this.getCanvas().contains(e)||this.getBubbleCanvas().contains(e))&&(s=this.scale);do{const n=ms(e);(e===this.getCanvas()||e===this.getBubbleCanvas())&&(s=1),o+=n.x*s,i+=n.y*s,e=e.parentNode}while(e&&e!==this.getParentSvg()&&e!==this.getInjectionDiv());return new A(o,i)}getCachedParentSvgSize(){const e=this.cachedParentSvgSize;return new ee(e.width,e.height)}getOriginOffsetInPixels(){return In(this.getCanvas())}getInjectionDiv(){if(!this.injectionDiv){let e=this.svgGroup_;for(;e;){if((" "+(e.getAttribute("class")||"")+" ").includes(" injectionDiv ")){this.injectionDiv=e;break}e=e.parentNode}}return this.injectionDiv}getSvgGroup(){return this.svgGroup_}getBlockCanvas(){return this.getCanvas()}setResizeHandlerWrapper(e){this.resizeHandlerWrapper=e}createDom(e,o){return this.injectionDiv||(this.injectionDiv=o??null),this.svgGroup_=I(v.G,{class:"blocklyWorkspace",id:this.id}),o&&De(this.svgGroup_,Fe.LABEL,t.Msg$$module$build$src$core$msg.WORKSPACE_ARIA_LABEL),e&&(this.svgBackground_=I(v.RECT,{height:"100%",width:"100%",class:e},this.svgGroup_),"blocklyMainBackground"===e&&this.grid?this.svgBackground_.style.fill="var(--blocklyGridPattern)":this.themeManager_.subscribe(this.svgBackground_,"workspaceBackgroundColour","fill")),this.layerManager=new class{constructor(e){this.workspace=e,this.layers=new Map,(e=e.getInjectionDiv())&&(this.dragLayer=this.createDragLayer(e),this.animationLayer=this.createAnimationLayer(e)),e=this.createLayer(50),R(e,"blocklyBlockCanvas"),e=this.createLayer(100),R(e,"blocklyBubbleCanvas")}createDragLayer(e){const o=I(v.SVG,{class:"blocklyBlockDragSurface",xmlns:Ql,"xmlns:html":Ao,"xmlns:xlink":It,version:"1.1"});return e.append(o),I(v.G,{},o)}createAnimationLayer(e){const o=I(v.SVG,{class:"blocklyAnimationLayer",xmlns:Ql,"xmlns:html":Ao,"xmlns:xlink":It,version:"1.1"});return e.append(o),I(v.G,{},o)}appendToAnimationLayer(e){let o;const i=null==(o=this.dragLayer)?void 0:o.getAttribute("transform");if(i){let n;null==(n=this.animationLayer)||n.setAttribute("transform",i)}let s;null==(s=this.animationLayer)||s.appendChild(e.getSvgRoot())}translateLayers(e,o){let i;e=`translate(${e.x}, ${e.y}) scale(${o})`,null==(i=this.dragLayer)||i.setAttribute("transform",e);for(const[,s]of this.layers)s.setAttribute("transform",e)}moveToDragLayer(e){let o;null==(o=this.dragLayer)||o.appendChild(e.getSvgRoot()),e.canBeFocused()&&t.getFocusManager$$module$build$src$core$focus_manager().focusNode(e)}moveOffDragLayer(e,o){this.append(e,o),e.canBeFocused()&&t.getFocusManager$$module$build$src$core$focus_manager().focusNode(e)}append(e,o){let i;if(this.layers.has(o)||this.createLayer(o),e=e.getSvgRoot(),(null==(i=this.layers.get(o))?void 0:i.lastChild)!==e){let s;null==(s=this.layers.get(o))||s.appendChild(e)}}createLayer(e){const o=this.workspace.getSvgGroup(),i=I(v.G,{});let s=!1;const n=[...this.layers].sort((l,h)=>l[0]-h[0]);for(const[l,h]of n)if(e<l){o.insertBefore(i,h),s=!0;break}return s||o.appendChild(i),this.layers.set(e,i),i}hasLayer(e){return e===this.dragLayer||new Set(this.layers.values()).has(e)}getBlockLayer(){return this.layers.get(50)}getBubbleLayer(){return this.layers.get(100)}}(this),this.svgBlockCanvas_=this.layerManager.getBlockLayer(),this.svgBubbleCanvas_=this.layerManager.getBubbleLayer(),this.isFlyout||(U(this.svgGroup_,"pointerdown",this,this.onMouseDown,!1),this.dummyWheelListener=()=>{},document.body.addEventListener("wheel",this.dummyWheelListener),U(this.svgGroup_,"wheel",this,this.onMouseWheel)),this.options.hasCategories&&(this.toolbox=new(Ve(w.TOOLBOX,this.options,!0))(this)),this.grid&&this.grid.update(this.scale),this.recordDragTargets(),(e=Ve(w.CURSOR,this.options))&&this.markerManager.setCursor(new e(this)),e=null===this.options.parentWorkspace,this.renderer.createDom(this.svgGroup_,this.getTheme(),e?this.getInjectionDiv():void 0),t.getFocusManager$$module$build$src$core$focus_manager().registerTree(this,!!this.injectionDiv||this.isFlyout),this.svgGroup_}dispose(){if(this.rendered=!1,this.currentGesture_&&this.currentGesture_.cancel(),this.svgGroup_&&ce(this.svgGroup_),this.toolbox&&(this.toolbox.dispose(),this.toolbox=null),this.flyout&&(this.flyout.dispose(),this.flyout=null),this.trashcan&&(this.trashcan.dispose(),this.trashcan=null),this.scrollbar&&(this.scrollbar.dispose(),this.scrollbar=null),this.zoomControls_&&this.zoomControls_.dispose(),this.audioManager&&this.audioManager.dispose(),this.grid&&(this.grid=null),this.renderer.dispose(),this.markerManager.dispose(),super.dispose(),this.themeManager_&&(this.themeManager_.unsubscribeWorkspace(this),this.themeManager_.unsubscribe(this.svgBackground_),this.options.parentWorkspace||this.themeManager_.dispose()),this.connectionDBList.length=0,this.toolboxCategoryCallbacks.clear(),this.flyoutButtonCallbacks.clear(),!this.options.parentWorkspace){const e=this.getParentSvg();e&&e.parentNode&&ce(e.parentNode)}this.resizeHandlerWrapper&&(ne(this.resizeHandlerWrapper),this.resizeHandlerWrapper=null),this.dummyWheelListener&&(document.body.removeEventListener("wheel",this.dummyWheelListener),this.dummyWheelListener=null),t.getFocusManager$$module$build$src$core$focus_manager().isRegistered(this)&&t.getFocusManager$$module$build$src$core$focus_manager().unregisterTree(this)}addTrashcan(){this.trashcan=nt.newTrashcan(this);const e=this.trashcan.createDom();this.svgGroup_.insertBefore(e,this.getCanvas())}static newTrashcan(e){throw Error("The implementation of newTrashcan should be monkey-patched in by blockly.ts")}addZoomControls(){this.zoomControls_=new pp(this);const e=this.zoomControls_.createDom();this.svgGroup_.appendChild(e)}copyOptionsForFlyout(){return new no({parentWorkspace:this,rtl:this.RTL,oneBasedIndex:this.options.oneBasedIndex,horizontalLayout:this.horizontalLayout,renderer:this.options.renderer,rendererOverrides:this.options.rendererOverrides,plugins:this.options.plugins,modalInputs:this.options.modalInputs,move:{scrollbars:!0}})}addFlyout(e){const o=this.copyOptionsForFlyout();return o.toolboxPosition=this.options.toolboxPosition,this.flyout=this.horizontalLayout?new(Ve(w.FLYOUTS_HORIZONTAL_TOOLBOX,this.options,!0))(o):new(Ve(w.FLYOUTS_VERTICAL_TOOLBOX,this.options,!0))(o),this.flyout.autoClose=!1,this.flyout.getWorkspace().setVisible(!0),this.flyout.createDom(e)}getFlyout(e){return this.flyout||e?this.flyout:this.toolbox?this.toolbox.getFlyout():null}getToolbox(){return this.toolbox}updateScreenCalculations(){this.updateInverseScreenCTM(),this.recordDragTargets()}resizeContents(){this.resizesEnabled&&this.rendered&&(this.scrollbar&&this.scrollbar.resize(),this.updateInverseScreenCTM())}resize(){this.toolbox?this.toolbox.position():this.flyout&&this.flyout.position();const e=this.componentManager.getComponents(xe.Capability.POSITIONABLE,!0),o=this.getMetricsManager().getUiMetrics(),i=[];for(let n,s=0;n=e[s];s++){n.position(o,i);const l=n.getBoundingRectangle();l&&i.push(l)}this.scrollbar&&this.scrollbar.resize(),this.updateScreenCalculations()}updateScreenCalculationsIfScrolled(){const e=Jr();A.equals(this.lastRecordedPageScroll,e)||(this.lastRecordedPageScroll=e,this.updateScreenCalculations())}getLayerManager(){return this.layerManager}getCanvas(){return this.layerManager.getBlockLayer()}setCachedParentSvgSize(e,o){const i=this.getParentSvg();null!=e&&(this.cachedParentSvgSize.width=e,i.setAttribute("data-cached-width",`${e}`)),null!=o&&(this.cachedParentSvgSize.height=o,i.setAttribute("data-cached-height",`${o}`))}getBubbleCanvas(){return this.layerManager.getBubbleLayer()}getParentSvg(){if(!this.cachedParentSvg){let e=this.svgGroup_;for(;e;){if("svg"===e.tagName){this.cachedParentSvg=e;break}e=e.parentNode}}return this.cachedParentSvg}maybeFireViewportChangeEvent(){if(_e()){var e=this.scale,o=-this.scrollY,i=-this.scrollX;if(!(e===this.oldScale&&Math.abs(o-this.oldTop)<1&&Math.abs(i-this.oldLeft)<1)){var s=new(B(E.VIEWPORT_CHANGE))(o,i,e,this.id,this.oldScale);this.oldScale=e,this.oldTop=o,this.oldLeft=i,L(s)}}}translate(e,o){let i,s;null==(i=this.layerManager)||i.translateLayers(new A(e,o),this.scale),null==(s=this.grid)||s.moveTo(e,o),this.maybeFireViewportChangeEvent()}getWidth(){const e=this.getMetrics();return e?e.viewWidth/this.scale:0}setVisible(e){this.visible=e,this.svgGroup_&&(this.scrollbar&&this.scrollbar.setContainerVisible(e),this.getFlyout()&&this.getFlyout().setContainerVisible(e),this.getParentSvg().style.display=e?"block":"none",this.toolbox&&this.toolbox.setVisible(e),e||this.hideChaff(!0))}render(){const e=this.getAllBlocks(!1);for(let o=e.length-1;o>=0;o--)e[o].queueRender();this.getTopBlocks().flatMap(o=>o.getDescendants(!1)).filter(o=>o.isInsertionMarker()).forEach(o=>o.queueRender())}highlightBlock(e,o){if(void 0===o){for(let s,i=0;s=this.highlightedBlocks[i];i++)s.setHighlighted(!1);this.highlightedBlocks.length=0}(e=e?this.getBlockById(e):null)&&((o=void 0===o||o)?this.highlightedBlocks.includes(e)||this.highlightedBlocks.push(e):ft(this.highlightedBlocks,e),e.setHighlighted(o))}variableChangeCallback(e){switch(e.type){case E.VAR_CREATE:case E.VAR_DELETE:case E.VAR_RENAME:case E.VAR_TYPE_CHANGE:this.refreshToolboxSelection()}}refreshToolboxSelection(){const e=this.isFlyout?this.targetWorkspace:this;e&&!e.currentGesture_&&e.toolbox&&e.toolbox.getFlyout()&&e.toolbox.refreshSelection()}recordDragTargets(){const e=this.componentManager.getComponents(xe.Capability.DRAG_TARGET,!0);this.dragTargetAreas=[];for(let i,o=0;i=e[o];o++){const s=i.getClientRect();s&&this.dragTargetAreas.push({component:i,clientRect:s})}}newBlock(e,o){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}newComment(e){throw Error("The implementation of newComment should be monkey-patched in by blockly.ts")}getDragTarget(e){for(let i,o=0;i=this.dragTargetAreas[o];o++)if(i.clientRect.contains(e.clientX,e.clientY))return i.component;return null}onMouseDown(e){const o=this.getGesture(e);o&&o.handleWsStart(e,this)}startDrag(e,o){Yo(this,e,o)}moveDrag(e){return Ss(this,e)}setKeyboardMoveInProgress(e){this.keyboardMoveInProgress=e}isDragging(){return this.keyboardMoveInProgress||null!==this.currentGesture_&&this.currentGesture_.isDragging()}isDraggable(){return this.options.moveOptions&&this.options.moveOptions.drag}isMovable(){return this.options.moveOptions&&!!this.options.moveOptions.scrollbars||this.options.moveOptions&&this.options.moveOptions.wheel||this.options.moveOptions&&this.options.moveOptions.drag||this.options.zoomOptions&&this.options.zoomOptions.wheel||this.options.zoomOptions&&this.options.zoomOptions.pinch}isMovableHorizontally(){const e=!!this.scrollbar;return this.isMovable()&&(!e||e&&this.scrollbar.canScrollHorizontally())}isMovableVertically(){const e=!!this.scrollbar;return this.isMovable()&&(!e||e&&this.scrollbar.canScrollVertically())}onMouseWheel(e){if(Ac.inProgress())e.preventDefault(),e.stopPropagation();else{var o=this.options.zoomOptions&&this.options.zoomOptions.wheel,i=this.options.moveOptions&&this.options.moveOptions.wheel;if(o||i){var s=Uo(e);if(ep)var n=e.metaKey;o&&(e.ctrlKey||n||!i)?(s=-s.y/50,o=$o(e,this.getParentSvg(),this.getInverseScreenCTM()),this.zoom(o.x,o.y,s)):(o=this.scrollX-s.x,i=this.scrollY-s.y,e.shiftKey&&!s.x&&(o=this.scrollX-s.y,i=this.scrollY),this.scroll(o,i)),e.preventDefault()}}}getBlocksBoundingBox(){const e=this.getTopBoundedElements();if(!e.length)return new Q(0,0,0,0);const o=e[0].getBoundingRectangle();for(let s=1;s<e.length;s++){var i=e[s];i.isInsertionMarker&&i.isInsertionMarker()||((i=i.getBoundingRectangle()).top<o.top&&(o.top=i.top),i.bottom>o.bottom&&(o.bottom=i.bottom),i.left<o.left&&(o.left=i.left),i.right>o.right&&(o.right=i.right))}return o}cleanUp(){this.setResizesEnabled(!1),t.setGroup$$module$build$src$core$events$utils(!0);var e=this.getTopBlocks(!0),o=e.filter(l=>l.isMovable());const i=e.filter(l=>!l.isMovable()).map(l=>l.getBoundingRectangle());e=function(l){for(const h of i)if(l.intersects(h))return h;return null};var s=0;const n=this.renderer.getConstants().MIN_BLOCK_HEIGHT;for(const l of o){for(o=l.getBoundingRectangle(),l.moveBy(-o.left,s-o.top,["cleanup"]),l.snapToGrid(),s=e(o=l.getBoundingRectangle());null!=s;)s=s.top+s.getHeight()+n,l.moveBy(0,s-o.top,["cleanup"]),l.snapToGrid(),s=e(o=l.getBoundingRectangle());s=l.getRelativeToSurfaceXY().y+l.getHeightWidth().height+n}t.setGroup$$module$build$src$core$events$utils(!1),this.setResizesEnabled(!0)}showContextMenu(e){if(!this.isReadOnly()&&!this.isFlyout){var o=K.registry.getContextMenuOptions({workspace:this,focusedNode:this},e);this.configureContextMenu&&this.configureContextMenu(o,e);var i=e instanceof PointerEvent?new A(e.clientX,e.clientY):yo(this,new A(5,5));As(e,o,this.RTL,this,i)}}updateToolbox(e){if(e=wn(e)){if(!this.options.languageTree)throw Error("Existing toolbox is null.  Can't create new toolbox.");if(An(e)){if(!this.toolbox)throw Error("Existing toolbox has no categories.  Can't change mode.");this.options.languageTree=e,this.toolbox.render(e)}else{if(!this.flyout)throw Error("Existing toolbox has categories.  Can't change mode.");this.options.languageTree=e,this.flyout.show(e)}}else if(this.options.languageTree)throw Error("Can't nullify an existing toolbox.")}markFocused(){this.options.parentWorkspace?this.options.parentWorkspace.markFocused():(us(this),this.getParentSvg().focus({preventScroll:!0}))}zoom(e,o,i){i=Math.pow(this.options.zoomOptions.scaleSpeed,i);const s=this.scale*i;if(this.scale!==s){s>this.options.zoomOptions.maxScale?i=this.options.zoomOptions.maxScale/this.scale:s<this.options.zoomOptions.minScale&&(i=this.options.zoomOptions.minScale/this.scale);var n=this.getCanvas().getCTM(),l=this.getParentSvg().createSVGPoint();l.x=e,l.y=o,l=l.matrixTransform(n.inverse()),n=n.translate((e=l.x)*(1-i),(o=l.y)*(1-i)).scale(i),this.scrollX=n.e,this.scrollY=n.f,this.setScale(s)}}zoomCenter(e){var o=this.getMetrics();let i;this.flyout?(i=o.svgWidth?o.svgWidth/2:0,o=o.svgHeight?o.svgHeight/2:0):(i=o.viewWidth/2+o.absoluteLeft,o=o.viewHeight/2+o.absoluteTop),this.zoom(i,o,e)}zoomToFit(){if(this.isMovable()){var e=this.getMetrics(),o=e.viewWidth;e=e.viewHeight;var i=this.getBlocksBoundingBox(),n=i.right-i.left+40;if(i=i.bottom-i.top+40,n){this.flyout&&(this.horizontalLayout?(e+=this.flyout.getHeight(),i+=this.flyout.getHeight()/this.scale):(o+=this.flyout.getWidth(),n+=this.flyout.getWidth()/this.scale)),o/=n,e/=i,t.disable$$module$build$src$core$events$utils();try{this.setScale(Math.min(o,e)),this.scrollCenter()}finally{t.enable$$module$build$src$core$events$utils()}this.maybeFireViewportChangeEvent()}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}beginCanvasTransition(){R(this.getCanvas(),"blocklyCanvasTransitioning"),R(this.getBubbleCanvas(),"blocklyCanvasTransitioning")}endCanvasTransition(){te(this.getCanvas(),"blocklyCanvasTransitioning"),te(this.getBubbleCanvas(),"blocklyCanvasTransitioning")}scrollCenter(){if(this.isMovable()){var e=this.getMetrics(),o=(e.scrollWidth-e.viewWidth)/2,i=(e.scrollHeight-e.viewHeight)/2;this.scroll(o=-o-e.scrollLeft,i=-i-e.scrollTop)}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}centerOnBlock(e,o){if(this.isMovable()){var i=e?this.getBlockById(e):null;if(i){e=i.getRelativeToSurfaceXY(),i=o?{height:i.height,width:i.width}:i.getHeightWidth();var s=this.scale;o=(e.x+(this.RTL?-1:1)*i.width/2)*s,e=(e.y+i.height/2)*s,i=this.getMetrics(),this.scroll(-(o-i.viewWidth/2),-(e-i.viewHeight/2))}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}setScale(e){this.options.zoomOptions.maxScale&&e>this.options.zoomOptions.maxScale?e=this.options.zoomOptions.maxScale:this.options.zoomOptions.minScale&&e<this.options.zoomOptions.minScale&&(e=this.options.zoomOptions.minScale),this.scale=e,this.hideChaff(!1),(e=this.getFlyout(!1))&&e.isVisible()&&(e.reflow(),this.recordDragTargets()),this.grid&&this.grid.update(this.scale),e=this.getMetrics(),this.scrollX-=e.absoluteLeft,this.scrollY-=e.absoluteTop,e.viewLeft+=e.absoluteLeft,e.viewTop+=e.absoluteTop,this.scroll(this.scrollX,this.scrollY),this.scrollbar&&(this.flyout?this.scrollbar.resizeView(e):this.scrollbar.resizeContent(e))}getScale(){return this.scale}getAbsoluteScale(){const e=i=>{if(i.isFlyout){let s;const n=null==(s=i.targetWorkspace)?void 0:s.getFlyout();if(n instanceof Ic)return n.getFlyoutScale()}return i.getScale()},o=(i,s)=>i.options.parentWorkspace&&i.options.parentWorkspace.getSvgGroup().contains(i.getSvgGroup())?o(i.options.parentWorkspace,s*e(i)):s*e(i);return o(this,1)}scroll(e,o){this.hideChaff(!0);const i=this.getMetrics();e=Math.min(e,-i.scrollLeft),o=Math.min(o,-i.scrollTop);const s=i.scrollTop+Math.max(0,i.scrollHeight-i.viewHeight);e=Math.max(e,-(i.scrollLeft+Math.max(0,i.scrollWidth-i.viewWidth))),o=Math.max(o,-s),this.scrollX=e,this.scrollY=o,this.scrollbar&&this.scrollbar.set(-(e+i.scrollLeft),-(o+i.scrollTop),!1),this.translate(e+=i.absoluteLeft,o+=i.absoluteTop)}getBlockById(e){return super.getBlockById(e)}getAllBlocks(e=!1){return super.getAllBlocks(e)}getTopBlocks(e=!1){return super.getTopBlocks(e)}addTopBlock(e){this.addTopBoundedElement(e),super.addTopBlock(e)}removeTopBlock(e){this.removeTopBoundedElement(e),super.removeTopBlock(e)}addTopComment(e){this.addTopBoundedElement(e),super.addTopComment(e)}removeTopComment(e){this.removeTopBoundedElement(e),super.removeTopComment(e)}getTopComments(e=!1){return super.getTopComments(e)}getCommentById(e){return super.getCommentById(e)}getRootWorkspace(){return super.getRootWorkspace()}addTopBoundedElement(e){this.topBoundedElements.push(e)}removeTopBoundedElement(e){ft(this.topBoundedElements,e)}getTopBoundedElements(e=!1){const o=[].concat(this.topBoundedElements);return e&&o.sort(this.sortByOrigin.bind(this)),o}setResizesEnabled(e){const o=!this.resizesEnabled&&e;this.resizesEnabled=e,o&&this.resizeContents()}clear(){this.setResizesEnabled(!1),super.clear(),this.topBoundedElements=[],this.setResizesEnabled(!0)}registerButtonCallback(e,o){if("function"!=typeof o)throw TypeError("Button callbacks must be functions.");this.flyoutButtonCallbacks.set(e,o)}getButtonCallback(e){let o;return null!=(o=this.flyoutButtonCallbacks.get(e))?o:null}removeButtonCallback(e){this.flyoutButtonCallbacks.delete(e)}registerToolboxCategoryCallback(e,o){if("function"!=typeof o)throw TypeError("Toolbox category callbacks must be functions.");this.toolboxCategoryCallbacks.set(e,o)}getToolboxCategoryCallback(e){return this.toolboxCategoryCallbacks.get(e)||null}removeToolboxCategoryCallback(e){this.toolboxCategoryCallbacks.delete(e)}getGesture(e){if(this.keyboardMoveInProgress)return e.preventDefault(),e.stopPropagation(),null;const o="pointerdown"===e.type;let i;return o&&null!=(i=this.currentGesture_)&&i.hasStarted()&&(console.warn("Tried to start the same gesture twice."),this.currentGesture_.cancel()),!this.currentGesture_&&o&&(this.currentGesture_=new Ac(e,this)),this.currentGesture_}clearGesture(){this.currentGesture_=null}cancelCurrentGesture(){this.currentGesture_&&this.currentGesture_.cancel()}getAudioManager(){return this.audioManager}getGrid(){return this.grid}hideChaff(e=!1){xo(),Gn(this),Kt(),this.hideComponents(e)}hideComponents(e=!1){this.getComponentManager().getComponents(xe.Capability.AUTOHIDEABLE,!0).forEach(o=>o.autoHide(e))}static setTopLevelWorkspaceMetrics(e){const o=this.getMetrics();"number"==typeof e.x&&(this.scrollX=-(o.scrollLeft+(o.scrollWidth-o.viewWidth)*e.x)),"number"==typeof e.y&&(this.scrollY=-(o.scrollTop+(o.scrollHeight-o.viewHeight)*e.y)),this.translate(this.scrollX+o.absoluteLeft,this.scrollY+o.absoluteTop)}addClass(e){this.injectionDiv&&R(this.injectionDiv,e)}removeClass(e){this.injectionDiv&&te(this.injectionDiv,e)}setIsReadOnly(e){super.setIsReadOnly(e),e?this.addClass("blocklyReadOnly"):this.removeClass("blocklyReadOnly")}scrollBoundsIntoView(e,o=10){if(!Ac.inProgress()){var i=this.getScale(),s=this.getMetricsManager().getViewMetrics(!0);if(s=new Q(s.top,s.top+s.height,s.left,s.left+s.width),!(e.left>=s.left&&e.top>=s.top&&e.right<=s.right&&e.bottom<=s.bottom)){(e=e.clone()).top-=o,e.bottom+=o,e.left-=o,e.right+=o;var n=o=0;e.left<s.left?o=this.RTL?Math.min(s.left-e.left,s.right-e.right):s.left-e.left:e.right>s.right&&(o=this.RTL?s.right-e.right:Math.max(s.right-e.right,s.left-e.left)),e.top<s.top?n=s.top-e.top:e.bottom>s.bottom&&(n=Math.max(s.bottom-e.bottom,s.top-e.top)),this.scroll(this.scrollX+o*i,this.scrollY+n*i)}}}getFocusableElement(){return this.svgGroup_}getFocusableTree(){return this.isMutator&&this.options.parentWorkspace||this}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}getRootFocusableNode(){return this}getRestoredFocusableNode(e){if(e)return null;let o;return null!=(o=this.getTopBlocks(!0)[0])?o:null}getNestedTrees(){const e=this.getAllBlocks().map(i=>i.getIcons()).flat().filter(i=>i instanceof t.MutatorIcon$$module$build$src$core$icons$mutator_icon&&i.bubbleIsVisible()).map(i=>{let s;return null==(s=i.getBubble())?void 0:s.getWorkspace()}).filter(i=>!!i),o=this.getFlyout(!0);return o&&e.push(o.getWorkspace()),e}searchForWorkspaceComment(e){for(const o of this.getTopComments())if(o instanceof so&&o.canBeFocused()&&o.getFocusableElement().id===e)return o}lookUpFocusableNode(e){var o;const i=null==(o=this.targetWorkspace)?void 0:o.getFlyout();if(this.isFlyout&&i)for(var s of i.getContents())if(o=s.getElement(),Vo(o)&&o.canBeFocused()&&o.getFocusableElement().id===e)return o;if(s=e.indexOf("_field_"),o=e.indexOf("_connection_"),-1!==s){var n=e.substring(0,s);if(n=this.getBlockById(n))for(var l of n.getFields())if(l.canBeFocused()&&l.getFocusableElement().id===e)return l;return null}if(-1!==o){if(n=e.substring(0,o),n=this.getBlockById(n))for(const $ of n.getConnections_(!0))if($.id===e)return $;return null}var h;if(-1!==(l=Math.max(e.indexOf(Gu),e.indexOf(Dp),e.indexOf(Pp)))&&(l=e.substring(0,l),l=this.searchForWorkspaceComment(l)))return e.indexOf(Gu)>-1?l.getEditorFocusableNode():null!=(h=l.view.getCommentBarButtons().find($=>$.getFocusableElement().id.includes(e)))?h:null;if((h=this.getAllBlocks(!1).find($=>$.getFocusableElement().id===e))||(h=this.searchForWorkspaceComment(e)))return h;for(n of h=this.getAllBlocks().map($=>$.getIcons()).flat()){if(n.canBeFocused()&&n.getFocusableElement().id===e)return n;if(jo(n)&&(h=n.getBubble())&&h.canBeFocused()&&h.getFocusableElement().id===e)return h}return null}onTreeFocus(e,o){}onTreeBlur(e){if(this.isFlyout&&this.targetWorkspace&&!t.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()){var o=this.targetWorkspace.getFlyout(),i=this.targetWorkspace.getToolbox();i&&e===i||(i&&i.clearSelection(),o&&kt(o)&&o.autoHide(!1))}}getNavigator(){return this.navigator}setNavigator(e){this.navigator=e}},L$={};L$.WorkspaceSvg=nt,L$.resizeSvgContents=Fl;var an=class extends zs{constructor(e){super(),this.isBlank=typeof e>"u",e&&(this.varId=e.getId(),this.workspaceId=e.getWorkspace().id)}toJson(){const e=super.toJson();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");return e.varId=this.varId,e}static fromJson(e,o,i){return(o=super.fromJson(e,o,i??new an)).varId=e.varId,o}},_d=class extends an{constructor(e){super(e),this.type=E.VAR_CREATE,e&&(this.varType=e.getType(),this.varName=e.getName())}toJson(){const e=super.toJson();if(void 0===this.varType)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");return e.varType=this.varType,e.varName=this.varName,e}static fromJson(e,o,i){return(o=super.fromJson(e,o,i??new _d)).varType=e.varType,o.varName=e.varName,o}run(e){var o=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");o=o.getVariableMap(),e?o.createVariable(this.varName,this.varType,this.varId):(e=o.getVariableById(this.varId))&&o.deleteVariable(e)}};D(w.EVENT,E.VAR_CREATE,_d);var _g=class{constructor(e,o,i,s){this.workspace=e,this.name=o,this.type=i||"",this.id=s||Ne()}getId(){return this.id}getName(){return this.name}setName(e){return this.name=e,this}getType(){return this.type}setType(e){return this.type=e,this}getWorkspace(){return this.workspace}save(){const e={name:this.getName(),id:this.getId()},o=this.getType();return o&&(e.type=o),e}static load(e,o){e=new this(o,e.name,e.type,e.id),o.getVariableMap().addVariable(e),L(new(B(E.VAR_CREATE))(e))}};D(w.VARIABLE_MODEL,vt,_g);var bd=class extends an{constructor(e){super(e),this.type=E.VAR_DELETE,e&&(this.varType=e.getType(),this.varName=e.getName())}toJson(){const e=super.toJson();if(void 0===this.varType)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");return e.varType=this.varType,e.varName=this.varName,e}static fromJson(e,o,i){return(o=super.fromJson(e,o,i??new bd)).varType=e.varType,o.varName=e.varName,o}run(e){var o=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");o=o.getVariableMap(),e?(e=o.getVariableById(this.varId))&&o.deleteVariable(e):o.createVariable(this.varName,this.varType,this.varId)}};D(w.EVENT,E.VAR_DELETE,bd);var fd=class extends an{constructor(e,o){super(e),this.type=E.VAR_RENAME,e&&(this.oldName=e.getName(),this.newName=typeof o>"u"?"":o)}toJson(){const e=super.toJson();if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");return e.oldName=this.oldName,e.newName=this.newName,e}static fromJson(e,o,i){return(o=super.fromJson(e,o,i??new fd)).oldName=e.oldName,o.newName=e.newName,o}run(e){var o=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");const i=(o=o.getVariableMap()).getVariableById(this.varId);e?i&&o.renameVariable(i,this.newName):i&&o.renameVariable(i,this.oldName)}};D(w.EVENT,E.VAR_RENAME,fd);var bg=class{constructor(e,o=!1){this.workspace=e,this.potentialMap=o,this.variableMap=new Map}clear(){for(const e of this.variableMap.values())for(const o of e.values())this.deleteVariable(o);if(0!==this.variableMap.size)throw Error("Non-empty variable map")}renameVariable(e,o){if(e.getName()===o)return e;var i=e.getType();i=this.getVariable(o,i);const s=this.workspace.getAllBlocks(!1);let n="";this.potentialMap||(n=t.getGroup$$module$build$src$core$events$utils())||t.setGroup$$module$build$src$core$events$utils(!0);try{i&&i.getId()!==e.getId()?this.renameVariableWithConflict(e,o,i,s):this.renameVariableAndUses(e,o,s)}finally{this.potentialMap||t.setGroup$$module$build$src$core$events$utils(n)}return e}changeVariableType(e,o){var i;let s;return null==(i=this.variableMap.get(e.getType()))||i.delete(e.getId()),e.setType(o),(i=null!=(s=this.variableMap.get(o))?s:new Map).set(e.getId(),e),this.variableMap.has(o)||this.variableMap.set(o,i),e}renameVariableById(e,o){ze("VariableMap.renameVariableById","v12","v13","VariableMap.renameVariable");const i=this.getVariableById(e);if(!i)throw Error("Tried to rename a variable that didn't exist. ID: "+e);this.renameVariable(i,o)}renameVariableAndUses(e,o,i){for(this.potentialMap||L(new(B(E.VAR_RENAME))(e,o)),e.setName(o),o=0;o<i.length;o++)i[o].updateVarName(e)}renameVariableWithConflict(e,o,i,s){const n=e.getType();for(o!==i.getName()&&this.renameVariableAndUses(i,o,s),o=0;o<s.length;o++)s[o].renameVarById(e.getId(),i.getId());let h;this.potentialMap||L(new(B(E.VAR_DELETE))(e)),null==(h=this.variableMap.get(n))||h.delete(e.getId())}createVariable(e,o,i){var s=this.getVariable(e,o);if(s){if(i&&s.getId()!==i)throw Error('Variable "'+e+'" is already in use and its id is "'+s.getId()+'" which conflicts with the passed in id, "'+i+'".');return s}if(i&&this.getVariableById(i))throw Error('Variable id, "'+i+'", is already in use.');if(s=i||Ne(),o=o||"",!(i=Rt(w.VARIABLE_MODEL,vt,!0)))throw Error("No variable model is registered.");let n;return s=new i(this.workspace,e,o,s),(e=null!=(n=this.variableMap.get(o))?n:new Map).set(s.getId(),s),this.variableMap.has(o)||this.variableMap.set(o,e),this.potentialMap||L(new(B(E.VAR_CREATE))(s)),s}addVariable(e){const o=e.getType();let i;this.variableMap.has(o)||this.variableMap.set(o,new Map),null==(i=this.variableMap.get(o))||i.set(e.getId(),e)}deleteVariable(e){const o=Es(this.workspace,e.getId());let i="";this.potentialMap||(i=t.getGroup$$module$build$src$core$events$utils())||t.setGroup$$module$build$src$core$events$utils(!0);try{for(let n=0;n<o.length;n++)o[n].dispose(!0);const s=this.variableMap.get(e.getType());s&&s.has(e.getId())&&(s.delete(e.getId()),this.potentialMap||L(new(B(E.VAR_DELETE))(e)),0===s.size&&this.variableMap.delete(e.getType()))}finally{this.potentialMap||t.setGroup$$module$build$src$core$events$utils(i)}}deleteVariableById(e){ze("VariableMap.deleteVariableById","v12","v13","Blockly.Variables.deleteVariable"),(e=this.getVariableById(e))&&t.deleteVariable$$module$build$src$core$variables(this.workspace,e)}getVariable(e,o){if(!(o=this.variableMap.get(o||"")))return null;let i;return null!=(i=[...o.values()].find(s=>t.Names$$module$build$src$core$names.equals(s.getName(),e)))?i:null}getVariableById(e){for(const o of this.variableMap.values())if(o.has(e)){let i;return null!=(i=o.get(e))?i:null}return null}getVariablesOfType(e){return(e=this.variableMap.get(e||""))?[...e.values()]:[]}getTypes(){return[...this.variableMap.keys()]}getAllVariables(){let e=[];for(const o of this.variableMap.values())e=e.concat(...o.values());return e}getAllVariableNames(){ze("VariableMap.getAllVariableNames","v12","v13","Blockly.Variables.getAllVariables");const e=[];for(const o of this.variableMap.values())for(const i of o.values())e.push(i.getName());return e}getVariableUsesById(e){return ze("VariableMap.getVariableUsesById","v12","v13","Blockly.Variables.getVariableUsesById"),Es(this.workspace,e)}};D(w.VARIABLE_MAP,vt,bg);var Td=class extends oo{constructor(e,o){super(o),this.type=E.TRASHCAN_OPEN,this.isOpen=e}toJson(){const e=super.toJson();if(void 0===this.isOpen)throw Error("Whether this is already open or not is undefined. Either pass a value to the constructor, or call fromJson");return e.isOpen=this.isOpen,e}static fromJson(e,o,i){return(o=super.fromJson(e,o,i??new Td)).isOpen=e.isOpen,o}};D(w.EVENT,E.TRASHCAN_OPEN,Td);var fg=class extends Cc{constructor(e){super(),this.workspace=e,this.id="trashcan",this.contents=[],this.flyout=null,this.isLidOpen=!1,this.minOpenness=0,this.lidTask=this.svgLid=this.svgGroup=null,this.top=this.left=this.lidOpen=0,this.initialized=!1,this.workspace.options.maxTrashcanContents<=0||(e=this.workspace.copyOptionsForFlyout(),this.workspace.horizontalLayout?(e.toolboxPosition=this.workspace.toolboxPosition===j.TOP?j.BOTTOM:j.TOP,this.flyout=new(Ve(w.FLYOUTS_HORIZONTAL_TOOLBOX,this.workspace.options,!0))(e)):(e.toolboxPosition=this.workspace.toolboxPosition===j.RIGHT?j.LEFT:j.RIGHT,this.flyout=new(Ve(w.FLYOUTS_VERTICAL_TOOLBOX,this.workspace.options,!0))(e)),this.workspace.addChangeListener(this.onDelete.bind(this)))}createDom(){let e;this.svgGroup=I(v.G,{class:"blocklyTrash"});const o=String(Math.random()).substring(2);e=I(v.CLIPPATH,{id:"blocklyTrashBodyClipPath"+o},this.svgGroup),I(v.RECT,{width:Fr,height:Ed,y:Ur},e);const i=I(v.IMAGE,{width:dt_width,x:-Tg,height:dt_height,y:-Eg,"clip-path":"url(#blocklyTrashBodyClipPath"+o+")"},this.svgGroup);return i.setAttributeNS(It,"xlink:href",this.workspace.options.pathToMedia+dt_url),e=I(v.CLIPPATH,{id:"blocklyTrashLidClipPath"+o},this.svgGroup),I(v.RECT,{width:Fr,height:Ur},e),this.svgLid=I(v.IMAGE,{width:dt_width,x:-Tg,height:dt_height,y:-Eg,"clip-path":"url(#blocklyTrashLidClipPath"+o+")"},this.svgGroup),this.svgLid.setAttributeNS(It,"xlink:href",this.workspace.options.pathToMedia+dt_url),lt(this.svgGroup,"pointerdown",this,this.blockMouseDownWhenOpenable),lt(this.svgGroup,"pointerup",this,this.click),lt(i,"pointerover",this,this.mouseOver),lt(i,"pointerout",this,this.mouseOut),this.animateLid(),this.svgGroup}init(){if(this.workspace.options.maxTrashcanContents>0){const e=this.flyout.createDom(v.SVG);R(e,"blocklyTrashcanFlyout"),d(e,this.workspace.getParentSvg()),this.flyout.init(this.workspace)}this.workspace.getComponentManager().addComponent({component:this,weight:xe.ComponentWeight.TRASHCAN_WEIGHT,capabilities:[xe.Capability.AUTOHIDEABLE,xe.Capability.DELETE_AREA,xe.Capability.DRAG_TARGET,xe.Capability.POSITIONABLE]}),this.initialized=!0,this.setLidOpen(!1)}dispose(){this.workspace.getComponentManager().removeComponent("trashcan"),this.svgGroup&&ce(this.svgGroup),this.lidTask&&clearTimeout(this.lidTask)}hasContents(){return!!this.contents.length}contentsIsOpen(){return!!this.flyout&&this.flyout.isVisible()}openFlyout(){if(!this.contentsIsOpen()){var e=this.contents.map(function(i){return JSON.parse(i)}),o=this.workspace.getParentSvg().style;o.cursor="wait",setTimeout(()=>{let i,s;null==(i=this.flyout)||i.show(e),o.cursor="",null==(s=this.workspace.scrollbar)||s.setVisible(!1)},10),this.fireUiEvent(!0)}}closeFlyout(){var e,o;this.contentsIsOpen()&&(null==(e=this.flyout)||e.hide(),null==(o=this.workspace.scrollbar)||o.setVisible(!0),this.fireUiEvent(!1),this.workspace.recordDragTargets())}autoHide(e){!e&&this.flyout&&this.closeFlyout()}emptyContents(){this.hasContents()&&(this.contents.length=0,this.setMinOpenness(0),this.closeFlyout())}position(e,o){if(this.initialized){var s,n,i=Mn(this.workspace,e);e=Rn(i,new ee(Fr,Ed+Ur),TT,B$,e,this.workspace),o=Nn(e,B$,i.vertical===Ui.TOP?Ys.DOWN:Ys.UP,o),this.top=o.top,this.left=o.left,null==(s=this.svgGroup)||s.setAttribute("transform","translate("+this.left+","+this.top+")"),null==(n=this.flyout)||n.position()}}getBoundingRectangle(){return new Q(this.top,this.top+Ed+Ur,this.left,this.left+Fr)}getClientRect(){if(!this.svgGroup)return null;var e=this.svgGroup.getBoundingClientRect();const o=e.top+Eg-vd;return new Q(o,o+Ur+Ed+2*vd,e=e.left+Tg-vd,e+Fr+2*vd)}onDragOver(e){this.setLidOpen(this.wouldDelete_)}onDragExit(e){this.setLidOpen(!1)}onDrop(e){setTimeout(this.setLidOpen.bind(this,!1),100)}setLidOpen(e){this.isLidOpen!==e&&(this.lidTask&&clearTimeout(this.lidTask),this.isLidOpen=e,this.animateLid())}animateLid(){const e=yT;var o=1/(e+1);this.lidOpen+=this.isLidOpen?o:-o,this.lidOpen=Math.min(Math.max(this.lidOpen,this.minOpenness),1),this.setLidAngle(this.lidOpen*F$),o=P$+this.lidOpen*(xT-P$),this.svgGroup&&(this.svgGroup.style.opacity=`${o}`),this.lidOpen>this.minOpenness&&this.lidOpen<1&&(this.lidTask=setTimeout(this.animateLid.bind(this),vT/e))}setLidAngle(e){const o=this.workspace.toolboxPosition===j.RIGHT||this.workspace.horizontalLayout&&this.workspace.RTL;let i;null==(i=this.svgLid)||i.setAttribute("transform","rotate("+(o?-e:e)+","+(o?4:Fr-4)+","+(Ur-2)+")")}setMinOpenness(e){this.minOpenness=e,this.isLidOpen||this.setLidAngle(e*F$)}closeLid(){this.setLidOpen(!1)}click(){this.hasContents()&&!this.workspace.isDragging()&&this.openFlyout()}fireUiEvent(e){e=new(B(E.TRASHCAN_OPEN))(e,this.workspace.id),L(e)}blockMouseDownWhenOpenable(e){!this.contentsIsOpen()&&this.hasContents()&&e.stopPropagation()}mouseOver(){this.hasContents()&&this.setLidOpen(!0)}mouseOut(){this.setLidOpen(!1)}onDelete(e){if(!(this.workspace.options.maxTrashcanContents<=0||!ui(e)||e.wasShadow)){if(!e.oldJson)throw Error("Encountered a delete event without proper oldJson");if(e=JSON.stringify(this.cleanBlockJson(e.oldJson)),!this.contents.includes(e)){for(this.contents.unshift(e);this.contents.length>this.workspace.options.maxTrashcanContents;)this.contents.pop();this.setMinOpenness(ET)}}}cleanBlockJson(e){return function o(i){if(i){if(delete i.id,delete i.x,delete i.y,delete i.enabled,delete i.disabledReasons,i.icons&&i.icons.comment){var s=i.icons.comment;delete s.height,delete s.width,delete s.pinned}for(var n in s=i.inputs){var l=s[n];const h=l.block;l=l.shadow,h&&o(h),l&&o(l)}i.next&&(i=(n=i.next).block,n=n.shadow,i&&o(i),n&&o(n))}}(e=JSON.parse(JSON.stringify(e))),Object.assign({},{kind:"BLOCK"},e)}},Fr=47,Ed=44,Ur=16,B$=20,TT=20,vd=10,Tg=0,Eg=32,ET=.1,vT=80,yT=4,P$=.4,xT=.8,F$=45,Bc=null,Pc=null,yd=void 0,uo={};uo.BlockPaster=Nr,uo.copy=Ps,uo.getLastCopiedData=Mi,uo.getLastCopiedLocation=nr,uo.getLastCopiedWorkspace=Fs,uo.paste=Zt,uo.registry=mp,uo.setLastCopiedData=Ul,uo.setLastCopiedLocation=Hl,uo.setLastCopiedWorkspace=Zl;var Ki={};Ki.CollapseCommentBarButton=Lp,Ki.CommentBarButton=bc,Ki.CommentEditor=Bp,Ki.CommentView=Or,Ki.DeleteCommentBarButton=Fp,Ki.RenderedWorkspaceComment=so,Ki.WorkspaceComment=fc;var ri=function(e){return e.ESCAPE="escape",e.DELETE="delete",e.COPY="copy",e.CUT="cut",e.PASTE="paste",e.UNDO="undo",e.REDO="redo",e}(ri||{});Gl();var Mo={};Mo.names=ri,Mo.registerCopy=ar,Mo.registerCut=ur,Mo.registerDefaultShortcuts=Gl,Mo.registerDelete=lr,Mo.registerEscape=Di,Mo.registerPaste=dr,Mo.registerRedo=Zs,Mo.registerUndo=hr;var xd={ProcedureSerializer:class{constructor(e,o){this.procedureModelClass=e,this.parameterModelClass=o,this.priority=75}save(e){return(e=e.getProcedureMap().getProcedures().map(o=>pr(o))).length?e:null}load(e,o){const i=o.getProcedureMap();for(const s of e)i.add(gr(this.procedureModelClass,this.parameterModelClass,s,o))}clear(e){e.getProcedureMap().clear()}}};xd.loadProcedure=gr,xd.saveProcedure=pr;var U$=class{constructor(){this.priority=100}save(e){return(e=e.getAllVariables().map(o=>o.save())).length?e:null}load(e,o){const i=Rt(w.VARIABLE_MODEL,vt);e.forEach(s=>{i?.load(s,o)})}clear(e){e.getVariableMap().clear()}};_s("variables",new U$);var Z$={};Z$.VariableSerializer=U$;var vg={};vg.load=Ht,vg.save=wo;var wT={blocks:hc,exceptions:Ks,priorities:H_,procedures:xd,registry:gp,variables:Z$,workspaceComments:Cu,workspaces:vg};"Blockly"in globalThis||(globalThis.Blockly={Msg:Zm});var yg="label",xg=class{load(e,o){return(e=new pt(o.getWorkspace(),o.targetWorkspace,e,!0)).show(),new rn(e,yg)}gapForItem(e,o){return o}disposeItem(e){(e=e.getElement())instanceof pt&&e.dispose()}getType(){return yg}};D(w.FLYOUT_INFLATER,yg,xg);var Cg=class extends Mc{constructor(e){super(),this.GRID_UNIT=4,this.CURSOR_COLOUR="#ffa200",this.CURSOR_RADIUS=5,this.JAGGED_TEETH_WIDTH=this.JAGGED_TEETH_HEIGHT=0,this.START_HAT_HEIGHT=22,this.START_HAT_WIDTH=96,this.SHAPES={HEXAGONAL:1,ROUND:2,SQUARE:3,PUZZLE:4,NOTCH:5},this.SHAPE_IN_SHAPE_PADDING={1:{0:5*this.GRID_UNIT,1:2*this.GRID_UNIT,2:5*this.GRID_UNIT,3:5*this.GRID_UNIT},2:{0:3*this.GRID_UNIT,1:3*this.GRID_UNIT,2:1*this.GRID_UNIT,3:2*this.GRID_UNIT},3:{0:2*this.GRID_UNIT,1:2*this.GRID_UNIT,2:2*this.GRID_UNIT,3:2*this.GRID_UNIT}},this.FULL_BLOCK_FIELDS=!0,this.FIELD_TEXT_FONTWEIGHT="bold",this.FIELD_TEXT_FONTFAMILY='"Helvetica Neue", "Segoe UI", Helvetica, sans-serif',this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!0,this.SELECTED_GLOW_COLOUR="#fff200",this.SELECTED_GLOW_SIZE=.5,this.REPLACEMENT_GLOW_COLOUR="#fff200",this.REPLACEMENT_GLOW_SIZE=2,this.selectedGlowFilterId="",this.selectedGlowFilter=null,this.replacementGlowFilterId="",this.SQUARED=this.ROUNDED=this.HEXAGONAL=this.replacementGlowFilter=null,e&&(this.GRID_UNIT=e),this.SMALL_PADDING=this.GRID_UNIT,this.MEDIUM_PADDING=2*this.GRID_UNIT,this.MEDIUM_LARGE_PADDING=3*this.GRID_UNIT,this.LARGE_PADDING=4*this.GRID_UNIT,this.CORNER_RADIUS=1*this.GRID_UNIT,this.NOTCH_WIDTH=9*this.GRID_UNIT,this.NOTCH_HEIGHT=2*this.GRID_UNIT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT=3*this.GRID_UNIT,this.MIN_BLOCK_WIDTH=2*this.GRID_UNIT,this.MIN_BLOCK_HEIGHT=12*this.GRID_UNIT,this.EMPTY_STATEMENT_INPUT_HEIGHT=6*this.GRID_UNIT,this.TOP_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=6*this.GRID_UNIT,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT,this.STATEMENT_INPUT_SPACER_MIN_WIDTH=40*this.GRID_UNIT,this.STATEMENT_INPUT_PADDING_LEFT=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_PADDING=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_MIN_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=6*this.GRID_UNIT,this.CURSOR_WS_WIDTH=20*this.GRID_UNIT,this.FIELD_TEXT_FONTSIZE=3*this.GRID_UNIT,this.FIELD_BORDER_RECT_RADIUS=this.CORNER_RADIUS,this.FIELD_BORDER_RECT_X_PADDING=2*this.GRID_UNIT,this.FIELD_BORDER_RECT_Y_PADDING=1.625*this.GRID_UNIT,this.FIELD_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_COLOUR_DEFAULT_WIDTH=6*this.GRID_UNIT,this.FIELD_COLOUR_DEFAULT_HEIGHT=8*this.GRID_UNIT,this.FIELD_CHECKBOX_X_OFFSET=1*this.GRID_UNIT,this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH=12*this.GRID_UNIT}setFontConstants_(e){super.setFontConstants_(e),this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT=this.FIELD_TEXT_HEIGHT+2*this.FIELD_BORDER_RECT_Y_PADDING}init(){super.init(),this.HEXAGONAL=this.makeHexagonal(),this.ROUNDED=this.makeRounded(),this.SQUARED=this.makeSquared(),this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT+this.INSIDE_CORNERS.rightWidth}setDynamicProperties_(e){super.setDynamicProperties_(e),this.SELECTED_GLOW_COLOUR=e.getComponentStyle("selectedGlowColour")||this.SELECTED_GLOW_COLOUR;const o=Number(e.getComponentStyle("selectedGlowSize"));this.SELECTED_GLOW_SIZE=o&&!isNaN(o)?o:this.SELECTED_GLOW_SIZE,this.REPLACEMENT_GLOW_COLOUR=e.getComponentStyle("replacementGlowColour")||this.REPLACEMENT_GLOW_COLOUR,this.REPLACEMENT_GLOW_SIZE=(e=Number(e.getComponentStyle("replacementGlowSize")))&&!isNaN(e)?e:this.REPLACEMENT_GLOW_SIZE}dispose(){super.dispose(),this.selectedGlowFilter&&ce(this.selectedGlowFilter),this.replacementGlowFilter&&ce(this.replacementGlowFilter)}makeStartHat(){const e=this.START_HAT_HEIGHT,o=this.START_HAT_WIDTH;return{height:.75*e,width:o,path:at("c",[P(25,-e),P(71,-e),P(o,0)])}}makeHexagonal(){function e(i,s,n){var l=i/2;return T(-(n=n?-1:1)*(l=l>o?o:l),i=(s?-1:1)*i/2)+T(n*l,i)}const o=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;return{type:this.SHAPES.HEXAGONAL,isDynamic:!0,width:i=>(i/=2)>o?o:i,height:i=>i,connectionOffsetY:i=>i/2,connectionOffsetX:i=>-i,pathDown:i=>e(i,!1,!1),pathUp:i=>e(i,!0,!1),pathRightDown:i=>e(i,!1,!0),pathRightUp:i=>e(i,!1,!0)}}makeRounded(){function e(s,n,l){const h=s>i?s-i:0,$=l===n?"0":"1";return a("a","0 0,"+$,s=(s>i?i:s)/2,P((l?1:-1)*s,(n?-1:1)*s))+c("v",(n?-1:1)*h)+a("a","0 0,"+$,s,P((l?-1:1)*s,(n?-1:1)*s))}const o=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,i=2*o;return{type:this.SHAPES.ROUND,isDynamic:!0,width:s=>(s/=2)>o?o:s,height:s=>s,connectionOffsetY:s=>s/2,connectionOffsetX:s=>-s,pathDown:s=>e(s,!1,!1),pathUp:s=>e(s,!0,!1),pathRightDown:s=>e(s,!1,!0),pathRightUp:s=>e(s,!1,!0)}}makeSquared(){function e(i,s,n){i-=2*o;const l=n===s?"0":"1";return a("a","0 0,"+l,o,P((n?1:-1)*o,(s?-1:1)*o))+c("v",(s?-1:1)*i)+a("a","0 0,"+l,o,P((n?-1:1)*o,(s?-1:1)*o))}const o=this.CORNER_RADIUS;return{type:this.SHAPES.SQUARE,isDynamic:!0,width:i=>o,height:i=>i,connectionOffsetY:i=>i/2,connectionOffsetX:i=>-i,pathDown:i=>e(i,!1,!1),pathUp:i=>e(i,!0,!1),pathRightDown:i=>e(i,!1,!0),pathRightUp:i=>e(i,!1,!0)}}shapeFor(e){let o=e.getCheck();switch(!o&&e.targetConnection&&(o=e.targetConnection.getCheck()),e.type){case N.INPUT_VALUE:case N.OUTPUT_VALUE:if(null!==(e=e.getSourceBlock().getOutputShape()))switch(e){case this.SHAPES.HEXAGONAL:return this.HEXAGONAL;case this.SHAPES.ROUND:return this.ROUNDED;case this.SHAPES.SQUARE:return this.SQUARED}return o&&o.includes("Boolean")?this.HEXAGONAL:(o&&o.includes("Number")||o&&o.includes("String"),this.ROUNDED);case N.PREVIOUS_STATEMENT:case N.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown type")}}makeNotch(){function e(F){return at("c",[P(F*n/2,0),P(F*n*3/4,h/2),P(F*n,h)])+r([P(F*n,l)])+at("c",[P(F*n/4,h/2),P(F*n/2,h),P(F*n,h)])+c("h",F*s)+at("c",[P(F*n/2,0),P(F*n*3/4,-h/2),P(F*n,-h)])+r([P(F*n,-l)])+at("c",[P(F*n/4,-h/2),P(F*n/2,-h),P(F*n,-h)])}const o=this.NOTCH_WIDTH,i=this.NOTCH_HEIGHT,s=o/3,n=s/3,l=i/2,h=l/2,$=e(1),k=e(-1);return{type:this.SHAPES.NOTCH,width:o,height:i,pathLeft:$,pathRight:k}}makeInsideCorners(){const e=this.CORNER_RADIUS,o=a("a","0 0,0",e,P(-e,e)),i=a("a","0 0,1",e,P(-e,e));return{width:e,height:e,pathTop:o,pathBottom:a("a","0 0,0",e,P(e,e)),rightWidth:e,rightHeight:e,pathTopRight:i,pathBottomRight:a("a","0 0,1",e,P(e,e))}}generateSecondaryColour_(e){return ki("#000",e,.15)||e}generateTertiaryColour_(e){return ki("#000",e,.25)||e}createDom(e,o,i,s){super.createDom(e,o,i,s),e=I(v.DEFS,{},e),o=I(v.FILTER,{id:"blocklySelectedGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e),I(v.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.SELECTED_GLOW_SIZE},o),i=I(v.FECOMPONENTTRANSFER,{result:"outBlur"},o),I(v.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},i),I(v.FEFLOOD,{"flood-color":this.SELECTED_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},o),I(v.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},o),this.selectedGlowFilterId=o.id,this.selectedGlowFilter=o,e=I(v.FILTER,{id:"blocklyReplacementGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e),I(v.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.REPLACEMENT_GLOW_SIZE},e),o=I(v.FECOMPONENTTRANSFER,{result:"outBlur"},e),I(v.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},o),I(v.FEFLOOD,{"flood-color":this.REPLACEMENT_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},e),I(v.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},e),I(v.FECOMPOSITE,{in:"SourceGraphic",in2:"outGlow",operator:"over"},e),this.replacementGlowFilterId=e.id,this.replacementGlowFilter=e,s&&(s.style.setProperty("--blocklySelectedGlowFilter",`url(#${this.selectedGlowFilterId})`),s.style.setProperty("--blocklyReplacementGlowFilter",`url(#${this.replacementGlowFilterId})`))}getCSS_(e){return[`${e} .blocklyText,`,`${e} .blocklyFlyoutLabelText {`,`font: ${this.FIELD_TEXT_FONTWEIGHT} ${this.FIELD_TEXT_FONTSIZE}pt ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${e} .blocklyTextInputBubble textarea {`,"font-weight: normal;","}",`${e} .blocklyText {`,"fill: #fff;","}",`${e} .blocklyNonEditableField>rect:not(.blocklyDropdownRect),`,`${e} .blocklyEditableField>rect:not(.blocklyDropdownRect) {`,`fill: ${this.FIELD_BORDER_RECT_COLOUR};`,"}",`${e} .blocklyNonEditableField>text,`,`${e} .blocklyEditableField>text,`,`${e} .blocklyNonEditableField>g>text,`,`${e} .blocklyEditableField>g>text {`,"fill: #575E75;","}",`${e} .blocklyFlyoutLabelText {`,"fill: #575E75;","}",`${e} .blocklyText.blocklyBubbleText {`,"fill: #575E75;","}",`${e} .blocklyDraggable:not(.blocklyDisabled)`," .blocklyEditableField:not(.blocklyEditing):hover>rect,",`${e} .blocklyDraggable:not(.blocklyDisabled)`," .blocklyEditableField:not(.blocklyEditing):hover>.blocklyPath {","stroke: #fff;","stroke-width: 2;","}",`${e} .blocklyHtmlInput {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,`font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,"color: #575E75;","}",`${e} .blocklyDropdownText {`,"fill: #fff !important;","}",`${e}.blocklyWidgetDiv .blocklyMenuItem,`,`${e}.blocklyDropDownDiv .blocklyMenuItem {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${e}.blocklyDropDownDiv .blocklyMenuItemContent {`,"color: #fff;","}",`${e} .blocklyHighlightedConnectionPath {`,`stroke: ${this.SELECTED_GLOW_COLOUR};`,"}",`${e} .blocklyDisabledPattern > .blocklyOutlinePath {`,"fill: var(--blocklyDisabledPattern)","}",`${e} .blocklyInsertionMarker>.blocklyPath {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}",`${e} .blocklySelected>.blocklyPath.blocklyPathSelected {`,"fill: none;","filter: var(--blocklySelectedGlowFilter);","}",`${e} .blocklyReplaceable>.blocklyPath {`,"filter: var(--blocklyReplacementGlowFilter);","}"]}},kg=class extends Nc{constructor(e,o){super(e,o)}draw(){const e=this.block_.pathObject;e.beginDrawing(),this.drawOutline_(),this.drawInternals_(),this.updateConnectionHighlights(),e.setPath(this.outlinePath_+"\n"+this.inlinePath_),this.info_.RTL&&e.flipRTL(),this.recordSizeOnBlock_(),this.info_.outputConnection&&(e.outputShapeType=this.info_.outputConnection.shape.type),e.endDrawing()}drawOutline_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape&&!this.info_.hasStatementInput&&!this.info_.bottomRow.hasNextConnection?(this.drawFlatTop_(),this.drawRightDynamicConnection_(),this.drawFlatBottom_(),this.drawLeftDynamicConnection_()):super.drawOutline_()}drawLeft_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape?this.drawLeftDynamicConnection_():super.drawLeft_()}drawRightSideRow_(e){if(!(e.height<=0)){if(_.isSpacer(e)){const s=e.precedesStatement;var o=e.followsStatement;if(s||o){const n=this.constants_.INSIDE_CORNERS;var i=n.rightHeight;return o=o?n.pathBottomRight:"",e=(i=e.height-(s?i:0))>0?c("V",e.yPos+i):"",void(this.outlinePath_+=o+e+(s?n.pathTopRight:""))}}this.outlinePath_+=c("V",e.yPos+e.height)}}drawRightDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.outlinePath_+=this.info_.outputConnection.shape.pathRightDown(this.info_.outputConnection.height)}drawLeftDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.positionOutputConnection_(),this.outlinePath_+=this.info_.outputConnection.shape.pathUp(this.info_.outputConnection.height),this.outlinePath_+="z"}drawFlatTop_(){const e=this.info_.topRow;this.positionPreviousConnection_(),this.outlinePath_+=u(e.xPos,this.info_.startY),this.outlinePath_+=c("h",e.width)}drawFlatBottom_(){const e=this.info_.bottomRow;this.positionNextConnection_(),this.outlinePath_+=c("V",e.baseline),this.outlinePath_+=c("h",-e.width)}drawInlineInput_(e){this.positionInlineInputConnection_(e);const o=e.input.name;e.connectedBlock||this.info_.isInsertionMarker||(e=He(e.xPos+e.connectionWidth,e.centerline-e.height/2)+this.getInlineInputPath(e),this.block_.pathObject.setOutlinePath(o,e))}getInlineInputPath(e){const o=e.width-2*e.connectionWidth,i=e.height;return c("h",o)+e.shape.pathRightDown(i)+c("h",-o)+e.shape.pathUp(i)+"z"}drawStatementInput_(e){var o=e.getLastInput();const i=o.xPos+o.notchOffset+o.shape.width,s=this.constants_.INSIDE_CORNERS,n=o.shape.pathRight+c("h",-(o.notchOffset-s.width))+s.pathTop,l=e.height-2*s.height;o=s.pathBottom+c("h",o.notchOffset-s.width)+(o.connectedBottomNextConnection?"":o.shape.pathLeft),this.outlinePath_+=c("H",i)+n+c("v",l)+o+c("H",e.xPos+e.width),this.positionStatementInputConnection_(e)}drawConnectionHighlightPath(e){const o=e.connectionModel;if(o.type===N.NEXT_STATEMENT||o.type===N.PREVIOUS_STATEMENT||o.type===N.OUTPUT_VALUE&&!e.isDynamicShape)return super.drawConnectionHighlightPath(e);e=o.type===N.INPUT_VALUE?He(e.connectionWidth,-e.height/2)+this.getInlineInputPath(e):He(e.width,-e.height/2)+e.shape.pathDown(e.height);const i=o.getSourceBlock();let s,n;return null==(n=(s=i.pathObject).addConnectionHighlight)?void 0:n.call(s,o,e,o.getOffsetInBlock(),i.RTL)}},Ji=class extends ue{constructor(e,o,i,s,n,l,h){if(super(ue.SKIP_SETUP),this.imageElement=this.clickHandler=null,this.flipRtl=this.isDirty_=this.EDITABLE=!1,this.altText="",i=Number(Ae(i)),o=Number(Ae(o)),isNaN(i)||isNaN(o))throw Error("Height and width values of an image field must cast to numbers.");if(i<=0||o<=0)throw Error("Height and width values of an image field must be greater than 0.");this.size_=new ee(o,i+Ji.Y_PADDING),this.imageHeight=i,"function"==typeof n&&(this.clickHandler=n),e!==ue.SKIP_SETUP&&(h?this.configure_(h):(this.flipRtl=!!l,this.altText=Ae(s)||""),this.setValue(Ae(e)))}configure_(e){super.configure_(e),e.flipRtl&&(this.flipRtl=e.flipRtl),e.alt&&(this.altText=Ae(e.alt))}initView(){this.imageElement=I(v.IMAGE,{height:this.imageHeight+"px",width:this.size_.width+"px",alt:this.altText},this.fieldGroup_),this.imageElement.setAttributeNS(It,"xlink:href",this.value_),this.fieldGroup_&&R(this.fieldGroup_,"blocklyImageField"),this.clickHandler&&(this.imageElement.style.cursor="pointer")}updateSize_(){}doClassValidation_(e){return"string"!=typeof e?null:e}doValueUpdate_(e){this.value_=e,this.imageElement&&this.imageElement.setAttributeNS(It,"xlink:href",this.value_)}getFlipRtl(){return this.flipRtl}setAlt(e){e!==this.altText&&(this.altText=e||"",this.imageElement&&this.imageElement.setAttribute("alt",this.altText))}isClickable(){return super.isClickable()&&!!this.clickHandler}showEditor_(){this.clickHandler&&this.clickHandler(this)}setOnClickHandler(e){this.clickHandler=e}getText_(){return this.altText}static fromJson(e){if(!e.src||!e.width||!e.height)throw Error("src, width, and height values for an image field arerequired. The width and height must be non-zero.");return new this(e.src,e.width,e.height,void 0,void 0,void 0,e)}};Ji.Y_PADDING=1,Pt("field_image",Ji),Ji.prototype.DEFAULT_VALUE="";var un=class extends ue{set size_(e){super.size_=e}get size_(){const e=super.size_;return e.width<14&&(e.width=14),e}constructor(e,o,i){super(ue.SKIP_SETUP),this.spellcheck_=!0,this.htmlInput_=null,this.isTextValid_=this.isBeingEdited_=!1,this.onInputWrapper=this.onKeyDownWrapper=this.valueWhenEditorWasOpened_=null,this.fullBlockClickTarget_=!1,this.workspace_=null,this.SERIALIZABLE=!0,e!==ue.SKIP_SETUP&&(i&&this.configure_(i),this.setValue(e),o&&this.setValidator(o))}configure_(e){super.configure_(e),void 0!==e.spellcheck&&(this.spellcheck_=e.spellcheck)}initView(){if(!this.getSourceBlock())throw new Me;super.initView(),this.isFullBlockField()&&(this.clickTarget_=this.sourceBlock_.getSvgRoot()),this.fieldGroup_&&R(this.fieldGroup_,"blocklyInputField")}isFullBlockField(){const e=this.getSourceBlock();if(!e)throw new Me;let o;return this.fullBlockClickTarget_=!(null==(o=this.getConstants())||!o.FULL_BLOCK_FIELDS)&&e.isSimpleReporter()}doValueInvalid_(e,o=!0){this.isBeingEdited_&&(this.isDirty_=!0,this.isTextValid_=!1,e=this.value_,this.value_=this.valueWhenEditorWasOpened_,this.sourceBlock_&&_e()&&this.value_!==e&&o&&L(new(B(E.BLOCK_CHANGE))(this.sourceBlock_,"field",this.name||null,e,this.value_)))}doValueUpdate_(e){this.isTextValid_=this.isDirty_=!0,this.value_=e}applyColour(){const e=this.getSourceBlock();if(!e)throw new Me;this.getConstants().FULL_BLOCK_FIELDS&&this.fieldGroup_&&(!this.isFullBlockField()&&this.borderRect_?(this.borderRect_.style.display="block",this.borderRect_.setAttribute("stroke",e.getColourTertiary())):(this.borderRect_.style.display="none",e.pathObject.svgPath.setAttribute("fill",this.getConstants().FIELD_BORDER_RECT_COLOUR)))}getSize(){let e;return null!=(e=this.getConstants())&&e.FULL_BLOCK_FIELDS&&(this.render_(),this.isDirty_=!1),super.getSize()}onLocationChange(){this.isBeingEdited_&&this.resizeEditor_()}render_(){if(super.render_(),this.isBeingEdited_){var e=this.htmlInput_;this.isTextValid_?(te(e,"blocklyInvalidInput"),De(e,Fe.INVALID,!1)):(R(e,"blocklyInvalidInput"),De(e,Fe.INVALID,!0))}if(!(e=this.getSourceBlock()))throw new Me;this.getConstants().FULL_BLOCK_FIELDS&&e.applyColour()}setSpellcheck(e){e!==this.spellcheck_&&(this.spellcheck_=e,this.htmlInput_&&this.htmlInput_.setAttribute("spellcheck",this.spellcheck_))}showEditor_(e,o=!1,i=!0){this.workspace_=this.sourceBlock_.workspace,!o&&this.workspace_.options.modalInputs&&($m||Qh||Tu)?this.showPromptEditor():this.showInlineEditor(o,i)}showPromptEditor(){sl(t.Msg$$module$build$src$core$msg.CHANGE_VALUE_TITLE,this.getText(),e=>{null!==e&&this.setValue(this.getValueFromEditorText_(e)),this.onFinishEditing_(this.value_)})}showInlineEditor(e,o){const i=this.getSourceBlock();if(!i)throw new Me;vl(this,i.RTL,this.widgetDispose_.bind(this),this.workspace_,o),this.htmlInput_=this.widgetCreate_(),this.isBeingEdited_=!0,this.valueWhenEditorWasOpened_=this.value_,e||(this.htmlInput_.focus({preventScroll:!0}),this.htmlInput_.select())}widgetCreate_(){var e=this.getSourceBlock();if(!e)throw new Me;t.setGroup$$module$build$src$core$events$utils(!0);const o=Is();var i=this.getClickTarget_();if(!i)throw Error("A click target has not been set.");R(i,"blocklyEditing"),(i=document.createElement("input")).className="blocklyHtmlInput",i.setAttribute("spellcheck",this.spellcheck_);const s=this.workspace_.getAbsoluteScale();var n=this.getConstants().FIELD_TEXT_FONTSIZE*s+"pt";return o.style.fontSize=n,i.style.fontSize=n,n=un.BORDERRADIUS*s+"px",this.isFullBlockField()&&(n=((n=this.getScaledBBox()).bottom-n.top)/2+"px",e=e.getParent()?e.getParent().getColourTertiary():this.sourceBlock_.getColourTertiary(),i.style.border=1*s+"px solid "+e,o.style.borderRadius=n,o.style.transition="box-shadow 0.25s ease 0s",this.getConstants().FIELD_TEXTINPUT_BOX_SHADOW&&(o.style.boxShadow="rgba(255, 255, 255, 0.3) 0 0 0 "+4*s+"px")),i.style.borderRadius=n,o.appendChild(i),i.value=i.defaultValue=this.getEditorText_(this.value_),i.setAttribute("data-untyped-default-value",String(this.value_)),this.resizeEditor_(),this.bindInputEvents_(i),i}widgetDispose_(){this.isBeingEdited_=!1,this.isTextValid_=!0,this.forceRerender(),this.onFinishEditing_(this.value_),this.sourceBlock_&&_e()&&null!==this.valueWhenEditorWasOpened_&&this.valueWhenEditorWasOpened_!==this.value_&&(L(new(B(E.BLOCK_CHANGE))(this.sourceBlock_,"field",this.name||null,this.valueWhenEditorWasOpened_,this.value_)),this.valueWhenEditorWasOpened_=null),t.setGroup$$module$build$src$core$events$utils(!1),this.unbindInputEvents_();var e=Is().style;if(e.width="auto",e.height="auto",e.fontSize="",e.transition="",e.boxShadow="",this.htmlInput_=null,!(e=this.getClickTarget_()))throw Error("A click target has not been set.");te(e,"blocklyEditing")}onFinishEditing_(e){}bindInputEvents_(e){this.onKeyDownWrapper=U(e,"keydown",this,this.onHtmlInputKeyDown_),this.onInputWrapper=U(e,"input",this,this.onHtmlInputChange)}unbindInputEvents_(){this.onKeyDownWrapper&&(ne(this.onKeyDownWrapper),this.onKeyDownWrapper=null),this.onInputWrapper&&(ne(this.onInputWrapper),this.onInputWrapper=null)}onHtmlInputKeyDown_(e){if("Enter"===e.key)Ii(this),Kt();else if("Escape"===e.key)this.setValue(this.htmlInput_.getAttribute("data-untyped-default-value"),!1),Ii(this),Kt();else if("Tab"===e.key){e.preventDefault();var o,i=null==(o=this.workspace_)?void 0:o.getCursor();o=s=>(s instanceof un||s instanceof $e&&s.isSimpleReporter())&&s!==this.getSourceBlock(),(e=(e=e.shiftKey?i?.getPreviousNode(this,o,!1):i?.getNextNode(this,o,!1))instanceof $e&&e.isSimpleReporter()?e.getFields().next().value:e)instanceof un&&(Ii(this),Kt(),i=e.getSourceBlock(),e.isFullBlockField()&&i&&i instanceof $e?t.getFocusManager$$module$build$src$core$focus_manager().focusNode(i):t.getFocusManager$$module$build$src$core$focus_manager().focusNode(e),e.showEditor())}}onHtmlInputChange(e){e=this.value_,this.setValue(this.getValueFromEditorText_(this.htmlInput_.value),!1),this.sourceBlock_&&_e()&&this.value_!==e&&L(new(B(E.BLOCK_FIELD_INTERMEDIATE_CHANGE))(this.sourceBlock_,this.name||null,e,this.value_))}setEditorValue_(e,o=!0){this.isDirty_=!0,this.isBeingEdited_&&(this.htmlInput_.value=this.getEditorText_(e)),this.setValue(e,o)}resizeEditor_(){Xt().then(()=>{const e=this.getSourceBlock();if(!e)throw new Me;const o=Is(),i=this.getScaledBBox();o.style.width=i.right-i.left+"px",o.style.height=i.bottom-i.top+"px";const s=i.top;o.style.left=`${e.RTL?i.right-o.offsetWidth:i.left}px`,o.style.top=`${s}px`})}repositionForWindowResize(){let e;const o=null==(e=this.getSourceBlock())?void 0:e.getRootBlock();return o instanceof $e&&(z(this.workspace_,this.workspace_.getMetricsManager().getViewMetrics(!0),o)||this.resizeEditor_(),!0)}getText_(){return this.isBeingEdited_&&this.htmlInput_?this.htmlInput_.value:null}getEditorText_(e){return`${e}`}getValueFromEditorText_(e){return e}};un.BORDERRADIUS=4,t.FieldTextInput$$module$build$src$core$field_textinput=class extends un{constructor(e,o,i){super(e,o,i)}initView(){super.initView(),this.fieldGroup_&&R(this.fieldGroup_,"blocklyTextInputField")}doClassValidation_(e){return void 0===e?null:`${e}`}static fromJson(e){return new this(Ae(e.text),void 0,e)}},Pt("field_input",t.FieldTextInput$$module$build$src$core$field_textinput),t.FieldTextInput$$module$build$src$core$field_textinput.prototype.DEFAULT_VALUE="";var Ig=class extends cd{constructor(e){super(e)}endsWithElemSpacer(){return!1}hasLeftSquareCorner(e){return!!e.outputConnection}hasRightSquareCorner(e){return!!e.outputConnection&&!e.statementInputCount&&!e.nextConnection}},Fc=class extends Rc{constructor(e,o){if(super(e,o),this.connectedBottomNextConnection=!1,this.connectedBlock){for(e=this.connectedBlock;o=e.getNextBlock();)e=o;e.nextConnection||(this.height=this.connectedBlockHeight,this.connectedBottomNextConnection=!0)}}},wg=class extends ao{constructor(e){super(e),this.width=this.height=0,this.type|=_.getType("RIGHT_CONNECTION")}},Ag=class extends gd{constructor(e){super(e)}endsWithElemSpacer(){return!1}hasLeftSquareCorner(e){return!!e.outputConnection||(e.hat?"cap"===e.hat:this.constants_.ADD_START_HATS)&&!e.outputConnection&&!e.previousConnection}hasRightSquareCorner(e){return!!e.outputConnection&&!e.statementInputCount&&!e.nextConnection}},Sg=class extends Pr{constructor(e,o){super(e,o),this.isInline=!0,this.renderer_=e,this.constants_=this.renderer_.getConstants(),this.topRow=new Ag(this.constants_),this.bottomRow=new Ig(this.constants_),this.isMultiRow=!o.getInputsInline()||o.isCollapsed(),this.hasStatementInput=o.statementInputCount>0,this.rightSide=this.outputConnection?new wg(this.constants_):null,this.rightAlignedDummyInputs=new WeakMap}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.adjustXPosition_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}shouldStartNewRow_(e,o){return!!o&&(o instanceof Oo||e instanceof xt||o instanceof xt||(e instanceof t.ValueInput$$module$build$src$core$inputs$value_input||e instanceof lo||e instanceof Oo)&&(!this.isInline||this.isMultiRow))}getDesiredRowWidth_(e){return e.hasStatement?this.width-this.startX-(this.constants_.INSIDE_CORNERS.rightWidth||0):super.getDesiredRowWidth_(e)}getInRowSpacing_(e,o){return e&&o||!this.outputConnection||!this.outputConnection.isDynamicShape||this.hasStatementInput||this.bottomRow.hasNextConnection?!e&&o&&_.isStatementInput(o)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:e&&_.isLeftRoundedCorner(e)&&o&&(_.isPreviousConnection(o)||_.isNextConnection(o))?o.notchOffset-this.constants_.CORNER_RADIUS:e&&_.isLeftSquareCorner(e)&&o&&_.isHat(o)||e&&_.isField(e)&&0===e.width?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:this.constants_.NO_PADDING}getSpacerRowHeight_(e,o){if(_.isTopRow(e)&&_.isBottomRow(o))return this.constants_.EMPTY_BLOCK_SPACER_HEIGHT;const i=_.isInputRow(e)&&e.hasStatement,s=_.isInputRow(o)&&o.hasStatement;return s||i?(e=Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.INSIDE_CORNERS.rightHeight||0),s&&i?Math.max(e,this.constants_.DUMMY_INPUT_MIN_HEIGHT):e):_.isTopRow(e)?e.hasPreviousConnection||this.outputConnection&&!this.hasStatementInput?this.constants_.NO_PADDING:Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):_.isBottomRow(o)?this.outputConnection?!o.hasNextConnection&&this.hasStatementInput?Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):this.constants_.NO_PADDING:Math.max(this.topRow.minHeight,Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.CORNER_RADIUS))-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING}getSpacerRowWidth_(e,o){const i=this.width-this.startX;return _.isInputRow(e)&&e.hasStatement||_.isInputRow(o)&&o.hasStatement?Math.max(i,this.constants_.STATEMENT_INPUT_SPACER_MIN_WIDTH):i}getElemCenterline_(e,o){if(e.hasStatement&&!_.isSpacer(o)&&!_.isStatementInput(o))return e.yPos+this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT/2;if(_.isInlineInput(o)){const i=o.connectedBlock;if(i&&i.outputConnection&&i.nextConnection)return e.yPos+i.height/2}return super.getElemCenterline_(e,o)}addInput_(e,o){if((e instanceof lo||e instanceof Oo)&&o.hasDummyInput&&o.align===t.Align$$module$build$src$core$inputs$align.LEFT&&e.align===t.Align$$module$build$src$core$inputs$align.RIGHT)this.rightAlignedDummyInputs.set(o,e);else if(e instanceof xt)return o.elements.push(new Fc(this.constants_,e)),o.hasStatement=!0,void(null===o.align&&(o.align=e.align));super.addInput_(e,o)}addAlignmentPadding_(e,o){if(this.rightAlignedDummyInputs.get(e)){let i;for(let s=0;s<e.elements.length;s++){const n=e.elements[s];if(_.isSpacer(n)&&(i=n),_.isField(n)&&n.parentInput===this.rightAlignedDummyInputs.get(e))break}if(i)return i.width+=o,void(e.width+=o)}super.addAlignmentPadding_(e,o)}adjustXPosition_(){const e=this.constants_.NOTCH_OFFSET_LEFT+this.constants_.NOTCH_WIDTH;let o=e;for(let n=2;n<this.rows.length-1;n+=2){var i=this.rows[n-1];const l=this.rows[n];var s=this.rows[n+1];if(i=2===n?!!this.topRow.hasPreviousConnection:!!i.followsStatement,s=n+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!s.precedesStatement,_.isInputRow(l)&&l.hasStatement){let h,$;l.measure(),o=l.width-(null!=($=null==(h=l.getLastInput())?void 0:h.width)?$:0)+e}else if(i&&(2===n||s)&&_.isInputRow(l)&&!l.hasStatement){s=l.xPos,i=null;for(let h=0;h<l.elements.length;h++){const $=l.elements[h];_.isSpacer($)&&(i=$),!(i&&(_.isField($)||_.isInput($))&&s<o)||_.isField($)&&($.field instanceof zi||$.field instanceof Ji)||(i.width+=o-s),s+=$.width}}}}finalizeOutputConnection_(){if(this.outputConnection&&this.outputConnection.isDynamicShape){var e=this.outputConnection.shape;if("isDynamic"in e&&e.isDynamic){for(var o=0,i=0;i<this.rows.length;i++){const s=this.rows[i];s.yPos=o,o+=s.height}this.height=o,o=e.height(i=this.bottomRow.hasNextConnection?this.height-this.bottomRow.descenderHeight:this.height),i=e.width(i),this.outputConnection.height=o,this.outputConnection.width=i,this.outputConnection.startX=i,this.outputConnection.connectionOffsetY=e.connectionOffsetY(o),this.outputConnection.connectionOffsetX=e.connectionOffsetX(i),e=0,this.hasStatementInput||this.bottomRow.hasNextConnection||(e=i,this.rightSide.height=o,this.rightSide.width=e,this.rightSide.centerline=o/2,this.rightSide.xPos=this.width+e),this.startX=i,this.width+=i+e,this.widthWithChildren+=i+e}}}finalizeHorizontalAlignment_(){if(this.outputConnection&&!this.hasStatementInput&&!this.bottomRow.hasNextConnection){for(var e=0,o=0;o<this.rows.length;o++){var i=this.rows[o];if(!_.isInputRow(i))continue;e=i.elements[i.elements.length-2];let s=this.getNegativeSpacing_(i.elements[1]),n=this.getNegativeSpacing_(e);const l=this.constants_.MIN_BLOCK_WIDTH+2*this.outputConnection.width;this.width-(e=s+n)<l&&(s=(e=this.width-l)/2,n=e/2),i.elements.unshift(new Ct(this.constants_,-s)),i.elements.push(new Ct(this.constants_,-n))}if(e)for(this.width-=e,this.widthWithChildren-=e,this.rightSide.xPos-=e,o=0;o<this.rows.length;o++)_.isTopOrBottomRow(i=this.rows[o])&&(i.elements[1].width-=e),i.width-=e,i.widthWithConnectedBlocks-=e}}getNegativeSpacing_(e){if(!e||!this.outputConnection)return 0;const o=this.outputConnection.width;var i=this.outputConnection.shape.type;const s=this.constants_;if(this.inputRows.length>1)return i===s.SHAPES.ROUND?o-(i=this.height/2>(i=this.constants_.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH)?i:this.height/2)*(1-Math.sin(Math.acos((i-this.constants_.SMALL_PADDING)/i))):0;if(_.isInlineInput(e)){const n=e.connectedBlock;return null==(e=n?n.pathObject.outputShapeType:e.shape.type)||n&&n.outputConnection&&(n.statementInputCount||n.nextConnection)||i===s.SHAPES.HEXAGONAL&&i!==e?0:o-this.constants_.SHAPE_IN_SHAPE_PADDING[i][e]}return _.isField(e)?i===s.SHAPES.ROUND&&e.field instanceof t.FieldTextInput$$module$build$src$core$field_textinput?o-2.75*s.GRID_UNIT:o-this.constants_.SHAPE_IN_SHAPE_PADDING[i][0]:_.isIcon(e)?this.constants_.SMALL_PADDING:0}finalizeVerticalAlignment_(){if(!this.outputConnection)for(let s=2;s<this.rows.length-1;s+=2){const n=this.rows[s-1],l=this.rows[s],h=this.rows[s+1];var e=2===s,o=s+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!h.precedesStatement;if(e?this.topRow.hasPreviousConnection:n.followsStatement){var i=l.elements[1];if(i=3===l.elements.length&&i instanceof ud&&(i.field instanceof zi||i.field instanceof Ji),!e&&i)n.height-=this.constants_.SMALL_PADDING,h.height-=this.constants_.SMALL_PADDING,l.height-=this.constants_.MEDIUM_PADDING;else if(e||o){if(o){for(e=!1,o=0;o<l.elements.length;o++)if(_.isInlineInput(i=l.elements[o])&&i.connectedBlock&&!i.connectedBlock.isShadow()&&i.connectedBlock.getHeightWidth().height>=40){e=!0;break}e&&(n.height-=this.constants_.SMALL_PADDING,h.height-=this.constants_.SMALL_PADDING)}}else n.height+=this.constants_.SMALL_PADDING}}}finalize_(){this.finalizeOutputConnection_(),this.finalizeHorizontalAlignment_(),this.finalizeVerticalAlignment_(),super.finalize_(),this.rightSide&&(this.widthWithChildren+=this.rightSide.width)}},Og=class extends Dc{constructor(e,o,i){super(e,o,i),this.svgPathSelected=null,this.outlines=new Map,this.remainingOutlines=new Set,this.outputShapeType=null,this.constants=i}setPath(e){super.setPath(e),this.svgPathSelected&&this.svgPathSelected.setAttribute("d",e)}applyColour(e){super.applyColour(e);const o=e.getParent();e.isShadow()&&o&&this.svgPath.setAttribute("stroke",o.getColourTertiary());for(const i of this.outlines.values())i.setAttribute("fill",this.style.colourTertiary)}flipRTL(){super.flipRTL();for(const e of this.outlines.values())e.setAttribute("transform","scale(-1 1)")}updateSelected(e){this.setClass_("blocklySelected",e),e?this.svgPathSelected||(this.svgPathSelected=this.svgPath.cloneNode(!0),this.svgPathSelected.classList.add("blocklyPathSelected"),te(this.svgPathSelected,tt.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME),te(this.svgPathSelected,tt.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME),this.svgPathSelected.removeAttribute("tabindex"),this.svgPathSelected.removeAttribute("id"),this.svgRoot.appendChild(this.svgPathSelected)):this.svgPathSelected&&(this.svgRoot.removeChild(this.svgPathSelected),this.svgPathSelected=null)}updateReplacementFade(e){this.setClass_("blocklyReplaceable",e)}updateShapeForInputHighlight(e,o){e=e.getParentInput().name,(e=this.getOutlinePath(e))&&(o?e.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):e.removeAttribute("filter"))}beginDrawing(){this.remainingOutlines.clear();for(const e of this.outlines.keys())this.remainingOutlines.add(e)}endDrawing(){if(this.remainingOutlines.size)for(const e of this.remainingOutlines)this.removeOutlinePath(e);this.remainingOutlines.clear()}setOutlinePath(e,o){(e=this.getOutlinePath(e)).setAttribute("d",o),e.setAttribute("fill",this.style.colourTertiary)}getOutlinePath(e){return this.outlines.has(e)||this.outlines.set(e,I(v.PATH,{class:"blocklyOutlinePath",d:""},this.svgRoot)),this.remainingOutlines.delete(e),this.outlines.get(e)}removeOutlinePath(e){let o,i;null==(o=this.outlines.get(e))||null==(i=o.parentNode)||i.removeChild(this.outlines.get(e)),this.outlines.delete(e)}},Cd=class extends Lc{constructor(e){super(e)}makeConstants_(){return new Cg}makeRenderInfo_(e){return new Sg(this,e)}makeDrawer_(e,o){return new kg(e,o)}makePathObject(e,o){return new Og(e,o,this.getConstants())}getConstants(){return this.constants_}};ko("zelos",Cd);var Rg=class{constructor(e){this.staticConn=this.draggedConn=this.markerConn=this.fadedBlock=null,this.workspace=e.workspace}previewReplacement(e,o,i){t.disable$$module$build$src$core$events$utils();try{this.hidePreview(),this.fadedBlock=i,i.fadeForReplacement(!0),this.workspace.getRenderer().shouldHighlightConnection(o)&&(o.highlight(),this.staticConn=o)}finally{t.enable$$module$build$src$core$events$utils()}}previewConnection(e,o){if(e!==this.draggedConn||o!==this.staticConn){t.disable$$module$build$src$core$events$utils();try{this.hidePreview(),this.shouldUseMarkerPreview(e,o)&&(this.markerConn=this.previewMarker(e,o)),this.workspace.getRenderer().shouldHighlightConnection(o)&&o.highlight(),this.draggedConn=e,this.staticConn=o}finally{t.enable$$module$build$src$core$events$utils()}}}shouldUseMarkerPreview(e,o){return o.type===N.PREVIOUS_STATEMENT||o.type===N.NEXT_STATEMENT||!(this.workspace.getRenderer()instanceof Cd)}previewMarker(e,o){const i=e.getSourceBlock(),s=this.createInsertionMarker(i),n=this.getMatchingConnection(i,s,e);if(!n)return null;s.queueRender(),Wo(),n.connect(o);const l={x:o.x-n.x,y:o.y-n.y},h=n.getOffsetInBlock().clone();return Xt().then(()=>{if(!s.isDeadOrDying()){t.disable$$module$build$src$core$events$utils();try{s?.positionNearConnection(n,l,h),s?.getSvgRoot().setAttribute("visibility","visible")}finally{t.enable$$module$build$src$core$events$utils()}}}),n}createInsertionMarker(e){const o=Tt(e,{addCoordinates:!1,addInputBlocks:!1,addNextBlocks:!1,doFullSerialization:!1});if(!o)throw Error(`Failed to serialize source block. ${e.toDevString()}`);e=zo(o,this.workspace);for(const i of e.getDescendants(!1))i.setInsertionMarker(!0);return e.initSvg(),e.getSvgRoot().setAttribute("visibility","hidden"),e}getMatchingConnection(e,o,i){if(e=e.getConnections_(!0),o=o.getConnections_(!0),e.length!==o.length)return null;for(let s=0;s<e.length;s++)if(e[s]===i)return o[s];return null}hidePreview(){t.disable$$module$build$src$core$events$utils();try{this.staticConn&&(this.staticConn.unhighlight(),this.staticConn=null),this.fadedBlock&&(this.fadedBlock.fadeForReplacement(!1),this.fadedBlock=null),this.markerConn&&(this.hideInsertionMarker(this.markerConn),this.draggedConn=this.markerConn=null)}finally{t.enable$$module$build$src$core$events$utils()}}hideInsertionMarker(e){const o=e.getSourceBlock(),i=o.outputConnection;let s;if(null!=(s=o.previousConnection)&&s.targetConnection||null!=i&&i.targetConnection)o.unplug(!0);else{let n;null==(n=e.targetBlock())||n.unplug(!1)}o.dispose()}dispose(){this.hidePreview()}};D(w.CONNECTION_PREVIEWER,vt,Rg);var Qi={};Qi.Align=t.Align$$module$build$src$core$inputs$align,Qi.DummyInput=lo,Qi.EndRowInput=Oo,Qi.Input=sn,Qi.StatementInput=xt,Qi.ValueInput=t.ValueInput$$module$build$src$core$inputs$value_input,Qi.inputTypes=t.inputTypes$$module$build$src$core$inputs$input_types;var H$=!1;t.CodeGenerator$$module$build$src$core$generator=class{constructor(e){this.forBlock=Object.create(null),this.FUNCTION_NAME_PLACEHOLDER_="{leCUI8hutHZI4480Dc}",this.STATEMENT_SUFFIX=this.STATEMENT_PREFIX=this.INFINITE_LOOP_TRAP=null,this.INDENT="  ",this.COMMENT_WRAP=60,this.ORDER_OVERRIDES=[],this.isInitialized=null,this.RESERVED_WORDS_="",this.definitions_=Object.create(null),this.functionNames_=Object.create(null),this.nameDB_=void 0,this.name_=e,this.FUNCTION_NAME_PLACEHOLDER_REGEXP_=new RegExp(this.FUNCTION_NAME_PLACEHOLDER_,"g")}workspaceToCode(e){e||(console.warn("No workspace specified in workspaceToCode call.  Guessing."),e=bt());var o=[];this.init(e),e=e.getTopBlocks(!0);for(let s,i=0;s=e[i];i++){let n=this.blockToCode(s);Array.isArray(n)&&(n=n[0]),n&&(s.outputConnection&&(n=this.scrubNakedValue(n),this.STATEMENT_PREFIX&&!s.suppressPrefixSuffix&&(n=this.injectId(this.STATEMENT_PREFIX,s)+n),this.STATEMENT_SUFFIX&&!s.suppressPrefixSuffix&&(n+=this.injectId(this.STATEMENT_SUFFIX,s))),o.push(n))}return o=o.join("\n"),(o=(o=(o=this.finish(o)).replace(/^\s+\n/,"")).replace(/\n\s+$/,"\n")).replace(/[ \t]+\n/g,"\n")}prefixLines(e,o){return o+e.replace(/(?!\n$)\n/g,"\n"+o)}allNestedComments(e){const o=[];e=e.getDescendants(!0);for(let i=0;i<e.length;i++){const s=e[i].getCommentText();s&&o.push(s)}return o.length&&o.push(""),o.join("\n")}blockToCode(e,o){if(!1===this.isInitialized&&console.warn("CodeGenerator init was not called before blockToCode was called."),!e)return"";if(!e.isEnabled())return o?"":this.blockToCode(e.getNextBlock());if(e.isInsertionMarker())return o?"":this.blockToCode(e.getChildren(!1)[0]);var i=this.forBlock[e.type];if("function"!=typeof i)throw Error(`${this.name_} generator does not know how to generate code for block type "${e.type}".`);if(i=i.call(e,e,this),Array.isArray(i)){if(!e.outputConnection)throw TypeError("Expecting string from statement block: "+e.type);return[this.scrub_(e,i[0],o),i[1]]}if("string"==typeof i)return this.STATEMENT_PREFIX&&!e.suppressPrefixSuffix&&(i=this.injectId(this.STATEMENT_PREFIX,e)+i),this.STATEMENT_SUFFIX&&!e.suppressPrefixSuffix&&(i+=this.injectId(this.STATEMENT_SUFFIX,e)),this.scrub_(e,i,o);if(null===i)return"";throw SyntaxError("Invalid code generated: "+i)}valueToCode(e,o,i){if(isNaN(i))throw TypeError("Expecting valid order from block: "+e.type);var s=e.getInputTargetBlock(o);if(!s&&!e.getInput(o))throw ReferenceError(`Input "${o}" doesn't exist on "${e.type}"`);if(!s||""===(o=this.blockToCode(s)))return"";if(!Array.isArray(o))throw TypeError(`Expecting tuple from value block: ${s.type} See developers.google.com/blockly/guides/create-custom-blocks/generating-code for more information`);if(e=o[0],o=o[1],isNaN(o))throw TypeError("Expecting valid order from value block: "+s.type);if(!e)return"";s=!1;var n=Math.floor(i);const l=Math.floor(o);if(n<=l&&(n!==l||0!==n&&99!==n))for(s=!0,n=0;n<this.ORDER_OVERRIDES.length;n++)if(this.ORDER_OVERRIDES[n][0]===i&&this.ORDER_OVERRIDES[n][1]===o){s=!1;break}return s&&(e="("+e+")"),e}statementToCode(e,o){const i=e.getInputTargetBlock(o);if(!i&&!e.getInput(o))throw ReferenceError(`Input "${o}" doesn't exist on "${e.type}"`);if("string"!=typeof(e=this.blockToCode(i)))throw TypeError("Expecting code from statement block: "+(i&&i.type));return e&&(e=this.prefixLines(e,this.INDENT)),e}addLoopTrap(e,o){return this.INFINITE_LOOP_TRAP&&(e=this.prefixLines(this.injectId(this.INFINITE_LOOP_TRAP,o),this.INDENT)+e),this.STATEMENT_SUFFIX&&!o.suppressPrefixSuffix&&(e=this.prefixLines(this.injectId(this.STATEMENT_SUFFIX,o),this.INDENT)+e),this.STATEMENT_PREFIX&&!o.suppressPrefixSuffix&&(e+=this.prefixLines(this.injectId(this.STATEMENT_PREFIX,o),this.INDENT)),e}injectId(e,o){return o=o.id.replace(/\$/g,"$$$$"),e.replace(/%1/g,"'"+o+"'")}addReservedWords(e){this.RESERVED_WORDS_+=e+","}provideFunction_(e,o){if(!this.definitions_[e]){const i=this.nameDB_.getDistinctName(e,t.NameType$$module$build$src$core$names.PROCEDURE);let s;for(this.functionNames_[e]=i,Array.isArray(o)&&(o=o.join("\n")),o=o.trim().replace(this.FUNCTION_NAME_PLACEHOLDER_REGEXP_,i);s!==o;)s=o,o=o.replace(/^(( {2})*) {2}/gm,"$1\0");o=o.replace(/\0/g,this.INDENT),this.definitions_[e]=o}return this.functionNames_[e]}getVariableName(e){return this.getName(e,t.NameType$$module$build$src$core$names.VARIABLE)}getProcedureName(e){return this.getName(e,t.NameType$$module$build$src$core$names.PROCEDURE)}getName(e,o){if(!this.nameDB_)throw Error("Name database is not defined. You must initialize `nameDB_` in your generator class and call `init` first.");return this.nameDB_.getName(e,o)}init(e){this.definitions_=Object.create(null),this.functionNames_=Object.create(null)}scrub_(e,o,i){return o}finish(e){return this.definitions_=Object.create(null),this.functionNames_=Object.create(null),e}scrubNakedValue(e){return e}};var kd=class extends Ic{constructor(e){super(e)}setMetrics_(e){if(this.isVisible()){var o=this.workspace_.getMetricsManager(),i=o.getScrollMetrics(),s=o.getViewMetrics();o=o.getAbsoluteMetrics(),"number"==typeof e.y&&(this.workspace_.scrollY=-(i.top+(i.height-s.height)*e.y)),this.workspace_.translate(this.workspace_.scrollX+o.left,this.workspace_.scrollY+o.top)}}getX(){if(!this.isVisible())return 0;var e=this.targetWorkspace.getMetricsManager();const o=e.getAbsoluteMetrics(),i=e.getViewMetrics();return e=e.getToolboxMetrics(),this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?this.toolboxPosition_===j.LEFT?e.width:i.width-this.getWidth():this.toolboxPosition_===j.LEFT?0:i.width:this.toolboxPosition_===j.LEFT?0:i.width+o.left-this.getWidth()}getY(){return 0}position(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var e=this.targetWorkspace.getMetricsManager().getViewMetrics();this.height_=e.height;var o=this.getWidth()-this.CORNER_RADIUS;this.setBackgroundPath(o,e.height-2*this.CORNER_RADIUS),e=this.getX(),o=this.getY(),this.positionAt_(this.getWidth(),this.getHeight(),e,o)}}setBackgroundPath(e,o){const i=this.toolboxPosition_===j.RIGHT;var s=e+this.CORNER_RADIUS;(s=["M "+(i?s:0)+",0"]).push("h",i?-e:e),s.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,i?0:1,i?-this.CORNER_RADIUS:this.CORNER_RADIUS,this.CORNER_RADIUS),s.push("v",Math.max(0,o)),s.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,i?0:1,i?this.CORNER_RADIUS:-this.CORNER_RADIUS,this.CORNER_RADIUS),s.push("h",i?e:-e),s.push("z"),this.svgBackground_.setAttribute("d",s.join(" "))}scrollToStart(){let e;null==(e=this.workspace_.scrollbar)||e.setY(0)}wheel_(e){var o=Uo(e);if(o.y){const i=this.workspace_.getMetricsManager(),s=i.getScrollMetrics();let n;o=i.getViewMetrics().top-s.top+o.y,null==(n=this.workspace_.scrollbar)||n.setY(o),Gn(this.workspace_),Kt()}e.preventDefault(),e.stopPropagation()}layout_(e){this.workspace_.scale=this.targetWorkspace.scale;var o=this.MARGIN;const i=this.RTL?o:o+this.tabWidth_;for(const s of e)s.getElement().moveBy(i,o),o+=s.getElement().getBoundingRectangle().getHeight()}isDragTowardWorkspace(e){e=Math.atan2(e.y,e.x)/Math.PI*180;const o=this.dragAngleRange_;return e<o&&e>-o||e<-180+o||e>180-o}getClientRect(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;const e=this.svgGroup_.getBoundingClientRect(),o=e.left;return this.toolboxPosition_===j.LEFT?new Q(-1e9,1e9,-1e9,o+e.width):new Q(-1e9,1e9,o,1e9)}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();let e=this.getContents().reduce((o,i)=>Math.max(o,i.getElement().getBoundingRectangle().getWidth()),0);if(e+=1.5*this.MARGIN+this.tabWidth_,e*=this.workspace_.scale,e+=Oe.scrollbarThickness,this.getWidth()!==e){if(this.RTL)for(const o of this.getContents()){const i=o.getElement().getBoundingRectangle().left,s=e/this.workspace_.scale-o.getElement().getBoundingRectangle().getWidth()-this.MARGIN-this.tabWidth_;o.getElement().moveBy(s-i,0)}this.targetWorkspace.scrollbar||this.autoClose||this.targetWorkspace.getFlyout()!==this||this.toolboxPosition_!==j.LEFT||this.targetWorkspace.translate(this.targetWorkspace.scrollX+e,this.targetWorkspace.scrollY),this.width_=e,this.position(),this.targetWorkspace.resizeContents(),this.targetWorkspace.recordDragTargets()}}};kd.registryName="verticalFlyout",D(w.FLYOUTS_VERTICAL_TOOLBOX,vt,kd);var Mg=class extends Ic{constructor(e){super(e),this.horizontalLayout=!0}setMetrics_(e){if(this.isVisible()){var o=this.workspace_.getMetricsManager(),i=o.getScrollMetrics(),s=o.getViewMetrics();o=o.getAbsoluteMetrics(),"number"==typeof e.x&&(this.workspace_.scrollX=-(i.left+(i.width-s.width)*e.x)),this.workspace_.translate(this.workspace_.scrollX+o.left,this.workspace_.scrollY+o.top)}}getX(){return 0}getY(){if(!this.isVisible())return 0;var e=this.targetWorkspace.getMetricsManager();const o=e.getAbsoluteMetrics(),i=e.getViewMetrics();e=e.getToolboxMetrics();const s=this.toolboxPosition_===j.TOP;return this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?s?e.height:i.height-this.getHeight():s?0:i.height:s?0:i.height+o.top-this.getHeight()}position(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var e=this.targetWorkspace.getMetricsManager().getViewMetrics();this.width_=e.width,e=e.width-2*this.CORNER_RADIUS;var o=this.getHeight()-this.CORNER_RADIUS;this.setBackgroundPath(e,o),e=this.getX(),o=this.getY(),this.positionAt_(this.getWidth(),this.getHeight(),e,o)}}setBackgroundPath(e,o){const i=this.toolboxPosition_===j.TOP,s=["M 0,"+(i?0:this.CORNER_RADIUS)];i?(s.push("h",e+2*this.CORNER_RADIUS),s.push("v",o),s.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,this.CORNER_RADIUS),s.push("h",-e),s.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,-this.CORNER_RADIUS)):(s.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,-this.CORNER_RADIUS),s.push("h",e),s.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,this.CORNER_RADIUS),s.push("v",o),s.push("h",-e-2*this.CORNER_RADIUS)),s.push("z"),this.svgBackground_.setAttribute("d",s.join(" "))}scrollToStart(){let e;null==(e=this.workspace_.scrollbar)||e.setX(this.RTL?1/0:0)}wheel_(e){var o=Uo(e);if(o=o.x||o.y){const i=this.workspace_.getMetricsManager(),s=i.getScrollMetrics();let n;o=i.getViewMetrics().left-s.left+o,null==(n=this.workspace_.scrollbar)||n.setX(o),Gn(this.workspace_),Kt()}e.preventDefault(),e.stopPropagation()}layout_(e){this.workspace_.scale=this.targetWorkspace.scale;const o=this.MARGIN;let i=o+this.tabWidth_;this.RTL&&(e=e.reverse());for(const s of e)e=s.getElement().getBoundingRectangle(),e=this.RTL?i+e.getWidth():i,s.getElement().moveBy(e,o),i+=s.getElement().getBoundingRectangle().getWidth()}isDragTowardWorkspace(e){e=Math.atan2(e.y,e.x)/Math.PI*180;const o=this.dragAngleRange_;return e<90+o&&e>90-o||e>-90-o&&e<-90+o}getClientRect(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;const e=this.svgGroup_.getBoundingClientRect(),o=e.top;return this.toolboxPosition_===j.TOP?new Q(-1e9,o+e.height,-1e9,1e9):new Q(o,1e9,-1e9,1e9)}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();let e=this.getContents().reduce((o,i)=>Math.max(o,i.getElement().getBoundingRectangle().getHeight()),0);e+=1.5*this.MARGIN,e*=this.workspace_.scale,e+=Oe.scrollbarThickness,this.getHeight()!==e&&(this.targetWorkspace.scrollbar||this.autoClose||this.targetWorkspace.getFlyout()!==this||this.toolboxPosition_!==j.TOP||this.targetWorkspace.translate(this.targetWorkspace.scrollX,this.targetWorkspace.scrollY+e),this.height_=e,this.position(),this.targetWorkspace.resizeContents(),this.targetWorkspace.recordDragTargets())}};D(w.FLYOUTS_HORIZONTAL_TOOLBOX,vt,Mg);var Zr=class extends ot{constructor(e,o,i,s,n){super(ue.SKIP_SETUP),this.defaultType="",this.variableTypes=[],this.variable=null,this.SERIALIZABLE=!0,this.menuGenerator_=Zr.dropdownCreate,this.defaultVariableName="string"==typeof e?e:"",this.size_=new ee(0,0),e!==ue.SKIP_SETUP&&(n?this.configure_(n):this.setTypes(i,s),o&&this.setValidator(o))}configure_(e){super.configure_(e),this.setTypes(e.variableTypes,e.defaultType)}initModel(){var e=this.getSourceBlock();if(!e)throw new Me;this.variable||(e=t.getOrCreateVariablePackage$$module$build$src$core$variables(e.workspace,null,this.defaultVariableName,this.defaultType),this.doValueUpdate_(e.getId()))}initView(){super.initView(),R(this.fieldGroup_,"blocklyVariableField")}shouldAddBorderRect_(){const e=this.getSourceBlock();if(!e)throw new Me;return super.shouldAddBorderRect_()&&(!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||"variables_get"!==e.type)}fromXml(e){var o=this.getSourceBlock();if(!o)throw new Me;const i=e.getAttribute("id"),s=e.textContent,n=e.getAttribute("variabletype")||e.getAttribute("variableType")||"";if(o=t.getOrCreateVariablePackage$$module$build$src$core$variables(o.workspace,i,s,n),null!==n&&n!==o.getType())throw Error("Serialized variable type with id '"+o.getId()+"' had type "+o.getType()+", and does not match variable field that references it: "+Bt(e)+".");this.setValue(o.getId())}toXml(e){return this.initModel(),e.id=this.variable.getId(),e.textContent=this.variable.getName(),this.variable.getType()&&e.setAttribute("variabletype",this.variable.getType()),e}saveState(e){var o=this.saveLegacyState(Zr);return null!==o||(this.initModel(),o={id:this.variable.getId()},e&&(o.name=this.variable.getName(),o.type=this.variable.getType())),o}loadState(e){const o=this.getSourceBlock();if(!o)throw new Me;this.loadLegacyState(Zr,e)||(e=t.getOrCreateVariablePackage$$module$build$src$core$variables(o.workspace,e.id||null,e.name,e.type||""),this.setValue(e.getId()))}setSourceBlock(e){if(e.isShadow())throw Error("Variable fields are not allowed to exist on shadow blocks.");super.setSourceBlock(e)}getValue(){return this.variable?this.variable.getId():null}getText(){return this.variable?this.variable.getName():""}getVariable(){return this.variable}getDefaultType(){return this.defaultType}getValidator(){return this.variable?this.validator_:null}doClassValidation_(e){if(null===e)return null;var o=this.getSourceBlock();if(!o)throw new Me;return(o=t.getVariable$$module$build$src$core$variables(o.workspace,e))?(o=o.getType(),this.typeIsAllowed(o)?e:(console.warn("Variable type doesn't match this field!  Type was "+o),null)):(console.warn("Variable id doesn't point to a real variable! ID was "+e),null)}doValueUpdate_(e){const o=this.getSourceBlock();if(!o)throw new Me;this.variable=t.getVariable$$module$build$src$core$variables(o.workspace,e),super.doValueUpdate_(e)}typeIsAllowed(e){const o=this.getVariableTypes();if(!o)return!0;for(let i=0;i<o.length;i++)if(e===o[i])return!0;return!1}getVariableTypes(){if(this.variableTypes)return this.variableTypes;if(!this.sourceBlock_||this.sourceBlock_.isDeadOrDying())return[""];let e=this.sourceBlock_.workspace.getVariableMap().getTypes();if(this.sourceBlock_.isInFlyout){const o=this.sourceBlock_.workspace.getPotentialVariableMap();if(!o)return e;e=Array.from(new Set([...e,...o.getTypes()]))}return e}setTypes(e=null,o=""){var i=this.getText();if(Array.isArray(e)){if(0===e.length)throw Error(`'variableTypes' of field variable ${i} was an empty list. If you want to include all variable types, pass 'null' instead.`);i=!1;for(let s=0;s<e.length;s++)e[s]===o&&(i=!0);if(!i)throw Error("Invalid default type '"+o+"' in the definition of a FieldVariable")}else if(null!==e)throw Error(`'variableTypes' was not an array or null in the definition of FieldVariable ${i}`);this.defaultType=o,this.variableTypes=e}refreshVariableName(){this.forceRerender()}onItemSelected_(e,o){if(e=o.getValue(),this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()){if(e===Ec&&this.variable)return void t.renameVariable$$module$build$src$core$variables(this.sourceBlock_.workspace,this.variable);if(e===vc&&this.variable)return e=this.variable.getWorkspace(),void t.deleteVariable$$module$build$src$core$variables(e,this.variable,this.sourceBlock_)}this.setValue(e)}referencesVariables(){return!0}static fromJson(e){return new this(Ae(e.variable),void 0,void 0,void 0,e)}static dropdownCreate(){if(!this.variable)throw Error("Tried to call dropdownCreate on a variable field with no variable selected.");const e=this.getText();let o=[];var i=this.getSourceBlock();if(i&&!i.isDeadOrDying()){i=i.workspace;const l=this.getVariableTypes();for(let h=0;h<l.length;h++){const $=l[h],k=i.getVariableMap().getVariablesOfType($);if(o=o.concat(k),i.isFlyout){var s=void 0,n=void 0;o=o.concat(null!=(n=null==(s=i.getPotentialVariableMap())?void 0:s.getVariablesOfType($))?n:[])}}}for(o.sort(Ts),s=[],n=0;n<o.length;n++)s[n]=[o[n].getName(),o[n].getId()];return s.push([t.Msg$$module$build$src$core$msg.RENAME_VARIABLE,Ec]),t.Msg$$module$build$src$core$msg.DELETE_VARIABLE&&s.push([t.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",e),vc]),s}};Pt("field_variable",Zr);var Id=class extends un{constructor(e,o,i,s,n,l){super(ue.SKIP_SETUP),this.min_=-1/0,this.max_=1/0,this.precision_=0,this.decimalPlaces=null,this.spellcheck_=!1,e!==ue.SKIP_SETUP&&(l?this.configure_(l):this.setConstraints(o,i,s),this.setValue(e),n&&this.setValidator(n))}configure_(e){super.configure_(e),this.setMinInternal(e.min),this.setMaxInternal(e.max),this.setPrecisionInternal(e.precision)}setConstraints(e,o,i){this.setMinInternal(e),this.setMaxInternal(o),this.setPrecisionInternal(i),this.setValue(this.getValue())}setMin(e){this.setMinInternal(e),this.setValue(this.getValue())}setMinInternal(e){null==e?this.min_=-1/0:(e=Number(e),isNaN(e)||(this.min_=e))}getMin(){return this.min_}setMax(e){this.setMaxInternal(e),this.setValue(this.getValue())}setMaxInternal(e){null==e?this.max_=1/0:(e=Number(e),isNaN(e)||(this.max_=e))}getMax(){return this.max_}setPrecision(e){this.setPrecisionInternal(e),this.setValue(this.getValue())}setPrecisionInternal(e){this.precision_=Number(e)||0;let o=String(this.precision_);o.includes("e")&&(o=this.precision_.toLocaleString("en-US",{maximumFractionDigits:20}));const i=o.indexOf(".");this.decimalPlaces=-1===i?e?0:null:o.length-i-1}getPrecision(){return this.precision_}doClassValidation_(e){return null===e||(e=(e=(e=`${e}`.replace(/O/gi,"0")).replace(/,/g,"")).replace(/infinity/i,"Infinity"),e=Number(e||0),isNaN(e))?null:(e=Math.min(Math.max(e,this.min_),this.max_),this.precision_&&isFinite(e)&&(e=Math.round(e/this.precision_)*this.precision_),null!==this.decimalPlaces&&(e=Number(e.toFixed(this.decimalPlaces))),e)}widgetCreate_(){const e=super.widgetCreate_();return this.min_>-1/0&&(e.min=`${this.min_}`,De(e,Fe.VALUEMIN,this.min_)),this.max_<1/0&&(e.max=`${this.max_}`,De(e,Fe.VALUEMAX,this.max_)),e}initView(){super.initView(),this.fieldGroup_&&R(this.fieldGroup_,"blocklyNumberField")}static fromJson(e){return new this(e.value,void 0,void 0,void 0,void 0,e)}};Pt("field_number",Id),Id.prototype.DEFAULT_VALUE=0;var Ng=class extends zi{constructor(e,o,i){super(String(e??""),o,i),this.EDITABLE=!1,this.SERIALIZABLE=!0}static fromJson(e){return new this(Ae(e.text),void 0,e)}};Pt("field_label_serializable",Ng);var es=class extends ue{constructor(e,o,i){super(ue.SKIP_SETUP),this.SERIALIZABLE=!0,this.value_=this.value_,this.checkChar=es.CHECK_CHAR,e!==ue.SKIP_SETUP&&(i&&this.configure_(i),this.setValue(e),o&&this.setValidator(o))}configure_(e){super.configure_(e),e.checkCharacter&&(this.checkChar=e.checkCharacter)}saveState(){const e=this.saveLegacyState(es);return null!==e?e:this.getValueBoolean()}initView(){super.initView();const e=this.getTextElement();R(this.fieldGroup_,"blocklyCheckboxField"),e.style.display=this.value_?"block":"none"}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_(this.getConstants().FIELD_CHECKBOX_X_OFFSET)}getDisplayText_(){return this.checkChar}setCheckCharacter(e){this.checkChar=e||es.CHECK_CHAR,this.forceRerender()}showEditor_(){this.setValue(!this.value_)}doClassValidation_(e){return!0===e||"TRUE"===e?"TRUE":!1===e||"FALSE"===e?"FALSE":null}doValueUpdate_(e){this.value_=this.convertValueToBool(e),this.textElement_&&(this.textElement_.style.display=this.value_?"block":"none")}getValue(){return this.value_?"TRUE":"FALSE"}getValueBoolean(){return this.value_}getText(){return String(this.convertValueToBool(this.value_))}convertValueToBool(e){return"string"==typeof e?"TRUE"===e:!!e}static fromJson(e){return new this(e.checked,void 0,e)}};es.CHECK_CHAR="\u2713",Pt("field_checkbox",es),es.prototype.DEFAULT_VALUE=!1;var Dg=class{constructor(e,o){this.draggable=e,this.workspace=o,this.dragTarget=null,this.startLoc=e.getRelativeToSurfaceXY()}onDragStart(e){t.getGroup$$module$build$src$core$events$utils()||t.setGroup$$module$build$src$core$events$utils(!0),this.draggable.startDrag(e)}onDrag(e,o){this.moveDraggable(e,o),o=this.getRoot(this.draggable),le(o)&&o.setDeleteStyle(this.wouldDeleteDraggable(e,o)),this.updateDragTarget(e)}updateDragTarget(e){e=this.workspace.getDragTarget(e);const o=this.getRoot(this.draggable);if(this.dragTarget!==e){let i;null==(i=this.dragTarget)||i.onDragExit(o),e?.onDragEnter(o)}e?.onDragOver(o),this.dragTarget=e}moveDraggable(e,o){o=this.pixelsToWorkspaceUnits(o),o=A.sum(this.startLoc,o),this.draggable.drag(o,e)}wouldDeleteDraggable(e,o){return!(!(e=this.workspace.getDragTarget(e))||!this.workspace.getComponentManager().hasCapability(e.id,xe.Capability.DELETE_AREA))&&e.wouldDelete(o)}onDragEnd(e){const o=t.getGroup$$module$build$src$core$events$utils();var i=this.workspace.getDragTarget(e);const s=this.getRoot(this.draggable);if(i){let n;null==(n=this.dragTarget)||n.onDrop(s)}this.shouldReturnToStart(e,s)&&this.draggable.revertDrag(),(i=le(s)&&this.wouldDeleteDraggable(e,s))&&this.draggable instanceof $e&&ae(this.draggable.getRootBlock()),this.draggable.endDrag(e),i&&le(s)&&(t.setGroup$$module$build$src$core$events$utils(o),s.dispose()),t.setGroup$$module$build$src$core$events$utils(!1),!i&&Vo(this.draggable)&&t.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.draggable)}getRoot(e){return e instanceof $e?e.getRootBlock():e}shouldReturnToStart(e,o){return!!(e=this.workspace.getDragTarget(e))&&e.shouldPreventMove(o)}pixelsToWorkspaceUnits(e){return e=new A(e.x/this.workspace.scale,e.y/this.workspace.scale),this.workspace.isMutator&&e.scale(1/this.workspace.options.parentWorkspace.scale),e}};D(w.BLOCK_DRAGGER,vt,Dg);var Uc={};Uc.BlockDragStrategy=Zp,Uc.BubbleDragStrategy=Up,Uc.CommentDragStrategy=Np,Uc.Dragger=Dg;var wd=class extends oo{constructor(e,o,i){super(e?e.workspace.id:void 0),this.type=E.BLOCK_DRAG,e&&(this.blockId=e.id,this.isStart=o,this.blocks=i)}toJson(){const e=super.toJson();if(void 0===this.isStart)throw Error("Whether this event is the start of a drag is undefined. Either pass the value to the constructor, or call fromJson");if(void 0===this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");return e.isStart=this.isStart,e.blockId=this.blockId,e.blocks=this.blocks,e}static fromJson(e,o,i){return(o=super.fromJson(e,o,i??new wd)).isStart=e.isStart,o.blockId=e.blockId,o.blocks=e.blocks,o}};D(w.EVENT,E.BLOCK_DRAG,wd);var Ad=class extends Hi{constructor(e,o,i,s){super(e),this.type=E.BLOCK_FIELD_INTERMEDIATE_CHANGE,this.recordUndo=!1,e&&(this.name=o,this.oldValue=i,this.newValue=s)}toJson(){const e=super.toJson();if(!this.name)throw Error("The changed field name is undefined. Either pass a name to the constructor, or call fromJson.");return e.name=this.name,e.oldValue=this.oldValue,e.newValue=this.newValue,e}static fromJson(e,o,i){return(o=super.fromJson(e,o,i??new Ad)).name=e.name,o.oldValue=e.oldValue,o.newValue=e.newValue,o}isNull(){return this.oldValue===this.newValue}run(e){var o=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");if(!(o=o.getBlockById(this.blockId)))throw Error("The associated block is undefined. Either pass a block to the constructor, or call fromJson");e=e?this.newValue:this.oldValue,(o=o.getField(this.name))?o.setValue(e):console.warn("Can't set non-existent field: "+this.name)}};D(w.EVENT,E.BLOCK_FIELD_INTERMEDIATE_CHANGE,Ad);var Sd=class extends Hi{constructor(e){super(e),this.type=E.BLOCK_MOVE,e&&(e.isShadow()&&(this.recordUndo=!1),e=this.currentLocation(),this.oldParentId=e.parentId,this.oldInputName=e.inputName,this.oldCoordinate=e.coordinate)}toJson(){const e=super.toJson();return e.oldParentId=this.oldParentId,e.oldInputName=this.oldInputName,this.oldCoordinate&&(e.oldCoordinate=`${Math.round(this.oldCoordinate.x)}, ${Math.round(this.oldCoordinate.y)}`),e.newParentId=this.newParentId,e.newInputName=this.newInputName,this.newCoordinate&&(e.newCoordinate=`${Math.round(this.newCoordinate.x)}, ${Math.round(this.newCoordinate.y)}`),this.reason&&(e.reason=this.reason),this.recordUndo||(e.recordUndo=this.recordUndo),e}static fromJson(e,o,i){return(o=super.fromJson(e,o,i??new Sd)).oldParentId=e.oldParentId,o.oldInputName=e.oldInputName,e.oldCoordinate&&(i=e.oldCoordinate.split(","),o.oldCoordinate=new A(Number(i[0]),Number(i[1]))),o.newParentId=e.newParentId,o.newInputName=e.newInputName,e.newCoordinate&&(i=e.newCoordinate.split(","),o.newCoordinate=new A(Number(i[0]),Number(i[1]))),void 0!==e.reason&&(o.reason=e.reason),void 0!==e.recordUndo&&(o.recordUndo=e.recordUndo),o}recordNew(){const e=this.currentLocation();this.newParentId=e.parentId,this.newInputName=e.inputName,this.newCoordinate=e.coordinate}setReason(e){this.reason=e}currentLocation(){var e=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var o=e.getBlockById(this.blockId);if(!o)throw Error("The block associated with the block move event could not be found");e={};const i=o.getParent();return i?(e.parentId=i.id,(o=i.getInputWithBlock(o))&&(e.inputName=o.name)):e.coordinate=o.getRelativeToSurfaceXY(),e}isNull(){return this.oldParentId===this.newParentId&&this.oldInputName===this.newInputName&&A.equals(this.oldCoordinate,this.newCoordinate)}run(e){var o=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var i=o.getBlockById(this.blockId);if(i){var s=e?this.newParentId:this.oldParentId,n=e?this.newInputName:this.oldInputName;if(e=e?this.newCoordinate:this.oldCoordinate,s){var l=o.getBlockById(s);if(!l)return void console.warn("Can't connect to non-existent block: "+s)}if(i.getParent()&&i.unplug(),e)n=i.getRelativeToSurfaceXY(),i.moveBy(e.x-n.x,e.y-n.y,this.reason);else{let h,$;(!(o=i.outputConnection)||i.previousConnection&&i.previousConnection.isConnected())&&(o=i.previousConnection),i=null==($=o)?void 0:$.type,n?(i=l.getInput(n))&&(h=i.connection):i===N.PREVIOUS_STATEMENT&&(h=l.nextConnection),h&&o?o.connect(h):console.warn("Can't connect to non-existent input: "+n)}}else console.warn("Can't move non-existent block: "+this.blockId)}};D(w.EVENT,E.BLOCK_MOVE,Sd);var Rd,Od=class extends oo{constructor(e,o,i){super(e?e.workspace.id:void 0),this.type=E.BUBBLE_OPEN,e&&(this.blockId=e.id,this.isOpen=o,this.bubbleType=i)}toJson(){const e=super.toJson();if(void 0===this.isOpen)throw Error("Whether this event is for opening the bubble is undefined. Either pass the value to the constructor, or call fromJson");if(!this.bubbleType)throw Error("The type of bubble is undefined. Either pass the value to the constructor, or call fromJson");return e.isOpen=this.isOpen,e.bubbleType=this.bubbleType,e.blockId=this.blockId||"",e}static fromJson(e,o,i){return(o=super.fromJson(e,o,i??new Od)).isOpen=e.isOpen,o.bubbleType=e.bubbleType,o.blockId=e.blockId,o}};(function(e){e.MUTATOR="mutator",e.COMMENT="comment",e.WARNING="warning"})(Rd||(Rd={})),D(w.EVENT,E.BUBBLE_OPEN,Od);var V$={};V$.BubbleOpen=Od,V$.BubbleType=Rd;var ho=class extends zs{constructor(e){super(),this.isBlank=!e,e&&(this.commentId=e.id,this.workspaceId=e.workspace.id,this.group=t.getGroup$$module$build$src$core$events$utils(),this.recordUndo=Ze())}toJson(){const e=super.toJson();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");return e.commentId=this.commentId,e}static fromJson(e,o,i){return(o=super.fromJson(e,o,i??new ho)).commentId=e.commentId,o}static CommentCreateDeleteHelper(e,o){const i=e.getEventWorkspace_();if(o){if(!e.json)throw Error("Encountered a comment event without proper json");bs(e.json,i)}else{if(!e.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");(o=i.getCommentById(e.commentId))?o.dispose():console.warn("Can't delete non-existent comment: "+e.commentId)}}},Md=class extends ho{constructor(e,o,i){super(e),this.type=E.COMMENT_CHANGE,e&&(this.oldContents_=typeof o>"u"?"":o,this.newContents_=typeof i>"u"?"":i)}toJson(){const e=super.toJson();if(!this.oldContents_)throw Error("The old contents is undefined. Either pass a value to the constructor, or call fromJson");if(!this.newContents_)throw Error("The new contents is undefined. Either pass a value to the constructor, or call fromJson");return e.oldContents=this.oldContents_,e.newContents=this.newContents_,e}static fromJson(e,o,i){return(o=super.fromJson(e,o,i??new Md)).oldContents_=e.oldContents,o.newContents_=e.newContents,o}isNull(){return this.oldContents_===this.newContents_}run(e){var o=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(o=o.getCommentById(this.commentId)){var i=e?this.newContents_:this.oldContents_;if(void 0===i)throw Error(e?"The new contents is undefined. Either pass a value to the constructor, or call fromJson":"The old contents is undefined. Either pass a value to the constructor, or call fromJson");o.setText(i)}else console.warn("Can't change non-existent comment: "+this.commentId)}};D(w.EVENT,E.COMMENT_CHANGE,Md);var Nd=class extends ho{constructor(e,o){super(e),this.newCollapsed=o,this.type=E.COMMENT_COLLAPSE}toJson(){const e=super.toJson();if(void 0===this.newCollapsed)throw Error("The new collapse value undefined. Either call recordNew, or call fromJson");return e.newCollapsed=this.newCollapsed,e}static fromJson(e,o,i){return(o=super.fromJson(e,o,i??new Nd)).newCollapsed=e.newCollapsed,o}run(e){var o=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");(o=o.getCommentById(this.commentId))?o.setCollapsed(e?!!this.newCollapsed:!this.newCollapsed):console.warn("Can't collapse or uncollapse non-existent comment: "+this.commentId)}};D(w.EVENT,E.COMMENT_COLLAPSE,Nd);var Dd=class extends ho{constructor(e){super(e),this.type=E.COMMENT_CREATE,e&&(this.xml=Os(e),this.json=qo(e,{addCoordinates:!0}))}toJson(){const e=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.json)throw Error("The comment JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.xml=Bt(this.xml),e.json=this.json,e}static fromJson(e,o,i){return(o=super.fromJson(e,o,i??new Dd)).xml=t.textToDom$$module$build$src$core$utils$xml(e.xml),o.json=e.json,o}run(e){ho.CommentCreateDeleteHelper(this,e)}};D(w.EVENT,E.COMMENT_CREATE,Dd);var Ld=class extends ho{constructor(e){super(e),this.type=E.COMMENT_DELETE,e&&(this.xml=Os(e),this.json=qo(e,{addCoordinates:!0}))}run(e){ho.CommentCreateDeleteHelper(this,!e)}toJson(){const e=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.json)throw Error("The comment JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.xml=Bt(this.xml),e.json=this.json,e}static fromJson(e,o,i){return(o=super.fromJson(e,o,i??new Ld)).xml=t.textToDom$$module$build$src$core$utils$xml(e.xml),o.json=e.json,o}};D(w.EVENT,E.COMMENT_DELETE,Ld);var Bd=class extends oo{constructor(e,o){super(e?e.workspace.id:void 0),this.type=E.COMMENT_DRAG,e&&(this.commentId=e.id,this.isStart=o)}toJson(){const e=super.toJson();if(void 0===this.isStart)throw Error("Whether this event is the start of a drag is undefined. Either pass the value to the constructor, or call fromJson");if(void 0===this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");return e.isStart=this.isStart,e.commentId=this.commentId,e}static fromJson(e,o,i){return(o=super.fromJson(e,o,i??new Bd)).isStart=e.isStart,o.commentId=e.commentId,o}};D(w.EVENT,E.COMMENT_DRAG,Bd);var Pd=class extends ho{constructor(e){super(e),this.type=E.COMMENT_MOVE,e&&(this.comment_=e,this.oldCoordinate_=e.getRelativeToSurfaceXY())}recordNew(){if(this.newCoordinate_)throw Error("Tried to record the new position of a comment on the same event twice.");if(!this.comment_)throw Error("The comment is undefined. Pass a comment to the constructor if you want to use the record functionality");this.newCoordinate_=this.comment_.getRelativeToSurfaceXY()}setReason(e){this.reason=e}setOldCoordinate(e){this.oldCoordinate_=e}toJson(){const e=super.toJson();if(!this.oldCoordinate_)throw Error("The old comment position is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.newCoordinate_)throw Error("The new comment position is undefined. Either call recordNew, or call fromJson");return e.oldCoordinate=`${Math.round(this.oldCoordinate_.x)}, ${Math.round(this.oldCoordinate_.y)}`,e.newCoordinate=Math.round(this.newCoordinate_.x)+","+Math.round(this.newCoordinate_.y),e}static fromJson(e,o,i){return o=super.fromJson(e,o,i??new Pd),i=e.oldCoordinate.split(","),o.oldCoordinate_=new A(Number(i[0]),Number(i[1])),i=e.newCoordinate.split(","),o.newCoordinate_=new A(Number(i[0]),Number(i[1])),o}isNull(){return A.equals(this.oldCoordinate_,this.newCoordinate_)}run(e){var o=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(o=o.getCommentById(this.commentId)){if(!(e=e?this.newCoordinate_:this.oldCoordinate_))throw Error("Either oldCoordinate_ or newCoordinate_ is undefined. Either pass a comment to the constructor and call recordNew, or call fromJson");o.moveTo(e)}else console.warn("Can't move non-existent comment: "+this.commentId)}};D(w.EVENT,E.COMMENT_MOVE,Pd);var Fd=class extends ho{constructor(e){super(e),this.type=E.COMMENT_RESIZE,e&&(this.oldSize=e.getSize())}recordCurrentSizeAsNewSize(){if(this.newSize)throw Error("Tried to record the new size of a comment on the same event twice.");var e=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(!(e=e.getCommentById(this.commentId)))throw Error("The comment associated with the comment resize event could not be found");this.newSize=e.getSize()}toJson(){const e=super.toJson();if(!this.oldSize)throw Error("The old comment size is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.newSize)throw Error("The new comment size is undefined. Either call recordCurrentSizeAsNewSize, or call fromJson");return e.oldWidth=Math.round(this.oldSize.width),e.oldHeight=Math.round(this.oldSize.height),e.newWidth=Math.round(this.newSize.width),e.newHeight=Math.round(this.newSize.height),e}static fromJson(e,o,i){return(o=super.fromJson(e,o,i??new Fd)).oldSize=new ee(e.oldWidth,e.oldHeight),o.newSize=new ee(e.newWidth,e.newHeight),o}isNull(){return ee.equals(this.oldSize,this.newSize)}run(e){var o=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(o=o.getCommentById(this.commentId)){if(!(e=e?this.newSize:this.oldSize))throw Error("Either oldSize or newSize is undefined. Either pass a comment to the constructor and call recordCurrentSizeAsNewSize, or call fromJson");o.setSize(e)}else console.warn("Can't resize non-existent comment: "+this.commentId)}};D(w.EVENT,E.COMMENT_RESIZE,Fd);var Ud=class extends oo{constructor(e,o,i){super(i),this.type=E.TOOLBOX_ITEM_SELECT,this.oldItem=e??void 0,this.newItem=o??void 0}toJson(){const e=super.toJson();return e.oldItem=this.oldItem,e.newItem=this.newItem,e}static fromJson(e,o,i){return(o=super.fromJson(e,o,i??new Ud)).oldItem=e.oldItem,o.newItem=e.newItem,o}};D(w.EVENT,E.TOOLBOX_ITEM_SELECT,Ud);var Zd=class extends an{constructor(e,o,i){super(e),this.oldType=o,this.newType=i,this.type=E.VAR_TYPE_CHANGE}toJson(){const e=super.toJson();if(!this.oldType||!this.newType)throw Error("The variable's types are undefined. Either pass them to the constructor, or call fromJson");return e.oldType=this.oldType,e.newType=this.newType,e}static fromJson(e,o,i){return(o=super.fromJson(e,o,i??new Zd)).oldType=e.oldType,o.newType=e.newType,o}run(e){const o=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.oldType||!this.newType)throw Error("The variable's types are undefined. Either pass them to the constructor, or call fromJson");const i=o.getVariableMap().getVariableById(this.varId);i&&(e?o.getVariableMap().changeVariableType(i,this.newType):o.getVariableMap().changeVariableType(i,this.oldType))}};D(w.EVENT,E.VAR_TYPE_CHANGE,Zd);var q$,W$,z$,j$,Y$,X$,K$,J$,Q$,e_,t_,o_,i_,s_,n_,r_,l_,c_,a_,u_,d_,h_,p_,g_,M,Lg=class extends zs{constructor(e){super(),this.isBlank=!0,this.recordUndo=!1,this.type=E.FINISHED_LOADING,this.isBlank=!!e,e&&(this.workspaceId=e.id)}};D(w.EVENT,E.FINISHED_LOADING,Lg),t.BLOCK_CHANGE$$module$build$src$core$events$events=E.BLOCK_CHANGE,t.BLOCK_CREATE$$module$build$src$core$events$events=E.BLOCK_CREATE,t.BLOCK_DELETE$$module$build$src$core$events$events=E.BLOCK_DELETE,q$=E.BLOCK_DRAG,t.BLOCK_MOVE$$module$build$src$core$events$events=E.BLOCK_MOVE,W$=E.BLOCK_FIELD_INTERMEDIATE_CHANGE,z$=E.BUBBLE_OPEN,j$=E.BLOCK_CHANGE,Y$=E.CLICK,X$=E.COMMENT_CHANGE,K$=E.COMMENT_CREATE,J$=E.COMMENT_DELETE,Q$=E.COMMENT_MOVE,e_=E.COMMENT_RESIZE,t_=E.COMMENT_DRAG,o_=E.BLOCK_CREATE,i_=E.BLOCK_DELETE,s_=E.FINISHED_LOADING,n_=E.BLOCK_MOVE,r_=E.SELECTED,l_=E.THEME_CHANGE,c_=E.TOOLBOX_ITEM_SELECT,a_=E.TRASHCAN_OPEN,u_=E.UI,d_=E.VAR_CREATE,h_=E.VAR_DELETE,p_=E.VAR_RENAME,g_=E.VIEWPORT_CHANGE,(M={}).Abstract=zs,M.BLOCK_CHANGE=t.BLOCK_CHANGE$$module$build$src$core$events$events,M.BLOCK_CREATE=t.BLOCK_CREATE$$module$build$src$core$events$events,M.BLOCK_DELETE=t.BLOCK_DELETE$$module$build$src$core$events$events,M.BLOCK_DRAG=q$,M.BLOCK_FIELD_INTERMEDIATE_CHANGE=W$,M.BLOCK_MOVE=t.BLOCK_MOVE$$module$build$src$core$events$events,M.BUBBLE_OPEN=z$,M.BUMP_EVENTS=tp,M.BlockBase=Hi,M.BlockChange=Gi,M.BlockCreate=Vu,M.BlockDelete=ju,M.BlockDrag=wd,M.BlockFieldIntermediateChange=Ad,M.BlockMove=Sd,M.BubbleOpen=Od,M.BubbleType=Rd,M.CHANGE=j$,M.CLICK=Y$,M.COMMENT_CHANGE=X$,M.COMMENT_CREATE=K$,M.COMMENT_DELETE=J$,M.COMMENT_DRAG=t_,M.COMMENT_MOVE=Q$,M.COMMENT_RESIZE=e_,M.CREATE=o_,M.Click=Eu,M.ClickTarget=vu,M.CommentBase=ho,M.CommentChange=Md,M.CommentCollapse=Nd,M.CommentCreate=Dd,M.CommentDelete=Ld,M.CommentDrag=Bd,M.CommentMove=Pd,M.CommentResize=Fd,M.DELETE=i_,M.FINISHED_LOADING=s_,M.FinishedLoading=Lg,M.MOVE=n_,M.SELECTED=r_,M.Selected=zu,M.THEME_CHANGE=l_,M.TOOLBOX_ITEM_SELECT=c_,M.TRASHCAN_OPEN=a_,M.ThemeChange=qu,M.ToolboxItemSelect=Ud,M.TrashcanOpen=Td,M.UI=u_,M.UiBase=oo,M.VAR_CREATE=d_,M.VAR_DELETE=h_,M.VAR_RENAME=p_,M.VIEWPORT_CHANGE=g_,M.VarBase=an,M.VarCreate=_d,M.VarDelete=bd,M.VarRename=fd,M.VarTypeChange=Zd,M.ViewportChange=Wu,M.clearPendingUndo=$i,M.disable=t.disable$$module$build$src$core$events$utils,M.disableOrphans=cs,M.enable=t.enable$$module$build$src$core$events$utils,M.filter=mi,M.fire=L,M.fromJson=ls,M.get=B,M.getDescendantIds=Go,M.getGroup=t.getGroup$$module$build$src$core$events$utils,M.getRecordUndo=Ze,M.isEnabled=_e,M.setGroup=t.setGroup$$module$build$src$core$events$utils,M.setRecordUndo=t.setRecordUndo$$module$build$src$core$events$utils;var No={};No.BottomRow=Ig,No.ConstantProvider=Cg,No.Drawer=kg,No.PathObject=Og,No.RenderInfo=Sg,No.Renderer=Cd,No.RightConnectionShape=wg,No.StatementInput=Fc,No.TopRow=Ag,zh();var Ke={};Ke.registerCleanup=Hs,Ke.registerCollapse=Wl,Ke.registerCollapseExpandBlock=Er,Ke.registerComment=Xl,Ke.registerCommentCreate=Wh,Ke.registerCommentDelete=Qe,Ke.registerCommentDuplicate=qh,Ke.registerCommentOptions=im,Ke.registerDefaultOptions=zh,Ke.registerDelete=G,Ke.registerDeleteAll=jl,Ke.registerDisable=Kl,Ke.registerDuplicate=fr,Ke.registerExpand=Gs,Ke.registerHelp=J,Ke.registerInline=Tr,Ke.registerRedo=_r,Ke.registerUndo=$r;var Bg="button",Pg=class{load(e,o){return(e=new pt(o.getWorkspace(),o.targetWorkspace,e,!1)).show(),new rn(e,Bg)}gapForItem(e,o){return o}disposeItem(e){(e=e.getElement())instanceof pt&&e.dispose()}getType(){return Bg}};D(w.FLYOUT_INFLATER,Bg,Pg);var Zc={};Zc.Bubble=de,Zc.MiniWorkspaceBubble=So,Zc.TextBubble=Hp,Zc.TextInputBubble=ld;var Fg="block",Ug=class{constructor(){this.permanentlyDisabledBlocks=new Set,this.listeners=new Map,this.capacityWrapper=this.filterFlyoutBasedOnCapacity.bind(this)}load(e,o){return this.setFlyout(o),(e=this.createBlock(e,o.getWorkspace())).isEnabled()?this.updateStateBasedOnCapacity(e):this.permanentlyDisabledBlocks.add(e),e.getDescendants(!1).forEach(i=>i.isInFlyout=!0),this.addBlockListeners(e),new rn(e,Fg)}createBlock(e,o){return e.blockxml?(e="string"==typeof e.blockxml?t.textToDom$$module$build$src$core$utils$xml(e.blockxml):e.blockxml,o=Xo(e,o)):(void 0===e.enabled&&(e.enabled="true"!==e.disabled&&!0!==e.disabled),void 0===e.disabledReasons&&!1===e.enabled&&(e.disabledReasons=[Gt]),"x"in e&&delete e.x,"y"in e&&delete e.y,o=vs(e,o)),o}gapForItem(e,o){let i;return e.gap?i=parseInt(String(e.gap)):e.blockxml&&(e="string"==typeof e.blockxml?t.textToDom$$module$build$src$core$utils$xml(e.blockxml):e.blockxml,i=parseInt(e.getAttribute("gap"))),!i||isNaN(i)?o:i}disposeItem(e){(e=e.getElement())instanceof $e&&(this.removeListeners(e.id),e.dispose(!1,!1))}removeListeners(e){let o;(null!=(o=this.listeners.get(e))?o:[]).forEach(i=>ne(i)),this.listeners.delete(e)}setFlyout(e){if(this.flyout!==e){if(this.flyout){let i;null==(i=this.flyout.targetWorkspace)||i.removeChangeListener(this.capacityWrapper)}var o;this.flyout=e,null==(o=this.flyout.targetWorkspace)||o.addChangeListener(this.capacityWrapper)}}updateStateBasedOnCapacity(e){let o,i;const s=null==(o=this.flyout)||null==(i=o.targetWorkspace)?void 0:i.isCapacityAvailable(hs(e));for(;e;)e.setDisabledReason(!s,"WORKSPACE_AT_BLOCK_CAPACITY"),e=e.getNextBlock()}addBlockListeners(e){const o=[];o.push(U(e.getSvgRoot(),"pointerdown",e,i=>{let s,n;const l=null==(s=this.flyout)||null==(n=s.targetWorkspace)?void 0:n.getGesture(i);l&&this.flyout&&(l.setStartBlock(e),l.handleFlyoutStart(i,this.flyout))})),o.push(lt(e.getSvgRoot(),"pointermove",null,()=>{let i,s;null!=(i=this.flyout)&&null!=(s=i.targetWorkspace)&&s.isDragging()||e.addSelect()})),o.push(lt(e.getSvgRoot(),"pointerleave",null,()=>{let i,s;null!=(i=this.flyout)&&null!=(s=i.targetWorkspace)&&s.isDragging()||e.removeSelect()})),this.listeners.set(e.id,o)}filterFlyoutBasedOnCapacity(e){!this.flyout||e&&e.type!==E.BLOCK_CREATE&&e.type!==E.BLOCK_DELETE||this.flyout.getWorkspace().getTopBlocks(!1).forEach(o=>{this.permanentlyDisabledBlocks.has(o)||this.updateStateBasedOnCapacity(o)})}getType(){return Fg}};D(w.FLYOUT_INFLATER,Fg,Ug);var Zg=class extends Mc{constructor(){super(),this.FIELD_TEXT_BASELINE_CENTER=!1,this.DARK_PATH_OFFSET=1,this.MAX_BOTTOM_WIDTH=30,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT/2}getCSS_(e){return super.getCSS_(e).concat([`${e} .blocklyInsertionMarker>.blocklyPathLight,`,`${e} .blocklyInsertionMarker>.blocklyPathDark {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"])}},Hg=class{constructor(e){this.inlineSteps_=this.steps_="",this.info_=e,this.RTL_=this.info_.RTL,e=e.getRenderer(),this.constants_=e.getConstants(),this.highlightConstants_=e.getHighlightConstants(),this.highlightOffset=this.highlightConstants_.OFFSET,this.outsideCornerPaths_=this.highlightConstants_.OUTSIDE_CORNER,this.insideCornerPaths_=this.highlightConstants_.INSIDE_CORNER,this.puzzleTabPaths_=this.highlightConstants_.PUZZLE_TAB,this.notchPaths_=this.highlightConstants_.NOTCH,this.startPaths_=this.highlightConstants_.START_HAT,this.jaggedTeethPaths_=this.highlightConstants_.JAGGED_TEETH}getPath(){return this.steps_+"\n"+this.inlineSteps_}drawTopCorner(e){this.steps_+=u(e.xPos,this.info_.startY);for(let i,o=0;i=e.elements[o];o++)_.isLeftSquareCorner(i)?this.steps_+=this.highlightConstants_.START_POINT:_.isLeftRoundedCorner(i)?this.steps_+=this.outsideCornerPaths_.topLeft(this.RTL_):_.isPreviousConnection(i)?this.steps_+=this.notchPaths_.pathLeft:_.isHat(i)?this.steps_+=this.startPaths_.path(this.RTL_):_.isSpacer(i)&&0!==i.width&&(this.steps_+=c("H",i.xPos+i.width-this.highlightOffset));this.steps_+=c("H",e.xPos+e.width-this.highlightOffset)}drawJaggedEdge_(e){this.info_.RTL&&(this.steps_+=this.jaggedTeethPaths_.pathLeft+c("v",e.height-this.jaggedTeethPaths_.height-this.highlightOffset))}drawValueInput(e){const o=e.getLastInput();if(this.RTL_){const i=e.height-o.connectionHeight;this.steps_+=He(o.xPos+o.width-this.highlightOffset,e.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)+c("v",i)}else this.steps_+=He(o.xPos+o.width,e.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)}drawStatementInput(e){const o=e.getLastInput();if(o)if(this.RTL_){const i=e.height-2*this.insideCornerPaths_.height;this.steps_+=He(o.xPos,e.yPos)+this.insideCornerPaths_.pathTop(this.RTL_)+c("v",i)+this.insideCornerPaths_.pathBottom(this.RTL_)+T(e.width-o.xPos-this.insideCornerPaths_.width,0)}else this.steps_+=He(o.xPos,e.yPos+e.height)+this.insideCornerPaths_.pathBottom(this.RTL_)+T(e.width-o.xPos-this.insideCornerPaths_.width,0)}drawRightSideRow(e){const o=e.xPos+e.width-this.highlightOffset;e instanceof pd&&e.followsStatement&&(this.steps_+=c("H",o)),this.RTL_&&(this.steps_+=c("H",o),e.height>this.highlightOffset&&(this.steps_+=c("V",e.yPos+e.height-this.highlightOffset)))}drawBottomRow(e){if(this.RTL_)this.steps_+=c("V",e.baseline-this.highlightOffset);else{const o=this.info_.bottomRow.elements[0];_.isLeftSquareCorner(o)?this.steps_+=He(e.xPos+this.highlightOffset,e.baseline-this.highlightOffset):_.isLeftRoundedCorner(o)&&(this.steps_+=He(e.xPos,e.baseline),this.steps_+=this.outsideCornerPaths_.bottomLeft())}}drawLeft(){var e=this.info_.outputConnection;e&&(e=e.connectionOffsetY+e.height,this.RTL_?this.steps_+=He(this.info_.startX,e):(this.steps_+=He(this.info_.startX+this.highlightOffset,this.info_.bottomRow.baseline-this.highlightOffset),this.steps_+=c("V",e)),this.steps_+=this.puzzleTabPaths_.pathUp(this.RTL_)),this.RTL_||(_.isLeftRoundedCorner((e=this.info_.topRow).elements[0])?this.steps_+=c("V",this.outsideCornerPaths_.height):this.steps_+=c("V",e.capline+this.highlightOffset))}drawInlineInput(e){const o=this.highlightOffset,i=e.xPos+e.connectionWidth;var s=e.centerline-e.height/2;const n=e.width-e.connectionWidth,l=s+o;this.RTL_?(s=e.connectionOffsetY-o,e=e.height-(e.connectionOffsetY+e.connectionHeight)+o,this.inlineSteps_+=He(i-o,l)+c("v",s)+this.puzzleTabPaths_.pathDown(this.RTL_)+c("v",e)+c("h",n)):this.inlineSteps_+=He(e.xPos+e.width+o,l)+c("v",e.height)+c("h",-n)+He(i,s+e.connectionOffsetY)+this.puzzleTabPaths_.pathDown(this.RTL_)}},Gg=class extends Nc{constructor(e,o){super(e,o),this.highlighter_=new Hg(o)}draw(){this.drawOutline_(),this.drawInternals_(),this.updateConnectionHighlights();const e=this.block_.pathObject;e.setPath(this.outlinePath_+"\n"+this.inlinePath_),e.setHighlightPath(this.highlighter_.getPath()),this.info_.RTL&&e.flipRTL(),this.recordSizeOnBlock_()}drawTop_(){this.highlighter_.drawTopCorner(this.info_.topRow),this.highlighter_.drawRightSideRow(this.info_.topRow),super.drawTop_()}drawJaggedEdge_(e){this.highlighter_.drawJaggedEdge_(e),super.drawJaggedEdge_(e)}drawValueInput_(e){this.highlighter_.drawValueInput(e),super.drawValueInput_(e)}drawStatementInput_(e){this.highlighter_.drawStatementInput(e),super.drawStatementInput_(e)}drawRightSideRow_(e){this.highlighter_.drawRightSideRow(e),this.outlinePath_+=c("H",e.xPos+e.width)+c("V",e.yPos+e.height)}drawBottom_(){this.highlighter_.drawBottomRow(this.info_.bottomRow),super.drawBottom_()}drawLeft_(){this.highlighter_.drawLeft(),super.drawLeft_()}drawInlineInput_(e){this.highlighter_.drawInlineInput(e),super.drawInlineInput_(e)}positionInlineInputConnection_(e){if(e.connectionModel){let i=e.xPos+e.connectionWidth+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(i*=-1),e.connectionModel.setOffsetInBlock(i,e.centerline-e.height/2+e.connectionOffsetY+this.constants_.DARK_PATH_OFFSET)}}positionStatementInputConnection_(e){const o=e.getLastInput();if(null!=o&&o.connectionModel){let i=e.xPos+e.statementEdge+o.notchOffset;i=this.info_.RTL?-1*i:i+this.constants_.DARK_PATH_OFFSET,o.connectionModel.setOffsetInBlock(i,e.yPos+this.constants_.DARK_PATH_OFFSET)}}positionExternalValueConnection_(e){const o=e.getLastInput();if(o&&o.connectionModel){let i=e.xPos+e.width+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(i*=-1),o.connectionModel.setOffsetInBlock(i,e.yPos)}}positionNextConnection_(){const e=this.info_.bottomRow;if(e.connection){const o=e.connection,i=o.xPos;o.connectionModel.setOffsetInBlock((this.info_.RTL?-i:i)+this.constants_.DARK_PATH_OFFSET/2,e.baseline+this.constants_.DARK_PATH_OFFSET)}}},Vg=class{constructor(e){this.OFFSET=.5,this.constantProvider=e,this.START_POINT=u(this.OFFSET,this.OFFSET)}init(){this.INSIDE_CORNER=this.makeInsideCorner(),this.OUTSIDE_CORNER=this.makeOutsideCorner(),this.PUZZLE_TAB=this.makePuzzleTab(),this.NOTCH=this.makeNotch(),this.JAGGED_TEETH=this.makeJaggedTeeth(),this.START_HAT=this.makeStartHat()}makeInsideCorner(){const e=this.constantProvider.CORNER_RADIUS,o=this.OFFSET,i=(1-Math.SQRT1_2)*(e+o)-o,s=u(i,i)+a("a","0 0,0",e,P(-i-o,e-i)),n=a("a","0 0,0",e+o,P(e+o,e+o)),l=u(i,-i)+a("a","0 0,0",e+o,P(e-i,i+o));return{width:e+o,height:e,pathTop:h=>h?s:"",pathBottom:h=>h?n:l}}makeOutsideCorner(){const e=this.constantProvider.CORNER_RADIUS,o=this.OFFSET,i=(1-Math.SQRT1_2)*(e-o)+o,s=u(i,i)+a("a","0 0,1",e-o,P(e-i,-i+o)),n=u(o,e)+a("a","0 0,1",e-o,P(e,-e+o)),l=-i,h=u(i,l)+a("a","0 0,1",e-o,P(-i+o,-l-e));return{height:e,topLeft:$=>$?s:n,bottomLeft:()=>h}}makePuzzleTab(){const e=this.constantProvider.TAB_WIDTH,o=this.constantProvider.TAB_HEIGHT,i=u(-2,2.5-o+.9)+T(-.45*e,-2.1),s=c("v",2.5)+u(.97*-e,2.5)+at("q",[P(.05*-e,10),P(.3*e,9.5)])+u(.67*e,-1.9)+c("v",2.5),n=c("v",-1.5)+u(-.92*e,-.5)+at("q",[P(-.19*e,-5.5),P(0,-11)])+u(.92*e,1),l=u(-5,o-.7)+T(.46*e,-2.1);return{width:e,height:o,pathUp:h=>h?i:n,pathDown:h=>h?s:l}}makeNotch(){return{pathLeft:c("h",this.OFFSET)+this.constantProvider.NOTCH.pathLeft}}makeJaggedTeeth(){return{pathLeft:T(5.1,2.6)+u(-10.2,6.8)+T(5.1,2.6),height:12,width:10.2}}makeStartHat(){const e=this.constantProvider.START_HAT.height,o=u(25,-8.7)+at("c",[P(29.7,-6.2),P(57.2,-.5),P(75,8.7)]),i=at("c",[P(17.8,-9.2),P(45.3,-14.9),P(75,-8.7)])+He(100.5,e+.5);return{path:s=>s?o:i}}},qg=class extends dd{constructor(e,o){super(e,o),this.constants_=e,this.connectedBlock&&(this.width+=this.constants_.DARK_PATH_OFFSET,this.height+=this.constants_.DARK_PATH_OFFSET)}},Wg=class extends Rc{constructor(e,o){super(e,o),this.constants_=e,this.connectedBlock&&(this.height+=this.constants_.DARK_PATH_OFFSET)}},zg=class extends Pr{constructor(e,o){super(e,o),this.renderer_=e}getRenderer(){return this.renderer_}populateBottomRow_(){super.populateBottomRow_(),this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1]instanceof xt||(this.bottomRow.minHeight=this.constants_.MEDIUM_PADDING-this.constants_.DARK_PATH_OFFSET)}addInput_(e,o){this.isInline&&e instanceof t.ValueInput$$module$build$src$core$inputs$value_input?(o.elements.push(new qg(this.constants_,e)),o.hasInlineInput=!0):e instanceof xt?(o.elements.push(new Wg(this.constants_,e)),o.hasStatement=!0):e instanceof t.ValueInput$$module$build$src$core$inputs$value_input?(o.elements.push(new ad(this.constants_,e)),o.hasExternalInput=!0):(e instanceof lo||e instanceof Oo)&&(o.minHeight=Math.max(o.minHeight,this.constants_.DUMMY_INPUT_MIN_HEIGHT),o.hasDummyInput=!0),this.isInline||null!==o.align||(o.align=e.align)}addElemSpacing_(){let e=!1;for(let s,i=0;s=this.rows[i];i++)s.hasExternalInput&&(e=!0);for(let s,i=0;s=this.rows[i];i++){var o=s.elements;if(s.elements=[],s.startsWithElemSpacer()&&s.elements.push(new Ct(this.constants_,this.getInRowSpacing_(null,o[0]))),o.length){for(let n=0;n<o.length-1;n++){s.elements.push(o[n]);const l=this.getInRowSpacing_(o[n],o[n+1]);s.elements.push(new Ct(this.constants_,l))}s.elements.push(o[o.length-1]),s.endsWithElemSpacer()&&(o=this.getInRowSpacing_(o[o.length-1],null),e&&s.hasDummyInput&&(o+=this.constants_.TAB_WIDTH),s.elements.push(new Ct(this.constants_,o)))}}}getInRowSpacing_(e,o){if(!e)return o&&_.isField(o)&&o.isEditable?this.constants_.MEDIUM_PADDING:o&&_.isInlineInput(o)?this.constants_.MEDIUM_LARGE_PADDING:o&&_.isStatementInput(o)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!_.isInput(e)&&(!o||_.isStatementInput(o)))return _.isField(e)&&e.isEditable?0===e.width?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:_.isIcon(e)?2*this.constants_.LARGE_PADDING+1:_.isHat(e)?this.constants_.NO_PADDING:_.isPreviousOrNextConnection(e)?this.constants_.LARGE_PADDING:_.isLeftRoundedCorner(e)?this.constants_.MIN_BLOCK_WIDTH:_.isJaggedEdge(e)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(_.isInput(e)&&!o){if(_.isExternalInput(e))return this.constants_.NO_PADDING;if(_.isInlineInput(e))return this.constants_.LARGE_PADDING;if(_.isStatementInput(e))return this.constants_.NO_PADDING}if(!_.isInput(e)&&o&&_.isInput(o)){if(_.isField(e)&&e.isEditable){if(_.isInlineInput(o)||_.isExternalInput(o))return this.constants_.SMALL_PADDING}else{if(_.isInlineInput(o)||_.isExternalInput(o))return this.constants_.MEDIUM_LARGE_PADDING;if(_.isStatementInput(o))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(_.isIcon(e)&&o&&!_.isInput(o))return this.constants_.LARGE_PADDING;if(_.isInlineInput(e)&&o&&_.isField(o))return o.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(_.isLeftSquareCorner(e)&&o){if(_.isHat(o))return this.constants_.NO_PADDING;if(_.isPreviousConnection(o))return o.notchOffset;if(_.isNextConnection(o))return o.notchOffset+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}if(_.isLeftRoundedCorner(e)&&o){if(_.isPreviousConnection(o))return o.notchOffset-this.constants_.CORNER_RADIUS;if(_.isNextConnection(o))return o.notchOffset-this.constants_.CORNER_RADIUS+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}return _.isField(e)&&o&&_.isField(o)&&e.isEditable===o.isEditable?0===e.width?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING:o&&_.isJaggedEdge(o)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(e,o){return _.isTopRow(e)&&_.isBottomRow(o)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:_.isTopRow(e)||_.isBottomRow(o)?this.constants_.NO_PADDING:e.hasExternalInput&&o.hasExternalInput?this.constants_.LARGE_PADDING:!e.hasStatement&&o.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:e.hasStatement&&o.hasStatement||!e.hasStatement&&o.hasDummyInput||e.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(e,o){if(_.isSpacer(o))return e.yPos+o.height/2;if(_.isBottomRow(e))return e=e.yPos+e.height-e.descenderHeight,_.isNextConnection(o)?e+o.height/2:e-o.height/2;if(_.isTopRow(e))return _.isHat(o)?e.capline-o.height/2:e.capline+o.height/2;let i=e.yPos;return _.isField(o)||_.isIcon(o)?(i+=o.height/2,(e.hasInlineInput||e.hasStatement)&&o.height+this.constants_.TALL_INPUT_FIELD_OFFSET_Y<=e.height&&(i+=this.constants_.TALL_INPUT_FIELD_OFFSET_Y)):i=_.isInlineInput(o)?i+o.height/2:i+e.height/2,i}alignRowElements_(){if(this.isInline){var e=0,o=new WeakMap,i=null;for(let n,s=this.rows.length-1;n=this.rows[s];s--)o.set(n,e),_.isInputRow(n)&&(n.hasStatement&&this.alignStatementRow_(n),i&&i.hasStatement&&n.width<i.width?o.set(n,i.width):e=n.hasStatement?n.width:Math.max(e,n.width),i=n);e=0;for(let n,s=0;n=this.rows[s];s++)n.hasStatement?e=this.getDesiredRowWidth_(n):_.isSpacer(n)?n.width=Math.max(e,o.get(n)):(i=n.width,(e=Math.max(e,o.get(n))-i)>0&&this.addAlignmentPadding_(n,e),e=n.width)}else super.alignRowElements_()}getDesiredRowWidth_(e){return this.isInline&&e.hasStatement?this.statementEdge+this.constants_.MAX_BOTTOM_WIDTH+this.startX:super.getDesiredRowWidth_(e)}finalize_(){let e=0,o=0;for(let n,s=0;n=this.rows[s];s++){n.yPos=o,n.xPos=this.startX,o+=n.height,e=Math.max(e,n.widthWithConnectedBlocks);var i=o-this.topRow.ascenderHeight;n===this.bottomRow&&i<this.constants_.MIN_BLOCK_HEIGHT&&(this.bottomRow.height+=i=this.constants_.MIN_BLOCK_HEIGHT-i,o+=i),this.recordElemPositions_(n)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(i=this.block_.nextConnection.targetBlock())&&(e=Math.max(e,i.getHeightWidth().width-this.constants_.DARK_PATH_OFFSET)),this.bottomRow.baseline=o-this.bottomRow.descenderHeight,this.widthWithChildren=e+this.startX+this.constants_.DARK_PATH_OFFSET,this.width+=this.constants_.DARK_PATH_OFFSET,this.height=o+this.constants_.DARK_PATH_OFFSET,this.startY=this.topRow.capline}},jg=class extends Dc{constructor(e,o,i){super(e,o,i),this.constants=i,this.colourDark="#000000",this.svgPathDark=I(v.PATH,{class:"blocklyPathDark",transform:"translate(1,1)"}),this.svgRoot.insertBefore(this.svgPathDark,this.svgPath),this.svgPathLight=I(v.PATH,{class:"blocklyPathLight"},this.svgRoot)}setPath(e){this.svgPath.setAttribute("d",e),this.svgPathDark.setAttribute("d",e)}setHighlightPath(e){this.svgPathLight.setAttribute("d",e)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)"),this.svgPathLight.setAttribute("transform","scale(-1 1)"),this.svgPathDark.setAttribute("transform","translate(1,1) scale(-1 1)")}applyColour(e){if(this.svgPathLight.style.display="",this.svgPathDark.style.display="",!this.style.colourTertiary)throw Error("The renderer did not properly initialize the tertiary colour of the block style");this.svgPathLight.setAttribute("stroke",this.style.colourTertiary),this.svgPathDark.setAttribute("fill",this.colourDark),super.applyColour(e),this.svgPath.setAttribute("stroke","none")}setStyle(e){this.style=e,this.colourDark=ki("#000",this.style.colourPrimary,.2)||this.colourDark}updateHighlighted(e){super.updateHighlighted(e),this.svgPathLight.style.display=e?"none":"inline"}updateShadow_(e){if(e){if(this.svgPathLight.style.display="none",!this.style.colourSecondary)throw Error("The renderer did not properly initialize the secondary colour of the block style block style");this.svgPathDark.setAttribute("fill",this.style.colourSecondary),this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary)}}updateDisabled_(e){super.updateDisabled_(e),e&&this.svgPath.setAttribute("stroke","none")}},Yg=class extends Lc{constructor(e){super(e),this.highlightConstants=null}init(e,o){super.init(e,o),this.highlightConstants=this.makeHighlightConstants_(),this.highlightConstants.init()}refreshDom(e,o,i){super.refreshDom(e,o,i),this.getHighlightConstants().init()}makeConstants_(){return new Zg}makeRenderInfo_(e){return new zg(this,e)}makeDrawer_(e,o){return new Gg(e,o)}makePathObject(e,o){return new jg(e,o,this.getConstants())}makeHighlightConstants_(){return new Vg(this.getConstants())}getHighlightConstants(){if(!this.highlightConstants)throw Error("Cannot access the highlight constants because init has not been called");return this.highlightConstants}};ko("geras",Yg);var Do={};Do.ConstantProvider=Zg,Do.Drawer=Gg,Do.HighlightConstantProvider=Vg,Do.Highlighter=Hg,Do.InlineInput=qg,Do.PathObject=jg,Do.RenderInfo=zg,Do.Renderer=Yg,Do.StatementInput=Wg;var Xg=class extends Pr{constructor(e,o){super(e,o)}getRenderer(){return this.renderer_}addElemSpacing_(){let e=!1;for(var o=0;o<this.rows.length;o++)if(this.rows[o].hasExternalInput){e=!0;break}for(o=0;o<this.rows.length;o++){const s=this.rows[o];var i=s.elements;if(s.elements=[],s.startsWithElemSpacer()&&s.elements.push(new Ct(this.constants_,this.getInRowSpacing_(null,i[0]))),i.length){for(let n=0;n<i.length-1;n++){s.elements.push(i[n]);const l=this.getInRowSpacing_(i[n],i[n+1]);s.elements.push(new Ct(this.constants_,l))}s.elements.push(i[i.length-1]),s.endsWithElemSpacer()&&(i=this.getInRowSpacing_(i[i.length-1],null),e&&s.hasDummyInput&&(i+=this.constants_.TAB_WIDTH),s.elements.push(new Ct(this.constants_,i)))}}}getInRowSpacing_(e,o){if(!e)return o&&_.isField(o)&&o.isEditable?this.constants_.MEDIUM_PADDING:o&&_.isInlineInput(o)?this.constants_.MEDIUM_LARGE_PADDING:o&&_.isStatementInput(o)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!_.isInput(e)&&!o)return _.isField(e)&&e.isEditable?0===e.width?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:_.isIcon(e)?2*this.constants_.LARGE_PADDING+1:_.isHat(e)?this.constants_.NO_PADDING:_.isPreviousOrNextConnection(e)?this.constants_.LARGE_PADDING:_.isLeftRoundedCorner(e)?this.constants_.MIN_BLOCK_WIDTH:_.isJaggedEdge(e)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(_.isInput(e)&&!o){if(_.isExternalInput(e))return this.constants_.NO_PADDING;if(_.isInlineInput(e))return this.constants_.LARGE_PADDING;if(_.isStatementInput(e))return this.constants_.NO_PADDING}if(!_.isInput(e)&&o&&_.isInput(o)){if(_.isField(e)&&e.isEditable){if(_.isInlineInput(o)||_.isExternalInput(o))return this.constants_.SMALL_PADDING}else{if(_.isInlineInput(o)||_.isExternalInput(o))return this.constants_.MEDIUM_LARGE_PADDING;if(_.isStatementInput(o))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(_.isIcon(e)&&o&&!_.isInput(o))return this.constants_.LARGE_PADDING;if(_.isInlineInput(e)&&o&&_.isField(o))return o.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(_.isLeftSquareCorner(e)&&o){if(_.isHat(o))return this.constants_.NO_PADDING;if(_.isPreviousConnection(o)||_.isNextConnection(o))return o.notchOffset}return _.isLeftRoundedCorner(e)&&o?o.notchOffset-this.constants_.CORNER_RADIUS:_.isField(e)&&o&&_.isField(o)&&e.isEditable===o.isEditable?0===e.width?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING:o&&_.isJaggedEdge(o)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(e,o){return _.isTopRow(e)&&_.isBottomRow(o)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:_.isTopRow(e)||_.isBottomRow(o)?this.constants_.NO_PADDING:e.hasExternalInput&&o.hasExternalInput?this.constants_.LARGE_PADDING:!e.hasStatement&&o.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:e.hasStatement&&o.hasStatement||e.hasDummyInput||o.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(e,o){if(_.isSpacer(o))return e.yPos+o.height/2;if(_.isBottomRow(e))return e=e.yPos+e.height-e.descenderHeight,_.isNextConnection(o)?e+o.height/2:e-o.height/2;if(_.isTopRow(e))return _.isHat(o)?e.capline-o.height/2:e.capline+o.height/2;let i=e.yPos;return _.isField(o)&&e.hasStatement?i+(this.constants_.TALL_INPUT_FIELD_OFFSET_Y+o.height/2):i+e.height/2}finalize_(){let e=0,o=0;for(var i=0;i<this.rows.length;i++){const n=this.rows[i];n.yPos=o,n.xPos=this.startX,o+=n.height,e=Math.max(e,n.widthWithConnectedBlocks);var s=o-this.topRow.ascenderHeight;n===this.bottomRow&&s<this.constants_.MIN_BLOCK_HEIGHT&&(this.bottomRow.height+=s=this.constants_.MIN_BLOCK_HEIGHT-s,o+=s),this.recordElemPositions_(n)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(i=this.block_.nextConnection.targetBlock())&&(e=Math.max(e,i.getHeightWidth().width)),this.bottomRow.baseline=o-this.bottomRow.descenderHeight,this.widthWithChildren=e+this.startX,this.height=o,this.startY=this.topRow.capline}},Kg=class extends Lc{constructor(e){super(e)}makeRenderInfo_(e){return new Xg(this,e)}};ko("thrasos",Kg);var Jg={};Jg.RenderInfo=Xg,Jg.Renderer=Kg;var m_=new Wi("zelos",{colour_blocks:{colourPrimary:"#CF63CF",colourSecondary:"#C94FC9",colourTertiary:"#BD42BD"},list_blocks:{colourPrimary:"#9966FF",colourSecondary:"#855CD6",colourTertiary:"#774DCB"},logic_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC"},loop_blocks:{colourPrimary:"#0fBD8C",colourSecondary:"#0DA57A",colourTertiary:"#0B8E69"},math_blocks:{colourPrimary:"#59C059",colourSecondary:"#46B946",colourTertiary:"#389438"},procedure_blocks:{colourPrimary:"#FF6680",colourSecondary:"#FF4D6A",colourTertiary:"#FF3355"},text_blocks:{colourPrimary:"#FFBF00",colourSecondary:"#E6AC00",colourTertiary:"#CC9900"},variable_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},variable_dynamic_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},hat_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC",hat:"cap"}},{colour_category:{colour:"#CF63CF"},list_category:{colour:"#9966FF"},logic_category:{colour:"#4C97FF"},loop_category:{colour:"#0fBD8C"},math_category:{colour:"#59C059"},procedure_category:{colour:"#FF6680"},text_category:{colour:"#FFBF00"},variable_category:{colour:"#FF8C1A"},variable_dynamic_category:{colour:"#FF8C1A"}}),AE={Classic:Tc,Zelos:m_},Hd=class{constructor(e,o,i){this.id_=e.toolboxitemid||ct(),this.level_=(this.parent_=i||null)?this.parent_.getLevel()+1:0,this.toolboxItemDef_=e,this.parentToolbox_=o,this.workspace_=this.parentToolbox_.getWorkspace()}init(){}getDiv(){return null}getClickTarget(){return null}getId(){return this.id_}getParent(){return null}getLevel(){return this.level_}isSelectable(){return!1}isCollapsible(){return!1}dispose(){}setVisible_(e){}getFocusableElement(){const e=this.getDiv();if(!e)throw Error("Trying to access toolbox item before DOM is initialized.");if(!(e instanceof HTMLElement))throw Error("Toolbox item div is unexpectedly not an HTML element.");return e}getFocusableTree(){return this.parentToolbox_}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}},Wt=class extends Hd{constructor(e,o,i){super(e,o,i),this.colour_=this.name_="",this.labelDom_=this.iconDom_=this.rowContents_=this.rowDiv_=this.htmlDiv_=null,this.isDisabled_=this.isHidden_=!1,this.flyoutItems_=[],this.cssConfig_=this.makeDefaultCssConfig_()}init(){this.parseCategoryDef_(this.toolboxItemDef_),this.parseContents_(this.toolboxItemDef_),this.createDom_(),"true"===this.toolboxItemDef_.hidden&&this.hide()}makeDefaultCssConfig_(){return{container:"blocklyToolboxCategoryContainer",row:"blocklyToolboxCategory",rowcontentcontainer:"blocklyTreeRowContentContainer",icon:"blocklyToolboxCategoryIcon",label:"blocklyToolboxCategoryLabel",contents:"blocklyToolboxCategoryGroup",selected:"blocklyToolboxSelected",openicon:"blocklyToolboxCategoryIconOpen",closedicon:"blocklyToolboxCategoryIconClosed"}}parseContents_(e){if("custom"in e)this.flyoutItems_=e.custom;else if(e=e.contents)for(let o=0;o<e.length;o++){const i=e[o];Array.isArray(this.flyoutItems_)&&this.flyoutItems_.push(i)}}parseCategoryDef_(e){this.name_="name"in e?Ae(e.name):"",this.colour_=this.getColour_(e),Object.assign(this.cssConfig_,e.cssconfig||e.cssConfig)}createDom_(){this.htmlDiv_=this.createContainer_(),Yt(this.htmlDiv_,wt.TREEITEM),De(this.htmlDiv_,Fe.SELECTED,!1),De(this.htmlDiv_,Fe.LEVEL,this.level_+1),this.rowDiv_=this.createRowContainer_(),this.rowDiv_.style.pointerEvents="auto",this.htmlDiv_.appendChild(this.rowDiv_),this.rowContents_=this.createRowContentsContainer_(),this.rowContents_.style.pointerEvents="none",this.rowDiv_.appendChild(this.rowContents_),this.iconDom_=this.createIconDom_(),Yt(this.iconDom_,wt.PRESENTATION),this.rowContents_.appendChild(this.iconDom_),this.labelDom_=this.createLabelDom_(this.name_),this.rowContents_.appendChild(this.labelDom_);const e=this.labelDom_.getAttribute("id");return e&&De(this.htmlDiv_,Fe.LABELLEDBY,e),this.addColourBorder_(this.colour_),this.htmlDiv_}createContainer_(){const e=document.createElement("div");e.tabIndex=-1,e.id=this.getId();const o=this.cssConfig_.container;return o&&R(e,o),e}createRowContainer_(){const e=document.createElement("div");var o=this.cssConfig_.row;return o&&R(e,o),o=Wt.nestedPadding*this.getLevel()+"px",this.workspace_.RTL?e.style.paddingRight=o:e.style.paddingLeft=o,e}createRowContentsContainer_(){const e=document.createElement("div"),o=this.cssConfig_.rowcontentcontainer;return o&&R(e,o),e}createIconDom_(){const e=document.createElement("span");if(!this.parentToolbox_.isHorizontal()){const o=this.cssConfig_.icon;o&&R(e,o)}return e.style.display="inline-block",e}createLabelDom_(e){const o=document.createElement("span");return o.setAttribute("id",this.getId()+".label"),o.textContent=e,(e=this.cssConfig_.label)&&R(o,e),o}refreshTheme(){this.colour_=this.getColour_(this.toolboxItemDef_),this.addColourBorder_(this.colour_)}addColourBorder_(e){e&&(e=Wt.borderWidth+"px solid "+(e||"#ddd"),this.workspace_.RTL?this.rowDiv_.style.borderRight=e:this.rowDiv_.style.borderLeft=e)}getColour_(e){const o=e.categorystyle||e.categoryStyle;if((e=e.colour)&&o)console.warn('Toolbox category "'+this.name_+'" must not have both a style and a colour');else{if(o)return this.getColourfromStyle(o);if(e)return this.parseColour(e)}return""}getColourfromStyle(e){var o=this.workspace_.getTheme();if(e&&o){if((o=o.categoryStyles[e])&&o.colour)return this.parseColour(o.colour);console.warn('Style "'+e+'" must exist and contain a colour value')}return""}getClickTarget(){return this.rowDiv_}parseColour(e){if(null==(e=Ae(e))||""===e)return"";var o=Number(e);return isNaN(o)?(o=Ci(e))?o:(console.warn('Toolbox category "'+this.name_+'" has unrecognized colour attribute: '+e),""):Ba(o)}openIcon_(e){if(e){var o=this.cssConfig_.closedicon;o&&_i(e,o),(o=this.cssConfig_.openicon)&&R(e,o)}}closeIcon_(e){if(e){var o=this.cssConfig_.openicon;o&&_i(e,o),(o=this.cssConfig_.closedicon)&&R(e,o)}}setVisible_(e){this.htmlDiv_.style.display=e?"block":"none",this.isHidden_=!e,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}hide(){this.setVisible_(!1)}show(){this.setVisible_(!0)}isVisible(){return!this.isHidden_&&this.allAncestorsExpanded_()}allAncestorsExpanded_(){let e=this;for(;e.getParent();)if(e=e.getParent(),!e.isExpanded())return!1;return!0}isSelectable(){return this.isVisible()&&!this.isDisabled_}onClick(e){}setSelected(e){if(this.rowDiv_){var o=this.cssConfig_.selected;if(e){const i=this.parseColour(Wt.defaultBackgroundColour);this.rowDiv_.style.backgroundColor=this.colour_||i,o&&R(this.rowDiv_,o)}else this.rowDiv_.style.backgroundColor="",o&&te(this.rowDiv_,o);De(this.htmlDiv_,Fe.SELECTED,e)}}setDisabled(e){this.isDisabled_=e,this.getDiv().setAttribute("disabled",`${e}`),e?this.getDiv().setAttribute("disabled","true"):this.getDiv().removeAttribute("disabled")}getName(){return this.name_}getParent(){return this.parent_}getDiv(){return this.htmlDiv_}getContents(){return this.flyoutItems_}updateFlyoutContents(e){this.flyoutItems_=[],this.toolboxItemDef_="string"==typeof e?{kind:this.toolboxItemDef_.kind,custom:e,id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden}:{kind:this.toolboxItemDef_.kind,name:"name"in this.toolboxItemDef_?this.toolboxItemDef_.name:"",contents:$s(e),id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden},this.parseContents_(this.toolboxItemDef_)}dispose(){ce(this.htmlDiv_)}};Wt.registrationName="category",Wt.nestedPadding=19,Wt.borderWidth=8,Wt.defaultBackgroundColour="#57e",Dt('\n.blocklyToolboxCategory:not(.blocklyToolboxSelected):hover {\n  background-color: rgba(255, 255, 255, .2);\n}\n\n.blocklyToolbox[layout="h"] .blocklyToolboxCategoryContainer {\n  margin: 1px 5px 1px 0;\n}\n\n.blocklyToolbox[dir="RTL"][layout="h"] .blocklyToolboxCategoryContainer {\n  margin: 1px 0 1px 5px;\n}\n\n.blocklyToolboxCategory {\n  height: 22px;\n  line-height: 22px;\n  margin-bottom: 3px;\n  padding-right: 8px;\n  white-space: nowrap;\n}\n\n.blocklyToolbox[dir="RTL"] .blocklyToolboxCategory {\n  margin-left: 8px;\n  padding-right: 0;\n}\n\n.blocklyToolboxCategoryIcon {\n  background-image: url(<<<PATH>>>/sprites.png);\n  height: 16px;\n  vertical-align: middle;\n  visibility: hidden;\n  width: 16px;\n}\n\n.blocklyToolboxCategoryIconClosed {\n  background-position: -32px -1px;\n}\n\n.blocklyToolbox[dir="RTL"] .blocklyToolboxCategoryIconClosed {\n  background-position: 0 -1px;\n}\n\n.blocklyToolboxSelected>.blocklyToolboxCategoryIconClosed {\n  background-position: -32px -17px;\n}\n\n.blocklyToolbox[dir="RTL"] .blocklyToolboxSelected>.blocklyToolboxCategoryIconClosed {\n  background-position: 0 -17px;\n}\n\n.blocklyToolboxCategoryIconOpen {\n  background-position: -16px -1px;\n}\n\n.blocklyToolboxSelected>.blocklyToolboxCategoryIconOpen {\n  background-position: -16px -17px;\n}\n\n.blocklyToolboxCategoryLabel {\n  cursor: default;\n  font: 16px sans-serif;\n  padding: 0 3px;\n  vertical-align: middle;\n}\n\n.blocklyToolboxDelete .blocklyToolboxCategoryLabel {\n  cursor: url("<<<PATH>>>/handdelete.cur"), auto;\n}\n\n.blocklyToolboxSelected .blocklyToolboxCategoryLabel {\n  color: #fff;\n}\n'),D(w.TOOLBOX_ITEM,Wt.registrationName,Wt);var Hr=class extends Hd{constructor(e,o){super(e,o),this.cssConfig_={container:"blocklyTreeSeparator"},this.htmlDiv=null,Object.assign(this.cssConfig_,e.cssconfig||e.cssConfig)}init(){this.createDom_()}createDom_(){const e=document.createElement("div");e.tabIndex=-1,e.id=this.getId();const o=this.cssConfig_.container;return o&&R(e,o),this.htmlDiv=e}getDiv(){return this.htmlDiv}dispose(){ce(this.htmlDiv)}};Hr.registrationName="sep",Dt('\n.blocklyTreeSeparator {\n  border-bottom: solid #e5e5e5 1px;\n  height: 0;\n  margin: 5px 0;\n}\n\n.blocklyToolbox[layout="h"] .blocklyTreeSeparator {\n  border-right: solid #e5e5e5 1px;\n  border-bottom: none;\n  height: auto;\n  margin: 0 5px 0 5px;\n  padding: 5px 0;\n  width: 0;\n}\n'),D(w.TOOLBOX_ITEM,Hr.registrationName,Hr);var dn=class extends Wt{constructor(e,o,i){super(e,o,i),this.subcategoriesDiv_=null,this.expanded_=!1,this.toolboxItems_=[]}makeDefaultCssConfig_(){const e=super.makeDefaultCssConfig_();return e.contents="blocklyToolboxCategoryGroup",e}parseContents_(e){if("custom"in e)this.flyoutItems_=e.custom;else{const o=e.contents;if(o){this.flyoutItems_=[],e=!0;for(let i=0;i<o.length;i++){const s=o[i];!Po(w.TOOLBOX_ITEM,s.kind)||s.kind.toLowerCase()===Hr.registrationName&&e?(this.flyoutItems_.push(s),e=!0):(this.createToolboxItem(s),e=!1)}}}}createToolboxItem(e){let o=e.kind;"CATEGORY"===o.toUpperCase()&&Sn(e)&&(o=dn.registrationName),e=new($t(w.TOOLBOX_ITEM,o))(e,this.parentToolbox_,this),this.toolboxItems_.push(e)}init(){super.init(),this.setExpanded("true"===this.toolboxItemDef_.expanded||!0===this.toolboxItemDef_.expanded)}createDom_(){super.createDom_();const e=this.getChildToolboxItems();return this.subcategoriesDiv_=this.createSubCategoriesDom_(e),Yt(this.subcategoriesDiv_,wt.GROUP),this.htmlDiv_.appendChild(this.subcategoriesDiv_),this.closeIcon_(this.iconDom_),De(this.htmlDiv_,Fe.EXPANDED,!1),this.htmlDiv_}createIconDom_(){const e=document.createElement("span");if(!this.parentToolbox_.isHorizontal()){const o=this.cssConfig_.icon;o&&R(e,o),e.style.visibility="visible"}return e.style.display="inline-block",e}createSubCategoriesDom_(e){const o=document.createElement("div");o.style.display="none";var i=this.cssConfig_.contents;for(i&&R(o,i),i=0;i<e.length;i++){const s=e[i];s.init();const n=s.getDiv();if(o.appendChild(n),s.getClickTarget){let l;null==(l=s.getClickTarget())||l.setAttribute("id",s.getId())}}return o}setExpanded(e){if(this.expanded_!==e){if(this.expanded_=e)this.subcategoriesDiv_.style.display="block",this.openIcon_(this.iconDom_);else{let o;null==(o=this.parentToolbox_.getFlyout())||o.setVisible(!1),this.subcategoriesDiv_.style.display="none",this.closeIcon_(this.iconDom_)}De(this.htmlDiv_,Fe.EXPANDED,e),this.parentToolbox_.handleToolboxItemResize()}}setVisible_(e){this.htmlDiv_.style.display=e?"block":"none";const o=this.getChildToolboxItems();for(let i=0;i<o.length;i++)o[i].setVisible_(e);this.isHidden_=!e,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}isExpanded(){return this.expanded_}isCollapsible(){return!0}onClick(e){this.toggleExpanded()}toggleExpanded(){this.setExpanded(!this.expanded_)}getDiv(){return this.htmlDiv_}getChildToolboxItems(){return this.toolboxItems_}};dn.registrationName="collapsibleCategory",D(w.TOOLBOX_ITEM,dn.registrationName,dn);var Qg=class extends Cc{constructor(e){super(),this.id="toolbox",this.contentsDiv_=this.HtmlDiv=null,this.isVisible_=!1,this.height_=this.width_=0,this.flyout=null,this.contents=new Map,this.previouslySelectedItem_=this.selectedItem_=null,this.boundEvents_=[],this.workspace_=e,this.toolboxDef_=e.options.languageTree||{contents:[]},this.horizontalLayout=e.options.horizontalLayout,this.RTL=e.options.RTL,this.toolboxPosition=e.options.toolboxPosition}onShortcut(e){return!1}init(){var e=this.workspace_;const o=e.getParentSvg();this.flyout=this.createFlyout_(),this.HtmlDiv=this.createDom_(this.workspace_);const i=this.flyout.createDom("svg");R(i,"blocklyToolboxFlyout"),d(i,o),this.setVisible(!0),this.flyout.init(e),this.render(this.toolboxDef_),(e=e.getThemeManager()).subscribe(this.HtmlDiv,"toolboxBackgroundColour","background-color"),e.subscribe(this.HtmlDiv,"toolboxForegroundColour","color"),this.workspace_.getComponentManager().addComponent({component:this,weight:xe.ComponentWeight.TOOLBOX_WEIGHT,capabilities:[xe.Capability.AUTOHIDEABLE,xe.Capability.DELETE_AREA,xe.Capability.DRAG_TARGET]}),t.getFocusManager$$module$build$src$core$focus_manager().registerTree(this,!0)}createDom_(e){e=e.getParentSvg();const o=this.createContainer_();return o.id=ct(),this.contentsDiv_=this.createContentsContainer_(),Yt(this.contentsDiv_,wt.TREE),o.appendChild(this.contentsDiv_),e.parentNode.insertBefore(o,e),this.attachEvents_(o,this.contentsDiv_),o}createContainer_(){const e=document.createElement("div");return e.setAttribute("layout",this.isHorizontal()?"h":"v"),R(e,"blocklyToolbox"),e.setAttribute("dir",this.RTL?"RTL":"LTR"),e}createContentsContainer_(){const e=document.createElement("div");return R(e,"blocklyToolboxCategoryGroup"),this.isHorizontal()&&(e.style.flexDirection="row"),e}attachEvents_(e,o){e=U(e,"pointerdown",this,this.onClick_,!1),this.boundEvents_.push(e),o=U(o,"keydown",this,this.onKeyDown_,!1),this.boundEvents_.push(o)}onClick_(e){if(_t(e)||e.target===this.HtmlDiv)bt().hideChaff(!1);else{var o=e.target.getAttribute("id");o&&(o=this.getToolboxItemById(o)).isSelectable()&&(this.setSelectedItem(o),o.onClick(e)),bt().hideChaff(!0)}qe()}onKeyDown_(e){let o=!1;switch(e.key){case"ArrowDown":o=this.selectNext();break;case"ArrowUp":o=this.selectPrevious();break;case"ArrowLeft":o=this.selectParent();break;case"ArrowRight":o=this.selectChild();break;case"Enter":case" ":this.selectedItem_&&this.selectedItem_.isCollapsible()&&(this.selectedItem_.toggleExpanded(),o=!0);break;default:o=!1}!o&&this.selectedItem_&&this.selectedItem_.onKeyDown&&(o=this.selectedItem_.onKeyDown(e)),o&&e.preventDefault()}createFlyout_(){const e=this.workspace_,o=e.copyOptionsForFlyout();return o.toolboxPosition=e.options.toolboxPosition,new(Ve(e.horizontalLayout?w.FLYOUTS_HORIZONTAL_TOOLBOX:w.FLYOUTS_VERTICAL_TOOLBOX,e.options,!0))(o)}render(e){this.toolboxDef_=e,this.contents.forEach(o=>o.dispose()),this.contents.clear(),this.renderContents_(e.contents),this.position(),this.handleToolboxItemResize()}renderContents_(e){const o=document.createDocumentFragment();for(let i=0;i<e.length;i++)this.createToolboxItem(e[i],o);this.contentsDiv_.appendChild(o)}createToolboxItem(e,o){var i=e.kind;"CATEGORY"===i.toUpperCase()&&Sn(e)&&(i=dn.registrationName),(i=$t(w.TOOLBOX_ITEM,i.toLowerCase()))&&((e=new i(e,this)).init(),this.addToolboxItem_(e),(i=e.getDiv())&&o.appendChild(i),e.getClickTarget()&&e.getClickTarget().setAttribute("id",e.getId()))}addToolboxItem_(e){if(this.contents.set(e.getId(),e),e.isCollapsible()){e=e.getChildToolboxItems();for(let o=0;o<e.length;o++)this.addToolboxItem_(e[o])}}getToolboxItems(){return[...this.contents.values()]}addStyle(e){e&&this.HtmlDiv&&R(this.HtmlDiv,e)}removeStyle(e){e&&this.HtmlDiv&&te(this.HtmlDiv,e)}getClientRect(){if(!this.HtmlDiv||!this.isVisible_)return null;var e=this.HtmlDiv.getBoundingClientRect();const o=e.top,i=o+e.height,s=e.left;return e=s+e.width,this.toolboxPosition===j.TOP?new Q(-1e7,i,-1e7,1e7):this.toolboxPosition===j.BOTTOM?new Q(o,1e7,-1e7,1e7):this.toolboxPosition===j.LEFT?new Q(-1e7,1e7,-1e7,e):new Q(-1e7,1e7,s,1e7)}wouldDelete(e){return this.updateWouldDelete_(e instanceof $e?!e.getParent()&&e.isDeletable():le(e)&&e.isDeletable()),this.wouldDelete_}onDragEnter(e){this.updateCursorDeleteStyle_(!0)}onDragExit(e){this.updateCursorDeleteStyle_(!1)}onDrop(e){this.updateCursorDeleteStyle_(!1)}updateWouldDelete_(e){e!==this.wouldDelete_&&(this.updateCursorDeleteStyle_(!1),this.wouldDelete_=e,this.updateCursorDeleteStyle_(!0))}updateCursorDeleteStyle_(e){const o=this.wouldDelete_?"blocklyToolboxDelete":"blocklyToolboxGrab";e?this.addStyle(o):this.removeStyle(o)}getToolboxItemById(e){return this.contents.get(e)||null}getWidth(){return this.width_}getHeight(){return this.height_}getFlyout(){return this.flyout}getWorkspace(){return this.workspace_}getSelectedItem(){return this.selectedItem_}getPreviouslySelectedItem(){return this.previouslySelectedItem_}isHorizontal(){return this.horizontalLayout}position(){const e=this.workspace_.getMetrics(),o=this.HtmlDiv;o&&(this.horizontalLayout?(o.style.left="0",o.style.height="auto",o.style.width="100%",this.height_=o.offsetHeight,this.width_=e.viewWidth,this.toolboxPosition===j.TOP?o.style.top="0":o.style.bottom="0"):(this.toolboxPosition===j.RIGHT?o.style.right="0":o.style.left="0",o.style.height="100%",this.width_=o.offsetWidth,this.height_=e.viewHeight),this.flyout.position())}handleToolboxItemResize(){const e=this.workspace_;var o=this.HtmlDiv.getBoundingClientRect();const i=this.getFlyout(),s=this.toolboxPosition===j.LEFT?e.scrollX+o.width+(null!=i&&i.isVisible()?i.getWidth():0):e.scrollX;o=this.toolboxPosition===j.TOP?e.scrollY+o.height+(null!=i&&i.isVisible()?i.getHeight():0):e.scrollY,e.translate(s,o),Eo(e)}clearSelection(){this.setSelectedItem(null)}refreshTheme(){this.contents.forEach(e=>{e.refreshTheme&&e.refreshTheme()})}refreshSelection(){this.selectedItem_&&this.selectedItem_.isSelectable()&&this.selectedItem_.getContents().length&&this.flyout.show(this.selectedItem_.getContents())}setVisible(e){this.isVisible_!==e&&(this.HtmlDiv.style.display=e?"block":"none",this.isVisible_=e,this.workspace_.recordDragTargets())}autoHide(e){!e&&this.flyout&&this.flyout.autoClose&&this.clearSelection()}setSelectedItem(e){const o=this.selectedItem_;!e&&!o||e&&!Xh(e)||(this.shouldDeselectItem_(o,e)&&null!==o&&this.deselectItem_(o),this.shouldSelectItem_(o,e)&&null!==e&&this.selectItem_(o,e),this.updateFlyout_(o,e),this.fireSelectEvent(o,e))}shouldDeselectItem_(e,o){return null!==e&&(!e.isCollapsible()||e!==o)}shouldSelectItem_(e,o){return null!==o&&o!==e}deselectItem_(e){this.selectedItem_=null,this.previouslySelectedItem_=e,e.setSelected(!1),De(this.contentsDiv_,Fe.ACTIVEDESCENDANT,"")}selectItem_(e,o){this.selectedItem_=o,this.previouslySelectedItem_=e,o.setSelected(!0),De(this.contentsDiv_,Fe.ACTIVEDESCENDANT,o.getId())}selectItemByPosition(e){(e=this.getToolboxItems()[e])&&this.setSelectedItem(e)}updateFlyout_(e,o){o&&(e!==o||o.isCollapsible())&&o.getContents().length?(this.flyout.show(o.getContents()),this.flyout.scrollToStart()):this.flyout.hide()}fireSelectEvent(e,o){const i=e&&e.getName();let s=o&&o.getName();e===o&&(s=null),e=new(B(E.TOOLBOX_ITEM_SELECT))(i,s,this.workspace_.id),L(e)}selectParent(){return!(!this.selectedItem_||(this.selectedItem_.isCollapsible()&&this.selectedItem_.isExpanded()?(this.selectedItem_.toggleExpanded(),0):!this.selectedItem_.getParent()||!this.selectedItem_.getParent().isSelectable()||(this.setSelectedItem(this.selectedItem_.getParent()),0)))}selectChild(){if(!this.selectedItem_||!this.selectedItem_.isCollapsible())return!1;const e=this.selectedItem_;return e.isExpanded()?this.selectNext():e.toggleExpanded(),!0}selectNext(){if(!this.selectedItem_)return!1;const e=[...this.contents.values()];let o=e.indexOf(this.selectedItem_)+1;if(o>-1&&o<e.length){let i=e[o];for(;i&&!i.isSelectable();)i=e[++o];if(i&&i.isSelectable())return this.setSelectedItem(i),!0}return!1}selectPrevious(){if(!this.selectedItem_)return!1;const e=[...this.contents.values()];let o=e.indexOf(this.selectedItem_)-1;if(o>-1&&o<e.length){let i=e[o];for(;i&&!i.isSelectable();)i=e[--o];if(i&&i.isSelectable())return this.setSelectedItem(i),!0}return!1}dispose(){this.workspace_.getComponentManager().removeComponent("toolbox"),this.flyout.dispose(),this.contents.forEach(e=>e.dispose());for(let e=0;e<this.boundEvents_.length;e++)ne(this.boundEvents_[e]);this.boundEvents_=[],this.contents.clear(),this.HtmlDiv&&(this.workspace_.getThemeManager().unsubscribe(this.HtmlDiv),ce(this.HtmlDiv)),t.getFocusManager$$module$build$src$core$focus_manager().unregisterTree(this)}getFocusableElement(){if(!this.HtmlDiv)throw Error("Toolbox DOM has not yet been created.");return this.HtmlDiv}getFocusableTree(){return this}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}getRootFocusableNode(){return this}getRestoredFocusableNode(e){if(!e||e===this){let o;return null!=(o=this.getToolboxItems().find(i=>i.isSelectable()))?o:null}return null}getNestedTrees(){return[]}lookUpFocusableNode(e){return this.getToolboxItemById(e)}onTreeFocus(e,o){e!==this?this.getSelectedItem()!==e&&this.setSelectedItem(e):this.clearSelection()}onTreeBlur(e){let o;e&&e===(null==(o=this.flyout)?void 0:o.getWorkspace())||(this.clearSelection(),this.flyout&&kt(this.flyout)&&this.flyout.autoHide(!1))}};Dt('\n.blocklyToolboxDelete {\n  cursor: url("<<<PATH>>>/handdelete.cur"), auto;\n}\n\n.blocklyToolboxGrab {\n  cursor: url("<<<PATH>>>/handclosed.cur"), auto;\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n}\n\n/* Category tree in Toolbox. */\n.blocklyToolbox {\n  box-sizing: border-box;\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n  background-color: #ddd;\n  overflow-x: visible;\n  overflow-y: auto;\n  padding: 4px 0 4px 0;\n  position: absolute;\n  z-index: 70;  /* so blocks go under toolbox when dragging */\n  -webkit-tap-highlight-color: transparent;  /* issue #1345 */\n}\n\n.blocklyToolboxCategoryGroup {\n  display: flex;\n  flex-wrap: wrap;\n  flex-direction: column;\n}\n\n.blocklyToolboxCategoryGroup:focus {\n  outline: none;\n}\n'),D(w.TOOLBOX,vt,Qg);var BE=N.INPUT_VALUE,PE=N.OUTPUT_VALUE,FE=N.NEXT_STATEMENT,UE=N.PREVIOUS_STATEMENT,ZE=j.TOP,HE=j.BOTTOM,GE=j.LEFT,VE=j.RIGHT;cn.prototype.newBlock=function(e,o){return new nn(this,e,o)},nt.prototype.newBlock=function(e,o){return new $e(this,e,o)},cn.prototype.newComment=function(e){return new fc(this,e)},nt.prototype.newComment=function(e){return new so(this,e)},nt.newTrashcan=function(e){return new fg(e)},So.prototype.newWorkspaceSvg=function(e){return new nt(e)},t.Names$$module$build$src$core$names.prototype.populateProcedures=function(e){e=(e=Ai(e))[0].concat(e[1]);for(let o=0;o<e.length;o++)this.getName(e[o][0],t.Names$$module$build$src$core$names.NameType.PROCEDURE)};var x={};return x.Block=nn,x.BlockFlyoutInflater=Ug,x.BlockNavigationPolicy=Yp,x.BlockSvg=$e,x.Blocks=ye,x.ButtonFlyoutInflater=Pg,x.COLLAPSED_FIELD_NAME=ac,x.COLLAPSED_INPUT_NAME=yr,x.COLLAPSE_CHARS=30,x.CodeGenerator=t.CodeGenerator$$module$build$src$core$generator,x.CollapsibleToolboxCategory=dn,x.ComponentManager=xe,x.Connection=se,x.ConnectionChecker=mg,x.ConnectionDB=on,x.ConnectionNavigationPolicy=Kp,x.ConnectionType=N,x.ContextMenu=tn,x.ContextMenuItems=Ke,x.ContextMenuRegistry=K,x.Css=up,x.DELETE_VARIABLE_ID=vc,x.DeleteArea=Cc,x.DragTarget=Vp,x.DropDownDiv=st,x.Events=M,x.Extensions=ro,x.Field=ue,x.FieldCheckbox=es,x.FieldDropdown=ot,x.FieldImage=Ji,x.FieldLabel=zi,x.FieldLabelSerializable=Ng,x.FieldNavigationPolicy=Jp,x.FieldNumber=Id,x.FieldTextInput=t.FieldTextInput$$module$build$src$core$field_textinput,x.FieldVariable=Zr,x.Flyout=Ic,x.FlyoutButton=pt,x.FlyoutButtonNavigationPolicy=Wp,x.FlyoutItem=rn,x.FlyoutMetricsManager=qp,x.FlyoutNavigationPolicy=zp,x.FlyoutNavigator=eg,x.FlyoutSeparator=kc,x.FlyoutSeparatorNavigationPolicy=jp,x.FocusManager=tt,x.FocusableTreeTraverser=je,x.Generator=t.CodeGenerator$$module$build$src$core$generator,x.Gesture=Ac,x.Grid=sd,x.HorizontalFlyout=Mg,x.INPUT_VALUE=BE,x.Input=sn,x.InsertionMarkerPreviewer=Rg,x.KeyboardNavigationController=og,x.LabelFlyoutInflater=xg,x.LineCursor=nd,x.Marker=sg,x.MarkerManager=rd,x.Menu=ku,x.MenuItem=cc,x.MetricsManager=td,x.Msg=t.Msg$$module$build$src$core$msg,x.NEXT_STATEMENT=FE,x.Names=t.Names$$module$build$src$core$names,x.Navigator=od,x.OPPOSITE_TYPE=ni,x.OUTPUT_VALUE=PE,x.Options=no,x.PREVIOUS_STATEMENT=UE,x.PROCEDURE_CATEGORY_NAME=Sc,x.Procedures=gt,x.RENAME_VARIABLE_ID=Ec,x.RenderedConnection=Xe,x.Scrollbar=Oe,x.ScrollbarPair=id,x.SeparatorFlyoutInflater=tg,x.ShortcutItems=Mo,x.ShortcutRegistry=be,x.TOOLBOX_AT_BOTTOM=HE,x.TOOLBOX_AT_LEFT=GE,x.TOOLBOX_AT_RIGHT=VE,x.TOOLBOX_AT_TOP=ZE,x.Theme=Wi,x.ThemeManager=gg,x.Themes=AE,x.Toast=Zi,x.Toolbox=Qg,x.ToolboxCategory=Wt,x.ToolboxItem=Hd,x.ToolboxSeparator=Hr,x.Tooltip=At,x.Touch=Ws,x.Trashcan=fg,x.UnattachedFieldError=Me,x.VARIABLE_CATEGORY_NAME=Au,x.VARIABLE_DYNAMIC_CATEGORY_NAME=$d,x.VERSION="12.2.0",x.VariableMap=bg,x.VariableModel=_g,x.Variables=Le,x.VariablesDynamic=Xi,x.VerticalFlyout=kd,x.WidgetDiv=io,x.Workspace=cn,x.WorkspaceAudio=$g,x.WorkspaceDragger=ig,x.WorkspaceNavigationPolicy=Qp,x.WorkspaceSvg=nt,x.Xml=ht,x.ZoomControls=pp,x.blockAnimations=xc,x.blockRendering=ge,x.browserEvents=Qo,x.bubbles=Zc,x.bumpObjects=ed,x.clipboard=uo,x.comments=Ki,x.common=Ye,x.config=t.config$$module$build$src$core$config,x.constants=X_,x.defineBlocksWithJsonArray=kn,x.dialog=ii,x.dragging=Uc,x.fieldRegistry=Yu,x.geras=Do,x.getFocusManager=t.getFocusManager$$module$build$src$core$focus_manager,x.getMainWorkspace=bt,x.getSelected=fo,x.hasBubble=jo,x.hideChaff=sm,x.icons=ji,x.inject=mr,x.inputs=Qi,x.isCopyable=Ni,x.isDeletable=le,x.isDraggable=ut,x.isIcon=Z,x.isObservable=Ut,x.isPaster=jh,x.isRenderedElement=Yh,x.isSelectable=as,x.isSerializable=fs,x.isVariableBackedParameterModel=nl,x.keyboardNavigationController=wc,x.layers=nb,x.navigateBlock=Se,x.navigateStacks=Pe,x.procedures=gt,x.registry=Jo,x.renderManagement=wu,x.serialization=wT,x.setLocale=Ep,x.setParentContainer=Cn,x.svgResize=Eo,x.thrasos=Jg,x.uiPosition=Xs,x.utils=Ie,x.zelos=No,x.__namespace__=t,x})?Ee.apply(po,[]):Ee)&&(ci.exports=Je)},8927:function(ci,po,Ee){var V,Je,t;Je=[Ee(7519)],V=function(D){var p=D.__namespace__,mt=p.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"variables_get_dynamic",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_dynamic_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableDynamicSetterGetter"]},{type:"variables_set_dynamic",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_dynamic_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableDynamicSetterGetter"]}]),Bo={customContextMenu:function(d){if(this.isInFlyout)("variables_get_dynamic"===this.type||"variables_get_reporter_dynamic"===this.type)&&(b={text:p.Msg$$module$build$src$core$msg.RENAME_VARIABLE,enabled:!0,callback:Po(this)},y=this.getField("VAR").getText(),y={text:p.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",y),enabled:!0,callback:$t(this)},d.unshift(b),d.unshift(y));else{if("variables_get_dynamic"===this.type)var m="variables_set_dynamic",b=p.Msg$$module$build$src$core$msg.VARIABLES_GET_CREATE_SET;else m="variables_get_dynamic",b=p.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET;var y=this.getField("VAR");m={type:m,fields:{VAR:y.saveState(!0)}},d.push({enabled:this.workspace.remainingCapacity()>0,text:b.replace("%1",y.getText()),callback:p.callbackFactory$$module$build$src$core$contextmenu(this,m)})}},onchange:function(d){d=this.getFieldValue("VAR"),d=p.getVariable$$module$build$src$core$variables(this.workspace,d),"variables_get_dynamic"===this.type?this.outputConnection.setCheck(d.getType()):this.getInput("VALUE").connection.setCheck(d.getType())}},Po=function(d){return function(){const m=d.workspace,b=d.getField("VAR").getVariable();p.renameVariable$$module$build$src$core$variables(m,b)}},$t=function(d){return function(){const m=d.getField("VAR").getVariable();m&&p.deleteVariable$$module$build$src$core$variables(m.getWorkspace(),m,d)}};p.registerMixin$$module$build$src$core$extensions("contextMenu_variableDynamicSetterGetter",Bo),p.defineBlocks$$module$build$src$core$common(mt);var Rt={blocks:mt},go=p.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"variables_get",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableSetterGetter"]},{type:"variables_set",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableSetterGetter"]}]),Ve={customContextMenu:function(d){if(this.isInFlyout)("variables_get"===this.type||"variables_get_reporter"===this.type)&&(b={text:p.Msg$$module$build$src$core$msg.RENAME_VARIABLE,enabled:!0,callback:ts(this)},y=this.getField("VAR").getText(),y={text:p.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",y),enabled:!0,callback:it(this)},d.unshift(b),d.unshift(y));else{if("variables_get"===this.type)var m="variables_set",b=p.Msg$$module$build$src$core$msg.VARIABLES_GET_CREATE_SET;else m="variables_get",b=p.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET;var y=this.getField("VAR");m={type:m,fields:{VAR:y.saveState(!0)}},d.push({enabled:this.workspace.remainingCapacity()>0,text:b.replace("%1",y.getText()),callback:p.callbackFactory$$module$build$src$core$contextmenu(this,m)})}}},ts=function(d){return function(){const m=d.workspace,b=d.getField("VAR").getVariable();p.renameVariable$$module$build$src$core$variables(m,b)}},it=function(d){return function(){const m=d.getField("VAR").getVariable();m&&p.deleteVariable$$module$build$src$core$variables(m.getWorkspace(),m,d)}};p.registerMixin$$module$build$src$core$extensions("contextMenu_variableSetterGetter",Ve),p.defineBlocks$$module$build$src$core$common(go);var qe={blocks:go},fe=p.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"text",message0:"%1",args0:[{type:"field_input",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["text_quotes","parent_tooltip_when_inline"]},{type:"text_join",message0:"",output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_JOIN_HELPURL}",tooltip:"%{BKY_TEXT_JOIN_TOOLTIP}",mutator:"text_join_mutator"},{type:"text_create_join_container",message0:"%{BKY_TEXT_CREATE_JOIN_TITLE_JOIN} %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"STACK"}],style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_TOOLTIP}",enableContextMenu:!1},{type:"text_create_join_item",message0:"%{BKY_TEXT_CREATE_JOIN_ITEM_TITLE_ITEM}",previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_ITEM_TOOLTIP}",enableContextMenu:!1},{type:"text_append",message0:"%{BKY_TEXT_APPEND_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_TEXT_APPEND_VARIABLE}"},{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",extensions:["text_append_tooltip"]},{type:"text_length",message0:"%{BKY_TEXT_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"text_blocks",tooltip:"%{BKY_TEXT_LENGTH_TOOLTIP}",helpUrl:"%{BKY_TEXT_LENGTH_HELPURL}"},{type:"text_isEmpty",message0:"%{BKY_TEXT_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"text_blocks",tooltip:"%{BKY_TEXT_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_TEXT_ISEMPTY_HELPURL}"},{type:"text_indexOf",message0:"%{BKY_TEXT_INDEXOF_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"END",options:[["%{BKY_TEXT_INDEXOF_OPERATOR_FIRST}","FIRST"],["%{BKY_TEXT_INDEXOF_OPERATOR_LAST}","LAST"]]},{type:"input_value",name:"FIND",check:"String"}],output:"Number",style:"text_blocks",helpUrl:"%{BKY_TEXT_INDEXOF_HELPURL}",inputsInline:!0,extensions:["text_indexOf_tooltip"]},{type:"text_charAt",message0:"%{BKY_TEXT_CHARAT_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"WHERE",options:[["%{BKY_TEXT_CHARAT_FROM_START}","FROM_START"],["%{BKY_TEXT_CHARAT_FROM_END}","FROM_END"],["%{BKY_TEXT_CHARAT_FIRST}","FIRST"],["%{BKY_TEXT_CHARAT_LAST}","LAST"],["%{BKY_TEXT_CHARAT_RANDOM}","RANDOM"]]}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_CHARAT_HELPURL}",inputsInline:!0,mutator:"text_charAt_mutator"}]);fe.text_getSubstring={init:function(){this.WHERE_OPTIONS_1=[[p.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FROM_START,"FROM_START"],[p.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FROM_END,"FROM_END"],[p.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[p.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_FROM_START,"FROM_START"],[p.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_FROM_END,"FROM_END"],[p.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_LAST,"LAST"]],this.setHelpUrl(p.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("STRING").setCheck("String").appendField(p.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT);const d=m=>{const b=p.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this["WHERE_OPTIONS_"+m]});return b.setValidator(function(y){const O=this.getValue();(y="FROM_START"===y||"FROM_END"===y)!=("FROM_START"===O||"FROM_END"===O)&&this.getSourceBlock().updateAt_(m,y)}),b};this.appendDummyInput("WHERE1_INPUT").appendField(d(1),"WHERE1"),this.appendDummyInput("AT1"),this.appendDummyInput("WHERE2_INPUT").appendField(d(2),"WHERE2"),this.appendDummyInput("AT2"),p.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL&&this.appendDummyInput("TAIL").appendField(p.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL),this.setInputsInline(!0),this.setOutput(!0,"String"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(p.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TOOLTIP)},mutationToDom:function(){const d=p.createElement$$module$build$src$core$utils$xml("mutation");var m=this.getInput("AT1")instanceof p.ValueInput$$module$build$src$core$inputs$value_input;return d.setAttribute("at1",`${m}`),m=this.getInput("AT2")instanceof p.ValueInput$$module$build$src$core$inputs$value_input,d.setAttribute("at2",`${m}`),d},domToMutation:function(d){const m="true"===d.getAttribute("at1");d="true"===d.getAttribute("at2"),this.updateAt_(1,m),this.updateAt_(2,d)},updateAt_:function(d,m){this.removeInput("AT"+d),this.removeInput("ORDINAL"+d,!0),m?(this.appendValueInput("AT"+d).setCheck("Number"),p.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+d).appendField(p.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+d),2===d&&p.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(p.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL)),1===d&&(this.moveInputBefore("AT1","WHERE2_INPUT"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","WHERE2_INPUT"))}},fe.text_changeCase={init:function(){const d=[[p.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE,"UPPERCASE"],[p.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE,"LOWERCASE"],[p.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_TITLECASE,"TITLECASE"]];this.setHelpUrl(p.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(p.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:d}),"CASE"),this.setOutput(!0,"String"),this.setTooltip(p.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_TOOLTIP)}},fe.text_trim={init:function(){const d=[[p.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_BOTH,"BOTH"],[p.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_LEFT,"LEFT"],[p.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_RIGHT,"RIGHT"]];this.setHelpUrl(p.Msg$$module$build$src$core$msg.TEXT_TRIM_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(p.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:d}),"MODE"),this.setOutput(!0,"String"),this.setTooltip(p.Msg$$module$build$src$core$msg.TEXT_TRIM_TOOLTIP)}},fe.text_print={init:function(){this.jsonInit({message0:p.Msg$$module$build$src$core$msg.TEXT_PRINT_TITLE,args0:[{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:p.Msg$$module$build$src$core$msg.TEXT_PRINT_TOOLTIP,helpUrl:p.Msg$$module$build$src$core$msg.TEXT_PRINT_HELPURL})}};var ai={updateType_:function(d){this.outputConnection.setCheck("NUMBER"===d?"Number":"String")},mutationToDom:function(){const d=p.createElement$$module$build$src$core$utils$xml("mutation");return d.setAttribute("type",this.getFieldValue("TYPE")),d},domToMutation:function(d){this.updateType_(d.getAttribute("type"))}};fe.text_prompt_ext=Object.assign({},ai,{init:function(){var d=[[p.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[p.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(p.Msg$$module$build$src$core$msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),(d=p.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:d})).setValidator(m=>{this.updateType_(m)}),this.appendValueInput("TEXT").appendField(d,"TYPE"),this.setOutput(!0,"String"),this.setTooltip(()=>"TEXT"===this.getFieldValue("TYPE")?p.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_TEXT:p.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_NUMBER)}}),fe.text_prompt=Object.assign({},ai,{init:function(){this.mixin(U);var d=[[p.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[p.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(p.Msg$$module$build$src$core$msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),(d=p.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:d})).setValidator(m=>{this.updateType_(m)}),this.appendDummyInput().appendField(d,"TYPE").appendField(this.newQuote_(!0)).appendField(p.fromJson$$module$build$src$core$field_registry({type:"field_input",text:""}),"TEXT").appendField(this.newQuote_(!1)),this.setOutput(!0,"String"),this.setTooltip(()=>"TEXT"===this.getFieldValue("TYPE")?p.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_TEXT:p.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_NUMBER)}}),fe.text_count={init:function(){this.jsonInit({message0:p.Msg$$module$build$src$core$msg.TEXT_COUNT_MESSAGE0,args0:[{type:"input_value",name:"SUB",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"Number",inputsInline:!0,style:"text_blocks",tooltip:p.Msg$$module$build$src$core$msg.TEXT_COUNT_TOOLTIP,helpUrl:p.Msg$$module$build$src$core$msg.TEXT_COUNT_HELPURL})}},fe.text_replace={init:function(){this.jsonInit({message0:p.Msg$$module$build$src$core$msg.TEXT_REPLACE_MESSAGE0,args0:[{type:"input_value",name:"FROM",check:"String"},{type:"input_value",name:"TO",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:p.Msg$$module$build$src$core$msg.TEXT_REPLACE_TOOLTIP,helpUrl:p.Msg$$module$build$src$core$msg.TEXT_REPLACE_HELPURL})}},fe.text_reverse={init:function(){this.jsonInit({message0:p.Msg$$module$build$src$core$msg.TEXT_REVERSE_MESSAGE0,args0:[{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:p.Msg$$module$build$src$core$msg.TEXT_REVERSE_TOOLTIP,helpUrl:p.Msg$$module$build$src$core$msg.TEXT_REVERSE_HELPURL})}};var U={QUOTE_IMAGE_LEFT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAn0lEQVQI1z3OMa5BURSF4f/cQhAKjUQhuQmFNwGJEUi0RKN5rU7FHKhpjEH3TEMtkdBSCY1EIv8r7nFX9e29V7EBAOvu7RPjwmWGH/VuF8CyN9/OAdvqIXYLvtRaNjx9mMTDyo+NjAN1HNcl9ZQ5oQMM3dgDUqDo1l8DzvwmtZN7mnD+PkmLa+4mhrxVA9fRowBWmVBhFy5gYEjKMfz9AylsaRRgGzvZAAAAAElFTkSuQmCC",QUOTE_IMAGE_RIGHT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAqUlEQVQI1z3KvUpCcRiA8ef9E4JNHhI0aFEacm1o0BsI0Slx8wa8gLauoDnoBhq7DcfWhggONDmJJgqCPA7neJ7p934EOOKOnM8Q7PDElo/4x4lFb2DmuUjcUzS3URnGib9qaPNbuXvBO3sGPHJDRG6fGVdMSeWDP2q99FQdFrz26Gu5Tq7dFMzUvbXy8KXeAj57cOklgA+u1B5AoslLtGIHQMaCVnwDnADZIFIrXsoXrgAAAABJRU5ErkJggg==",QUOTE_IMAGE_WIDTH:12,QUOTE_IMAGE_HEIGHT:12,quoteField_:function(d){for(let b,m=0;b=this.inputList[m];m++)for(let O,y=0;O=b.fieldRow[y];y++)if(d===O.name)return b.insertFieldAt(y,this.newQuote_(!0)),void b.insertFieldAt(y+2,this.newQuote_(!1));console.warn('field named "'+d+'" not found in '+this.toDevString())},newQuote_:function(d){return p.fromJson$$module$build$src$core$field_registry({type:"field_image",src:(d=this.RTL?!d:d)?this.QUOTE_IMAGE_LEFT_DATAURI:this.QUOTE_IMAGE_RIGHT_DATAURI,width:this.QUOTE_IMAGE_WIDTH,height:this.QUOTE_IMAGE_HEIGHT,alt:d?"\u201c":"\u201d"})}},ne={itemCount_:0,mutationToDom:function(){const d=p.createElement$$module$build$src$core$utils$xml("mutation");return d.setAttribute("items",`${this.itemCount_}`),d},domToMutation:function(d){this.itemCount_=parseInt(d.getAttribute("items"),10),this.updateShape_()},saveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function(d){this.itemCount_=d.itemCount,this.updateShape_()},decompose:function(d){const m=d.newBlock("text_create_join_container");m.initSvg();let b=m.getInput("STACK").connection;for(let y=0;y<this.itemCount_;y++){const O=d.newBlock("text_create_join_item");O.initSvg(),b.connect(O.previousConnection),b=O.nextConnection}return m},compose:function(d){var m=d.getInputTargetBlock("STACK");for(d=[];m;)m.isInsertionMarker()||d.push(m.valueConnection_),m=m.getNextBlock();for(m=0;m<this.itemCount_;m++){const b=this.getInput("ADD"+m).connection.targetConnection;b&&!d.includes(b)&&b.disconnect()}for(this.itemCount_=d.length,this.updateShape_(),m=0;m<this.itemCount_;m++){let b;null==(b=d[m])||b.reconnect(this,"ADD"+m)}},saveConnections:function(d){d=d.getInputTargetBlock("STACK");let m=0;for(;d;){if(d.isInsertionMarker()){d=d.getNextBlock();continue}const b=this.getInput("ADD"+m);d.valueConnection_=b&&b.connection.targetConnection,d=d.getNextBlock(),m++}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(this.newQuote_(!0)).appendField(this.newQuote_(!1));for(var d=0;d<this.itemCount_;d++)if(!this.getInput("ADD"+d)){const m=this.appendValueInput("ADD"+d).setAlign(p.Align$$module$build$src$core$inputs$align.RIGHT);0===d&&m.appendField(p.Msg$$module$build$src$core$msg.TEXT_JOIN_TITLE_CREATEWITH)}for(d=this.itemCount_;this.getInput("ADD"+d);d++)this.removeInput("ADD"+d)}};p.register$$module$build$src$core$extensions("text_append_tooltip",p.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_TEXT_APPEND_TOOLTIP}","VAR"));var $o={isAt_:!1,mutationToDom:function(){const d=p.createElement$$module$build$src$core$utils$xml("mutation");return d.setAttribute("at",`${this.isAt_}`),d},domToMutation:function(d){d="false"!==d.getAttribute("at"),this.updateAt_(d)},updateAt_:function(d){this.removeInput("AT",!0),this.removeInput("ORDINAL",!0),d&&(this.appendValueInput("AT").setCheck("Number"),p.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(p.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)),p.Msg$$module$build$src$core$msg.TEXT_CHARAT_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(p.Msg$$module$build$src$core$msg.TEXT_CHARAT_TAIL)),this.isAt_=d}};p.register$$module$build$src$core$extensions("text_indexOf_tooltip",function(){this.setTooltip(()=>p.Msg$$module$build$src$core$msg.TEXT_INDEXOF_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"0":"-1"))}),p.register$$module$build$src$core$extensions("text_quotes",function(){this.mixin(U),this.quoteField_("TEXT")}),p.registerMixin$$module$build$src$core$extensions("quote_image_mixin",U),p.registerMutator$$module$build$src$core$extensions("text_join_mutator",ne,function(){this.mixin(U),this.itemCount_=2,this.updateShape_(),this.setMutator(new p.MutatorIcon$$module$build$src$core$icons$mutator_icon(["text_create_join_item"],this))}),p.registerMutator$$module$build$src$core$extensions("text_charAt_mutator",$o,function(){this.getField("WHERE").setValidator(function(d){d="FROM_START"===d||"FROM_END"===d;const m=this.getSourceBlock();d!==m.isAt_&&m.updateAt_(d)}),this.updateAt_(!0),this.setTooltip(()=>{var d=this.getFieldValue("WHERE");let m=p.Msg$$module$build$src$core$msg.TEXT_CHARAT_TOOLTIP;return("FROM_START"===d||"FROM_END"===d)&&(d="FROM_START"===d?p.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP:p.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_END_TOOLTIP)&&(m+="  "+d.replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),m})}),p.defineBlocks$$module$build$src$core$common(fe);var ct={blocks:fe},Ne={},_o={setStatements_:function(d){this.hasStatements_!==d&&(d?(this.appendStatementInput("STACK").appendField(p.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_DO),this.getInput("RETURN")&&this.moveInputBefore("STACK","RETURN")):this.removeInput("STACK",!0),this.hasStatements_=d)},updateParams_:function(){let d="";this.arguments_.length&&(d=p.Msg$$module$build$src$core$msg.PROCEDURES_BEFORE_PARAMS+" "+this.arguments_.join(", ")),p.disable$$module$build$src$core$events$utils();try{this.setFieldValue(d,"PARAMS")}finally{p.enable$$module$build$src$core$events$utils()}},mutationToDom:function(d){const m=p.createElement$$module$build$src$core$utils$xml("mutation");d&&m.setAttribute("name",this.getFieldValue("NAME"));for(let b=0;b<this.argumentVarModels_.length;b++){const y=p.createElement$$module$build$src$core$utils$xml("arg"),O=this.argumentVarModels_[b];y.setAttribute("name",O.getName()),y.setAttribute("varid",O.getId()),d&&this.paramIds_&&y.setAttribute("paramId",this.paramIds_[b]),m.appendChild(y)}return this.hasStatements_||m.setAttribute("statements","false"),m},domToMutation:function(d){this.arguments_=[],this.argumentVarModels_=[];for(let y,b=0;y=d.childNodes[b];b++)if("arg"===y.nodeName.toLowerCase()){var m=y;const O=m.getAttribute("name");m=m.getAttribute("varid")||m.getAttribute("varId"),this.arguments_.push(O),null!==(m=p.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,m,O,""))?this.argumentVarModels_.push(m):console.log(`Failed to create a variable named "${O}", ignoring.`)}this.updateParams_(),p.mutateCallers$$module$build$src$core$procedures(this),this.setStatements_("false"!==d.getAttribute("statements"))},saveExtraState:function(){if(!this.argumentVarModels_.length&&this.hasStatements_)return null;const d=Object.create(null);if(this.argumentVarModels_.length){d.params=[];for(let m=0;m<this.argumentVarModels_.length;m++)d.params.push({name:this.argumentVarModels_[m].getName(),id:this.argumentVarModels_[m].getId()})}return this.hasStatements_||(d.hasStatements=!1),d},loadExtraState:function(d){if(this.arguments_=[],this.argumentVarModels_=[],d.params)for(let b=0;b<d.params.length;b++){var m=d.params[b];m=p.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,m.id,m.name,""),this.arguments_.push(m.getName()),this.argumentVarModels_.push(m)}this.updateParams_(),p.mutateCallers$$module$build$src$core$procedures(this),this.setStatements_(!1!==d.hasStatements)},decompose:function(d){const m=p.createElement$$module$build$src$core$utils$xml("block");m.setAttribute("type","procedures_mutatorcontainer");var b=p.createElement$$module$build$src$core$utils$xml("statement");b.setAttribute("name","STACK"),m.appendChild(b);for(let O=0;O<this.arguments_.length;O++){const Ce=p.createElement$$module$build$src$core$utils$xml("block");Ce.setAttribute("type","procedures_mutatorarg");var y=p.createElement$$module$build$src$core$utils$xml("field");y.setAttribute("name","NAME");const Mt=p.createTextNode$$module$build$src$core$utils$xml(this.arguments_[O]);y.appendChild(Mt),Ce.appendChild(y),y=p.createElement$$module$build$src$core$utils$xml("next"),Ce.appendChild(y),b.appendChild(Ce),b=y}return d=p.domToBlock$$module$build$src$core$xml(m,d),"procedures_defreturn"===this.type?d.setFieldValue(this.hasStatements_,"STATEMENTS"):d.removeInput("STATEMENT_INPUT"),p.mutateCallers$$module$build$src$core$procedures(this),d},compose:function(d){this.arguments_=[],this.paramIds_=[],this.argumentVarModels_=[];let m=d.getInputTargetBlock("STACK");for(;m&&!m.isInsertionMarker();){var b=m.getFieldValue("NAME");this.arguments_.push(b),b=this.workspace.getVariable(b,""),this.argumentVarModels_.push(b),this.paramIds_.push(m.id),m=m.nextConnection&&m.nextConnection.targetBlock()}if(this.updateParams_(),p.mutateCallers$$module$build$src$core$procedures(this),null!==(d=d.getFieldValue("STATEMENTS"))&&this.hasStatements_!==(d="TRUE"===d))if(d){var y;this.setStatements_(!0),null==(y=this.statementConnection_)||y.reconnect(this,"STACK"),this.statementConnection_=null}else y=this.getInput("STACK").connection,(this.statementConnection_=y.targetConnection)&&((y=y.targetBlock()).unplug(),y.bumpNeighbours()),this.setStatements_(!1)},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},renameVarById:function(d,m){var b=this.workspace.getVariableById(d);if(""===b.getType()){b=b.getName(),m=this.workspace.getVariableById(m);var y=!1;for(let O=0;O<this.argumentVarModels_.length;O++)this.argumentVarModels_[O].getId()===d&&(this.arguments_[O]=m.getName(),this.argumentVarModels_[O]=m,y=!0);y&&(this.displayRenamedVar_(b,m.getName()),p.mutateCallers$$module$build$src$core$procedures(this))}},updateVarName:function(d){const m=d.getName();let y,b=!1;for(let O=0;O<this.argumentVarModels_.length;O++)this.argumentVarModels_[O].getId()===d.getId()&&(y=this.arguments_[O],this.arguments_[O]=m,b=!0);b&&(this.displayRenamedVar_(y,m),p.mutateCallers$$module$build$src$core$procedures(this))},displayRenamedVar_:function(d,m){this.updateParams_();var b=this.getIcon(p.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE);if(b&&b.bubbleIsVisible()){b=b.getWorkspace().getAllBlocks(!1);for(let O,y=0;O=b[y];y++)"procedures_mutatorarg"===O.type&&p.Names$$module$build$src$core$names.equals(d,O.getFieldValue("NAME"))&&O.setFieldValue(m,"NAME")}},customContextMenu:function(d){if(!this.isInFlyout){var m=this.getFieldValue("NAME"),b={type:this.callType_,extraState:{name:m,params:this.arguments_}};if(d.push({enabled:!0,text:p.Msg$$module$build$src$core$msg.PROCEDURES_CREATE_DO.replace("%1",m),callback:p.callbackFactory$$module$build$src$core$contextmenu(this,b)}),!this.isCollapsed())for(m=0;m<this.argumentVarModels_.length;m++){const y={type:"variables_get",fields:{VAR:{name:(b=this.argumentVarModels_[m]).getName(),id:b.getId(),type:b.getType()}}};d.push({enabled:!0,text:p.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET.replace("%1",b.getName()),callback:p.callbackFactory$$module$build$src$core$contextmenu(this,y)})}}}};Ne.procedures_defnoreturn=Object.assign({},_o,{init:function(){var d=p.findLegalName$$module$build$src$core$procedures("",this);(d=p.fromJson$$module$build$src$core$field_registry({type:"field_input",text:d})).setValidator(p.rename$$module$build$src$core$procedures),d.setSpellcheck(!1),this.appendDummyInput().appendField(p.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_TITLE).appendField(d,"NAME").appendField("","PARAMS"),this.setMutator(new p.MutatorIcon$$module$build$src$core$icons$mutator_icon(["procedures_mutatorarg"],this)),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&p.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_COMMENT&&this.setCommentText(p.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(p.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_TOOLTIP),this.setHelpUrl(p.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!1]},callType_:"procedures_callnoreturn"}),Ne.procedures_defreturn=Object.assign({},_o,{init:function(){var d=p.findLegalName$$module$build$src$core$procedures("",this);(d=p.fromJson$$module$build$src$core$field_registry({type:"field_input",text:d})).setValidator(p.rename$$module$build$src$core$procedures),d.setSpellcheck(!1),this.appendDummyInput().appendField(p.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_TITLE).appendField(d,"NAME").appendField("","PARAMS"),this.appendValueInput("RETURN").setAlign(p.Align$$module$build$src$core$inputs$align.RIGHT).appendField(p.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.setMutator(new p.MutatorIcon$$module$build$src$core$icons$mutator_icon(["procedures_mutatorarg"],this)),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&p.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_COMMENT&&this.setCommentText(p.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(p.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_TOOLTIP),this.setHelpUrl(p.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!0]},callType_:"procedures_callreturn"}),Ne.procedures_mutatorcontainer={init:function(){this.appendDummyInput().appendField(p.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORCONTAINER_TITLE),this.appendStatementInput("STACK"),this.appendDummyInput("STATEMENT_INPUT").appendField(p.Msg$$module$build$src$core$msg.PROCEDURES_ALLOW_STATEMENTS).appendField(p.fromJson$$module$build$src$core$field_registry({type:"field_checkbox",checked:!0}),"STATEMENTS"),this.setStyle("procedure_blocks"),this.setTooltip(p.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP),this.contextMenu=!1}};var zt=class extends p.FieldTextInput$$module$build$src$core$field_textinput{constructor(){super(...arguments),this.editingInteractively=!1}showEditor_(d){super.showEditor_(d),this.editingInteractively=!0,this.editingVariable=void 0}onFinishEditing_(d){super.onFinishEditing_(d),this.editingInteractively=!1}};Ne.procedures_mutatorarg={init:function(){const d=new zt(p.DEFAULT_ARG$$module$build$src$core$procedures,this.validator_);this.appendDummyInput().appendField(p.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORARG_TITLE).appendField(d,"NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(p.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORARG_TOOLTIP),this.contextMenu=!1},validator_:function(d){var m=this.getSourceBlock();const b=m.workspace.getRootWorkspace();if(!(d=d.replace(/[\s\xa0]+/g," ").replace(/^ | $/g,"")))return null;const y=(m.workspace.targetWorkspace||m.workspace).getAllBlocks(!1),O=d.toLowerCase();for(let Ce=0;Ce<y.length;Ce++){if(y[Ce].id===this.getSourceBlock().id)continue;const Mt=y[Ce].getFieldValue("NAME");if(Mt&&Mt.toLowerCase()===O)return null}return m.isInFlyout||((m=b.getVariable(d,""))&&m.getName()!==d&&b.renameVariableById(m.getId(),d),m||(this.editingInteractively?this.editingVariable?b.renameVariableById(this.editingVariable.getId(),d):this.editingVariable=b.createVariable(d,""):b.createVariable(d,""))),d}};var jt="DISABLED_PROCEDURE_DEFINITION",is={getProcedureCall:function(){return this.getFieldValue("NAME")},renameProcedure:function(d,m){p.Names$$module$build$src$core$names.equals(d,this.getProcedureCall())&&(this.setFieldValue(m,"NAME"),this.setTooltip((this.outputConnection?p.Msg$$module$build$src$core$msg.PROCEDURES_CALLRETURN_TOOLTIP:p.Msg$$module$build$src$core$msg.PROCEDURES_CALLNORETURN_TOOLTIP).replace("%1",m)))},setProcedureParameters_:function(d,m){var b=p.getDefinition$$module$build$src$core$procedures(this.getProcedureCall(),this.workspace);if((b=(b=b&&b.getIcon(p.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE))&&b.bubbleIsVisible())?this.setCollapsed(!1):(this.quarkConnections_={},this.quarkIds_=null),d.join("\n")===this.arguments_.join("\n"))this.quarkIds_=m;else{if(m.length!==d.length)throw RangeError("paramNames and paramIds must be the same length.");this.quarkIds_||(this.quarkConnections_={},this.quarkIds_=[]);for(let O=0;O<this.arguments_.length;O++){var y=this.getInput("ARG"+O);y&&(this.quarkConnections_[this.quarkIds_[O]]=y=y.connection.targetConnection,b&&y&&!m.includes(this.quarkIds_[O])&&(y.disconnect(),y.getSourceBlock().bumpNeighbours()))}for(this.arguments_=[].concat(d),this.argumentVarModels_=[],d=0;d<this.arguments_.length;d++)b=p.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,null,this.arguments_[d],""),this.argumentVarModels_.push(b);if(this.updateShape_(),this.quarkIds_=m)for(m=0;m<this.arguments_.length;m++)if((d=this.quarkIds_[m])in this.quarkConnections_){let O;null!=(O=this.quarkConnections_[d])&&O.reconnect(this,"ARG"+m)||delete this.quarkConnections_[d]}}},updateShape_:function(){for(var d=0;d<this.arguments_.length;d++){var m=this.getField("ARGNAME"+d);if(m){p.disable$$module$build$src$core$events$utils();try{m.setValue(this.arguments_[d])}finally{p.enable$$module$build$src$core$events$utils()}}else m=p.fromJson$$module$build$src$core$field_registry({type:"field_label",text:this.arguments_[d]}),this.appendValueInput("ARG"+d).setAlign(p.Align$$module$build$src$core$inputs$align.RIGHT).appendField(m,"ARGNAME"+d)}for(d=this.arguments_.length;this.getInput("ARG"+d);d++)this.removeInput("ARG"+d);(d=this.getInput("TOPROW"))&&(this.arguments_.length?this.getField("WITH")||d.appendField(p.Msg$$module$build$src$core$msg.PROCEDURES_CALL_BEFORE_PARAMS,"WITH"):this.getField("WITH")&&d.removeField("WITH"))},mutationToDom:function(){const d=p.createElement$$module$build$src$core$utils$xml("mutation");d.setAttribute("name",this.getProcedureCall());for(let m=0;m<this.arguments_.length;m++){const b=p.createElement$$module$build$src$core$utils$xml("arg");b.setAttribute("name",this.arguments_[m]),d.appendChild(b)}return d},domToMutation:function(d){var m=d.getAttribute("name");this.renameProcedure(this.getProcedureCall(),m),m=[];const b=[];for(let O,y=0;O=d.childNodes[y];y++)"arg"===O.nodeName.toLowerCase()&&(m.push(O.getAttribute("name")),b.push(O.getAttribute("paramId")));this.setProcedureParameters_(m,b)},saveExtraState:function(){const d=Object.create(null);return d.name=this.getProcedureCall(),this.arguments_.length&&(d.params=this.arguments_),d},loadExtraState:function(d){if(this.renameProcedure(this.getProcedureCall(),d.name),d=d.params){const m=[];m.length=d.length,m.fill(null),this.setProcedureParameters_(d,m)}},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},onchange:function(d){if(this.workspace&&!this.workspace.isFlyout&&d.recordUndo)if(d.type===p.BLOCK_CREATE$$module$build$src$core$events$events&&d.ids.includes(this.id)){var m=this.getProcedureCall(),b=p.getDefinition$$module$build$src$core$procedures(m,this.workspace);if(!b||b.type===this.defType_&&JSON.stringify(b.getVars())===JSON.stringify(this.arguments_)||(b=null),b)b.isEnabled()||(this.setDisabledReason(!0,jt),this.setWarningText(p.Msg$$module$build$src$core$msg.PROCEDURES_CALL_DISABLED_DEF_WARNING.replace("%1",m)));else{p.setGroup$$module$build$src$core$events$utils(d.group),d=p.createElement$$module$build$src$core$utils$xml("xml"),(m=p.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type",this.defType_);var y=(b=this.getRelativeToSurfaceXY()).y+2*p.config$$module$build$src$core$config.snapRadius;m.setAttribute("x",`${b.x+p.config$$module$build$src$core$config.snapRadius*(this.RTL?-1:1)}`),m.setAttribute("y",`${y}`),b=this.mutationToDom(),m.appendChild(b),(b=p.createElement$$module$build$src$core$utils$xml("field")).setAttribute("name","NAME"),y=this.getProcedureCall();const O=p.findLegalName$$module$build$src$core$procedures(y,this);y!==O&&this.renameProcedure(y,O),b.appendChild(p.createTextNode$$module$build$src$core$utils$xml(y)),m.appendChild(b),d.appendChild(m),p.domToWorkspace$$module$build$src$core$xml(d,this.workspace),p.setGroup$$module$build$src$core$events$utils(!1)}}else d.type===p.BLOCK_DELETE$$module$build$src$core$events$events?(m=this.getProcedureCall(),p.getDefinition$$module$build$src$core$procedures(m,this.workspace)||(p.setGroup$$module$build$src$core$events$utils(d.group),this.dispose(!0),p.setGroup$$module$build$src$core$events$utils(!1))):d.type===p.BLOCK_CHANGE$$module$build$src$core$events$events&&"disabled"===d.element&&(m=this.getProcedureCall(),(y=p.getDefinition$$module$build$src$core$procedures(m,this.workspace))&&y.id===d.blockId&&((b=p.getGroup$$module$build$src$core$events$utils())&&console.log("Saw an existing group while responding to a definition change"),p.setGroup$$module$build$src$core$events$utils(d.group),d=y.isEnabled(),this.setDisabledReason(!d,jt),this.setWarningText(d?null:p.Msg$$module$build$src$core$msg.PROCEDURES_CALL_DISABLED_DEF_WARNING.replace("%1",m)),p.setGroup$$module$build$src$core$events$utils(b)))},customContextMenu:function(d){if(this.workspace.isMovable()){var m=this.getProcedureCall(),b=this.workspace;d.push({enabled:!0,text:p.Msg$$module$build$src$core$msg.PROCEDURES_HIGHLIGHT_DEF,callback:function(){const y=p.getDefinition$$module$build$src$core$procedures(m,b);y&&(b.centerOnBlock(y.id),p.getFocusManager$$module$build$src$core$focus_manager().focusNode(y))}})}}};Ne.procedures_callnoreturn=Object.assign({},is,{init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(p.Msg$$module$build$src$core$msg.PROCEDURES_CALLNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null},defType_:"procedures_defnoreturn"}),Ne.procedures_callreturn=Object.assign({},is,{init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setOutput(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(p.Msg$$module$build$src$core$msg.PROCEDURES_CALLRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null},defType_:"procedures_defreturn"});Ne.procedures_ifreturn={init:function(){this.appendValueInput("CONDITION").setCheck("Boolean").appendField(p.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_IF),this.appendValueInput("VALUE").appendField(p.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(p.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_TOOLTIP),this.setHelpUrl(p.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_HELPURL),this.hasReturnValue_=!0},mutationToDom:function(){const d=p.createElement$$module$build$src$core$utils$xml("mutation");return d.setAttribute("value",String(Number(this.hasReturnValue_))),d},domToMutation:function(d){this.hasReturnValue_="1"===d.getAttribute("value"),this.hasReturnValue_||(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(p.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN))},onchange:function(d){if(!(this.workspace.isDragging&&this.workspace.isDragging()||d.type!==p.BLOCK_MOVE$$module$build$src$core$events$events&&d.type!==p.BLOCK_CREATE$$module$build$src$core$events$events)){d=!1;var m=this;do{if(this.FUNCTION_TYPES.includes(m.type)){d=!0;break}m=m.getSurroundParent()}while(m);if(d?("procedures_defnoreturn"===m.type&&this.hasReturnValue_?(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(p.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!1):"procedures_defreturn"!==m.type||this.hasReturnValue_||(this.removeInput("VALUE"),this.appendValueInput("VALUE").appendField(p.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!0),this.setWarningText(null)):this.setWarningText(p.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_WARNING),!this.isInFlyout)try{p.setRecordUndo$$module$build$src$core$events$utils(!1),this.setDisabledReason(!d,"UNPARENTED_IFRETURN")}finally{p.setRecordUndo$$module$build$src$core$events$utils(!0)}}},FUNCTION_TYPES:["procedures_defnoreturn","procedures_defreturn"]},p.defineBlocks$$module$build$src$core$common(Ne);var gn={blocks:Ne},di=p.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"math_number",message0:"%1",args0:[{type:"field_number",name:"NUM",value:0}],output:"Number",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",style:"math_blocks",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"math_arithmetic",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Number"},{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ADDITION_SYMBOL}","ADD"],["%{BKY_MATH_SUBTRACTION_SYMBOL}","MINUS"],["%{BKY_MATH_MULTIPLICATION_SYMBOL}","MULTIPLY"],["%{BKY_MATH_DIVISION_SYMBOL}","DIVIDE"],["%{BKY_MATH_POWER_SYMBOL}","POWER"]]},{type:"input_value",name:"B",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ARITHMETIC_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_single",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_SINGLE_OP_ROOT}","ROOT"],["%{BKY_MATH_SINGLE_OP_ABSOLUTE}","ABS"],["-","NEG"],["ln","LN"],["log10","LOG10"],["e^","EXP"],["10^","POW10"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_SINGLE_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_trig",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_TRIG_SIN}","SIN"],["%{BKY_MATH_TRIG_COS}","COS"],["%{BKY_MATH_TRIG_TAN}","TAN"],["%{BKY_MATH_TRIG_ASIN}","ASIN"],["%{BKY_MATH_TRIG_ACOS}","ACOS"],["%{BKY_MATH_TRIG_ATAN}","ATAN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_TRIG_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_constant",message0:"%1",args0:[{type:"field_dropdown",name:"CONSTANT",options:[["\u03c0","PI"],["e","E"],["\u03c6","GOLDEN_RATIO"],["sqrt(2)","SQRT2"],["sqrt(\xbd)","SQRT1_2"],["\u221e","INFINITY"]]}],output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTANT_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTANT_HELPURL}"},{type:"math_number_property",message0:"%1 %2",args0:[{type:"input_value",name:"NUMBER_TO_CHECK",check:"Number"},{type:"field_dropdown",name:"PROPERTY",options:[["%{BKY_MATH_IS_EVEN}","EVEN"],["%{BKY_MATH_IS_ODD}","ODD"],["%{BKY_MATH_IS_PRIME}","PRIME"],["%{BKY_MATH_IS_WHOLE}","WHOLE"],["%{BKY_MATH_IS_POSITIVE}","POSITIVE"],["%{BKY_MATH_IS_NEGATIVE}","NEGATIVE"],["%{BKY_MATH_IS_DIVISIBLE_BY}","DIVISIBLE_BY"]]}],inputsInline:!0,output:"Boolean",style:"math_blocks",tooltip:"%{BKY_MATH_IS_TOOLTIP}",mutator:"math_is_divisibleby_mutator"},{type:"math_change",message0:"%{BKY_MATH_CHANGE_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_MATH_CHANGE_TITLE_ITEM}"},{type:"input_value",name:"DELTA",check:"Number"}],previousStatement:null,nextStatement:null,style:"variable_blocks",helpUrl:"%{BKY_MATH_CHANGE_HELPURL}",extensions:["math_change_tooltip"]},{type:"math_round",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ROUND_OPERATOR_ROUND}","ROUND"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDUP}","ROUNDUP"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDDOWN}","ROUNDDOWN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ROUND_HELPURL}",tooltip:"%{BKY_MATH_ROUND_TOOLTIP}"},{type:"math_on_list",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ONLIST_OPERATOR_SUM}","SUM"],["%{BKY_MATH_ONLIST_OPERATOR_MIN}","MIN"],["%{BKY_MATH_ONLIST_OPERATOR_MAX}","MAX"],["%{BKY_MATH_ONLIST_OPERATOR_AVERAGE}","AVERAGE"],["%{BKY_MATH_ONLIST_OPERATOR_MEDIAN}","MEDIAN"],["%{BKY_MATH_ONLIST_OPERATOR_MODE}","MODE"],["%{BKY_MATH_ONLIST_OPERATOR_STD_DEV}","STD_DEV"],["%{BKY_MATH_ONLIST_OPERATOR_RANDOM}","RANDOM"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ONLIST_HELPURL}",mutator:"math_modes_of_list_mutator",extensions:["math_op_tooltip"]},{type:"math_modulo",message0:"%{BKY_MATH_MODULO_TITLE}",args0:[{type:"input_value",name:"DIVIDEND",check:"Number"},{type:"input_value",name:"DIVISOR",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_MODULO_TOOLTIP}",helpUrl:"%{BKY_MATH_MODULO_HELPURL}"},{type:"math_constrain",message0:"%{BKY_MATH_CONSTRAIN_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"Number"},{type:"input_value",name:"LOW",check:"Number"},{type:"input_value",name:"HIGH",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTRAIN_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTRAIN_HELPURL}"},{type:"math_random_int",message0:"%{BKY_MATH_RANDOM_INT_TITLE}",args0:[{type:"input_value",name:"FROM",check:"Number"},{type:"input_value",name:"TO",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_INT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_INT_HELPURL}"},{type:"math_random_float",message0:"%{BKY_MATH_RANDOM_FLOAT_TITLE_RANDOM}",output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_FLOAT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_FLOAT_HELPURL}"},{type:"math_atan2",message0:"%{BKY_MATH_ATAN2_TITLE}",args0:[{type:"input_value",name:"X",check:"Number"},{type:"input_value",name:"Y",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_ATAN2_TOOLTIP}",helpUrl:"%{BKY_MATH_ATAN2_HELPURL}"}]);p.register$$module$build$src$core$extensions("math_op_tooltip",p.buildTooltipForDropdown$$module$build$src$core$extensions("OP",{ADD:"%{BKY_MATH_ARITHMETIC_TOOLTIP_ADD}",MINUS:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MINUS}",MULTIPLY:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MULTIPLY}",DIVIDE:"%{BKY_MATH_ARITHMETIC_TOOLTIP_DIVIDE}",POWER:"%{BKY_MATH_ARITHMETIC_TOOLTIP_POWER}",ROOT:"%{BKY_MATH_SINGLE_TOOLTIP_ROOT}",ABS:"%{BKY_MATH_SINGLE_TOOLTIP_ABS}",NEG:"%{BKY_MATH_SINGLE_TOOLTIP_NEG}",LN:"%{BKY_MATH_SINGLE_TOOLTIP_LN}",LOG10:"%{BKY_MATH_SINGLE_TOOLTIP_LOG10}",EXP:"%{BKY_MATH_SINGLE_TOOLTIP_EXP}",POW10:"%{BKY_MATH_SINGLE_TOOLTIP_POW10}",SIN:"%{BKY_MATH_TRIG_TOOLTIP_SIN}",COS:"%{BKY_MATH_TRIG_TOOLTIP_COS}",TAN:"%{BKY_MATH_TRIG_TOOLTIP_TAN}",ASIN:"%{BKY_MATH_TRIG_TOOLTIP_ASIN}",ACOS:"%{BKY_MATH_TRIG_TOOLTIP_ACOS}",ATAN:"%{BKY_MATH_TRIG_TOOLTIP_ATAN}",SUM:"%{BKY_MATH_ONLIST_TOOLTIP_SUM}",MIN:"%{BKY_MATH_ONLIST_TOOLTIP_MIN}",MAX:"%{BKY_MATH_ONLIST_TOOLTIP_MAX}",AVERAGE:"%{BKY_MATH_ONLIST_TOOLTIP_AVERAGE}",MEDIAN:"%{BKY_MATH_ONLIST_TOOLTIP_MEDIAN}",MODE:"%{BKY_MATH_ONLIST_TOOLTIP_MODE}",STD_DEV:"%{BKY_MATH_ONLIST_TOOLTIP_STD_DEV}",RANDOM:"%{BKY_MATH_ONLIST_TOOLTIP_RANDOM}"}));var hi={mutationToDom:function(){const d=p.createElement$$module$build$src$core$utils$xml("mutation"),m="DIVISIBLE_BY"===this.getFieldValue("PROPERTY");return d.setAttribute("divisor_input",String(m)),d},domToMutation:function(d){d="true"===d.getAttribute("divisor_input"),this.updateShape_(d)},updateShape_:function(d){const m=this.getInput("DIVISOR");d?m||this.appendValueInput("DIVISOR").setCheck("Number"):m&&this.removeInput("DIVISOR")}};p.registerMutator$$module$build$src$core$extensions("math_is_divisibleby_mutator",hi,function(){this.getField("PROPERTY").setValidator(function(d){d="DIVISIBLE_BY"===d,this.getSourceBlock().updateShape_(d)})}),p.register$$module$build$src$core$extensions("math_change_tooltip",p.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_MATH_CHANGE_TOOLTIP}","VAR"));var $n={updateType_:function(d){this.outputConnection.setCheck("MODE"===d?"Array":"Number")},mutationToDom:function(){const d=p.createElement$$module$build$src$core$utils$xml("mutation");return d.setAttribute("op",this.getFieldValue("OP")),d},domToMutation:function(d){if(null===(d=d.getAttribute("op")))throw new TypeError("xmlElement had no op attribute");this.updateType_(d)}};p.registerMutator$$module$build$src$core$extensions("math_modes_of_list_mutator",$n,function(){this.getField("OP").setValidator(function(d){this.updateType_(d)}.bind(this))}),p.defineBlocks$$module$build$src$core$common(di);var Zo={blocks:di},Ho=p.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"controls_repeat_ext",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"input_value",name:"TIMES",check:"Number"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_repeat",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"field_number",name:"TIMES",value:10,min:0,precision:1}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_whileUntil",message0:"%1 %2",args0:[{type:"field_dropdown",name:"MODE",options:[["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_WHILE}","WHILE"],["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_UNTIL}","UNTIL"]]},{type:"input_value",name:"BOOL",check:"Boolean"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_WHILEUNTIL_HELPURL}",extensions:["controls_whileUntil_tooltip"]},{type:"controls_for",message0:"%{BKY_CONTROLS_FOR_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"FROM",check:"Number",align:"RIGHT"},{type:"input_value",name:"TO",check:"Number",align:"RIGHT"},{type:"input_value",name:"BY",check:"Number",align:"RIGHT"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],inputsInline:!0,previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOR_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_for_tooltip"]},{type:"controls_forEach",message0:"%{BKY_CONTROLS_FOREACH_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"LIST",check:"Array"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOREACH_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_forEach_tooltip"]},{type:"controls_flow_statements",message0:"%1",args0:[{type:"field_dropdown",name:"FLOW",options:[["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK}","BREAK"],["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE}","CONTINUE"]]}],previousStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FLOW_STATEMENTS_HELPURL}",suppressPrefixSuffix:!0,extensions:["controls_flow_tooltip","controls_flow_in_loop_check"]}]);p.register$$module$build$src$core$extensions("controls_whileUntil_tooltip",p.buildTooltipForDropdown$$module$build$src$core$extensions("MODE",{WHILE:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_WHILE}",UNTIL:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL}"})),p.register$$module$build$src$core$extensions("controls_flow_tooltip",p.buildTooltipForDropdown$$module$build$src$core$extensions("FLOW",{BREAK:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK}",CONTINUE:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE}"}));var fn={customContextMenu:function(d){if(!this.isInFlyout){var m=this.getField("VAR"),b=m.getVariable().getName();this.isCollapsed()||null===b||(m={type:"variables_get",fields:{VAR:m.saveState(!0)}},d.push({enabled:!0,text:p.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET.replace("%1",b),callback:p.callbackFactory$$module$build$src$core$contextmenu(this,m)}))}}};p.registerMixin$$module$build$src$core$extensions("contextMenu_newGetVariableBlock",fn),p.register$$module$build$src$core$extensions("controls_for_tooltip",p.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_CONTROLS_FOR_TOOLTIP}","VAR")),p.register$$module$build$src$core$extensions("controls_forEach_tooltip",p.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_CONTROLS_FOREACH_TOOLTIP}","VAR"));var ns=new Set(["controls_repeat","controls_repeat_ext","controls_forEach","controls_for","controls_whileUntil"]),En={getSurroundLoop:function(){let d=this;do{if(ns.has(d.type))return d;d=d.getSurroundParent()}while(d);return null},onchange:function(d){const m=this.workspace;if(m.isDragging&&!m.isDragging()&&(d.type===p.BLOCK_MOVE$$module$build$src$core$events$events||d.type===p.BLOCK_CREATE$$module$build$src$core$events$events)&&(d=!!this.getSurroundLoop(),this.setWarningText(d?null:p.Msg$$module$build$src$core$msg.CONTROLS_FLOW_STATEMENTS_WARNING),!this.isInFlyout))try{p.setRecordUndo$$module$build$src$core$events$utils(!1),this.setDisabledReason(!d,"CONTROL_FLOW_NOT_IN_LOOP")}finally{p.setRecordUndo$$module$build$src$core$events$utils(!0)}}};p.registerMixin$$module$build$src$core$extensions("controls_flow_in_loop_check",En),p.defineBlocks$$module$build$src$core$common(Ho);var vn={blocks:Ho,loopTypes:ns},Ze=p.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"logic_boolean",message0:"%1",args0:[{type:"field_dropdown",name:"BOOL",options:[["%{BKY_LOGIC_BOOLEAN_TRUE}","TRUE"],["%{BKY_LOGIC_BOOLEAN_FALSE}","FALSE"]]}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_BOOLEAN_TOOLTIP}",helpUrl:"%{BKY_LOGIC_BOOLEAN_HELPURL}"},{type:"controls_if",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],previousStatement:null,nextStatement:null,style:"logic_blocks",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",suppressPrefixSuffix:!0,mutator:"controls_if_mutator",extensions:["controls_if_tooltip"]},{type:"controls_ifelse",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],message2:"%{BKY_CONTROLS_IF_MSG_ELSE} %1",args2:[{type:"input_statement",name:"ELSE"}],previousStatement:null,nextStatement:null,style:"logic_blocks",tooltip:"%{BKYCONTROLS_IF_TOOLTIP_2}",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",suppressPrefixSuffix:!0,extensions:["controls_if_tooltip"]},{type:"logic_compare",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A"},{type:"field_dropdown",name:"OP",options:[["=","EQ"],["\u2260","NEQ"],["\u200f<","LT"],["\u200f\u2264","LTE"],["\u200f>","GT"],["\u200f\u2265","GTE"]]},{type:"input_value",name:"B"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_COMPARE_HELPURL}",extensions:["logic_compare","logic_op_tooltip"]},{type:"logic_operation",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Boolean"},{type:"field_dropdown",name:"OP",options:[["%{BKY_LOGIC_OPERATION_AND}","AND"],["%{BKY_LOGIC_OPERATION_OR}","OR"]]},{type:"input_value",name:"B",check:"Boolean"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_OPERATION_HELPURL}",extensions:["logic_op_tooltip"]},{type:"logic_negate",message0:"%{BKY_LOGIC_NEGATE_TITLE}",args0:[{type:"input_value",name:"BOOL",check:"Boolean"}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_NEGATE_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NEGATE_HELPURL}"},{type:"logic_null",message0:"%{BKY_LOGIC_NULL}",output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_NULL_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NULL_HELPURL}"},{type:"logic_ternary",message0:"%{BKY_LOGIC_TERNARY_CONDITION} %1",args0:[{type:"input_value",name:"IF",check:"Boolean"}],message1:"%{BKY_LOGIC_TERNARY_IF_TRUE} %1",args1:[{type:"input_value",name:"THEN"}],message2:"%{BKY_LOGIC_TERNARY_IF_FALSE} %1",args2:[{type:"input_value",name:"ELSE"}],output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_TERNARY_TOOLTIP}",helpUrl:"%{BKY_LOGIC_TERNARY_HELPURL}",extensions:["logic_ternary"]},{type:"controls_if_if",message0:"%{BKY_CONTROLS_IF_IF_TITLE_IF}",nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_IF_TOOLTIP}"},{type:"controls_if_elseif",message0:"%{BKY_CONTROLS_IF_ELSEIF_TITLE_ELSEIF}",previousStatement:null,nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSEIF_TOOLTIP}"},{type:"controls_if_else",message0:"%{BKY_CONTROLS_IF_ELSE_TITLE_ELSE}",previousStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSE_TOOLTIP}"}]);p.register$$module$build$src$core$extensions("logic_op_tooltip",p.buildTooltipForDropdown$$module$build$src$core$extensions("OP",{EQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_EQ}",NEQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_NEQ}",LT:"%{BKY_LOGIC_COMPARE_TOOLTIP_LT}",LTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_LTE}",GT:"%{BKY_LOGIC_COMPARE_TOOLTIP_GT}",GTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_GTE}",AND:"%{BKY_LOGIC_OPERATION_TOOLTIP_AND}",OR:"%{BKY_LOGIC_OPERATION_TOOLTIP_OR}"}));var yn={elseifCount_:0,elseCount_:0,mutationToDom:function(){if(!this.elseifCount_&&!this.elseCount_)return null;const d=p.createElement$$module$build$src$core$utils$xml("mutation");return this.elseifCount_&&d.setAttribute("elseif",String(this.elseifCount_)),this.elseCount_&&d.setAttribute("else","1"),d},domToMutation:function(d){this.elseifCount_=parseInt(d.getAttribute("elseif"),10)||0,this.elseCount_=parseInt(d.getAttribute("else"),10)||0,this.rebuildShape_()},saveExtraState:function(){if(!this.elseifCount_&&!this.elseCount_)return null;const d=Object.create(null);return this.elseifCount_&&(d.elseIfCount=this.elseifCount_),this.elseCount_&&(d.hasElse=!0),d},loadExtraState:function(d){this.elseifCount_=d.elseIfCount||0,this.elseCount_=d.hasElse?1:0,this.updateShape_()},decompose:function(d){const m=d.newBlock("controls_if_if");m.initSvg();let b=m.nextConnection;for(let y=1;y<=this.elseifCount_;y++){const O=d.newBlock("controls_if_elseif");O.initSvg(),b.connect(O.previousConnection),b=O.nextConnection}return this.elseCount_&&((d=d.newBlock("controls_if_else")).initSvg(),b.connect(d.previousConnection)),m},compose:function(d){d=d.nextConnection.targetBlock(),this.elseCount_=this.elseifCount_=0;const m=[null],b=[null];let y=null;for(;d;){if(!d.isInsertionMarker())switch(d.type){case"controls_if_elseif":this.elseifCount_++,m.push(d.valueConnection_),b.push(d.statementConnection_);break;case"controls_if_else":this.elseCount_++,y=d.statementConnection_;break;default:throw TypeError("Unknown block type: "+d.type)}d=d.getNextBlock()}this.updateShape_(),this.reconnectChildBlocks_(m,b,y)},saveConnections:function(d){d=d.nextConnection.targetBlock();let m=1;for(;d;){if(!d.isInsertionMarker())switch(d.type){case"controls_if_elseif":var b=this.getInput("IF"+m);const y=this.getInput("DO"+m);d.valueConnection_=b&&b.connection.targetConnection,d.statementConnection_=y&&y.connection.targetConnection,m++;break;case"controls_if_else":b=this.getInput("ELSE"),d.statementConnection_=b&&b.connection.targetConnection;break;default:throw TypeError("Unknown block type: "+d.type)}d=d.getNextBlock()}},rebuildShape_:function(){const d=[null],m=[null];let b=null;this.getInput("ELSE")&&(b=this.getInput("ELSE").connection.targetConnection);for(let y=1;this.getInput("IF"+y);y++){const O=this.getInput("IF"+y),Ce=this.getInput("DO"+y);d.push(O.connection.targetConnection),m.push(Ce.connection.targetConnection)}this.updateShape_(),this.reconnectChildBlocks_(d,m,b)},updateShape_:function(){this.getInput("ELSE")&&this.removeInput("ELSE");for(var d=1;this.getInput("IF"+d);d++)this.removeInput("IF"+d),this.removeInput("DO"+d);for(d=1;d<=this.elseifCount_;d++)this.appendValueInput("IF"+d).setCheck("Boolean").appendField(p.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_ELSEIF),this.appendStatementInput("DO"+d).appendField(p.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_THEN);this.elseCount_&&this.appendStatementInput("ELSE").appendField(p.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_ELSE)},reconnectChildBlocks_:function(d,m,b){for(let y=1;y<=this.elseifCount_;y++){let O,Ce;null==(O=d[y])||O.reconnect(this,"IF"+y),null==(Ce=m[y])||Ce.reconnect(this,"DO"+y)}b?.reconnect(this,"ELSE")}};p.registerMutator$$module$build$src$core$extensions("controls_if_mutator",yn,null,["controls_if_elseif","controls_if_else"]);p.register$$module$build$src$core$extensions("controls_if_tooltip",function(){this.setTooltip(function(){return this.elseifCount_||this.elseCount_?!this.elseifCount_&&this.elseCount_?p.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_2:this.elseifCount_&&!this.elseCount_?p.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_3:this.elseifCount_&&this.elseCount_?p.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_4:"":p.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_1}.bind(this))});var rs={onchange:function(d){this.prevBlocks_||(this.prevBlocks_=[null,null]);var m=this.getInputTargetBlock("A");const b=this.getInputTargetBlock("B");m&&b&&!this.workspace.connectionChecker.doTypeChecks(m.outputConnection,b.outputConnection)&&(p.setGroup$$module$build$src$core$events$utils(d.group),(d=this.prevBlocks_[0])!==m&&(m.unplug(),!d||d.isDisposed()||d.isShadow()||this.getInput("A").connection.connect(d.outputConnection)),(m=this.prevBlocks_[1])!==b&&(b.unplug(),!m||m.isDisposed()||m.isShadow()||this.getInput("B").connection.connect(m.outputConnection)),this.bumpNeighbours(),p.setGroup$$module$build$src$core$events$utils(!1)),this.prevBlocks_[0]=this.getInputTargetBlock("A"),this.prevBlocks_[1]=this.getInputTargetBlock("B")}};p.register$$module$build$src$core$extensions("logic_compare",function(){this.mixin(rs)});var $i={prevParentConnection_:null,onchange:function(d){const m=this.getInputTargetBlock("THEN"),b=this.getInputTargetBlock("ELSE"),y=this.outputConnection.targetConnection;if((m||b)&&y)for(let O=0;O<2;O++){const Ce=1===O?m:b;Ce&&!Ce.workspace.connectionChecker.doTypeChecks(Ce.outputConnection,y)&&(p.setGroup$$module$build$src$core$events$utils(d.group),y===this.prevParentConnection_?(this.unplug(),y.getSourceBlock().bumpNeighbours()):(Ce.unplug(),Ce.bumpNeighbours()),p.setGroup$$module$build$src$core$events$utils(!1))}this.prevParentConnection_=y}};p.registerMixin$$module$build$src$core$extensions("logic_ternary",$i),p.defineBlocks$$module$build$src$core$common(Ze);var _e={blocks:Ze},We=p.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"lists_create_empty",message0:"%{BKY_LISTS_CREATE_EMPTY_TITLE}",output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_CREATE_EMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_CREATE_EMPTY_HELPURL}"},{type:"lists_repeat",message0:"%{BKY_LISTS_REPEAT_TITLE}",args0:[{type:"input_value",name:"ITEM"},{type:"input_value",name:"NUM",check:"Number"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_LISTS_REPEAT_HELPURL}"},{type:"lists_reverse",message0:"%{BKY_LISTS_REVERSE_MESSAGE0}",args0:[{type:"input_value",name:"LIST",check:"Array"}],output:"Array",inputsInline:!0,style:"list_blocks",tooltip:"%{BKY_LISTS_REVERSE_TOOLTIP}",helpUrl:"%{BKY_LISTS_REVERSE_HELPURL}"},{type:"lists_isEmpty",message0:"%{BKY_LISTS_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"list_blocks",tooltip:"%{BKY_LISTS_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_ISEMPTY_HELPURL}"},{type:"lists_length",message0:"%{BKY_LISTS_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"list_blocks",tooltip:"%{BKY_LISTS_LENGTH_TOOLTIP}",helpUrl:"%{BKY_LISTS_LENGTH_HELPURL}"}]);We.lists_create_with={init:function(){this.setHelpUrl(p.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_HELPURL),this.setStyle("list_blocks"),this.itemCount_=3,this.updateShape_(),this.setOutput(!0,"Array"),this.setMutator(new p.MutatorIcon$$module$build$src$core$icons$mutator_icon(["lists_create_with_item"],this)),this.setTooltip(p.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_TOOLTIP)},mutationToDom:function(){const d=p.createElement$$module$build$src$core$utils$xml("mutation");return d.setAttribute("items",String(this.itemCount_)),d},domToMutation:function(d){if(!(d=d.getAttribute("items")))throw new TypeError("element did not have items");this.itemCount_=parseInt(d,10),this.updateShape_()},saveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function(d){this.itemCount_=d.itemCount,this.updateShape_()},decompose:function(d){const m=d.newBlock("lists_create_with_container");m.initSvg();let b=m.getInput("STACK").connection;for(let y=0;y<this.itemCount_;y++){const O=d.newBlock("lists_create_with_item");if(O.initSvg(),!O.previousConnection)throw Error("itemBlock has no previousConnection");b.connect(O.previousConnection),b=O.nextConnection}return m},compose:function(d){var m=d.getInputTargetBlock("STACK");for(d=[];m;)m.isInsertionMarker()||d.push(m.valueConnection_),m=m.getNextBlock();for(m=0;m<this.itemCount_;m++){const b=this.getInput("ADD"+m).connection.targetConnection;b&&!d.includes(b)&&b.disconnect()}for(this.itemCount_=d.length,this.updateShape_(),m=0;m<this.itemCount_;m++){let b;null==(b=d[m])||b.reconnect(this,"ADD"+m)}},saveConnections:function(d){d=d.getInputTargetBlock("STACK");let m=0;for(;d;){if(d.isInsertionMarker()){d=d.getNextBlock();continue}const b=this.getInput("ADD"+m);let y;d.valueConnection_=null==(y=b)?void 0:y.connection.targetConnection,d=d.getNextBlock(),m++}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(p.Msg$$module$build$src$core$msg.LISTS_CREATE_EMPTY_TITLE);for(var d=0;d<this.itemCount_;d++)if(!this.getInput("ADD"+d)){const m=this.appendValueInput("ADD"+d).setAlign(p.Align$$module$build$src$core$inputs$align.RIGHT);0===d&&m.appendField(p.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_INPUT_WITH)}for(d=this.itemCount_;this.getInput("ADD"+d);d++)this.removeInput("ADD"+d)}},We.lists_create_with_container={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(p.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD),this.appendStatementInput("STACK"),this.setTooltip(p.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP),this.contextMenu=!1}},We.lists_create_with_item={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(p.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_ITEM_TITLE),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(p.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_ITEM_TOOLTIP),this.contextMenu=!1}},We.lists_indexOf={init:function(){var d=[[p.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_FIRST,"FIRST"],[p.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_LAST,"LAST"]];if(this.setHelpUrl(p.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_HELPURL),this.setStyle("list_blocks"),this.setOutput(!0,"Number"),this.appendValueInput("VALUE").setCheck("Array").appendField(p.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_INPUT_IN_LIST),!(d=p.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:d})))throw Error("field_dropdown not found");this.appendValueInput("FIND").appendField(d,"END"),this.setInputsInline(!0),this.setTooltip(()=>p.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"0":"-1"))}},We.lists_getIndex={init:function(){var d=[[p.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_GET,"GET"],[p.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_GET_REMOVE,"GET_REMOVE"],[p.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_REMOVE,"REMOVE"]];this.WHERE_OPTIONS=[[p.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[p.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[p.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FIRST,"FIRST"],[p.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_LAST,"LAST"],[p.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(p.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_HELPURL),this.setStyle("list_blocks"),(d=p.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:d})).setValidator(function(m){m="REMOVE"===m,this.getSourceBlock().updateStatement_(m)}),this.appendValueInput("VALUE").setCheck("Array").appendField(p.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(d,"MODE").appendField("","SPACE"),(d=p.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this.WHERE_OPTIONS})).setValidator(function(m){const b=this.getValue();(m="FROM_START"===m||"FROM_END"===m)!=("FROM_START"===b||"FROM_END"===b)&&this.getSourceBlock().updateAt_(m)}),this.appendDummyInput().appendField(d,"WHERE"),this.appendDummyInput("AT"),p.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL&&this.appendDummyInput("TAIL").appendField(p.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL),this.setInputsInline(!0),this.setOutput(!0),this.updateAt_(!0),this.setTooltip(()=>{const m=this.getFieldValue("MODE"),b=this.getFieldValue("WHERE");let y="";switch(m+" "+b){case"GET FROM_START":case"GET FROM_END":y=p.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM;break;case"GET FIRST":y=p.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST;break;case"GET LAST":y=p.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST;break;case"GET RANDOM":y=p.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM;break;case"GET_REMOVE FROM_START":case"GET_REMOVE FROM_END":y=p.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM;break;case"GET_REMOVE FIRST":y=p.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST;break;case"GET_REMOVE LAST":y=p.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST;break;case"GET_REMOVE RANDOM":y=p.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM;break;case"REMOVE FROM_START":case"REMOVE FROM_END":y=p.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM;break;case"REMOVE FIRST":y=p.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST;break;case"REMOVE LAST":y=p.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST;break;case"REMOVE RANDOM":y=p.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM}return("FROM_START"===b||"FROM_END"===b)&&(y+="  "+("FROM_START"===b?p.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP:p.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_END_TOOLTIP).replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),y})},mutationToDom:function(){const d=p.createElement$$module$build$src$core$utils$xml("mutation");d.setAttribute("statement",String(!this.outputConnection));const m=this.getInput("AT")instanceof p.ValueInput$$module$build$src$core$inputs$value_input;return d.setAttribute("at",String(m)),d},domToMutation:function(d){const m="true"===d.getAttribute("statement");this.updateStatement_(m),d="false"!==d.getAttribute("at"),this.updateAt_(d)},saveExtraState:function(){return this.outputConnection?null:{isStatement:!0}},loadExtraState:function(d){d.isStatement?this.updateStatement_(!0):"string"==typeof d&&this.domToMutation(p.textToDom$$module$build$src$core$utils$xml(d))},updateStatement_:function(d){d!==!this.outputConnection&&(this.unplug(!0,!0),d?(this.setOutput(!1),this.setPreviousStatement(!0),this.setNextStatement(!0)):(this.setPreviousStatement(!1),this.setNextStatement(!1),this.setOutput(!0)))},updateAt_:function(d){this.removeInput("AT"),this.removeInput("ORDINAL",!0),d?(this.appendValueInput("AT").setCheck("Number"),p.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(p.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"),p.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL&&this.moveInputBefore("TAIL",null)}},We.lists_setIndex={init:function(){var d=[[p.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_SET,"SET"],[p.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INSERT,"INSERT"]];this.WHERE_OPTIONS=[[p.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[p.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[p.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FIRST,"FIRST"],[p.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_LAST,"LAST"],[p.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(p.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(p.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INPUT_IN_LIST),d=p.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:d}),this.appendDummyInput().appendField(d,"MODE").appendField("","SPACE"),(d=p.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this.WHERE_OPTIONS})).setValidator(function(m){const b=this.getValue();(m="FROM_START"===m||"FROM_END"===m)!=("FROM_START"===b||"FROM_END"===b)&&this.getSourceBlock().updateAt_(m)}),this.appendDummyInput().appendField(d,"WHERE"),this.appendDummyInput("AT"),this.appendValueInput("TO").appendField(p.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INPUT_TO),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(p.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP),this.updateAt_(!0),this.setTooltip(()=>{const m=this.getFieldValue("MODE"),b=this.getFieldValue("WHERE");let y="";switch(m+" "+b){case"SET FROM_START":case"SET FROM_END":y=p.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM;break;case"SET FIRST":y=p.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST;break;case"SET LAST":y=p.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST;break;case"SET RANDOM":y=p.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM;break;case"INSERT FROM_START":case"INSERT FROM_END":y=p.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM;break;case"INSERT FIRST":y=p.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST;break;case"INSERT LAST":y=p.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST;break;case"INSERT RANDOM":y=p.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM}return("FROM_START"===b||"FROM_END"===b)&&(y+="  "+p.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),y})},mutationToDom:function(){const d=p.createElement$$module$build$src$core$utils$xml("mutation"),m=this.getInput("AT")instanceof p.ValueInput$$module$build$src$core$inputs$value_input;return d.setAttribute("at",String(m)),d},domToMutation:function(d){d="false"!==d.getAttribute("at"),this.updateAt_(d)},saveExtraState:function(){return null},loadExtraState:function(){},updateAt_:function(d){this.removeInput("AT"),this.removeInput("ORDINAL",!0),d?(this.appendValueInput("AT").setCheck("Number"),p.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(p.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"),this.moveInputBefore("AT","TO"),this.getInput("ORDINAL")&&this.moveInputBefore("ORDINAL","TO")}},We.lists_getSublist={init:function(){this.WHERE_OPTIONS_1=[[p.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FROM_START,"FROM_START"],[p.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FROM_END,"FROM_END"],[p.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[p.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_FROM_START,"FROM_START"],[p.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_FROM_END,"FROM_END"],[p.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_LAST,"LAST"]],this.setHelpUrl(p.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(p.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_INPUT_IN_LIST);const d=m=>{const b=p.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this["WHERE_OPTIONS_"+m]});return b.setValidator(function(y){const O=this.getValue();(y="FROM_START"===y||"FROM_END"===y)!=("FROM_START"===O||"FROM_END"===O)&&this.getSourceBlock().updateAt_(m,y)}),b};this.appendDummyInput("WHERE1_INPUT").appendField(d(1),"WHERE1"),this.appendDummyInput("AT1"),this.appendDummyInput("WHERE2_INPUT").appendField(d(2),"WHERE2"),this.appendDummyInput("AT2"),p.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL&&this.appendDummyInput("TAIL").appendField(p.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(p.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TOOLTIP)},mutationToDom:function(){const d=p.createElement$$module$build$src$core$utils$xml("mutation");var m=this.getInput("AT1")instanceof p.ValueInput$$module$build$src$core$inputs$value_input;return d.setAttribute("at1",String(m)),m=this.getInput("AT2")instanceof p.ValueInput$$module$build$src$core$inputs$value_input,d.setAttribute("at2",String(m)),d},domToMutation:function(d){const m="true"===d.getAttribute("at1");d="true"===d.getAttribute("at2"),this.updateAt_(1,m),this.updateAt_(2,d)},saveExtraState:function(){return null},loadExtraState:function(){},updateAt_:function(d,m){this.removeInput("AT"+d),this.removeInput("ORDINAL"+d,!0),m?(this.appendValueInput("AT"+d).setCheck("Number"),p.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+d).appendField(p.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+d),1===d&&(this.moveInputBefore("AT1","WHERE2_INPUT"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","WHERE2_INPUT")),p.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL&&this.moveInputBefore("TAIL",null)}},We.lists_sort={init:function(){this.jsonInit({message0:"%{BKY_LISTS_SORT_TITLE}",args0:[{type:"field_dropdown",name:"TYPE",options:[["%{BKY_LISTS_SORT_TYPE_NUMERIC}","NUMERIC"],["%{BKY_LISTS_SORT_TYPE_TEXT}","TEXT"],["%{BKY_LISTS_SORT_TYPE_IGNORECASE}","IGNORE_CASE"]]},{type:"field_dropdown",name:"DIRECTION",options:[["%{BKY_LISTS_SORT_ORDER_ASCENDING}","1"],["%{BKY_LISTS_SORT_ORDER_DESCENDING}","-1"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_SORT_TOOLTIP}",helpUrl:"%{BKY_LISTS_SORT_HELPURL}"})}},We.lists_split={init:function(){const d=p.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:[[p.Msg$$module$build$src$core$msg.LISTS_SPLIT_LIST_FROM_TEXT,"SPLIT"],[p.Msg$$module$build$src$core$msg.LISTS_SPLIT_TEXT_FROM_LIST,"JOIN"]]});if(!d)throw Error("field_dropdown not found");d.setValidator(m=>{this.updateType_(m)}),this.setHelpUrl(p.Msg$$module$build$src$core$msg.LISTS_SPLIT_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("INPUT").setCheck("String").appendField(d,"MODE"),this.appendValueInput("DELIM").setCheck("String").appendField(p.Msg$$module$build$src$core$msg.LISTS_SPLIT_WITH_DELIMITER),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.setTooltip(()=>{const m=this.getFieldValue("MODE");if("SPLIT"===m)return p.Msg$$module$build$src$core$msg.LISTS_SPLIT_TOOLTIP_SPLIT;if("JOIN"===m)return p.Msg$$module$build$src$core$msg.LISTS_SPLIT_TOOLTIP_JOIN;throw Error("Unknown mode: "+m)})},updateType_:function(d){if(this.getFieldValue("MODE")!==d){const m=this.getInput("INPUT").connection;m.setShadowDom(null);const b=m.targetBlock();b&&(m.disconnect(),b.isShadow()?b.dispose(!1):this.bumpNeighbours())}"SPLIT"===d?(this.outputConnection.setCheck("Array"),this.getInput("INPUT").setCheck("String")):(this.outputConnection.setCheck("String"),this.getInput("INPUT").setCheck("Array"))},mutationToDom:function(){const d=p.createElement$$module$build$src$core$utils$xml("mutation");return d.setAttribute("mode",this.getFieldValue("MODE")),d},domToMutation:function(d){this.updateType_(d.getAttribute("mode"))},saveExtraState:function(){return{mode:this.getFieldValue("MODE")}},loadExtraState:function(d){this.updateType_(d.mode)}},p.defineBlocks$$module$build$src$core$common(We);var te={blocks:We},ce={blocks:Object.assign({},We,Ze,Ho,di,Ne,fe,go,mt),lists:te,logic:_e,loops:vn,math:Zo,procedures:gn,texts:ct,variables:qe,variablesDynamic:Rt};return ce.__namespace__=p,ce},void 0!==(t=V.apply(po,Je))&&(ci.exports=t)},3329:function(ci,po,Ee){var V,Je,t;Je=[Ee(7519),Ee(8905),Ee(8927)],void 0!==(t="function"==typeof(V=function(D,p,mt){"use strict";return D.setLocale(p),D})?V.apply(po,Je):V)&&(ci.exports=t)},8905:function(ci,po){var Ee,Je;void 0!==(Je="function"==typeof(Ee=function(){"use strict";var t=t||{Msg:Object.create(null)};return t.Msg.ADD_COMMENT="Add Comment",t.Msg.ALT_KEY="Alt",t.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE="Can't delete the variable '%1' because it's part of the definition of the function '%2'",t.Msg.CHANGE_VALUE_TITLE="Change value:",t.Msg.CHROME_OS="ChromeOS",t.Msg.CLEAN_UP="Clean up Blocks",t.Msg.CLOSE="Close",t.Msg.COLLAPSED_WARNINGS_WARNING="Collapsed blocks contain warnings.",t.Msg.COLLAPSE_ALL="Collapse Blocks",t.Msg.COLLAPSE_BLOCK="Collapse Block",t.Msg.COLOUR_BLEND_COLOUR1="colour 1",t.Msg.COLOUR_BLEND_COLOUR2="colour 2",t.Msg.COLOUR_BLEND_HELPURL="https://meyerweb.com/eric/tools/color-blend/#:::rgbp",t.Msg.COLOUR_BLEND_RATIO="ratio",t.Msg.COLOUR_BLEND_TITLE="blend",t.Msg.COLOUR_BLEND_TOOLTIP="Blends two colours together with a given ratio (0.0 - 1.0).",t.Msg.COLOUR_PICKER_HELPURL="https://en.wikipedia.org/wiki/Color",t.Msg.COLOUR_PICKER_TOOLTIP="Choose a colour from the palette.",t.Msg.COLOUR_RANDOM_HELPURL="http://randomcolour.com",t.Msg.COLOUR_RANDOM_TITLE="random colour",t.Msg.COLOUR_RANDOM_TOOLTIP="Choose a colour at random.",t.Msg.COLOUR_RGB_BLUE="blue",t.Msg.COLOUR_RGB_GREEN="green",t.Msg.COLOUR_RGB_HELPURL="https://www.december.com/html/spec/colorpercompact.html",t.Msg.COLOUR_RGB_RED="red",t.Msg.COLOUR_RGB_TITLE="colour with",t.Msg.COLOUR_RGB_TOOLTIP="Create a colour with the specified amount of red, green, and blue. All values must be between 0 and 100.",t.Msg.COMMAND_KEY="\u2318 Command",t.Msg.CONTROLS_FLOW_STATEMENTS_HELPURL="https://github.com/google/blockly/wiki/Loops#loop-termination-blocks",t.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK="break out of loop",t.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE="continue with next iteration of loop",t.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK="Break out of the containing loop.",t.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE="Skip the rest of this loop, and continue with the next iteration.",t.Msg.CONTROLS_FLOW_STATEMENTS_WARNING="Warning: This block may only be used within a loop.",t.Msg.CONTROLS_FOREACH_HELPURL="https://github.com/google/blockly/wiki/Loops#for-each",t.Msg.CONTROLS_FOREACH_TITLE="for each item %1 in list %2",t.Msg.CONTROLS_FOREACH_TOOLTIP="For each item in a list, set the variable '%1' to the item, and then do some statements.",t.Msg.CONTROLS_FOR_HELPURL="https://github.com/google/blockly/wiki/Loops#count-with",t.Msg.CONTROLS_FOR_TITLE="count with %1 from %2 to %3 by %4",t.Msg.CONTROLS_FOR_TOOLTIP="Have the variable '%1' take on the values from the start number to the end number, counting by the specified interval, and do the specified blocks.",t.Msg.CONTROLS_IF_ELSEIF_TOOLTIP="Add a condition to the if block.",t.Msg.CONTROLS_IF_ELSE_TOOLTIP="Add a final, catch-all condition to the if block.",t.Msg.CONTROLS_IF_HELPURL="https://github.com/google/blockly/wiki/IfElse",t.Msg.CONTROLS_IF_IF_TOOLTIP="Add, remove, or reorder sections to reconfigure this if block.",t.Msg.CONTROLS_IF_MSG_ELSE="else",t.Msg.CONTROLS_IF_MSG_ELSEIF="else if",t.Msg.CONTROLS_IF_MSG_IF="if",t.Msg.CONTROLS_IF_TOOLTIP_1="If a value is true, then do some statements.",t.Msg.CONTROLS_IF_TOOLTIP_2="If a value is true, then do the first block of statements. Otherwise, do the second block of statements.",t.Msg.CONTROLS_IF_TOOLTIP_3="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements.",t.Msg.CONTROLS_IF_TOOLTIP_4="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements. If none of the values are true, do the last block of statements.",t.Msg.CONTROLS_REPEAT_HELPURL="https://en.wikipedia.org/wiki/For_loop",t.Msg.CONTROLS_REPEAT_INPUT_DO="do",t.Msg.CONTROLS_REPEAT_TITLE="repeat %1 times",t.Msg.CONTROLS_REPEAT_TOOLTIP="Do some statements several times.",t.Msg.CONTROLS_WHILEUNTIL_HELPURL="https://github.com/google/blockly/wiki/Loops#repeat",t.Msg.CONTROLS_WHILEUNTIL_OPERATOR_UNTIL="repeat until",t.Msg.CONTROLS_WHILEUNTIL_OPERATOR_WHILE="repeat while",t.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL="While a value is false, then do some statements.",t.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_WHILE="While a value is true, then do some statements.",t.Msg.CONTROL_KEY="Ctrl",t.Msg.COPY_SHORTCUT="Copy",t.Msg.CUT_SHORTCUT="Cut",t.Msg.DELETE_ALL_BLOCKS="Delete all %1 blocks?",t.Msg.DELETE_BLOCK="Delete Block",t.Msg.DELETE_VARIABLE="Delete the '%1' variable",t.Msg.DELETE_VARIABLE_CONFIRMATION="Delete %1 uses of the '%2' variable?",t.Msg.DELETE_X_BLOCKS="Delete %1 Blocks",t.Msg.DIALOG_CANCEL="Cancel",t.Msg.DIALOG_OK="OK",t.Msg.DISABLE_BLOCK="Disable Block",t.Msg.DUPLICATE_BLOCK="Duplicate",t.Msg.DUPLICATE_COMMENT="Duplicate Comment",t.Msg.EDIT_BLOCK_CONTENTS="Edit Block contents",t.Msg.ENABLE_BLOCK="Enable Block",t.Msg.EXPAND_ALL="Expand Blocks",t.Msg.EXPAND_BLOCK="Expand Block",t.Msg.EXTERNAL_INPUTS="External Inputs",t.Msg.HELP="Help",t.Msg.HELP_PROMPT="Press %1 for help on keyboard controls",t.Msg.INLINE_INPUTS="Inline Inputs",t.Msg.KEYBOARD_NAV_CONSTRAINED_MOVE_HINT="Use the arrow keys to move, then %1 to accept the position",t.Msg.KEYBOARD_NAV_COPIED_HINT="Copied. Press %1 to paste.",t.Msg.KEYBOARD_NAV_CUT_HINT="Cut. Press %1 to paste.",t.Msg.KEYBOARD_NAV_UNCONSTRAINED_MOVE_HINT="Hold %1 and use arrow keys to move freely, then %2 to accept the position",t.Msg.LINUX="Linux",t.Msg.LISTS_CREATE_EMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#create-empty-list",t.Msg.LISTS_CREATE_EMPTY_TITLE="create empty list",t.Msg.LISTS_CREATE_EMPTY_TOOLTIP="Returns a list, of length 0, containing no data records",t.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD="list",t.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP="Add, remove, or reorder sections to reconfigure this list block.",t.Msg.LISTS_CREATE_WITH_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",t.Msg.LISTS_CREATE_WITH_INPUT_WITH="create list with",t.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP="Add an item to the list.",t.Msg.LISTS_CREATE_WITH_TOOLTIP="Create a list with any number of items.",t.Msg.LISTS_GET_INDEX_FIRST="first",t.Msg.LISTS_GET_INDEX_FROM_END="# from end",t.Msg.LISTS_GET_INDEX_FROM_START="#",t.Msg.LISTS_GET_INDEX_GET="get",t.Msg.LISTS_GET_INDEX_GET_REMOVE="get and remove",t.Msg.LISTS_GET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-items-from-a-list",t.Msg.LISTS_GET_INDEX_LAST="last",t.Msg.LISTS_GET_INDEX_RANDOM="random",t.Msg.LISTS_GET_INDEX_REMOVE="remove",t.Msg.LISTS_GET_INDEX_TAIL="",t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST="Returns the first item in a list.",t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM="Returns the item at the specified position in a list.",t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST="Returns the last item in a list.",t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM="Returns a random item in a list.",t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST="Removes and returns the first item in a list.",t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM="Removes and returns the item at the specified position in a list.",t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST="Removes and returns the last item in a list.",t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM="Removes and returns a random item in a list.",t.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST="Removes the first item in a list.",t.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM="Removes the item at the specified position in a list.",t.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST="Removes the last item in a list.",t.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM="Removes a random item in a list.",t.Msg.LISTS_GET_SUBLIST_END_FROM_END="to # from end",t.Msg.LISTS_GET_SUBLIST_END_FROM_START="to #",t.Msg.LISTS_GET_SUBLIST_END_LAST="to last",t.Msg.LISTS_GET_SUBLIST_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-a-sublist",t.Msg.LISTS_GET_SUBLIST_START_FIRST="get sub-list from first",t.Msg.LISTS_GET_SUBLIST_START_FROM_END="get sub-list from # from end",t.Msg.LISTS_GET_SUBLIST_START_FROM_START="get sub-list from #",t.Msg.LISTS_GET_SUBLIST_TAIL="",t.Msg.LISTS_GET_SUBLIST_TOOLTIP="Creates a copy of the specified portion of a list.",t.Msg.LISTS_INDEX_FROM_END_TOOLTIP="%1 is the last item.",t.Msg.LISTS_INDEX_FROM_START_TOOLTIP="%1 is the first item.",t.Msg.LISTS_INDEX_OF_FIRST="find first occurrence of item",t.Msg.LISTS_INDEX_OF_HELPURL="https://github.com/google/blockly/wiki/Lists#finding-items-in-a-list",t.Msg.LISTS_INDEX_OF_LAST="find last occurrence of item",t.Msg.LISTS_INDEX_OF_TOOLTIP="Returns the index of the first/last occurrence of the item in the list. Returns %1 if item is not found.",t.Msg.LISTS_INLIST="in list",t.Msg.LISTS_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#is-empty",t.Msg.LISTS_ISEMPTY_TITLE="%1 is empty",t.Msg.LISTS_ISEMPTY_TOOLTIP="Returns true if the list is empty.",t.Msg.LISTS_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Lists#length-of",t.Msg.LISTS_LENGTH_TITLE="length of %1",t.Msg.LISTS_LENGTH_TOOLTIP="Returns the length of a list.",t.Msg.LISTS_REPEAT_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",t.Msg.LISTS_REPEAT_TITLE="create list with item %1 repeated %2 times",t.Msg.LISTS_REPEAT_TOOLTIP="Creates a list consisting of the given value repeated the specified number of times.",t.Msg.LISTS_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Lists#reversing-a-list",t.Msg.LISTS_REVERSE_MESSAGE0="reverse %1",t.Msg.LISTS_REVERSE_TOOLTIP="Reverse a copy of a list.",t.Msg.LISTS_SET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#in-list--set",t.Msg.LISTS_SET_INDEX_INPUT_TO="as",t.Msg.LISTS_SET_INDEX_INSERT="insert at",t.Msg.LISTS_SET_INDEX_SET="set",t.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST="Inserts the item at the start of a list.",t.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM="Inserts the item at the specified position in a list.",t.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST="Append the item to the end of a list.",t.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM="Inserts the item randomly in a list.",t.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST="Sets the first item in a list.",t.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM="Sets the item at the specified position in a list.",t.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST="Sets the last item in a list.",t.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM="Sets a random item in a list.",t.Msg.LISTS_SORT_HELPURL="https://github.com/google/blockly/wiki/Lists#sorting-a-list",t.Msg.LISTS_SORT_ORDER_ASCENDING="ascending",t.Msg.LISTS_SORT_ORDER_DESCENDING="descending",t.Msg.LISTS_SORT_TITLE="sort %1 %2 %3",t.Msg.LISTS_SORT_TOOLTIP="Sort a copy of a list.",t.Msg.LISTS_SORT_TYPE_IGNORECASE="alphabetic, ignore case",t.Msg.LISTS_SORT_TYPE_NUMERIC="numeric",t.Msg.LISTS_SORT_TYPE_TEXT="alphabetic",t.Msg.LISTS_SPLIT_HELPURL="https://github.com/google/blockly/wiki/Lists#splitting-strings-and-joining-lists",t.Msg.LISTS_SPLIT_LIST_FROM_TEXT="make list from text",t.Msg.LISTS_SPLIT_TEXT_FROM_LIST="make text from list",t.Msg.LISTS_SPLIT_TOOLTIP_JOIN="Join a list of texts into one text, separated by a delimiter.",t.Msg.LISTS_SPLIT_TOOLTIP_SPLIT="Split text into a list of texts, breaking at each delimiter.",t.Msg.LISTS_SPLIT_WITH_DELIMITER="with delimiter",t.Msg.LOGIC_BOOLEAN_FALSE="false",t.Msg.LOGIC_BOOLEAN_HELPURL="https://github.com/google/blockly/wiki/Logic#values",t.Msg.LOGIC_BOOLEAN_TOOLTIP="Returns either true or false.",t.Msg.LOGIC_BOOLEAN_TRUE="true",t.Msg.LOGIC_COMPARE_HELPURL="https://en.wikipedia.org/wiki/Inequality_(mathematics)",t.Msg.LOGIC_COMPARE_TOOLTIP_EQ="Return true if both inputs equal each other.",t.Msg.LOGIC_COMPARE_TOOLTIP_GT="Return true if the first input is greater than the second input.",t.Msg.LOGIC_COMPARE_TOOLTIP_GTE="Return true if the first input is greater than or equal to the second input.",t.Msg.LOGIC_COMPARE_TOOLTIP_LT="Return true if the first input is smaller than the second input.",t.Msg.LOGIC_COMPARE_TOOLTIP_LTE="Return true if the first input is smaller than or equal to the second input.",t.Msg.LOGIC_COMPARE_TOOLTIP_NEQ="Return true if both inputs are not equal to each other.",t.Msg.LOGIC_NEGATE_HELPURL="https://github.com/google/blockly/wiki/Logic#not",t.Msg.LOGIC_NEGATE_TITLE="not %1",t.Msg.LOGIC_NEGATE_TOOLTIP="Returns true if the input is false. Returns false if the input is true.",t.Msg.LOGIC_NULL="null",t.Msg.LOGIC_NULL_HELPURL="https://en.wikipedia.org/wiki/Nullable_type",t.Msg.LOGIC_NULL_TOOLTIP="Returns null.",t.Msg.LOGIC_OPERATION_AND="and",t.Msg.LOGIC_OPERATION_HELPURL="https://github.com/google/blockly/wiki/Logic#logical-operations",t.Msg.LOGIC_OPERATION_OR="or",t.Msg.LOGIC_OPERATION_TOOLTIP_AND="Return true if both inputs are true.",t.Msg.LOGIC_OPERATION_TOOLTIP_OR="Return true if at least one of the inputs is true.",t.Msg.LOGIC_TERNARY_CONDITION="test",t.Msg.LOGIC_TERNARY_HELPURL="https://en.wikipedia.org/wiki/%3F:",t.Msg.LOGIC_TERNARY_IF_FALSE="if false",t.Msg.LOGIC_TERNARY_IF_TRUE="if true",t.Msg.LOGIC_TERNARY_TOOLTIP="Check the condition in 'test'. If the condition is true, returns the 'if true' value; otherwise returns the 'if false' value.",t.Msg.MAC_OS="macOS",t.Msg.MATH_ADDITION_SYMBOL="+",t.Msg.MATH_ARITHMETIC_HELPURL="https://en.wikipedia.org/wiki/Arithmetic",t.Msg.MATH_ARITHMETIC_TOOLTIP_ADD="Return the sum of the two numbers.",t.Msg.MATH_ARITHMETIC_TOOLTIP_DIVIDE="Return the quotient of the two numbers.",t.Msg.MATH_ARITHMETIC_TOOLTIP_MINUS="Return the difference of the two numbers.",t.Msg.MATH_ARITHMETIC_TOOLTIP_MULTIPLY="Return the product of the two numbers.",t.Msg.MATH_ARITHMETIC_TOOLTIP_POWER="Return the first number raised to the power of the second number.",t.Msg.MATH_ATAN2_HELPURL="https://en.wikipedia.org/wiki/Atan2",t.Msg.MATH_ATAN2_TITLE="atan2 of X:%1 Y:%2",t.Msg.MATH_ATAN2_TOOLTIP="Return the arctangent of point (X, Y) in degrees from -180 to 180.",t.Msg.MATH_CHANGE_HELPURL="https://en.wikipedia.org/wiki/Programming_idiom#Incrementing_a_counter",t.Msg.MATH_CHANGE_TITLE="change %1 by %2",t.Msg.MATH_CHANGE_TOOLTIP="Add a number to variable '%1'.",t.Msg.MATH_CONSTANT_HELPURL="https://en.wikipedia.org/wiki/Mathematical_constant",t.Msg.MATH_CONSTANT_TOOLTIP="Return one of the common constants: \u03c0 (3.141\u2026), e (2.718\u2026), \u03c6 (1.618\u2026), sqrt(2) (1.414\u2026), sqrt(\xbd) (0.707\u2026), or \u221e (infinity).",t.Msg.MATH_CONSTRAIN_HELPURL="https://en.wikipedia.org/wiki/Clamping_(graphics)",t.Msg.MATH_CONSTRAIN_TITLE="constrain %1 low %2 high %3",t.Msg.MATH_CONSTRAIN_TOOLTIP="Constrain a number to be between the specified limits (inclusive).",t.Msg.MATH_DIVISION_SYMBOL="\xf7",t.Msg.MATH_IS_DIVISIBLE_BY="is divisible by",t.Msg.MATH_IS_EVEN="is even",t.Msg.MATH_IS_NEGATIVE="is negative",t.Msg.MATH_IS_ODD="is odd",t.Msg.MATH_IS_POSITIVE="is positive",t.Msg.MATH_IS_PRIME="is prime",t.Msg.MATH_IS_TOOLTIP="Check if a number is an even, odd, prime, whole, positive, negative, or if it is divisible by certain number. Returns true or false.",t.Msg.MATH_IS_WHOLE="is whole",t.Msg.MATH_MODULO_HELPURL="https://en.wikipedia.org/wiki/Modulo_operation",t.Msg.MATH_MODULO_TITLE="remainder of %1 \xf7 %2",t.Msg.MATH_MODULO_TOOLTIP="Return the remainder from dividing the two numbers.",t.Msg.MATH_MULTIPLICATION_SYMBOL="\xd7",t.Msg.MATH_NUMBER_HELPURL="https://en.wikipedia.org/wiki/Number",t.Msg.MATH_NUMBER_TOOLTIP="A number.",t.Msg.MATH_ONLIST_HELPURL="",t.Msg.MATH_ONLIST_OPERATOR_AVERAGE="average of list",t.Msg.MATH_ONLIST_OPERATOR_MAX="max of list",t.Msg.MATH_ONLIST_OPERATOR_MEDIAN="median of list",t.Msg.MATH_ONLIST_OPERATOR_MIN="min of list",t.Msg.MATH_ONLIST_OPERATOR_MODE="modes of list",t.Msg.MATH_ONLIST_OPERATOR_RANDOM="random item of list",t.Msg.MATH_ONLIST_OPERATOR_STD_DEV="standard deviation of list",t.Msg.MATH_ONLIST_OPERATOR_SUM="sum of list",t.Msg.MATH_ONLIST_TOOLTIP_AVERAGE="Return the average (arithmetic mean) of the numeric values in the list.",t.Msg.MATH_ONLIST_TOOLTIP_MAX="Return the largest number in the list.",t.Msg.MATH_ONLIST_TOOLTIP_MEDIAN="Return the median number in the list.",t.Msg.MATH_ONLIST_TOOLTIP_MIN="Return the smallest number in the list.",t.Msg.MATH_ONLIST_TOOLTIP_MODE="Return a list of the most common item(s) in the list.",t.Msg.MATH_ONLIST_TOOLTIP_RANDOM="Return a random element from the list.",t.Msg.MATH_ONLIST_TOOLTIP_STD_DEV="Return the standard deviation of the list.",t.Msg.MATH_ONLIST_TOOLTIP_SUM="Return the sum of all the numbers in the list.",t.Msg.MATH_POWER_SYMBOL="^",t.Msg.MATH_RANDOM_FLOAT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",t.Msg.MATH_RANDOM_FLOAT_TITLE_RANDOM="random fraction",t.Msg.MATH_RANDOM_FLOAT_TOOLTIP="Return a random fraction between 0.0 (inclusive) and 1.0 (exclusive).",t.Msg.MATH_RANDOM_INT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",t.Msg.MATH_RANDOM_INT_TITLE="random integer from %1 to %2",t.Msg.MATH_RANDOM_INT_TOOLTIP="Return a random integer between the two specified limits, inclusive.",t.Msg.MATH_ROUND_HELPURL="https://en.wikipedia.org/wiki/Rounding",t.Msg.MATH_ROUND_OPERATOR_ROUND="round",t.Msg.MATH_ROUND_OPERATOR_ROUNDDOWN="round down",t.Msg.MATH_ROUND_OPERATOR_ROUNDUP="round up",t.Msg.MATH_ROUND_TOOLTIP="Round a number up or down.",t.Msg.MATH_SINGLE_HELPURL="https://en.wikipedia.org/wiki/Square_root",t.Msg.MATH_SINGLE_OP_ABSOLUTE="absolute",t.Msg.MATH_SINGLE_OP_ROOT="square root",t.Msg.MATH_SINGLE_TOOLTIP_ABS="Return the absolute value of a number.",t.Msg.MATH_SINGLE_TOOLTIP_EXP="Return e to the power of a number.",t.Msg.MATH_SINGLE_TOOLTIP_LN="Return the natural logarithm of a number.",t.Msg.MATH_SINGLE_TOOLTIP_LOG10="Return the base 10 logarithm of a number.",t.Msg.MATH_SINGLE_TOOLTIP_NEG="Return the negation of a number.",t.Msg.MATH_SINGLE_TOOLTIP_POW10="Return 10 to the power of a number.",t.Msg.MATH_SINGLE_TOOLTIP_ROOT="Return the square root of a number.",t.Msg.MATH_SUBTRACTION_SYMBOL="-",t.Msg.MATH_TRIG_ACOS="acos",t.Msg.MATH_TRIG_ASIN="asin",t.Msg.MATH_TRIG_ATAN="atan",t.Msg.MATH_TRIG_COS="cos",t.Msg.MATH_TRIG_HELPURL="https://en.wikipedia.org/wiki/Trigonometric_functions",t.Msg.MATH_TRIG_SIN="sin",t.Msg.MATH_TRIG_TAN="tan",t.Msg.MATH_TRIG_TOOLTIP_ACOS="Return the arccosine of a number.",t.Msg.MATH_TRIG_TOOLTIP_ASIN="Return the arcsine of a number.",t.Msg.MATH_TRIG_TOOLTIP_ATAN="Return the arctangent of a number.",t.Msg.MATH_TRIG_TOOLTIP_COS="Return the cosine of a degree (not radian).",t.Msg.MATH_TRIG_TOOLTIP_SIN="Return the sine of a degree (not radian).",t.Msg.MATH_TRIG_TOOLTIP_TAN="Return the tangent of a degree (not radian).",t.Msg.MOVE_BLOCK="Move Block",t.Msg.NEW_COLOUR_VARIABLE="Create colour variable...",t.Msg.NEW_NUMBER_VARIABLE="Create number variable...",t.Msg.NEW_STRING_VARIABLE="Create string variable...",t.Msg.NEW_VARIABLE="Create variable...",t.Msg.NEW_VARIABLE_TITLE="New variable name:",t.Msg.NEW_VARIABLE_TYPE_TITLE="New variable type:",t.Msg.OPTION_KEY="\u2325 Option",t.Msg.ORDINAL_NUMBER_SUFFIX="",t.Msg.PASTE_SHORTCUT="Paste",t.Msg.PROCEDURES_ALLOW_STATEMENTS="allow statements",t.Msg.PROCEDURES_BEFORE_PARAMS="with:",t.Msg.PROCEDURES_CALLNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",t.Msg.PROCEDURES_CALLNORETURN_TOOLTIP="Run the user-defined function '%1'.",t.Msg.PROCEDURES_CALLRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",t.Msg.PROCEDURES_CALLRETURN_TOOLTIP="Run the user-defined function '%1' and use its output.",t.Msg.PROCEDURES_CALL_BEFORE_PARAMS="with:",t.Msg.PROCEDURES_CALL_DISABLED_DEF_WARNING="Can't run the user-defined function '%1' because the definition block is disabled.",t.Msg.PROCEDURES_CREATE_DO="Create '%1'",t.Msg.PROCEDURES_DEFNORETURN_COMMENT="Describe this function...",t.Msg.PROCEDURES_DEFNORETURN_DO="",t.Msg.PROCEDURES_DEFNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",t.Msg.PROCEDURES_DEFNORETURN_PROCEDURE="do something",t.Msg.PROCEDURES_DEFNORETURN_TITLE="to",t.Msg.PROCEDURES_DEFNORETURN_TOOLTIP="Creates a function with no output.",t.Msg.PROCEDURES_DEFRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",t.Msg.PROCEDURES_DEFRETURN_RETURN="return",t.Msg.PROCEDURES_DEFRETURN_TOOLTIP="Creates a function with an output.",t.Msg.PROCEDURES_DEF_DUPLICATE_WARNING="Warning: This function has duplicate parameters.",t.Msg.PROCEDURES_HIGHLIGHT_DEF="Highlight function definition",t.Msg.PROCEDURES_IFRETURN_HELPURL="https://c2.com/cgi/wiki?GuardClause",t.Msg.PROCEDURES_IFRETURN_TOOLTIP="If a value is true, then return a second value.",t.Msg.PROCEDURES_IFRETURN_WARNING="Warning: This block may be used only within a function definition.",t.Msg.PROCEDURES_MUTATORARG_TITLE="input name:",t.Msg.PROCEDURES_MUTATORARG_TOOLTIP="Add an input to the function.",t.Msg.PROCEDURES_MUTATORCONTAINER_TITLE="inputs",t.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP="Add, remove, or reorder inputs to this function.",t.Msg.REDO="Redo",t.Msg.REMOVE_COMMENT="Remove Comment",t.Msg.RENAME_VARIABLE="Rename variable...",t.Msg.RENAME_VARIABLE_TITLE="Rename all '%1' variables to:",t.Msg.SHORTCUTS_CODE_NAVIGATION="Code navigation",t.Msg.SHORTCUTS_EDITING="Editing",t.Msg.SHORTCUTS_GENERAL="General",t.Msg.TEXT_APPEND_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",t.Msg.TEXT_APPEND_TITLE="to %1 append text %2",t.Msg.TEXT_APPEND_TOOLTIP="Append some text to variable '%1'.",t.Msg.TEXT_CHANGECASE_HELPURL="https://github.com/google/blockly/wiki/Text#adjusting-text-case",t.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE="to lower case",t.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE="to Title Case",t.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE="to UPPER CASE",t.Msg.TEXT_CHANGECASE_TOOLTIP="Return a copy of the text in a different case.",t.Msg.TEXT_CHARAT_FIRST="get first letter",t.Msg.TEXT_CHARAT_FROM_END="get letter # from end",t.Msg.TEXT_CHARAT_FROM_START="get letter #",t.Msg.TEXT_CHARAT_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-text",t.Msg.TEXT_CHARAT_LAST="get last letter",t.Msg.TEXT_CHARAT_RANDOM="get random letter",t.Msg.TEXT_CHARAT_TAIL="",t.Msg.TEXT_CHARAT_TITLE="in text %1 %2",t.Msg.TEXT_CHARAT_TOOLTIP="Returns the letter at the specified position.",t.Msg.TEXT_COUNT_HELPURL="https://github.com/google/blockly/wiki/Text#counting-substrings",t.Msg.TEXT_COUNT_MESSAGE0="count %1 in %2",t.Msg.TEXT_COUNT_TOOLTIP="Count how many times some text occurs within some other text.",t.Msg.TEXT_CREATE_JOIN_ITEM_TOOLTIP="Add an item to the text.",t.Msg.TEXT_CREATE_JOIN_TITLE_JOIN="join",t.Msg.TEXT_CREATE_JOIN_TOOLTIP="Add, remove, or reorder sections to reconfigure this text block.",t.Msg.TEXT_GET_SUBSTRING_END_FROM_END="to letter # from end",t.Msg.TEXT_GET_SUBSTRING_END_FROM_START="to letter #",t.Msg.TEXT_GET_SUBSTRING_END_LAST="to last letter",t.Msg.TEXT_GET_SUBSTRING_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-a-region-of-text",t.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT="in text",t.Msg.TEXT_GET_SUBSTRING_START_FIRST="get substring from first letter",t.Msg.TEXT_GET_SUBSTRING_START_FROM_END="get substring from letter # from end",t.Msg.TEXT_GET_SUBSTRING_START_FROM_START="get substring from letter #",t.Msg.TEXT_GET_SUBSTRING_TAIL="",t.Msg.TEXT_GET_SUBSTRING_TOOLTIP="Returns a specified portion of the text.",t.Msg.TEXT_INDEXOF_HELPURL="https://github.com/google/blockly/wiki/Text#finding-text",t.Msg.TEXT_INDEXOF_OPERATOR_FIRST="find first occurrence of text",t.Msg.TEXT_INDEXOF_OPERATOR_LAST="find last occurrence of text",t.Msg.TEXT_INDEXOF_TITLE="in text %1 %2 %3",t.Msg.TEXT_INDEXOF_TOOLTIP="Returns the index of the first/last occurrence of the first text in the second text. Returns %1 if text is not found.",t.Msg.TEXT_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Text#checking-for-empty-text",t.Msg.TEXT_ISEMPTY_TITLE="%1 is empty",t.Msg.TEXT_ISEMPTY_TOOLTIP="Returns true if the provided text is empty.",t.Msg.TEXT_JOIN_HELPURL="https://github.com/google/blockly/wiki/Text#text-creation",t.Msg.TEXT_JOIN_TITLE_CREATEWITH="create text with",t.Msg.TEXT_JOIN_TOOLTIP="Create a piece of text by joining together any number of items.",t.Msg.TEXT_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",t.Msg.TEXT_LENGTH_TITLE="length of %1",t.Msg.TEXT_LENGTH_TOOLTIP="Returns the number of letters (including spaces) in the provided text.",t.Msg.TEXT_PRINT_HELPURL="https://github.com/google/blockly/wiki/Text#printing-text",t.Msg.TEXT_PRINT_TITLE="print %1",t.Msg.TEXT_PRINT_TOOLTIP="Print the specified text, number or other value.",t.Msg.TEXT_PROMPT_HELPURL="https://github.com/google/blockly/wiki/Text#getting-input-from-the-user",t.Msg.TEXT_PROMPT_TOOLTIP_NUMBER="Prompt for user for a number.",t.Msg.TEXT_PROMPT_TOOLTIP_TEXT="Prompt for user for some text.",t.Msg.TEXT_PROMPT_TYPE_NUMBER="prompt for number with message",t.Msg.TEXT_PROMPT_TYPE_TEXT="prompt for text with message",t.Msg.TEXT_REPLACE_HELPURL="https://github.com/google/blockly/wiki/Text#replacing-substrings",t.Msg.TEXT_REPLACE_MESSAGE0="replace %1 with %2 in %3",t.Msg.TEXT_REPLACE_TOOLTIP="Replace all occurances of some text within some other text.",t.Msg.TEXT_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Text#reversing-text",t.Msg.TEXT_REVERSE_MESSAGE0="reverse %1",t.Msg.TEXT_REVERSE_TOOLTIP="Reverses the order of the characters in the text.",t.Msg.TEXT_TEXT_HELPURL="https://en.wikipedia.org/wiki/String_(computer_science)",t.Msg.TEXT_TEXT_TOOLTIP="A letter, word, or line of text.",t.Msg.TEXT_TRIM_HELPURL="https://github.com/google/blockly/wiki/Text#trimming-removing-spaces",t.Msg.TEXT_TRIM_OPERATOR_BOTH="trim spaces from both sides of",t.Msg.TEXT_TRIM_OPERATOR_LEFT="trim spaces from left side of",t.Msg.TEXT_TRIM_OPERATOR_RIGHT="trim spaces from right side of",t.Msg.TEXT_TRIM_TOOLTIP="Return a copy of the text with spaces removed from one or both ends.",t.Msg.TODAY="Today",t.Msg.UNDO="Undo",t.Msg.UNKNOWN="Unknown",t.Msg.UNNAMED_KEY="unnamed",t.Msg.VARIABLES_DEFAULT_NAME="item",t.Msg.VARIABLES_GET_CREATE_SET="Create 'set %1'",t.Msg.VARIABLES_GET_HELPURL="https://github.com/google/blockly/wiki/Variables#get",t.Msg.VARIABLES_GET_TOOLTIP="Returns the value of this variable.",t.Msg.VARIABLES_SET="set %1 to %2",t.Msg.VARIABLES_SET_CREATE_GET="Create 'get %1'",t.Msg.VARIABLES_SET_HELPURL="https://github.com/google/blockly/wiki/Variables#set",t.Msg.VARIABLES_SET_TOOLTIP="Sets this variable to be equal to the input.",t.Msg.VARIABLE_ALREADY_EXISTS="A variable named '%1' already exists.",t.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE="A variable named '%1' already exists for another type: '%2'.",t.Msg.VARIABLE_ALREADY_EXISTS_FOR_A_PARAMETER="A variable named '%1' already exists as a parameter in the procedure '%2'.",t.Msg.WINDOWS="Windows",t.Msg.WORKSPACE_ARIA_LABEL="Blockly Workspace",t.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT="Say something...",t.Msg.CONTROLS_FOREACH_INPUT_DO=t.Msg.CONTROLS_REPEAT_INPUT_DO,t.Msg.CONTROLS_FOR_INPUT_DO=t.Msg.CONTROLS_REPEAT_INPUT_DO,t.Msg.CONTROLS_IF_ELSEIF_TITLE_ELSEIF=t.Msg.CONTROLS_IF_MSG_ELSEIF,t.Msg.CONTROLS_IF_ELSE_TITLE_ELSE=t.Msg.CONTROLS_IF_MSG_ELSE,t.Msg.CONTROLS_IF_IF_TITLE_IF=t.Msg.CONTROLS_IF_MSG_IF,t.Msg.CONTROLS_IF_MSG_THEN=t.Msg.CONTROLS_REPEAT_INPUT_DO,t.Msg.CONTROLS_WHILEUNTIL_INPUT_DO=t.Msg.CONTROLS_REPEAT_INPUT_DO,t.Msg.LISTS_CREATE_WITH_ITEM_TITLE=t.Msg.VARIABLES_DEFAULT_NAME,t.Msg.LISTS_GET_INDEX_HELPURL=t.Msg.LISTS_INDEX_OF_HELPURL,t.Msg.LISTS_GET_INDEX_INPUT_IN_LIST=t.Msg.LISTS_INLIST,t.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST=t.Msg.LISTS_INLIST,t.Msg.LISTS_INDEX_OF_INPUT_IN_LIST=t.Msg.LISTS_INLIST,t.Msg.LISTS_SET_INDEX_INPUT_IN_LIST=t.Msg.LISTS_INLIST,t.Msg.MATH_CHANGE_TITLE_ITEM=t.Msg.VARIABLES_DEFAULT_NAME,t.Msg.PROCEDURES_DEFRETURN_COMMENT=t.Msg.PROCEDURES_DEFNORETURN_COMMENT,t.Msg.PROCEDURES_DEFRETURN_DO=t.Msg.PROCEDURES_DEFNORETURN_DO,t.Msg.PROCEDURES_DEFRETURN_PROCEDURE=t.Msg.PROCEDURES_DEFNORETURN_PROCEDURE,t.Msg.PROCEDURES_DEFRETURN_TITLE=t.Msg.PROCEDURES_DEFNORETURN_TITLE,t.Msg.TEXT_APPEND_VARIABLE=t.Msg.VARIABLES_DEFAULT_NAME,t.Msg.TEXT_CREATE_JOIN_ITEM_TITLE_ITEM=t.Msg.VARIABLES_DEFAULT_NAME,t.Msg.MATH_HUE="230",t.Msg.LOOPS_HUE="120",t.Msg.LISTS_HUE="260",t.Msg.LOGIC_HUE="210",t.Msg.VARIABLES_HUE="330",t.Msg.TEXTS_HUE="160",t.Msg.PROCEDURES_HUE="290",t.Msg.COLOUR_HUE="20",t.Msg.VARIABLES_DYNAMIC_HUE="310",t.Msg})?Ee.apply(po,[]):Ee)&&(ci.exports=Je)}}]);