(self.webpackChunklogic_programming=self.webpackChunklogic_programming||[]).push([[898],{7898:(Xo,no,ce)=>{"use strict";ce.r(no),ce.d(no,{HomeModule:()=>il});var V=ce(6814),Fe=ce(9310),o=ce(4946);let U=(()=>{class h{constructor(r){this.router=r}isElectron(){return!!(window&&window.process&&window.process.type||window&&window.require||typeof navigator<"u"&&navigator.userAgent.toLowerCase().indexOf("electron")>-1||"file:"===window.location.protocol)}isGitHubPages(){return"napssters.github.io"===window.location.hostname}isLocalDevelopment(){return"localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname}navigateTo(r){if(console.log("Environment check:",{isElectron:this.isElectron(),isGitHubPages:this.isGitHubPages(),isLocalDevelopment:this.isLocalDevelopment(),protocol:window.location.protocol,hostname:window.location.hostname}),this.isElectron())console.log("Using Angular Router for Electron:",r),this.router.navigate([r]);else if(this.isGitHubPages()){const p=`/logic-programming${r}`;console.log("Using window.location for GitHub Pages:",p),window.location.href=p}else console.log("Using Angular Router for local development:",r),this.router.navigate([r])}static{this.\u0275fac=function(p){return new(p||h)(o.LFG(Fe.F0))}}static{this.\u0275prov=o.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"})}}return h})(),d=(()=>{class h{transform(r){return r?"funciones y modularidad"===r.trim().toLowerCase()?"Funciones/Modularidad":"abstracci\xf3n y simplificaci\xf3n"===r.trim().toLowerCase()?"Abstracci\xf3n/Simplificaci\xf3n":r:""}static{this.\u0275fac=function(p){return new(p||h)}}static{this.\u0275pipe=o.Yjl({name:"cardTitleFormat",type:h,pure:!0})}}return h})();function tt(h,w){if(1&h){const r=o.EpF();o.TgZ(0,"div",2)(1,"button",3),o.NdJ("click",function(){const _=o.CHM(r).$implicit,S=o.oxw();return o.KtG(S.redirigir(_.url))}),o.TgZ(2,"div",4)(3,"div",5)(4,"div",6),o._UZ(5,"img",7),o.qZA(),o.TgZ(6,"h3",8),o.ALo(7,"cardTitleFormat"),o._uU(8),o.ALo(9,"cardTitleFormat"),o.qZA()(),o.TgZ(10,"div",9)(11,"span",10),o._uU(12),o.qZA(),o.TgZ(13,"p",11),o._uU(14),o.qZA()()()()()}if(2&h){const r=w.$implicit,p=w.index;o.xp6(4),o.Udp("background",r.color),o.xp6(1),o.Q6J("src",r.image,o.LSH)("alt",r.title),o.xp6(1),o.Q6J("ngClass","Abstracci\xf3n/Simplificaci\xf3n"===o.lcZ(7,8,r.title)?"text-left":"text-center justify-center mx-auto"),o.xp6(2),o.Oqu(o.lcZ(9,10,r.title)),o.xp6(4),o.hij("M\xf3dulo ",p+1,""),o.xp6(2),o.Oqu(r.description)}}let Ko=(()=>{class h{constructor(r){this.navigationService=r,this.cards=[]}redirigir(r){this.navigationService.navigateTo(r)}static{this.\u0275fac=function(p){return new(p||h)(o.Y36(U))}}static{this.\u0275cmp=o.Xpm({type:h,selectors:[["app-cards"]],inputs:{cards:"cards"},decls:2,vars:1,consts:[[1,"grid","grid-cols-1","md:grid-cols-3","md:gap-x-0.5","md:gap-y-6","justify-center"],["class","card-flip-container",4,"ngFor","ngForOf"],[1,"card-flip-container"],[1,"card-link",3,"click"],[1,"card-flip"],[1,"card-flip-front","flex","flex-col","items-center","justify-center","rounded-xl","shadow-lg","p-6","h-[292px]","w-[286px]","cursor-pointer","bg-white"],[1,"w-[153px]","h-[153px]","mb-4","rounded-full","shadow-md","flex","items-center","justify-center"],[1,"w-[145px]","h-[145px]","rounded-full","object-cover",3,"src","alt"],[1,"text-base","font-semibold","text-gray-900","drop-shadow","max-w-[250px]","line-clamp-2","h-12","flex","items-center",3,"ngClass"],[1,"card-flip-back","flex","flex-col","items-center","justify-center","rounded-xl","shadow-lg","p-6","h-[292px]","w-[286px]","cursor-pointer","bg-white/90"],[1,"text-sm","font-bold","text-cyan-700","mb-2"],[1,"text-base","text-gray-800","w-full","text-justify"]],template:function(p,a){1&p&&(o.TgZ(0,"div",0),o.YNc(1,tt,15,12,"div",1),o.qZA()),2&p&&(o.xp6(1),o.Q6J("ngForOf",a.cards))},dependencies:[V.mk,V.sg,d],styles:[".card-flip-container[_ngcontent-%COMP%]{perspective:1000px;display:flex;justify-content:center;align-items:center}.card-link[_ngcontent-%COMP%]{text-decoration:none}.card-flip[_ngcontent-%COMP%]{width:224px;height:256px;position:relative;transition:transform .6s;transform-style:preserve-3d;cursor:pointer}.card-flip-container[_ngcontent-%COMP%]:hover   .card-flip[_ngcontent-%COMP%]{transform:rotateY(180deg)}.card-flip-front[_ngcontent-%COMP%], .card-flip-back[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;backface-visibility:hidden;border-radius:1rem;box-shadow:0 8px 32px #1f26875e;display:flex;flex-direction:column;align-items:center;justify-content:center}.card-flip-back[_ngcontent-%COMP%]{transform:rotateY(180deg)}"]})}}return h})(),Jo=(()=>{class h{static{this.\u0275fac=function(p){return new(p||h)}}static{this.\u0275cmp=o.Xpm({type:h,selectors:[["app-tutorial"]],decls:88,vars:0,consts:[[1,"p-4","max-w-2xl","mx-auto"],[1,"text-3xl","font-extrabold","mb-4","text-cyan-700"],[1,"mb-6","text-lg","text-gray-700"],[1,"mb-8"],[1,"text-xl","font-bold","text-cyan-600","mb-2"],[1,"flex","gap-4","flex-wrap"],["src","assets/img/tutorial/menu-flotante.png","alt","Men\xfa flotante",1,"tutorial-img"],["src","assets/img/tutorial/menu-flotante-2.png","alt","Men\xfa flotante 2",1,"tutorial-img"],["src","assets/img/tutorial/pantalla-ppal.png","alt","Pantalla principal",1,"tutorial-img"],["src","assets/img/tutorial/modulos.png","alt","M\xf3dulos",1,"tutorial-img"],["src","assets/img/tutorial/modulos-card-girado.png","alt","M\xf3dulo girado",1,"tutorial-img"],["src","assets/img/tutorial/ejemplos.png","alt","Ejemplos",1,"tutorial-img"],["src","assets/img/tutorial/ejercicios.png","alt","Ejercicios",1,"tutorial-img"],["src","assets/img/tutorial/seccion-ejemplo.png","alt","Controles de ejercicios y ejemplos",1,"tutorial-img"],[1,"list-disc","ml-6"],[1,"mt-2"],["src","assets/img/tutorial/paso-a-paso.png","alt","Diagrama de flujo",1,"tutorial-img"],["src","assets/img/tutorial/blockly.png","alt","Blockly",1,"tutorial-img"],["src","assets/img/tutorial/seleccionar-opcion.png","alt","Selecci\xf3n de opci\xf3n",1,"tutorial-img"],[1,"mt-8","text-center","text-lg","text-cyan-700","font-semibold"]],template:function(p,a){1&p&&(o.TgZ(0,"div",0)(1,"h2",1),o._uU(2,"Tutorial de uso del aplicativo"),o.qZA(),o.TgZ(3,"p",2),o._uU(4,"Bienvenido. Aqu\xed aprender\xe1s c\xf3mo usar cada parte del aplicativo paso a paso, con im\xe1genes y explicaciones sencillas. Si nunca has usado una app de l\xf3gica de programaci\xf3n, este tutorial es para ti."),o.qZA(),o.TgZ(5,"div",3)(6,"h3",4),o._uU(7,"1. Navegaci\xf3n flotante"),o.qZA(),o.TgZ(8,"div",5),o._UZ(9,"img",6)(10,"img",7),o.qZA(),o.TgZ(11,"p"),o._uU(12,"En la esquina inferior derecha ver\xe1s un bot\xf3n flotante. Haz clic para moverte entre los m\xf3dulos del curso. Puedes ir al siguiente, anterior o volver al inicio f\xe1cilmente."),o._UZ(13,"br"),o._uU(14," Si pones el mouse encima de cada bot\xf3n, aparecer\xe1 un peque\xf1o mensaje que te explica para qu\xe9 sirve cada uno. As\xed sabr\xe1s si el bot\xf3n te lleva al siguiente m\xf3dulo, al anterior o al inicio."),o.qZA()(),o.TgZ(15,"div",3)(16,"h3",4),o._uU(17,"2. Pantalla principal y m\xf3dulos"),o.qZA(),o.TgZ(18,"div",5),o._UZ(19,"img",8)(20,"img",9)(21,"img",10),o.qZA(),o.TgZ(22,"p"),o._uU(23,"En la pantalla principal ver\xe1s tarjetas de colores. Cada tarjeta es un m\xf3dulo. Haz clic en una para abrir su contenido y empezar a aprender."),o._UZ(24,"br"),o._uU(25," Si pones el mouse encima de una tarjeta, ver\xe1s una animaci\xf3n donde la tarjeta gira y te muestra m\xe1s detalles. Adem\xe1s, aparecer\xe1 un mensaje que te explica qu\xe9 informaci\xf3n ver\xe1s al girar la tarjeta."),o.qZA()(),o.TgZ(26,"div",3)(27,"h3",4),o._uU(28,"3. Ejercicios y ejemplos"),o.qZA(),o.TgZ(29,"div",5),o._UZ(30,"img",11)(31,"img",12),o.qZA(),o.TgZ(32,"p"),o._uU(33,"Dentro de cada m\xf3dulo encontrar\xe1s ejemplos y ejercicios. Los ejemplos te muestran c\xf3mo funciona la l\xf3gica. Los ejercicios te permiten practicar y resolver problemas."),o.qZA()(),o.TgZ(34,"div",3)(35,"h3",4),o._uU(36,"4. Controles de ejercicios y ejemplos"),o.qZA(),o._UZ(37,"img",13),o.TgZ(38,"ul",14)(39,"li")(40,"b"),o._uU(41,"Avanzar:"),o.qZA(),o._uU(42,' Pasa al siguiente paso del ejercicio. Si pones el mouse encima del bot\xf3n, ver\xe1s un mensaje que te dice "Avanzar".'),o.qZA(),o.TgZ(43,"li")(44,"b"),o._uU(45,"Retroceder:"),o.qZA(),o._uU(46,' Vuelve al paso anterior. Al poner el mouse encima, ver\xe1s el mensaje "Retroceder".'),o.qZA(),o.TgZ(47,"li")(48,"b"),o._uU(49,"Reiniciar:"),o.qZA(),o._uU(50,' Vuelve a empezar el ejercicio desde cero. El mensaje "Reiniciar" te ayuda a saber para qu\xe9 sirve el bot\xf3n.'),o.qZA()(),o.TgZ(51,"p",15),o._uU(52,"Usa estos botones para controlar el ritmo y repetir los ejercicios cuantas veces quieras. Siempre que pongas el mouse encima de un bot\xf3n, aparecer\xe1 un mensaje que te explica su funci\xf3n."),o.qZA()(),o.TgZ(53,"div",3)(54,"h3",4),o._uU(55,"5. Diagrama de flujo"),o.qZA(),o._UZ(56,"img",16),o.TgZ(57,"p"),o._uU(58,"Muchos ejercicios muestran un diagrama de flujo. Este te ayuda a visualizar la l\xf3gica y el orden de los pasos. Observa c\xf3mo se conectan los bloques y sigue el flujo para entender el proceso."),o.qZA()(),o.TgZ(59,"div",3)(60,"h3",4),o._uU(61,"6. Uso de Blockly"),o.qZA(),o._UZ(62,"img",17),o.TgZ(63,"p"),o._uU(64,'Blockly es una herramienta visual para programar con bloques. Arrastra los bloques, \xfanelos y arma tu soluci\xf3n. Haz clic en "Ejecutar" para ver el resultado y comprobar si tu l\xf3gica es correcta.'),o.qZA()(),o.TgZ(65,"div",3)(66,"h3",4),o._uU(67,"7. Selecci\xf3n de opciones en Concepto de Variables"),o.qZA(),o._UZ(68,"img",18),o.TgZ(69,"p"),o._uU(70,"En el m\xf3dulo de Concepto de Variables, ver\xe1s una lista de opciones. Haz clic en una para abrir ejemplos y ejercicios espec\xedficos de ese tema."),o.qZA()(),o.TgZ(71,"div",3)(72,"h3",4),o._uU(73,"8. Consejos para aprender mejor"),o.qZA(),o.TgZ(74,"ul",14)(75,"li"),o._uU(76,"Lee cada explicaci\xf3n con calma y sigue los pasos."),o.qZA(),o.TgZ(77,"li"),o._uU(78,"Practica los ejercicios varias veces para dominar la l\xf3gica."),o.qZA(),o.TgZ(79,"li"),o._uU(80,"Usa los diagramas de flujo para entender el proceso antes de programar."),o.qZA(),o.TgZ(81,"li"),o._uU(82,"No tengas miedo de equivocarte, cada error es una oportunidad para aprender."),o.qZA(),o.TgZ(83,"li"),o._uU(84,"Si tienes dudas, revisa el tutorial o pregunta a tu profesor."),o.qZA()()(),o.TgZ(85,"div",19)(86,"p"),o._uU(87,"\xa1Listo! Ya sabes c\xf3mo usar el aplicativo. Explora, practica y aprende l\xf3gica de programaci\xf3n de forma visual y divertida."),o.qZA()()())},styles:[".tutorial-img[_ngcontent-%COMP%]{box-shadow:0 4px 16px #0000001f;border-radius:1rem}",".tutorial-img[_ngcontent-%COMP%] {\n    width: 180px;\n    max-width: 100%;\n    border-radius: 0.75rem;\n    box-shadow: 0 2px 8px rgba(0,0,0,0.12);\n    margin-bottom: 0.5rem;\n    transition: transform 0.3s cubic-bezier(.4,2,.3,1), box-shadow 0.3s;\n    cursor: pointer;\n  }\n  .tutorial-img[_ngcontent-%COMP%]:hover {\n    transform: scale(3);\n    box-shadow: 0 12px 48px rgba(0,0,0,0.28);\n    z-index: 100;\n  }\n  .tutorial-modal-bg[_ngcontent-%COMP%] {\n    position: fixed;\n    top: 0; left: 0; right: 0; bottom: 0;\n    background: rgba(0,0,0,0.7);\n    z-index: 1000;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n  .tutorial-modal-img[_ngcontent-%COMP%] {\n    max-width: 90vw;\n    max-height: 90vh;\n    border-radius: 1rem;\n    box-shadow: 0 8px 32px rgba(0,0,0,0.32);\n    background: #fff;\n    padding: 1rem;\n  }"]})}}return h})();const ot=JSON.parse('{"_":[{"title":"Introducci\xf3n a la L\xf3gica de Programaci\xf3n","description":"Fundamentos esenciales para entender c\xf3mo funcionan los programas, comparados con recetas detalladas.","image":"assets/img/landing/m1.png","url":"/home/introduccion","color":"linear-gradient(135deg, #38bdf8 0%, #6366f1 50%, #a78bfa 100%)"},{"title":"Concepto de Variables","description":"Explicaci\xf3n sobre c\xf3mo las variables almacenan datos como n\xfameros, palabras o im\xe1genes, esenciales en programaci\xf3n.","image":"assets/img/landing/m2.png","url":"/home/concepto-variables","color":"linear-gradient(135deg, #38bdf8 0%, #6366f1 50%, #a78bfa 100%)"},{"title":"Estructuras de Control: Condicionales","description":"Uso de estructuras para tomar decisiones en programas seg\xfan condiciones espec\xedficas.","image":"assets/img/landing/m3.png","url":"/home/condicionales","color":"linear-gradient(135deg, #38bdf8 0%, #6366f1 50%, #a78bfa 100%)"},{"title":"Estructuras de Control: Bucles","description":"Repetici\xf3n eficiente de acciones en programas usando bucles \'for\' y \'while\'.","image":"assets/img/landing/m4.png","url":"/home/bucles","color":"linear-gradient(135deg, #fbbf24 0%, #f472b6 100%)"},{"title":"Funciones y Modularidad","description":"Organizaci\xf3n del c\xf3digo mediante funciones para facilitar su mantenimiento y reutilizaci\xf3n.","image":"assets/img/landing/m5.png","url":"/home/modularidad","color":"linear-gradient(135deg, #fbbf24 0%, #f472b6 100%)"},{"title":"Abstracci\xf3n y Simplificaci\xf3n","description":"M\xe9todos para dividir problemas complejos en partes m\xe1s simples y manejables.","image":"assets/img/landing/m6.png","url":"/home/abstraccion","color":"linear-gradient(135deg, #fbbf24 0%, #f472b6 100%)"},{"title":"Pensamiento L\xf3gico y Deductivo","description":"Aplicaci\xf3n de razonamiento l\xf3gico para resolver problemas usando premisas y conclusiones.","image":"assets/img/landing/m7.png","url":"/home/pensamiento-logico","color":"linear-gradient(135deg, #22c55e 0%, #06b6d4 100%)"},{"title":"Toma de Decisiones y Evaluaci\xf3n de Opciones","description":"Proceso sistem\xe1tico para evaluar diferentes opciones y tomar decisiones informadas.","image":"assets/img/landing/m8.png","url":"/home/toma-de-decisiones","color":"linear-gradient(135deg, #22c55e 0%, #06b6d4 100%)"},{"title":"Soluci\xf3n Creativa de Problemas","description":"Enfoque pr\xe1ctico y creativo para resolver desaf\xedos mediante ideas originales y efectivas.","image":"assets/img/landing/m9.png","url":"/home/solucion-creativa","color":"linear-gradient(135deg, #22c55e 0%, #06b6d4 100%)"}]}');var kt=ce(2593);const ro=["dynamicComponentContainer"];function Re(h,w){if(1&h){const r=o.EpF();o.TgZ(0,"div",1),o.NdJ("click",function(a){o.CHM(r);const _=o.oxw();return o.KtG(_.onBackdropClick(a))}),o.TgZ(1,"div",2),o.NdJ("click",function(a){o.CHM(r);const _=o.oxw();return o.KtG(_.onModalContentClick(a))}),o.TgZ(2,"div",3)(3,"div")(4,"h2",4),o._uU(5),o.qZA()(),o.TgZ(6,"div",5)(7,"button",6),o.NdJ("click",function(){o.CHM(r);const a=o.oxw();return o.KtG(a.closeModal())}),o.O4$(),o.TgZ(8,"svg",7),o._UZ(9,"path",8),o.qZA(),o.kcU(),o.TgZ(10,"div",9),o._uU(11," Cerrar "),o._UZ(12,"div",10),o.qZA()()()(),o.TgZ(13,"div",11)(14,"div",12),o.GkF(15,null,13),o.qZA()()()()}if(2&h){const r=o.oxw();o.xp6(1),o.Tol(r.maxWidth+" "+r.maxHeight),o.xp6(4),o.Oqu(r.title)}}let lo=(()=>{class h{constructor(){this.isVisible=!1,this.title="",this.componentType=null,this.componentInputs={},this.maxWidth="max-w-4xl",this.maxHeight="max-h-[90vh]",this.onClose=new o.vpe,this.componentRef=null}ngOnChanges(r){r.isVisible&&this.isVisible&&this.componentType&&setTimeout(()=>{this.loadComponent()},0)}ngOnDestroy(){this.destroyComponent()}loadComponent(){!this.dynamicComponentContainer||!this.componentType||(this.destroyComponent(),this.componentRef=this.dynamicComponentContainer.createComponent(this.componentType),this.componentInputs&&Object.keys(this.componentInputs).forEach(r=>{this.componentRef?.instance.hasOwnProperty(r)&&(this.componentRef.instance[r]=this.componentInputs[r])}),this.componentRef.changeDetectorRef.detectChanges())}destroyComponent(){this.componentRef&&(this.componentRef.destroy(),this.componentRef=null),this.dynamicComponentContainer&&this.dynamicComponentContainer.clear()}closeModal(){this.onClose.emit()}onBackdropClick(r){this.closeModal()}onModalContentClick(r){r.stopPropagation()}static{this.\u0275fac=function(p){return new(p||h)}}static{this.\u0275cmp=o.Xpm({type:h,selectors:[["app-modal"]],viewQuery:function(p,a){if(1&p&&o.Gf(ro,5,o.s_b),2&p){let _;o.iGM(_=o.CRH())&&(a.dynamicComponentContainer=_.first)}},inputs:{isVisible:"isVisible",title:"title",componentType:"componentType",componentInputs:"componentInputs",maxWidth:"maxWidth",maxHeight:"maxHeight"},outputs:{onClose:"onClose"},features:[o.TTD],decls:1,vars:1,consts:[["class","fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",3,"click",4,"ngIf"],[1,"fixed","inset-0","z-50","flex","items-center","justify-center","bg-black","bg-opacity-50",3,"click"],[1,"bg-white","rounded-lg","shadow-xl","w-full","mx-4","overflow-auto",3,"click"],[1,"flex","justify-between","items-center","p-6","border-b","border-gray-200","sticky","top-0","bg-white","z-10"],[1,"text-2xl","font-bold","text-gray-800"],[1,"relative"],[1,"w-10","h-10","text-white","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border-2","group",2,"background-color","#f3ae22","border-color","#d18c00",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7"],[1,"absolute","top-12","left-1/2","transform","-translate-x-1/2","bg-gray-800","text-white","text-xs","px-2","py-1","rounded","shadow-lg","opacity-0","group-hover:opacity-100","transition-opacity","duration-200","whitespace-nowrap","pointer-events-none","z-50"],[1,"absolute","bottom-full","left-1/2","transform","-translate-x-1/2","w-0","h-0","border-l-2","border-r-2","border-b-4","border-transparent","border-b-gray-800"],[1,"p-6"],[1,"min-h-[400px]"],["dynamicComponentContainer",""]],template:function(p,a){1&p&&o.YNc(0,Re,17,3,"div",0),2&p&&o.Q6J("ngIf",a.isVisible)},dependencies:[V.O5],styles:[".modal-overlay[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px)}.modal-content[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_modalSlideIn .3s ease-out}@keyframes _ngcontent-%COMP%_modalSlideIn{0%{opacity:0;transform:translateY(-20px) scale(.95)}to{opacity:1;transform:translateY(0) scale(1)}}"]})}}return h})();const at=function(h){return{cards:h}};let Oe=(()=>{class h{constructor(r,p,a){this.router=r,this.navigationService=p,this.modalService=a,this.cards=[],this.showModal=!1,this.modalComponentType=Ko,this.modalTitle="M\xf3dulos disponibles"}redirigir(r){this.navigationService.navigateTo(r)}ngOnInit(){this.loadData(),this.modalSubscription=this.modalService.onOpenModal().subscribe(()=>{this.openCardsModal()})}ngOnDestroy(){this.modalSubscription&&this.modalSubscription.unsubscribe()}loadData(){this.cards=ot._}openCardsModal(){this.modalComponentType=Ko,this.modalTitle="M\xf3dulos disponibles",this.showModal=!0}openTutorialModal(){this.modalComponentType=Jo,this.modalTitle="Tutorial de uso del aplicativo",this.showModal=!0}closeCardsModal(){this.showModal=!1}static{this.\u0275fac=function(p){return new(p||h)(o.Y36(Fe.F0),o.Y36(U),o.Y36(kt.Z))}}static{this.\u0275cmp=o.Xpm({type:h,selectors:[["app-start-page"]],decls:21,vars:8,consts:[[1,"min-h-screen","w-full","bg-gradient-to-br","from-cyan-100","via-white","to-blue-100","relative","overflow-hidden","flex","flex-col"],[1,"absolute","inset-0","w-full","h-full","z-0"],["src","assets/img/landing/logica_de_programacion.jpeg","alt","L\xf3gica de Programaci\xf3n",1,"w-full","h-full","object-cover"],[1,"flex","flex-col","justify-center","items-start","p-8","z-10","w-full","md:w-2/3","relative",2,"margin-left","4rem","min-height","100vh","justify-content","center"],[2,"border-radius","2rem","width","87%","max-width","none","max-height","480px","background","rgba(255,255,255,0.18)","backdrop-filter","blur(16px)","box-shadow","0 8px 32px 0 rgba(31,38,135,0.37)","border","1px solid rgba(255,255,255,0.18)","padding","2.5rem 2rem","display","flex","flex-direction","column","align-items","flex-start","justify-content","center","margin-left","-2rem"],[2,"margin-left","2rem","margin-right","2rem"],[1,"w-32","h-32","rounded-full","shadow-xl","mb-6","flex","items-center","justify-center","bg-white/30","animate-bounce"],["src","assets/img/landing/utp.png","alt","utp",1,"w-28","h-28","object-contain"],[1,"text-4xl","md:text-5xl","font-extrabold","text-white","drop-shadow-lg","mb-4","leading-tight"],[1,"text-xl","md:text-2xl","text-white","drop-shadow-lg","mb-4","font-semibold"],[1,"text-base","text-white","drop-shadow-lg","mb-6","w-full","text-justify"],[1,"flex","items-center","gap-4"],[1,"bg-cyan-600","hover:bg-cyan-700","text-white","font-bold","py-2","px-6","rounded-full","shadow","transition-all","duration-300",3,"click"],[1,"flex","flex-col","items-start"],[1,"text-cyan-700","hover:text-white","hover:underline","font-semibold","text-base","cursor-pointer",3,"click"],[3,"isVisible","title","componentType","componentInputs","maxWidth","maxHeight","onClose"]],template:function(p,a){1&p&&(o.TgZ(0,"section",0)(1,"div",1),o._UZ(2,"img",2),o.qZA(),o.TgZ(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6),o._UZ(7,"img",7),o.qZA(),o.TgZ(8,"h1",8),o._uU(9,"Pensamiento b\xe1sico de Programador"),o.qZA(),o.TgZ(10,"p",9),o._uU(11,"Explorando la L\xf3gica de la Programaci\xf3n"),o.qZA(),o.TgZ(12,"p",10),o._uU(13,"Aprende l\xf3gica de programaci\xf3n de forma visual, interactiva y divertida. Descubre los m\xf3dulos y comienza tu viaje en el pensamiento computacional."),o.qZA(),o.TgZ(14,"div",11)(15,"button",12),o.NdJ("click",function(){return a.openCardsModal()}),o._uU(16,"Comenzar ahora"),o.qZA(),o.TgZ(17,"div",13)(18,"a",14),o.NdJ("click",function(){return a.openTutorialModal()}),o._uU(19,"\xbfC\xf3mo usar el aplicativo?"),o.qZA()()()()()(),o.TgZ(20,"app-modal",15),o.NdJ("onClose",function(){return a.closeCardsModal()}),o.qZA()()),2&p&&(o.xp6(20),o.Q6J("isVisible",a.showModal)("title",a.modalTitle)("componentType",a.modalComponentType)("componentInputs",o.VKq(6,at,a.cards))("maxWidth","max-w-5xl")("maxHeight","max-h-[90vh]"))},dependencies:[lo]})}}return h})();function we(h,w){1&h&&(o.TgZ(0,"section",12)(1,"div",13)(2,"h2",14),o._uU(3,"\u{1f4cd} "),o.TgZ(4,"b"),o._uU(5,"\xbfQu\xe9 es la soluci\xf3n creativa de problemas?"),o.qZA()(),o.TgZ(6,"p",15),o._uU(7," La soluci\xf3n creativa de problemas es la capacidad de encontrar caminos innovadores para resolver desaf\xedos, combinando pensamiento l\xf3gico con imaginaci\xf3n."),o._UZ(8,"br"),o._uU(9," No se trata \xfanicamente de \u201cpensar diferente\u201d por el simple hecho de ser original, sino de encontrar soluciones que sean originales y, al mismo tiempo, efectivas."),o.qZA(),o.TgZ(10,"p",15),o._uU(11,"En programaci\xf3n, muchas veces un problema puede resolverse con t\xe9cnicas ya conocidas, pero cuando estas no funcionan o no son \xf3ptimas, entra en juego la creatividad para encontrar un enfoque alternativo."),o.qZA(),o.TgZ(12,"div",16)(13,"h3",17),o._uU(14,"\u{1f4e6} Met\xe1fora: El chef improvisador"),o.qZA(),o.TgZ(15,"p",18),o._uU(16,"Imagina que eres un chef y est\xe1s cocinando un plato especial para un cliente."),o._UZ(17,"br"),o._uU(18," De repente, te das cuenta de que falta un ingrediente clave."),o.qZA(),o.TgZ(19,"ul",19)(20,"li"),o._uU(21,"Opci\xf3n tradicional: cancelar el plato o retrasar el pedido para ir a comprarlo."),o.qZA(),o.TgZ(22,"li"),o._uU(23,"Opci\xf3n creativa: sustituir el ingrediente por otro que tengas a mano y que aporte un sabor similar o incluso mejor."),o.qZA()(),o.TgZ(24,"p",18),o._uU(25,"La creatividad en la soluci\xf3n de problemas es exactamente eso: adaptarte a la situaci\xf3n y buscar nuevas combinaciones que cumplan el objetivo, incluso mejorando el resultado esperado."),o.qZA()(),o.TgZ(26,"div",20)(27,"h2",21),o._uU(28,"\u{1f504} Soluci\xf3n creativa y la vida real"),o.qZA(),o.TgZ(29,"ul",22)(30,"li"),o._uU(31,"En casa: Si se rompe el control remoto, puedes cambiar de canal usando los botones de la TV o incluso una app en el tel\xe9fono."),o.qZA(),o.TgZ(32,"li"),o._uU(33,"En el trabajo: Si un archivo es demasiado pesado para enviarlo por correo, puedes comprimirlo, subirlo a la nube o dividirlo en partes."),o.qZA(),o.TgZ(34,"li"),o._uU(35,"En la escuela: Si olvidaste tu cuaderno, puedes pedirle a un compa\xf1ero una foto de las notas."),o.qZA()(),o.TgZ(36,"p",18),o._uU(37,"La creatividad no siempre es \u201cinventar algo nuevo\u201d desde cero, muchas veces es usar lo que tienes de una forma distinta."),o.qZA()(),o.TgZ(38,"div",23)(39,"h2",24),o._uU(40,"\u{1f9e9} Elementos clave de la soluci\xf3n creativa"),o.qZA(),o.TgZ(41,"ul",22)(42,"li"),o._uU(43,"Identificaci\xf3n precisa del problema"),o._UZ(44,"br"),o.TgZ(45,"span",18),o._uU(46,"No se puede encontrar una soluci\xf3n efectiva si no se entiende exactamente qu\xe9 se quiere resolver."),o._UZ(47,"br"),o._uU(48,"Ejemplo: \u201cEl sistema es lento\u201d es muy general. \u201cEl sistema tarda 5 segundos en cargar la lista de productos\u201d es espec\xedfico y accionable."),o.qZA()(),o.TgZ(49,"li"),o._uU(50,"An\xe1lisis desde diferentes perspectivas"),o._UZ(51,"br"),o.TgZ(52,"span",18),o._uU(53,"Ver el problema desde distintos \xe1ngulos. A veces la soluci\xf3n aparece cuando lo miras desde el punto de vista de otro usuario, otro equipo o incluso otra cultura."),o.qZA()(),o.TgZ(54,"li"),o._uU(55,"Generaci\xf3n de m\xfaltiples ideas"),o._UZ(56,"br"),o.TgZ(57,"span",18),o._uU(58,"Cuantas m\xe1s ideas tengas, m\xe1s probabilidades de encontrar una soluci\xf3n innovadora. Aqu\xed no se juzga si son \u201cbuenas\u201d o \u201cmalas\u201d, la prioridad es cantidad."),o.qZA()(),o.TgZ(59,"li"),o._uU(60,"Pensar fuera del patr\xf3n (out of the box)"),o._UZ(61,"br"),o.TgZ(62,"span",18),o._uU(63,"Se trata de romper las rutas mentales comunes y atreverse a probar lo que, en principio, podr\xeda parecer extra\xf1o."),o.qZA()(),o.TgZ(64,"li"),o._uU(65,"Combinar conceptos"),o._UZ(66,"br"),o.TgZ(67,"span",18),o._uU(68,"La fusi\xf3n de dos ideas distintas suele producir soluciones poderosas. Ejemplo: las \u201cbicicletas el\xe9ctricas\u201d combinan el transporte tradicional con tecnolog\xeda el\xe9ctrica."),o.qZA()(),o.TgZ(69,"li"),o._uU(70,"Evaluaci\xf3n pr\xe1ctica"),o._UZ(71,"br"),o.TgZ(72,"span",18),o._uU(73,"No toda idea creativa es viable. Hay que considerar recursos, tiempo, riesgos y beneficios antes de implementarla."),o.qZA()(),o.TgZ(74,"li"),o._uU(75,"Iteraci\xf3n y mejora"),o._UZ(76,"br"),o.TgZ(77,"span",18),o._uU(78,"La primera versi\xf3n rara vez es perfecta. La creatividad tambi\xe9n incluye la capacidad de mejorar la soluci\xf3n con base en pruebas y retroalimentaci\xf3n."),o.qZA()()()(),o.TgZ(79,"div",16)(80,"h2",25),o._uU(81,"\u{1f9e0} Enfoques creativos usados en programaci\xf3n"),o.qZA(),o.TgZ(82,"ul",22)(83,"li"),o._uU(84,"Reutilizaci\xf3n de c\xf3digo en contextos distintos al que fue creado."),o.qZA(),o.TgZ(85,"li"),o._uU(86,"Uso de librer\xedas de forma no tradicional, combinando funciones para lograr nuevos resultados."),o.qZA(),o.TgZ(87,"li"),o._uU(88,"Aplicar conceptos de un lenguaje de programaci\xf3n en otro para obtener ventajas t\xe9cnicas."),o.qZA(),o.TgZ(89,"li"),o._uU(90,"Pensar en soluciones visuales (UI/UX) para problemas que no son puramente t\xe9cnicos."),o.qZA()()(),o.TgZ(91,"div",26)(92,"h2",27),o._uU(93,"\u{1f680} Beneficios de aplicar soluciones creativas"),o.qZA(),o.TgZ(94,"ul",22)(95,"li"),o._uU(96,"Mayor eficiencia y reducci\xf3n de costos."),o.qZA(),o.TgZ(97,"li"),o._uU(98,"Respuestas r\xe1pidas a problemas imprevistos."),o.qZA(),o.TgZ(99,"li"),o._uU(100,"Mayor competitividad y diferenciaci\xf3n en el mercado."),o.qZA(),o.TgZ(101,"li"),o._uU(102,"Mejor experiencia para el usuario final."),o.qZA(),o.TgZ(103,"li"),o._uU(104,"Incremento de la satisfacci\xf3n personal y del equipo al resolver desaf\xedos de forma ingeniosa."),o.qZA()()()()())}function co(h,w){1&h&&(o.TgZ(0,"section",12)(1,"h1",28),o._uU(2,"Ejemplos"),o.qZA()())}function Qo(h,w){1&h&&(o.TgZ(0,"section",12)(1,"h1",28),o._uU(2,"Ejercicios"),o.qZA()())}const N=function(h){return{"button-with-point":h}};let Ye=(()=>{class h{constructor(){this.selectedSection=1}static{this.\u0275fac=function(p){return new(p||h)}}static{this.\u0275cmp=o.Xpm({type:h,selectors:[["app-solucion-creativa"]],decls:23,vars:24,consts:[[1,"text-center","mb-6","mt-6"],[1,"text-3xl","font-bold","text-gray-800","mb-2","drop-shadow-md"],[1,"flex","items-center","justify-center","mb-1"],[1,"h-0.5","bg-gradient-to-r","from-transparent","via-green-500","to-transparent","w-96","shadow-sm"],[1,"flex","items-center","justify-center"],[1,"h-px","bg-gradient-to-r","from-transparent","via-gray-300","to-transparent","w-64","opacity-60"],[1,"flex","flex-col","items-center","mb-6"],[1,"sticky","top-0","z-20","w-auto","flex","justify-center","bg-transparent","backdrop-blur-md","py-2","rounded-xl"],[1,"flex","gap-72"],[1,"relative","px-4","py-2","rounded-lg","font-semibold","text-gray-700","hover:text-green-500","transition",3,"ngClass","click"],[1,"flex","flex-col","gap-6","items-center","w-full","px-2","md:px-0"],["class","bg-gray-500/20 backdrop-blur-md p-8 rounded-lg border border-gray-400/30 shadow-lg w-full max-w-7xl mt-2 mb-8",4,"ngIf"],[1,"bg-gray-500/20","backdrop-blur-md","p-8","rounded-lg","border","border-gray-400/30","shadow-lg","w-full","max-w-7xl","mt-2","mb-8"],[1,"flex","flex-col","gap-6","mb-8","justify-start","items-start"],[1,"text-xl","font-bold","text-blue-500","mb-2","flex","items-center","gap-2"],[1,"text-gray-800","ml-8"],[1,"bg-gradient-to-br","from-blue-100","via-blue-50","to-white","border-l-4","border-blue-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"text-lg","font-semibold","text-gray-700","mt-4","mb-2","flex","items-center","gap-2"],[1,"text-gray-700"],[1,"list-disc","pl-6","text-gray-700","mb-2"],[1,"bg-gradient-to-br","from-green-100","via-green-50","to-white","border-l-4","border-green-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"text-xl","font-bold","text-green-600","mb-2","flex","items-center","gap-2"],[1,"list-disc","ml-6","text-gray-800","mb-2"],[1,"bg-gradient-to-br","from-yellow-100","via-yellow-50","to-white","border-l-4","border-yellow-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"text-xl","font-bold","text-yellow-600","mb-2","flex","items-center","gap-2"],[1,"text-xl","font-bold","text-blue-600","mb-2","flex","items-center","gap-2"],[1,"bg-gradient-to-br","from-pink-100","via-pink-50","to-white","border-l-4","border-pink-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"text-xl","font-bold","text-pink-600","mb-2","flex","items-center","gap-2"],[1,"mt-6"]],template:function(p,a){1&p&&(o.TgZ(0,"div",0)(1,"h1",1),o._uU(2,"\u{1f3a8} Soluci\xf3n Creativa de Problemas"),o.qZA(),o.TgZ(3,"div",2),o._UZ(4,"div",3),o.qZA(),o.TgZ(5,"div",4),o._UZ(6,"div",5),o.qZA()(),o.TgZ(7,"div",6)(8,"nav",7)(9,"ul",8)(10,"li")(11,"button",9),o.NdJ("click",function(){return a.selectedSection=1}),o._uU(12," Teor\xeda "),o.qZA()(),o.TgZ(13,"li")(14,"button",9),o.NdJ("click",function(){return a.selectedSection=2}),o._uU(15," Ejemplos "),o.qZA()(),o.TgZ(16,"li")(17,"button",9),o.NdJ("click",function(){return a.selectedSection=3}),o._uU(18," Ejercicios "),o.qZA()()()()(),o.TgZ(19,"div",10),o.YNc(20,we,105,0,"section",11),o.YNc(21,co,3,0,"section",11),o.YNc(22,Qo,3,0,"section",11),o.qZA()),2&p&&(o.xp6(11),o.ekj("border-b-4",1===a.selectedSection)("border-blue-500",1===a.selectedSection),o.Q6J("ngClass",o.VKq(18,N,1===a.selectedSection)),o.xp6(3),o.ekj("border-b-4",2===a.selectedSection)("border-blue-500",2===a.selectedSection),o.Q6J("ngClass",o.VKq(20,N,2===a.selectedSection)),o.xp6(3),o.ekj("border-b-4",3===a.selectedSection)("border-blue-500",3===a.selectedSection),o.Q6J("ngClass",o.VKq(22,N,3===a.selectedSection)),o.xp6(3),o.Q6J("ngIf",1===a.selectedSection),o.xp6(1),o.Q6J("ngIf",2===a.selectedSection),o.xp6(1),o.Q6J("ngIf",3===a.selectedSection))},dependencies:[V.mk,V.O5],styles:[".button-with-point[_ngcontent-%COMP%]{border-bottom-width:4px!important;border-bottom-color:#22c55e!important}"]})}}return h})();function J(h,w){1&h&&(o.TgZ(0,"section",12)(1,"div",13)(2,"h2",14),o._uU(3,"\u{1f9e0} \xbfQu\xe9 es la toma de decisiones?"),o.qZA(),o.TgZ(4,"p",15),o._uU(5,"La toma de decisiones es el proceso consciente de elegir entre varias alternativas (opciones) analizando informaci\xf3n, premisas y consecuencias. En programaci\xf3n y en la vida real implica evaluar datos, aplicar reglas l\xf3gicas y seleccionar la acci\xf3n m\xe1s adecuada seg\xfan objetivos y restricciones."),o.qZA(),o.TgZ(6,"div",16)(7,"h3",17),o._uU(8,"\u{1f527} Elementos fundamentales de todo proceso de decisi\xf3n"),o.qZA(),o.TgZ(9,"ul",18)(10,"li")(11,"b"),o._uU(12,"Opciones (alternativas):"),o.qZA(),o._uU(13," las posibilidades entre las que puedes elegir."),o.qZA(),o.TgZ(14,"li")(15,"b"),o._uU(16,"Premisas / datos:"),o.qZA(),o._uU(17," hechos o suposiciones sobre la situaci\xf3n (lo que sabes)."),o.qZA(),o.TgZ(18,"li")(19,"b"),o._uU(20,"Criterios:"),o.qZA(),o._uU(21," lo que valoras para elegir (rapidez, coste, seguridad, calidad)."),o.qZA(),o.TgZ(22,"li")(23,"b"),o._uU(24,"Restricciones:"),o.qZA(),o._uU(25," l\xedmites reales (presupuesto, tiempo, recursos)."),o.qZA(),o.TgZ(26,"li")(27,"b"),o._uU(28,"Consecuencias:"),o.qZA(),o._uU(29," resultados esperados para cada opci\xf3n."),o.qZA(),o.TgZ(30,"li")(31,"b"),o._uU(32,"Incertidumbre:"),o.qZA(),o._uU(33," grado de desconocimiento o probabilidad de distintos resultados."),o.qZA()()(),o.TgZ(34,"div",19)(35,"h2",20),o._uU(36,"\u{1f4da} Tipos de decisiones"),o.qZA(),o.TgZ(37,"ul",21)(38,"li")(39,"b"),o._uU(40,"Determin\xedsticas:"),o.qZA(),o._uU(41," resultado claro si se cumplen condiciones (ej. sem\xe1foro)."),o.qZA(),o.TgZ(42,"li")(43,"b"),o._uU(44,"Probabil\xedsticas:"),o.qZA(),o._uU(45," resultado incierto (ej. clima, mercado)."),o.qZA(),o.TgZ(46,"li")(47,"b"),o._uU(48,"Simples / aisladas:"),o.qZA(),o._uU(49," una sola elecci\xf3n moment\xe1nea."),o.qZA(),o.TgZ(50,"li")(51,"b"),o._uU(52,"Secuenciales:"),o.qZA(),o._uU(53," m\xfaltiples decisiones encadenadas (planificaci\xf3n)."),o.qZA(),o.TgZ(54,"li")(55,"b"),o._uU(56,"\xd3ptimas vs. satisficing:"),o.qZA(),o._uU(57," buscar la mejor soluci\xf3n o una suficientemente buena (por tiempo/recursos)."),o.qZA()()(),o.TgZ(58,"div",22)(59,"h2",23),o._uU(60,"\u{1f9ed} Met\xe1foras cotidianas"),o.qZA(),o.TgZ(61,"ul",21)(62,"li")(63,"b"),o._uU(64,"Bifurcaci\xf3n en el camino:"),o.qZA(),o._uU(65," llegas a un cruce y tomas la ruta seg\xfan se\xf1ales (condicional)."),o.qZA(),o.TgZ(66,"li")(67,"b"),o._uU(68,"Carta de restaurante:"),o.qZA(),o._uU(69," eliges plato seg\xfan hambre, tiempo y dinero (ponderar criterios)."),o.qZA(),o.TgZ(70,"li")(71,"b"),o._uU(72,"GPS con tr\xe1fico:"),o.qZA(),o._uU(73," elige la ruta m\xe1s r\xe1pida en tiempo real (evaluaci\xf3n din\xe1mica con datos)."),o.qZA(),o.TgZ(74,"li")(75,"b"),o._uU(76,"Comprar en oferta:"),o.qZA(),o._uU(77," comparas precio y necesidad; si el descuento compensa, compras (an\xe1lisis coste-beneficio)."),o.qZA()()(),o.TgZ(78,"div",24)(79,"h2",25),o._uU(80,"\u{1f517} C\xf3mo se conectan premisas y conclusiones"),o.qZA(),o.TgZ(81,"ul",21)(82,"li"),o._uU(83,"Premisa: \u201cSi llueve, llevar\xe9 paraguas.\u201d"),o.qZA(),o.TgZ(84,"li"),o._uU(85,"Hecho observado: \u201cEst\xe1 lloviendo.\u201d"),o.qZA(),o.TgZ(86,"li"),o._uU(87,"Conclusi\xf3n: \u201cLlevo paraguas.\u201d"),o.qZA()(),o.TgZ(88,"p",26),o._uU(89,"En l\xf3gica: premisas \u2192 reglas (si\u2026 entonces, y, o, no) \u2192 conclusi\xf3n. En programaci\xf3n esto se traduce en condiciones ("),o.TgZ(90,"code"),o._uU(91,"if"),o.qZA(),o._uU(92,"), combinaciones ("),o.TgZ(93,"code"),o._uU(94,"&&"),o.qZA(),o._uU(95,", "),o.TgZ(96,"code"),o._uU(97,"||"),o.qZA(),o._uU(98,") y negaciones ("),o.TgZ(99,"code"),o._uU(100,"!"),o.qZA(),o._uU(101,")."),o.qZA()(),o.TgZ(102,"div",27)(103,"h2",28),o._uU(104,"\u{1f9e0} Modelos mentales y t\xe9cnicas l\xf3gicas \xfatiles"),o.qZA(),o.TgZ(105,"ul",21)(106,"li")(107,"b"),o._uU(108,"Si \u2026 entonces (implicaci\xf3n):"),o.qZA(),o._uU(109," estructura b\xe1sica para decisiones."),o.qZA(),o.TgZ(110,"li")(111,"b"),o._uU(112,"AND (y) / OR (o) / NOT (no):"),o.qZA(),o._uU(113," combinar condiciones."),o.qZA(),o.TgZ(114,"li")(115,"b"),o._uU(116,"\xc1rbol de decisi\xf3n:"),o.qZA(),o._uU(117," representar opciones y sus resultados en ramas."),o.qZA(),o.TgZ(118,"li")(119,"b"),o._uU(120,"Funci\xf3n de utilidad / puntuaci\xf3n:"),o.qZA(),o._uU(121," asignar valor num\xe9rico a cada opci\xf3n y elegir la de mayor puntaje."),o.qZA(),o.TgZ(122,"li")(123,"b"),o._uU(124,"Reglas heur\xedsticas:"),o.qZA(),o._uU(125," atajos para decidir r\xe1pido (p. ej. \u201csi tengo menos de 5 minutos, elijo la opci\xf3n r\xe1pida\u201d)."),o.qZA(),o.TgZ(126,"li")(127,"b"),o._uU(128,"B\xfasqueda y optimizaci\xf3n:"),o.qZA(),o._uU(129," cuando hay muchas opciones, aplicar estrategias (greedy, b\xfasqueda por puntaje, backtracking)."),o.qZA()()(),o.TgZ(130,"div",16)(131,"h2",29),o._uU(132,"\u{1f9fe} Herramientas pr\xe1cticas para evaluar opciones"),o.qZA(),o.TgZ(133,"h3",30),o._uU(134,"1) Matriz de decisi\xf3n ponderada"),o.qZA(),o.TgZ(135,"ol",31)(136,"li"),o._uU(137,"Listar criterios relevantes."),o.qZA(),o.TgZ(138,"li"),o._uU(139,"Asignar peso a cada criterio (suma 1 o 100)."),o.qZA(),o.TgZ(140,"li"),o._uU(141,"Puntuar cada opci\xf3n por criterio (0\u20135)."),o.qZA(),o.TgZ(142,"li"),o._uU(143,"Multiplicar y sumar para obtener la puntuaci\xf3n total."),o.qZA()(),o.TgZ(144,"div",32)(145,"table",33)(146,"thead")(147,"tr",34)(148,"th",35),o._uU(149,"Opci\xf3n"),o.qZA(),o.TgZ(150,"th",36),o._uU(151,"Rapidez (0.4)"),o.qZA(),o.TgZ(152,"th",36),o._uU(153,"Costo (0.3)"),o.qZA(),o.TgZ(154,"th",36),o._uU(155,"Facilidad (0.3)"),o.qZA(),o.TgZ(156,"th",37),o._uU(157,"Score total"),o.qZA()()(),o.TgZ(158,"tbody")(159,"tr",38)(160,"td",39),o._uU(161,"Opci\xf3n A"),o.qZA(),o.TgZ(162,"td",39),o._uU(163,"4 \u2192 1.6"),o.qZA(),o.TgZ(164,"td",39),o._uU(165,"3 \u2192 0.9"),o.qZA(),o.TgZ(166,"td",39),o._uU(167,"5 \u2192 1.5"),o.qZA(),o.TgZ(168,"td",39),o._uU(169,"4.0"),o.qZA()(),o.TgZ(170,"tr",40)(171,"td",39),o._uU(172,"Opci\xf3n B"),o.qZA(),o.TgZ(173,"td",39),o._uU(174,"3 \u2192 1.2"),o.qZA(),o.TgZ(175,"td",39),o._uU(176,"5 \u2192 1.5"),o.qZA(),o.TgZ(177,"td",39),o._uU(178,"2 \u2192 0.6"),o.qZA(),o.TgZ(179,"td",39),o._uU(180,"3.3"),o.qZA()()()()(),o.TgZ(181,"h3",30),o._uU(182,"2) Pros / Cons"),o.qZA(),o.TgZ(183,"p",26),o._uU(184,"Lista simple de ventajas y desventajas; \xfatil para decisiones con pocos criterios."),o.qZA(),o.TgZ(185,"h3",30),o._uU(186,"3) \xc1rbol de decisi\xf3n b\xe1sico"),o.qZA(),o.TgZ(187,"p",26),o._uU(188,"Dibuja nodos: en cada nodo una condici\xf3n; en hojas la consecuencia o recompensa. Muy \xfatil para decisiones secuenciales."),o.qZA(),o.TgZ(189,"h3",30),o._uU(190,"4) Sensitivity / An\xe1lisis de sensibilidad"),o.qZA(),o.TgZ(191,"p",26),o._uU(192,"Modificar pesos o supuestos para ver si la decisi\xf3n se mantiene estable."),o.qZA()(),o.TgZ(193,"div",22)(194,"h2",23),o._uU(195,"\u26a0\ufe0f Sesgos y errores comunes"),o.qZA(),o.TgZ(196,"ul",21)(197,"li")(198,"b"),o._uU(199,"Anclaje:"),o.qZA(),o._uU(200," fijarse en la primera informaci\xf3n recibida."),o.qZA(),o.TgZ(201,"li")(202,"b"),o._uU(203,"Confirmaci\xf3n:"),o.qZA(),o._uU(204," buscar solo datos que confirmen nuestra idea."),o.qZA(),o.TgZ(205,"li")(206,"b"),o._uU(207,"Disponibilidad:"),o.qZA(),o._uU(208," sobrevalorar ejemplos recientes o memorables."),o.qZA(),o.TgZ(209,"li")(210,"b"),o._uU(211,"Exceso de confianza:"),o.qZA(),o._uU(212," subestimar la incertidumbre."),o.qZA()(),o.TgZ(213,"p",26),o._uU(214,"Ense\xf1ar a preguntar: \u201c\xbfQu\xe9 supongo?\u201d y \u201c\xbfQu\xe9 pasa si esa suposici\xf3n falla?\u201d ayuda a mitigarlos."),o.qZA()(),o.TgZ(215,"div",24)(216,"h2",25),o._uU(217,"\u{1f5a5} C\xf3mo mapear todo esto en programaci\xf3n"),o.qZA(),o.TgZ(218,"ul",21)(219,"li")(220,"b"),o._uU(221,"Condicionales ("),o.TgZ(222,"code"),o._uU(223,"if/else"),o.qZA(),o._uU(224,"):"),o.qZA(),o._uU(225," decisiones simples."),o.qZA(),o.TgZ(226,"li")(227,"b"),o._uU(228,"Switch / case:"),o.qZA(),o._uU(229," elegir entre varias alternativas discretas."),o.qZA(),o.TgZ(230,"li")(231,"b"),o._uU(232,"Funciones que devuelven puntajes:"),o.qZA(),o._uU(233," implementar matriz ponderada ("),o.TgZ(234,"code"),o._uU(235,"score(option)"),o.qZA(),o._uU(236,")."),o.qZA(),o.TgZ(237,"li")(238,"b"),o._uU(239,"Estructuras de datos (arrays / objetos):"),o.qZA(),o._uU(240," almacenar opciones, criterios y resultados."),o.qZA(),o.TgZ(241,"li")(242,"b"),o._uU(243,"\xc1rboles (estructuras recursivas):"),o.qZA(),o._uU(244," modelar decisiones secuenciales."),o.qZA(),o.TgZ(245,"li")(246,"b"),o._uU(247,"Simulaci\xf3n / Monte Carlo:"),o.qZA(),o._uU(248," cuando hay incertidumbre usar simulaciones para estimar probabilidades. "),o.qZA()(),o.TgZ(249,"h3",41),o._uU(250,"Pseudoc\xf3digo ejemplo (score):"),o.qZA(),o.TgZ(251,"pre",42)(252,"code"),o._uU(253),o.qZA()()()()()),2&h&&(o.xp6(253),o.AsE("// criterios = ","{"," rapidez:0.4, costo:0.3, facilidad:0.3 ","}","\n// opciones = [A,B,C]\nfor opcion in opciones:\n    score = 0\n    for criterio in criterios:\n        score += puntaje(opcion, criterio) * criterios[criterio]\n    escoger opcion con max(score)\n"))}function vo(h,w){1&h&&(o.TgZ(0,"section",12)(1,"h1",43),o._uU(2,"Ejemplos"),o.qZA()())}function it(h,w){1&h&&(o.TgZ(0,"section",12)(1,"h1",43),o._uU(2,"Ejercicios"),o.qZA()())}const wt=function(h){return{"button-with-point":h}};let yo=(()=>{class h{constructor(){this.selectedSection=1}static{this.\u0275fac=function(p){return new(p||h)}}static{this.\u0275cmp=o.Xpm({type:h,selectors:[["app-toma-decisiones"]],decls:23,vars:24,consts:[[1,"text-center","mb-6","mt-6"],[1,"text-3xl","font-bold","text-gray-800","mb-2","drop-shadow-md"],[1,"flex","items-center","justify-center","mb-1"],[1,"h-0.5","bg-gradient-to-r","from-transparent","via-blue-500","to-transparent","w-96","shadow-sm"],[1,"flex","items-center","justify-center"],[1,"h-px","bg-gradient-to-r","from-transparent","via-gray-300","to-transparent","w-64","opacity-60"],[1,"flex","flex-col","items-center","mb-6"],[1,"sticky","top-0","z-20","w-auto","flex","justify-center","bg-transparent","backdrop-blur-md","py-2","rounded-xl"],[1,"flex","gap-72"],[1,"relative","px-4","py-2","rounded-lg","font-semibold","text-gray-700","hover:text-blue-500","transition",3,"ngClass","click"],[1,"flex","flex-col","gap-6","items-center","w-full","px-2","md:px-0"],["class","bg-gray-500/20 backdrop-blur-md p-8 rounded-lg border border-gray-400/30 shadow-lg w-full max-w-7xl mt-2 mb-8",4,"ngIf"],[1,"bg-gray-500/20","backdrop-blur-md","p-8","rounded-lg","border","border-gray-400/30","shadow-lg","w-full","max-w-7xl","mt-2","mb-8"],[1,"flex","flex-col","gap-6","mb-8","justify-start","items-start"],[1,"text-xl","font-bold","text-blue-500","mb-2","flex","items-center","gap-2"],[1,"text-gray-800","ml-8"],[1,"bg-gradient-to-br","from-blue-100","via-blue-50","to-white","border-l-4","border-blue-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"text-lg","font-semibold","text-gray-700","mt-4","mb-2","flex","items-center","gap-2"],[1,"list-disc","pl-6","text-gray-700","mb-2"],[1,"bg-gradient-to-br","from-green-100","via-green-50","to-white","border-l-4","border-green-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"text-xl","font-bold","text-green-600","mb-2","flex","items-center","gap-2"],[1,"list-disc","ml-6","text-gray-800","mb-2"],[1,"bg-gradient-to-br","from-yellow-100","via-yellow-50","to-white","border-l-4","border-yellow-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"text-xl","font-bold","text-yellow-600","mb-2","flex","items-center","gap-2"],[1,"bg-gradient-to-br","from-purple-100","via-purple-50","to-white","border-l-4","border-purple-400","shadow-lg","rounded-xl","p-6","w-full","mt-2","mb-2"],[1,"text-xl","font-bold","text-purple-600","mb-2","flex","items-center","gap-2"],[1,"text-gray-700"],[1,"bg-gradient-to-br","from-pink-100","via-pink-50","to-white","border-l-4","border-pink-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"text-xl","font-bold","text-pink-600","mb-2","flex","items-center","gap-2"],[1,"text-xl","font-bold","text-blue-600","mb-2","flex","items-center","gap-2"],[1,"font-semibold","text-blue-700"],[1,"list-decimal","ml-8","text-gray-700","mb-2"],[1,"overflow-x-auto","mb-4"],[1,"min-w-full","text-sm","text-left","border-separate","border-spacing-0","rounded-xl","shadow-lg","bg-white"],[1,"bg-gradient-to-r","from-blue-500","via-cyan-400","to-green-300"],[1,"py-3","px-6","font-bold","text-white","rounded-tl-xl","text-center"],[1,"py-3","px-6","font-bold","text-white","text-center"],[1,"py-3","px-6","font-bold","text-white","rounded-tr-xl","text-center"],[1,"hover:bg-red-50","transition"],[1,"py-3","px-6","border-b","border-gray-200"],[1,"hover:bg-blue-50","transition"],[1,"font-semibold","text-purple-700"],[1,"bg-gray-900","text-green-200","rounded-lg","p-4","text-sm","overflow-x-auto"],[1,"mt-6"]],template:function(p,a){1&p&&(o.TgZ(0,"div",0)(1,"h1",1),o._uU(2,"\u{1f5c2}\ufe0f Toma de Decisiones y Evaluaci\xf3n de Opciones"),o.qZA(),o.TgZ(3,"div",2),o._UZ(4,"div",3),o.qZA(),o.TgZ(5,"div",4),o._UZ(6,"div",5),o.qZA()(),o.TgZ(7,"div",6)(8,"nav",7)(9,"ul",8)(10,"li")(11,"button",9),o.NdJ("click",function(){return a.selectedSection=1}),o._uU(12," Teor\xeda "),o.qZA()(),o.TgZ(13,"li")(14,"button",9),o.NdJ("click",function(){return a.selectedSection=2}),o._uU(15," Ejemplos "),o.qZA()(),o.TgZ(16,"li")(17,"button",9),o.NdJ("click",function(){return a.selectedSection=3}),o._uU(18," Ejercicios "),o.qZA()()()()(),o.TgZ(19,"div",10),o.YNc(20,J,254,2,"section",11),o.YNc(21,vo,3,0,"section",11),o.YNc(22,it,3,0,"section",11),o.qZA()),2&p&&(o.xp6(11),o.ekj("border-b-4",1===a.selectedSection)("border-blue-500",1===a.selectedSection),o.Q6J("ngClass",o.VKq(18,wt,1===a.selectedSection)),o.xp6(3),o.ekj("border-b-4",2===a.selectedSection)("border-blue-500",2===a.selectedSection),o.Q6J("ngClass",o.VKq(20,wt,2===a.selectedSection)),o.xp6(3),o.ekj("border-b-4",3===a.selectedSection)("border-blue-500",3===a.selectedSection),o.Q6J("ngClass",o.VKq(22,wt,3===a.selectedSection)),o.xp6(3),o.Q6J("ngIf",1===a.selectedSection),o.xp6(1),o.Q6J("ngIf",2===a.selectedSection),o.xp6(1),o.Q6J("ngIf",3===a.selectedSection))},dependencies:[V.mk,V.O5]})}}return h})();var Ee=ce(9862);function ve(h,w){1&h&&(o.TgZ(0,"div",6),o._uU(1,"Cargando ejemplos..."),o.qZA())}function ao(h,w){if(1&h&&(o.TgZ(0,"div",7),o._uU(1),o.qZA()),2&h){const r=o.oxw(2);o.xp6(1),o.Oqu(r.error)}}function ei(h,w){if(1&h){const r=o.EpF();o.TgZ(0,"div",10)(1,"div",11)(2,"div",12)(3,"span",13),o._uU(4),o.qZA(),o.TgZ(5,"span",14),o._uU(6),o.qZA()(),o.TgZ(7,"div",15)(8,"p",16),o._uU(9),o.qZA()()(),o.TgZ(10,"div",17)(11,"div",18),o._uU(12,"Puntuaci\xf3n: "),o.TgZ(13,"span",19),o._uU(14),o.qZA()(),o.TgZ(15,"button",20),o.NdJ("click",function(){const _=o.CHM(r).$implicit,S=o.oxw(3);return o.KtG(S.seleccionarEjemplo(_))}),o._uU(16,"Intentar ejemplo"),o.qZA()()()}if(2&h){const r=w.$implicit,p=o.oxw(3);o.xp6(4),o.Oqu(p.getEmojiEjemplo(r.titulo)),o.xp6(2),o.Oqu(r.titulo),o.xp6(3),o.hij("",r.enunciado," "),o.xp6(5),o.Oqu(p.puntuacionesEjemplos[r.id]||0)}}function Pt(h,w){if(1&h&&(o.TgZ(0,"div",8),o.YNc(1,ei,17,4,"div",9),o.qZA()),2&h){const r=o.oxw(2);o.xp6(1),o.Q6J("ngForOf",r.ejemplos)}}function Ki(h,w){if(1&h&&(o.TgZ(0,"div",44),o._uU(1),o.qZA()),2&h){const r=o.oxw().$implicit,p=o.oxw(4);o.Q6J("id","tooltip-"+r),o.xp6(1),o.hij(" ",null==p.ejemploSeleccionado.preguntas[p.preguntaActualEjemplo].consecuencias[r]?null:p.ejemploSeleccionado.preguntas[p.preguntaActualEjemplo].consecuencias[r].feedback," ")}}const Bt=function(h,w){return{"col-span-2 justify-self-center":h,"col-span-1":w}};function Ji(h,w){if(1&h){const r=o.EpF();o.ynx(0),o.TgZ(1,"div",41)(2,"button",42),o.NdJ("click",function(){const _=o.CHM(r).$implicit,S=o.oxw(4);return o.KtG(S.responderEjemplo(_))}),o._uU(3),o.qZA(),o.YNc(4,Ki,2,2,"div",43),o.qZA(),o.BQk()}if(2&h){const r=w.$implicit,p=w.index,a=o.oxw(4);o.xp6(1),o.Q6J("ngClass",o.WLB(4,Bt,a.ejemploSeleccionado.preguntas[a.preguntaActualEjemplo].elecciones.length%2==1&&p===a.ejemploSeleccionado.preguntas[a.preguntaActualEjemplo].elecciones.length-1,!(a.ejemploSeleccionado.preguntas[a.preguntaActualEjemplo].elecciones.length%2==1&&p===a.ejemploSeleccionado.preguntas[a.preguntaActualEjemplo].elecciones.length-1))),o.xp6(1),o.uIk("aria-describedby","tooltip-"+r),o.xp6(1),o.hij(" ",r," "),o.xp6(1),o.Q6J("ngIf",null==a.ejemploSeleccionado.preguntas[a.preguntaActualEjemplo].consecuencias[r]?null:a.ejemploSeleccionado.preguntas[a.preguntaActualEjemplo].consecuencias[r].feedback)}}function en(h,w){if(1&h&&(o.TgZ(0,"div",36)(1,"h3",37)(2,"span",13),o._uU(3,"\u2753"),o.qZA(),o._uU(4),o.qZA(),o.TgZ(5,"div",38)(6,"div",39),o.YNc(7,Ji,5,7,"ng-container",40),o.qZA()()()),2&h){const r=o.oxw(3);o.xp6(4),o.hij(" ",r.ejemploSeleccionado.preguntas[r.preguntaActualEjemplo].pregunta," "),o.xp6(3),o.Q6J("ngForOf",r.ejemploSeleccionado.preguntas[r.preguntaActualEjemplo].elecciones)}}function tn(h,w){if(1&h&&(o.TgZ(0,"div",21)(1,"div",22),o._UZ(2,"div",23)(3,"div",24),o.qZA(),o.TgZ(4,"div",25)(5,"div",26)(6,"span",27),o._uU(7),o.qZA(),o.TgZ(8,"span",28),o._uU(9),o.qZA()(),o.TgZ(10,"p",29),o._uU(11),o.qZA()(),o.YNc(12,en,8,2,"div",30),o.TgZ(13,"div",31)(14,"div",32),o._uU(15,"Pregunta "),o.TgZ(16,"span",33),o._uU(17),o.qZA(),o._uU(18," / "),o.TgZ(19,"span",33),o._uU(20),o.qZA()(),o.TgZ(21,"div",34)(22,"span",35),o._uU(23,"\u2b50"),o.qZA(),o._uU(24),o.qZA()()()),2&h){const r=o.oxw(2);o.xp6(7),o.hij("",r.getEmojiEjemplo(r.ejemploSeleccionado.titulo),"\u200d"),o.xp6(2),o.Oqu(r.ejemploSeleccionado.titulo),o.xp6(2),o.hij("",r.ejemploSeleccionado.enunciado," "),o.xp6(1),o.Q6J("ngIf",r.preguntaActualEjemplo<r.ejemploSeleccionado.preguntas.length),o.xp6(5),o.Oqu(r.preguntaActualEjemplo+1),o.xp6(3),o.Oqu(r.ejemploSeleccionado.preguntas.length),o.xp6(4),o.hij(" ",r.puntuacionEjemplo," ")}}function on(h,w){if(1&h){const r=o.EpF();o.TgZ(0,"div",45)(1,"div",46)(2,"div",47)(3,"span",27),o._uU(4,"\u{1f3c6}"),o.qZA(),o.TgZ(5,"span",48),o._uU(6,"\xa1Ejemplo completado!"),o.qZA()(),o.TgZ(7,"p",49),o._uU(8),o.qZA(),o.TgZ(9,"button",50),o.NdJ("click",function(){o.CHM(r);const a=o.oxw(2);return o.KtG(a.reiniciarEjemplo())}),o._uU(10,"Volver al selector de ejemplos"),o.qZA()()()}if(2&h){const r=o.oxw(2);o.xp6(8),o.Oqu(r.resultadoEjemplo)}}function ti(h,w){if(1&h&&(o.TgZ(0,"div"),o.YNc(1,ve,2,0,"div",1),o.YNc(2,ao,2,1,"div",2),o.YNc(3,Pt,2,1,"div",3),o.YNc(4,tn,25,7,"div",4),o.YNc(5,on,11,1,"div",5),o.qZA()),2&h){const r=o.oxw();o.xp6(1),o.Q6J("ngIf",r.loading),o.xp6(1),o.Q6J("ngIf",r.error),o.xp6(1),o.Q6J("ngIf",!r.ejemploSeleccionado&&!r.loading&&!r.error),o.xp6(1),o.Q6J("ngIf",r.ejemploSeleccionado&&!r.finalizadoEjemplo),o.xp6(1),o.Q6J("ngIf",r.finalizadoEjemplo)}}function Qi(h,w){1&h&&(o.TgZ(0,"div",6),o._uU(1,"Cargando ejercicios..."),o.qZA())}function oi(h,w){if(1&h&&(o.TgZ(0,"div",7),o._uU(1),o.qZA()),2&h){const r=o.oxw(2);o.xp6(1),o.Oqu(r.error)}}function sn(h,w){if(1&h){const r=o.EpF();o.TgZ(0,"div",52)(1,"div",11)(2,"div",12)(3,"span",13),o._uU(4),o.qZA(),o.TgZ(5,"span",14),o._uU(6),o.qZA()(),o.TgZ(7,"div",53)(8,"p",16),o._uU(9),o.qZA()()(),o.TgZ(10,"div",17)(11,"div",18),o._uU(12,"Puntuaci\xf3n: "),o.TgZ(13,"span",54),o._uU(14),o.qZA()(),o.TgZ(15,"button",55),o.NdJ("click",function(){const _=o.CHM(r).$implicit,S=o.oxw(3);return o.KtG(S.seleccionarEjercicio(_))}),o._uU(16,"Intent\xe9moslo"),o.qZA()()()}if(2&h){const r=w.$implicit,p=o.oxw(3);o.xp6(4),o.Oqu(p.getEmoji(r.titulo)),o.xp6(2),o.Oqu(r.titulo),o.xp6(3),o.hij("",r.enunciado," "),o.xp6(5),o.Oqu(p.puntuacionesEjercicios[r.id]||0)}}function nn(h,w){if(1&h&&(o.TgZ(0,"div",8),o.YNc(1,sn,17,4,"div",51),o.qZA()),2&h){const r=o.oxw(2);o.xp6(1),o.Q6J("ngForOf",r.ejercicios)}}function rn(h,w){if(1&h){const r=o.EpF();o.TgZ(0,"button",63),o.NdJ("click",function(){const _=o.CHM(r).$implicit,S=o.oxw(4);return o.KtG(S.responder(_))}),o._uU(1),o.qZA()}if(2&h){const r=w.$implicit;o.xp6(1),o.hij(" ",r," ")}}function Co(h,w){if(1&h&&(o.TgZ(0,"div",60)(1,"h3",61)(2,"span",13),o._uU(3,"\u2753"),o.qZA(),o._uU(4),o.qZA(),o.TgZ(5,"div",38),o.YNc(6,rn,2,1,"button",62),o.qZA()()),2&h){const r=o.oxw(3);o.xp6(4),o.hij(" ",r.ejercicioSeleccionado.preguntas[r.preguntaActual].pregunta," "),o.xp6(2),o.Q6J("ngForOf",r.ejercicioSeleccionado.preguntas[r.preguntaActual].elecciones)}}function ii(h,w){if(1&h&&(o.TgZ(0,"div",21)(1,"div",22),o._UZ(2,"div",23)(3,"div",24),o.qZA(),o.TgZ(4,"div",25)(5,"div",26)(6,"span",27),o._uU(7),o.qZA(),o.TgZ(8,"span",56),o._uU(9),o.qZA()(),o.TgZ(10,"p",29),o._uU(11),o.qZA()(),o.YNc(12,Co,7,2,"div",57),o.TgZ(13,"div",58)(14,"div",32),o._uU(15,"Pregunta "),o.TgZ(16,"span",33),o._uU(17),o.qZA(),o._uU(18," / "),o.TgZ(19,"span",33),o._uU(20),o.qZA()(),o.TgZ(21,"div",59)(22,"span",35),o._uU(23,"\u2b50"),o.qZA(),o._uU(24),o.qZA()()()),2&h){const r=o.oxw(2);o.xp6(7),o.Oqu(r.getEmoji(r.ejercicioSeleccionado.titulo)),o.xp6(2),o.Oqu(r.ejercicioSeleccionado.titulo),o.xp6(2),o.hij("",r.ejercicioSeleccionado.enunciado," "),o.xp6(1),o.Q6J("ngIf",r.preguntaActual<r.ejercicioSeleccionado.preguntas.length),o.xp6(5),o.Oqu(r.preguntaActual+1),o.xp6(3),o.Oqu(r.ejercicioSeleccionado.preguntas.length),o.xp6(4),o.hij(" ",r.puntuacion," ")}}function ln(h,w){if(1&h){const r=o.EpF();o.TgZ(0,"div",45)(1,"div",64)(2,"div",47)(3,"span",27),o._uU(4,"\u{1f3c6}"),o.qZA(),o.TgZ(5,"span",65),o._uU(6,"\xa1Ejercicio completado!"),o.qZA()(),o.TgZ(7,"p",49),o._uU(8),o.qZA(),o.TgZ(9,"button",66),o.NdJ("click",function(){o.CHM(r);const a=o.oxw(2);return o.KtG(a.reiniciar())}),o._uU(10,"Volver al selector de ejercicios"),o.qZA()()()}if(2&h){const r=o.oxw(2);o.xp6(8),o.Oqu(r.resultado)}}function cn(h,w){if(1&h&&(o.TgZ(0,"div"),o.YNc(1,Qi,2,0,"div",1),o.YNc(2,oi,2,1,"div",2),o.YNc(3,nn,2,1,"div",3),o.YNc(4,ii,25,7,"div",4),o.YNc(5,ln,11,1,"div",5),o.qZA()),2&h){const r=o.oxw();o.xp6(1),o.Q6J("ngIf",r.loading),o.xp6(1),o.Q6J("ngIf",r.error),o.xp6(1),o.Q6J("ngIf",!r.ejercicioSeleccionado&&!r.loading&&!r.error),o.xp6(1),o.Q6J("ngIf",r.ejercicioSeleccionado&&!r.finalizado),o.xp6(1),o.Q6J("ngIf",r.finalizado)}}let an=(()=>{class h{constructor(r){this.http=r,this.puntuacionesEjemplos={},this.tipo=2,this.ejemplos=[],this.ejemploSeleccionado=null,this.preguntaActualEjemplo=0,this.puntuacionEjemplo=0,this.finalizadoEjemplo=!1,this.resultadoEjemplo="",this.feedbackEjemplo="",this.ejercicios=[],this.loading=!0,this.error="",this.ejercicioSeleccionado=null,this.preguntaActual=0,this.puntuacion=0,this.finalizado=!1,this.resultado="",this.puntuacionesEjercicios={},this.cargarEjercicios()}cargarEjercicios(){this.http.get("assets/jsons-base/pensamiento-logico.json").subscribe({next:r=>{this.ejercicios=r.ejercicios,this.ejemplos=r.ejemplos,this.loading=!1},error:()=>{this.error="No se pudo cargar el archivo de ejercicios.",this.loading=!1}})}seleccionarEjercicio(r){this.ejercicioSeleccionado=r,this.preguntaActual=0,this.puntuacion=0,this.finalizado=!1,this.resultado=""}seleccionarEjemplo(r){this.ejemploSeleccionado=r,this.preguntaActualEjemplo=0,this.puntuacionEjemplo=0,this.finalizadoEjemplo=!1,this.resultadoEjemplo="",this.feedbackEjemplo=""}responderEjemplo(r){if(!this.ejemploSeleccionado)return;const p=this.ejemploSeleccionado.preguntas[this.preguntaActualEjemplo],a=p.consecuencias[r];let _=0;p.puntuaciones&&"number"==typeof p.puntuaciones[r]?_=p.puntuaciones[r]:"number"==typeof a?.puntuacion&&(_=a.puntuacion),this.puntuacionEjemplo+=_,this.feedbackEjemplo=a?.feedback||"",a?.final?(this.finalizadoEjemplo=!0,this.resultadoEjemplo="\xa1Ejemplo finalizado! Puntuaci\xf3n: "+this.puntuacionEjemplo,this.ejemploSeleccionado&&(this.puntuacionesEjemplos[this.ejemploSeleccionado.id]=this.puntuacionEjemplo)):(this.preguntaActualEjemplo++,this.preguntaActualEjemplo>=this.ejemploSeleccionado.preguntas.length&&(this.finalizadoEjemplo=!0,this.resultadoEjemplo="\xa1Ejemplo finalizado! Puntuaci\xf3n: "+this.puntuacionEjemplo,this.ejemploSeleccionado&&(this.puntuacionesEjemplos[this.ejemploSeleccionado.id]=this.puntuacionEjemplo)))}reiniciarEjemplo(){this.ejemploSeleccionado=null,this.preguntaActualEjemplo=0,this.puntuacionEjemplo=0,this.finalizadoEjemplo=!1,this.resultadoEjemplo="",this.feedbackEjemplo=""}responder(r){if(!this.ejercicioSeleccionado)return;const p=this.ejercicioSeleccionado.preguntas[this.preguntaActual],a=p.consecuencias[r];let _=0;p.puntuaciones&&"number"==typeof p.puntuaciones[r]?_=p.puntuaciones[r]:"number"==typeof a?.puntuacion&&(_=a.puntuacion),this.puntuacion+=_,a?.final?(this.finalizado=!0,this.resultado="\xa1Ejercicio finalizado! Puntuaci\xf3n: "+this.puntuacion,this.ejercicioSeleccionado&&(this.puntuacionesEjercicios[this.ejercicioSeleccionado.id]=this.puntuacion)):(this.preguntaActual++,this.preguntaActual>=this.ejercicioSeleccionado.preguntas.length&&(this.finalizado=!0,this.resultado="\xa1Ejercicio finalizado! Puntuaci\xf3n: "+this.puntuacion,this.ejercicioSeleccionado&&(this.puntuacionesEjercicios[this.ejercicioSeleccionado.id]=this.puntuacion)))}reiniciar(){this.ejercicioSeleccionado=null,this.preguntaActual=0,this.puntuacion=0,this.finalizado=!1,this.resultado=""}getEmoji(r){return r.toLowerCase().includes("clima")?"\u{1f326}\ufe0f":r.toLowerCase().includes("desayuno")?"\u{1f373}":r.toLowerCase().includes("sem\xe1foro")?"\u{1f6a6}":r.toLowerCase().includes("detective")?"\u{1f575}\ufe0f":r.toLowerCase().includes("caf\xe9")?"\u2615":r.toLowerCase().includes("robot")?"\u{1f916}":r.toLowerCase().includes("guardarropa")?"\u{1f454}":"\u{1f9e9}"}getEmojiEjemplo(r){return r.toLowerCase().includes("chef")?"\u{1f373}":r.toLowerCase().includes("ingredientes")?"\u{1f957}":r.toLowerCase().includes("enfermera")?"\u{1f489}":r.toLowerCase().includes("pacientes")?"\u{1f3e5}":r.toLowerCase().includes("tienda")?"\u{1f3ea}":r.toLowerCase().includes("estilista")?"\u{1f487}\u200d\u2642\ufe0f":r.toLowerCase().includes("clientas")?"\u{1f481}":r.toLowerCase().includes("organizador")?"\u{1f389}":r.toLowerCase().includes("fiestas")?"\u{1f38a}":r.toLowerCase().includes("entrenador")?"\u{1f3cb}\ufe0f":r.toLowerCase().includes("deportivo")?"\u26bd":r.toLowerCase().includes("t\xe9cnico")?"\u{1f527}":r.toLowerCase().includes("computadoras")?"\u{1f4bb}":"\u{1f9e9}"}static{this.\u0275fac=function(p){return new(p||h)(o.Y36(Ee.eN))}}static{this.\u0275cmp=o.Xpm({type:h,selectors:[["app-game-question-selection"]],inputs:{tipo:"tipo"},decls:2,vars:2,consts:[[4,"ngIf"],["class","text-center py-8",4,"ngIf"],["class","text-red-500 text-center py-8",4,"ngIf"],["class","grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",4,"ngIf"],["class","game-section w-full max-w-2xl mx-auto flex flex-col items-center justify-center relative gap-6",4,"ngIf"],["class","w-full max-w-2xl mx-auto flex flex-col items-center justify-center relative gap-6",4,"ngIf"],[1,"text-center","py-8"],[1,"text-red-500","text-center","py-8"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-6"],["class","card-ejemplo bg-gradient-to-br from-white via-blue-100 to-purple-100 rounded-3xl shadow-xl border border-blue-200 flex flex-col justify-between items-stretch px-6 pt-6 pb-4 h-[22.61180115rem] w-full max-w-md mx-auto transition-all duration-200 hover:scale-105",4,"ngFor","ngForOf"],[1,"card-ejemplo","bg-gradient-to-br","from-white","via-blue-100","to-purple-100","rounded-3xl","shadow-xl","border","border-blue-200","flex","flex-col","justify-between","items-stretch","px-6","pt-6","pb-4","h-[22.61180115rem]","w-full","max-w-md","mx-auto","transition-all","duration-200","hover:scale-105"],[1,"flex","flex-col","gap-2","flex-grow"],[1,"flex","items-center","mb-4","gap-2"],[1,"emoji-card","text-2xl"],[1,"text-lg","font-bold","text-gray-800","truncate"],[1,"bg-gradient-to-br","from-blue-50","via-purple-50","to-white","border-l-4","border-blue-300","shadow","rounded-xl","px-2","py-3","w-full","mb-2","overflow-auto"],[1,"text-gray-700","text-sm",2,"text-align","justify","white-space","pre-line"],[1,"flex","flex-col","items-center","mt-auto"],[1,"text-xs","text-gray-600","mb-2"],[1,"font-bold","text-blue-700"],[1,"btn-ejemplo","w-full","bg-gradient-to-r","from-blue-400","to-purple-400","text-white","font-semibold","py-2","px-4","rounded-lg","shadow","hover:from-blue-500","hover:to-purple-500","transition",3,"click"],[1,"game-section","w-full","max-w-2xl","mx-auto","flex","flex-col","items-center","justify-center","relative","gap-6"],[1,"absolute","top-0","left-0","w-full","h-full","pointer-events-none","z-0"],[1,"game-bg-gradient"],[1,"game-bg-stars"],[1,"game-card","relative","z-10","animate-pop","shadow-2xl","rounded-3xl","px-8","pt-8","pb-6","flex","flex-col","items-center","w-full",2,"background","linear-gradient(135deg, #fef9c3 0%, #e0e7ff 100%)"],[1,"flex","items-center","gap-2","mb-2"],[1,"emoji-card","text-4xl"],[1,"text-2xl","font-extrabold","text-pink-700","drop-shadow"],[1,"mb-2","text-gray-800","text-justify","text-lg","font-medium","w-full","max-w-xl"],["class","game-question-card bg-white/80 rounded-xl p-6 shadow-lg border-2 border-pink-300 animate-fade-in w-full",4,"ngIf"],[1,"game-status-card","bg-white/80","rounded-xl","px-6","py-4","shadow-lg","border-2","border-pink-300","flex","justify-between","items-center","w-full","max-w-md","animate-fade-in"],[1,"text-sm","text-pink-600","font-bold"],[1,"text-base"],[1,"text-pink-600","font-extrabold","text-lg","flex","items-center","gap-1"],[1,"emoji-card","text-xl"],[1,"game-question-card","bg-white/80","rounded-xl","p-6","shadow-lg","border-2","border-pink-300","animate-fade-in","w-full"],[1,"font-bold","text-pink-700","text-xl","mb-4","flex","items-center","gap-2"],[1,"flex","flex-wrap","gap-4","justify-center"],[1,"grid","grid-cols-2","gap-4","w-full"],[4,"ngFor","ngForOf"],[1,"relative","group","flex","justify-center",3,"ngClass"],[1,"game-btn-choice","w-full","break-words","whitespace-pre-line","px-6","py-3","rounded-full","font-bold","text-lg","shadow-lg","transition","transform","hover:scale-110","hover:bg-gradient-to-r","hover:from-pink-400","hover:to-yellow-400","bg-gradient-to-r","from-pink-400","to-purple-400","text-white","border-2","border-white",3,"click"],["class","absolute left-1/2 -translate-x-1/2 top-full mt-2 z-20 px-3 py-2 rounded-lg bg-pink-700 text-white text-sm font-medium shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-pre-line min-w-[10rem] max-w-[19rem]",3,"id",4,"ngIf"],[1,"absolute","left-1/2","-translate-x-1/2","top-full","mt-2","z-20","px-3","py-2","rounded-lg","bg-pink-700","text-white","text-sm","font-medium","shadow-lg","opacity-0","group-hover:opacity-100","transition-opacity","duration-200","pointer-events-none","whitespace-pre-line","min-w-[10rem]","max-w-[19rem]",3,"id"],[1,"w-full","max-w-2xl","mx-auto","flex","flex-col","items-center","justify-center","relative","gap-6"],[1,"relative","z-10","animate-pop","shadow-2xl","rounded-3xl","px-8","pt-8","pb-6","flex","flex-col","items-center","w-full","mb-4",2,"background","linear-gradient(135deg, #b6c7ff 0%, #f3f4f6 100%)"],[1,"flex","items-center","gap-2","mb-4"],[1,"text-2xl","font-extrabold","text-blue-700","drop-shadow"],[1,"mb-4","text-gray-800","text-lg","font-medium","w-full","max-w-xl","text-center"],[1,"bg-gradient-to-r","from-blue-200","to-purple-200","hover:from-blue-300","hover:to-purple-300","text-gray-800","font-semibold","py-3","px-8","rounded-full","shadow-xl","transition","transform","hover:scale-105","mt-2",3,"click"],["class","card-ejercicio bg-gradient-to-br from-white via-blue-100 to-green-200 rounded-2xl shadow-xl border border-green-300 flex flex-col justify-between items-stretch px-5 pt-7 pb-5 h-[26.5335rem] w-full max-w-md mx-auto transition-all duration-200 hover:scale-105",4,"ngFor","ngForOf"],[1,"card-ejercicio","bg-gradient-to-br","from-white","via-blue-100","to-green-200","rounded-2xl","shadow-xl","border","border-green-300","flex","flex-col","justify-between","items-stretch","px-5","pt-7","pb-5","h-[26.5335rem]","w-full","max-w-md","mx-auto","transition-all","duration-200","hover:scale-105"],[2,"background","linear-gradient(135deg, #b1eef6 0%, #e0e7ff 100%)","border-left","4px solid #38b2ac","box-shadow","0 2px 8px rgba(59,130,246,0.10)","border-radius","1rem","padding","1rem 0.5rem","width","100%","margin-bottom","0.5rem","overflow","auto"],[1,"font-bold","text-yellow-700"],[1,"btn-ejercicio","w-full","bg-gradient-to-r","from-green-500","to-blue-400","text-white","font-semibold","py-2","px-4","rounded-lg","shadow","hover:from-green-600","hover:to-blue-500","transition",3,"click"],[1,"text-2xl","font-extrabold","text-purple-700","drop-shadow"],["class","game-question-card bg-white/80 rounded-xl p-6 shadow-lg border-2 border-yellow-300 animate-fade-in w-full",4,"ngIf"],[1,"game-status-card","bg-white/80","rounded-xl","px-6","py-4","shadow-lg","border-2","border-purple-300","flex","justify-between","items-center","w-full","max-w-md","animate-fade-in"],[1,"text-green-600","font-extrabold","text-lg","flex","items-center","gap-1"],[1,"game-question-card","bg-white/80","rounded-xl","p-6","shadow-lg","border-2","border-yellow-300","animate-fade-in","w-full"],[1,"font-bold","text-blue-700","text-xl","mb-4","flex","items-center","gap-2"],["class","game-btn-choice px-6 py-3 rounded-full font-bold text-lg shadow-lg transition transform hover:scale-110 hover:bg-gradient-to-r hover:from-yellow-400 hover:to-pink-400 bg-gradient-to-r from-blue-400 to-purple-400 text-white border-2 border-white",3,"click",4,"ngFor","ngForOf"],[1,"game-btn-choice","px-6","py-3","rounded-full","font-bold","text-lg","shadow-lg","transition","transform","hover:scale-110","hover:bg-gradient-to-r","hover:from-yellow-400","hover:to-pink-400","bg-gradient-to-r","from-blue-400","to-purple-400","text-white","border-2","border-white",3,"click"],[1,"relative","z-10","animate-pop","shadow-2xl","rounded-3xl","px-8","pt-8","pb-6","flex","flex-col","items-center","w-full","mb-4",2,"background","linear-gradient(135deg, #94efb5 0%, #f3f4f6 100%)"],[1,"text-2xl","font-extrabold","text-green-700","drop-shadow"],[1,"bg-gradient-to-r","from-green-200","to-blue-200","hover:from-green-300","hover:to-blue-300","text-gray-800","font-semibold","py-3","px-8","rounded-full","shadow-xl","transition","transform","hover:scale-105","mt-2",3,"click"]],template:function(p,a){1&p&&(o.YNc(0,ti,6,5,"div",0),o.YNc(1,cn,6,5,"div",0)),2&p&&(o.Q6J("ngIf",1===a.tipo),o.xp6(1),o.Q6J("ngIf",2===a.tipo))},dependencies:[V.mk,V.sg,V.O5],styles:['.game-card[_ngcontent-%COMP%]{box-shadow:0 12px 40px #0000002e;border-radius:2rem;background:linear-gradient(135deg,#fef9c3 0%,#e0e7ff 100%);animation:_ngcontent-%COMP%_pop .5s cubic-bezier(.17,.67,.83,.67);margin-bottom:0;width:100%;max-width:38rem}.game-question-card[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fade-in .6s;margin-bottom:0;width:100%;max-width:38rem}.game-status-card[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fade-in .6s;margin-top:0;width:100%;max-width:24rem;box-shadow:0 4px 16px #a855f71a;border-radius:1.5rem;background:rgba(255,255,255,.85)}.game-section[_ngcontent-%COMP%]{position:relative;min-height:32rem;max-width:70rem;padding-top:2rem;padding-bottom:2rem}.game-bg-gradient[_ngcontent-%COMP%]{position:absolute;inset:0;z-index:0;background:radial-gradient(circle at 60% 40%,#fbbf24 0%,#a5b4fc 60%,#fff 100%);opacity:.5}.game-bg-stars[_ngcontent-%COMP%]{position:absolute;inset:0;z-index:1;pointer-events:none}.game-bg-stars[_ngcontent-%COMP%]:before{content:"\\2728\\2728\\2728\\2728\\2728";position:absolute;top:5%;left:5%;font-size:2rem;opacity:.3}.game-bg-stars[_ngcontent-%COMP%]:after{content:"\\2b50\\fe0f\\2b50\\fe0f\\2b50\\fe0f";position:absolute;bottom:5%;right:5%;font-size:2.5rem;opacity:.2}.game-card[_ngcontent-%COMP%]{box-shadow:0 12px 40px #0000002e;border-radius:2rem;background:linear-gradient(135deg,#fef9c3 0%,#e0e7ff 100%);animation:_ngcontent-%COMP%_pop .5s cubic-bezier(.17,.67,.83,.67)}.game-question-card[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fade-in .6s}.game-btn-choice[_ngcontent-%COMP%]{cursor:pointer;font-size:1.1rem;font-weight:700;border-radius:999px;box-shadow:0 4px 16px #3b82f61a;background:linear-gradient(90deg,#60a5fa 0%,#a78bfa 100%);color:#fff;border:2px solid #fff;transition:background .2s,color .2s,transform .2s}.game-btn-choice[_ngcontent-%COMP%]:hover{background:linear-gradient(90deg,#fbbf24 0%,#f472b6 100%);color:#fff;transform:scale(1.08)}.animate-pop[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pop .5s cubic-bezier(.17,.67,.83,.67)}@keyframes _ngcontent-%COMP%_pop{0%{transform:scale(.8);opacity:0}80%{transform:scale(1.05);opacity:1}to{transform:scale(1);opacity:1}}@keyframes _ngcontent-%COMP%_fade-in{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.emoji-card[_ngcontent-%COMP%]{font-size:1.3rem;margin-right:.5rem;filter:drop-shadow(0 2px 4px rgba(0,0,0,.1))}.card-ejercicio[_ngcontent-%COMP%]   .text-xs[_ngcontent-%COMP%]{margin-bottom:.5rem}.card-ejercicio[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .card-ejercicio[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:.25rem}.card-ejercicio[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:.5rem;overflow:visible;white-space:pre-line;text-align:justify}.ejercicio-container[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .4s}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}']})}}return h})();function es(h,w){1&h&&(o.TgZ(0,"section",12)(1,"div",13)(2,"h2",14),o._uU(3,"\u{1f4cd} \xbfQu\xe9 es el pensamiento l\xf3gico?"),o.qZA(),o.TgZ(4,"p",15),o._uU(5,"El pensamiento l\xf3gico es la habilidad de analizar un problema, dividirlo en partes m\xe1s peque\xf1as y organizarlas para llegar a una soluci\xf3n. En programaci\xf3n, es el proceso mental que usamos para decirle a la computadora qu\xe9 hacer y en qu\xe9 orden hacerlo."),o.qZA(),o.TgZ(6,"div",16)(7,"h3",17),o._uU(8,"\u{1f4e6} Met\xe1fora: El constructor de LEGO"),o.qZA(),o.TgZ(9,"p",18),o._uU(10,"Imagina que quieres construir un castillo con piezas LEGO:"),o.qZA(),o.TgZ(11,"ul",19)(12,"li"),o._uU(13,"Primero revisas las instrucciones (el plan)."),o.qZA(),o.TgZ(14,"li"),o._uU(15,"Luego buscas las piezas necesarias (datos y recursos)."),o.qZA(),o.TgZ(16,"li"),o._uU(17,"Despu\xe9s las unes en el orden correcto (algoritmo)."),o.qZA()(),o.TgZ(18,"p",18),o._uU(19,"Si te saltas un paso o pones una pieza en el lugar equivocado, el castillo no quedar\xe1 como esperas. En programaci\xf3n pasa lo mismo: si no sigues una l\xf3gica clara, el programa no funcionar\xe1 correctamente."),o.qZA()(),o.TgZ(20,"div",20)(21,"h2",21),o._uU(22,"\u{1f504} Pensamiento l\xf3gico y la vida real "),o.qZA(),o.TgZ(23,"ul",22)(24,"li"),o._uU(25,"Si me levanto temprano \u2192 desayuno tranquilo."),o.qZA(),o.TgZ(26,"li"),o._uU(27,"Si no \u2192 desayuno r\xe1pido o no desayuno."),o.qZA(),o.TgZ(28,"li"),o._uU(29,"Si llueve \u2192 llevo paraguas."),o.qZA(),o.TgZ(30,"li"),o._uU(31,"Si no \u2192 salgo sin paraguas."),o.qZA()(),o.TgZ(32,"p",18),o._uU(33,"El pensamiento l\xf3gico es b\xe1sicamente seguir pasos, verificar condiciones y actuar en consecuencia."),o.qZA()(),o.TgZ(34,"div",23)(35,"h2",14),o._uU(36,"\u{1f4dc} Premisas y Conclusiones"),o.qZA(),o.TgZ(37,"h3",24),o._uU(38,"\u{1f9fe} \xbfQu\xe9 es una premisa?"),o.qZA(),o.TgZ(39,"p",18),o._uU(40,"Una premisa es una afirmaci\xf3n o hecho que aceptamos como verdadero y que sirve de base para razonar."),o.qZA(),o.TgZ(41,"p",18),o._uU(42,'Ejemplo: "Si estudio, aprobar\xe9 el examen".'),o._UZ(43,"br"),o._uU(44,"Aqu\xed estamos asumiendo que esta relaci\xf3n es cierta."),o.qZA(),o.TgZ(45,"h3",24),o._uU(46,"\u{1f3c1} \xbfQu\xe9 es una conclusi\xf3n?"),o.qZA(),o.TgZ(47,"p",18),o._uU(48,"Una conclusi\xf3n es el resultado que obtenemos despu\xe9s de analizar una o m\xe1s premisas. "),o.qZA(),o.TgZ(49,"p",18),o._uU(50,"Ejemplo:"),o._UZ(51,"br"),o._uU(52,'Premisa 1: "Si estudio, aprobar\xe9 el examen".'),o._UZ(53,"br"),o._uU(54,'Premisa 2: "Estudi\xe9".'),o._UZ(55,"br"),o._uU(56,'Conclusi\xf3n: "Aprobar\xe9 el examen".'),o.qZA()(),o.TgZ(57,"div",25)(58,"h2",26),o._uU(59,"\u{1f517} C\xf3mo se conectan las premisas y conclusiones"),o.qZA(),o.TgZ(60,"ul",22)(61,"li")(62,"b"),o._uU(63,"SI... ENTONCES (implicaci\xf3n):"),o.qZA(),o._uU(64," Si la condici\xf3n es verdadera, entonces ejecuta una acci\xf3n."),o._UZ(65,"br"),o._uU(66,"Ej: Si llueve, llevo paraguas."),o.qZA(),o.TgZ(67,"li")(68,"b"),o._uU(69,"Y (conjunci\xf3n):"),o.qZA(),o._uU(70," Ambas condiciones deben cumplirse para que algo pase."),o._UZ(71,"br"),o._uU(72,"Ej: Si tengo hambre y hay comida, entonces como."),o.qZA(),o.TgZ(73,"li")(74,"b"),o._uU(75,"O (disyunci\xf3n):"),o.qZA(),o._uU(76," Basta con que una condici\xf3n sea cierta para que algo ocurra."),o._UZ(77,"br"),o._uU(78,"Ej: Si es s\xe1bado o es domingo, descanso."),o.qZA(),o.TgZ(79,"li")(80,"b"),o._uU(81,"NO (negaci\xf3n):"),o.qZA(),o._uU(82," Invierte el valor l\xf3gico de una condici\xf3n."),o._UZ(83,"br"),o._uU(84,"Ej: Si no est\xe1 encendido, enci\xe9ndelo. "),o.qZA()()(),o.TgZ(85,"div",27)(86,"h2",28),o._uU(87,"\u{1f50d} Met\xe1fora: Detectives de la l\xf3gica "),o.qZA(),o.TgZ(88,"ul",22)(89,"li"),o._uU(90,"Las premisas son las pistas que ha encontrado."),o.qZA(),o.TgZ(91,"li"),o._uU(92,"La conclusi\xf3n es el resultado que obtiene al juntar esas pistas."),o.qZA(),o.TgZ(93,"li"),o._uU(94,"Si una pista es falsa, la conclusi\xf3n tambi\xe9n puede fallar."),o.qZA()()(),o.TgZ(95,"div",16)(96,"h2",29),o._uU(97,"\u{1f9e9} Elementos clave del pensamiento l\xf3gico"),o.qZA(),o.TgZ(98,"ul",22)(99,"li")(100,"b"),o._uU(101,"Observaci\xf3n:"),o.qZA(),o._uU(102," entender qu\xe9 est\xe1 pasando o qu\xe9 se necesita."),o.qZA(),o.TgZ(103,"li")(104,"b"),o._uU(105,"An\xe1lisis:"),o.qZA(),o._uU(106," separar el problema en partes peque\xf1as."),o.qZA(),o.TgZ(107,"li")(108,"b"),o._uU(109,"Secuencias:"),o.qZA(),o._uU(110," ordenar las acciones paso a paso."),o.qZA(),o.TgZ(111,"li")(112,"b"),o._uU(113,"Condiciones:"),o.qZA(),o._uU(114," decidir qu\xe9 hacer dependiendo de una situaci\xf3n."),o.qZA(),o.TgZ(115,"li")(116,"b"),o._uU(117,"Repeticiones:"),o.qZA(),o._uU(118," repetir acciones hasta que se cumpla un objetivo."),o.qZA(),o.TgZ(119,"li")(120,"b"),o._uU(121,"Optimizaci\xf3n:"),o.qZA(),o._uU(122," buscar la manera m\xe1s simple y r\xe1pida de resolverlo."),o.qZA()()()()())}function un(h,w){1&h&&(o.TgZ(0,"section",12),o._UZ(1,"app-game-question-selection",30),o.qZA()),2&h&&(o.xp6(1),o.Q6J("tipo",1))}function dn(h,w){1&h&&(o.TgZ(0,"section",12),o._UZ(1,"app-game-question-selection",30),o.qZA()),2&h&&(o.xp6(1),o.Q6J("tipo",2))}const si=function(h){return{"button-with-point":h}};let Se=(()=>{class h{constructor(){this.selectedSection=1}static{this.\u0275fac=function(p){return new(p||h)}}static{this.\u0275cmp=o.Xpm({type:h,selectors:[["app-pensamiento-logico"]],decls:23,vars:24,consts:[[1,"text-center","mb-6","mt-6"],[1,"text-3xl","font-bold","text-gray-800","mb-2","drop-shadow-md"],[1,"flex","items-center","justify-center","mb-1"],[1,"h-0.5","bg-gradient-to-r","from-transparent","via-[#facc15]","to-transparent","w-96","shadow-sm"],[1,"flex","items-center","justify-center"],[1,"h-px","bg-gradient-to-r","from-transparent","via-gray-300","to-transparent","w-64","opacity-60"],[1,"flex","flex-col","items-center","mb-6"],[1,"sticky","top-0","z-20","w-auto","flex","justify-center","bg-transparent","backdrop-blur-md","py-2","rounded-xl"],[1,"flex","gap-72"],[1,"relative","px-4","py-2","rounded-lg","font-semibold","text-gray-700","hover:text-[#facc15]","transition",3,"ngClass","click"],[1,"flex","flex-col","gap-6","items-center","w-full","px-2","md:px-0"],["class","bg-gray-500/20 backdrop-blur-md p-8 rounded-lg border border-gray-400/30 shadow-lg w-full max-w-7xl mt-2 mb-8",4,"ngIf"],[1,"bg-gray-500/20","backdrop-blur-md","p-8","rounded-lg","border","border-gray-400/30","shadow-lg","w-full","max-w-7xl","mt-2","mb-8"],[1,"flex","flex-col","gap-6","mb-8","justify-start","items-start"],[1,"text-xl","font-bold","text-yellow-600","mb-2","flex","items-center","gap-2"],[1,"text-gray-800","ml-8"],[1,"bg-gradient-to-br","from-blue-100","via-blue-50","to-white","border-l-4","border-blue-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"text-lg","font-semibold","text-gray-700","mt-4","mb-2","flex","items-center","gap-2"],[1,"text-gray-700"],[1,"list-disc","pl-6","text-gray-700","mb-2"],[1,"bg-gradient-to-br","from-green-100","via-green-50","to-white","border-l-4","border-green-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"text-xl","font-bold","text-green-600","mb-2","flex","items-center","gap-2"],[1,"list-disc","ml-6","text-gray-800","mb-2"],[1,"bg-gradient-to-br","from-yellow-100","via-yellow-50","to-white","border-l-4","border-yellow-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"font-semibold","text-yellow-700"],[1,"bg-gradient-to-br","from-purple-100","via-purple-50","to-white","border-l-4","border-purple-400","shadow-lg","rounded-xl","p-6","w-full","mt-2","mb-2"],[1,"text-xl","font-bold","text-purple-600","mb-2","flex","items-center","gap-2"],[1,"bg-gradient-to-br","from-pink-100","via-pink-50","to-white","border-l-4","border-pink-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"text-xl","font-bold","text-pink-600","mb-2","flex","items-center","gap-2"],[1,"text-xl","font-bold","text-blue-600","mb-2","flex","items-center","gap-2"],[3,"tipo"]],template:function(p,a){1&p&&(o.TgZ(0,"div",0)(1,"h1",1),o._uU(2,"\u{1f4a1} Pensamiento L\xf3gico en Programaci\xf3n"),o.qZA(),o.TgZ(3,"div",2),o._UZ(4,"div",3),o.qZA(),o.TgZ(5,"div",4),o._UZ(6,"div",5),o.qZA()(),o.TgZ(7,"div",6)(8,"nav",7)(9,"ul",8)(10,"li")(11,"button",9),o.NdJ("click",function(){return a.selectedSection=1}),o._uU(12," Teor\xeda "),o.qZA()(),o.TgZ(13,"li")(14,"button",9),o.NdJ("click",function(){return a.selectedSection=2}),o._uU(15," Ejemplos "),o.qZA()(),o.TgZ(16,"li")(17,"button",9),o.NdJ("click",function(){return a.selectedSection=3}),o._uU(18," Ejercicios "),o.qZA()()()()(),o.TgZ(19,"div",10),o.YNc(20,es,123,0,"section",11),o.YNc(21,un,2,1,"section",11),o.YNc(22,dn,2,1,"section",11),o.qZA()),2&p&&(o.xp6(11),o.ekj("border-b-4",1===a.selectedSection)("border-blue-500",1===a.selectedSection),o.Q6J("ngClass",o.VKq(18,si,1===a.selectedSection)),o.xp6(3),o.ekj("border-b-4",2===a.selectedSection)("border-blue-500",2===a.selectedSection),o.Q6J("ngClass",o.VKq(20,si,2===a.selectedSection)),o.xp6(3),o.ekj("border-b-4",3===a.selectedSection)("border-blue-500",3===a.selectedSection),o.Q6J("ngClass",o.VKq(22,si,3===a.selectedSection)),o.xp6(3),o.Q6J("ngIf",1===a.selectedSection),o.xp6(1),o.Q6J("ngIf",2===a.selectedSection),o.xp6(1),o.Q6J("ngIf",3===a.selectedSection))},dependencies:[V.mk,V.O5,an],styles:[".button-with-point[_ngcontent-%COMP%]{border-bottom-width:4px!important;border-bottom-color:#facc15!important}"]})}}return h})();function D(h,w){1&h&&(o.O4$(),o._UZ(0,"path",40))}function hn(h,w){1&h&&(o.O4$(),o._UZ(0,"path",41))}function ni(h,w){1&h&&(o.O4$(),o._UZ(0,"path",42))}function ts(h,w){if(1&h){const r=o.EpF();o.TgZ(0,"div",45)(1,"div",46)(2,"div",47),o.O4$(),o.TgZ(3,"svg",48),o._UZ(4,"circle",49)(5,"path",50),o.qZA()(),o.kcU(),o.TgZ(6,"div",51)(7,"span",52),o._uU(8,"\xbfQuieres ver la explicaci\xf3n paso a paso?"),o.qZA(),o.TgZ(9,"p",53),o._uU(10,"Puedes ver c\xf3mo se resuelve este ejemplo bloque por bloque."),o.qZA()(),o.TgZ(11,"div",12)(12,"button",54),o.NdJ("click",function(){o.CHM(r);const a=o.oxw(4);return o.KtG(a.setShowSteps(!0))}),o.O4$(),o.TgZ(13,"svg",55),o._UZ(14,"path",37),o.qZA()(),o.kcU(),o.TgZ(15,"div",56),o._uU(16," Mostrar explicaci\xf3n paso a paso "),o.qZA()()()()}}function ri(h,w){if(1&h){const r=o.EpF();o.TgZ(0,"div",57)(1,"div",20)(2,"div",58)(3,"div",59),o._uU(4," \u{1f463} "),o.qZA(),o.TgZ(5,"div",56),o._uU(6," Ver pasos "),o.qZA()(),o.TgZ(7,"h2",60),o._uU(8,"Explicaci\xf3n paso a paso"),o.qZA()(),o.TgZ(9,"div")(10,"div",28)(11,"h3",29),o._uU(12,"\u{1f4cb} Instrucciones:"),o.qZA(),o.TgZ(13,"p",30),o._uU(14),o.qZA()(),o._UZ(15,"div",31),o.TgZ(16,"div",61)(17,"button",33),o.NdJ("click",function(){o.CHM(r);const a=o.oxw(4);return o.KtG(a.previousStep())}),o.O4$(),o.TgZ(18,"svg",22),o._UZ(19,"path",34),o.qZA()(),o.kcU(),o.TgZ(20,"span",35),o._uU(21),o.qZA(),o.TgZ(22,"button",36),o.NdJ("click",function(){o.CHM(r);const a=o.oxw(4);return o.KtG(a.nextStep())}),o.O4$(),o.TgZ(23,"svg",22),o._UZ(24,"path",37),o.qZA()()()()()}if(2&h){const r=o.oxw(4);o.xp6(14),o.Oqu(null==r.currentStep?null:r.currentStep.description),o.xp6(3),o.Udp("background-color",r.canGoPreviousStep?"#f3ae22":"")("border-color",r.canGoPreviousStep?"#d18c00":""),o.ekj("opacity-50",!r.canGoPreviousStep)("cursor-not-allowed",!r.canGoPreviousStep),o.Q6J("disabled",!r.canGoPreviousStep),o.xp6(4),o.AsE(" Paso ",r.stepIndex+1," de ",r.currentExample.explanation.length," "),o.xp6(1),o.ekj("opacity-50",!r.canGoNextStep)("cursor-not-allowed",!r.canGoNextStep),o.Q6J("disabled",!r.canGoNextStep)}}function li(h,w){if(1&h&&(o.ynx(0),o.YNc(1,ts,17,0,"div",43),o.YNc(2,ri,25,17,"div",44),o.BQk()),2&h){const r=o.oxw(3);o.xp6(1),o.Q6J("ngIf",!r.showSteps),o.xp6(1),o.Q6J("ngIf",r.showSteps)}}function ne(h,w){if(1&h){const r=o.EpF();o.TgZ(0,"div",18)(1,"div",19)(2,"div",20)(3,"div",12)(4,"div",21),o.O4$(),o.TgZ(5,"svg",22),o.YNc(6,D,1,0,"path",23),o.YNc(7,hn,1,0,"path",24),o.YNc(8,ni,1,0,"path",25),o.qZA()(),o.kcU(),o.TgZ(9,"div",26),o._uU(10),o.qZA()(),o.TgZ(11,"h2",27),o._uU(12),o.qZA()(),o.TgZ(13,"div",28)(14,"h3",29),o._uU(15,"\u{1f4cb} Instrucciones:"),o.qZA(),o.TgZ(16,"p",30),o._uU(17),o.qZA()(),o._UZ(18,"div",31),o.TgZ(19,"div",32)(20,"button",33),o.NdJ("click",function(){o.CHM(r);const a=o.oxw(2);return o.KtG(a.onPreviousExercise())}),o.O4$(),o.TgZ(21,"svg",22),o._UZ(22,"path",34),o.qZA()(),o.kcU(),o.TgZ(23,"span",35),o._uU(24),o.qZA(),o.TgZ(25,"button",36),o.NdJ("click",function(){o.CHM(r);const a=o.oxw(2);return o.KtG(a.onNextExercise())}),o.O4$(),o.TgZ(26,"svg",22),o._UZ(27,"path",37),o.qZA()()()(),o.kcU(),o.TgZ(28,"div",38),o.YNc(29,li,3,2,"ng-container",39),o.qZA()()}if(2&h){const r=o.oxw(2);o.xp6(4),o.Udp("background-color",r.getDifficultyColor(r.currentDifficulty))("border-color",r.getDifficultyBorderColor(r.currentDifficulty)),o.xp6(2),o.Q6J("ngIf","easy"===r.currentDifficulty),o.xp6(1),o.Q6J("ngIf","medium"===r.currentDifficulty),o.xp6(1),o.Q6J("ngIf","hard"===r.currentDifficulty),o.xp6(2),o.hij(" ",r.getDifficultyText(r.currentDifficulty)," "),o.xp6(2),o.Oqu(null==r.currentExample?null:r.currentExample.title),o.xp6(5),o.Oqu(null==r.currentExample?null:r.currentExample.description),o.xp6(3),o.Udp("background-color",r.currentExampleIndex>0?"#f3ae22":"")("border-color",r.currentExampleIndex>0?"#d18c00":""),o.ekj("opacity-50",0===r.currentExampleIndex)("cursor-not-allowed",0===r.currentExampleIndex),o.Q6J("disabled",0===r.currentExampleIndex),o.xp6(4),o.AsE(" ",r.currentExampleIndex+1," de ",r.examples.length," "),o.xp6(1),o.ekj("opacity-50",r.currentExampleIndex===r.examples.length-1)("cursor-not-allowed",r.currentExampleIndex===r.examples.length-1),o.Q6J("disabled",r.currentExampleIndex===r.examples.length-1),o.xp6(4),o.Q6J("ngIf",(null==r.currentExample?null:r.currentExample.explanation)&&(null==r.currentExample?null:r.currentExample.explanation.length)>0)}}function Ge(h,w){if(1&h){const r=o.EpF();o.TgZ(0,"div",62),o.NdJ("dragstart",function(a){const S=o.CHM(r).$implicit,H=o.oxw(2);return o.KtG(H.onDragStart(a,S))})("drop",function(a){o.CHM(r);const _=o.oxw(2);return o.KtG(_.onDropToDrag(a))})("dragover",function(a){return a.preventDefault()}),o._uU(1),o.qZA()}if(2&h){const r=w.$implicit;o.xp6(1),o.hij(" ",r.text," ")}}function Io(h,w){1&h&&(o.ynx(0),o.O4$(),o.TgZ(1,"svg",66),o._UZ(2,"path",67),o.qZA(),o.BQk())}const os=function(h){return{fontSize:h}};function P(h,w){if(1&h&&(o.ynx(0),o.TgZ(1,"div",68),o._uU(2),o.qZA(),o.BQk()),2&h){const r=o.oxw().$implicit,p=o.oxw(3);o.xp6(1),o.Q6J("ngStyle",o.VKq(2,os,4===p.n?"0.8rem":"1.1rem")),o.xp6(1),o.hij(" ",(null==r?null:r.text)||r," ")}}const is=function(){return{width:"113px",height:"113px"}},I=function(){return{width:"160px",height:"160px"}};function R(h,w){if(1&h){const r=o.EpF();o.TgZ(0,"div",65),o.NdJ("drop",function(a){const S=o.CHM(r).index,H=o.oxw().index,W=o.oxw(2);return o.KtG(W.onDrop(a,H,S))})("dragover",function(a){return a.preventDefault()})("dragstart",function(a){const _=o.CHM(r),S=_.$implicit,H=_.index,W=o.oxw().index,Wt=o.oxw(2);return o.KtG(S?Wt.onDragStart(a,S,W,H):null)}),o.YNc(1,Io,3,0,"ng-container",39),o.YNc(2,P,3,4,"ng-container",39),o.qZA()}if(2&h){const r=w.$implicit,p=o.oxw(3);o.Q6J("ngClass",r?"cellblock":"cell")("ngStyle",4===p.n?o.DdM(5,is):o.DdM(6,I))("draggable",!!r),o.xp6(1),o.Q6J("ngIf",!r),o.xp6(1),o.Q6J("ngIf",r)}}function ci(h,w){if(1&h&&(o.TgZ(0,"div")(1,"div",63),o.YNc(2,R,3,7,"div",64),o.qZA()()),2&h){const r=w.$implicit;o.xp6(2),o.Q6J("ngForOf",r)}}function X(h,w){if(1&h&&(o.TgZ(0,"div",69)(1,"div",70)(2,"div",71),o.O4$(),o.TgZ(3,"svg",72),o._UZ(4,"path",73),o.qZA(),o.kcU(),o.TgZ(5,"div")(6,"p",74),o._uU(7,"\xa1Perfecto!"),o.qZA(),o.TgZ(8,"p",75),o._uU(9),o.qZA()()()()()),2&h){const r=o.oxw(2);o.xp6(9),o.Oqu(r.currentMessage)}}function ai(h,w){if(1&h&&(o.TgZ(0,"div",69)(1,"div",76)(2,"div",71),o.O4$(),o.TgZ(3,"svg",72),o._UZ(4,"path",77),o.qZA(),o.kcU(),o.TgZ(5,"div")(6,"p",74),o._uU(7,"Int\xe9ntalo de nuevo"),o.qZA(),o.TgZ(8,"p",75),o._uU(9),o.qZA()()()()()),2&h){const r=o.oxw(2);o.xp6(9),o.Oqu(r.currentMessage)}}const Q=function(h){return{"grid-template-columns":h,"justify-content":"center",margin:"0 auto",width:"max-content"}};function c(h,w){if(1&h){const r=o.EpF();o.TgZ(0,"div",1),o.YNc(1,ne,30,27,"div",2),o.TgZ(2,"div",3)(3,"div",4)(4,"h3",5)(5,"b"),o._uU(6,"Tomar Bloques"),o.qZA()(),o.TgZ(7,"div",6),o.YNc(8,Ge,2,1,"div",7),o.qZA()(),o.TgZ(9,"div",8)(10,"h3",5)(11,"b"),o._uU(12,"Soltar Bloques"),o.qZA()(),o.TgZ(13,"div",9),o.YNc(14,ci,3,1,"div",10),o.qZA()()(),o.TgZ(15,"div",11)(16,"div",12)(17,"button",13),o.NdJ("click",function(){o.CHM(r);const a=o.oxw();return a.showValidationModal=!0,o.KtG(a.onValidatePuzzle())}),o.O4$(),o.TgZ(18,"svg",14),o._UZ(19,"path",15),o.qZA()(),o.kcU(),o.TgZ(20,"div",16),o._uU(21," Validar ejercicio "),o.qZA()()(),o.YNc(22,X,10,1,"div",17),o.YNc(23,ai,10,1,"div",17),o.qZA()}if(2&h){const r=o.oxw();o.xp6(1),o.Q6J("ngIf",r.examples&&r.examples.length>0),o.xp6(7),o.Q6J("ngForOf",r.blocks),o.xp6(5),o.Q6J("ngStyle",o.VKq(6,Q,"repeat("+r.n+", 1fr)")),o.xp6(1),o.Q6J("ngForOf",r.dropMatrix),o.xp6(8),o.Q6J("ngIf",r.showSuccess),o.xp6(1),o.Q6J("ngIf",r.showError)}}let g=(()=>{class h{constructor(){this.showSuccess=!1,this.showError=!1,this.currentMessage="",this.showValidationModal=!1,this.showSteps=!1,this.n=3,this.description="",this.blocks=[],this.currentExampleIndex=0,this.examples=[],this.validationResult="",this.previousExample=new o.vpe,this.nextExample=new o.vpe,this.stepIndex=0,this.validatePuzzle=new o.vpe,this.blocksChange=new o.vpe,this.dropMatrix=[],this.dragSource=null}get currentStep(){return this.currentExample?.explanation&&this.currentExample.explanation.length>0?this.currentExample.explanation[this.stepIndex]:null}get canGoPreviousStep(){return this.stepIndex>0}get canGoNextStep(){return this.currentExample?.explanation&&this.stepIndex<this.currentExample.explanation.length-1}previousStep(){if(this.canGoPreviousStep){const r=this.stepIndex,p=Math.floor(r/this.n),a=r%this.n,_=this.dropMatrix[p][a];_&&(this.blocks.push(_),this.dropMatrix[p][a]=null,this.blocks=[...this.blocks]),this.stepIndex--}}nextStep(){if(this.canGoNextStep&&(this.stepIndex++,this.currentExample?.explanation&&this.currentExample?.answer&&Array.isArray(this.currentExample.answer)&&void 0!==this.currentExample.explanation[this.stepIndex]?.blockId_answer)){const r=this.currentExample.explanation[this.stepIndex].blockId_answer,a=(this.currentExample.answer.find(W=>W.blockId===r),this.blocks.find(W=>W.id===r)),_=Math.floor(this.stepIndex/this.n),S=this.stepIndex%this.n,H=this.dropMatrix[_][S];H&&H.id!==r&&(this.blocks.push(H),this.dropMatrix[_][S]=null),a&&(this.dropMatrix[_][S]=a,this.blocks=this.blocks.filter(W=>W.id!==r),this.blocks=[...this.blocks])}}ngOnChanges(){this.stepIndex=0}ngOnInit(){let p=Math.sqrt(this.currentExample?.answer?.length||9);this.n=Number.isInteger(p)&&p>1?p:3,this.dropMatrix=Array.from({length:this.n},()=>Array(this.n).fill(null)),(!this.examples||0===this.examples.length)&&(this.blocks=this.blocks&&this.blocks.length>0?[...this.blocks]:Array.from({length:this.n*this.n},(a,_)=>({id:_+1,text:`Bloque ${_+1}`})))}onDrop(r,p,a){const _=r.dataTransfer.getData("text");if(this.dragSource&&"matrix"===this.dragSource.type){const S=this.dragSource.row,H=this.dragSource.col,W=this.dropMatrix[p][a];this.dropMatrix[p][a]=this.dropMatrix[S][H],this.dropMatrix[S][H]=W}else if(this.dragSource&&"block"===this.dragSource.type){const S=this.blocks.find(H=>H.text===_);if(S)if(this.dropMatrix[p][a]){const H=this.dropMatrix[p][a];this.dropMatrix[p][a]=S,this.blocks=this.blocks.filter(W=>W.text!==_),this.blocks.push(H)}else this.dropMatrix[p][a]=S,this.blocks=this.blocks.filter(H=>H.text!==_)}this.dragSource=null}onDropToDrag(r){const p=r.dataTransfer.getData("text");for(let a=0;a<this.n;a++)for(let _=0;_<this.n;_++){const S=this.dropMatrix[a][_];if(S&&S.text===p){this.blocks.push(S),this.dropMatrix[a][_]=null,this.blocksChange.emit(this.blocks);break}}this.dragSource=null}onDragStart(r,p,a,_){r.dataTransfer.setData("text",p.text),this.dragSource=void 0!==a&&void 0!==_?{type:"matrix",row:a,col:_,value:p.text}:{type:"block",value:p.text}}onPreviousExercise(){this.showSteps=!1,this.stepIndex=0,this.previousExample.emit()}onNextExercise(){this.showSteps=!1,this.stepIndex=0,this.nextExample.emit()}onValidatePuzzle(){let r=[];for(let S=0;S<this.n;S++)for(let H=0;H<this.n;H++){const W=this.dropMatrix[S][H];W&&void 0!==W.id&&r.push(W.id)}const p=(this.currentExample?.answer||[]).map(S=>S.blockId);r.sort((S,H)=>S-H);const a=[...p].sort((S,H)=>S-H),_=r.length===a.length&&r.every((S,H)=>S===a[H]);this.validationResult=_?"correcto":"incorrecto",_?(this.showSuccess=!0,this.currentMessage="\xa1Excelente! Has completado el ejercicio correctamente. \u{1f389}",setTimeout(()=>{this.showSuccess=!1},2500)):(this.showError=!0,this.currentMessage="La soluci\xf3n no es correcta. Revisa las instrucciones e int\xe9ntalo de nuevo. \u{1f4aa}",setTimeout(()=>{this.showError=!1},2500)),this.validatePuzzle.emit()}get canGoPrevious(){return this.currentExampleIndex>0}get canGoNext(){return this.currentExampleIndex<this.examples.length-1}get currentTitle(){return this.currentExample?.title||""}get currentDescription(){return this.currentExample?.description||""}get currentInstructions(){return this.currentExample?.instructions||""}get currentDifficulty(){return this.currentExample?.difficulty||"easy"}getDifficultyColor(r){return"easy"===r?"#4ade80":"medium"===r?"#fbbf24":"hard"===r?"#ef4444":"#a3a3a3"}getDifficultyBorderColor(r){return"easy"===r?"#22c55e":"medium"===r?"#d97706":"hard"===r?"#b91c1c":"#737373"}getDifficultyText(r){return"easy"===r?"F\xe1cil":"medium"===r?"Intermedio":"hard"===r?"Dif\xedcil":"Desconocido"}setShowSteps(r){if(this.showSteps=r,r){this.stepIndex=0;let p=[];for(let a=0;a<this.n;a++)for(let _=0;_<this.n;_++)this.dropMatrix[a][_]&&(p.push(this.dropMatrix[a][_]),this.dropMatrix[a][_]=null);if(this.blocks=[...this.blocks,...p],this.currentExample?.answer&&Array.isArray(this.currentExample.answer)&&this.currentExample.answer.length>0){const a=this.currentExample.answer[0],_=void 0!==a.blockId?a.blockId:a,S=this.blocks.find(H=>H.id===_);if(S){const H=Math.floor(0/this.n);this.dropMatrix[H][0%this.n]=S,this.blocks=this.blocks.filter(Wt=>Wt.id!==_),this.blocks=[...this.blocks]}}}}static{this.\u0275fac=function(p){return new(p||h)}}static{this.\u0275cmp=o.Xpm({type:h,selectors:[["app-puzzle"]],inputs:{n:"n",description:"description",blocks:"blocks",currentExample:"currentExample",currentExampleIndex:"currentExampleIndex",examples:"examples",validationResult:"validationResult"},outputs:{previousExample:"previousExample",nextExample:"nextExample",validatePuzzle:"validatePuzzle",blocksChange:"blocksChange"},features:[o.TTD],decls:1,vars:1,consts:[["class","w-full",4,"ngIf"],[1,"w-full"],["class","w-full flex flex-row items-start mt-2 gap-8",4,"ngIf"],[1,"flex","flex-row","gap-8","items-start","w-full","mb-6"],[1,"drag-box","w-1/2"],[1,"mb-2","text-center"],[1,"blocks","grid","grid-cols-4","gap-2",2,"display","grid","grid-template-columns","repeat(4, 1fr)","justify-content","center","width","100%","max-width","460px","margin","0 auto"],["class","block","draggable","true","style","width:110px;height:100px;display:flex;align-items:center;justify-content:center;text-align:center;font-size:0.85rem;color:#333;font-weight:500;overflow-wrap:break-word;word-break:break-word;white-space:pre-line;line-height:1.1;padding:0;",3,"dragstart","drop","dragover",4,"ngFor","ngForOf"],[1,"drop-box","w-1/2"],[1,"matrix","mt-[1002px]","grid","gap-x-2",3,"ngStyle"],[4,"ngFor","ngForOf"],[1,"w-full","flex","justify-end","mt-6"],[1,"relative","group"],["aria-label","Validar ejercicio",1,"w-12","h-12","bg-green-600","hover:bg-green-700","text-white","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border-2","border-green-800",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 13l4 4L19 7"],[1,"absolute","right-0","top-full","mt-2","bg-gray-800","text-white","text-xs","rounded","py-1","px-2","opacity-0","group-hover:opacity-100","transition-opacity","duration-200","whitespace-nowrap","z-10"],["class","fixed inset-0 z-[9999] flex items-center justify-center bg-black bg-opacity-50",4,"ngIf"],[1,"w-full","flex","flex-row","items-start","mt-2","gap-8"],[1,"px-4","py-3","max-w-xl","flex-shrink-0"],[1,"flex","items-center","space-x-3","mb-2"],[1,"w-8","h-8","text-white","rounded-full","shadow-lg","flex","items-center","justify-center","border-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 10V3L4 14h7v7l9-11h-7z",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17.657 18.657A8 8 0 016.343 7.343S7 9 9 10c0-2 .5-5 2.986-7C14 5 16.09 5.777 17.656 7.343A7.975 7.975 0 0120 13a7.975 7.975 0 01-2.343 5.657z",4,"ngIf"],[1,"absolute","left-1/2","transform","-translate-x-1/2","-top-8","bg-gray-800","text-white","text-xs","rounded","py-1","px-2","opacity-0","group-hover:opacity-100","transition-opacity","duration-200","whitespace-nowrap","z-10"],[1,"text-xl","font-bold","text-gray-800"],[1,"bg-blue-50","border-l-4","border-blue-400","p-2","rounded-r-lg","mb-4"],[1,"font-semibold","text-blue-800","mb-1","text-sm"],[1,"text-blue-700","text-sm","text-justify"],[1,"border-t","border-gray-200","w-full"],[1,"flex","justify-between","items-center","pt-4"],[1,"w-10","h-10","text-white","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border-2","disabled:bg-gray-400","disabled:border-gray-300","disabled:hover:bg-gray-400",3,"disabled","click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[1,"text-sm","text-green-600","font-bold"],[1,"w-10","h-10","bg-blue-600","hover:bg-blue-700","text-white","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border-2","border-blue-800","disabled:bg-gray-400","disabled:border-gray-300","disabled:hover:bg-gray-400",3,"disabled","click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],[1,"flex-1","flex","flex-col","items-center","justify-center"],[4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 10V3L4 14h7v7l9-11h-7z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17.657 18.657A8 8 0 016.343 7.343S7 9 9 10c0-2 .5-5 2.986-7C14 5 16.09 5.777 17.656 7.343A7.975 7.975 0 0120 13a7.975 7.975 0 01-2.343 5.657z"],["class","mx-auto",4,"ngIf"],["class","px-4 py-3 w-full max-w-xl",4,"ngIf"],[1,"mx-auto"],[1,"rounded-xl","shadow-lg","p-4","flex","flex-col","items-center","justify-center","bg-gradient-to-br","from-blue-100","via-blue-50","to-white","border","border-blue-300",2,"width","220px","height","220px"],[1,"mb-2","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-10","h-10","text-blue-400"],["cx","12","cy","12","r","10","stroke-width","2","stroke","currentColor","fill","#e3f2fd"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01"],[1,"text-center","mb-3"],[1,"text-blue-700","font-semibold","text-base"],[1,"text-gray-600","text-xs","mt-1"],["aria-label","Ver pasos",1,"w-10","h-10","bg-blue-600","hover:bg-blue-700","text-white","rounded-full","shadow-lg","flex","items-center","justify-center","border-2","border-blue-800","transition-all","duration-300","ease-in-out",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],[1,"absolute","left-1/2","transform","-translate-x-1/2","-top-10","bg-gray-800","text-white","text-xs","rounded","py-1","px-2","opacity-0","group-hover:opacity-100","transition-opacity","duration-200","whitespace-nowrap","z-10"],[1,"px-4","py-3","w-full","max-w-xl"],[1,"relative","group","flex","items-center"],[1,"w-8","h-8","bg-blue-200","text-blue-700","rounded-full","shadow-lg","flex","items-center","justify-center","border-2","border-blue-400","text-base"],[1,"text-xl","font-bold","text-black","mb-0","flex","items-center"],[1,"flex","justify-between","items-center","pt-2"],["draggable","true",1,"block",2,"width","110px","height","100px","display","flex","align-items","center","justify-content","center","text-align","center","font-size","0.85rem","color","#333","font-weight","500","overflow-wrap","break-word","word-break","break-word","white-space","pre-line","line-height","1.1","padding","0",3,"dragstart","drop","dragover"],[1,"flex","flex-row",2,"gap","8px","margin-bottom","0"],[3,"ngClass","ngStyle","draggable","drop","dragover","dragstart",4,"ngFor","ngForOf"],[3,"ngClass","ngStyle","draggable","drop","dragover","dragstart"],["width","80","height","80","viewBox","0 0 80 80"],["d","M7,7 Q7,40 40,40 Q73,40 73,7 Q40,7 40,40 Q40,73 7,73 Q7,40 40,40 Q73,40 73,73 Q40,73 40,40 Q7,40 7,7 Z","fill","#fafafa","stroke","#90caf9","stroke-width","3"],[2,"width","100%","height","100%","display","flex","align-items","center","justify-content","center","text-align","center","color","#333",3,"ngStyle"],[1,"fixed","inset-0","z-[9999]","flex","items-center","justify-center","bg-black","bg-opacity-50"],[1,"bg-green-500","text-white","px-8","py-6","rounded-xl","shadow-2xl","transform","transition-all","duration-500","ease-in-out","max-w-md","mx-4"],[1,"flex","items-center","space-x-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","flex-shrink-0"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"font-bold","text-lg"],[1,"text-sm","opacity-90"],[1,"bg-red-500","text-white","px-8","py-6","rounded-xl","shadow-2xl","transform","transition-all","duration-500","ease-in-out","max-w-md","mx-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"]],template:function(p,a){1&p&&o.YNc(0,c,24,8,"div",0),2&p&&o.Q6J("ngIf",a.currentExample)},dependencies:[V.mk,V.sg,V.O5,V.PC],styles:[".puzzle-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:1rem}.flex-row-box[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:flex-start;gap:3rem;width:100%;justify-content:center}.drag-box[_ngcontent-%COMP%]{min-width:180px;background:linear-gradient(135deg,#f4fafe 0%,#f7eafd 100%);border-radius:16px;box-shadow:0 4px 16px #5050a01a;padding:1.5rem 1rem 1.2rem;border:none;transition:box-shadow .3s,background .3s}.drop-box[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f7eafd 0%,#f4fafe 100%);border-radius:16px;box-shadow:0 4px 16px #5050a01a;padding:1.5rem 1rem 1.2rem;border:none;transition:box-shadow .3s,background .3s}.blocks[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.75rem}.block[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8fafc 0%,#e0e7ff 60%,#fbc2eb 100%);border:2px solid #a5b4fc;box-shadow:0 4px 16px #a5b4fc33,0 1.5px 6px #fbc2eb22;border-radius:14px;cursor:grab;font-size:2rem;padding:1.2rem 2.5rem;transition:transform .18s cubic-bezier(.4,2,.3,1),box-shadow .18s,background .18s}.block[_ngcontent-%COMP%]:hover{transform:scale(1.07) translateY(-4px);box-shadow:0 8px 24px #a5b4fc55,0 2px 12px #fbc2eb44;background:linear-gradient(135deg,#fbc2eb 0%,#e0e7ff 80%,#f8fafc 100%);border-color:#6366f1}.block[_ngcontent-%COMP%]:active{transform:scale(.97);box-shadow:0 2px 8px #a5b4fc33}.matrix[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem}.row[_ngcontent-%COMP%]{display:flex;gap:2rem}.cell[_ngcontent-%COMP%]{width:160px;height:160px;background:linear-gradient(135deg,#e3f2fd 0%,#fafafa 100%);border:4px dashed #90caf9;display:flex;align-items:center;justify-content:center;border-radius:16px;font-size:2.2rem;transition:background .2s}.cell[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#bbdefb 0%,#e3f2fd 80%,#fafafa 100%)}.cell[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;align-items:center;justify-content:center;text-align:center;font-size:1.1rem;color:#333;padding:8px;overflow-wrap:break-word;word-break:break-word;white-space:pre-line}.cell[_ngcontent-%COMP%]:hover{background:#e3f2fd}.controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1.5rem;margin-top:2rem}.description[_ngcontent-%COMP%]{font-weight:700;font-size:1.1rem}.cellblock[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fbc2eb 0%,#e0e7ff 80%,#f8fafc 100%);border:2px solid #a5b4fc;box-shadow:0 4px 16px #a5b4fc33,0 1.5px 6px #fbc2eb22;border-radius:14px;width:160px;height:160px;border:4px dashed #90caf9;display:flex;align-items:center;justify-content:center;transition:background .2s}.cellblock[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#f8fafc 0%,#e0e7ff 60%,#fbc2eb 100%);box-shadow:0 8px 24px #a5b4fc55,0 2px 12px #fbc2eb44}.cellblock.small[_ngcontent-%COMP%]{width:110px;height:100px}"]})}}return h})();const b=["puzzleRef"];function E(h,w){1&h&&(o.TgZ(0,"section",12)(1,"div",13)(2,"h2",14),o._uU(3,"\u{1f393} \xbfQu\xe9 es la Abstracci\xf3n?"),o.qZA(),o.TgZ(4,"p",15),o._uU(5,"La abstracci\xf3n es el proceso de enfocarse en los aspectos m\xe1s importantes de un problema, ignorando todo lo que no es esencial para resolverlo."),o.qZA(),o.TgZ(6,"div",16)(7,"h3",17),o._uU(8,"\u{1f9e9} Explicaci\xf3n:"),o.qZA(),o.TgZ(9,"p",18),o._uU(10,"Imagina que explicas c\xf3mo llegar a tu casa: das solo los pasos clave y eliminas detalles innecesarios. As\xed aplicas abstracci\xf3n, qued\xe1ndote con lo esencial para no perderse."),o.qZA(),o.TgZ(11,"h3",17),o._uU(12,"\u{1f3e1} Ejemplo cotidiano:"),o.qZA(),o.TgZ(13,"p",18),o._uU(14,"Al pensar en \u201cpreparar desayuno\u201d, tu mente abstrae y simplifica la acci\xf3n en pasos importantes, sin cada movimiento exacto."),o.qZA()(),o.TgZ(15,"div",19)(16,"h2",20),o._uU(17,"\u{1f6e0} \xbfQu\xe9 es la Simplificaci\xf3n?"),o.qZA(),o.TgZ(18,"p",21),o._uU(19,"Simplificaci\xf3n es organizar lo esencial en estructuras claras, reducir la complejidad y hacerlo m\xe1s f\xe1cil de comprender o resolver."),o.qZA(),o.TgZ(20,"h3",17),o._uU(21,"\u{1f50e} Explicaci\xf3n:"),o.qZA(),o.TgZ(22,"p",18),o._uU(23,"Si tienes muchas opciones para preparar el desayuno y lo haces todo a la vez, te enredas. Pero si lo simplificas en una secuencia ordenada, es m\xe1s f\xe1cil y menos propenso a errores."),o.qZA(),o.TgZ(24,"h3",17),o._uU(25,"\u{1f4dd} Ejemplo cotidiano:"),o.qZA(),o.TgZ(26,"p",18),o._uU(27,"Hacer una lista de tareas es simplificar tu d\xeda: organizas qu\xe9 hacer, en qu\xe9 orden y con qu\xe9 prioridad."),o.qZA()(),o.TgZ(28,"div",22)(29,"h2",23),o._uU(30,"\u{1f9e0} \xbfPor qu\xe9 son importantes en programaci\xf3n?"),o.qZA(),o.TgZ(31,"ul",24)(32,"li"),o._uU(33,"Permiten enfocarse en lo que realmente importa."),o.qZA(),o.TgZ(34,"li"),o._uU(35,"Ayudan a dividir tareas complejas en pasos manejables."),o.qZA(),o.TgZ(36,"li"),o._uU(37,"El c\xf3digo es m\xe1s limpio, claro y reutilizable."),o.qZA()(),o.TgZ(38,"p",18),o._uU(39,"En programaci\xf3n, abstraer y simplificar hace que los problemas grandes sean m\xe1s f\xe1ciles de entender, resolver y mantener."),o.qZA()()(),o.TgZ(40,"div",25)(41,"h2",26),o._uU(42,"\u2753 Preguntas frecuentes y sus respuestas"),o.qZA(),o.TgZ(43,"div",27)(44,"div",28)(45,"span",29),o._uU(46,"\u{1f914} \xbfLa abstracci\xf3n significa ignorar cosas?"),o.qZA(),o._UZ(47,"br"),o.TgZ(48,"span",18),o._uU(49,"S\xed, pero solo las cosas que no son necesarias para el problema que est\xe1s resolviendo. No se trata de ser descuidado, sino de ser eficiente."),o._UZ(50,"br"),o._uU(51," Si est\xe1s programando un bot\xf3n para encender una luz, no necesitas saber el color del bot\xf3n, sino si fue presionado o no."),o._UZ(52,"br")(53,"br"),o._uU(54," Abstraer es priorizar lo esencial y dejar de lado lo que no aporta a la soluci\xf3n. As\xed tomas decisiones m\xe1s claras y efectivas, tanto en programaci\xf3n como en la vida diaria."),o.qZA()(),o.TgZ(55,"div",30)(56,"span",29),o._uU(57,"\u{1f914} \xbfSimplificar es lo mismo que hacer algo m\xe1s f\xe1cil?"),o.qZA(),o._UZ(58,"br"),o.TgZ(59,"span",18),o._uU(60,"Casi. Simplificar no significa que el problema en s\xed sea f\xe1cil, sino que lo haces m\xe1s claro y estructurado, para poder resolverlo paso a paso."),o._UZ(61,"br"),o._uU(62," Por ejemplo, construir una casa es complejo, pero si lo divides en planos, cimientos, paredes y techos, puedes trabajar por fases. Eso es simplificaci\xf3n."),o._UZ(63,"br")(64,"br"),o._uU(65," Simplificar es dividir lo complejo en partes manejables, para avanzar sin sentirse abrumado y evitar errores innecesarios."),o.qZA()(),o.TgZ(66,"div",28)(67,"span",29),o._uU(68,"\u{1f914} \xbfPuedo aplicar estos conceptos en mi vida diaria?"),o.qZA(),o._UZ(69,"br"),o.TgZ(70,"span",18),o._uU(71,"\xa1Absolutamente!"),o._UZ(72,"br"),o._uU(73," Cada vez que haces una lista de mercado, organizas tu rutina o das una explicaci\xf3n breve y clara a alguien, est\xe1s abstraendo y simplificando."),o._UZ(74,"br"),o._uU(75," Al contar una historia a un ni\xf1o, no mencionas todos los detalles ni usas t\xe9rminos complejos. Usas solo lo necesario para que entienda y se mantenga interesado."),o._UZ(76,"br")(77,"br"),o._uU(78," Estos conceptos te ayudan a organizar mejor tus tareas y comunicarte de forma m\xe1s clara en cualquier situaci\xf3n cotidiana."),o.qZA()(),o.TgZ(79,"div",30)(80,"span",29),o._uU(81,"\u{1f914} \xbfQu\xe9 pasa si abstraigo o simplifico demasiado?"),o.qZA(),o._UZ(82,"br"),o.TgZ(83,"span",18),o._uU(84,"Si abstraes o simplificas en exceso, puedes perder informaci\xf3n importante que podr\xeda ser clave para resolver el problema correctamente. El reto est\xe1 en encontrar el equilibrio: eliminar lo innecesario, pero conservar lo esencial. En programaci\xf3n, abstraer demasiado puede hacer que el c\xf3digo sea dif\xedcil de entender o mantener; simplificar demasiado puede hacer que se pierdan funcionalidades importantes. Por eso, siempre revisa que lo que eliminas no sea fundamental para tu objetivo."),o.qZA()(),o.TgZ(85,"div",28)(86,"span",29),o._uU(87,"\u{1f914} \xbfC\xf3mo s\xe9 si estoy abstraiendo o simplificando correctamente?"),o.qZA(),o._UZ(88,"br"),o.TgZ(89,"span",18),o._uU(90,"La mejor se\xf1al es que puedes explicar el problema o la soluci\xf3n de forma clara y breve, y que cualquier persona pueda entender los pasos principales sin perderse en detalles. Si al aplicar tu abstracci\xf3n o simplificaci\xf3n, el resultado sigue siendo \xfatil, funcional y f\xe1cil de seguir, vas por buen camino. Si notas que surgen dudas, confusiones o que falta informaci\xf3n esencial, es momento de revisar y ajustar tu enfoque. Recuerda: la claridad y la utilidad son tus mejores indicadores."),o.qZA()()()(),o.TgZ(91,"h2",31),o._uU(92,"\u{1f9f0} Comparaciones Cotidianas"),o.qZA(),o.TgZ(93,"div",32)(94,"table",33)(95,"thead")(96,"tr",34)(97,"th",35),o._uU(98,"Situaci\xf3n Real"),o.qZA(),o.TgZ(99,"th",36),o._uU(100,"Abstracci\xf3n"),o.qZA(),o.TgZ(101,"th",37),o._uU(102,"Simplificaci\xf3n"),o.qZA()()(),o.TgZ(103,"tbody")(104,"tr",38)(105,"td",39),o._uU(106,"Preparar una maleta"),o.qZA(),o.TgZ(107,"td",39),o._uU(108,"Llevar solo lo necesario (ropa, documentos)"),o.qZA(),o.TgZ(109,"td",39),o._uU(110,"Doblar y acomodar para que todo quepa"),o.qZA()(),o.TgZ(111,"tr",40)(112,"td",39),o._uU(113,"Contar c\xf3mo llegar a un lugar"),o.qZA(),o.TgZ(114,"td",39),o._uU(115,"Dar solo los pasos relevantes"),o.qZA(),o.TgZ(116,"td",39),o._uU(117,"Ordenar las instrucciones en la mejor secuencia"),o.qZA()(),o.TgZ(118,"tr",41)(119,"td",39),o._uU(120,"Ense\xf1ar a usar una app"),o.qZA(),o.TgZ(121,"td",39),o._uU(122,"Explicar solo las funciones b\xe1sicas al inicio"),o.qZA(),o.TgZ(123,"td",39),o._uU(124,"Mostrar una pantalla con pocas opciones para no abrumar"),o.qZA()(),o.TgZ(125,"tr",42)(126,"td",39),o._uU(127,"Cocinar una receta"),o.qZA(),o.TgZ(128,"td",39),o._uU(129,"Usar solo ingredientes clave"),o.qZA(),o.TgZ(130,"td",39),o._uU(131,"Organizar los pasos para no mezclar todo sin orden"),o.qZA()(),o.TgZ(132,"tr",43)(133,"td",44),o._uU(134,"Resolver un problema en grupo"),o.qZA(),o.TgZ(135,"td",44),o._uU(136,"Identificar el problema central"),o.qZA(),o.TgZ(137,"td",44),o._uU(138,"Asignar tareas espec\xedficas a cada miembro"),o.qZA()()()()(),o.TgZ(139,"div",45)(140,"h2",46),o._uU(141,"\u2728 Frases clave para recordar"),o.qZA(),o.TgZ(142,"ul",47)(143,"li"),o._uU(144,'"No todo lo que ves es importante. Lo importante es lo que te acerca a la soluci\xf3n."'),o.qZA(),o.TgZ(145,"li"),o._uU(146,'"Si puedes explicarlo con menos pasos, lo est\xe1s entendiendo mejor."'),o.qZA(),o.TgZ(147,"li"),o._uU(148,'"La abstracci\xf3n te da claridad. La simplificaci\xf3n te da control."'),o.qZA()()()())}function A(h,w){if(1&h){const r=o.EpF();o.TgZ(0,"section",12)(1,"app-puzzle",48,49),o.NdJ("previousExample",function(){o.CHM(r);const a=o.oxw();return o.KtG(a.previousExample())})("nextExample",function(){o.CHM(r);const a=o.oxw();return o.KtG(a.nextExample())})("validatePuzzle",function(){o.CHM(r);const a=o.oxw();return o.KtG(a.validatePuzzle())})("blocksChange",function(a){o.CHM(r);const _=o.oxw();return o.KtG(_.currentBlocks=a)}),o.qZA()()}if(2&h){const r=o.oxw();o.xp6(1),o.Q6J("n",3)("description","Resuelve el rompecabezas colocando los bloques en la matriz.")("blocks",r.currentBlocks)("currentExample",r.currentExample)("currentExampleIndex",r.currentExampleIndex)("examples",r.examples)("validationResult",r.validationResult)}}function he(h,w){if(1&h){const r=o.EpF();o.TgZ(0,"section",12)(1,"app-puzzle",50,49),o.NdJ("previousExample",function(){o.CHM(r);const a=o.oxw();return o.KtG(a.previousPuzzle())})("nextExample",function(){o.CHM(r);const a=o.oxw();return o.KtG(a.nextPuzzle())})("validatePuzzle",function(){o.CHM(r);const a=o.oxw();return o.KtG(a.validatePuzzle())}),o.qZA()()}if(2&h){const r=o.oxw();o.xp6(1),o.Q6J("n",16===(null==r.currentBlockly||null==r.currentBlockly.answer?null:r.currentBlockly.answer.length)?4:3)("description",null==r.currentBlockly?null:r.currentBlockly.description)("blocks",r.blocklyBlocks)("currentExample",r.currentBlockly)("currentExampleIndex",r.currentBlocklyIndex)("examples",r.blocklyExercises)("validationResult",r.validationResult)}}const ut=function(h){return{"button-with-point":h}};let pn=(()=>{class h{get canGoPreviousPuzzle(){return this.currentBlocklyIndex>0}get canGoNextPuzzle(){return this.currentBlocklyIndex<this.blocklyExercises.length-1}previousPuzzle(){this.currentBlocklyIndex>0&&(this.currentBlocklyIndex--,this.currentBlockly=this.blocklyExercises[this.currentBlocklyIndex],this.resetPuzzle(),this.validationResult="")}nextPuzzle(){this.currentBlocklyIndex<this.blocklyExercises.length-1&&(this.currentBlocklyIndex++,this.currentBlockly=this.blocklyExercises[this.currentBlocklyIndex],this.resetPuzzle(),this.validationResult="")}get puzzleBlocks(){return this.currentBlockly?.blocks||[]}get puzzleAnswer(){return this.currentBlockly?.answer||[]}validatePuzzle(){if(!this.puzzleComponent)return;const r=this.puzzleComponent.dropMatrix.flat().filter(_=>null!==_).map(_=>_.text),p=this.puzzleAnswer.map(_=>_.text),a=r.length===p.length&&r.every((_,S)=>_===p[S]);this.validationResult=a?"\xa1Correcto!":"Incorrecto, revisa el orden y los bloques."}constructor(r){this.http=r,this.blocklyExercises=[],this.currentBlocklyIndex=0,this.currentBlockly=null,this.selectedSection=1,this.examples=[],this.currentExampleIndex=0,this.currentExample=null,this.validationResult="",this.currentBlocks=[]}ngOnInit(){this.loadExamples(),this.loadBlocklyExercises()}loadBlocklyExercises(){this.http.get("assets/jsons-base/blockly-exercises.json").subscribe({next:r=>{this.blocklyExercises=r.abstraccion.exercises||[],this.currentBlockly=this.blocklyExercises[0]||null,this.currentBlocklyIndex=0,console.log("Blockly Abstracci\xf3n loaded:",this.blocklyExercises.length)},error:r=>{console.error("Error cargando ejercicios blockly:",r)}})}previousBlockly(){this.currentBlocklyIndex>0&&(this.currentBlocklyIndex--,this.currentBlockly=this.blocklyExercises[this.currentBlocklyIndex],this.resetPuzzle(),this.validationResult="")}nextBlockly(){this.currentBlocklyIndex<this.blocklyExercises.length-1&&(this.currentBlocklyIndex++,this.currentBlockly=this.blocklyExercises[this.currentBlocklyIndex],this.resetPuzzle(),this.validationResult="")}get canGoPreviousBlockly(){return this.currentBlocklyIndex>0}get canGoNextBlockly(){return this.currentBlocklyIndex<this.blocklyExercises.length-1}get blocklyBlocks(){return this.currentBlockly?.blocks||[]}get blocklyAnswer(){return this.currentBlockly?.answer||[]}loadExamples(){this.http.get("assets/jsons-base/modulos.json").subscribe({next:r=>{this.examples=r.abstraccion.examples,this.currentExample=this.examples[0],this.currentBlocks=this.shuffleBlocks(this.currentExample?.blocks||[]),console.log("Abstracci\xf3n examples loaded:",this.examples.length)},error:r=>{console.error("Error cargando ejemplos de abstracci\xf3n:",r)}})}previousExample(){this.currentExampleIndex>0&&(this.currentExampleIndex--,this.currentExample=this.examples[this.currentExampleIndex],this.currentBlocks=this.shuffleBlocks(this.currentExample?.blocks||[]),this.resetPuzzle(),this.validationResult="")}nextExample(){this.currentExampleIndex<this.examples.length-1&&(this.currentExampleIndex++,this.currentExample=this.examples[this.currentExampleIndex],this.currentBlocks=this.shuffleBlocks(this.currentExample?.blocks||[]),this.resetPuzzle(),this.validationResult="")}get canGoPreviousExample(){return this.currentExampleIndex>0}get canGoNextExample(){return this.currentExampleIndex<this.examples.length-1}shuffleBlocks(r){const p=[...r];for(let a=p.length-1;a>0;a--){const _=Math.floor(Math.random()*(a+1));[p[a],p[_]]=[p[_],p[a]]}return p}get currentAnswer(){return this.currentExample?.answer||[]}resetPuzzle(){setTimeout(()=>{this.puzzleComponent&&this.puzzleComponent.ngOnInit()},0)}static{this.\u0275fac=function(p){return new(p||h)(o.Y36(Ee.eN))}}static{this.\u0275cmp=o.Xpm({type:h,selectors:[["app-abstraccion"]],viewQuery:function(p,a){if(1&p&&o.Gf(b,5),2&p){let _;o.iGM(_=o.CRH())&&(a.puzzleComponent=_.first)}},decls:23,vars:24,consts:[[1,"text-center","mb-6","mt-6"],[1,"text-3xl","font-bold","text-gray-800","mb-2","drop-shadow-md"],[1,"flex","items-center","justify-center","mb-1"],[1,"h-0.5","bg-gradient-to-r","from-transparent","via-red-500","to-transparent","w-96","shadow-sm"],[1,"flex","items-center","justify-center"],[1,"h-px","bg-gradient-to-r","from-transparent","via-gray-300","to-transparent","w-64","opacity-60"],[1,"flex","flex-col","items-center","mb-6"],[1,"sticky","top-0","z-20","w-auto","flex","justify-center","bg-transparent","backdrop-blur-md","py-2","rounded-xl"],[1,"flex","gap-72"],[1,"relative","px-4","py-2","rounded-lg","font-semibold","text-gray-700","hover:text-red-500","transition",3,"ngClass","click"],[1,"flex","flex-col","gap-6","items-center","w-full","px-2","md:px-0"],["class","bg-gray-500/20 backdrop-blur-md p-8 rounded-lg border border-gray-400/30 shadow-lg w-full max-w-7xl mt-2 mb-8",4,"ngIf"],[1,"bg-gray-500/20","backdrop-blur-md","p-8","rounded-lg","border","border-gray-400/30","shadow-lg","w-full","max-w-7xl","mt-2","mb-8"],[1,"flex","flex-col","gap-6","mb-8","justify-start","items-start"],[1,"text-xl","font-bold","text-red-500","mb-2","flex","items-center","gap-2"],[1,"text-gray-800","ml-8"],[1,"bg-gradient-to-br","from-red-100","via-red-50","to-white","border-l-4","border-red-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"text-lg","font-semibold","text-gray-700","mt-4","mb-2","flex","items-center","gap-2"],[1,"text-gray-700"],[1,"bg-gradient-to-br","from-blue-100","via-blue-50","to-white","border-l-4","border-blue-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"text-xl","font-bold","text-blue-500","mb-2","flex","items-center","gap-2"],[1,"text-gray-800"],[1,"bg-gradient-to-br","from-green-100","via-green-50","to-white","border-l-4","border-green-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"text-xl","font-bold","text-green-600","mb-2","flex","items-center","gap-2"],[1,"list-disc","ml-6","text-gray-800","mb-2"],[1,"bg-gradient-to-br","from-purple-100","via-purple-50","to-white","border-l-4","border-purple-400","shadow-lg","rounded-xl","p-6","w-full","mt-2","mb-2"],[1,"text-2xl","font-bold","text-purple-600","mb-2","flex","items-center","gap-2"],[1,"space-y-2"],[1,"bg-white","rounded-lg","p-3","max-w-2xl","w-[95%]","text-justify","ml-0","mt-8"],[1,"font-semibold"],[1,"bg-white","rounded-lg","p-3","max-w-2xl","w-[95%]","text-justify","ml-auto","mt-8"],[1,"text-2xl","font-bold","text-pink-600","mb-4","mt-4","flex","items-center","gap-2"],[1,"overflow-x-auto","mb-4"],[1,"min-w-full","text-sm","text-left","border-separate","border-spacing-0","rounded-xl","shadow-lg","bg-white"],[1,"bg-gradient-to-r","from-blue-500","via-cyan-400","to-green-300"],[1,"py-3","px-6","font-bold","text-white","rounded-tl-xl","text-center"],[1,"py-3","px-6","font-bold","text-white","text-center"],[1,"py-3","px-6","font-bold","text-white","rounded-tr-xl","text-center"],[1,"hover:bg-red-50","transition"],[1,"py-3","px-6","border-b","border-gray-200"],[1,"hover:bg-blue-50","transition"],[1,"hover:bg-pink-50","transition"],[1,"hover:bg-green-50","transition"],[1,"hover:bg-yellow-50","transition"],[1,"py-3","px-6"],[1,"bg-gradient-to-br","from-yellow-100","via-yellow-50","to-white","border-l-4","border-yellow-400","shadow-lg","rounded-xl","mt-6","p-6","w-full"],[1,"text-xl","font-bold","text-yellow-600","mb-2","flex","items-center","gap-2"],[1,"list-disc","ml-6","text-gray-800"],[3,"n","description","blocks","currentExample","currentExampleIndex","examples","validationResult","previousExample","nextExample","validatePuzzle","blocksChange"],["puzzleRef",""],[3,"n","description","blocks","currentExample","currentExampleIndex","examples","validationResult","previousExample","nextExample","validatePuzzle"]],template:function(p,a){1&p&&(o.TgZ(0,"div",0)(1,"h1",1),o._uU(2,"\u{1f3af} Abstracci\xf3n y Simplificaci\xf3n"),o.qZA(),o.TgZ(3,"div",2),o._UZ(4,"div",3),o.qZA(),o.TgZ(5,"div",4),o._UZ(6,"div",5),o.qZA()(),o.TgZ(7,"div",6)(8,"nav",7)(9,"ul",8)(10,"li")(11,"button",9),o.NdJ("click",function(){return a.selectedSection=1}),o._uU(12," Teor\xeda "),o.qZA()(),o.TgZ(13,"li")(14,"button",9),o.NdJ("click",function(){return a.selectedSection=2}),o._uU(15," Ejemplos "),o.qZA()(),o.TgZ(16,"li")(17,"button",9),o.NdJ("click",function(){return a.selectedSection=3}),o._uU(18," Ejercicios "),o.qZA()()()()(),o.TgZ(19,"div",10),o.YNc(20,E,149,0,"section",11),o.YNc(21,A,3,7,"section",11),o.YNc(22,he,3,7,"section",11),o.qZA()),2&p&&(o.xp6(11),o.ekj("border-b-4",1===a.selectedSection)("border-red-500",1===a.selectedSection),o.Q6J("ngClass",o.VKq(18,ut,1===a.selectedSection)),o.xp6(3),o.ekj("border-b-4",2===a.selectedSection)("border-red-500",2===a.selectedSection),o.Q6J("ngClass",o.VKq(20,ut,2===a.selectedSection)),o.xp6(3),o.ekj("border-b-4",3===a.selectedSection)("border-red-500",3===a.selectedSection),o.Q6J("ngClass",o.VKq(22,ut,3===a.selectedSection)),o.xp6(3),o.Q6J("ngIf",1===a.selectedSection),o.xp6(1),o.Q6J("ngIf",2===a.selectedSection),o.xp6(1),o.Q6J("ngIf",3===a.selectedSection))},dependencies:[V.mk,V.O5,g],styles:['.button-with-point[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:-8px;left:50%;transform:translate(-50%);width:0;height:0;border-left:8px solid transparent;border-right:8px solid transparent;border-top:8px solid #ef4444}']})}}return h})();function xo(h,w){if(1&h&&(o.TgZ(0,"div",7)(1,"h3",31),o._uU(2),o.qZA(),o.TgZ(3,"div",32),o._UZ(4,"div",33),o.qZA()()),2&h){const r=o.oxw();o.xp6(2),o.Oqu(r.title)}}function ss(h,w){1&h&&o._UZ(0,"div",47)}function St(h,w){1&h&&(o.TgZ(0,"div",48)(1,"span",49),o._uU(2," \u25b6 "),o.qZA()())}function uo(h,w){1&h&&(o.TgZ(0,"div",11),o.O4$(),o.TgZ(1,"svg",50),o._UZ(2,"line",51),o.qZA(),o.kcU(),o.TgZ(3,"div",52)(4,"span",53),o._uU(5,"..."),o.qZA()()())}function ui(h,w){1&h&&(o.TgZ(0,"div",54),o.O4$(),o.TgZ(1,"svg",55),o._UZ(2,"path",56),o.TgZ(3,"defs")(4,"marker",57),o._UZ(5,"polygon",58),o.qZA()()(),o.kcU(),o.TgZ(6,"span",59),o._uU(7,"Bucle"),o.qZA()())}function _r(h,w){if(1&h&&(o.ynx(0),o.TgZ(1,"div",38),o.YNc(2,ss,1,0,"div",39),o.TgZ(3,"div",40)(4,"div")(5,"div",41)(6,"span",42),o._uU(7),o.qZA(),o.TgZ(8,"span",43),o._uU(9),o.qZA()()(),o.YNc(10,St,3,0,"div",44),o.qZA(),o.YNc(11,uo,6,0,"div",45),o.YNc(12,ui,8,0,"div",46),o.qZA(),o.BQk()),2&h){const r=o.oxw(),p=r.index,a=r.$implicit,_=o.oxw(2);o.xp6(2),o.Q6J("ngIf",p>0),o.xp6(2),o.Tol(_.getStepClass(a.type)),o.xp6(3),o.Oqu(_.getStepIcon(a.type)),o.xp6(2),o.Oqu(a.text),o.xp6(1),o.Q6J("ngIf",a.id===_.currentStepId),o.xp6(1),o.Q6J("ngIf",p===_.visibleSteps.length-1&&_.nextStepAvailable()),o.xp6(1),o.Q6J("ngIf",a.loopBack&&p===_.visibleSteps.length-1)}}function br(h,w){if(1&h){const r=o.EpF();o.O4$(),o.kcU(),o.TgZ(0,"button",70),o.NdJ("click",function(){o.CHM(r);const a=o.oxw(4);return o.KtG(a.chooseBranch("no"))}),o._uU(1,"No"),o.qZA()}}function st(h,w){1&h&&(o.TgZ(0,"div",48)(1,"span",49),o._uU(2," \u25b6 "),o.qZA()())}function ns(h,w){if(1&h){const r=o.EpF();o.O4$(),o.kcU(),o.TgZ(0,"button",71),o.NdJ("click",function(){o.CHM(r);const a=o.oxw(4);return o.KtG(a.chooseBranch("yes"))}),o._uU(1,"S\xed"),o.qZA()}}function di(h,w){if(1&h&&(o.ynx(0),o.TgZ(1,"div",60)(2,"div",38),o.O4$(),o.TgZ(3,"svg",61),o._UZ(4,"line",62),o.qZA(),o.YNc(5,br,2,0,"button",63),o.qZA(),o.kcU(),o.TgZ(6,"div",40)(7,"div",64)(8,"div",65)(9,"div",66),o._uU(10),o.qZA(),o.TgZ(11,"div",67),o._uU(12),o.qZA()()(),o.YNc(13,st,3,0,"div",44),o.qZA(),o.TgZ(14,"div",38),o.O4$(),o.TgZ(15,"svg",61),o._UZ(16,"line",68),o.qZA(),o.YNc(17,ns,2,0,"button",69),o.qZA()(),o.BQk()),2&h){const r=o.oxw(),p=r.index,a=r.$implicit,_=o.oxw(2);o.xp6(5),o.Q6J("ngIf",p===_.visibleSteps.length-1&&_.currentStepId===a.id),o.xp6(5),o.Oqu(_.getStepIcon(a.type)),o.xp6(2),o.Oqu(a.text),o.xp6(1),o.Q6J("ngIf",a.id===_.currentStepId),o.xp6(4),o.Q6J("ngIf",p===_.visibleSteps.length-1&&_.currentStepId===a.id)}}function gc(h,w){if(1&h&&(o.TgZ(0,"div",36),o.YNc(1,_r,13,8,"ng-container",37),o.YNc(2,di,18,5,"ng-container",37),o.qZA()),2&h){const r=w.$implicit,p=o.oxw(2);o.xp6(1),o.Q6J("ngIf",!p.isDecision(r.type)),o.xp6(1),o.Q6J("ngIf",p.isDecision(r.type))}}function ho(h,w){if(1&h&&(o.TgZ(0,"div",34),o.YNc(1,gc,3,2,"div",35),o.qZA()),2&h){const r=o.oxw();o.xp6(1),o.Q6J("ngForOf",r.visibleSteps)}}function rs(h,w){1&h&&(o.TgZ(0,"div",72)(1,"div",73),o._uU(2,"\u{1f680}"),o.qZA(),o.TgZ(3,"p",74),o._uU(4,"\xa1Comencemos el diagrama de flujo!"),o.qZA(),o.TgZ(5,"p",75),o._uU(6,'Presiona "Siguiente" para ver el primer paso'),o.qZA()())}function gn(h,w){1&h&&(o.TgZ(0,"div",76)(1,"div",77)(2,"div",78),o._uU(3,"\u{1f389}"),o.qZA(),o.TgZ(4,"p",79),o._uU(5,"\xa1Diagrama de flujo completado!"),o.qZA(),o.TgZ(6,"p",80),o._uU(7,"Has visualizado todos los pasos del proceso"),o.qZA()()())}let dt=(()=>{class h{constructor(){this.steps=[],this.title="",this.currentStepId=null,this.visibleSteps=[],this.history=[]}ngOnInit(){this.resetSteps()}ngOnChanges(r){r.steps&&this.steps&&this.resetSteps()}getStepById(r){return this.steps.find(p=>p.id===r)}resetSteps(){this.steps.length>0?(this.currentStepId=this.steps[0].id,this.history=[this.currentStepId],this.updateVisibleSteps()):(this.currentStepId=null,this.history=[],this.visibleSteps=[])}updateVisibleSteps(){this.visibleSteps=this.history.map(r=>this.getStepById(r)).filter(Boolean)}previousStep(){this.history.length>1&&(this.history.pop(),this.currentStepId=this.history[this.history.length-1],this.updateVisibleSteps())}nextStep(){if(!this.steps||0===this.steps.length||null===this.currentStepId)return;const r=this.getStepById(this.currentStepId);if(!r||"decision"===r.type)return;let p=null;if("number"==typeof r.next?p=r.next:"number"==typeof r.loopBack&&(p=r.loopBack),!p){const a=this.steps.findIndex(_=>_.id===this.currentStepId);a<this.steps.length-1&&(p=this.steps[a+1].id)}p&&(this.currentStepId=p,this.history.push(p),this.updateVisibleSteps())}chooseBranch(r){const p=this.getStepById(this.currentStepId);if(!p||"decision"!==p.type)return;const a=p.branches&&"number"==typeof p.branches[r]?p.branches[r]:null;a&&(this.currentStepId=a,this.history.push(a),this.updateVisibleSteps())}nextStepAvailable(){if(null===this.currentStepId)return!1;const r=this.getStepById(this.currentStepId);return!(!r||"decision"===r.type||"end"===r.type)&&("number"==typeof r.next||"number"==typeof r.loopBack||this.steps.findIndex(a=>a.id===this.currentStepId)<this.steps.length-1)}get canGoPrevious(){return this.history.length>1}get canReset(){return this.history.length>1}get progressText(){const r=this.getStepById(this.currentStepId);return r&&"end"===r.type?"Diagrama completado":`Paso ${this.visibleSteps.length} de ${this.steps.length}`}get progressPercentage(){if(0===this.steps.length)return 0;const r=this.getStepById(this.currentStepId);if(r&&"end"===r.type)return 100;const p=Math.round(this.visibleSteps.length/this.steps.length*100);return p>99?99:p}getStepClass(r){const p="inline-block p-3 rounded-lg shadow-md border-2 mb-3 mx-auto min-w-[150px] text-center transition-all duration-300 hover:shadow-lg";switch(r){case"start":case"end":return`${p} bg-green-100 border-green-400 text-green-800`;case"process":return`${p} bg-blue-100 border-blue-400 text-blue-800`;case"decision":return`${p} bg-yellow-100 border-yellow-400 text-yellow-800 transform rotate-45`;default:return`${p} bg-gray-100 border-gray-400 text-gray-800`}}getStepIcon(r){switch(r){case"start":return"\u{1f7e2}";case"process":return"\u{1f4e6}";case"decision":return"\u{1f914}";case"end":return"\u2705";default:return"\u{1f4dd}"}}isDecision(r){return"decision"===r}static{this.\u0275fac=function(p){return new(p||h)}}static{this.\u0275cmp=o.Xpm({type:h,selectors:[["app-flowchart"]],inputs:{steps:"steps",title:"title"},features:[o.TTD],decls:48,vars:29,consts:[[1,"flowchart-container","w-full","h-full","flex","flex-col"],[1,"flex-1","overflow-y-auto"],["class","text-center mb-4",4,"ngIf"],["class","flex flex-col items-center space-y-2 pb-6",4,"ngIf"],["class","text-center text-gray-500 py-8",4,"ngIf"],["class","text-center py-4",4,"ngIf"],[1,"mt-6","p-4","bg-gray-50","rounded-lg","border"],[1,"text-center","mb-4"],[1,"text-sm","font-bold","text-gray-700","mb-2"],[1,"flex","items-center","justify-center"],[1,"h-0.5","bg-gradient-to-r","from-transparent","via-blue-400","to-transparent","w-32"],[1,"flex","flex-col","items-center"],[1,"grid","grid-cols-2","gap-x-24","gap-y-3","text-xs","max-w-2xl"],[1,"flex","items-center","space-x-2"],[1,"w-4","h-4","bg-green-100","border","border-green-400","rounded"],[1,"w-4","h-4","bg-blue-100","border","border-blue-400","rounded"],[1,"w-4","h-4","bg-yellow-100","border","border-yellow-400","rounded","transform","rotate-45"],[1,"bg-white/90","backdrop-blur-sm","p-3","rounded-lg","border","border-gray-300","shadow-sm","mt-1","flex-shrink-0"],[1,"mb-3"],[1,"flex","justify-between","items-center","mb-1"],[1,"text-xs","font-medium","text-gray-700"],[1,"text-xs","font-medium","text-green-600"],[1,"w-full","bg-gray-200","rounded-full","h-1.5"],[1,"bg-gradient-to-r","from-blue-500","to-green-500","h-1.5","rounded-full","transition-all","duration-500","ease-in-out"],[1,"flex","justify-center","items-center","space-x-2"],[1,"w-8","h-8","text-white","rounded-full","shadow-md","hover:shadow-lg","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border","disabled:bg-gray-400","disabled:border-gray-300","disabled:hover:bg-gray-400",3,"disabled","click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[1,"px-3","py-1.5","text-xs","font-medium","text-white","bg-gray-500","rounded-md","shadow-md","hover:shadow-lg","transition-all","duration-300","ease-in-out","disabled:bg-gray-300","disabled:cursor-not-allowed",3,"disabled","click"],[1,"w-8","h-8","bg-blue-600","hover:bg-blue-700","text-white","rounded-full","shadow-md","hover:shadow-lg","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border","border-blue-800","disabled:bg-gray-400","disabled:border-gray-300","disabled:hover:bg-gray-400",3,"disabled","click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],[1,"text-lg","font-bold","text-gray-800"],[1,"flex","items-center","justify-center","mt-2"],[1,"h-0.5","bg-gradient-to-r","from-transparent","via-blue-400","to-transparent","w-64"],[1,"flex","flex-col","items-center","space-y-2","pb-6"],["class","step-animation w-full flex justify-center items-center relative",4,"ngFor","ngForOf"],[1,"step-animation","w-full","flex","justify-center","items-center","relative"],[4,"ngIf"],[1,"flex","flex-col","items-center","w-1/2"],["class","w-0.5 h-6 bg-gray-300 mb-2 mx-auto",4,"ngIf"],[1,"step-container","relative"],[1,"flex","items-center","justify-center","space-x-2"],[1,"text-lg"],[1,"font-medium"],["class","absolute -top-2 -right-2 z-10",4,"ngIf"],["class","flex flex-col items-center",4,"ngIf"],["class","flex flex-col items-center mt-2",4,"ngIf"],[1,"w-0.5","h-6","bg-gray-300","mb-2","mx-auto"],[1,"absolute","-top-2","-right-2","z-10"],[1,"inline-flex","items-center","justify-center","w-6","h-6","bg-green-500","text-white","text-xs","font-bold","rounded-full","animate-pulse"],["width","32","height","32",1,"mx-auto"],["x1","16","y1","0","x2","16","y2","32","stroke","#60a5fa","stroke-width","2","stroke-dasharray","4"],[1,"w-6","h-6","border-2","border-dashed","border-blue-400","rounded-full","flex","items-center","justify-center"],[1,"text-blue-400","text-xs","animate-pulse"],[1,"flex","flex-col","items-center","mt-2"],["width","60","height","40","viewBox","0 0 60 40",1,"mx-auto"],["d","M30 0 Q60 20 30 40 Q0 20 30 0","stroke","#3b82f6","stroke-width","2","fill","none","marker-end","url(#arrowhead)"],["id","arrowhead","markerWidth","6","markerHeight","6","refX","5","refY","3","orient","auto"],["points","0 0, 6 3, 0 6","fill","#3b82f6"],[1,"text-xs","text-blue-600","font-bold"],[1,"flex","flex-row","items-center","w-full","justify-center"],["width","60","height","32",1,"mb-2"],["x1","60","y1","16","x2","0","y2","16","stroke","#f87171","stroke-width","2"],["class","px-4 py-2 bg-red-500 text-white rounded shadow hover:bg-red-600 font-bold",3,"click",4,"ngIf"],[1,"w-32","h-32","bg-yellow-100","border-2","border-yellow-400","transform","rotate-45","flex","items-center","justify-center","mx-auto"],[1,"transform","-rotate-45","text-center"],[1,"text-lg","mb-1"],[1,"text-xs","font-medium","text-yellow-800","leading-tight"],["x1","0","y1","16","x2","60","y2","16","stroke","#34d399","stroke-width","2"],["class","px-4 py-2 bg-green-500 text-white rounded shadow hover:bg-green-600 font-bold",3,"click",4,"ngIf"],[1,"px-4","py-2","bg-red-500","text-white","rounded","shadow","hover:bg-red-600","font-bold",3,"click"],[1,"px-4","py-2","bg-green-500","text-white","rounded","shadow","hover:bg-green-600","font-bold",3,"click"],[1,"text-center","text-gray-500","py-8"],[1,"text-6xl","mb-4"],[1,"text-lg","font-medium"],[1,"text-sm"],[1,"text-center","py-4"],[1,"bg-green-50","border","border-green-200","rounded-lg","p-4"],[1,"text-4xl","mb-2"],[1,"text-green-800","font-medium"],[1,"text-green-600","text-sm"]],template:function(p,a){1&p&&(o.TgZ(0,"div",0)(1,"div",1),o.YNc(2,xo,5,1,"div",2),o.YNc(3,ho,2,1,"div",3),o.YNc(4,rs,7,0,"div",4),o.YNc(5,gn,8,0,"div",5),o.TgZ(6,"div",6)(7,"div",7)(8,"h4",8),o._uU(9,"Leyenda"),o.qZA(),o.TgZ(10,"div",9),o._UZ(11,"div",10),o.qZA()(),o.TgZ(12,"div",11)(13,"div",12)(14,"div",13),o._UZ(15,"div",14),o.TgZ(16,"span"),o._uU(17,"\u{1f7e2} Inicio/Fin"),o.qZA()(),o.TgZ(18,"div",13),o._UZ(19,"div",15),o.TgZ(20,"span"),o._uU(21,"\u{1f4e6} Proceso"),o.qZA()(),o.TgZ(22,"div",13),o._UZ(23,"div",16),o.TgZ(24,"span"),o._uU(25,"\u{1f914} Decisi\xf3n"),o.qZA()(),o.TgZ(26,"div",13),o._UZ(27,"div",14),o.TgZ(28,"span"),o._uU(29,"\u2705 Final"),o.qZA()()()()()(),o.TgZ(30,"div",17)(31,"div",18)(32,"div",19)(33,"span",20),o._uU(34),o.qZA(),o.TgZ(35,"span",21),o._uU(36),o.qZA()(),o.TgZ(37,"div",22),o._UZ(38,"div",23),o.qZA()(),o.TgZ(39,"div",24)(40,"button",25),o.NdJ("click",function(){return a.previousStep()}),o.O4$(),o.TgZ(41,"svg",26),o._UZ(42,"path",27),o.qZA()(),o.kcU(),o.TgZ(43,"button",28),o.NdJ("click",function(){return a.resetSteps()}),o._uU(44," \u{1f504} Reiniciar "),o.qZA(),o.TgZ(45,"button",29),o.NdJ("click",function(){return a.nextStep()}),o.O4$(),o.TgZ(46,"svg",26),o._UZ(47,"path",30),o.qZA()()()()()),2&p&&(o.xp6(2),o.Q6J("ngIf",a.title),o.xp6(1),o.Q6J("ngIf",a.visibleSteps.length>0),o.xp6(1),o.Q6J("ngIf",0===a.visibleSteps.length&&a.steps.length>0),o.xp6(1),o.Q6J("ngIf",!a.nextStepAvailable()&&a.visibleSteps.length>0),o.xp6(29),o.Oqu(a.progressText),o.xp6(2),o.hij("",a.progressPercentage,"%"),o.xp6(2),o.Udp("width",a.progressPercentage,"%"),o.xp6(2),o.Udp("background-color",a.canGoPrevious?"#f3ae22":"")("border-color",a.canGoPrevious?"#d18c00":""),o.ekj("opacity-50",!a.canGoPrevious)("cursor-not-allowed",!a.canGoPrevious),o.Q6J("disabled",!a.canGoPrevious),o.xp6(3),o.ekj("opacity-50",!a.canReset)("cursor-not-allowed",!a.canReset)("hover:bg-gray-600",a.canReset),o.Q6J("disabled",!a.canReset),o.xp6(2),o.ekj("opacity-50",!a.nextStepAvailable())("cursor-not-allowed",!a.nextStepAvailable()),o.Q6J("disabled",!a.nextStepAvailable()))},dependencies:[V.sg,V.O5],styles:[".flowchart-container[_ngcontent-%COMP%]{font-family:Inter,sans-serif;display:flex;flex-direction:column;height:100%;max-height:100%}.flex-1[_ngcontent-%COMP%]{flex:1;min-height:0}.flex-shrink-0[_ngcontent-%COMP%]{flex-shrink:0}.overflow-y-auto[_ngcontent-%COMP%]{scroll-behavior:smooth}.step-container[_ngcontent-%COMP%]{position:relative;z-index:1}.step-container[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{transition:all .3s cubic-bezier(.4,0,.2,1);box-shadow:0 2px 8px #00000012}.step-container[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:hover{transform:scale(1.07);z-index:10;box-shadow:0 6px 24px #0000001f}.decision-diamond[_ngcontent-%COMP%], .w-32.h-32[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fef3c7,#fde68a);box-shadow:0 4px 12px -1px #00000014;border-radius:12px}.flow-connector[_ngcontent-%COMP%], .bg-gray-300[_ngcontent-%COMP%], .bg-gray-400[_ngcontent-%COMP%]{background:linear-gradient(to bottom,#dbeafe,#60a5fa)}@keyframes _ngcontent-%COMP%_stepAppear{0%{opacity:0;transform:translateY(-20px) scale(.8)}50%{opacity:.7;transform:translateY(-5px) scale(1.1)}to{opacity:1;transform:translateY(0) scale(1)}}.step-animation[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_stepAppear .5s cubic-bezier(.4,0,.2,1)}@keyframes _ngcontent-%COMP%_drawLine{0%{stroke-dasharray:0,100;opacity:0}to{stroke-dasharray:100,0;opacity:1}}.animate-draw-line[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_drawLine .4s ease-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:scale(.5)}to{opacity:1;transform:scale(1)}}.animate-fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-out}@keyframes _ngcontent-%COMP%_gentlePulse{0%,to{transform:scale(1);opacity:1}50%{transform:scale(1.1);opacity:.8}}.animate-pulse[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_gentlePulse 2s ease-in-out infinite}.step-nav-button[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 25px #00000026}.progress-bar[_ngcontent-%COMP%]{background:linear-gradient(90deg,#3b82f6,#10b981);background-size:200% 100%;animation:_ngcontent-%COMP%_gradientShift 3s ease infinite}@keyframes _ngcontent-%COMP%_gradientShift{0%{background-position:0% 50%}50%{background-position:100% 50%}to{background-position:0% 50%}}@media (max-width: 768px){.step-container[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{min-width:120px;padding:.5rem;font-size:.875rem}.decision-diamond[_ngcontent-%COMP%]{width:100px!important;height:100px!important}.step-nav-button[_ngcontent-%COMP%]{width:2.5rem;height:2.5rem}}.legend-item[_ngcontent-%COMP%]{transition:background-color .2s ease}.legend-item[_ngcontent-%COMP%]:hover{background-color:#3b82f61a}.flowchart-shadow[_ngcontent-%COMP%]{filter:drop-shadow(0 4px 6px rgba(0,0,0,.1))}.completion-celebration[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_celebrate .8s ease-out}@keyframes _ngcontent-%COMP%_celebrate{0%{transform:scale(1)}25%{transform:scale(1.1) rotate(5deg)}50%{transform:scale(1.2) rotate(-5deg)}75%{transform:scale(1.1) rotate(2deg)}to{transform:scale(1) rotate(0)}}.status-message[_ngcontent-%COMP%]{transition:all .5s ease-in-out}.control-panel[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);background:rgba(255,255,255,.9);border:1px solid rgba(0,0,0,.1)}.continuation-indicator[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_bounce 2s ease-in-out infinite}@keyframes _ngcontent-%COMP%_bounce{0%,20%,50%,80%,to{transform:translateY(0)}40%{transform:translateY(-5px)}60%{transform:translateY(-3px)}}"]})}}return h})();var ls=ce(3329);const{Variables:mi,dialog:_i,inject:gs}=ls;let Gt=(()=>{class h{constructor(){this.workspace=null}initializeWorkspace(r){const p={toolbox:this.getVariablesToolbox(),collapse:!0,comments:!0,disable:!0,maxBlocks:1/0,trashcan:!0,horizontalLayout:!1,toolboxPosition:"start",css:!0,media:"https://unpkg.com/blockly/media/",rtl:!1,scrollbars:!0,sounds:!0,oneBasedIndex:!0,grid:{spacing:20,length:3,colour:"#ccc",snap:!0},zoom:{controls:!0,wheel:!0,startScale:1,maxScale:3,minScale:.3,scaleSpeed:1.2}};return this.workspace=gs(r,p),this.workspace&&(this.workspace.getVariableMap().createVariable("item"),console.log('Variable por defecto "item" creada')),this.workspace}getVariablesToolbox(){let r="";return r+='\n        <block type="variables_set">\n          <field name="VAR">item</field>\n        </block>\n        <block type="variables_get">\n          <field name="VAR">item</field>\n        </block>',this.workspace&&this.workspace.getAllVariables().forEach(a=>{const _=a.getName();"item"!==_&&(r+=`\n          <block type="variables_set">\n            <field name="VAR">${_}</field>\n          </block>\n          <block type="variables_get">\n            <field name="VAR">${_}</field>\n          </block>`)}),`\n    <xml xmlns="https://developers.google.com/blockly/xml" id="toolbox" style="display: none">\n      <category name="Variables" colour="#a55b5b">\n        ${r}\n        <button text="Crear variable..." callbackKey="CREATE_VARIABLE"></button>\n      </category>\n      <category name="L\xf3gica" colour="#5b80a5">\n        <block type="logic_boolean">\n          <field name="BOOL">TRUE</field>\n        </block>\n        <block type="logic_boolean">\n          <field name="BOOL">FALSE</field>\n        </block>\n        <block type="logic_compare">\n          <field name="OP">EQ</field>\n        </block>\n        <block type="logic_compare">\n          <field name="OP">NEQ</field>\n        </block>\n        <block type="logic_compare">\n          <field name="OP">GT</field>\n        </block>\n        <block type="logic_compare">\n          <field name="OP">GTE</field>\n        </block>\n        <block type="logic_compare">\n          <field name="OP">LT</field>\n        </block>\n        <block type="logic_compare">\n          <field name="OP">LTE</field>\n        </block>\n        <block type="logic_operation">\n          <field name="OP">AND</field>\n        </block>\n        <block type="logic_operation">\n          <field name="OP">OR</field>\n        </block>\n        <block type="logic_negate"></block>\n      </category>\n      <category name="Control" colour="#e1a91a">\n        <block type="controls_if"></block>\n        <block type="controls_if">\n          <mutation else="1"></mutation>\n        </block>\n        <block type="controls_if">\n          <mutation elseif="1" else="1"></mutation>\n        </block>\n      </category>\n      <category name="Bucles" colour="#5ba58c">\n        <block type="controls_repeat_ext">\n          <value name="TIMES">\n            <shadow type="math_number">\n              <field name="NUM">10</field>\n            </shadow>\n          </value>\n        </block>\n        <block type="controls_whileUntil">\n          <field name="MODE">WHILE</field>\n        </block>\n        <block type="controls_whileUntil">\n          <field name="MODE">UNTIL</field>\n        </block>\n        <block type="controls_for">\n          <field name="VAR">i</field>\n          <value name="FROM">\n            <shadow type="math_number">\n              <field name="NUM">1</field>\n            </shadow>\n          </value>\n          <value name="TO">\n            <shadow type="math_number">\n              <field name="NUM">10</field>\n            </shadow>\n          </value>\n          <value name="BY">\n            <shadow type="math_number">\n              <field name="NUM">1</field>\n            </shadow>\n          </value>\n        </block>\n        <block type="controls_forEach">\n          <field name="VAR">j</field>\n        </block>\n        <block type="controls_flow_statements">\n          <field name="FLOW">BREAK</field>\n        </block>\n        <block type="controls_flow_statements">\n          <field name="FLOW">CONTINUE</field>\n        </block>\n      </category>\n      <category name="Matem\xe1ticas" colour="#5b5ba5">\n        <block type="math_number">\n          <field name="NUM">0</field>\n        </block>\n        <block type="math_arithmetic">\n          <field name="OP">ADD</field>\n        </block>\n        <block type="math_arithmetic">\n          <field name="OP">MINUS</field>\n        </block>\n        <block type="math_arithmetic">\n          <field name="OP">MULTIPLY</field>\n        </block>\n        <block type="math_arithmetic">\n          <field name="OP">DIVIDE</field>\n        </block>\n        <block type="math_single">\n          <field name="OP">ROOT</field>\n        </block>\n        <block type="math_single">\n          <field name="OP">ABS</field>\n        </block>\n        <block type="math_single">\n          <field name="OP">NEG</field>\n        </block>\n        <block type="math_single">\n          <field name="OP">LN</field>\n        </block>\n        <block type="math_single">\n          <field name="OP">LOG10</field>\n        </block>\n        <block type="math_single">\n          <field name="OP">EXP</field>\n        </block>\n        <block type="math_single">\n          <field name="OP">POW10</field>\n        </block>\n        <block type="math_trig">\n          <field name="OP">SIN</field>\n        </block>\n        <block type="math_trig">\n          <field name="OP">COS</field>\n        </block>\n        <block type="math_trig">\n          <field name="OP">TAN</field>\n        </block>\n        <block type="math_constant">\n          <field name="CONSTANT">PI</field>\n        </block>\n        <block type="math_constant">\n          <field name="CONSTANT">E</field>\n        </block>\n        <block type="math_constant">\n          <field name="CONSTANT">GOLDEN_RATIO</field>\n        </block>\n        <block type="math_number_property">\n          <mutation divisor_input="false"></mutation>\n          <field name="PROPERTY">EVEN</field>\n        </block>\n        <block type="math_round">\n          <field name="OP">ROUND</field>\n        </block>\n        <block type="math_on_list">\n          <mutation op="SUM"></mutation>\n          <field name="OP">SUM</field>\n        </block>\n        <block type="math_modulo"></block>\n        <block type="math_constrain">\n          <value name="LOW">\n            <shadow type="math_number">\n              <field name="NUM">1</field>\n            </shadow>\n          </value>\n          <value name="HIGH">\n            <shadow type="math_number">\n              <field name="NUM">100</field>\n            </shadow>\n          </value>\n        </block>\n        <block type="math_random_int">\n          <value name="FROM">\n            <shadow type="math_number">\n              <field name="NUM">1</field>\n            </shadow>\n          </value>\n          <value name="TO">\n            <shadow type="math_number">\n              <field name="NUM">100</field>\n            </shadow>\n          </value>\n        </block>\n        <block type="math_random_float"></block>\n      </category>\n      <category name="Texto" colour="#5ba55b">\n        <block type="text">\n          <field name="TEXT"></field>\n        </block>\n        <block type="text_join">\n          <mutation items="2"></mutation>\n        </block>\n        <block type="text_append">\n          <field name="VAR">item</field>\n        </block>\n        <block type="text_length"></block>\n        <block type="text_isEmpty"></block>\n        <block type="text_indexOf">\n          <field name="END">FIRST</field>\n          <value name="VALUE">\n            <block type="variables_get">\n              <field name="VAR">texto</field>\n            </block>\n          </value>\n        </block>\n        <block type="text_charAt">\n          <mutation at="true"></mutation>\n          <field name="WHERE">FROM_START</field>\n          <value name="VALUE">\n            <block type="variables_get">\n              <field name="VAR">texto</field>\n            </block>\n          </value>\n        </block>\n        <block type="text_getSubstring">\n          <mutation at1="true" at2="true"></mutation>\n          <field name="WHERE1">FROM_START</field>\n          <field name="WHERE2">FROM_START</field>\n          <value name="STRING">\n            <block type="variables_get">\n              <field name="VAR">texto</field>\n            </block>\n          </value>\n        </block>\n        <block type="text_changeCase">\n          <field name="CASE">UPPERCASE</field>\n        </block>\n        <block type="text_trim">\n          <field name="MODE">BOTH</field>\n        </block>\n        <block type="text_print">\n          <value name="TEXT">\n            <shadow type="text">\n              <field name="TEXT">abc</field>\n            </shadow>\n          </value>\n        </block>\n        <block type="text_prompt_ext">\n          <mutation type="TEXT"></mutation>\n          <field name="TYPE">TEXT</field>\n          <value name="TEXT">\n            <shadow type="text">\n              <field name="TEXT">abc</field>\n            </shadow>\n          </value>\n        </block>\n      </category>\n      <category name="Salida" colour="#745ba5">\n        <block type="text_print">\n          <value name="TEXT">\n            <shadow type="text">\n              <field name="TEXT">abc</field>\n            </shadow>\n          </value>\n        </block>\n      </category>\n      <category name="Listas" colour="#745ba5">\n        <block type="lists_create_with">\n          <mutation items="0"></mutation>\n        </block>\n        <block type="lists_create_with">\n          <mutation items="3"></mutation>\n        </block>\n        <block type="lists_repeat">\n          <value name="NUM">\n            <shadow type="math_number">\n              <field name="NUM">5</field>\n            </shadow>\n          </value>\n        </block>\n        <block type="lists_length"></block>\n        <block type="lists_isEmpty"></block>\n        <block type="lists_indexOf">\n          <field name="END">FIRST</field>\n          <value name="VALUE">\n            <block type="variables_get">\n              <field name="VAR">lista</field>\n            </block>\n          </value>\n        </block>\n        <block type="lists_getIndex">\n          <mutation statement="false" at="true"></mutation>\n          <field name="MODE">GET</field>\n          <field name="WHERE">FROM_START</field>\n          <value name="VALUE">\n            <block type="variables_get">\n              <field name="VAR">lista</field>\n            </block>\n          </value>\n        </block>\n        <block type="lists_setIndex">\n          <mutation at="true"></mutation>\n          <field name="MODE">SET</field>\n          <field name="WHERE">FROM_START</field>\n          <value name="LIST">\n            <block type="variables_get">\n              <field name="VAR">lista</field>\n            </block>\n          </value>\n        </block>\n        <block type="lists_getSublist">\n          <mutation at1="true" at2="true"></mutation>\n          <field name="WHERE1">FROM_START</field>\n          <field name="WHERE2">FROM_START</field>\n          <value name="LIST">\n            <block type="variables_get">\n              <field name="VAR">lista</field>\n            </block>\n          </value>\n        </block>\n        <block type="lists_split">\n          <mutation mode="SPLIT"></mutation>\n          <field name="MODE">SPLIT</field>\n          <value name="DELIM">\n            <shadow type="text">\n              <field name="TEXT">,</field>\n            </shadow>\n          </value>\n        </block>\n        <block type="lists_sort">\n          <field name="TYPE">NUMERIC</field>\n          <field name="DIRECTION">1</field>\n        </block>\n      </category>\n      <category name="Funciones" colour="#9a5ba5" custom="PROCEDURE">\n      </category>\n    </xml>\n    `}generateCode(){if(!this.workspace)return"";const r=this.workspace.getTopBlocks(!0);let p="";return console.log("Bloques encontrados:",r.length),r.forEach((a,_)=>{console.log("Procesando cadena de bloques iniciando con:",a.type);let S=a,H="";for(;S;){console.log("Bloque en cadena:",S.type);const W=this.blockToCode(S);W&&(H&&(H+="\n"),H+=W),S=S.getNextBlock()}H&&(p&&(p+="\n"),p+=H)}),console.log("C\xf3digo generado completo:",p),p}blockToCode(r){switch(console.log("Procesando bloque:",r.type),r.type){case"variables_set":const p=r.getFieldValue("VAR"),a=this.workspace.getVariableById(p),_=a?a.getName():p,S=r.getInputTargetBlock("VALUE"),H=S?this.getBlockValue(S):"";return console.log("Variables_set - ID:",p,"Nombre real:",_,"Valor:",H),`var ${_} = ${H};`;case"procedures_defreturn":const W=r.getFieldValue("NAME"),nt=(r.getVars?r.getVars():[]).join(", ");let qt="";const vi=r.getInputTargetBlock("STACK");if(vi){let Z=vi;for(;Z;){const z=this.blockToCode(Z);z&&(qt+=(qt?"\n  ":"  ")+z),Z=Z.getNextBlock()}}const Lo=r.getInputTargetBlock("RETURN");let yi="";return Lo&&(yi=this.getBlockValue(Lo),qt+=(qt?"\n  ":"  ")+`return ${yi};`),`function ${W}(${nt}) {\n${qt}\n}`;case"procedures_defnoreturn":const At=r.getFieldValue("NAME"),Es=(r.getVars?r.getVars():[]).join(", ");let Do="";const Ci=r.getInputTargetBlock("STACK");if(Ci){let Z=Ci;for(;Z;){const z=this.blockToCode(Z);z&&(Do+=(Do?"\n  ":"  ")+z),Z=Z.getNextBlock()}}return`function ${At}(${Es}) {\n${Do}\n}`;case"procedures_callreturn":const vs=r.getFieldValue("NAME"),Ii=[];if(r.inputList)for(let Z=0;Z<r.inputList.length;Z++){const z=r.inputList[Z];if(z.name&&z.connection){const Ue=z.connection.targetBlock();Ue&&Ii.push(this.getBlockValue(Ue))}}return`${vs}(${Ii.join(", ")})`;case"procedures_callnoreturn":const xi=r.getFieldValue("NAME"),ki=[];if(r.inputList)for(let Z=0;Z<r.inputList.length;Z++){const z=r.inputList[Z];if(z.name&&z.connection){const Ue=z.connection.targetBlock();Ue&&ki.push(this.getBlockValue(Ue))}}return`${xi}(${ki.join(", ")});`;case"math_number":const sl=r.getFieldValue("NUM");return console.log("Math_number:",sl),sl;case"text":const ys=r.getFieldValue("TEXT");return console.log("Text:",ys),`"${ys}"`;case"logic_boolean":const nl=r.getFieldValue("BOOL").toLowerCase();return console.log("Logic_boolean:",nl),nl;case"math_arithmetic":const Ta=r.getFieldValue("OP"),wn=r.getInputTargetBlock("A"),bt=r.getInputTargetBlock("B"),rl=wn?this.getBlockValue(wn):"0",ll=bt?this.getBlockValue(bt):"0";let ft="+";switch(Ta){case"ADD":ft="+";break;case"MINUS":ft="-";break;case"MULTIPLY":ft="*";break;case"DIVIDE":ft="/"}return console.log("Math_arithmetic - A:",rl,"Op:",ft,"B:",ll),`${rl} ${ft} ${ll}`;case"variables_get":const cl=r.getFieldValue("VAR");return console.log("Variables_get:",cl),cl;case"text_join":const Cs=[];for(let Z=0;Z<r.inputList.length;Z++){const z=r.inputList[Z];if(1===z.type){const Ue=z.connection?.targetBlock();Ue&&Cs.push(this.getBlockValue(Ue))}}return console.log("Text_join - inputs:",Cs),Cs.join(" + ");case"text_print":const Is=r.getInputTargetBlock("TEXT"),al=Is?this.getBlockValue(Is):'""';return console.log("Text_print - value:",al),`print(${al});`;case"logic_compare":const Ea=r.getFieldValue("OP"),ul=r.getInputTargetBlock("A"),Sn=r.getInputTargetBlock("B"),xs=ul?this.getBlockValue(ul):"",An=Sn?this.getBlockValue(Sn):"";let Tt="==";switch(Ea){case"EQ":Tt="==";break;case"NEQ":Tt="!=";break;case"LT":Tt="<";break;case"LTE":Tt="<=";break;case"GT":Tt=">";break;case"GTE":Tt=">="}return console.log("Logic_compare - A:",xs,"Op:",Tt,"B:",An),`${xs} ${Tt} ${An}`;case"logic_operation":const va=r.getFieldValue("OP"),dl=r.getInputTargetBlock("A"),hl=r.getInputTargetBlock("B"),pl=dl?this.getBlockValue(dl):"",L=hl?this.getBlockValue(hl):"";let Ne="&&";switch(va){case"AND":Ne="&&";break;case"OR":Ne="||"}return console.log("Logic_operation - A:",pl,"Op:",Ne,"B:",L),`${pl} ${Ne} ${L}`;case"logic_negate":const Ie=r.getInputTargetBlock("BOOL"),ae=Ie?this.getBlockValue(Ie):"";return console.log("Logic_negate - value:",ae),`!(${ae})`;case"controls_if":let rt="",Po=r.getInputTargetBlock("IF0");const B=Po?this.getBlockValue(Po):"";let pe=r.getInputTargetBlock("DO0"),Rn="";if(pe){let Z=pe;for(;Z;){const z=this.blockToCode(Z);z&&(Rn+=(Rn?"\n  ":"  ")+z),Z=Z.getNextBlock()}}rt=`if (${B}) {\n${Rn}\n}`;const gl=r.getInputTargetBlock("ELSE");if(gl){let Z="",z=gl;for(;z;){const Ue=this.blockToCode(z);Ue&&(Z+=(Z?"\n  ":"  ")+Ue),z=z.getNextBlock()}rt+=` else {\n${Z}\n}`}return console.log("Controls_if - condition:",B,"code:",rt),rt;case"controls_repeat_ext":const $l=r.getInputTargetBlock("TIMES"),ks=$l?this.getBlockValue($l):"10";let On=r.getInputTargetBlock("DO"),wi="";if(On){let Z=On;for(;Z;){const z=this.blockToCode(Z);z&&(wi+=(wi?"\n  ":"  ")+z),Z=Z.getNextBlock()}}const Mn=`for (let i = 0; i < ${ks}; i++) {\n${wi}\n}`;return console.log("Controls_repeat_ext - times:",ks,"code:",Mn),Mn;case"controls_whileUntil":const Nn=r.getFieldValue("MODE"),Ln=r.getInputTargetBlock("BOOL"),Dn=Ln?this.getBlockValue(Ln):"false";let Bo=r.getInputTargetBlock("DO"),ws="";if(Bo){let Z=Bo;for(;Z;){const z=this.blockToCode(Z);z&&(ws+=(ws?"\n  ":"  ")+z),Z=Z.getNextBlock()}}const ml="WHILE"===Nn?Dn:`!(${Dn})`,ya=`while (${ml}) {\n${ws}\n}`;return console.log("Controls_whileUntil - mode:",Nn,"condition:",ml),ya;case"controls_for":const Rt=r.getFieldValue("VAR"),Pn=r.getInputTargetBlock("FROM"),_l=r.getInputTargetBlock("TO"),Ss=r.getInputTargetBlock("BY"),Xe=Pn?this.getBlockValue(Pn):"1",Bn=_l?this.getBlockValue(_l):"10",po=Ss?this.getBlockValue(Ss):"1";let lt=r.getInputTargetBlock("DO"),zt="";if(lt){let Z=lt;for(;Z;){const z=this.blockToCode(Z);z&&(zt+=(zt?"\n  ":"  ")+z),Z=Z.getNextBlock()}}const Fn=`for (let ${Rt} = ${Xe}; ${Rt} <= ${Bn}; ${Rt} += ${po}) {\n${zt}\n}`;return console.log("Controls_for - var:",Rt,"from:",Xe,"to:",Bn,"by:",po),Fn;case"math_single":const Un=r.getFieldValue("OP"),bl=r.getInputTargetBlock("NUM"),We=bl?this.getBlockValue(bl):"0";let ct="";switch(Un){case"ROOT":ct=`Math.sqrt(${We})`;break;case"ABS":ct=`Math.abs(${We})`;break;case"NEG":ct=`-(${We})`;break;case"LN":ct=`Math.log(${We})`;break;case"LOG10":ct=`Math.log10(${We})`;break;case"EXP":ct=`Math.exp(${We})`;break;case"POW10":ct=`Math.pow(10, ${We})`}return console.log("Math_single - op:",Un,"result:",ct),ct;case"math_trig":const Si=r.getFieldValue("OP"),Hn=r.getInputTargetBlock("NUM"),Fo=Hn?this.getBlockValue(Hn):"0";let Ot="";switch(Si){case"SIN":Ot=`Math.sin(${Fo})`;break;case"COS":Ot=`Math.cos(${Fo})`;break;case"TAN":Ot=`Math.tan(${Fo})`;break;case"ASIN":Ot=`Math.asin(${Fo})`;break;case"ACOS":Ot=`Math.acos(${Fo})`;break;case"ATAN":Ot=`Math.atan(${Fo})`}return console.log("Math_trig - op:",Si,"result:",Ot),Ot;case"math_constant":const fl=r.getFieldValue("CONSTANT");let Et="";switch(fl){case"PI":Et="Math.PI";break;case"E":Et="Math.E";break;case"GOLDEN_RATIO":Et="1.618033988749895";break;case"SQRT2":Et="Math.SQRT2";break;case"SQRT1_2":Et="Math.SQRT1_2";break;case"INFINITY":Et="Infinity"}return console.log("Math_constant - constant:",fl,"result:",Et),Et;case"math_random_int":const Zn=r.getInputTargetBlock("FROM"),Vn=r.getInputTargetBlock("TO"),As=Zn?this.getBlockValue(Zn):"1",Tl=Vn?this.getBlockValue(Vn):"100",El=`Math.floor(Math.random() * (${Tl} - ${As} + 1)) + ${As}`;return console.log("Math_random_int - from:",As,"to:",Tl),El;case"math_random_float":return console.log("Math_random_float"),"Math.random()";case"lists_create_with":const Gn=[];for(let Z=0;Z<r.inputList.length;Z++){const z=r.inputList[Z];if(1===z.type){const Ue=z.connection?.targetBlock();Ue&&Gn.push(this.getBlockValue(Ue))}}const Rs=`[${Gn.join(", ")}]`;return console.log("Lists_create_with - items:",Gn),Rs;case"lists_length":const Wn=r.getInputTargetBlock("VALUE"),qn=Wn?this.getBlockValue(Wn):"[]",Os=`${qn}.length`;return console.log("Lists_length - list:",qn),Os;case"text_length":const vl=r.getInputTargetBlock("VALUE"),zn=vl?this.getBlockValue(vl):'""',Ms=`${zn}.length`;return console.log("Text_length - text:",zn),Ms;case"text_isEmpty":const Ai=r.getInputTargetBlock("VALUE"),Ri=Ai?this.getBlockValue(Ai):'""',jn=`${Ri}.length === 0`;return console.log("Text_isEmpty - text:",Ri),jn;default:return console.log("Bloque no reconocido:",r.type),""}}getBlockValue(r){switch(console.log("getBlockValue called for block type:",r.type),r.type){case"math_number":const p=r.getFieldValue("NUM");return console.log("Math_number value:",p),p;case"text":const a=r.getFieldValue("TEXT");return console.log("Text value:",a),`"${a}"`;case"logic_boolean":const _=r.getFieldValue("BOOL").toLowerCase();return console.log("Logic_boolean value:",_),_;case"variables_get":const S=r.getFieldValue("VAR"),H=this.workspace.getVariableById(S),W=H?H.getName():S;return console.log("Variables_get - ID:",S,"Nombre real:",W),W;case"math_arithmetic":const Wt=this.blockToCode(r);return console.log("Math_arithmetic value:",Wt),Wt;case"logic_compare":const nt=this.blockToCode(r);return console.log("Logic_compare value:",nt),nt;case"logic_operation":const qt=this.blockToCode(r);return console.log("Logic_operation value:",qt),qt;case"logic_negate":const vi=this.blockToCode(r);return console.log("Logic_negate value:",vi),vi;case"text_join":const Lo=this.blockToCode(r);return console.log("Text_join value:",Lo),Lo;case"math_single":const yi=this.blockToCode(r);return console.log("Math_single value:",yi),yi;case"math_trig":const At=this.blockToCode(r);return console.log("Math_trig value:",At),At;case"math_constant":const Ts=this.blockToCode(r);return console.log("Math_constant value:",Ts),Ts;case"math_random_int":const Es=this.blockToCode(r);return console.log("Math_random_int value:",Es),Es;case"math_random_float":const Do=this.blockToCode(r);return console.log("Math_random_float value:",Do),Do;case"lists_create_with":const Ci=this.blockToCode(r);return console.log("Lists_create_with value:",Ci),Ci;case"lists_length":const vs=this.blockToCode(r);return console.log("Lists_length value:",vs),vs;case"text_length":const Ii=this.blockToCode(r);return console.log("Text_length value:",Ii),Ii;case"text_isEmpty":const xi=this.blockToCode(r);return console.log("Text_isEmpty value:",xi),xi;default:const ki=this.blockToCode(r);return console.log("Default case - block type:",r.type,"value:",ki),ki}}clearWorkspace(){this.workspace&&this.workspace.clear()}getWorkspace(){return this.workspace}dispose(){this.workspace&&(this.workspace.dispose(),this.workspace=null)}validateCode(r,p){console.log("=== VALIDACI\xd3N DE C\xd3DIGO ==="),console.log("C\xf3digo generado original:",JSON.stringify(r)),console.log("C\xf3digo esperado original:",JSON.stringify(p));const a=this.normalizeForComparison(r),_=this.normalizeForComparison(p);console.log("C\xf3digo generado normalizado:",JSON.stringify(a)),console.log("C\xf3digo esperado normalizado:",JSON.stringify(_));const S=a===_;console.log("Comparaci\xf3n normalizada:",S);const H=this.flexibleCodeComparison(r,p);console.log("Comparaci\xf3n flexible:",H);const W=S||H;return console.log("Resultado final de validaci\xf3n:",W),console.log("=== FIN VALIDACI\xd3N ==="),W}normalizeForComparison(r){return r.replace(/\bvar\b/g,"let").replace(/\s+/g," ").replace(/;\s*}/g," }").replace(/;\s*$/gm,"").replace(/'/g,'"').replace(/\s*([+\-*/%=<>!&|])\s*/g," $1 ").replace(/\s*([{}();,])\s*/g,"$1").trim().toLowerCase()}flexibleCodeComparison(r,p){const a=r.split("\n").map(S=>S.trim()).filter(S=>S.length>0),_=p.split("\n").map(S=>S.trim()).filter(S=>S.length>0);if(a.length!==_.length)return console.log(`Diferente n\xfamero de l\xedneas: generado ${a.length}, esperado ${_.length}`),!1;for(let S=0;S<a.length;S++){const H=this.normalizeCodeLine(a[S]),W=this.normalizeCodeLine(_[S]);if(H!==W)return console.log(`L\xednea ${S+1} no coincide:`),console.log("  Generada:",a[S]),console.log("  Esperada:",_[S]),console.log("  Gen normalizada:",H),console.log("  Esp normalizada:",W),!1}return!0}normalizeCodeLine(r){return r.replace(/\bvar\b/g,"let").replace(/\s+/g," ").replace(/;$/,"").replace(/'/g,'"').replace(/\s*([=!<>]+)\s*/g," $1 ").replace(/\s*([+\-*/%])\s*/g," $1 ").trim().toLowerCase()}setupCallbacks(r){this.workspace&&this.workspace.registerButtonCallback("CREATE_VARIABLE",()=>{console.log("Bot\xf3n crear variable presionado"),r?r.showCreateVariableDialog(p=>{this.createVariable(p)}):mi.createVariableButtonHandler(this.workspace)})}createVariable(r){if(!this.workspace||!r.trim())return null;try{const p=this.workspace.getVariableMap().createVariable(r.trim());return console.log("Variable creada con nueva API:",r),setTimeout(()=>{this.refreshToolbox()},100),p}catch(p){return console.error("Error creando variable:",p),null}}refreshToolbox(){if(this.workspace)try{console.log("Refrescando toolbox con variables actuales...");const r=this.getVariablesToolbox();console.log("Nuevo toolbox XML generado"),this.workspace.updateToolbox(r),console.log("Toolbox actualizado exitosamente");const p=this.workspace.getToolbox();p&&(p.refreshSelection(),console.log("Selecci\xf3n del toolbox refrescada"))}catch(r){console.warn("Error refrescando toolbox:",r),this.fallbackRefresh()}}fallbackRefresh(){try{if(console.log("Intentando fallback refresh..."),this.workspace){const r=this.workspace.getToolbox();r&&r.refreshTheme&&r.refreshTheme(),this.workspace.render()}}catch(r){console.warn("Error en fallback refresh:",r)}}setupCustomDialogs(r){try{if(_i&&_i.setPrompt)_i.setPrompt((p,a,_)=>{p.toLowerCase().includes("variable")||p.toLowerCase().includes("nombre")?r.showCreateVariableDialog(_):_(prompt(p,a))}),_i.setConfirm((p,a)=>{if(p.toLowerCase().includes("delete")||p.toLowerCase().includes("eliminar")){const _=this.extractVariableNameFromMessage(p);r.showDeleteVariableDialog(_,()=>a(!0)),r.onCancelDeleteVariable=()=>a(!1)}else{const _=confirm(p);a(_)}});else{const p=window.prompt,a=window.confirm;window.blocklyPrompt=p,window.blocklyConfirm=a,window.prompt=(_,S)=>_&&(_.toLowerCase().includes("variable")||_.toLowerCase().includes("nombre"))?(r.showCreateVariableDialog(H=>{}),null):p(_,S),window.confirm=_=>{if(_&&(_.toLowerCase().includes("delete")||_.toLowerCase().includes("eliminar"))){const S=this.extractVariableNameFromMessage(_);return r.showDeleteVariableDialog(S,()=>{}),!1}return a(_)}}}catch(p){console.warn("No se pudieron configurar los di\xe1logos personalizados:",p)}}extractVariableNameFromMessage(r){const p=r.match(/"([^"]+)"/);return p?p[1]:"variable"}static{this.\u0275fac=function(p){return new(p||h)}}static{this.\u0275prov=o.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"})}}return h})();var ms=ce(95);const Wr=["blocklyDiv"];function na(h,w){1&h&&(o.O4$(),o._UZ(0,"path",37))}function ra(h,w){1&h&&(o.O4$(),o._UZ(0,"path",38))}function la(h,w){1&h&&(o.O4$(),o._UZ(0,"path",39))}function ca(h,w){1&h&&(o.O4$(),o.TgZ(0,"svg",32),o._UZ(1,"path",40),o.qZA())}function qr(h,w){1&h&&(o.O4$(),o.TgZ(0,"svg",41),o._UZ(1,"circle",42)(2,"path",43),o.qZA())}function aa(h,w){if(1&h){const r=o.EpF();o.TgZ(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"div",6)(5,"div",7)(6,"div",8),o.O4$(),o.TgZ(7,"svg",9),o.YNc(8,na,1,0,"path",10),o.YNc(9,ra,1,0,"path",11),o.YNc(10,la,1,0,"path",12),o.qZA()(),o.kcU(),o.TgZ(11,"div",13),o._uU(12),o.qZA()(),o.TgZ(13,"h2",14),o._uU(14),o.qZA()(),o.TgZ(15,"p",15),o._uU(16),o.qZA(),o.TgZ(17,"div",16)(18,"h3",17),o._uU(19,"\u{1f4cb} Instrucciones:"),o.qZA(),o.TgZ(20,"p",18),o._uU(21),o.qZA()(),o._UZ(22,"div",19),o.TgZ(23,"div",20)(24,"button",21),o.NdJ("click",function(){o.CHM(r);const a=o.oxw();return o.KtG(a.onPreviousExercise())}),o.O4$(),o.TgZ(25,"svg",9),o._UZ(26,"path",22),o.qZA()(),o.kcU(),o.TgZ(27,"span",23),o._uU(28),o.qZA(),o.TgZ(29,"button",24),o.NdJ("click",function(){o.CHM(r);const a=o.oxw();return o.KtG(a.onNextExercise())}),o.O4$(),o.TgZ(30,"svg",9),o._UZ(31,"path",25),o.qZA()()()()(),o.kcU(),o.TgZ(32,"div",26)(33,"div",27),o._UZ(34,"div",28,29),o.qZA(),o.TgZ(36,"div",30)(37,"div",7)(38,"button",31),o.NdJ("click",function(){o.CHM(r);const a=o.oxw();return o.KtG(a.resetWorkspace())}),o.O4$(),o.TgZ(39,"svg",32),o._UZ(40,"path",33),o.qZA()(),o.kcU(),o.TgZ(41,"div",13),o._uU(42," Reiniciar "),o.qZA()(),o.TgZ(43,"div",7)(44,"button",34),o.NdJ("click",function(){o.CHM(r);const a=o.oxw();return o.KtG(a.validateSolution())}),o.YNc(45,ca,2,0,"svg",35),o.YNc(46,qr,3,0,"svg",36),o.qZA(),o.TgZ(47,"div",13),o._uU(48," Validar "),o.qZA()()()()()()}if(2&h){const r=o.oxw();o.xp6(6),o.Udp("background-color",r.getDifficultyColor(r.currentExercise.difficulty))("border-color",r.getDifficultyBorderColor(r.currentExercise.difficulty)),o.xp6(2),o.Q6J("ngIf","easy"===r.currentExercise.difficulty),o.xp6(1),o.Q6J("ngIf","medium"===r.currentExercise.difficulty),o.xp6(1),o.Q6J("ngIf","hard"===r.currentExercise.difficulty),o.xp6(2),o.hij(" ",r.getDifficultyText(r.currentExercise.difficulty)," "),o.xp6(2),o.Oqu(r.currentExercise.title),o.xp6(2),o.Oqu(r.currentExercise.description),o.xp6(5),o.Oqu(r.currentExercise.instructions),o.xp6(3),o.Udp("background-color",r.canGoPrevious?"#f3ae22":"")("border-color",r.canGoPrevious?"#d18c00":""),o.ekj("opacity-50",!r.canGoPrevious)("cursor-not-allowed",!r.canGoPrevious),o.Q6J("disabled",!r.canGoPrevious),o.xp6(4),o.AsE(" ",r.currentExerciseIndex+1," de ",r.exercises.length," "),o.xp6(1),o.ekj("opacity-50",!r.canGoNext)("cursor-not-allowed",!r.canGoNext),o.Q6J("disabled",!r.canGoNext),o.xp6(15),o.Q6J("disabled",r.isValidating),o.xp6(1),o.Q6J("ngIf",!r.isValidating),o.xp6(1),o.Q6J("ngIf",r.isValidating)}}function zr(h,w){if(1&h&&(o.TgZ(0,"div",44)(1,"div",45)(2,"div",46),o.O4$(),o.TgZ(3,"svg",47),o._UZ(4,"path",40),o.qZA(),o.kcU(),o.TgZ(5,"div")(6,"p",48),o._uU(7,"\xa1Perfecto!"),o.qZA(),o.TgZ(8,"p",49),o._uU(9),o.qZA()()()()()),2&h){const r=o.oxw();o.xp6(9),o.Oqu(r.currentMessage)}}function ua(h,w){if(1&h&&(o.TgZ(0,"div",44)(1,"div",50)(2,"div",46),o.O4$(),o.TgZ(3,"svg",47),o._UZ(4,"path",51),o.qZA(),o.kcU(),o.TgZ(5,"div")(6,"p",48),o._uU(7,"Int\xe9ntalo de nuevo"),o.qZA(),o.TgZ(8,"p",49),o._uU(9),o.qZA()()()()()),2&h){const r=o.oxw();o.xp6(9),o.Oqu(r.currentMessage)}}function Ro(h,w){if(1&h){const r=o.EpF();o.TgZ(0,"div",44)(1,"div",52)(2,"div",53)(3,"h3",54),o._uU(4,"Crear Nueva Variable"),o.qZA(),o.TgZ(5,"p",55),o._uU(6,"Ingresa el nombre para tu nueva variable"),o.qZA()(),o.TgZ(7,"div",53)(8,"label",56),o._uU(9,"Nombre de la variable"),o.qZA(),o.TgZ(10,"input",57,58),o.NdJ("ngModelChange",function(a){o.CHM(r);const _=o.oxw();return o.KtG(_.newVariableName=a)})("keyup.enter",function(){o.CHM(r);const a=o.oxw();return o.KtG(a.confirmCreateVariable())})("keyup.escape",function(){o.CHM(r);const a=o.oxw();return o.KtG(a.cancelCreateVariable())}),o.qZA()(),o.TgZ(12,"div",59)(13,"button",60),o.NdJ("click",function(){o.CHM(r);const a=o.oxw();return o.KtG(a.cancelCreateVariable())}),o._uU(14," Cancelar "),o.qZA(),o.TgZ(15,"button",61),o.NdJ("click",function(){o.CHM(r);const a=o.oxw();return o.KtG(a.confirmCreateVariable())}),o._uU(16," Crear Variable "),o.qZA()()()()}if(2&h){const r=o.oxw();o.xp6(10),o.Q6J("ngModel",r.newVariableName),o.xp6(5),o.Q6J("disabled",!(null!=r.newVariableName&&r.newVariableName.trim()))}}function _s(h,w){if(1&h){const r=o.EpF();o.TgZ(0,"div",44)(1,"div",52)(2,"div",53)(3,"h3",54),o._uU(4,"Renombrar Variable"),o.qZA(),o.TgZ(5,"p",55),o._uU(6),o.qZA()(),o.TgZ(7,"div",53)(8,"label",56),o._uU(9,"Nuevo nombre de la variable"),o.qZA(),o.TgZ(10,"input",62,63),o.NdJ("ngModelChange",function(a){o.CHM(r);const _=o.oxw();return o.KtG(_.newVariableName=a)})("keyup.enter",function(){o.CHM(r);const a=o.oxw();return o.KtG(a.confirmRenameVariable())})("keyup.escape",function(){o.CHM(r);const a=o.oxw();return o.KtG(a.cancelRenameVariable())}),o.qZA()(),o.TgZ(12,"div",59)(13,"button",60),o.NdJ("click",function(){o.CHM(r);const a=o.oxw();return o.KtG(a.cancelRenameVariable())}),o._uU(14," Cancelar "),o.qZA(),o.TgZ(15,"button",61),o.NdJ("click",function(){o.CHM(r);const a=o.oxw();return o.KtG(a.confirmRenameVariable())}),o._uU(16," Renombrar "),o.qZA()()()()}if(2&h){const r=o.oxw();o.xp6(6),o.hij('Cambia el nombre de la variable "',r.currentVariableName,'"'),o.xp6(4),o.Q6J("ngModel",r.newVariableName),o.xp6(5),o.Q6J("disabled",!(null!=r.newVariableName&&r.newVariableName.trim()))}}function In(h,w){if(1&h){const r=o.EpF();o.TgZ(0,"div",44)(1,"div",52)(2,"div",53)(3,"h3",54),o._uU(4,"Eliminar Variable"),o.qZA(),o.TgZ(5,"p",55),o._uU(6),o.qZA(),o.TgZ(7,"p",64),o._uU(8,"Esta acci\xf3n no se puede deshacer"),o.qZA()(),o.TgZ(9,"div",59)(10,"button",60),o.NdJ("click",function(){o.CHM(r);const a=o.oxw();return o.KtG(a.cancelDeleteVariable())}),o._uU(11," Cancelar "),o.qZA(),o.TgZ(12,"button",65),o.NdJ("click",function(){o.CHM(r);const a=o.oxw();return o.KtG(a.confirmDeleteVariable())}),o._uU(13," Eliminar "),o.qZA()()()()}if(2&h){const r=o.oxw();o.xp6(6),o.hij('\xbfEst\xe1s seguro de que quieres eliminar la variable "',r.currentVariableName,'"?')}}let Oo=(()=>{class h{constructor(r){this.blocklyService=r,this.exercises=[],this.currentExerciseIndex=0,this.exerciseCompleted=new o.vpe,this.nextExercise=new o.vpe,this.previousExercise=new o.vpe,this.workspace=null,this.showSuccess=!1,this.showError=!1,this.currentMessage="",this.isValidating=!1,this.showCreateVariableModal=!1,this.showRenameVariableModal=!1,this.showDeleteVariableModal=!1,this.newVariableName="",this.currentVariableName="",this.currentVariableCallback=null,this.onCancelDeleteVariable=null}ngOnInit(){}ngAfterViewInit(){setTimeout(()=>{this.initializeBlockly()},100)}ngOnDestroy(){this.blocklyService.dispose()}get currentExercise(){return this.exercises[this.currentExerciseIndex]||null}get canGoPrevious(){return this.currentExerciseIndex>0}get canGoNext(){return this.currentExerciseIndex<this.exercises.length-1}initializeBlockly(){this.blocklyDiv&&this.blocklyDiv.nativeElement&&(this.workspace=this.blocklyService.initializeWorkspace(this.blocklyDiv.nativeElement),this.blocklyService.setupCallbacks(this),this.blocklyService.setupCustomDialogs(this),console.log("Blockly workspace initialized with custom dialogs"),setTimeout(()=>{this.hideBlocklyScrollbars()},100),this.workspace&&this.workspace.addChangeListener(()=>{setTimeout(()=>{this.hideBlocklyScrollbars()},50)}))}hideBlocklyScrollbars(){const r=this.blocklyDiv?.nativeElement;r&&(r.querySelectorAll(".blocklyScrollbarHandle, .blocklyScrollbarBackground, .blocklyScrollbarVertical, .blocklyScrollbarHorizontal").forEach(_=>{_.style.display="none",_.style.visibility="hidden"}),r.querySelectorAll("*").forEach(_=>{_.style.overflow="hidden"}))}validateSolution(){this.currentExercise&&(this.isValidating=!0,this.showSuccess=!1,this.showError=!1,setTimeout(()=>{const r=this.blocklyService.generateCode();console.log("C\xf3digo generado por el usuario:",r),console.log("C\xf3digo esperado:",this.currentExercise.expectedCode);const p=this.blocklyService.validateCode(r,this.currentExercise.expectedCode);console.log("\xbfEs correcto?",p),p?(this.showSuccessMessage(),this.exerciseCompleted.emit({exerciseId:this.currentExercise.id,success:!0})):(this.showErrorMessage(),this.exerciseCompleted.emit({exerciseId:this.currentExercise.id,success:!1})),this.isValidating=!1},1e3))}generateCodeFromBlocks(){return this.blocklyService.generateCode()}compareCode(r,p){return this.blocklyService.validateCode(r,p)}showSuccessMessage(){this.showSuccess=!0,this.currentMessage="\xa1Excelente! Has completado el ejercicio correctamente. \u{1f389}",setTimeout(()=>{this.showSuccess=!1},3e3)}showErrorMessage(){this.showError=!0,this.currentMessage="La soluci\xf3n no es correcta. Revisa las instrucciones e int\xe9ntalo de nuevo. \u{1f4aa}",setTimeout(()=>{this.showError=!1},3e3)}onPreviousExercise(){this.canGoPrevious&&(this.resetWorkspace(),this.previousExercise.emit())}onNextExercise(){this.canGoNext&&(this.resetWorkspace(),this.nextExercise.emit())}resetWorkspace(){this.blocklyService.clearWorkspace(),this.showSuccess=!1,this.showError=!1,this.isValidating=!1,this.showCreateVariableModal=!1,this.showRenameVariableModal=!1,this.showDeleteVariableModal=!1,this.newVariableName="",this.currentVariableName="",this.currentVariableCallback=null,this.onCancelDeleteVariable=null,setTimeout(()=>{this.hideBlocklyScrollbars()},100)}getDifficultyColor(r){switch(r){case"easy":return"#10B981";case"medium":return"#F59E0B";case"hard":return"#EF4444";default:return"#6B7280"}}getDifficultyBorderColor(r){switch(r){case"easy":return"#047857";case"medium":return"#D97706";case"hard":return"#DC2626";default:return"#4B5563"}}getDifficultyText(r){switch(r){case"easy":return"F\xe1cil";case"medium":return"Intermedio";case"hard":return"Dif\xedcil";default:return"Normal"}}showCreateVariableDialog(r){this.currentVariableCallback=r,this.newVariableName="",this.showCreateVariableModal=!0,setTimeout(()=>{document.getElementById("variableNameInput")?.focus()},100)}confirmCreateVariable(){const r=this.newVariableName.trim();console.log("Intentando crear variable:",r),r&&this.currentVariableCallback?(console.log("Ejecutando callback para crear variable"),this.currentVariableCallback(r),setTimeout(()=>{console.log("Variables en workspace despu\xe9s de crear:",this.getWorkspaceVariables())},500),this.cancelCreateVariable()):console.log("No se puede crear variable - nombre vac\xedo o callback nulo")}getWorkspaceVariables(){return this.workspace?this.workspace.getAllVariables().map(r=>r.getName()):[]}cancelCreateVariable(){this.showCreateVariableModal=!1,this.newVariableName="",this.currentVariableCallback=null}showRenameVariableDialog(r,p){this.currentVariableName=r,this.currentVariableCallback=p,this.newVariableName=r,this.showRenameVariableModal=!0,setTimeout(()=>{const a=document.getElementById("renameVariableInput");a?.focus(),a?.select()},100)}confirmRenameVariable(){const r=this.newVariableName.trim();r&&this.currentVariableCallback&&(this.currentVariableCallback(r),this.cancelRenameVariable())}cancelRenameVariable(){this.showRenameVariableModal=!1,this.newVariableName="",this.currentVariableName="",this.currentVariableCallback=null}showDeleteVariableDialog(r,p){this.currentVariableName=r,this.currentVariableCallback=p,this.showDeleteVariableModal=!0}confirmDeleteVariable(){this.currentVariableCallback&&(this.currentVariableCallback(),this.cancelDeleteVariable())}cancelDeleteVariable(){this.showDeleteVariableModal=!1,this.currentVariableName="",this.currentVariableCallback=null,this.onCancelDeleteVariable&&(this.onCancelDeleteVariable(),this.onCancelDeleteVariable=null)}static{this.\u0275fac=function(p){return new(p||h)(o.Y36(Gt))}}static{this.\u0275cmp=o.Xpm({type:h,selectors:[["app-blockly-exercise"]],viewQuery:function(p,a){if(1&p&&o.Gf(Wr,5),2&p){let _;o.iGM(_=o.CRH())&&(a.blocklyDiv=_.first)}},inputs:{exercises:"exercises",currentExerciseIndex:"currentExerciseIndex"},outputs:{exerciseCompleted:"exerciseCompleted",nextExercise:"nextExercise",previousExercise:"previousExercise"},decls:6,vars:6,consts:[["class","w-full",4,"ngIf"],["class","fixed inset-0 z-[9999] flex items-center justify-center bg-black bg-opacity-50",4,"ngIf"],[1,"w-full"],[1,"grid","grid-cols-12","gap-6","min-h-[600px]"],[1,"col-span-4","flex","items-center","justify-center","relative"],[1,"px-4","py-3","w-full","max-w-sm"],[1,"flex","items-center","space-x-3","mb-1"],[1,"relative","group"],[1,"w-8","h-8","text-white","rounded-full","shadow-lg","flex","items-center","justify-center","border-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 10V3L4 14h7v7l9-11h-7z",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17.657 18.657A8 8 0 016.343 7.343S7 9 9 10c0-2 .5-5 2.986-7C14 5 16.09 5.777 17.656 7.343A7.975 7.975 0 0120 13a7.975 7.975 0 01-2.343 5.657z",4,"ngIf"],[1,"absolute","left-1/2","transform","-translate-x-1/2","-top-8","bg-gray-800","text-white","text-xs","rounded","py-1","px-2","opacity-0","group-hover:opacity-100","transition-opacity","duration-200","whitespace-nowrap","z-10"],[1,"text-xl","font-bold","text-gray-800"],[1,"text-gray-600","text-sm","mb-2"],[1,"bg-blue-50","border-l-4","border-blue-400","p-2","rounded-r-lg","mb-4"],[1,"font-semibold","text-blue-800","mb-1","text-sm"],[1,"text-blue-700","text-sm"],[1,"border-t","border-gray-200","w-full"],[1,"flex","justify-between","items-center","pt-4"],[1,"w-10","h-10","text-white","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border-2","disabled:bg-gray-400","disabled:border-gray-300","disabled:hover:bg-gray-400",3,"disabled","click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[1,"text-sm","text-green-600","font-bold"],[1,"w-10","h-10","bg-blue-600","hover:bg-blue-700","text-white","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border-2","border-blue-800","disabled:bg-gray-400","disabled:border-gray-300","disabled:hover:bg-gray-400",3,"disabled","click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],[1,"col-span-8","relative"],[1,"overflow-hidden","blockly-container",2,"height","600px","overflow","hidden !important"],["id","blocklyDiv",1,"w-full","h-full","blockly-workspace",2,"margin","0","padding","0","display","block","overflow","hidden !important","scrollbar-width","none","-ms-overflow-style","none"],["blocklyDiv",""],[1,"absolute","bottom-4","left-1/2","transform","-translate-x-1/2","flex","space-x-4","z-10"],[1,"w-12","h-12","text-white","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border-2",2,"background-color","#f3ae22","border-color","#d18c00",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],[1,"w-12","h-12","bg-blue-600","hover:bg-blue-700","disabled:bg-blue-400","text-white","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border-2","border-blue-800",3,"disabled","click"],["class","w-5 h-5","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],["class","w-5 h-5 animate-spin","fill","none","viewBox","0 0 24 24",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 10V3L4 14h7v7l9-11h-7z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17.657 18.657A8 8 0 016.343 7.343S7 9 9 10c0-2 .5-5 2.986-7C14 5 16.09 5.777 17.656 7.343A7.975 7.975 0 0120 13a7.975 7.975 0 01-2.343 5.657z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],["fill","none","viewBox","0 0 24 24",1,"w-5","h-5","animate-spin"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 0 1 8-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 0 1 4 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],[1,"fixed","inset-0","z-[9999]","flex","items-center","justify-center","bg-black","bg-opacity-50"],[1,"bg-green-500","text-white","px-8","py-6","rounded-xl","shadow-2xl","transform","transition-all","duration-500","ease-in-out","max-w-md","mx-4"],[1,"flex","items-center","space-x-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","flex-shrink-0"],[1,"font-bold","text-lg"],[1,"text-sm","opacity-90"],[1,"bg-red-500","text-white","px-8","py-6","rounded-xl","shadow-2xl","transform","transition-all","duration-500","ease-in-out","max-w-md","mx-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"bg-white","px-8","py-6","rounded-xl","shadow-2xl","transform","transition-all","duration-300","ease-in-out","max-w-md","mx-4","w-full"],[1,"mb-6"],[1,"text-xl","font-bold","text-gray-800","mb-2"],[1,"text-gray-600","text-sm"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","variableNameInput","type","text","placeholder","Ej: edad, nombre, contador...",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500","outline-none","transition-colors",3,"ngModel","ngModelChange","keyup.enter","keyup.escape"],["variableNameInput",""],[1,"flex","justify-end","space-x-3"],[1,"px-4","py-2","text-gray-600","hover:text-gray-800","hover:bg-gray-100","rounded-lg","transition-colors",3,"click"],[1,"px-6","py-2","bg-blue-600","hover:bg-blue-700","disabled:bg-gray-300","disabled:cursor-not-allowed","text-white","font-medium","rounded-lg","transition-colors",3,"disabled","click"],["id","renameVariableInput","type","text","placeholder","Nuevo nombre...",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500","outline-none","transition-colors",3,"ngModel","ngModelChange","keyup.enter","keyup.escape"],["renameVariableInput",""],[1,"text-red-600","text-xs","mt-2"],[1,"px-6","py-2","bg-red-600","hover:bg-red-700","text-white","font-medium","rounded-lg","transition-colors",3,"click"]],template:function(p,a){1&p&&(o.YNc(0,aa,49,30,"div",0),o.YNc(1,zr,10,1,"div",1),o.YNc(2,ua,10,1,"div",1),o.YNc(3,Ro,17,2,"div",1),o.YNc(4,_s,17,3,"div",1),o.YNc(5,In,14,1,"div",1)),2&p&&(o.Q6J("ngIf",a.currentExercise),o.xp6(1),o.Q6J("ngIf",a.showSuccess),o.xp6(1),o.Q6J("ngIf",a.showError),o.xp6(1),o.Q6J("ngIf",a.showCreateVariableModal),o.xp6(1),o.Q6J("ngIf",a.showRenameVariableModal),o.xp6(1),o.Q6J("ngIf",a.showDeleteVariableModal))},dependencies:[V.O5,ms.Fj,ms.JJ,ms.On],styles:['.blockly-exercise-container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto}.exercise-header[_ngcontent-%COMP%]{border-bottom:1px solid #e5e7eb;padding-bottom:1rem}.blockly-workspace-container[_ngcontent-%COMP%]{position:relative}#blocklyDiv[_ngcontent-%COMP%]{position:relative;background-color:#f9fafb;border-radius:0;width:100%;height:500px}.blockly-workspace-container[_ngcontent-%COMP%]   .blocklySvg[_ngcontent-%COMP%]{border-radius:.5rem}.blockly-workspace-container[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{border-radius:.5rem}@keyframes _ngcontent-%COMP%_slideInRight{0%{transform:translate(100%);opacity:0}to{transform:translate(0);opacity:1}}@keyframes _ngcontent-%COMP%_slideOutRight{0%{transform:translate(0);opacity:1}to{transform:translate(100%);opacity:0}}.difficulty-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.05em}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:not(:disabled):hover{transform:translateY(-1px);box-shadow:0 4px 12px #00000026}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{cursor:not-allowed;opacity:.6}@media (max-width: 768px){.blockly-exercise-container[_ngcontent-%COMP%]{margin:0 1rem;padding:1rem}.action-buttons[_ngcontent-%COMP%]{flex-direction:column;gap:1rem}.action-buttons[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center}.exercise-header[_ngcontent-%COMP%]   .flex[_ngcontent-%COMP%]{flex-direction:column;gap:.5rem}}.blockly-workspace-container[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:-2px;background:linear-gradient(45deg,#3b82f6,#8b5cf6,#06b6d4);border-radius:.5rem;z-index:-1;opacity:0;transition:opacity .3s ease}.blockly-workspace-container[_ngcontent-%COMP%]:hover:before{opacity:.1}.instruction-box[_ngcontent-%COMP%]{position:relative;overflow:hidden}.instruction-box[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;right:0;height:2px;background:linear-gradient(90deg,#3b82f6,transparent)}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.animate-spin[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}.blockly-workspace-container[_ngcontent-%COMP%]   div[_ngcontent-%COMP%], .blockly-workspace-container[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%], .blockly-workspace-container[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{overflow:hidden!important;scrollbar-width:none!important;-ms-overflow-style:none!important}.blockly-workspace-container[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]::-webkit-scrollbar, .blockly-workspace-container[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]::-webkit-scrollbar, .blockly-workspace-container[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]::-webkit-scrollbar{display:none!important;width:0!important;height:0!important;background:transparent!important}div[class*=blockly][_ngcontent-%COMP%]{overflow:hidden!important}g[class*=blockly][_ngcontent-%COMP%]{overflow:hidden!important}.blocklyScrollbarHandle[_ngcontent-%COMP%], .blocklyScrollbarBackground[_ngcontent-%COMP%], .blocklyScrollbarVertical[_ngcontent-%COMP%], .blocklyScrollbarHorizontal[_ngcontent-%COMP%]{display:none!important;visibility:hidden!important}']})}}return h})();function Mo(h,w){if(1&h){const r=o.EpF();o.TgZ(0,"div",51)(1,"div",52)(2,"div",53)(3,"span",54),o._uU(4),o.qZA(),o.TgZ(5,"h3",55),o._uU(6),o.qZA()(),o.TgZ(7,"p",56),o._uU(8),o.qZA()(),o.TgZ(9,"div",57)(10,"div",58)(11,"p",59),o._uU(12),o.qZA()(),o.TgZ(13,"button",60),o.NdJ("click",function(){const _=o.CHM(r).$implicit,S=o.oxw();return o.KtG(S.openFlowchartModal(_))}),o._uU(14," \u{1f680} Ver Diagrama de Flujo "),o.qZA()()()}if(2&h){const r=w.$implicit;o.xp6(4),o.Oqu(r.icon),o.xp6(2),o.Oqu(r.title),o.xp6(2),o.Oqu(r.description),o.xp6(4),o.Oqu(r.question)}}let jr=(()=>{class h{constructor(r){this.http=r,this.ejemplos=[],this.ejercicios=[],this.currentBlocklyExerciseIndex=0,this.showModal=!1,this.modalTitle="",this.modalComponentType=null,this.modalComponentInputs={}}ngOnInit(){this.cargarEjemplos(),this.cargarEjercicios()}cargarEjemplos(){this.http.get("assets/jsons-base/modulos.json").subscribe({next:r=>{this.ejemplos=r.funciones?.examples||[]},error:r=>{this.ejemplos=[]}})}cargarEjercicios(){this.http.get("assets/jsons-base/blockly-exercises.json").subscribe({next:r=>{this.ejercicios=r.funciones?.exercises||[]},error:r=>{this.ejercicios=[]}})}openFlowchartModal(r){this.modalTitle=`\u{1f9e9} Diagrama de Flujo - ${r.title}`,this.modalComponentType=dt,this.modalComponentInputs={steps:r.steps||[],title:r.title},this.showModal=!0}closeModal(){this.showModal=!1,this.modalComponentType=null,this.modalComponentInputs={}}onBlocklyExerciseCompleted(r){console.log("Ejercicio completado:",r)}nextBlocklyExercise(){this.currentBlocklyExerciseIndex<this.ejercicios.length-1&&this.currentBlocklyExerciseIndex++}previousBlocklyExercise(){this.currentBlocklyExerciseIndex>0&&this.currentBlocklyExerciseIndex--}static{this.\u0275fac=function(p){return new(p||h)(o.Y36(Ee.eN))}}static{this.\u0275cmp=o.Xpm({type:h,selectors:[["app-modularidad"]],decls:225,vars:10,consts:[[1,"text-center","mb-6","mt-6"],[1,"text-3xl","font-bold","text-gray-800","mb-2","drop-shadow-md"],[1,"flex","items-center","justify-center","mb-1"],[1,"h-0.5","bg-gradient-to-r","from-transparent","via-cyan-500","to-transparent","w-96","shadow-sm"],[1,"flex","items-center","justify-center"],[1,"h-px","bg-gradient-to-r","from-transparent","via-gray-300","to-transparent","w-64","opacity-60"],[1,"min-h-screen"],[1,"flex","flex-col","gap-6","p-4","mx-8"],[1,"bg-gray-500/20","backdrop-blur-md","p-6","rounded-lg","border","border-gray-400/30","shadow-lg"],[1,"text-xl","font-bold","mb-3","text-gray-800"],[1,"space-y-6"],[1,"w-full"],[1,"text-gray-700","leading-relaxed","text-justify","text-base",2,"text-align","justify"],[1,"bg-cyan-50","p-3","rounded","border-l-4","border-cyan-400"],[1,"text-cyan-800","text-sm","font-medium","mb-2"],[1,"text-gray-700","text-sm"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4","mb-6"],[1,"p-4","bg-blue-50","rounded-lg","border-l-4","border-blue-400"],[1,"text-lg","font-semibold","text-blue-600","mb-2"],[1,"bg-white","p-3","rounded","border","text-sm"],[1,"list-disc","pl-6","mb-2"],[1,"p-4","bg-teal-50","rounded-lg","border-l-4","border-teal-400"],[1,"text-lg","font-semibold","text-teal-600","mb-2"],[1,"p-4","bg-orange-50","rounded-lg","border-l-4","border-orange-400"],[1,"text-lg","font-semibold","text-orange-600","mb-2"],[1,"p-4","bg-yellow-50","rounded-lg","border-l-4","border-yellow-400"],[1,"text-lg","font-semibold","text-yellow-600","mb-2"],[1,"text-gray-700","mb-2"],[1,"bg-white","p-3","rounded","border","text-sm","space-y-2"],[1,"text-gray-700"],[1,"p-4","bg-indigo-50","rounded-lg","border-l-4","border-indigo-400"],[1,"text-lg","font-semibold","text-indigo-600","mb-2"],[1,"p-4","bg-purple-50","rounded-lg","border-l-4","border-purple-400"],[1,"text-lg","font-semibold","text-purple-600","mb-2"],[1,"text-purple-600","font-semibold"],[1,"p-4","bg-cyan-50","rounded-lg","border-l-4","border-cyan-400"],[1,"text-lg","font-semibold","text-cyan-600","mb-2"],[1,"bg-white","p-3","rounded","border","text-xs","font-mono"],[1,"list-disc","pl-6","mt-2","text-sm"],[1,"p-4","bg-green-50","rounded-lg","border-l-4","border-green-400"],[1,"text-lg","font-semibold","text-green-600","mb-2"],[1,"bg-cyan-100","p-2","rounded","mt-2","text-xs","font-mono"],[1,"text-xl","font-bold","mb-4","text-gray-800"],[1,"text-gray-700","mb-6","text-justify"],[1,"overflow-x-auto"],[1,"flex","gap-6","pb-4",2,"min-width","max-content"],["class","flex-shrink-0 bg-white/80 backdrop-blur-sm rounded-lg p-6 border border-gray-200 shadow-md hover:shadow-lg transition-shadow duration-200 flex flex-col justify-between","style","width: 350px; height: 350px;",4,"ngFor","ngForOf"],[1,"mt-8","p-4","bg-cyan-50","border","border-cyan-200","rounded-lg"],[1,"text-cyan-800","text-sm"],[3,"exercises","exercisecompleted","nextexercise","previousexercise"],[3,"isVisible","title","componentType","componentInputs","onClose"],[1,"flex-shrink-0","bg-white/80","backdrop-blur-sm","rounded-lg","p-6","border","border-gray-200","shadow-md","hover:shadow-lg","transition-shadow","duration-200","flex","flex-col","justify-between",2,"width","350px","height","350px"],[1,"flex-1","flex","flex-col"],[1,"flex","items-center","mb-4"],[1,"text-3xl","mr-3"],[1,"text-lg","font-semibold","text-gray-800","line-clamp-2","leading-tight"],[1,"text-gray-600","text-sm","mb-4","leading-relaxed","line-clamp-4","flex-1"],[1,"mt-auto"],[1,"bg-cyan-50","p-3","rounded-lg","border-l-4","border-cyan-400","mb-4"],[1,"text-cyan-800","text-xs","font-medium","line-clamp-3"],[1,"w-full","bg-cyan-500","hover:bg-cyan-600","text-white","py-3","px-4","rounded","transition-colors","duration-200","text-sm","font-medium","shadow-md","hover:shadow-lg",3,"click"]],template:function(p,a){1&p&&(o.TgZ(0,"div",0)(1,"h1",1),o._uU(2,"\u{1f9e9} M\xf3dulo de Funciones"),o.qZA(),o.TgZ(3,"div",2),o._UZ(4,"div",3),o.qZA(),o.TgZ(5,"div",4),o._UZ(6,"div",5),o.qZA()(),o.TgZ(7,"div",6)(8,"div",7)(9,"div",8)(10,"h2",9),o._uU(11,"\u{1f9e9} \xbfQu\xe9 son las funciones?"),o.qZA(),o.TgZ(12,"div",10)(13,"div",11)(14,"p",12)(15,"strong"),o._uU(16,"Una funci\xf3n"),o.qZA(),o._uU(17," es como una peque\xf1a m\xe1quina que hace una tarea espec\xedfica dentro del programa.\nLe damos un nombre y dentro de ella escribimos los pasos que queremos que siga. En vez de escribir los mismos pasos una y otra vez, ponemos esos pasos dentro de la funci\xf3n y luego, cuando necesitamos que se hagan, simplemente llamamos a la funci\xf3n usando su nombre. Es como cuando grabas un mensaje de voz: lo haces una vez y puedes reproducirlo cada vez que quieras, sin tener que decirlo otra vez. "),o.qZA()(),o.TgZ(18,"div",13)(19,"p",14)(20,"strong"),o._uU(21,"Ejemplo cotidiano:"),o.qZA()(),o.TgZ(22,"p",15),o._uU(23,"Pedir comida por una app: t\xfa env\xedas el pedido (par\xe1metro), la app procesa la orden (instrucciones) y recibes la comida (resultado)."),o.qZA()(),o.TgZ(24,"div",16)(25,"div",17)(26,"h3",18),o._uU(27,"\u2699\ufe0f \xbfC\xf3mo funciona una funci\xf3n?"),o.qZA(),o.TgZ(28,"div",19)(29,"ul",20)(30,"li"),o._uU(31,"Recibe datos de entrada llamados "),o.TgZ(32,"strong"),o._uU(33,"par\xe1metros"),o.qZA(),o._uU(34,"."),o.qZA(),o.TgZ(35,"li"),o._uU(36,"Ejecuta una serie de instrucciones paso a paso."),o.qZA(),o.TgZ(37,"li"),o._uU(38,"Devuelve un resultado final llamado "),o.TgZ(39,"strong"),o._uU(40,"valor de retorno"),o.qZA(),o._uU(41,"."),o.qZA()()()(),o.TgZ(42,"div",21)(43,"h3",22),o._uU(44,"\u{1f5bc}\ufe0f Analog\xeda visual"),o.qZA(),o.TgZ(45,"div",19)(46,"p"),o._uU(47,"Imagina que una funci\xf3n es como una m\xe1quina en una f\xe1brica: le das materia prima (datos), la m\xe1quina sigue un proceso (instrucciones) y te entrega un producto terminado (resultado)."),o.qZA(),o.TgZ(48,"p"),o._uU(49,"Tambi\xe9n puedes pensar en una receta de cocina: ingredientes \u2192 proceso \u2192 platillo."),o.qZA()()(),o.TgZ(50,"div",23)(51,"h3",24),o._uU(52,"\u{1f48e} Importancia de las funciones"),o.qZA(),o.TgZ(53,"div",19)(54,"ul",20)(55,"li"),o._uU(56,"Permiten dividir el c\xf3digo en partes peque\xf1as y manejables."),o.qZA(),o.TgZ(57,"li"),o._uU(58,"Facilitan la reutilizaci\xf3n: puedes usar la misma funci\xf3n en diferentes lugares."),o.qZA(),o.TgZ(59,"li"),o._uU(60,"Ayudan a evitar errores y duplicaci\xf3n de c\xf3digo."),o.qZA(),o.TgZ(61,"li"),o._uU(62,"Mejoran la legibilidad y el mantenimiento de los programas."),o.qZA(),o.TgZ(63,"li"),o._uU(64,"Son la base de la programaci\xf3n modular y estructurada."),o.qZA()()()(),o.TgZ(65,"div",25)(66,"h3",26),o._uU(67,"\u{1f305} Ejemplos en la vida cotidiana"),o.qZA(),o.TgZ(68,"div",19)(69,"p",27)(70,"strong"),o._uU(71,"\u{1f4de} Llamar por tel\xe9fono:"),o.qZA(),o._uU(72," funci\xf3n que recibe el n\xfamero y conecta la llamada."),o.qZA(),o.TgZ(73,"p",27)(74,"strong"),o._uU(75,"\u{1f697} Usar GPS:"),o.qZA(),o._uU(76," funci\xf3n que recibe destino y muestra la ruta. "),o.qZA(),o.TgZ(77,"p",27)(78,"strong"),o._uU(79,"\u{1f9fa} Lavar ropa:"),o.qZA(),o._uU(80," funci\xf3n que recibe ropa sucia y devuelve ropa limpia."),o.qZA(),o.TgZ(81,"p",27)(82,"strong"),o._uU(83,"\u{1f373} Cocinar:"),o.qZA(),o._uU(84," funci\xf3n que recibe ingredientes y devuelve un platillo."),o.qZA()()(),o.TgZ(85,"div",21)(86,"h3",22),o._uU(87,"\u{1f9e0} Curiosidades y met\xe1foras"),o.qZA(),o.TgZ(88,"div",28)(89,"p",29),o._uU(90,"\u2022 Las funciones pueden llamarse a s\xed mismas (recursividad), como una mu\xf1eca rusa. "),o.qZA(),o.TgZ(91,"p",29),o._uU(92,"\u2022 En matem\xe1ticas, una funci\xf3n transforma una entrada en una salida: f(x) = x + 1. "),o.qZA(),o.TgZ(93,"p",29),o._uU(94,"\u2022 En la vida real, una receta de cocina es una funci\xf3n: ingredientes \u2192 platillo. "),o.qZA(),o.TgZ(95,"p",29),o._uU(96,"\u2022 Los videojuegos usan funciones para calcular puntajes, movimientos y efectos."),o.qZA()()(),o.TgZ(97,"div",30)(98,"h3",31),o._uU(99,"\u{1f9ea} Errores y curiosidades"),o.qZA(),o.TgZ(100,"div",28)(101,"p",29),o._uU(102,"\u2022 Olvidar el "),o.TgZ(103,"code"),o._uU(104,"return"),o.qZA(),o._uU(105," puede hacer que la funci\xf3n no devuelva nada."),o.qZA(),o.TgZ(106,"p",29),o._uU(107,"\u2022 Puedes tener funciones dentro de funciones (anidadas)."),o.qZA(),o.TgZ(108,"p",29),o._uU(109,"\u2022 Las funciones pueden recibir cero, uno o muchos par\xe1metros."),o.qZA(),o.TgZ(110,"p",29),o._uU(111,"\u2022 En algunos lenguajes, las funciones pueden devolver m\xe1s de un valor (tuplas, objetos)."),o.qZA()()(),o.TgZ(112,"div",32)(113,"h3",33),o._uU(114,"\u{1f6e0}\ufe0f Elementos clave de una funci\xf3n"),o.qZA(),o.TgZ(115,"div",28)(116,"div")(117,"span",34),o._uU(118,"\u2022 Nombre:"),o.qZA(),o._uU(119," Identificador \xfanico y descriptivo."),o.qZA(),o.TgZ(120,"div")(121,"span",34),o._uU(122,"\u2022 Par\xe1metros:"),o.qZA(),o._uU(123," Datos que recibe para trabajar."),o.qZA(),o.TgZ(124,"div")(125,"span",34),o._uU(126,"\u2022 Instrucciones:"),o.qZA(),o._uU(127," Pasos que ejecuta para cumplir su tarea."),o.qZA(),o.TgZ(128,"div")(129,"span",34),o._uU(130,"\u2022 Valor de retorno:"),o.qZA(),o._uU(131," Resultado que entrega al finalizar."),o.qZA()()(),o.TgZ(132,"div",17)(133,"h3",18),o._uU(134,"\u{1f30e} Comparaci\xf3n con la vida real"),o.qZA(),o.TgZ(135,"div",19)(136,"p",29),o._uU(137,"\u2022 Receta de cocina: funci\xf3n que recibe ingredientes y devuelve un platillo."),o.qZA(),o.TgZ(138,"p",29),o._uU(139,"\u2022 Llamar a un electricista: funci\xf3n que recibe problema y devuelve soluci\xf3n."),o.qZA(),o.TgZ(140,"p",29),o._uU(141,"\u2022 Pedir comida por app: funci\xf3n que recibe pedido y devuelve comida."),o.qZA(),o.TgZ(142,"p",29),o._uU(143,"\u2022 Usar una calculadora: funci\xf3n que recibe n\xfameros y devuelve el resultado."),o.qZA(),o.TgZ(144,"p",29),o._uU(145,"\u2022 Buscar informaci\xf3n en internet: funci\xf3n que recibe una pregunta y devuelve una respuesta."),o.qZA()()(),o.TgZ(146,"div",35)(147,"h3",36),o._uU(148,"\u{1f4cb} Sintaxis general"),o.qZA(),o.TgZ(149,"div",37)(150,"code"),o._uU(151),o._UZ(152,"br"),o._uU(153,"\xa0\xa0// instrucciones"),o._UZ(154,"br"),o._uU(155,"\xa0\xa0return valor;"),o._UZ(156,"br"),o._uU(157),o.qZA()(),o.TgZ(158,"ul",38)(159,"li")(160,"strong"),o._uU(161,"Funciones sin par\xe1metros:"),o.qZA(),o._uU(162," No reciben datos, solo ejecutan instrucciones."),o.qZA(),o.TgZ(163,"li")(164,"strong"),o._uU(165,"Funciones con par\xe1metros:"),o.qZA(),o._uU(166," Reciben uno o m\xe1s datos para trabajar."),o.qZA(),o.TgZ(167,"li")(168,"strong"),o._uU(169,"Funciones que retornan valor:"),o.qZA(),o._uU(170," Devuelven un resultado."),o.qZA(),o.TgZ(171,"li")(172,"strong"),o._uU(173,"Funciones que no retornan valor:"),o.qZA(),o._uU(174," Solo ejecutan acciones."),o.qZA()()(),o.TgZ(175,"div",39)(176,"h3",40),o._uU(177,"\u2705 Buenas pr\xe1cticas y errores comunes"),o.qZA(),o.TgZ(178,"div",19)(179,"ul",20)(180,"li"),o._uU(181,"Usa nombres descriptivos para tus funciones."),o.qZA(),o.TgZ(182,"li"),o._uU(183,"No hagas funciones demasiado largas o con muchas responsabilidades."),o.qZA(),o.TgZ(184,"li"),o._uU(185,"Documenta lo que hace cada funci\xf3n."),o.qZA(),o.TgZ(186,"li"),o._uU(187,"Olvidar el "),o.TgZ(188,"code"),o._uU(189,"return"),o.qZA(),o._uU(190," cuando se espera un resultado."),o.qZA(),o.TgZ(191,"li"),o._uU(192,"Confundir los par\xe1metros con las variables internas."),o.qZA(),o.TgZ(193,"li"),o._uU(194,"Usar nombres poco claros."),o.qZA()(),o.TgZ(195,"div",41)(196,"code"),o._uU(197),o._UZ(198,"br"),o._uU(199,'\xa0\xa0return "Hola, " + nombre + "!";'),o._UZ(200,"br"),o._uU(201),o._UZ(202,"br")(203,"br"),o._uU(204,'let mensaje = saludar("Ana"); // mensaje = "Hola, Ana!"'),o.qZA()()()()()()(),o.TgZ(205,"div",8)(206,"h2",42),o._uU(207,"\u{1f9ea} Ejemplos Din\xe1micos"),o.qZA(),o.TgZ(208,"p",43),o._uU(209," A continuaci\xf3n encontrar\xe1s ejemplos interactivos que demuestran c\xf3mo funcionan las funciones en situaciones cotidianas. Cada ejemplo incluye un diagrama de flujo que puedes visualizar paso a paso. "),o.qZA(),o.TgZ(210,"div",44)(211,"div",45),o.YNc(212,Mo,15,4,"div",46),o.qZA()(),o.TgZ(213,"div",47)(214,"p",48)(215,"strong"),o._uU(216,"\u{1f4a1} Consejo:"),o.qZA(),o._uU(217," Las funciones te ayudan a organizar y reutilizar tu c\xf3digo. Observa c\xf3mo cada ejemplo usa diferentes tipos de entrada y salida. "),o.qZA()()(),o.TgZ(218,"div",8)(219,"h2",42),o._uU(220,"\u{1f3af} Ejercicios Pr\xe1cticos"),o.qZA(),o.TgZ(221,"p",43),o._uU(222," Ahora es tu turno de practicar. Estos ejercicios te ayudar\xe1n a dominar las funciones usando programaci\xf3n visual con Blockly. Cada ejercicio te ense\xf1ar\xe1 un concepto espec\xedfico. "),o.qZA(),o.TgZ(223,"app-blockly-exercise",49),o.NdJ("exercisecompleted",function(S){return a.onBlocklyExerciseCompleted(S)})("nextexercise",function(){return a.nextBlocklyExercise()})("previousexercise",function(){return a.previousBlocklyExercise()}),o.qZA()()()(),o.TgZ(224,"app-modal",50),o.NdJ("onClose",function(){return a.closeModal()}),o.qZA()),2&p&&(o.xp6(151),o.hij("function nombreFuncion(par\xe1metros) ","{",""),o.xp6(6),o.Oqu("}"),o.xp6(40),o.hij("function saludar(nombre) ","{",""),o.xp6(4),o.Oqu("}"),o.xp6(11),o.Q6J("ngForOf",a.ejemplos),o.xp6(11),o.Q6J("exercises",a.ejercicios),o.xp6(1),o.Q6J("isVisible",a.showModal)("title",a.modalTitle)("componentType",a.modalComponentType)("componentInputs",a.modalComponentInputs))},dependencies:[V.sg,Oo,lo]})}}return h})();function xn(h,w){if(1&h){const r=o.EpF();o.TgZ(0,"div",52)(1,"div",53)(2,"div",54)(3,"span",55),o._uU(4),o.qZA(),o.TgZ(5,"h3",56),o._uU(6),o.qZA()(),o.TgZ(7,"p",57),o._uU(8),o.qZA()(),o.TgZ(9,"div",58)(10,"div",59)(11,"p",60),o._uU(12),o.qZA()(),o.TgZ(13,"button",61),o.NdJ("click",function(){const _=o.CHM(r).$implicit,S=o.oxw();return o.KtG(S.openFlowchartModal(_))}),o._uU(14," \u{1f680} Ver Diagrama de Flujo "),o.qZA()()()}if(2&h){const r=w.$implicit,p=o.oxw();o.xp6(4),o.Oqu(p.getIconForExample(r.title)),o.xp6(2),o.Oqu(p.getCleanTitle(r.title)),o.xp6(2),o.Oqu(r.description),o.xp6(4),o.Oqu(r.question)}}let Yr=(()=>{class h{constructor(r){this.http=r,this.examples=[],this.blocklyExercises=[],this.currentBlocklyExerciseIndex=0,this.selectedSection="teoria",this.showModal=!1,this.modalTitle="",this.modalComponentType=null,this.modalComponentInputs={}}ngOnInit(){this.loadExamples(),this.loadBlocklyExercises()}loadExamples(){this.http.get("assets/jsons-base/modulos.json").subscribe({next:r=>{this.examples=r.bucles?.examples||[]},error:r=>{console.error("Error al cargar ejemplos de bucles:",r),this.examples=[]}})}loadBlocklyExercises(){this.http.get("assets/jsons-base/blockly-exercises.json").subscribe({next:r=>{this.blocklyExercises=r.bucles?.exercises||[]},error:r=>{console.error("Error al cargar ejercicios de Blockly:",r),this.blocklyExercises=[]}})}getIconForExample(r){const p=r.toLowerCase(),a={"ejercicio|flexiones|rutina":"\u{1f3c3}\u200d\u2642\ufe0f","lavado|platos|lavar":"\u{1f37d}\ufe0f","contador|numeros|pares":"\u{1f522}","estudiante|calificacion|profesor":"\u{1f4da}","ahorro|dinero|ahorrar":"\ufffd","juego|adivinanza|adivinar":"\u{1f3b2}"};for(const[_,S]of Object.entries(a))if(_.split("|").some(H=>p.includes(H)))return S;return"\u{1f504}"}getCleanTitle(r){return r.replace(/^(Ejemplo|Ejercicio):\s*/i,"")}openFlowchartModal(r){this.modalTitle=`\u{1f504} Diagrama de Flujo - ${this.getCleanTitle(r.title)}`,this.modalComponentType=dt,this.modalComponentInputs={steps:r.steps||[],title:r.title},this.showModal=!0}closeModal(){this.showModal=!1,this.modalComponentType=null,this.modalComponentInputs={}}onBlocklyExerciseCompleted(r){console.log("Ejercicio completado:",r)}nextBlocklyExercise(){this.currentBlocklyExerciseIndex<this.blocklyExercises.length-1&&this.currentBlocklyExerciseIndex++}previousBlocklyExercise(){this.currentBlocklyExerciseIndex>0&&this.currentBlocklyExerciseIndex--}static{this.\u0275fac=function(p){return new(p||h)(o.Y36(Ee.eN))}}static{this.\u0275cmp=o.Xpm({type:h,selectors:[["app-bucles"]],decls:181,vars:7,consts:[[1,"text-center","mb-6","mt-6"],[1,"text-3xl","font-bold","text-gray-800","mb-2","drop-shadow-md"],[1,"flex","items-center","justify-center","mb-1"],[1,"h-0.5","bg-gradient-to-r","from-transparent","via-red-500","to-transparent","w-96","shadow-sm"],[1,"flex","items-center","justify-center"],[1,"h-px","bg-gradient-to-r","from-transparent","via-gray-300","to-transparent","w-64","opacity-60"],[1,"min-h-screen"],[1,"flex","flex-col","gap-6","p-4","mx-8"],[1,"bg-gray-500/20","backdrop-blur-md","p-6","rounded-lg","border","border-gray-400/30","shadow-lg"],[1,"mb-6"],[1,"text-xl","font-bold","mb-3","text-gray-800"],[1,"text-gray-700","leading-relaxed","mb-4","text-justify"],[1,"bg-red-50","p-3","rounded","border-l-4","border-red-400","mb-4"],[1,"text-red-800","text-sm","font-medium","mb-2"],[1,"text-gray-700","text-sm"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"p-4","bg-purple-50","rounded-lg","border-l-4","border-purple-400"],[1,"text-lg","font-semibold","text-purple-600","mb-2"],[1,"bg-white","p-3","rounded","border","text-sm","space-y-2"],[1,"text-purple-600","font-semibold"],[1,"p-4","bg-blue-50","rounded-lg","border-l-4","border-blue-400"],[1,"text-lg","font-semibold","text-blue-600","mb-2"],[1,"text-gray-700","text-justify","mb-3"],[1,"text-md","font-semibold","text-blue-600","mb-2"],[1,"bg-white","p-3","rounded","border","text-sm"],[1,"text-gray-700"],[1,"p-4","bg-green-50","rounded-lg","border-l-4","border-green-400"],[1,"text-lg","font-semibold","text-green-600","mb-2"],[1,"bg-white","p-3","rounded","border","text-sm","space-y-1"],[1,"text-green-600","font-medium"],[1,"p-4","bg-orange-50","rounded-lg","border-l-4","border-orange-400"],[1,"text-lg","font-semibold","text-orange-600","mb-2"],[1,"p-4","bg-teal-50","rounded-lg","border-l-4","border-teal-400"],[1,"text-lg","font-semibold","text-teal-600","mb-2"],[1,"text-teal-600","font-semibold"],[1,"p-4","bg-red-50","rounded-lg","border-l-4","border-red-400"],[1,"text-lg","font-semibold","text-red-600","mb-2"],[1,"p-4","bg-yellow-50","rounded-lg","border-l-4","border-yellow-400"],[1,"text-lg","font-semibold","text-yellow-600","mb-2"],[1,"text-gray-700","mb-2"],[1,"p-4","bg-indigo-50","rounded-lg","border-l-4","border-indigo-400"],[1,"text-lg","font-semibold","text-indigo-600","mb-2"],[1,"text-xl","font-bold","mb-4","text-gray-800"],[1,"text-gray-700","mb-6","text-justify"],[1,"overflow-x-auto"],[1,"flex","gap-6","pb-4",2,"min-width","max-content"],["class","flex-shrink-0 bg-white/80 backdrop-blur-sm rounded-lg p-6 border border-gray-200 shadow-md hover:shadow-lg transition-shadow duration-200 flex flex-col justify-between","style","width: 350px; height: 350px;",4,"ngFor","ngForOf"],[1,"mt-8","p-4","bg-red-50","border","border-red-200","rounded-lg"],[1,"text-red-800","text-sm"],[1,"bg-gray-500/20","backdrop-blur-md","p-6","rounded-lg","border","border-gray-400/35","shadow-lg"],[3,"exercises","currentExerciseIndex","exerciseCompleted","nextExercise","previousExercise"],[3,"isVisible","title","componentType","componentInputs","onClose"],[1,"flex-shrink-0","bg-white/80","backdrop-blur-sm","rounded-lg","p-6","border","border-gray-200","shadow-md","hover:shadow-lg","transition-shadow","duration-200","flex","flex-col","justify-between",2,"width","350px","height","350px"],[1,"flex-1","flex","flex-col"],[1,"flex","items-center","mb-4"],[1,"text-3xl","mr-3"],[1,"text-lg","font-semibold","text-gray-800","line-clamp-2","leading-tight"],[1,"text-gray-600","text-sm","mb-4","leading-relaxed","line-clamp-4","flex-1"],[1,"mt-auto"],[1,"bg-red-50","p-3","rounded-lg","border-l-4","border-red-400","mb-4"],[1,"text-red-800","text-xs","font-medium","line-clamp-3"],[1,"w-full","bg-red-500","hover:bg-red-600","text-white","py-3","px-4","rounded","transition-colors","duration-200","text-sm","font-medium","shadow-md","hover:shadow-lg",3,"click"]],template:function(p,a){1&p&&(o.TgZ(0,"div",0)(1,"h1",1),o._uU(2,"\u{1f504} Estructuras de Control: Bucles"),o.qZA(),o.TgZ(3,"div",2),o._UZ(4,"div",3),o.qZA(),o.TgZ(5,"div",4),o._UZ(6,"div",5),o.qZA()(),o.TgZ(7,"div",6)(8,"div",7)(9,"div",8)(10,"div",9)(11,"h2",10),o._uU(12,"\u{1f501} \xbfQu\xe9 son los bucles o ciclos?"),o.qZA(),o.TgZ(13,"p",11),o._uU(14," Los bucles son estructuras de control que permiten repetir un conjunto de instrucciones m\xfaltiples veces de forma autom\xe1tica, evitando tener que escribir el mismo c\xf3digo una y otra vez. "),o.qZA(),o.TgZ(15,"p",11),o._uU(16," Es como tener un asistente que hace la misma tarea tantas veces como le indiques, o hasta que se cumpla cierta condici\xf3n. "),o.qZA(),o.TgZ(17,"div",12)(18,"p",13)(19,"strong"),o._uU(20,"Ejemplo:"),o.qZA()(),o.TgZ(21,"p",14),o._uU(22,'En lugar de escribir "Imprimir Hola" 100 veces...'),o.qZA(),o.TgZ(23,"p",14),o._uU(24,'Usas un bucle: "Repetir 100 veces: Imprimir Hola"'),o.qZA()()(),o.TgZ(25,"div",9)(26,"div",15)(27,"div",16)(28,"h3",17),o._uU(29,"\u{1f3af} Tipos principales de bucles"),o.qZA(),o.TgZ(30,"div",18)(31,"div")(32,"span",19),o._uU(33,"\u2022 For (Para):"),o.qZA(),o._uU(34,' Se usa cuando sabes exactamente cu\xe1ntas veces quieres repetir algo. Ejemplo: "Haz ejercicio 20 veces".'),o.qZA(),o.TgZ(35,"div")(36,"span",19),o._uU(37,"\u2022 While (Mientras):"),o.qZA(),o._uU(38,' Se repite mientras una condici\xf3n sea verdadera. Ejemplo: "Estudia mientras no entiendas el tema".'),o.qZA(),o.TgZ(39,"div")(40,"span",19),o._uU(41,"\u2022 Do-While (Hacer-Mientras):"),o.qZA(),o._uU(42," Hace algo al menos una vez, luego verifica si debe continuar."),o.qZA()()(),o.TgZ(43,"div",20)(44,"h3",21),o._uU(45,'\u{1f300} \xbfPor qu\xe9 se llaman "bucles"?'),o.qZA(),o.TgZ(46,"p",22),o._uU(47,' Se llaman bucles porque el c\xf3digo "da vueltas" o "se enrolla" como un bucle, volviendo al inicio para repetir las mismas instrucciones una y otra vez. '),o.qZA(),o.TgZ(48,"h4",23),o._uU(49,"\u{1f504} Visualizaci\xf3n"),o.qZA(),o.TgZ(50,"div",24)(51,"p",25),o._uU(52,"Piensa en una pista circular donde un corredor da vueltas:"),o.qZA(),o.TgZ(53,"p",25),o._uU(54,"Vuelta 1 \u2192 Vuelta 2 \u2192 Vuelta 3... hasta completar todas."),o.qZA()()(),o.TgZ(55,"div",26)(56,"h3",27),o._uU(57,"\u{1f3e0} Met\xe1fora: Tareas dom\xe9sticas"),o.qZA(),o.TgZ(58,"p",22),o._uU(59,' Imagina que tu mam\xe1 te dice: "Lava todos los platos sucios" '),o.qZA(),o.TgZ(60,"div",28)(61,"p",25)(62,"strong"),o._uU(63,"Paso 1:"),o.qZA(),o._uU(64," Tomar un plato"),o.qZA(),o.TgZ(65,"p",25)(66,"strong"),o._uU(67,"Paso 2:"),o.qZA(),o._uU(68," Lavarlo con jab\xf3n"),o.qZA(),o.TgZ(69,"p",25)(70,"strong"),o._uU(71,"Paso 3:"),o.qZA(),o._uU(72," Enjuagarlo"),o.qZA(),o.TgZ(73,"p",25)(74,"strong"),o._uU(75,"Paso 4:"),o.qZA(),o._uU(76," \xbfQuedan m\xe1s platos? Si s\xed \u2192 volver al Paso 1"),o.qZA(),o.TgZ(77,"p",29),o._uU(78,"\xa1Eso es exactamente un bucle while!"),o.qZA()()(),o.TgZ(79,"div",30)(80,"h3",31),o._uU(81,"\u26a1 \xbfCu\xe1ndo usar bucles?"),o.qZA(),o.TgZ(82,"p",22),o._uU(83," Los bucles son perfectos cuando necesitas: "),o.qZA(),o.TgZ(84,"div",24),o._uU(85," \u2022 Procesar listas de elementos (estudiantes, productos, etc.)"),o._UZ(86,"br"),o._uU(87," \u2022 Repetir c\xe1lculos matem\xe1ticos"),o._UZ(88,"br"),o._uU(89," \u2022 Validar datos hasta que sean correctos"),o._UZ(90,"br"),o._uU(91," \u2022 Crear patrones o secuencias"),o._UZ(92,"br"),o._uU(93," \u2022 Automatizar tareas repetitivas "),o.qZA()(),o.TgZ(94,"div",32)(95,"h3",33),o._uU(96,"\u{1f527} Elementos de un bucle"),o.qZA(),o.TgZ(97,"div",18)(98,"div")(99,"span",34),o._uU(100,"\u2022 Inicializaci\xf3n:"),o.qZA(),o._uU(101," Preparar variables (contador = 0)"),o.qZA(),o.TgZ(102,"div")(103,"span",34),o._uU(104,"\u2022 Condici\xf3n:"),o.qZA(),o._uU(105," \xbfCu\xe1ndo parar? (contador < 10)"),o.qZA(),o.TgZ(106,"div")(107,"span",34),o._uU(108,"\u2022 Cuerpo:"),o.qZA(),o._uU(109," Qu\xe9 hacer en cada repetici\xf3n"),o.qZA(),o.TgZ(110,"div")(111,"span",34),o._uU(112,"\u2022 Actualizaci\xf3n:"),o.qZA(),o._uU(113," Cambiar variables (contador + 1)"),o.qZA()()(),o.TgZ(114,"div",35)(115,"h3",36),o._uU(116,"\u{1f48e} Importancia de los bucles"),o.qZA(),o.TgZ(117,"p",22),o._uU(118," Los bucles son fundamentales porque: "),o.qZA(),o.TgZ(119,"div",24),o._uU(120," \u2022 Ahorran tiempo y l\xedneas de c\xf3digo"),o._UZ(121,"br"),o._uU(122," \u2022 Reducen errores de escritura repetitiva"),o._UZ(123,"br"),o._uU(124," \u2022 Permiten procesar grandes cantidades de datos"),o._UZ(125,"br"),o._uU(126," \u2022 Hacen el c\xf3digo m\xe1s legible y mantenible"),o._UZ(127,"br"),o._uU(128," \u2022 Son la base de la automatizaci\xf3n "),o.qZA()(),o.TgZ(129,"div",37)(130,"h3",38),o._uU(131,"\u{1f305} Ejemplos en la vida cotidiana"),o.qZA(),o.TgZ(132,"div",24)(133,"p",39)(134,"strong"),o._uU(135,"\u{1f3c3}\u200d\u2642\ufe0f Ejercicio:"),o.qZA(),o._uU(136,' "Haz 20 flexiones"'),o.qZA(),o.TgZ(137,"p",39)(138,"strong"),o._uU(139,"\u{1f4da} Estudiar:"),o.qZA(),o._uU(140,' "Repasa hasta entender el tema"'),o.qZA(),o.TgZ(141,"p",39)(142,"strong"),o._uU(143,"\u{1f373} Cocinar:"),o.qZA(),o._uU(144,' "Revuelve la sopa cada 5 minutos hasta que est\xe9 lista"'),o.qZA(),o.TgZ(145,"p",25)(146,"strong"),o._uU(147,"\u{1f3b5} M\xfasica:"),o.qZA(),o._uU(148,' "Reproduce esta canci\xf3n en modo repetir"'),o.qZA()()(),o.TgZ(149,"div",40)(150,"h3",41),o._uU(151,"\u{1f9ea} Curiosidades sobre bucles"),o.qZA(),o.TgZ(152,"div",18)(153,"p",25),o._uU(154,'\u2022 Un bucle infinito puede "colgar" un programa si no tiene condici\xf3n de parada'),o.qZA(),o.TgZ(155,"p",25),o._uU(156,"\u2022 Los bucles anidados (un bucle dentro de otro) pueden crear patrones complejos"),o.qZA(),o.TgZ(157,"p",25),o._uU(158,'\u2022 En algunos lenguajes, puedes "romper" un bucle con la palabra "break"'),o.qZA(),o.TgZ(159,"p",25),o._uU(160,"\u2022 Los videojuegos usan un bucle principal que se ejecuta 60 veces por segundo"),o.qZA()()()()()(),o.TgZ(161,"div",8)(162,"h2",42),o._uU(163,"\u{1f9ea} Ejemplos Din\xe1micos"),o.qZA(),o.TgZ(164,"p",43),o._uU(165," A continuaci\xf3n encontrar\xe1s ejemplos interactivos que demuestran c\xf3mo funcionan los bucles en situaciones cotidianas. Cada ejemplo incluye un diagrama de flujo que puedes visualizar paso a paso. "),o.qZA(),o.TgZ(166,"div",44)(167,"div",45),o.YNc(168,xn,15,4,"div",46),o.qZA()(),o.TgZ(169,"div",47)(170,"p",48)(171,"strong"),o._uU(172,"\u{1f4a1} Consejo:"),o.qZA(),o._uU(173," Los bucles son herramientas poderosas que automatizan tareas repetitivas. Observa c\xf3mo cada ejemplo usa diferentes tipos de repetici\xf3n seg\xfan la situaci\xf3n. "),o.qZA()()(),o.TgZ(174,"div",49)(175,"h2",42),o._uU(176,"\u{1f3af} Ejercicios Pr\xe1cticos"),o.qZA(),o.TgZ(177,"p",43),o._uU(178," Ahora es tu turno de practicar. Estos ejercicios te ayudar\xe1n a dominar los bucles usando programaci\xf3n visual con Blockly. Cada ejercicio te ense\xf1ar\xe1 un concepto espec\xedfico. "),o.qZA(),o.TgZ(179,"app-blockly-exercise",50),o.NdJ("exerciseCompleted",function(S){return a.onBlocklyExerciseCompleted(S)})("nextExercise",function(){return a.nextBlocklyExercise()})("previousExercise",function(){return a.previousBlocklyExercise()}),o.qZA()()()(),o.TgZ(180,"app-modal",51),o.NdJ("onClose",function(){return a.closeModal()}),o.qZA()),2&p&&(o.xp6(168),o.Q6J("ngForOf",a.examples),o.xp6(11),o.Q6J("exercises",a.blocklyExercises)("currentExerciseIndex",a.currentBlocklyExerciseIndex),o.xp6(1),o.Q6J("isVisible",a.showModal)("title",a.modalTitle)("componentType",a.modalComponentType)("componentInputs",a.modalComponentInputs))},dependencies:[V.sg,Oo,lo]})}}return h})();function ge(h,w){if(1&h){const r=o.EpF();o.TgZ(0,"div",51)(1,"div",52)(2,"h3",53)(3,"span",54),o._uU(4),o.qZA(),o._uU(5),o.qZA(),o.TgZ(6,"p",55),o._uU(7),o.qZA()(),o.TgZ(8,"div",56)(9,"p",57),o._uU(10),o.qZA()(),o.TgZ(11,"button",58),o.NdJ("click",function(){const _=o.CHM(r).$implicit,S=o.oxw();return o.KtG(S.openFlowchartModal(_))}),o._uU(12," \u{1f680} Ver Diagrama de Flujo "),o.qZA()()}if(2&h){const r=w.$implicit,p=o.oxw();o.xp6(4),o.Oqu(p.getIconForExample(r.title)),o.xp6(1),o.hij(" ",p.getCleanTitle(r.title)," "),o.xp6(2),o.hij(" ",r.description," "),o.xp6(3),o.Oqu(r.question)}}let da=(()=>{class h{constructor(r){this.http=r,this.examples=[],this.showModal=!1,this.modalTitle="",this.modalComponentType=null,this.modalComponentInputs={},this.blocklyExercises=[],this.currentBlocklyExerciseIndex=0,this.completedExercises=new Set}ngOnInit(){this.loadExamples(),this.loadBlocklyExercises()}loadExamples(){this.http.get("assets/jsons-base/modulos.json").subscribe({next:r=>{this.examples=r.condicionales.examples||[]},error:r=>{console.error("Error loading examples:",r)}})}loadBlocklyExercises(){this.http.get("assets/jsons-base/blockly-exercises.json").subscribe({next:r=>{r.condicionales&&r.condicionales.exercises&&(this.blocklyExercises=r.condicionales.exercises,console.log("Blockly exercises loaded:",this.blocklyExercises.length))},error:r=>{console.error("Error cargando ejercicios de Blockly:",r)}})}getIconForExample(r){return r.includes("parque")||r.includes("Carlos")?"\u{1f333}":r.includes("tienda")||r.includes("Ana")?"\u{1f457}":r.includes("bicicleta")||r.includes("Luis")?"\u{1f6b4}\u200d\u2642\ufe0f":r.includes("t\xe9")||r.includes("Sof\xeda")?"\u{1f375}":r.includes("reuni\xf3n")||r.includes("Pedro")?"\u{1f4bc}":r.includes("comida")||r.includes("Mariana")?"\u{1f35e}":r.includes("videojuego")||r.includes("Javier")?"\u{1f3ae}":"\u{1f504}"}getCleanTitle(r){return r.replace(/^Ejemplo \d+:\s*/,"")}get currentBlocklyExercise(){return this.blocklyExercises[this.currentBlocklyExerciseIndex]||null}onBlocklyExerciseCompleted(r){r.success&&(this.completedExercises.add(r.exerciseId),console.log("Ejercicio completado:",r.exerciseId))}nextBlocklyExercise(){this.currentBlocklyExerciseIndex<this.blocklyExercises.length-1&&this.currentBlocklyExerciseIndex++}previousBlocklyExercise(){this.currentBlocklyExerciseIndex>0&&this.currentBlocklyExerciseIndex--}openFlowchartModal(r){this.modalTitle=`\u{1f504} Diagrama de Flujo - ${this.getCleanTitle(r.title)}`,this.modalComponentType=dt,this.modalComponentInputs={steps:r.steps||[],title:r.title},this.showModal=!0}closeModal(){this.showModal=!1,this.modalTitle="",this.modalComponentType=null,this.modalComponentInputs={}}static{this.\u0275fac=function(p){return new(p||h)(o.Y36(Ee.eN))}}static{this.\u0275cmp=o.Xpm({type:h,selectors:[["app-condicionales"]],decls:137,vars:7,consts:[[1,"text-center","mb-6","mt-6"],[1,"text-3xl","font-bold","text-gray-800","mb-2","drop-shadow-md"],[1,"flex","items-center","justify-center","mb-1"],[1,"h-0.5","bg-gradient-to-r","from-transparent","via-blue-500","to-transparent","w-96","shadow-sm"],[1,"flex","items-center","justify-center"],[1,"h-px","bg-gradient-to-r","from-transparent","via-gray-300","to-transparent","w-64","opacity-60"],[1,"min-h-screen"],[1,"flex","flex-col","gap-6","p-4","mx-8"],[1,"bg-gray-500/20","backdrop-blur-md","p-6","rounded-lg","border","border-gray-400/30","shadow-lg"],[1,"mb-6"],[1,"text-xl","font-bold","mb-3","text-gray-800"],[1,"text-gray-700","leading-relaxed","mb-4","text-justify"],[1,"bg-blue-50","p-3","rounded","border-l-4","border-blue-400","mb-4"],[1,"text-blue-800","text-sm","font-medium","mb-2"],[1,"text-gray-700","text-sm"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"p-4","bg-teal-50","rounded-lg","border-l-4","border-teal-400"],[1,"text-lg","font-semibold","text-teal-600","mb-2"],[1,"bg-white","p-3","rounded","border","text-sm","space-y-2"],[1,"text-teal-600","font-semibold"],[1,"p-4","bg-blue-50","rounded-lg","border-l-4","border-blue-400"],[1,"text-lg","font-semibold","text-blue-600","mb-2"],[1,"text-gray-700","text-justify","mb-3"],[1,"text-md","font-semibold","text-blue-600","mb-2"],[1,"bg-white","p-3","rounded","border","text-sm"],[1,"text-gray-700","mb-2"],[1,"text-gray-700"],[1,"p-4","bg-purple-50","rounded-lg","border-l-4","border-purple-400"],[1,"text-lg","font-semibold","text-purple-600","mb-2"],[1,"bg-white","p-3","rounded","border","text-sm","space-y-1"],[1,"text-gray-700","mt-2"],[1,"p-4","bg-orange-50","rounded-lg","border-l-4","border-orange-400"],[1,"text-lg","font-semibold","text-orange-600","mb-2"],[1,"p-4","bg-red-50","rounded-lg","border-l-4","border-red-400"],[1,"text-lg","font-semibold","text-red-600","mb-2"],[1,"p-4","bg-indigo-50","rounded-lg","border-l-4","border-indigo-400"],[1,"text-lg","font-semibold","text-indigo-600","mb-2"],[1,"bg-white","p-3","rounded","border","font-mono","text-sm"],[1,"text-blue-600"],[1,"text-red-600"],[1,"text-purple-600"],[1,"text-green-600"],[1,"text-xl","font-bold","mb-4","text-gray-800"],[1,"text-gray-700","mb-6","text-justify"],[1,"overflow-x-auto"],[1,"flex","gap-6","pb-4",2,"min-width","max-content"],["class","bg-white/60 backdrop-blur-sm p-6 rounded-lg shadow-md border border-gray-300/50 flex flex-col flex-shrink-0","style","width: 300px; height: 300px;",4,"ngFor","ngForOf"],[1,"mt-8","p-4","bg-blue-50","border","border-blue-200","rounded-lg"],[1,"text-blue-800","text-sm"],[3,"exercises","currentExerciseIndex","exerciseCompleted","nextExercise","previousExercise"],[3,"isVisible","title","componentType","componentInputs","onClose"],[1,"bg-white/60","backdrop-blur-sm","p-6","rounded-lg","shadow-md","border","border-gray-300/50","flex","flex-col","flex-shrink-0",2,"width","300px","height","300px"],[1,"flex-grow","overflow-hidden"],[1,"font-bold","text-lg","text-gray-800","mb-3","line-clamp-2","flex","items-center"],[1,"text-2xl","mr-2"],[1,"text-sm","text-gray-600","text-justify","mb-4","line-clamp-3"],[1,"mb-4","p-2","bg-blue-50","rounded","border-l-4","border-blue-400"],[1,"text-blue-800","text-xs","font-medium","line-clamp-2"],[1,"w-full","bg-blue-500","hover:bg-blue-600","text-white","py-2","px-4","rounded","transition-colors","duration-200","text-sm","font-medium",3,"click"]],template:function(p,a){1&p&&(o.TgZ(0,"div",0)(1,"h1",1),o._uU(2,"\u{1f500} Estructuras Condicionales"),o.qZA(),o.TgZ(3,"div",2),o._UZ(4,"div",3),o.qZA(),o.TgZ(5,"div",4),o._UZ(6,"div",5),o.qZA()(),o.TgZ(7,"div",6)(8,"div",7)(9,"div",8)(10,"div",9)(11,"h2",10),o._uU(12,"\u{1f9e0} \xbfQu\xe9 es una estructura condicional?"),o.qZA(),o.TgZ(13,"p",11),o._uU(14," En programaci\xf3n, una estructura condicional es una instrucci\xf3n que permite que el programa tome decisiones dependiendo de si una condici\xf3n es verdadera o falsa. "),o.qZA(),o.TgZ(15,"p",11),o._uU(16," Es como si el programa se encontrara con una pregunta y, seg\xfan la respuesta, siguiera un camino u otro. "),o.qZA(),o.TgZ(17,"div",12)(18,"p",13)(19,"strong"),o._uU(20,"Ejemplo:"),o.qZA()(),o.TgZ(21,"p",14),o._uU(22,"Si tienes hambre \u2192 comes."),o.qZA(),o.TgZ(23,"p",14),o._uU(24,"Si no tienes hambre \u2192 no comes."),o.qZA()()(),o.TgZ(25,"div",9)(26,"div",15)(27,"div",16)(28,"h3",17),o._uU(29,"\u{1f527} Elementos fundamentales de una estructura condicional"),o.qZA(),o.TgZ(30,"div",18)(31,"div")(32,"span",19),o._uU(33,"\u2022 Condici\xf3n:"),o.qZA(),o._uU(34," Es una comparaci\xf3n o evaluaci\xf3n que puede dar como resultado verdadero o falso. Ejemplo: edad >= 18 (\xbfEs la edad mayor o igual a 18?)"),o.qZA(),o.TgZ(35,"div")(36,"span",19),o._uU(37,"\u2022 Bloque verdadero:"),o.qZA(),o._uU(38," Son las instrucciones que se ejecutan si la condici\xf3n se cumple (es verdadera)."),o.qZA(),o.TgZ(39,"div")(40,"span",19),o._uU(41,"\u2022 Bloque falso:"),o.qZA(),o._uU(42," Son las instrucciones que se ejecutan si la condici\xf3n no se cumple (es falsa)."),o.qZA(),o.TgZ(43,"div")(44,"span",19),o._uU(45,"\u2022 Camino alternativo:"),o.qZA(),o._uU(46," Algunas estructuras condicionales permiten evaluar m\xe1s de una condici\xf3n con else if o condicionales anidados."),o.qZA()()(),o.TgZ(47,"div",20)(48,"h3",21),o._uU(49,'\u{1f393} \xbfPor qu\xe9 se llaman "condicionales"?'),o.qZA(),o.TgZ(50,"p",22),o._uU(51," Porque la ejecuci\xf3n del c\xf3digo depende de una condici\xf3n que se debe cumplir. Si la condici\xf3n es verdadera, el programa hace una cosa. Si es falsa, hace otra o no hace nada. "),o.qZA(),o.TgZ(52,"h4",23),o._uU(53,"\u{1f4cd} Ejemplo en la vida real"),o.qZA(),o.TgZ(54,"div",24)(55,"p",25),o._uU(56,"Si en el sem\xe1foro hay luz verde \u2192 avanzas."),o.qZA(),o.TgZ(57,"p",26),o._uU(58,"Si no hay luz verde (amarilla o roja) \u2192 te detienes o esperas."),o.qZA()()(),o.TgZ(59,"div",27)(60,"h3",28),o._uU(61,"\u{1f4e6} Met\xe1fora: Camino con bifurcaciones"),o.qZA(),o.TgZ(62,"p",22),o._uU(63," Imagina que vas caminando y llegas a una bifurcaci\xf3n con dos letreros: "),o.qZA(),o.TgZ(64,"div",29)(65,"p",26),o._uU(66,'Uno dice "Si est\xe1 soleado \u2192 sigue por aqu\xed hacia el parque".'),o.qZA(),o.TgZ(67,"p",26),o._uU(68,'Otro dice "Si est\xe1 lloviendo \u2192 sigue por aqu\xed hacia el caf\xe9".'),o.qZA(),o.TgZ(69,"p",30),o._uU(70,"En ese punto, observas el clima (condici\xf3n) y tomas el camino seg\xfan el resultado. El programa hace exactamente lo mismo: eval\xfaa la condici\xf3n y ejecuta la ruta de instrucciones correspondiente."),o.qZA()()(),o.TgZ(71,"div",31)(72,"h3",32),o._uU(73,"\u{1f5a5} \xbfD\xf3nde se usan los condicionales?"),o.qZA(),o.TgZ(74,"p",22),o._uU(75," Los condicionales est\xe1n en casi todo tipo de programa: "),o.qZA(),o.TgZ(76,"div",24),o._uU(77," \u2022 Para verificar permisos de acceso."),o._UZ(78,"br"),o._uU(79," \u2022 Para decidir si un usuario ve cierta informaci\xf3n."),o._UZ(80,"br"),o._uU(81," \u2022 Para ejecutar una acci\xf3n solo si hay datos disponibles."),o._UZ(82,"br"),o._uU(83," \u2022 Para determinar qu\xe9 mensaje mostrar dependiendo de una respuesta."),o._UZ(84,"br"),o._uU(85," \u2022 Para controlar el flujo de un videojuego (ganar, perder, seguir). "),o.qZA()(),o.TgZ(86,"div",33)(87,"h3",34),o._uU(88,"\u{1f9e0} Importancia de las estructuras condicionales"),o.qZA(),o.TgZ(89,"p",22),o._uU(90," Las estructuras condicionales son esenciales porque: "),o.qZA(),o.TgZ(91,"div",24),o._uU(92," \u2022 Permiten adaptar el comportamiento del programa a diferentes situaciones."),o._UZ(93,"br"),o._uU(94," \u2022 Son la base para tomar decisiones complejas."),o._UZ(95,"br"),o._uU(96," \u2022 Combinadas con variables, bucles y funciones, hacen que el programa sea flexible e interactivo. "),o.qZA()(),o.TgZ(97,"div",35)(98,"h3",36),o._uU(99,"\u{1f9ea} Curiosidades"),o.qZA(),o.TgZ(100,"p",22),o._uU(101," Algunos lenguajes permiten condicionales en una sola l\xednea, como en Python: "),o.qZA(),o.TgZ(102,"div",37)(103,"span",38),o._uU(104,"mensaje"),o.qZA(),o._uU(105," = "),o.TgZ(106,"span",39),o._uU(107,'"Mayor de edad"'),o.qZA(),o.TgZ(108,"span",40),o._uU(109,"if"),o.qZA(),o._uU(110," edad >= "),o.TgZ(111,"span",41),o._uU(112,"18"),o.qZA(),o.TgZ(113,"span",40),o._uU(114,"else"),o.qZA(),o.TgZ(115,"span",39),o._uU(116,'"Menor de edad"'),o.qZA()()()()()(),o.TgZ(117,"div",8)(118,"h2",42),o._uU(119,"\u{1f9ea} Ejemplos Din\xe1micos"),o.qZA(),o.TgZ(120,"p",43),o._uU(121," A continuaci\xf3n encontrar\xe1s ejemplos interactivos que demuestran c\xf3mo funcionan las estructuras condicionales en situaciones cotidianas. Cada ejemplo incluye un diagrama de flujo que puedes visualizar paso a paso. "),o.qZA(),o.TgZ(122,"div",44)(123,"div",45),o.YNc(124,ge,13,4,"div",46),o.qZA()(),o.TgZ(125,"div",47)(126,"p",48)(127,"strong"),o._uU(128,"\u{1f4a1} Consejo:"),o.qZA(),o._uU(129," Las estructuras condicionales son la base para crear programas que tomen decisiones inteligentes. Observa c\xf3mo cada ejemplo eval\xfaa una condici\xf3n y toma diferentes caminos seg\xfan el resultado. "),o.qZA()()(),o.TgZ(130,"div",8)(131,"h2",42),o._uU(132,"\u{1f3af} Ejercicios Pr\xe1cticos"),o.qZA(),o.TgZ(133,"p",43),o._uU(134," Ahora es tu turno de practicar. Estos ejercicios te ayudar\xe1n a dominar las estructuras condicionales usando programaci\xf3n visual con Blockly. Cada ejercicio te ense\xf1ar\xe1 un concepto espec\xedfico. "),o.qZA(),o.TgZ(135,"app-blockly-exercise",49),o.NdJ("exerciseCompleted",function(S){return a.onBlocklyExerciseCompleted(S)})("nextExercise",function(){return a.nextBlocklyExercise()})("previousExercise",function(){return a.previousBlocklyExercise()}),o.qZA()()()(),o.TgZ(136,"app-modal",50),o.NdJ("onClose",function(){return a.closeModal()}),o.qZA()),2&p&&(o.xp6(124),o.Q6J("ngForOf",a.examples),o.xp6(11),o.Q6J("exercises",a.blocklyExercises)("currentExerciseIndex",a.currentBlocklyExerciseIndex),o.xp6(1),o.Q6J("isVisible",a.showModal)("title",a.modalTitle)("componentType",a.modalComponentType)("componentInputs",a.modalComponentInputs))},dependencies:[V.sg,Oo,lo],styles:[".line-clamp-2[_ngcontent-%COMP%]{display:-webkit-box;-webkit-line-clamp:2;line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}.line-clamp-3[_ngcontent-%COMP%]{display:-webkit-box;-webkit-line-clamp:3;line-clamp:3;-webkit-box-orient:vertical;overflow:hidden}.bg-white\\/60[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 16px #00000026;transition:all .2s ease-in-out}"]})}}return h})();const bi=["flowchartRef"];function fi(h,w){1&h&&(o.TgZ(0,"h2",62),o._uU(1,"\u{1f4a1} Ejemplos Din\xe1micos"),o.qZA())}function ha(h,w){1&h&&(o.TgZ(0,"h2",62),o._uU(1,"\u{1f3af} Ejercicios de Pr\xe1ctica"),o.qZA())}function Xr(h,w){if(1&h){const r=o.EpF();o.TgZ(0,"div",18)(1,"h4",72),o._uU(2),o.qZA(),o.TgZ(3,"p",73),o._uU(4),o.qZA(),o.TgZ(5,"div",74)(6,"p",75),o._uU(7),o.qZA()(),o.TgZ(8,"div",76)(9,"button",77),o.NdJ("click",function(){o.CHM(r);const a=o.oxw(2);return o.KtG(a.previousExample())}),o.O4$(),o.TgZ(10,"svg",78),o._UZ(11,"path",79),o.qZA()(),o.kcU(),o.TgZ(12,"span",80),o._uU(13),o.qZA(),o.TgZ(14,"button",81),o.NdJ("click",function(){o.CHM(r);const a=o.oxw(2);return o.KtG(a.nextExample())}),o.O4$(),o.TgZ(15,"svg",78),o._UZ(16,"path",82),o.qZA()()()()}if(2&h){const r=o.oxw(2);o.xp6(2),o.Oqu(r.currentExample.title),o.xp6(2),o.Oqu(r.currentExample.description),o.xp6(3),o.Oqu(r.currentExample.question),o.xp6(2),o.Udp("background-color",r.canGoPreviousExample?"#f3ae22":"")("border-color",r.canGoPreviousExample?"#d18c00":""),o.ekj("opacity-50",!r.canGoPreviousExample)("cursor-not-allowed",!r.canGoPreviousExample),o.Q6J("disabled",!r.canGoPreviousExample),o.xp6(4),o.AsE(" ",r.currentExampleIndex+1," de ",r.examples.length," "),o.xp6(1),o.ekj("opacity-50",!r.canGoNextExample)("cursor-not-allowed",!r.canGoNextExample),o.Q6J("disabled",!r.canGoNextExample)}}function kn(h,w){1&h&&(o.TgZ(0,"div",83)(1,"p"),o._uU(2,"Cargando ejemplos..."),o.qZA()())}function Ti(h,w){if(1&h&&(o.TgZ(0,"div",84),o._UZ(1,"app-flowchart",85,86),o.qZA()),2&h){const r=o.oxw(2);o.xp6(1),o.Q6J("steps",r.currentExampleSteps)("title",r.currentExample.title)}}function Kr(h,w){1&h&&(o.TgZ(0,"div",87)(1,"p",88),o._uU(2,"Selecciona un ejemplo para ver su diagrama de flujo"),o.qZA()())}function No(h,w){1&h&&(o.TgZ(0,"div",87)(1,"p",88),o._uU(2,"No hay pasos disponibles para este ejemplo"),o.qZA()())}function bs(h,w){if(1&h&&(o.TgZ(0,"div",63)(1,"div",64)(2,"div",65),o.YNc(3,Xr,17,19,"div",66),o.YNc(4,kn,3,0,"div",67),o.qZA(),o.TgZ(5,"div",68)(6,"h3",69),o._uU(7,"\u{1f504} Paso a Paso"),o.qZA(),o.YNc(8,Ti,3,2,"div",70),o.YNc(9,Kr,3,0,"div",71),o.YNc(10,No,3,0,"div",71),o.qZA()()()),2&h){const r=o.oxw();o.xp6(3),o.Q6J("ngIf",r.currentExample),o.xp6(1),o.Q6J("ngIf",!r.currentExample),o.xp6(4),o.Q6J("ngIf",r.currentExample&&r.currentExampleSteps.length>0),o.xp6(1),o.Q6J("ngIf",!r.currentExample),o.xp6(1),o.Q6J("ngIf",r.currentExample&&0===r.currentExampleSteps.length)}}function Jr(h,w){if(1&h){const r=o.EpF();o.TgZ(0,"div",63)(1,"app-blockly-exercise",89),o.NdJ("exerciseCompleted",function(a){o.CHM(r);const _=o.oxw();return o.KtG(_.onExerciseCompleted(a))})("nextExercise",function(){o.CHM(r);const a=o.oxw();return o.KtG(a.onNextBlocklyExercise())})("previousExercise",function(){o.CHM(r);const a=o.oxw();return o.KtG(a.onPreviousBlocklyExercise())}),o.qZA()()}if(2&h){const r=o.oxw();o.xp6(1),o.Q6J("exercises",r.blocklyExercises)("currentExerciseIndex",r.currentBlocklyExerciseIndex)}}function Qr(h,w){1&h&&(o.TgZ(0,"div",90)(1,"div",91),o._uU(2,"\u{1f3af}"),o.qZA(),o.TgZ(3,"h2",92),o._uU(4,"Selecciona una opci\xf3n"),o.qZA(),o.TgZ(5,"p",93),o._uU(6,"Elige entre ejemplos o ejercicios para comenzar"),o.qZA()())}let pa=(()=>{class h{constructor(r){this.http=r,this.activeSection=null,this.examples=[],this.currentExampleIndex=0,this.currentExample=null,this.blocklyExercises=[],this.currentBlocklyExerciseIndex=0,this.completedExercises=new Set}ngOnInit(){this.loadExamples(),this.loadBlocklyExercises()}loadExamples(){this.http.get("assets/jsons-base/modulos.json").subscribe({next:r=>{this.examples=r.variables.examples,this.currentExample=this.examples[0],console.log("Variables examples loaded:",this.examples.length)},error:r=>{console.error("Error cargando ejemplos de variables:",r)}})}loadBlocklyExercises(){this.http.get("assets/jsons-base/blockly-exercises.json").subscribe({next:r=>{r.variables&&r.variables.exercises&&(this.blocklyExercises=r.variables.exercises,console.log("Blockly exercises loaded:",this.blocklyExercises.length))},error:r=>{console.error("Error cargando ejercicios de Blockly:",r)}})}showExamples(){this.activeSection="examples"}showPractice(){this.activeSection="practice"}previousExample(){this.currentExampleIndex>0&&(this.currentExampleIndex--,this.currentExample=this.examples[this.currentExampleIndex],this.resetFlowchart())}nextExample(){this.currentExampleIndex<this.examples.length-1&&(this.currentExampleIndex++,this.currentExample=this.examples[this.currentExampleIndex],this.resetFlowchart())}resetFlowchart(){setTimeout(()=>{this.flowchartComponent&&this.flowchartComponent.resetSteps()},0)}get canGoPreviousExample(){return this.currentExampleIndex>0}get canGoNextExample(){return this.currentExampleIndex<this.examples.length-1}get currentExampleSteps(){return this.currentExample?.steps||[]}onExerciseCompleted(r){r.success&&(this.completedExercises.add(r.exerciseId),console.log("Ejercicio completado:",r.exerciseId))}onNextBlocklyExercise(){this.currentBlocklyExerciseIndex++}onPreviousBlocklyExercise(){this.currentBlocklyExerciseIndex>0&&this.currentBlocklyExerciseIndex--}static{this.\u0275fac=function(p){return new(p||h)(o.Y36(Ee.eN))}}static{this.\u0275cmp=o.Xpm({type:h,selectors:[["app-concepto-variables"]],viewQuery:function(p,a){if(1&p&&o.Gf(bi,5),2&p){let _;o.iGM(_=o.CRH())&&(a.flowchartComponent=_.first)}},decls:190,vars:29,consts:[[1,"text-center","mb-8","mt-6"],[1,"text-3xl","font-bold","text-gray-800","mb-2","drop-shadow-md"],[1,"flex","items-center","justify-center","mb-1"],[1,"h-0.5","bg-gradient-to-r","from-transparent","via-blue-500","to-transparent","w-96","shadow-sm"],[1,"flex","items-center","justify-center"],[1,"h-px","bg-gradient-to-r","from-transparent","via-gray-300","to-transparent","w-64","opacity-60"],[1,"min-h-screen"],[1,"flex","flex-col","gap-6","p-4","mx-8"],[1,"bg-gray-500/20","backdrop-blur-md","p-6","rounded-lg","border","border-gray-400/30","shadow-lg"],[1,"mb-6"],[1,"text-xl","font-bold","mb-3","text-gray-800"],[1,"text-gray-700","leading-relaxed","mb-4","text-justify"],[1,"p-4","bg-teal-50","rounded-lg","border-l-4","border-teal-400"],[1,"text-lg","font-semibold","text-teal-600","mb-2"],[1,"text-gray-700","text-justify","mb-3"],[1,"bg-white","p-3","rounded","border","text-sm","space-y-2"],[1,"text-teal-600","font-semibold"],[1,"text-xl","font-bold","mb-5","text-gray-800"],[1,"space-y-4"],[1,"p-4","bg-blue-50","rounded-lg","border-l-4","border-blue-400"],[1,"text-lg","font-semibold","text-blue-600","mb-2"],[1,"bg-white","p-3","rounded","border","font-mono","text-sm"],[1,"text-blue-600"],[1,"text-green-600"],[1,"text-gray-500"],[1,"p-4","bg-green-50","rounded-lg","border-l-4","border-green-400"],[1,"text-lg","font-semibold","text-green-600","mb-2"],[1,"bg-white","p-3","rounded","border","text-sm"],[1,"p-4","bg-yellow-50","rounded-lg","border-l-4","border-yellow-400"],[1,"text-lg","font-semibold","text-yellow-600","mb-2"],[1,"bg-white","p-3","rounded","border","overflow-x-auto"],[1,"w-full","text-sm"],[1,"bg-gray-50"],[1,"px-3","py-2","text-left","font-semibold","text-gray-700","border-b"],[1,"border-b"],[1,"px-3","py-2","font-mono","text-blue-600"],[1,"px-3","py-2","text-gray-700"],[1,"px-3","py-2","font-mono","text-red-600"],[1,"px-3","py-2","font-mono","text-green-600"],[1,"px-3","py-2","font-mono","text-orange-600"],[1,"px-3","py-2","font-mono","text-indigo-600"],[1,"p-4","bg-purple-50","rounded-lg","border-l-4","border-purple-400"],[1,"text-lg","font-semibold","text-purple-600","mb-2"],[1,"p-4","bg-red-50","rounded-lg","border-l-4","border-red-400"],[1,"text-lg","font-semibold","text-red-600","mb-2"],[1,"p-4","bg-indigo-50","rounded-lg","border-l-4","border-indigo-400"],[1,"text-lg","font-semibold","text-indigo-600","mb-2"],[1,"text-purple-600"],[1,"text-red-600"],["class","text-xl font-bold text-gray-800",4,"ngIf"],[1,"flex","min-h-[600px]","items-center"],[1,"flex","flex-col","items-center","justify-center","space-y-4","mr-6"],[1,"relative","group"],[1,"w-14","h-14","text-white","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border-2",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"],[1,"absolute","left-16","top-1/2","transform","-translate-y-1/2","bg-gray-800","text-white","text-xs","rounded","py-1","px-2","opacity-0","group-hover:opacity-100","transition-opacity","duration-200","whitespace-nowrap","z-10"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"],[1,"flex-1","flex","items-center","justify-center"],["class","w-full",4,"ngIf"],["class","text-center w-full",4,"ngIf"],[1,"pb-8"],[1,"text-xl","font-bold","text-gray-800"],[1,"w-full"],[1,"grid","grid-cols-2","gap-4","w-full","items-center"],[1,"min-h-[400px]","flex","flex-col","justify-center"],["class","space-y-4",4,"ngIf"],["class","text-center text-gray-500",4,"ngIf"],[1,"min-h-[400px]"],[1,"text-lg","font-semibold","text-gray-800","mb-4"],["class","min-h-[350px]",4,"ngIf"],["class","text-center text-gray-500 mt-8",4,"ngIf"],[1,"text-base","font-semibold","text-blue-600"],[1,"text-gray-700","text-justify","leading-relaxed","text-sm"],[1,"bg-blue-50","p-3","rounded-lg","border-l-4","border-blue-400"],[1,"text-blue-800","font-medium","text-sm"],[1,"flex","justify-between","items-center","pt-4","border-t","border-gray-200"],[1,"w-10","h-10","text-white","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border-2","disabled:bg-gray-400","disabled:border-gray-300","disabled:hover:bg-gray-400",3,"disabled","click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[1,"text-sm","text-green-600","font-bold"],[1,"w-10","h-10","bg-blue-600","hover:bg-blue-700","text-white","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border-2","border-blue-800","disabled:bg-gray-400","disabled:border-gray-300","disabled:hover:bg-gray-400",3,"disabled","click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],[1,"text-center","text-gray-500"],[1,"min-h-[350px]"],[3,"steps","title"],["flowchartRef",""],[1,"text-center","text-gray-500","mt-8"],[1,"text-sm"],[3,"exercises","currentExerciseIndex","exerciseCompleted","nextExercise","previousExercise"],[1,"text-center","w-full"],[1,"text-6xl","mb-4"],[1,"text-xl","font-bold","mb-2","text-gray-800"],[1,"text-gray-600"]],template:function(p,a){1&p&&(o.TgZ(0,"div",0)(1,"h1",1),o._uU(2,"\u{1f4e6} Concepto de Variables"),o.qZA(),o.TgZ(3,"div",2),o._UZ(4,"div",3),o.qZA(),o.TgZ(5,"div",4),o._UZ(6,"div",5),o.qZA()(),o.TgZ(7,"div",6)(8,"div",7)(9,"div",8)(10,"div",9)(11,"h2",10),o._uU(12,"\u{1f9e0} \xbfQu\xe9 es una variable?"),o.qZA(),o.TgZ(13,"p",11),o._uU(14," En programaci\xf3n, una variable es un espacio de memoria reservado para guardar datos que pueden cambiar durante la ejecuci\xf3n de un programa. Estos datos pueden ser n\xfameros, textos, im\xe1genes, sonidos, valores booleanos (verdadero/falso), entre otros. "),o.qZA(),o.TgZ(15,"div",12)(16,"h3",13),o._uU(17,"\u{1f527} Elementos fundamentales de una variable"),o.qZA(),o.TgZ(18,"p",14),o._uU(19," Una variable tiene tres elementos fundamentales: "),o.qZA(),o.TgZ(20,"div",15)(21,"div")(22,"span",16),o._uU(23,"\u2022 Nombre:"),o.qZA(),o._uU(24," Es el identificador \xfanico de la variable. Como una etiqueta que permite acceder a su contenido."),o.qZA(),o.TgZ(25,"div")(26,"span",16),o._uU(27,"\u2022 Tipo de dato:"),o.qZA(),o._uU(28," Define el tipo de informaci\xf3n que la variable puede almacenar. Ejemplos: entero, texto, decimal, imagen."),o.qZA(),o.TgZ(29,"div")(30,"span",16),o._uU(31,"\u2022 Valor:"),o.qZA(),o._uU(32," Es el contenido actual que guarda la variable."),o.qZA()()()(),o.TgZ(33,"div",9)(34,"h2",17),o._uU(35,'\u{1f393} \xbfPor qu\xe9 se llaman "variables"?'),o.qZA(),o.TgZ(36,"div",18)(37,"div",19)(38,"h3",20),o._uU(39,"\u{1f504} Porque su valor puede cambiar"),o.qZA(),o.TgZ(40,"p",14),o._uU(41," Por ejemplo, si declaras una variable llamada edad, podr\xedas modificar su valor as\xed: "),o.qZA(),o.TgZ(42,"div",21)(43,"span",22),o._uU(44,"edad"),o.qZA(),o._uU(45," = "),o.TgZ(46,"span",23),o._uU(47,"15"),o.qZA(),o._UZ(48,"br"),o.TgZ(49,"span",24),o._uU(50,"# M\xe1s tarde en el programa..."),o.qZA(),o._UZ(51,"br"),o.TgZ(52,"span",22),o._uU(53,"edad"),o.qZA(),o._uU(54," = "),o.TgZ(55,"span",23),o._uU(56,"16"),o.qZA()()(),o.TgZ(57,"div",25)(58,"h3",26),o._uU(59,"\u{1f4e6} Met\xe1fora: Caja con etiqueta"),o.qZA(),o.TgZ(60,"p",14),o._uU(61,' Imagina que tienes una caja con una etiqueta que dice "Nombre". Dentro puedes guardar un papel que diga "Camila". '),o.qZA(),o.TgZ(62,"div",27)(63,"span",23),o._uU(64,"La caja"),o.qZA(),o._uU(65," = la variable"),o._UZ(66,"br"),o.TgZ(67,"span",23),o._uU(68,"La etiqueta"),o.qZA(),o._uU(69," = el nombre"),o._UZ(70,"br"),o.TgZ(71,"span",23),o._uU(72,"El papel dentro"),o.qZA(),o._uU(73," = el valor "),o.qZA()(),o.TgZ(74,"div",28)(75,"h3",29),o._uU(76,"\u{1f9fe} Ejemplo con distintos tipos de variables"),o.qZA(),o.TgZ(77,"div",30)(78,"table",31)(79,"thead",32)(80,"tr")(81,"th",33),o._uU(82,"Variable"),o.qZA(),o.TgZ(83,"th",33),o._uU(84,"Tipo"),o.qZA(),o.TgZ(85,"th",33),o._uU(86,"Valor"),o.qZA()()(),o.TgZ(87,"tbody")(88,"tr",34)(89,"td",35),o._uU(90,"nombre"),o.qZA(),o.TgZ(91,"td",36),o._uU(92,"Texto"),o.qZA(),o.TgZ(93,"td",37),o._uU(94,'"Luc\xeda"'),o.qZA()(),o.TgZ(95,"tr",34)(96,"td",35),o._uU(97,"edad"),o.qZA(),o.TgZ(98,"td",36),o._uU(99,"N\xfamero"),o.qZA(),o.TgZ(100,"td",38),o._uU(101,"21"),o.qZA()(),o.TgZ(102,"tr",34)(103,"td",35),o._uU(104,"altura"),o.qZA(),o.TgZ(105,"td",36),o._uU(106,"Decimal"),o.qZA(),o.TgZ(107,"td",39),o._uU(108,"1.65"),o.qZA()(),o.TgZ(109,"tr")(110,"td",35),o._uU(111,"esEstudiante"),o.qZA(),o.TgZ(112,"td",36),o._uU(113,"Booleano"),o.qZA(),o.TgZ(114,"td",40),o._uU(115,"true"),o.qZA()()()()()(),o.TgZ(116,"div",41)(117,"h3",42),o._uU(118,"\u{1f5a5} \xbfD\xf3nde se usan las variables?"),o.qZA(),o.TgZ(119,"p",14),o._uU(120," Las variables se usan en casi todo dentro de un programa: "),o.qZA(),o.TgZ(121,"div",27),o._uU(122," \u2022 Para mostrar informaci\xf3n al usuario"),o._UZ(123,"br"),o._uU(124," \u2022 Para hacer c\xe1lculos"),o._UZ(125,"br"),o._uU(126," \u2022 Para guardar respuestas del usuario"),o._UZ(127,"br"),o._uU(128," \u2022 Para controlar decisiones"),o._UZ(129,"br"),o._uU(130," \u2022 Para contar cosas (ej: puntuaci\xf3n) "),o.qZA()(),o.TgZ(131,"div",43)(132,"h3",44),o._uU(133,"\u{1f9e0} Importancia de las variables"),o.qZA(),o.TgZ(134,"p",14),o._uU(135," Son fundamentales en cualquier lenguaje. Son la base para trabajar con: "),o.qZA(),o.TgZ(136,"div",27),o._uU(137," \u2022 Condiciones (if)"),o._UZ(138,"br"),o._uU(139," \u2022 Repeticiones (for, while)"),o._UZ(140,"br"),o._uU(141," \u2022 Funciones"),o._UZ(142,"br"),o._uU(143," \u2022 Entrada y salida de datos "),o.qZA()(),o.TgZ(144,"div",45)(145,"h3",46),o._uU(146,"\u{1f9ea} Curiosidades"),o.qZA(),o.TgZ(147,"p",14),o._uU(148," En Python no necesitas indicar el tipo (din\xe1mico). En Java/C++ s\xed (est\xe1tico): "),o.qZA(),o.TgZ(149,"div",21)(150,"span",47),o._uU(151,"int "),o.qZA(),o.TgZ(152,"span",22),o._uU(153,"edad"),o.qZA(),o._uU(154," = "),o.TgZ(155,"span",23),o._uU(156,"20"),o.qZA(),o._uU(157,";"),o._UZ(158,"br"),o.TgZ(159,"span",47),o._uU(160,"String "),o.qZA(),o.TgZ(161,"span",22),o._uU(162,"nombre"),o.qZA(),o._uU(163," = "),o.TgZ(164,"span",48),o._uU(165,'"Ana"'),o.qZA(),o._uU(166,"; "),o.qZA()()()()(),o.TgZ(167,"div",8)(168,"div",9),o.YNc(169,fi,2,0,"h2",49),o.YNc(170,ha,2,0,"h2",49),o.qZA(),o.TgZ(171,"div",50)(172,"div",51)(173,"div",52)(174,"button",53),o.NdJ("click",function(){return a.showExamples()}),o.O4$(),o.TgZ(175,"svg",54),o._UZ(176,"path",55),o.qZA()(),o.kcU(),o.TgZ(177,"div",56),o._uU(178," Ejemplos "),o.qZA()(),o.TgZ(179,"div",52)(180,"button",53),o.NdJ("click",function(){return a.showPractice()}),o.O4$(),o.TgZ(181,"svg",54),o._UZ(182,"path",57),o.qZA()(),o.kcU(),o.TgZ(183,"div",56),o._uU(184," Ejercicios "),o.qZA()()(),o.TgZ(185,"div",58),o.YNc(186,bs,11,5,"div",59),o.YNc(187,Jr,2,2,"div",59),o.YNc(188,Qr,7,0,"div",60),o.qZA()()()(),o._UZ(189,"div",61),o.qZA()),2&p&&(o.xp6(169),o.Q6J("ngIf","examples"===a.activeSection),o.xp6(1),o.Q6J("ngIf","practice"===a.activeSection),o.xp6(4),o.ekj("bg-green-600","examples"===a.activeSection)("bg-blue-600","examples"!==a.activeSection)("hover:bg-green-700","examples"===a.activeSection)("hover:bg-blue-700","examples"!==a.activeSection)("border-green-800","examples"===a.activeSection)("border-blue-800","examples"!==a.activeSection),o.xp6(6),o.Udp("background-color","practice"!==a.activeSection?"#f3ae22":"")("border-color","practice"!==a.activeSection?"#d18c00":""),o.ekj("bg-green-600","practice"===a.activeSection)("hover:bg-green-700","practice"===a.activeSection)("hover:bg-yellow-600","practice"!==a.activeSection)("border-green-800","practice"===a.activeSection),o.xp6(6),o.Q6J("ngIf","examples"===a.activeSection),o.xp6(1),o.Q6J("ngIf","practice"===a.activeSection),o.xp6(1),o.Q6J("ngIf",!a.activeSection))},dependencies:[V.O5,dt,Oo]})}}return h})();const ga=["flowchartRef"];function $a(h,w){if(1&h&&(o.TgZ(0,"div",24)(1,"h3",25),o._uU(2),o.qZA(),o.TgZ(3,"p",26),o._uU(4),o.qZA()()),2&h){const r=w.$implicit;o.Udp("border-left-color",r.color),o.xp6(2),o.Oqu(r.title),o.xp6(2),o.Oqu(r.description)}}function el(h,w){if(1&h){const r=o.EpF();o.TgZ(0,"div",27)(1,"h3",28),o._uU(2),o.qZA(),o.TgZ(3,"p",29),o._uU(4),o.qZA(),o.TgZ(5,"div",30)(6,"p",31),o._uU(7),o.qZA()(),o.TgZ(8,"div",32)(9,"button",33),o.NdJ("click",function(){o.CHM(r);const a=o.oxw();return o.KtG(a.previousExample())}),o.O4$(),o.TgZ(10,"svg",34),o._UZ(11,"path",35),o.qZA()(),o.kcU(),o.TgZ(12,"span",36),o._uU(13),o.qZA(),o.TgZ(14,"button",37),o.NdJ("click",function(){o.CHM(r);const a=o.oxw();return o.KtG(a.nextExample())}),o.O4$(),o.TgZ(15,"svg",34),o._UZ(16,"path",38),o.qZA()()()()}if(2&h){const r=o.oxw();o.xp6(2),o.Oqu(r.currentExample.title),o.xp6(2),o.Oqu(r.currentExample.description),o.xp6(3),o.Oqu(r.currentExample.question),o.xp6(2),o.Udp("background-color",r.canGoPreviousExample?"#f3ae22":"")("border-color",r.canGoPreviousExample?"#d18c00":""),o.ekj("opacity-50",!r.canGoPreviousExample)("cursor-not-allowed",!r.canGoPreviousExample),o.Q6J("disabled",!r.canGoPreviousExample),o.xp6(4),o.AsE(" ",r.currentExampleIndex+1," de ",r.examples.length," "),o.xp6(1),o.ekj("opacity-50",!r.canGoNextExample)("cursor-not-allowed",!r.canGoNextExample),o.Q6J("disabled",!r.canGoNextExample)}}function ma(h,w){1&h&&(o.TgZ(0,"div",39)(1,"p"),o._uU(2,"Cargando ejemplos..."),o.qZA()())}function tl(h,w){if(1&h&&(o.TgZ(0,"div",40),o._UZ(1,"app-flowchart",41,42),o.qZA()),2&h){const r=o.oxw();o.xp6(1),o.Q6J("steps",r.currentExampleSteps)("title",r.currentExample.title)}}function Ei(h,w){1&h&&(o.TgZ(0,"div",43)(1,"p"),o._uU(2,"Selecciona un ejemplo de la secci\xf3n anterior para ver su diagrama de flujo"),o.qZA()())}function _a(h,w){1&h&&(o.TgZ(0,"div",43)(1,"p"),o._uU(2,"No hay pasos disponibles para este ejemplo"),o.qZA()())}const ba=[{path:"",children:[{path:"inicio",component:Oe},{path:"introduccion",component:(()=>{class h{constructor(r){this.http=r,this.moduleCards=[],this.allModules=[],this.currentModuleIndex=0,this.examples=[],this.currentExampleIndex=0,this.currentExample=null}ngOnInit(){this.loadModules(),this.loadExamples()}loadModules(){this.http.get("assets/jsons-base/start-page.json").subscribe({next:r=>{this.allModules=r.cards,this.moduleCards=r.cards.filter((p,a)=>0!==a),this.currentModuleIndex=0,console.log("Modules loaded:",this.allModules.length,"Current index:",this.currentModuleIndex)},error:r=>{console.error("Error cargando m\xf3dulos:",r)}})}loadExamples(){this.http.get("assets/jsons-base/modulos.json").subscribe({next:r=>{this.examples=r.introduccion.examples,this.currentExample=this.examples[0],console.log("Examples loaded:",this.examples.length)},error:r=>{console.error("Error cargando ejemplos:",r)}})}previousExample(){this.currentExampleIndex>0&&(this.currentExampleIndex--,this.currentExample=this.examples[this.currentExampleIndex],this.resetFlowchart())}nextExample(){this.currentExampleIndex<this.examples.length-1&&(this.currentExampleIndex++,this.currentExample=this.examples[this.currentExampleIndex],this.resetFlowchart())}resetFlowchart(){setTimeout(()=>{this.flowchartComponent&&this.flowchartComponent.resetSteps()},0)}get canGoPreviousExample(){return this.currentExampleIndex>0}get canGoNextExample(){return this.currentExampleIndex<this.examples.length-1}get currentExampleSteps(){return this.currentExample?.steps||[]}get flowchartTitle(){return this.currentExample?`Diagrama de Flujo: ${this.currentExample.title}`:""}static{this.\u0275fac=function(p){return new(p||h)(o.Y36(Ee.eN))}}static{this.\u0275cmp=o.Xpm({type:h,selectors:[["app-introduccion"]],viewQuery:function(p,a){if(1&p&&o.Gf(ga,5),2&p){let _;o.iGM(_=o.CRH())&&(a.flowchartComponent=_.first)}},decls:45,vars:6,consts:[[1,"text-center","mb-6","mt-6"],[1,"text-3xl","font-bold","text-gray-800","mb-2","drop-shadow-md"],[1,"flex","items-center","justify-center","mb-1"],[1,"h-0.5","bg-gradient-to-r","from-transparent","via-blue-500","to-transparent","w-96","shadow-sm"],[1,"flex","items-center","justify-center"],[1,"h-px","bg-gradient-to-r","from-transparent","via-gray-300","to-transparent","w-64","opacity-60"],[1,"min-h-screen"],[1,"flex","flex-col","gap-6","p-4","mx-8"],[1,"bg-gray-500/20","backdrop-blur-md","p-6","rounded-lg","border","border-gray-400/30","shadow-lg"],[1,"mb-6"],[1,"text-xl","font-bold","mb-3","text-gray-800"],[1,"text-gray-700","leading-relaxed","mb-4","text-justify"],[1,"list-disc","list-inside","text-gray-700","space-y-2","text-justify"],[1,"text-xl","font-bold","mb-4","text-gray-800"],[1,"space-y-3"],["class","p-3 bg-white/70 rounded-md border-l-4 shadow-lg",3,"border-left-color",4,"ngFor","ngForOf"],[1,"grid","grid-cols-2","gap-6"],[1,"bg-gray-500/20","backdrop-blur-md","p-6","rounded-lg","border","border-gray-400/30","shadow-lg","flex","flex-col"],[1,"text-xl","font-bold","mb-5"],["class","flex-1 flex flex-col justify-center space-y-4",4,"ngIf"],["class","flex-1 flex items-center justify-center text-gray-500",4,"ngIf"],["class","min-h-[400px]",4,"ngIf"],["class","text-center text-gray-500 mt-8",4,"ngIf"],[1,"pb-8"],[1,"p-3","bg-white/70","rounded-md","border-l-4","shadow-lg"],[1,"font-bold","text-gray-800"],[1,"text-sm","text-gray-600","text-justify"],[1,"flex-1","flex","flex-col","justify-center","space-y-4"],[1,"text-lg","font-semibold","text-blue-600"],[1,"text-gray-700","text-justify","leading-relaxed"],[1,"bg-blue-50","p-4","rounded-lg","border-l-4","border-blue-400"],[1,"text-blue-800","font-medium"],[1,"flex","justify-between","items-center","mt-6","pt-4","border-t","border-gray-200"],[1,"w-12","h-12","text-white","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border-2","disabled:bg-gray-400","disabled:border-gray-300","disabled:hover:bg-gray-400",3,"disabled","click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[1,"text-sm","text-green-600","font-bold"],[1,"w-12","h-12","bg-blue-600","hover:bg-blue-700","text-white","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border-2","border-blue-800","disabled:bg-gray-400","disabled:border-gray-300","disabled:hover:bg-gray-400",3,"disabled","click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],[1,"flex-1","flex","items-center","justify-center","text-gray-500"],[1,"min-h-[400px]"],[3,"steps","title"],["flowchartRef",""],[1,"text-center","text-gray-500","mt-8"]],template:function(p,a){1&p&&(o.TgZ(0,"div",0)(1,"h1",1),o._uU(2,"\u{1f4d8} Introducci\xf3n a la L\xf3gica de Programaci\xf3n"),o.qZA(),o.TgZ(3,"div",2),o._UZ(4,"div",3),o.qZA(),o.TgZ(5,"div",4),o._UZ(6,"div",5),o.qZA()(),o.TgZ(7,"div",6)(8,"div",7)(9,"div",8)(10,"div",9)(11,"h2",10),o._uU(12,"\u{1f9e0} \xbfQu\xe9 es la L\xf3gica de Programaci\xf3n?"),o.qZA(),o.TgZ(13,"p",11),o._uU(14," La l\xf3gica de programaci\xf3n es el conjunto de principios, reglas y procesos mentales que se utilizan para resolver problemas mediante instrucciones precisas y ordenadas que una computadora puede entender. Es el fundamento sobre el cual se construyen los programas inform\xe1ticos. "),o.qZA()(),o.TgZ(15,"div",9)(16,"h2",10),o._uU(17,"\u{1f9e9} \xbfPor qu\xe9 es importante aprender l\xf3gica de programaci\xf3n?"),o.qZA(),o.TgZ(18,"ul",12)(19,"li"),o._uU(20,"Permite pensar de forma estructurada y ordenada."),o.qZA(),o.TgZ(21,"li"),o._uU(22,"Facilita el an\xe1lisis y resoluci\xf3n de problemas."),o.qZA(),o.TgZ(23,"li"),o._uU(24,"Es esencial para aprender cualquier lenguaje de programaci\xf3n."),o.qZA(),o.TgZ(25,"li"),o._uU(26,"Desarrolla el pensamiento algor\xedtmico: pensar paso a paso como una m\xe1quina."),o.qZA()()(),o.TgZ(27,"div")(28,"h2",13),o._uU(29,"\u{1f504} Conceptos Fundamentales y M\xf3dulos del Aplicativo"),o.qZA(),o.TgZ(30,"div",14),o.YNc(31,$a,5,4,"div",15),o.qZA()()(),o.TgZ(32,"div",16)(33,"div",17)(34,"h2",18),o._uU(35,"\u{1f373} Ejemplos Pr\xe1cticos de Pensamiento Algor\xedtmico"),o.qZA(),o.YNc(36,el,17,19,"div",19),o.YNc(37,ma,3,0,"div",20),o.qZA(),o.TgZ(38,"div",8)(39,"h2",13),o._uU(40,"\u{1f504} Diagrama de Flujo"),o.qZA(),o.YNc(41,tl,3,2,"div",21),o.YNc(42,Ei,3,0,"div",22),o.YNc(43,_a,3,0,"div",22),o.qZA()()(),o._UZ(44,"div",23),o.qZA()),2&p&&(o.xp6(31),o.Q6J("ngForOf",a.moduleCards),o.xp6(5),o.Q6J("ngIf",a.currentExample),o.xp6(1),o.Q6J("ngIf",!a.currentExample),o.xp6(4),o.Q6J("ngIf",a.currentExample&&a.currentExampleSteps.length>0),o.xp6(1),o.Q6J("ngIf",!a.currentExample),o.xp6(1),o.Q6J("ngIf",a.currentExample&&0===a.currentExampleSteps.length))},dependencies:[V.sg,V.O5,dt]})}}return h})()},{path:"concepto-variables",component:pa},{path:"condicionales",component:da},{path:"bucles",component:Yr},{path:"modularidad",component:jr},{path:"abstraccion",component:pn},{path:"pensamiento-logico",component:Se},{path:"toma-de-decisiones",component:yo},{path:"solucion-creativa",component:Ye},{path:"**",redirectTo:"inicio"}]}];let fa=(()=>{class h{static{this.\u0275fac=function(p){return new(p||h)}}static{this.\u0275mod=o.oAB({type:h})}static{this.\u0275inj=o.cJS({imports:[Fe.Bz.forChild(ba),V.ez,Fe.Bz]})}}return h})();var fs=ce(2773),ol=ce(6208);let il=(()=>{class h{static{this.\u0275fac=function(p){return new(p||h)}}static{this.\u0275mod=o.oAB({type:h})}static{this.\u0275inj=o.cJS({imports:[V.ez,fa,fs.W,ol.m]})}}return h})()},7519:function(Xo,no){var ce,Fe;void 0!==(Fe="function"==typeof(ce=function(){var U,d,tt,Ko,Jo,ot,kt,ro,Re,lo,at,Oe,we,co,Qo,N,Ye,J,vo,it,wt,yo,Ee,ve,ao,ei,Pt,Ki,Bt,Ji,en,tn,on,ti,Qi,oi,sn,nn,rn,Co,ii,ln,cn,an,es,un,dn,si,Se,D,hn,ni,ts,ri,li,ne,Ge,Io,os,P,is,I,R,ci,X,ai,Q,c,g,b,E,A,he,ut,pn,xo,ss,St,uo,ui,_r,br,st,ns,di,gc,ho,rs,gn,dt,ls,id,fr,sd,$n,ht,Ft,$c,mn,nd,mc,Ut,ko,_c,bc,fc,Tc,_n,Tr,Ec,vc,yc,cs,rd,as,ld,Er,cd,bn,vr,ad,yr,ud,Cr,Cc,Ic,Ir,xr,kr,fn,dd,hi,Tn,wr,hd,pd,gd,Ht,ye,us,xc,Zt,wo,$d,kc,Sr,wc,md,Sc,En,_d,Ar,bd,Rr,fd,Td,Ed,pi,Ac,Or,Me,Mr,Rc,Nr,Lr,vd,Oc,Mc,yd,Dr,gi,Pr,Cd,Nc,Lc,Id,xd,$i,kd,vn,ds,hs,pt,wd,Sd,Ad,Rd,Od,Md,Nd,Dc,So,mi,Pc,Ld,Dd,Pd,Bd,Fd,Ud,Hd,Zd,Vd,Bc,Gd,Ao,Br,Wd,ps,Fr,Fc,Uc,Ur,Hr,_i,qd,Hc,Zc,Vc,Gc,Wc,qc,zc,zd,gs,jc,Zr,Vr,Vt,Yc,Xc,yn,Kc,Jc,jd,Gr,Qc,Yd,Xd,Kd,Jd,Qd,$s,ea,ta,Cn,oa,eh,th,ia,sa,Gt,ms,Wr,na,ra,la,ca,qr,aa,zr,ua,Ro,_s,In,Oo,Mo,jr,xn,Yr,ge,da,bi,fi,ha,Xr,kn,Ti,Kr,No,bs,Jr,Qr,pa,ga,$a,el,ma,tl,Ei,_a,oh,ba,fa,fs,ol,il,h,w,r,p,a,_,S,H,W,Wt,nt,qt,vi,Lo,yi,At,Ts,Es,Do,Ci,vs,Ii,xi,ki,sl,ys,nl,Ta,wn,bt,rl,ll,ft,cl,Cs,Is,al,Ea,ul,Sn,xs,An,Tt,va,dl,hl,pl,L,Ne,Ie,ae,rt,Po,B,pe,Rn,gl,$l,ks,On,wi,Mn,Nn,Ln,Dn,Bo,ws,ml,ya,Rt,Pn,_l,Ss,Xe,Bn,po,lt,zt,Fn,Un,bl,We,ct,Si,Hn,Fo,Ot,fl,Et,Zn,Vn,As,Tl,El,Gn,Rs,Wn,qn,Os,vl,zn,Ms,Ai,Ri,jn,Z,z,Ue,Vg,Ca,Ia,Gg,xa,Wg,ih,qg,Oi,sh,Yn,nh,rh,ka,lh,ch,ah,uh,dh,hh,ph,gh,$h,zg,jg,mh,Yg,Xg,Kg,Jg,Qg,_h,bh,fh,Th,Eh,vh,yh,wa,yl,Ch,e$,Ih,xh,kh,wh,Sh,Ah,Rh,Oh,Mh,Nh,t$,o$,i$,Lh,Dh,Ph,Bh,s$,y,o={};U=function(e,t,i,s){if(!(e instanceof x)&&"string"!=typeof e||""===`${e}`.trim())throw Error('Invalid type "'+e+'". The type must be a non-empty string or a Blockly.registry.Type.');if(e=`${e}`.toLowerCase(),"string"!=typeof t||""===t.trim())throw Error('Invalid name "'+t+'". The name must be a non-empty string.');const n=t.toLowerCase();if(!i)throw Error("Can not register a null value");let l=Mi[e],u=Sa[e];if(l||(l=Mi[e]=Object.create(null),u=Sa[e]=Object.create(null)),d(e,i),!s&&l[n]&&l[n]!==i)throw Error('Name "'+n+'" with type "'+e+'" already registered.');l[n]=i,u[n]=t},d=function(e,t){if(e===String(x.FIELD)&&"function"!=typeof t.fromJson)throw Error('Type "'+e+'" must have a fromJson function')},tt=function(e,t){e=`${e}`.toLowerCase(),t=t.toLowerCase();const i=Mi[e];i&&i[t]?(delete Mi[e][t],delete Sa[e][t]):console.warn("Unable to unregister ["+t+"]["+e+"] from the registry.")},Ko=function(e,t,i){e=`${e}`.toLowerCase(),t=t.toLowerCase();const s=Mi[e];if(!s||!s[t]){if(t="Unable to find ["+t+"]["+e+"] in the registry.",i)throw Error(t+" You must require or register a "+e+" plugin.");return console.warn(t),null}return s[t]},Jo=function(e,t){return e=`${e}`.toLowerCase(),t=t.toLowerCase(),!!(e=Mi[e])&&!!e[t]},ot=function(e,t,i){return Ko(e,t,i)},kt=function(e,t,i){return Ko(e,t,i)},ro=function(e,t,i){e=`${e}`.toLowerCase();var s=Mi[e];if(!s){if(s=`Unable to find [${e}] in the registry.`,i)throw Error(`${s} You must require or register a ${e} plugin.`);return console.warn(s),null}if(!t)return s;e=Sa[e],i=Object.create(null);for(const n of Object.keys(s))i[e[n]]=s[n];return i},Re=function(e,t,i){return"function"==typeof(t=t.plugins[String(e)]||gt)?t:ot(e,t,i)},lo=function(e,t){at(),Ra=setTimeout(function(){t&&t.handleRightClick(e)},E_)},at=function(){Ra&&(clearTimeout(Ra),Ra=0)},Oe=function(){Aa=null},we=function(e){return!e.type.startsWith("pointer")||e instanceof PointerEvent&&Qo(e)},co=function(e){return`${e.pointerId}`},Qo=function(e){const t=co(e);return Aa?Aa===t:"pointerdown"===e.type&&(Aa=t,!0)},N=function(e,t,i,s,n){function l($){(n||we($))&&(i?s.call(i,$):s($))}const u=[];if(t in Ns)for(let $=0;$<Ns[t].length;$++){const C=Ns[t][$];e.addEventListener(C,l,!1),u.push([e,C,l])}else e.addEventListener(t,l,!1),u.push([e,t,l]);return u},Ye=function(e,t,i,s){function n(u){i?s.call(i,u):s(u)}const l=[];if(t in Ns)for(let u=0;u<Ns[t].length;u++){const $=Ns[t][u];e.addEventListener($,n,!1),l.push([e,$,n])}else e.addEventListener(t,n,!1),l.push([e,t,n]);return l},J=function(e){const t=e[e.length-1][2];for(;e.length;){const[i,s,n]=e.pop();i.removeEventListener(s,n,!1)}return t},vo=function(e){if(e.target instanceof HTMLElement){if(e.target.isContentEditable||"true"===e.target.getAttribute("data-is-text-input"))return!0;if(e.target instanceof HTMLInputElement)return"text"===(e=e.target).type||"number"===e.type||"email"===e.type||"password"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type;if(e.target instanceof HTMLTextAreaElement)return!0}return!1},it=function(e){return!(!e.ctrlKey||!Zh)||2===e.button},wt=function(e,t,i){const s=t.createSVGPoint();return s.x=e.clientX,s.y=e.clientY,i||(i=t.getScreenCTM().inverse()),s.matrixTransform(i)},yo=function(e){switch(e.deltaMode){default:return{x:e.deltaX,y:e.deltaY};case 1:return{x:e.deltaX*_$,y:e.deltaY*_$};case 2:return{x:e.deltaX*b$,y:e.deltaY*b$}}},Ee=function(){return"blockly-"+(I_++).toString(36)},ve=function(){return Gh.genUid()},ao=function(e){return e.type===f.BLOCK_CREATE},ei=function(e){return e.type===f.BLOCK_DELETE},Pt=function(e){return e.type===f.BLOCK_CHANGE},Ki=function(e){return e.type===f.BLOCK_FIELD_INTERMEDIATE_CHANGE},Bt=function(e){return e.type===f.BLOCK_MOVE},Ji=function(e){return e.type===f.VAR_CREATE},en=function(e){return e.type===f.VAR_DELETE},tn=function(e){return e.type===f.VAR_RENAME},on=function(e){return e.type===f.BLOCK_DRAG},ti=function(e){return e.type===f.SELECTED},Qi=function(e){return e.type===f.CLICK},oi=function(e){return e.type===f.BUBBLE_OPEN},sn=function(e){return e.type===f.TRASHCAN_OPEN},nn=function(e){return e.type===f.TOOLBOX_ITEM_SELECT},rn=function(e){return e.type===f.THEME_CHANGE},Co=function(e){return e.type===f.VIEWPORT_CHANGE},ii=function(e){return e.type===f.COMMENT_CREATE},ln=function(e){return e.type===f.COMMENT_DELETE},cn=function(e){return e.type===f.COMMENT_CHANGE},an=function(e){return e.type===f.COMMENT_MOVE},es=function(e){return e.type===f.COMMENT_RESIZE},un=function(e){return e.type===f.COMMENT_DRAG},dn=function(e){return e.type===f.COMMENT_COLLAPSE},si=function(e){return e.type===f.FINISHED_LOADING},o.setRecordUndo$$module$build$src$core$events$utils=function(e){Cl=e},Se=function(){return Cl},D=function(e){jh.fireInternal(e)},hn=function(e){if(ne()){if(!Zo.length)try{requestAnimationFrame(()=>{setTimeout(ni,0)})}catch{setTimeout(ni,0)}ts(e)}},ni=function(){const e=ri(Zo);Zo.length=0;for(const t of e){if(!t.workspaceId)continue;let i;null==(i=uo(t.workspaceId))||i.fireChangeListener(t)}},ts=function(e){if(Pt(e)&&"mutation"===e.element){let t;for(t=Zo.length;t>0;t--){const i=Zo[t-1];if(i.group!==e.group||i.workspaceId!==e.workspaceId||!Bt(i)||i.newParentId!==e.blockId)break}Zo.splice(t,0,e)}else Zo.push(e)},ri=function(e){const t=[];for(const i of e)if(e=t[t.length-1],!i.isNull())if(e&&e.workspaceId===i.workspaceId&&e.group===i.group)if(Bt(i)&&Bt(e)&&i.blockId===e.blockId){if(e.newParentId=i.newParentId,e.newInputName=i.newInputName,e.newCoordinate=i.newCoordinate,e.reason||i.reason){let s,n;e.reason=Array.from(new Set((null!=(s=e.reason)?s:[]).concat(null!=(n=i.reason)?n:[])))}}else Pt(i)&&Pt(e)&&i.blockId===e.blockId&&i.element===e.element&&i.name===e.name?e.newValue=i.newValue:Co(i)&&Co(e)?(e.viewTop=i.viewTop,e.viewLeft=i.viewLeft,e.scale=i.scale,e.oldScale=i.oldScale):Qi(i)&&oi(e)||t.push(i);else t.push(i);return t.filter(i=>!i.isNull())},li=function(){for(let t,e=0;t=Zo[e];e++)t.recordUndo=!1},o.disable$$module$build$src$core$events$utils=function(){qh++},o.enable$$module$build$src$core$events$utils=function(){qh--},ne=function(){return 0===qh},o.getGroup$$module$build$src$core$events$utils=function(){return T$},o.setGroup$$module$build$src$core$events$utils=function(e){jh.setGroupInternal(e)},Ge=function(e){T$="boolean"==typeof e?e?ve():"":e},Io=function(e){const t=[];e=e.getDescendants(!1);for(let s,i=0;s=e[i];i++)t[i]=s.id;return t},os=function(e,t){const i=P(e.type);if(!i)throw Error("Unknown event type.");return i.fromJson(e,t)},P=function(e){const t=ot(x.EVENT,e);if(!t)throw Error(`Event type ${e} not found in registry.`);return t},is=function(e){if((Bt(e)||ao(e))&&e.workspaceId){var t=uo(e.workspaceId);if(!e.blockId)throw Error("Encountered a blockEvent without a proper blockId");if(e=t.getBlockById(e.blockId)){const i=Cl;try{Cl=!1;const s=e.getParent();if(s&&!s.hasDisabledReason(zh)){const n=e.getDescendants(!1);for(let u,l=0;u=n[l];l++)u.setDisabledReason(!1,zh)}else if((e.outputConnection||e.previousConnection)&&!t.isDragging())do{e.setDisabledReason(!0,zh),e=e.getNextBlock()}while(e)}finally{Cl=i}}}},I=function(e,t,i){e=document.createElementNS(Il,`${e}`);for(const s in t)e.setAttribute(s,`${t[s]}`);return i&&i.appendChild(e),e},R=function(e,t){return!(t=t.split(" ")).every(i=>e.classList.contains(i))&&(e.classList.add(...t),!0)},ci=function(e,t){e.classList.remove(...t.split(" "))},X=function(e,t){return!(t=t.split(" ")).every(i=>!e.classList.contains(i))&&(e.classList.remove(...t),!0)},ai=function(e,t){return e.classList.contains(t)},Q=function(e){return e&&e.parentNode?e.parentNode.removeChild(e):null},c=function(e,t){const i=t.nextSibling;if(!(t=t.parentNode))throw Error("Reference node has no parent.");i?t.insertBefore(e,i):t.appendChild(e)},g=function(e,t){e.style.transform=t,e.style["-webkit-transform"]=t},b=function(){Yh++,jt||(jt=Object.create(null))},E=function(){--Yh||(jt=null)},A=function(e){const t=e.textContent+"\n"+e.className.baseVal;var i;return jt&&(i=jt[t])||(i=window.getComputedStyle(e),i=ut(e,i.fontSize,i.fontWeight,i.fontFamily),jt&&(jt[t]=i)),i},he=function(e,t,i,s){return ut(e,t+"pt",i,s)},ut=function(e,t,i,s){const n=e.textContent;var l;return e=n+"\n"+e.className.baseVal,jt&&(l=jt[e])||(xl||((l=document.createElement("canvas")).className="blocklyComputeCanvas",document.body.appendChild(l),xl=l.getContext("2d")),n&&xl?(xl.font=i+" "+t+" "+s,l=xl.measureText(n).width):l=0,jt&&(jt[e]=l)),l},pn=function(e,t,i,s){const n=document.createElement("span");n.style.font=i+" "+t+" "+s,n.textContent=e,(e=document.createElement("div")).style.width="1px",e.style.height="0",(t=document.createElement("div")).style.display="flex",t.style.position="fixed",t.style.top="0",t.style.left="0",t.appendChild(n),t.appendChild(e),document.body.appendChild(t),i={height:0,baseline:0};try{t.style.alignItems="baseline",i.baseline=e.offsetTop-n.offsetTop,t.style.alignItems="flex-end",i.height=e.offsetTop-n.offsetTop}finally{document.body.removeChild(t)}return i},o.getFocusManager$$module$build$src$core$focus_manager=function(){return Ze.getFocusManager()},xo=function(e){return e&&"function"==typeof e.getFocusableElement&&"function"==typeof e.getFocusableTree&&"function"==typeof e.onNodeFocus&&"function"==typeof e.onNodeBlur&&"function"==typeof e.canBeFocused},ss=function(e){return xo(e)&&"string"==typeof e.id&&"object"==typeof e.workspace&&"function"==typeof e.select&&"function"==typeof e.unselect},St=function(e,t){for(const i in t)e[i]=null!==t[i]&&Array.isArray(t[i])?St(e[i]||[],t[i]):null!==t[i]&&"object"==typeof t[i]?St(e[i]||Object.create(null),t[i]):t[i];return e},uo=function(e){return kl[e]||null},ui=function(){const e=[];for(const t in kl)e.push(kl[t]);return e},_r=function(e){kl[e.id]=e},br=function(e){delete kl[e.id]},st=function(){return y$},ns=function(e){y$=e},di=function(){const e=o.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode();return e&&ss(e)?e:null},gc=function(e){o.getFocusManager$$module$build$src$core$focus_manager().focusNode(e)},ho=function(e){const t=di();let i,s,n,l;const u=new(P(f.SELECTED))(null!=(i=t?.id)?i:null,null!=(s=e?.id)?s:null,null!=(l=null!=(n=e?.workspace.id)?n:t?.workspace.id)?l:"");D(u)},rs=function(){return C$},gn=function(e){C$=e},dt=function(e){for(;e.options.parentWorkspace;)e=e.options.parentWorkspace;const t=e.getParentSvg(),i=e.getCachedParentSvgSize();var s=t.parentElement;if(s instanceof HTMLElement){var n=s.offsetWidth;s=s.offsetHeight,i.width!==n&&(t.setAttribute("width",n+"px"),e.setCachedParentSvgSize(n,null)),i.height!==s&&(t.setAttribute("height",s+"px"),e.setCachedParentSvgSize(null,s)),e.resize()}},ls=function(e,t){const i=Object.create(null),s=e.getDescendants(!0);t&&(e=e.getNextBlock())&&(e=s.indexOf(e),s.splice(e,s.length-e));for(let l,n=0;l=s[n];n++)i[l.type]?i[l.type]++:i[l.type]=1;return i},id=function(e){return function(){this.jsonInit(e)}},fr=function(e){I$.defineBlocksWithJsonArrayInternal(e)},sd=function(e){o.defineBlocks$$module$build$src$core$common(o.createBlockDefinitionsFromJsonArray$$module$build$src$core$common(e))},o.createBlockDefinitionsFromJsonArray$$module$build$src$core$common=function(e){const t={};for(let i=0;i<e.length;i++){const s=e[i];if(!s){console.warn(`Block definition #${i} in JSON array is ${s}. Skipping`);continue}const n=s.type;n?t[n]={init:id(s)}:console.warn(`Block definition #${i} in JSON array is missing a type attribute. Skipping.`)}return t},o.defineBlocks$$module$build$src$core$common=function(e){for(const t of Object.keys(e)){const i=e[t];t in ue&&console.warn(`Block definition "${t}" overwrites previous definition.`),ue[t]=i}},$n=function(e){let t=st();const i=o.getFocusManager$$module$build$src$core$focus_manager().getFocusedTree();for(const s of ui())if(i===s){t=s;break}!vo(e)&&t&&(!t.rendered||t.isFlyout||t.isVisible())&&re.registry.onKeyDown(t,e)},ht=function(e,t){return-1!==(t=e.indexOf(t))&&(e.splice(t,1),!0)},Ft=function(e){if(Xh)throw Error("CSS already injected");Kh+="\n"+e},$c=function(e,t){Xh||(Xh=!0,e&&(e=t.replace(/[\\/]$/,""),t=Kh.replace(/<<<PATH>>>/g,e),Kh="",(e=document.createElement("style")).id="blockly-common-style",t=document.createTextNode(t),e.appendChild(t),document.head.insertBefore(e,document.head.firstChild)))},mn=function(e){return S$.getSizeInternal(e)},nd=function(e){if("none"!==Ut(e,"display"))return mc(e);const t=e.style,i=t.display,s=t.visibility,n=t.position;t.visibility="hidden",t.position="absolute",t.display="inline";const l=e.offsetWidth;return e=e.offsetHeight,t.display=i,t.position=n,t.visibility=s,new Y(l,e)},mc=function(e){return new Y(e.offsetWidth,e.offsetHeight)},Ut=function(e,t){return(e=window.getComputedStyle(e))[t]||e.getPropertyValue(t)},ko=function(e){const t=new k(0,0);e=e.getBoundingClientRect();var i=document.documentElement;return i=new k(window.pageXOffset||i.scrollLeft,window.pageYOffset||i.scrollTop),t.x=e.left+i.x,t.y=e.top+i.y,t},_c=function(){const e=document.body,t=document.documentElement;return new k(e.scrollLeft||t.scrollLeft,e.scrollTop||t.scrollTop)},bc=function(e){const t=parseFloat(Ut(e,"borderLeftWidth")),i=parseFloat(Ut(e,"borderRightWidth")),s=parseFloat(Ut(e,"borderTopWidth"));return e=parseFloat(Ut(e,"borderBottomWidth")),new j(s,e,t,i)},fc=function(e,t,i){e=Tc(e,t,i),t.scrollLeft=e.x,t.scrollTop=e.y},Tc=function(e,t,i){var s=ko(e),n=ko(t),l=bc(t);const u=s.x-n.x-l.left;return s=s.y-n.y-l.top,n=mc(e),e=t.clientWidth-n.width,n=t.clientHeight-n.height,l=t.scrollLeft,t=t.scrollTop,i?(l+=u-e/2,t+=s-n/2):(l+=Math.min(u,Math.max(u-e,0)),t+=Math.min(s,Math.max(s-n,0))),new k(l,t)},_n=function(e){const t=new k(0,0);var i=e.x&&e.getAttribute("x");const s=e.y&&e.getAttribute("y");return i&&(t.x=parseInt(i)),s&&(t.y=parseInt(s)),(i=(i=e.getAttribute("transform"))&&i.match(A$))&&(t.x+=Number(i[1]),i[3]&&(t.y+=Number(i[3]))),(e=e.getAttribute("style"))&&e.includes("translate")&&(e=e.match(R$))&&(t.x+=Number(e[1]),e[3]&&(t.y+=Number(e[3]))),t},Tr=function(e){let t=0,i=0;for(;e;){const s=_n(e);if(t+=s.x,i+=s.y,(" "+(e.getAttribute("class")||"")+" ").includes(" injectionDiv "))break;e=e.parentNode}return new k(t,i)},Ec=function(){const e=_c();return new j(e.y,document.documentElement.clientHeight+e.y,e.x,document.documentElement.clientWidth+e.x)},vc=function(){const e=document.documentElement,t=window;return new k(t.pageXOffset||e.scrollLeft,t.pageYOffset||e.scrollTop)},yc=function(e,t){var i=t.x;t=t.y;const s=e.getInjectionDiv().getBoundingClientRect();return i=new k(i-s.left,t-s.top),t=e.getOriginOffsetInPixels(),k.difference(i,t).scale(1/e.scale)},cs=function(e,t){var i=t.scale(e.scale);t=i.x,i=i.y;const s=e.getInjectionDiv().getBoundingClientRect();return e=e.getOriginOffsetInPixels(),new k(t+s.left+e.x,i+s.top+e.y)},rd=function(e){({document:Ba=Ba,DOMParser:Sl=Sl,XMLSerializer:Al=Al}=e),Pa=new Sl,Qh=new Al},o.createElement$$module$build$src$core$utils$xml=function(e){return Ba.createElementNS(O$,e)},o.createTextNode$$module$build$src$core$utils$xml=function(e){return Ba.createTextNode(e)},o.textToDom$$module$build$src$core$utils$xml=function(e){let t=Pa.parseFromString(e,"text/xml");if(t&&t.documentElement&&!t.getElementsByTagName("parsererror").length)return t.documentElement;if((t=Pa.parseFromString(e,"text/html"))&&t.body.firstChild&&"xml"===t.body.firstChild.nodeName.toLowerCase())return t.body.firstChild;throw Error(`DOMParser was unable to parse: ${e}`)},as=function(e){return ld(Qh.serializeToString(e))},ld=function(e){return e.replace(U_,t=>`&#${t.charCodeAt(0)};`)},Er=function(e){return e?((e instanceof Element||"string"==typeof e)&&(e=Ic(e),e=ud(e)),cd(e),e):null},cd=function(e){const t=e.kind;if(e=e.contents,t&&t!==M$&&t!==ep)throw Error("Invalid toolbox kind "+t+". Please supply either "+M$+" or "+ep);if(!e)throw Error("Toolbox must have a contents attribute.")},bn=function(e){return e?e.contents?e.contents:Array.isArray(e)&&e.length>0&&!e[0].nodeType?e:Cr(e):[]},vr=function(e){return N$.hasCategoriesInternal(e)},ad=function(e){if(!e)return!1;const t=e.kind;return t?t===ep:!!e.contents.filter(i=>"CATEGORY"===i.kind.toUpperCase()).length},yr=function(e){return!(!e||!e.contents||!e.contents.filter(function(t){return"CATEGORY"===t.kind.toUpperCase()}).length)},ud=function(e){const t={contents:Cr(e)};return e instanceof Node&&Cc(e,t),t},Cr=function(e){const t=[];let i=e.childNodes;i||(i=e);for(let n,s=0;n=i[s];s++){if(!n.tagName)continue;e={};const l=n.tagName.toUpperCase();e.kind=l,"BLOCK"===l?e.blockxml=n:n.childNodes&&n.childNodes.length>0&&(e.contents=Cr(n)),Cc(n,e),t.push(e)}return t},Cc=function(e,t){for(let i=0;i<e.attributes.length;i++){const s=e.attributes[i];s.nodeName.includes("css-")?(t.cssconfig=t.cssconfig||{},t.cssconfig[s.nodeName.replace("css-","")]=s.value):t[s.nodeName]=s.value}},Ic=function(e){let t=null;if(e)if("string"==typeof e){if(t=o.textToDom$$module$build$src$core$utils$xml(e),"xml"!==t.nodeName.toLowerCase())throw TypeError("Toolbox should be an <xml> document.")}else e instanceof Element&&(t=e);return t},Ir=function(e,t,i,s,n,l){const u=l.scrollbar&&l.scrollbar.canScrollVertically();return e.horizontal===Rl.LEFT?(i=n.absoluteMetrics.left+i,u&&l.RTL&&(i+=be.scrollbarThickness)):(i=n.absoluteMetrics.left+n.viewMetrics.width-t.width-i,u&&!l.RTL&&(i-=be.scrollbarThickness)),e.vertical===Di.TOP?e=n.absoluteMetrics.top+s:(e=n.absoluteMetrics.top+n.viewMetrics.height-t.height-s,l.scrollbar&&l.scrollbar.canScrollHorizontally()&&(e-=be.scrollbarThickness)),new j(e,e+t.height,i,i+t.width)},xr=function(e,t){return{horizontal:t.toolboxMetrics.position===G.LEFT||e.horizontalLayout&&!e.RTL?Rl.RIGHT:Rl.LEFT,vertical:t.toolboxMetrics.position===G.BOTTOM?Di.TOP:Di.BOTTOM}},kr=function(e,t,i,s){const n=e.left,l=e.right-e.left,u=e.bottom-e.top;for(let $=0;$<s.length;$++){const C=s[$];e.intersects(C)&&(e=new j(e=i===Bs.UP?C.top-u-t:C.bottom+t,e+u,n,n+l),$=-1)}return e},fn=function(e,t){U(x.SERIALIZER,e,t)},dd=function(e){tt(x.SERIALIZER,e)},hi=function(e,{addCoordinates:t=!1,saveIds:i=!0}={}){const s=e.workspace,n=Object.create(null);return n.height=e.getSize().height,n.width=e.getSize().width,i&&(n.id=e.id),t&&(t=e.getRelativeToSurfaceXY(),n.x=s.RTL?s.getWidth()-t.x:t.x,n.y=t.y),e.getText()&&(n.text=e.getText()),e.isCollapsed()&&(n.collapsed=!0),e.isOwnEditable()||(n.editable=!1),e.isOwnMovable()||(n.movable=!1),e.isOwnDeletable()||(n.deletable=!1),n},Tn=function(e,t,{recordUndo:i=!1}={}){const s=Se();if(o.setRecordUndo$$module$build$src$core$events$utils(i),i=t.newComment(e.id),void 0!==e.text&&i.setText(e.text),void 0!==e.x||void 0!==e.y){const l=i.getRelativeToSurfaceXY();let u,$=null!=(u=e.x)?u:l.x;var n;$=t.RTL?t.getWidth()-$:$,t=null!=(n=e.y)?n:l.y,i.moveTo(new k($,t))}if(void 0!==e.width||e.height){let l,u;n=i.getSize(),i.setSize(new Y(null!=(l=e.width)?l:n.width,null!=(u=e.height)?u:n.height))}return void 0!==e.collapsed&&i.setCollapsed(e.collapsed),void 0!==e.editable&&i.setEditable(e.editable),void 0!==e.movable&&i.setMovable(e.movable),void 0!==e.deletable&&i.setDeletable(e.deletable),o.setRecordUndo$$module$build$src$core$events$utils(s),i},wr=function(e,t){U(x.PASTER,e,t)},hd=function(e){tt(x.PASTER,e)},pd=function(e){const t=e.workspace,i=e.getRelativeToSurfaceXY(),s=new k(0,0),n=t.getTopComments(!1).filter(l=>l.id!==e.id).map(l=>l.getRelativeToSurfaceXY());for(;gd(k.sum(i,s),n);)s.translate(t.RTL?-30:30,30);e.moveTo(k.sum(i,s))},gd=function(e,t){return t.some(i=>Math.abs(i.x-e.x)<=1&&Math.abs(i.y-e.y)<=1)},Ht=function(e,t){e.setAttribute(q_,t)},ye=function(e,t,i){Array.isArray(i)&&(i=i.join(" ")),e.setAttribute(W_+t,`${i}`)},us=function(e){return e&&"function"==typeof e.saveState&&"function"==typeof e.loadState},xc=function(e){return kc(e),$d()?(Sr(),Promise.resolve()):(Jn||(Jn=new Promise(t=>{cp=t,U$=window.requestAnimationFrame(()=>{Sr(),t()})})),Jn)},Zt=function(){return Jn||Promise.resolve()},wo=function(e){e||window.cancelAnimationFrame(U$),Sr(e),!e&&cp&&cp()},$d=function(){return p$},kc=function(e){rp.add(e),lp.set(e,o.getGroup$$module$build$src$core$events$utils());const t=e.getParent();t?kc(t):Ha.add(e)},Sr=function(e){const t=e?new Set([e]):new Set([...Ha].map(l=>l.workspace)),i=[...Ha].filter(md).filter(l=>t.has(l.workspace));for(var s of i)Sc(s);for(const l of t)l.resizeContents();for(var n of i)s=n.getRelativeToSurfaceXY(),n.updateComponentLocations(s);for(const l of i)n=o.getGroup$$module$build$src$core$events$utils(),(s=lp.get(l))&&o.setGroup$$module$build$src$core$events$utils(s),l.bumpNeighbours(),o.setGroup$$module$build$src$core$events$utils(n);for(const l of i)wc(l);e||(Jn=null)},wc=function(e){Ha.delete(e),rp.delete(e),lp.delete(e);for(const t of e.getChildren(!1))wc(t)},md=function(e){return!e.isDisposed()&&!e.getParent()},Sc=function(e){if(rp.has(e)&&e.initialized){for(const t of e.getChildren(!1))Sc(t);e.renderEfficiently()}},En=function(e,t){W$(e,t)},_d=function(e=G$){W$=e},Ar=function(e,t){z$(e,t)},bd=function(e=q$){z$=e},Rr=function(e,t,i){Y$(e,t,i)},fd=function(e=j$){Y$=e},Td=function(e,t){K$(e,t)},Ed=function(e=X$){K$=e},pi=function(e){return e&&"function"==typeof e.getProcedureDef},Ac=function(e){return e&&"function"==typeof e.getProcedureCall&&"function"==typeof e.renameProcedure},Or=function(e){return void 0!==e.getVariableModel},Me=function(e,t,i,s){e=e+" was deprecated in "+t+" and will be deleted in "+i+".",s&&(e+="\nUse "+s+" instead."),Q$.has(e)||(Q$.add(e),console.warn(e))},o.allUsedVarModels$$module$build$src$core$variables=function(e){e=e.getAllBlocks(!1);const t=new Set;for(let i=0;i<e.length;i++){const s=e[i].getVarModels();if(s)for(let n=0;n<s.length;n++){const l=s[n];l.getId()&&t.add(l)}}return Array.from(t.values())},o.allDeveloperVariables$$module$build$src$core$variables=function(e){e=e.getAllBlocks(!1);const t=new Set;for(let n,s=0;n=e[s];s++){var i=n.getDeveloperVariables;if(i){i=i();for(let l=0;l<i.length;l++)t.add(i[l])}}return Array.from(t.values())},Mr=function(e){return Rc(e,!1)},Rc=function(e,t=!0){return ue.variables_set||ue.variables_get||console.warn("There are no variable blocks, but there is a variable category."),t?(Me("The XML return value of Blockly.Variables.flyoutCategory()","v12","v13","the same method, but handle a return type of FlyoutItemInfo[] (JSON) instead."),vd(e)):(e.registerButtonCallback("CREATE_VARIABLE",function(i){gi(i.getTargetWorkspace())}),[{kind:"button",text:"%{BKY_NEW_VARIABLE}",callbackkey:"CREATE_VARIABLE"},...Lr(e,e.getVariableMap().getVariablesOfType(""),!0)])},Nr=function(e){return{VAR:{name:e.getName(),type:e.getType()}}},Lr=function(e,t,i,s="variables_get",n="variables_set"){i&&(i=ue.math_change),e=[];const l=t.slice(-1)[0];return l&&(ue[n]&&e.push({kind:"block",type:n,gap:i?8:24,fields:Nr(l)}),i&&e.push({kind:"block",type:"math_change",gap:ue[s]?20:8,fields:Nr(l),inputs:{DELTA:{shadow:{type:"math_number",fields:{NUM:1}}}}})),ue[s]&&e.push(...t.sort(ds).map(u=>({kind:"block",type:s,gap:8,fields:Nr(u)}))),e},vd=function(e){let t=[];const i=document.createElement("button");return i.setAttribute("text","%{BKY_NEW_VARIABLE}"),i.setAttribute("callbackKey","CREATE_VARIABLE"),e.registerButtonCallback("CREATE_VARIABLE",function(s){gi(s.getTargetWorkspace())}),t.push(i),e=Oc(e),t.concat(e)},Oc=function(e){const t=[];if((e=e.getVariableMap().getVariablesOfType("")).length>0){var i=e[e.length-1];if(ue.variables_set){var s=o.createElement$$module$build$src$core$utils$xml("block");s.setAttribute("type","variables_set"),s.setAttribute("gap",ue.math_change?"8":"24"),s.appendChild($i(i)),t.push(s)}if(ue.math_change&&((s=o.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","math_change"),s.setAttribute("gap",ue.variables_get?"20":"8"),s.appendChild($i(i)),i=o.textToDom$$module$build$src$core$utils$xml('<value name="DELTA"><shadow type="math_number"><field name="NUM">1</field></shadow></value>'),s.appendChild(i),t.push(s)),ue.variables_get){e.sort(ds);for(let l,n=0;l=e[n];n++)(i=o.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","variables_get"),i.setAttribute("gap","8"),i.appendChild($i(l)),t.push(i)}}return t},Mc=function(e){return tm.generateUniqueNameInternal(e)},yd=function(e){return Dr(up.charAt(0),e.getVariableMap().getAllVariables().map(t=>t.getName()))},Dr=function(e,t){if(!t.length)return e;const i=up;let s="",n=i.indexOf(e);for(;;){let l=!1;for(let u=0;u<t.length;u++)if(t[u].toLowerCase()===e){l=!0;break}if(!l)break;n++,n===i.length&&(n=0,s=`${Number(s)+1}`),e=i.charAt(n)+s}return e},gi=function(e,t,i){const n=i||"";!function s(l){Pr(o.Msg$$module$build$src$core$msg.NEW_VARIABLE_TITLE,l,function(u){if(u){var $=Nc(u,e);if($){if($.getType()===n)var C=o.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS.replace("%1",$.getName());else C=(C=o.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE).replace("%1",$.getName()).replace("%2",$.getType());En(C,function(){s(u)})}else e.getVariableMap().createVariable(u,n),t&&t(u)}else t&&t(null)})}("")},o.renameVariable$$module$build$src$core$variables=function(e,t,i){!function s(n){const l=o.Msg$$module$build$src$core$msg.RENAME_VARIABLE_TITLE.replace("%1",t.getName());Pr(l,n,function(u){if(u){var $=Cd(u,t.getType(),e),C=Lc(t.getName(),u,e);if($||C){var F="";$?F=o.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE.replace("%1",$.getName()).replace("%2",$.getType()):C&&(F=o.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_A_PARAMETER.replace("%1",u).replace("%2",C)),En(F,function(){s(u)})}else e.getVariableMap().renameVariable(t,u),i&&i(u)}else i&&i(null)})}("")},Pr=function(e,t,i){Rr(e,t,function(s){s&&((s=s.replace(/[\s\xa0]+/g," ").trim())===o.Msg$$module$build$src$core$msg.RENAME_VARIABLE||s===o.Msg$$module$build$src$core$msg.NEW_VARIABLE)&&(s=null),i(s)})},Cd=function(e,t,i){i=i.getVariableMap().getAllVariables(),e=e.toLowerCase();for(let n,s=0;n=i[s];s++)if(n.getName().toLowerCase()===e&&n.getType()!==t)return n;return null},Nc=function(e,t){t=t.getVariableMap().getAllVariables(),e=e.toLowerCase();for(let s,i=0;s=t[i];i++)if(s.getName().toLowerCase()===e)return s;return null},Lc=function(e,t,i){return i.getProcedureMap().getProcedures().length?Id(e,t,i):xd(e,t,i)},Id=function(e,t,i){e=e.toLowerCase(),t=t.toLowerCase(),i=i.getProcedureMap().getProcedures();for(const n of i){var s=n.getParameters().filter(Or).map(l=>l.getVariableModel().getName());if(s&&(i=s.some(l=>l.toLowerCase()===e),s=s.some(l=>l.toLowerCase()===t),i&&s))return n.getName()}return null},xd=function(e,t,i){e=e.toLowerCase(),t=t.toLowerCase(),i=i.getAllBlocks(!1);for(const n of i){if(!pi(n))continue;var s=(i=n.getProcedureDef())[1];const l=s.some(u=>u.toLowerCase()===e);if(s=s.some(u=>u.toLowerCase()===t),l&&s)return i[0]}return null},$i=function(e){const t=o.createElement$$module$build$src$core$utils$xml("field");return t.setAttribute("name","VAR"),t.setAttribute("id",e.getId()),t.setAttribute("variabletype",e.getType()),e=o.createTextNode$$module$build$src$core$utils$xml(e.getName()),t.appendChild(e),t},o.getOrCreateVariablePackage$$module$build$src$core$variables=function(e,t,i,s){let n=o.getVariable$$module$build$src$core$variables(e,t,i,s);return n||(n=kd(e,t,i,s)),n},o.getVariable$$module$build$src$core$variables=function(e,t,i,s){const n=e.getPotentialVariableMap();let l=null;if(t&&(l=e.getVariableById(t),!l&&n&&(l=n.getVariableById(t)),l))return l;if(i){if(void 0===s)throw Error("Tried to look up a variable by name without a type");l=e.getVariable(i,s),!l&&n&&(l=n.getVariable(i,s))}return l},kd=function(e,t,i,s){const n=e.getVariableMap(),l=e.getPotentialVariableMap();return i||(i=Mc(e.isFlyout?e.targetWorkspace:e)),l?l.createVariable(i,s,t??void 0):n.createVariable(i,s,t)},vn=function(e,t){e=e.getAllVariables();const i=[];if(t.length!==e.length)for(let s=0;s<e.length;s++){const n=e[s];t.includes(n)||i.push(n)}return i},ds=function(e,t){return e.getName().localeCompare(t.getName(),void 0,{sensitivity:"base"})},hs=function(e,t){const i=[];e=e.getAllBlocks(!1);for(let s=0;s<e.length;s++){const n=e[s].getVarModels();if(n)for(let l=0;l<n.length;l++)n[l].getId()===t&&i.push(e[s])}return i},o.deleteVariable$$module$build$src$core$variables=function(e,t,i){var s=t.getName();const n=hs(e,t.getId());for(let l=n.length-1;l>=0;l--){const u=n[l];if("procedures_defnoreturn"===u.type||"procedures_defreturn"===u.type)return i=String(u.getFieldValue("NAME")),s=o.Msg$$module$build$src$core$msg.CANNOT_DELETE_VARIABLE_PROCEDURE.replace("%1",s).replace("%2",i),void En(s);u===i&&n.splice(l,1)}i&&n.length||n.length>1?(s=o.Msg$$module$build$src$core$msg.DELETE_VARIABLE_CONFIRMATION.replace("%1",String(n.length+(i&&!i.workspace.isFlyout?1:0))).replace("%2",s),Ar(s,l=>{l&&t&&e.getVariableMap().deleteVariable(t)})):e.getVariableMap().deleteVariable(t)},pt=function(e,{addCoordinates:t=!1,addInputBlocks:i=!0,addNextBlocks:s=!0,doFullSerialization:n=!0,saveIds:l=!0}={}){if(e.isInsertionMarker())return null;const u={type:e.type,id:l?e.id:void 0};return t&&Sd(e,u),wd(e,u),Ad(e,u,n),Rd(e,u,n),Od(e,u,n),i&&Md(e,u,n,l),s&&Nd(e,u,n,l),u},wd=function(e,t){e.isCollapsed()&&(t.collapsed=!0),e.isEnabled()||(t.disabledReasons=Array.from(e.getDisabledReasons())),e.isOwnDeletable()||(t.deletable=!1),e.isOwnMovable()||(t.movable=!1),e.isOwnEditable()||(t.editable=!1),void 0!==e.inputsInline&&e.inputsInline!==e.inputsInlineDefault&&(t.inline=e.inputsInline),e.data&&(t.data=e.data)},Sd=function(e,t){const i=e.workspace;e=e.getRelativeToSurfaceXY(),t.x=Math.round(i.RTL?i.getWidth()-e.x:e.x),t.y=Math.round(e.y)},Ad=function(e,t,i){e.saveExtraState?null!==(e=e.saveExtraState(i))&&(t.extraState=e):e.mutationToDom&&null!==(e=e.mutationToDom())&&(t.extraState=nt(e).replace(' xmlns="https://developers.google.com/blockly/xml"',""))},Rd=function(e,t,i){const s=Object.create(null);for(const n of e.getIcons())us(n)&&(e=n.saveState(i))&&(s[n.getType().toString()]=e);Object.keys(s).length&&(t.icons=s)},Od=function(e,t,i){const s=Object.create(null);for(const n of e.getFields())n.isSerializable()&&(s[n.name]=n.saveState(i));Object.keys(s).length&&(t.fields=s)},Md=function(e,t,i,s){const n=Object.create(null);for(let l=0;l<e.inputList.length;l++){const u=e.inputList[l];if(!u.connection)continue;const $=Dc(u.connection,i,s);$&&(n[u.name]=$)}Object.keys(n).length&&(t.inputs=n)},Nd=function(e,t,i,s){e.nextConnection&&(e=Dc(e.nextConnection,i,s))&&(t.next=e)},Dc=function(e,t,i){const s=e.getShadowState(!0);if(e=e.targetBlock(),!s&&!e)return null;const n=Object.create(null);return s&&(n.shadow=s),e&&!e.isShadow()&&(n.block=pt(e,{doFullSerialization:t,saveIds:i})),n},So=function(e,t,{recordUndo:i=!1}={}){return e=mi(e,t,{recordUndo:i}),t.rendered&&wo(),e},mi=function(e,t,{parentConnection:i,isShadow:s=!1,recordUndo:n=!1}={}){const l=Se();o.setRecordUndo$$module$build$src$core$events$utils(n),(n=o.getGroup$$module$build$src$core$events$utils())||o.setGroup$$module$build$src$core$events$utils(!0),o.disable$$module$build$src$core$events$utils();const u=t.getAllVariables();let $;try{$=Pc(e,t,{parentConnection:i,isShadow:s})}finally{o.enable$$module$build$src$core$events$utils()}if(Ld(t,u),ne()&&D(new(P(f.BLOCK_CREATE))($)),o.setGroup$$module$build$src$core$events$utils(n),o.setRecordUndo$$module$build$src$core$events$utils(l),t.rendered){const C=$;setTimeout(()=>{C.disposed||C.setConnectionTracking(!0)},1)}return $},Pc=function(e,t,{parentConnection:i,isShadow:s=!1}={}){if(!e.type)throw new om(e);const n=t.newBlock(e.type,e.id);return n.setShadow(s),Dd(n,e),Pd(n,e),Bd(n,e),Fd(i,n,e),Ud(n,e),Hd(n,e),Zd(n,e),Vd(n,e),Gd(n,t.rendered),n},Ld=function(e,t){if(ne())for(e=vn(e,t),t=0;t<e.length;t++){const i=e[t];D(new(P(f.VAR_CREATE))(i))}},Dd=function(e,t){let i=void 0===t.x?0:t.x;t=void 0===t.y?0:t.y;const s=e.workspace;i=s.RTL?s.getWidth()-i:i,e.moveBy(i,t)},Pd=function(e,t){if(t.collapsed&&e.setCollapsed(!0),!1===t.deletable&&e.setDeletable(!1),!1===t.movable&&e.setMovable(!1),!1===t.editable&&e.setEditable(!1),!1===t.enabled&&e.setDisabledReason(!0,Mt),Array.isArray(t.disabledReasons))for(const i of t.disabledReasons)e.setDisabledReason(!0,i);void 0!==t.inline&&e.setInputsInline(t.inline),void 0!==t.data&&(e.data=t.data)},Bd=function(e,t){t.extraState&&(e.loadExtraState?e.loadExtraState(t.extraState):e.domToMutation&&e.domToMutation(o.textToDom$$module$build$src$core$utils$xml(t.extraState)))},Fd=function(e,t,i){if(e){if(e.getSourceBlock().isShadow()&&!t.isShadow())throw new sm(i);if(e.type===o.inputTypes$$module$build$src$core$inputs$input_types.VALUE){var s=t.outputConnection;if(!s)throw new Pl("output",t,i)}else if(!(s=t.previousConnection))throw new Pl("previous",t,i);if(!e.connect(s)){const n=t.workspace.connectionChecker;throw new im(n.getErrorMessage(n.canConnectWithReason(s,e,!1),s,e),e.type===o.inputTypes$$module$build$src$core$inputs$input_types.VALUE?"output connection":"previous connection",t,i)}}},Ud=function(e,t){if(t.icons){var i=Object.keys(t.icons);for(const n of i){i=t.icons[n];var s=e.getIcon(n);if(!s){if(!(s=ot(x.ICON,n,!1)))throw new nm(n,e,t);s=new s(e),e.addIcon(s)}us(s)&&s.loadState(i)}}},Hd=function(e,t){if(t.fields){var i=Object.keys(t.fields);for(let s=0;s<i.length;s++){const n=i[s],l=t.fields[n],u=e.getField(n);u?u.loadState(l):console.warn(`Ignoring non-existant field ${n} in block ${e.type}`)}}},Zd=function(e,t){if(t.inputs){var i=Object.keys(t.inputs);for(let s=0;s<i.length;s++){const n=i[s],l=e.getInput(n);if(!l||!l.connection)throw new Pl(n,e,t);Bc(l.connection,t.inputs[n])}}},Vd=function(e,t){if(t.next){if(!e.nextConnection)throw new Pl("next",e,t);Bc(e.nextConnection,t.next)}},Bc=function(e,t){t.shadow&&e.setShadowState(t.shadow),t.block&&Pc(t.block,e.getSourceBlock().workspace,{parentConnection:e})},Gd=function(e,t){if(t){e.setConnectionTracking(!1),e.initSvg(),e.queueRender();for(const i of e.getIcons())i.onLocationChange(e.getRelativeToSurfaceXY())}else e.initModel()},Ao=function(e){return"function"==typeof e.bubbleIsVisible&&"function"==typeof e.setBubbleVisible&&"function"==typeof e.getBubble},Br=function(e){return e*Math.PI/180},Wd=function(e){return 180*e/Math.PI},ps=function(e,t,i){if(i<e){const s=i;i=e,e=s}return Math.max(e,Math.min(t,i))},Fr=function(){document.querySelector(".blocklyDropDownDiv")||((fe=document.createElement("div")).className="blocklyDropDownDiv",fe.tabIndex=-1,(rs()||document.body).appendChild(fe),(Ul=document.createElement("div")).className="blocklyDropDownContent",fe.appendChild(Ul),za=N(Ul,"keydown",null,$n),(Zs=document.createElement("div")).className="blocklyDropDownArrow",fe.appendChild(Zs),fe.style.opacity="0",fe.style.transition="transform "+Wa+"s, opacity "+Wa+"s")},Fc=function(e){gp=e},Uc=function(){return Ui},Ur=function(){return Ul},Hr=function(){za&&(J(za),za=null),fe.remove(),Fr()},_i=function(e,t){fe.style.backgroundColor=e,fe.style.borderColor=t},qd=function(e,t,i,s,n=!0){return Gc(Zc(t),e,n,i,s)},Hc=function(e,t,i,s=!0){return um=!0,Gc(Vc(e),e,s,t,i)},Zc=function(e){var t=e.getSvgRoot();const i=e.workspace.scale,s=e.height*i;return e=e.width*i,t=ko(t),new j(t.y,t.y+s,t.x,t.x+e)},Vc=function(e){return e=e.getScaledBBox(),new j(e.top,e.bottom,e.left,e.right)},Gc=function(e,t,i,s,n){const l=e.left+(e.right-e.left)/2,u=e.bottom;e=e.top,n&&(e+=n);let $=(n=t.getSourceBlock()).workspace;for(;$.options.parentWorkspace;)$=$.options.parentWorkspace;return Fc($.getParentSvg().parentNode),Wc(t,n.RTL,l,u,l,e,i,s)},Wc=function(e,t,i,s,n,l,u,$){return Ui=e,Hs=$||null,fe.style.direction=t?"rtl":"ltr",e=st(),cm=e.getRenderer().getClassName(),am=e.getTheme().getClassName(),R(fe,cm),R(fe,am),i=Yc(i,s,n,l),u&&(qa=o.getFocusManager$$module$build$src$core$focus_manager().takeEphemeralFocus(fe)),i},qc=function(e,t,i,s){return{initialX:(e=gs(e,i.left,i.right,s.width)).divX,initialY:t,finalX:e.divX,finalY:t+hp,arrowX:e.arrowX,arrowY:-(Fl/2+dp),arrowAtTop:!0,arrowVisible:!0}},zc=function(e,t,i,s){return{initialX:(e=gs(e,i.left,i.right,s.width)).divX,initialY:t-s.height,finalX:e.divX,finalY:t-s.height-hp,arrowX:e.arrowX,arrowY:s.height-2*dp-Fl/2,arrowAtTop:!1,arrowVisible:!0}},zd=function(e,t,i){return{initialX:(e=gs(e,t.left,t.right,i.width)).divX,initialY:0,finalX:e.divX,finalY:0,arrowAtTop:null,arrowX:null,arrowY:null,arrowVisible:!1}},gs=function(e,t,i,s){return t=ps(t,e-s/2,i-s),{arrowX:e=ps(i=lm,e=e-Fl/2-t,s-i-Fl),divX:t}},jc=function(){return!!Ui},Zr=function(e,t){return Ui===e&&(t?Vt():Vr(),!0)},Vr=function(){fe.style.transform="translate(0, 0)",fe.style.opacity="0",pp=setTimeout(function(){Vt()},1e3*Wa),Hs&&(Hs(),Hs=null)},Vt=function(){jc()&&(pp&&clearTimeout(pp),Hs&&(Hs(),Hs=null),Hr(),Ui=null,st().markFocused(),qa&&(qa(),qa=null))},Yc=function(e,t,i,s){(e=ja.getPositionMetrics(e,t,i,s)).arrowVisible?(t=e.arrowX,i=e.arrowY,s=e.arrowAtTop?45:225,Zs.style.display="",Zs.style.transform=`translate(${t}px, ${i}px) rotate(${s}deg)`,Zs.setAttribute("class","blocklyDropDownArrow")):Zs.style.display="none",t=Math.floor(e.initialX),i=Math.floor(e.initialY),s=Math.floor(e.finalX);const n=Math.floor(e.finalY);return fe.style.left=t+"px",fe.style.top=i+"px",fe.style.display="block",fe.style.opacity="1",fe.style.transform="translate("+(s-t)+"px,"+(n-i)+"px)",!!e.arrowAtTop},Xc=function(){if(Ui){var e=Ui.getSourceBlock();const t=(e=um?Vc(Ui):Zc(e)).left+(e.right-e.left)/2;Yc(t,e.bottom,t,e.top)}else Vr()},yn=function(e){return e.length?e.reduce(function(t,i){return t.length<i.length?t:i}).length:0},Kc=function(e,t){if(!e.length)return 0;if(1===e.length)return e[0].length;let s,i=0;for(t=t||yn(e),s=0;s<t;s++){for(var n=e[0][s],l=1;l<e.length;l++)if(n!==e[l][s])return i;" "===n&&(i=s+1)}for(n=1;n<e.length;n++)if((l=e[n][s])&&" "!==l)return i;return t},Jc=function(e,t){if(!e.length)return 0;if(1===e.length)return e[0].length;let s,i=0;for(t=t||yn(e),s=0;s<t;s++){for(var n=e[0].substr(-s-1,1),l=1;l<e.length;l++)if(n!==e[l].substr(-s-1,1))return i;" "===n&&(i=s+1)}for(n=1;n<e.length;n++)if((l=e[n].charAt(e[n].length-s-1))&&" "!==l)return i;return t},o.wrap$$module$build$src$core$utils$string=function(e,t){e=e.split("\n");for(let i=0;i<e.length;i++)e[i]=jd(e[i],t);return e.join("\n")},jd=function(e,t){if(e.length<=t)return e;const i=e.trim().split(/\s+/);for(var s=0;s<i.length;s++)i[s].length>t&&(t=i[s].length);var n=-1/0;let l,u=1;do{s=n,l=e,e=[],n=i.length/u;let $=1;for(let C=0;C<i.length-1;C++)$<(C+1.5)/n?($++,e[C]=!0):e[C]=!1;e=Qc(i,e,t),n=Gr(i,e,t),e=Yd(i,e),u++}while(n>s);return l},Gr=function(e,t,i){const s=[0],n=[];for(var l=0;l<e.length;l++)s[s.length-1]+=e[l].length,!0===t[l]?(s.push(0),n.push(e[l].charAt(e[l].length-1))):!1===t[l]&&s[s.length-1]++;for(e=Math.max(...s),t=0,l=0;l<s.length;l++)t-=2*Math.pow(Math.abs(i-s[l]),1.5),t-=Math.pow(e-s[l],1.5),".?!".includes(n[l])?t+=i/3:",;)]}".includes(n[l])&&(t+=i/4);return s.length>1&&s[s.length-1]<=s[s.length-2]&&(t+=.5),t},Qc=function(e,t,i){let n,s=Gr(e,t,i);for(let l=0;l<t.length-1;l++){if(t[l]===t[l+1])continue;const u=[].concat(t);u[l]=!u[l],u[l+1]=!u[l+1];const $=Gr(e,u,i);$>s&&(s=$,n=u)}return n?Qc(e,n,i):t},Yd=function(e,t){const i=[];for(let s=0;s<e.length;s++)i.push(e[s]),void 0!==t[s]&&i.push(t[s]?"\n":" ");return i.join("")},o.isNumber$$module$build$src$core$utils$string=function(e){return/^\s*-?\d+(\.\d+)?\s*$/.test(e)},Xd=function(e){Ya=e},Kd=function(){return Ya},Jd=function(){return Hl},Qd=function(){return Ae},$s=function(e){if(e=ea(e)){for(e=e.tooltip;"function"==typeof e;)e=e();if("string"!=typeof e)throw Error("Tooltip function must return a string.");return e}return""},ea=function(e){for(;e&&e.tooltip;){if("string"==typeof e.tooltip||"function"==typeof e.tooltip)return e;e=e.tooltip}return null},ta=function(){document.querySelector(".blocklyTooltipDiv")||((Ae=document.createElement("div")).className="blocklyTooltipDiv",(rs()||document.body).appendChild(Ae))},Cn=function(e){e.mouseOverWrapper_=Ye(e,"pointerover",null,eh),e.mouseOutWrapper_=Ye(e,"pointerout",null,th),e.addEventListener("pointermove",ia,!1)},oa=function(e){e&&(J(e.mouseOverWrapper_),J(e.mouseOutWrapper_),e.removeEventListener("pointermove",ia))},eh=function(e){tr||(e=ea(e.currentTarget),Nt!==e&&(Gt(),Zl=null,Nt=e),clearTimeout(hm))},th=function(e){tr||(hm=setTimeout(function(){Zl=Nt=null,Gt()},1),clearTimeout(Vs),Vs=0)},ia=function(e){if(Nt&&Nt.tooltip&&!tr)if(Hl){const t=$p-e.pageX;e=mp-e.pageY,Math.sqrt(t*t+e*e)>pm&&Gt()}else Zl!==Nt&&(clearTimeout(Vs),$p=e.pageX,mp=e.pageY,Vs=setTimeout(ca,gm))},sa=function(){Zl=Nt=null,Gt()},Gt=function(){Hl&&(Hl=!1,Ae&&(Ae.style.display="none")),Vs&&(clearTimeout(Vs),Vs=0)},ms=function(){Gt(),tr=!0},Wr=function(){tr=!1},na=function(){Ae&&Nt&&("function"==typeof Ya?Ya(Ae,Nt):ra())},ra=function(){var e=$s(Nt);e=(e=o.wrap$$module$build$src$core$utils$string(e,dm)).split("\n");for(let t=0;t<e.length;t++){const i=document.createElement("div");i.appendChild(document.createTextNode(e[t])),Ae.appendChild(i)}},la=function(e){const t=document.documentElement.clientWidth,i=document.documentElement.clientHeight;let s=$p;s=e?s-(_p+Ae.offsetWidth):s+_p;let n=mp+bp;return n+Ae.offsetHeight>i+window.scrollY&&(n-=Ae.offsetHeight+2*bp),e?s=Math.max(Xa-window.scrollX,s):s+Ae.offsetWidth>t+window.scrollX-2*Xa&&(s=t-Ae.offsetWidth-2*Xa),{x:s,y:n}},ca=function(){if(!tr&&(Zl=Nt,Ae)){Ae.textContent="",na();var e=Nt.RTL;Ae.style.direction=e?"rtl":"ltr",Ae.style.display="block",Hl=!0;var{x:t,y:i}=la(e);Ae.style.left=t+"px",Ae.style.top=i+"px"}},qr=function(){return fp},aa=function(e){fp=e},zr=function(){return Tp},ua=function(e){Tp=e},Ro=function(e){e=`${e}`.toLowerCase().trim();var t=$m[e];if(t||(t="0x"===e.substring(0,2)?"#"+e.substring(2):e,/^#[0-9a-f]{6}$/.test(t="#"===t[0]?t:"#"+t)))return t;if(/^#[0-9a-f]{3}$/.test(t))return["#",t[1],t[1],t[2],t[2],t[3],t[3]].join("");var i=e.match(/^(?:rgb)?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/);return i&&(e=Number(i[1]),t=Number(i[2]),i=Number(i[3]),e>=0&&e<256&&t>=0&&t<256&&i>=0&&i<256)?_s(e,t,i):null},_s=function(e,t,i){return t=e<<16|t<<8|i,e<16?"#"+(16777216|t).toString(16).substr(1):"#"+t.toString(16)},In=function(e){return(e=Ro(e))?[(e=parseInt(e.substr(1),16))>>16,e>>8&255,255&e]:[0,0,0]},Oo=function(e,t,i){let s=0,n=0,l=0;if(0===t)l=n=s=i;else{const u=Math.floor(e/60),$=e/60-u;e=i*(1-t);const C=i*(1-t*$);switch(t=i*(1-t*(1-$)),u){case 1:s=C,n=i,l=e;break;case 2:s=e,n=i,l=t;break;case 3:s=e,n=C,l=i;break;case 4:s=t,n=e,l=i;break;case 5:s=i,n=e,l=C;break;case 6:case 0:s=i,n=t,l=e}}return _s(Math.floor(s),Math.floor(n),Math.floor(l))},Mo=function(e,t,i){return(e=Ro(e))&&(t=Ro(t))?(e=In(e),t=In(t),_s(Math.round(t[0]+i*(e[0]-t[0])),Math.round(t[1]+i*(e[1]-t[1])),Math.round(t[2]+i*(e[2]-t[2])))):null},jr=function(e){return Oo(e,fp,255*Tp)},xn=function(e,t,i){const s=[];var n=e.split("");n.push("");var l=0;e=[];let u=null;for(let F=0;F<n.length;F++){var $=n[F];if(0===l)if("%"===$)(l=e.join(""))&&s.push(l),e.length=0,l=1;else if(i&&"\n"===$){const _e=e.join("");_e&&s.push(_e),e.length=0,s.push($)}else e.push($);else if(1===l)"%"===$?(e.push($),l=0):t&&"0"<=$&&$<="9"?(l=2,u=$,($=e.join(""))&&s.push($),e.length=0):"{"===$?l=3:(e.push("%",$),l=0);else if(2===l)if("0"<=$&&$<="9")u+=$;else{var C=void 0;s.push(parseInt(null!=(C=u)?C:"",10)),F--,l=0}else 3===l&&(""===$?(e.splice(0,0,"%{"),F--,l=0):"}"!==$?e.push($):(l=e.join(""),/[A-Z]\w*/i.test(l)&&($=($=l.toUpperCase()).startsWith("BKY_")?$.substring(4):null)&&$ in o.Msg$$module$build$src$core$msg?"string"==typeof(l=o.Msg$$module$build$src$core$msg[$])?Array.prototype.push.apply(s,xn(l,t,i)):s.push(t?`${l}`:l):s.push("%{"+l+"}"),l=e.length=0))}for((t=e.join(""))&&s.push(t),C=[],e.length=0,n=0;n<s.length;n++)"string"!=typeof s[n]||i&&"\n"===s[n]?((t=e.join(""))&&C.push(t),e.length=0,C.push(s[n])):e.push(s[n]);return(t=e.join(""))&&C.push(t),e.length=0,C},Yr=function(e){return xn(e,!0,!0)},ge=function(e){return"string"!=typeof e?e:(e=xn(e,!1,!1)).length?String(e[0]):""},da=function(e){let t=!0;const i=o.Msg$$module$build$src$core$msg,s=e.match(/%{BKY_[A-Z]\w*}/gi);if(s)for(let n=0;n<s.length;n++)void 0===i[s[n].toUpperCase().slice(6,-1)]&&(console.warn("No message string for "+s[n]+" in "+e),t=!1);return t},bi=function(e){const t="string"==typeof e?ge(e):e;var i=Number(t);if(!isNaN(i)&&0<=i&&i<=360)return{hue:i,hex:Oo(i,qr(),255*zr())};if(i=Ro(t))return{hue:null,hex:i};throw i='Invalid colour: "'+t+'"',e!==t&&(i+=' (from "'+e+'")'),Error(i)},fi=function(){return It},ha=function(e){if(It=e,null===e){let t;null==(t=document.querySelector("."+Ep))||t.remove()}},Xr=function(){const e=rs()||document.body,t=document.querySelector("div."+Ep);t?It=t:((It=document.createElement("div")).className=Ep,It.tabIndex=-1),N(It,"keydown",null,$n),e.appendChild(It)},kn=function(e,t,i,s,n=!0){if(Ti(),or=e,Ka=i,i=It){if(i.style.direction=t?"rtl":"ltr",i.style.display="block",!s&&e instanceof ee){let $;s=null==($=e.getSourceBlock())?void 0:$.workspace}var l,u;_m=null!=(l=s)?l:null,e=null!=(u=s)?u:st(),ir=e.getRenderer().getClassName(),sr=e.getTheme().getClassName(),ir&&R(i,ir),sr&&R(i,sr),n&&(Ja=o.getFocusManager$$module$build$src$core$focus_manager().takeEphemeralFocus(i))}},Ti=function(){if(Kr()){or=null;var e=It;e&&(e.style.display="none",e.style.left="",e.style.top="",Ka&&(Ka(),Ka=null),e.textContent="",ir&&(X(e,ir),ir=""),sr&&(X(e,sr),sr=""),st().markFocused(),Ja&&(Ja(),Ja=null))}},Kr=function(){return!!or},No=function(e){or===e&&Ti()},bs=function(e){let t=null===_m,i=e;for(;!t&&i;){if(i===e){t=!0;break}i=e.options.parentWorkspace}t&&Ti()},Jr=function(e,t,i){It.style.left=e+"px",It.style.top=t+"px",It.style.height=i+"px"},Qr=function(e,t,i,s){const n=ga(e,t,i);e=pa(e,t,i,s),n<0?Jr(e,0,i.height+n):Jr(e,n,i.height)},pa=function(e,t,i,s){return s?Math.min(Math.max(t.right-i.width,e.left),e.right-i.width):Math.max(Math.min(t.left,e.right-i.width),e.left)},ga=function(e,t,i){return t.bottom+i.height>=e.bottom?t.top-i.height:t.bottom},$a=function(e){return!(null==e||!e.repositionForWindowResize)},el=function(){$a(or)&&or.repositionForWindowResize()||Ti()},ma=function(){return Qa},tl=function(e){Qa=e},Ei=function(e,t,i,s,n){if(kn(bm,i,ol,s),t.length){n||(e instanceof PointerEvent?n=new k(e.clientX,e.clientY):(console.warn("Context menu opened with keyboard but no location given"),n=new k(0,0)));var l=_a(t,i,e,n);eu=l,oh(l,i,n),setTimeout(function(){l.focus()},1),Qa=null}else fs()},_a=function(e,t,i,s){const n=new Ua;n.setRole(yt.MENU);for(let l=0;l<e.length;l++){const u=e[l];if(u.separator){n.addChild(new np);continue}const $=new Nl(u.text);$.setRightToLeft(t),$.setRole(yt.MENUITEM),n.addChild($),$.setEnabled(u.enabled),u.enabled&&$.onAction(function(C,F){fs(),requestAnimationFrame(()=>{setTimeout(()=>{u.callback(u.scope,i,F,s)},0)})},{})}return n},oh=function(e,t,i){const s=Ec();i=new j(i.y+s.top,i.y+s.top,i.x+s.left,i.x+s.left),ba(e);const n=e.getSize();t&&(i.left+=n.width,i.right+=n.width,s.left+=n.width,s.right+=n.width),Qr(s,i,n,t),e.focus()},ba=function(e){var t=fi();if(!t)throw Error("Attempting to create a context menu when widget div is null");t=e.render(t),R(t,"blocklyContextMenu"),N(t,"contextmenu",null,fa),e.focus()},fa=function(e){e.preventDefault(),e.stopPropagation()},fs=function(){No(bm),Qa=null},ol=function(){eu&&(eu.dispose(),eu=null)},o.callbackFactory$$module$build$src$core$contextmenu=function(e,t){return()=>{let i;o.disable$$module$build$src$core$events$utils();try{i=t instanceof Element?At(t,e.workspace):mi(t,e.workspace);const s=e.getRelativeToSurfaceXY();s.x=e.RTL?s.x-o.config$$module$build$src$core$config.snapRadius:s.x+o.config$$module$build$src$core$config.snapRadius,s.y+=2*o.config$$module$build$src$core$config.snapRadius,i.moveBy(s.x,s.y)}finally{o.enable$$module$build$src$core$events$utils()}return ne()&&!i.isShadow()&&D(new(P(f.BLOCK_CREATE))(i)),o.getFocusManager$$module$build$src$core$focus_manager().focusNode(i),i}},il=function(e,t){return(t=wt(t,e.getParentSvg(),e.getInverseScreenCTM())).x/=e.scale,t.y/=e.scale,t},h=function(e,t,i){t=il(e,t),Tm.set(e,k.difference(i,t))},w=function(e,t){if(t=il(e,t),!(e=Tm.get(e)))throw Error("Drag not initialized");return k.sum(e,t)},r=function(e,t=!1){const i=o.createElement$$module$build$src$core$utils$xml("xml");var s=a(o.allUsedVarModels$$module$build$src$core$variables(e));s.hasChildNodes()&&i.appendChild(s);for(const n of e.getTopComments())i.appendChild(p(n,t));for(e=e.getTopBlocks(!0),s=0;s<e.length;s++)i.appendChild(_(e[s],t));return i},p=function(e,t=!1){const i=o.createElement$$module$build$src$core$utils$xml("comment");t||i.setAttribute("id",e.id),t=e.workspace;const s=e.getRelativeToSurfaceXY();return s.x=t.RTL?t.getWidth()-s.x:s.x,i.setAttribute("x",`${s.x}`),i.setAttribute("y",`${s.y}`),i.setAttribute("w",`${e.getSize().width}`),i.setAttribute("h",`${e.getSize().height}`),e.getText()&&(i.textContent=e.getText()),e.isCollapsed()&&i.setAttribute("collapsed","true"),e.isOwnEditable()||i.setAttribute("editable","false"),e.isOwnMovable()||i.setAttribute("movable","false"),e.isOwnDeletable()||i.setAttribute("deletable","false"),i},a=function(e){const t=o.createElement$$module$build$src$core$utils$xml("variables");for(let i=0;i<e.length;i++){const s=e[i],n=o.createElement$$module$build$src$core$utils$xml("variable");n.appendChild(o.createTextNode$$module$build$src$core$utils$xml(s.getName())),s.getType()&&n.setAttribute("type",s.getType()),n.id=s.getId(),t.appendChild(n)}return t},_=function(e,t){if(e.isInsertionMarker()&&!(e=e.getChildren(!1)[0]))return new DocumentFragment;let i=0;if(e.workspace.RTL&&(i=e.workspace.getWidth()),t=W(e,t),wn(t)){const s=e.getRelativeToSurfaceXY();t.setAttribute("x",String(Math.round(e.workspace.RTL?i-s.x:s.x))),t.setAttribute("y",String(Math.round(s.y)))}return t},S=function(e){if(e.isSerializable()){const t=o.createElement$$module$build$src$core$utils$xml("field");return t.setAttribute("name",e.name||""),e.toXml(t)}return null},H=function(e,t){for(const i of e.getFields())(e=S(i))&&t.appendChild(e)},W=function(e,t){if(e.isInsertionMarker())return(t=e.getChildren(!1)[0])?W(t):new DocumentFragment;const i=o.createElement$$module$build$src$core$utils$xml(e.isShadow()?"shadow":"block");if(i.setAttribute("type",e.type),t||(i.id=e.id),e.mutationToDom){var s=e.mutationToDom();s&&(s.hasChildNodes()||s.hasAttributes())&&i.appendChild(s)}if(H(e,i),s=e.getCommentText()){var n=e.getIcon(ke.COMMENT),l=n.getBubbleSize(),u=n.bubbleIsVisible();n=n.getBubbleLocation();var $=o.createElement$$module$build$src$core$utils$xml("comment");$.appendChild(o.createTextNode$$module$build$src$core$utils$xml(s)),$.setAttribute("pinned",`${u}`),$.setAttribute("h",`${l.height}`),$.setAttribute("w",`${l.width}`),n&&($.setAttribute("x",`${e.workspace.RTL?e.workspace.getWidth()-(n.x+l.width):n.x}`),$.setAttribute("y",`${n.y}`)),i.appendChild($)}for(e.data&&((s=o.createElement$$module$build$src$core$utils$xml("data")).appendChild(o.createTextNode$$module$build$src$core$utils$xml(e.data)),i.appendChild(s)),s=0;s<e.inputList.length;s++){var C=void 0;u=!0,(l=e.inputList[s]).type!==o.inputTypes$$module$build$src$core$inputs$input_types.DUMMY&&l.type!==o.inputTypes$$module$build$src$core$inputs$input_types.END_ROW&&(n=l.connection.targetBlock(),l.type===o.inputTypes$$module$build$src$core$inputs$input_types.VALUE?C=o.createElement$$module$build$src$core$utils$xml("value"):l.type===o.inputTypes$$module$build$src$core$inputs$input_types.STATEMENT&&(C=o.createElement$$module$build$src$core$utils$xml("statement")),!($=l.connection.getShadowDom())||n&&n.isShadow()||C.appendChild(Wt($,t)),n&&(n=W(n,t)).nodeType===Vo.ELEMENT_NODE&&(C.appendChild(n),u=!1),C.setAttribute("name",l.name),u||i.appendChild(C))}let F;return void 0!==e.inputsInline&&e.inputsInline!==e.inputsInlineDefault&&i.setAttribute("inline",String(e.inputsInline)),e.isCollapsed()&&i.setAttribute("collapsed","true"),e.isEnabled()||i.setAttribute("disabled-reasons",Array.from(e.getDisabledReasons()).map(encodeURIComponent).join(",")),e.isOwnDeletable()||i.setAttribute("deletable","false"),e.isOwnMovable()||i.setAttribute("movable","false"),e.isOwnEditable()||i.setAttribute("editable","false"),(C=e.getNextBlock())&&(s=W(C,t)).nodeType===Vo.ELEMENT_NODE&&(F=o.createElement$$module$build$src$core$utils$xml("next"),F.appendChild(s),i.appendChild(F)),!(e=e.nextConnection&&e.nextConnection.getShadowDom())||C&&C.isShadow()||F.appendChild(Wt(e,t)),i},Wt=function(e,t){let s,i=e=e.cloneNode(!0);for(;i;)if(t&&"shadow"===i.nodeName&&i.removeAttribute("id"),i.firstChild)i=i.firstChild;else{for(;i&&!i.nextSibling;){let n;s=i,i=i.parentNode,s.nodeType===Vo.TEXT_NODE&&""===s.data.trim()&&(null==(n=i)?void 0:n.firstChild)!==s&&Q(s)}i&&(s=i,i=i.nextSibling,s.nodeType===Vo.TEXT_NODE&&""===s.data.trim()&&Q(s))}return e},nt=function(e){return as(e).replace(/<(\w+)([^<]*)\/>/g,"<$1$2></$1>")},qt=function(e){e=nt(e).split("<");let t="";for(let i=1;i<e.length;i++){const s=e[i];"/"===s[0]&&(t=t.substring(2)),e[i]=t+"<"+s,"/"!==s[0]&&"/>"!==s.slice(-2)&&(t+="  ")}return(e=(e=e.join("\n")).replace(/(<(\w+)\b[^>]*>[^\n]*)\n *<\/\2>/g,"$1</$2>")).replace(/^\n/,"")},vi=function(e,t){return t.setResizesEnabled(!1),t.clear(),e=o.domToWorkspace$$module$build$src$core$xml(e,t),t.setResizesEnabled(!0),e},o.domToWorkspace$$module$build$src$core$xml=function(e,t){let i=0;t.RTL&&(i=t.getWidth());const s=[];b();const n=o.getGroup$$module$build$src$core$events$utils();n||o.setGroup$$module$build$src$core$events$utils(!0),t.setResizesEnabled&&t.setResizesEnabled(!1);let l=!0;try{for(let $,u=0;$=e.childNodes[u];u++){const C=$.nodeName.toLowerCase(),F=$;if("block"===C||"shadow"===C&&!Se()){const _e=At(F,t);let le;s.push(_e.id);const je=parseInt(null!=(le=F.getAttribute("x"))?le:"10",10);let Yo;const Eo=parseInt(null!=(Yo=F.getAttribute("y"))?Yo:"10",10);isNaN(je)||isNaN(Eo)||_e.moveBy(t.RTL?i-je:je,Eo,["create"]),l=!1}else{if("shadow"===C)throw TypeError("Shadow block cannot be a top-level block.");if("comment"===C)Lo(F,t);else if("variables"===C){if(!l)throw Error("'variables' tag must exist once before block and shadow tag elements in the workspace XML, but it was found in another location.");Ts(F,t),l=!1}}}}finally{o.setGroup$$module$build$src$core$events$utils(n),t.setResizesEnabled&&t.setResizesEnabled(!0),t.rendered&&wo(),E()}return D(new(P(f.FINISHED_LOADING))(t)),s},Lo=function(e,t){var i;const s=null!=(i=e.getAttribute("id"))?i:void 0;var n,l;let u;var $;let C;return(i=t.rendered?new Kt(t,s):new Wl(t,s)).setText(null!=(n=e.textContent)?n:""),n=parseInt(null!=(l=e.getAttribute("x"))?l:"",10),l=parseInt(null!=(u=e.getAttribute("y"))?u:"",10),isNaN(n)||isNaN(l)||(n=t.RTL?t.getWidth()-n:n,i.moveTo(new k(n,l))),t=parseInt(null!=($=e.getAttribute("w"))?$:"",10),$=parseInt(null!=(C=e.getAttribute("h"))?C:"",10),isNaN(t)||isNaN($)||i.setSize(new Y(t,$)),"true"===e.getAttribute("collapsed")&&i.setCollapsed(!0),"false"===e.getAttribute("editable")&&i.setEditable(!1),"false"===e.getAttribute("movable")&&i.setMovable(!1),"false"===e.getAttribute("deletable")&&i.setDeletable(!1),i},yi=function(e,t){if(!t.getBlocksBoundingBox)return o.domToWorkspace$$module$build$src$core$xml(e,t);var i=t.getBlocksBoundingBox();if(e=o.domToWorkspace$$module$build$src$core$xml(e,t),i&&i.top!==i.bottom){var s=i.bottom;i=t.RTL?i.right:i.left;var n=1/0;let l=-1/0,u=1/0;for(let $=0;$<e.length;$++){const C=t.getBlockById(e[$]).getRelativeToSurfaceXY();C.y<u&&(u=C.y),C.x<n&&(n=C.x),C.x>l&&(l=C.x)}for(s=s-u+10,i=t.RTL?i-l:i-n,n=0;n<e.length;n++)t.getBlockById(e[n]).moveBy(i,s,["create"])}return e},o.domToBlock$$module$build$src$core$xml=function(e,t){return e=At(e,t),t.rendered&&wo(),e},At=function(e,t){o.disable$$module$build$src$core$events$utils();var i=t.getAllVariables();let s;try{if(s=ys(e,t),t.rendered){const n=s,l=s.getDescendants(!1);n.setConnectionTracking(!1);for(let u=l.length-1;u>=0;u--)l[u].initSvg();for(let u=l.length-1;u>=0;u--)l[u].queueRender();setTimeout(function(){n.disposed||n.setConnectionTracking(!0)},1),t.resizeContents()}else{const n=s.getDescendants(!1);for(let l=n.length-1;l>=0;l--)n[l].initModel()}}finally{o.enable$$module$build$src$core$events$utils()}if(ne()){for(e=vn(t,i),t=0;t<e.length;t++)i=e[t],D(new(P(f.VAR_CREATE))(i));D(new(P(f.BLOCK_CREATE))(s))}return s},Ts=function(e,t){for(let s=0;s<e.children.length;s++){var i=e.children[s];const n=i.getAttribute("type"),l=i.getAttribute("id");if(!(i=i.textContent))break;let u;t.getVariableMap().createVariable(i,null!=(u=n)?u:void 0,l)}},Es=function(e){const t={mutation:[],comment:[],data:[],field:[],input:[],next:[]};for(let i=0;i<e.children.length;i++){const s=e.children[i];if(s.nodeType!==Vo.TEXT_NODE)switch(s.nodeName.toLowerCase()){case"mutation":t.mutation.push(s);break;case"comment":t.comment.push(s);break;case"data":t.data.push(s);break;case"title":case"field":t.field.push(s);break;case"value":case"statement":t.input.push(s);break;case"next":t.next.push(s);break;default:console.warn("Ignoring unknown tag: "+s.nodeName)}}return t},Do=function(e,t){let i=!1;for(let s=0;s<e.length;s++)t.domToMutation&&(t.domToMutation(e[s]),t.initSvg&&(i=!0));return i},Ci=function(e,t){for(let i=0;i<e.length;i++){const s=e[i],n=s.textContent,l="true"===s.getAttribute("pinned");let u;const $=parseInt(null!=(u=s.getAttribute("w"))?u:"50",10);let C;const F=parseInt(null!=(C=s.getAttribute("h"))?C:"50",10);let _e,je,le=parseInt(null!=(_e=s.getAttribute("x"))?_e:"",10);const Yo=parseInt(null!=(je=s.getAttribute("y"))?je:"",10);t.setCommentText(n);const Eo=t.getIcon(ke.COMMENT);isNaN($)||isNaN(F)||Eo.setBubbleSize(new Y($,F)),Eo.setBubbleVisible(l),setTimeout(()=>{isNaN(le)||isNaN(Yo)||(le=t.workspace.RTL?t.workspace.getWidth()-(le+$):le,Eo.setBubbleLocation(new k(le,Yo))),Eo.setBubbleVisible(l)},1)}},vs=function(e,t){for(let i=0;i<e.length;i++)t.data=e[i].textContent},Ii=function(e,t){for(let i=0;i<e.length;i++){const s=e[i],n=s.getAttribute("name");n?nl(t,n,s):console.warn(`Ignoring unnamed field in block ${t.type}`)}},xi=function(e){let t=null,i=null;for(let s=0;s<e.childNodes.length;s++){const n=e.childNodes[s];wn(n)&&("block"===n.nodeName.toLowerCase()?t=n:"shadow"===n.nodeName.toLowerCase()&&(i=n))}return{childBlockElement:t,childShadowElement:i}},ki=function(e,t,i,s){for(let l=0;l<e.length;l++){var n=e[l];const u=n.getAttribute("name"),$=u?i.getInput(u):null;if(!$){console.warn("Ignoring non-existent input "+u+" in block "+s);break}if((n=xi(n)).childBlockElement){if(!$.connection)throw TypeError("Input connection does not exist.");ys(n.childBlockElement,t,$.connection,!1)}if(n.childShadowElement){let C;null==(C=$.connection)||C.setShadowDom(n.childShadowElement)}}},sl=function(e,t,i){for(let s=0;s<e.length;s++){const n=xi(e[s]);if(n.childBlockElement){if(!i.nextConnection)throw TypeError("Next statement does not exist.");if(i.nextConnection.isConnected())throw TypeError("Next statement is already connected.");ys(n.childBlockElement,t,i.nextConnection,!0)}n.childShadowElement&&i.nextConnection&&i.nextConnection.setShadowDom(n.childShadowElement)}},ys=function(e,t,i,s){var n;const l=e.getAttribute("type");if(!l)throw TypeError("Block type unspecified: "+e.outerHTML);var u=null!=(n=e.getAttribute("id"))?n:void 0;n=t.newBlock(l,u),u=Es(e);const $=Do(u.mutation,n);if(Ci(u.comment,n),vs(u.data,n),i)if(s){if(!n.previousConnection)throw TypeError("Next block does not have previous statement.");i.connect(n.previousConnection)}else if(n.outputConnection)i.connect(n.outputConnection);else{if(!n.previousConnection)throw TypeError("Child block does not have output or previous statement.");i.connect(n.previousConnection)}if(Ii(u.field,n),ki(u.input,t,n,l),sl(u.next,t,n),$&&n.initSvg(),(t=e.getAttribute("inline"))&&n.setInputsInline("true"===t),(t=e.getAttribute("disabled"))&&n.setDisabledReason("true"===t||"disabled"===t,Mt),null!==(t=e.getAttribute("disabled-reasons")))for(var C of t.split(","))n.setDisabledReason(!0,decodeURIComponent(C));if((C=e.getAttribute("deletable"))&&n.setDeletable("true"===C),(C=e.getAttribute("movable"))&&n.setMovable("true"===C),(C=e.getAttribute("editable"))&&n.setEditable("true"===C),(C=e.getAttribute("collapsed"))&&n.setCollapsed("true"===C),"shadow"===e.nodeName.toLowerCase()){for(e=n.getChildren(!1),C=0;C<e.length;C++)if(!e[C].isShadow())throw TypeError("Shadow block not allowed non-shadow child.");n.setShadow(!0)}return n},nl=function(e,t,i){const s=e.getField(t);s?s.fromXml(i):console.warn("Ignoring non-existent field "+t+" in block "+e.type)},Ta=function(e){for(let t=0;t<e.childNodes.length;t++){const i=e.childNodes[t];if("next"===i.nodeName.toLowerCase()){e.removeChild(i);break}}},wn=function(e){return e.nodeType===Vo.ELEMENT_NODE},bt=function(e,t){U(x.FIELD,e,t)},rl=function(e){tt(x.FIELD,e)},o.fromJson$$module$build$src$core$field_registry=function(e){return vm.fromJsonInternal(e)},ll=function(e){const t=kt(x.FIELD,e.type);return t?t.fromJson(e):(console.warn("Blockly could not create a field of type "+e.type+". The field is probably not being registered. This could be because the file is not loaded, the field does not register itself (Issue #1584), or the registration is not being reached."),null)},ft=function(e){return e&&"object"==typeof e&&"src"in e&&"string"==typeof e.src&&"alt"in e&&"string"==typeof e.alt&&"width"in e&&"number"==typeof e.width&&"height"in e&&"number"==typeof e.height},o.register$$module$build$src$core$extensions=function(e,t){if("string"!=typeof e||""===e.trim())throw Error('Error: Invalid extension name "'+e+'"');if(lr[e])throw Error('Error: Extension "'+e+'" is already registered.');if("function"!=typeof t)throw Error('Error: Extension "'+e+'" must be a function');lr[e]=t},o.registerMixin$$module$build$src$core$extensions=function(e,t){if(!t||"object"!=typeof t)throw Error('Error: Mixin "'+e+'" must be a object');o.register$$module$build$src$core$extensions(e,function(){this.mixin(t)})},o.registerMutator$$module$build$src$core$extensions=function(e,t,i,s){const n='Error when registering mutator "'+e+'": ';An(n,t);const l=Sn(t,n);if(i&&"function"!=typeof i)throw Error(n+'Extension "'+e+'" is not a function');o.register$$module$build$src$core$extensions(e,function(){l&&this.setMutator(new o.MutatorIcon$$module$build$src$core$icons$mutator_icon(s||[],this)),this.mixin(t),i&&i.apply(this)})},cl=function(e){Cs(e)?delete lr[e]:console.warn('No extension mapping for name "'+e+'" found to unregister')},Cs=function(e){return!!lr[e]},Is=function(e,t,i){const s=lr[e];if("function"!=typeof s)throw Error('Error: Extension "'+e+'" not found.');let n;if(i?al(e,t):n=Tt(t),s.apply(t),i)An('Error after applying mutator "'+e+'": ',t);else if(!va(n,t))throw Error('Error when applying extension "'+e+'": mutation properties changed when applying a non-mutator extension.')},al=function(e,t){if(Tt(t).length)throw Error('Error: tried to apply mutation "'+e+'" to a block that already has mutator functions.  Block id: '+t.id)},Ea=function(e,t){return xs(e.mutationToDom,e.domToMutation,t+" mutationToDom/domToMutation")},ul=function(e,t){return xs(e.saveExtraState,e.loadExtraState,t+" saveExtraState/loadExtraState")},Sn=function(e,t){return xs(e.compose,e.decompose,t+" compose/decompose")},xs=function(e,t,i){if(e&&t){if("function"!=typeof e||"function"!=typeof t)throw Error(i+" must be a function");return!0}if(!e&&!t)return!1;throw Error(i+"Must have both or neither functions")},An=function(e,t){const i=Ea(t,e),s=ul(t,e);if(!i&&!s)throw Error(e+"Mutations must contain either XML hooks, or JSON hooks, or both");Sn(t,e)},Tt=function(e){const t=[];return void 0!==e.domToMutation&&t.push(e.domToMutation),void 0!==e.mutationToDom&&t.push(e.mutationToDom),void 0!==e.saveExtraState&&t.push(e.saveExtraState),void 0!==e.loadExtraState&&t.push(e.loadExtraState),void 0!==e.compose&&t.push(e.compose),void 0!==e.decompose&&t.push(e.decompose),t},va=function(e,t){if((t=Tt(t)).length!==e.length)return!1;for(let i=0;i<t.length;i++)if(e[i]!==t[i])return!1;return!0},dl=function(e){if("object"!=typeof document)throw Error("runAfterPageLoad() requires browser document.");if("complete"===document.readyState)e();else{const t=setInterval(function(){"complete"===document.readyState&&(clearInterval(t),e())},10)}},o.buildTooltipForDropdown$$module$build$src$core$extensions=function(e,t){const i=[];return function(){i.includes(this.type)||(hl(this,e,t),i.push(this.type)),this.setTooltip(function(){const s=String(this.getFieldValue(e));return ge(t[s])}.bind(this))}},hl=function(e,t,i){var s=e.getField(t);if(s instanceof Ve&&!s.isOptionListDynamic()){s=s.getOptions();for(const n of s)n!==Ve.SEPARATOR&&([,s]=n,void 0===i[s]&&console.warn(`No tooltip mapping for value ${s} of field ${t} of block type ${e.type}.`))}},o.buildTooltipWithFieldText$$module$build$src$core$extensions=function(e,t){return function(){this.setTooltip(function(){const i=this.getField(t);return ge(e).replace("%1",i?i.getText():"")}.bind(this))}},pl=function(){const e=this.tooltip;this.setTooltip(function(){const t=this.getParent();return t&&t.getInputsInline()&&t.tooltip||e}.bind(this))},L=function(e,t){return" "+e+","+t+" "},Ne=function(e,t){return" "+e+t.join("")},Ie=function(e,t){return" M "+e+","+t+" "},ae=function(e,t){return" m "+e+","+t+" "},rt=function(e,t){return" l "+e+","+t+" "},Po=function(e){return" l"+e.join("")},B=function(e,t){return" "+e+" "+t+" "},pe=function(e,t,i,s){return e+" "+i+" "+i+" "+t+s},Rn=function(e,t){if(!e||!t)throw Error("Cannot connect null connections.");e.targetConnection=t,t.targetConnection=e},gl=function(e,t){let i=null;t=t.outputConnection;const s=t?.getConnectionChecker();for(let l,n=0;l=e.inputList[n];n++){const u=l.connection;let $;if(u&&null!=($=s)&&$.canConnect(t,u,!1)){if(i)return null;i=u}}return i},$l=function(e,t){let i;for(;i=gl(e,t);)if(!(e=i.targetBlock())||e.isShadow())return i;return null},ks=function(e){return xo(e)&&"function"==typeof e.getType&&"function"==typeof e.initView&&"function"==typeof e.dispose&&"function"==typeof e.getWeight&&"function"==typeof e.getSize&&"function"==typeof e.applyColour&&"function"==typeof e.hideForInsertionMarker&&"function"==typeof e.updateEditable&&"function"==typeof e.updateCollapsed&&"function"==typeof e.isShownWhenCollapsed&&"function"==typeof e.setOffsetInBlock&&"function"==typeof e.onLocationChange&&"function"==typeof e.onClick},On=function(e){return ks(e)&&Ao(e)&&us(e)&&"function"==typeof e.setText&&"function"==typeof e.getText&&"function"==typeof e.setBubbleSize&&"function"==typeof e.getBubbleSize&&"function"==typeof e.setBubbleLocation&&"function"==typeof e.getBubbleLocation&&e.getType()===ke.COMMENT},wi=function(e){if(!(e.getDescendants(!1).length>100)){var t=e.workspace,i=e.getSvgRoot();t.getAudioManager().play("delete");var l,s=e.getRelativeToSurfaceXY(),n=i.cloneNode(!0);n.setAttribute("transform","translate("+s.x+","+s.y+")"),null==(l=t.getLayerManager())||l.appendToAnimationLayer({getSvgRoot:()=>n}),Mn(n,{x:s.x,y:s.y,width:e.width,height:e.height},t.RTL,new Date)}},Mn=function(e,t,i,s){const n=((new Date).getTime()-s.getTime())/150;n>1?Q(e):(e.setAttribute("transform","translate("+(t.x+(i?-1:1)*t.width/2*n)+","+(t.y+t.height/2*n)+") scale("+(1-n)+")"),setTimeout(Mn,10,e,t,i,s))},Nn=function(e){var t=e.workspace;const i=t.scale;if(t.getAudioManager().play("click"),!(i<1)){var s=t.getSvgXY(e.getSvgRoot());e.outputConnection?(s.x+=(e.RTL?3:-3)*i,s.y+=13*i):e.previousConnection&&(s.x+=(e.RTL?-23:23)*i,s.y+=3*i);var n=I(T.CIRCLE,{cx:s.x,cy:s.y,r:0,fill:"none",stroke:"#888","stroke-width":10},t.getParentSvg());e=I(T.ANIMATE,{id:"animationCircle",begin:"indefinite",attributeName:"r",dur:"150ms",from:0,to:25*i},n),t=I(T.ANIMATE,{id:"animationOpacity",begin:"indefinite",attributeName:"opacity",dur:"150ms",from:1,to:0},n),e.beginElement(),t.beginElement(),setTimeout(()=>{Q(n)},150)}},Ln=function(e){if(Bo(),e.workspace.getAudioManager().play("disconnect"),!(e.workspace.scale<1)){var t=e.getHeightWidth().height;t=Math.atan(10/t)/Math.PI*180,e.RTL||(t*=-1),Yl=e,Dn(e,t,new Date,0)}},Dn=function(e,t,i,s){const n=[.66,1,.66,0,-.66,-1,-.66,0];let l="";i.getTime()+200>(new Date).getTime()&&(l=`skewX(${Math.round(n[s%n.length]*t)})`,pu=setTimeout(Dn,15,e,t,i,s+1)),e.getSvgRoot().setAttribute("transform",`${e.getTranslation()} ${l}`)},Bo=function(){Yl&&(pu&&(clearTimeout(pu),pu=null),Yl.getSvgRoot().setAttribute("transform",Yl.getTranslation()),Yl=null)},ws=function(e,t){const i=e.workspace,s=o.config$$module$build$src$core$config.snapRadius,n=k.difference(t,e.getRelativeToSurfaceXY()),l=new k(0,0),u=i.getAllBlocks(!1).filter($=>$.id!=e.id).map($=>$.getRelativeToSurfaceXY());for(;ml(k.sum(t,l),u)||ya(e,k.sum(n,l),s);)l.translate(i.RTL?-s:s,2*s);e.moveTo(k.sum(t,l))},ml=function(e,t){return t.some(i=>Math.abs(i.x-e.x)<=1&&Math.abs(i.y-e.y)<=1)},ya=function(e,t,i){return e.getConnections_(!1).some(s=>!!s.closest(i,t).connection)},Rt=function(e,t,i){const s=i.getBoundingRectangle(),n=s.right-s.left,l=ps(t.top,s.top,t.top+t.height-(s.bottom-s.top))-s.top;let u=t.left;return t=t.left+t.width-n,e.RTL?u=Math.min(t,u):t=Math.max(u,t),!(!(e=ps(u,s.left,t)-s.left)&&!l||(i.moveBy(e,l,["inbounds"]),0))},Pn=function(e){return t=>{var s,i=e.getMetricsManager();if(i.hasFixedEdges()&&!e.isDragging())if(Vh.includes(null!=(s=t.type)?s:"")){s=i.getScrollMetrics(!0);const n=_l(e,t);n&&(i=o.getGroup$$module$build$src$core$events$utils()||!1,o.setGroup$$module$build$src$core$events$utils(t.group),Rt(e,s,n)&&!t.group&&console.warn("Moved object in bounds but there was no event group. This may break undo."),o.setGroup$$module$build$src$core$events$utils(i))}else Co(t)&&t.scale&&t.oldScale&&t.scale>t.oldScale&&Ss(e)}},_l=function(e,t){let i=null;switch(t.type){case f.BLOCK_CREATE:case f.BLOCK_MOVE:(i=e.getBlockById(t.blockId))&&(i=i.getRootBlock());break;case f.COMMENT_CREATE:case f.COMMENT_MOVE:case f.COMMENT_RESIZE:i=e.getCommentById(t.commentId)}return i},Ss=function(e){var t=e.getMetricsManager();if(t.hasFixedEdges()&&!e.isDragging()){t=t.getScrollMetrics(!0);var i=e.getTopBoundedElements();for(let n,s=0;n=i[s];s++)Rt(e,t,n)}},Xe=function(e){return e&&"function"==typeof e.isDeletable&&"function"==typeof e.dispose&&"function"==typeof e.setDeleteStyle},Bn=function(e,t){const i=e.getIcons();for(const s of e.inputList){if(!s.isVisible())continue;let n;if(i.push(...s.fieldRow),null!=(n=s.connection)&&n.targetBlock())if(e=s.connection.targetBlock(),s.connection.type!==M.NEXT_STATEMENT||t)i.push(e);else{let l;(e=null==(l=e.lastConnectionInStack(!1))?void 0:l.getSourceBlock())&&i.push(e)}else{let l;(null==(l=s.connection)?void 0:l.type)===M.INPUT_VALUE&&i.push(s.connection)}}return i},po=function(e,t){const i=e.workspace.getTopBoundedElements(!0).filter(n=>xo(n));let s=null;if((e=i.indexOf(e instanceof se?e.getRootBlock():e)+t)>=0&&e<i.length?s=i[e]:e<0?s=i[i.length-1]:e>=i.length&&(s=i[0]),t<0&&s instanceof se){let n,l;return null!=(l=null==(n=s.lastConnectionInStack(!1))?void 0:n.getSourceBlock())?l:s}return s},lt=function(e,t){var i;let s;const n=e instanceof se?null!=(s=null==(i=e.outputConnection)?void 0:i.targetBlock())?s:e.getSurroundParent():e.getSourceBlock();return n instanceof se&&-1!==(e=(i=Bn(n,t>0)).indexOf(e))&&(t=e+t)>=0&&t<i.length?i[t]:null},zt=function(e){return e&&"function"==typeof e.getRelativeToSurfaceXY&&"function"==typeof e.isMovable&&"function"==typeof e.startDrag&&"function"==typeof e.drag&&"function"==typeof e.endDrag&&"function"==typeof e.revertDrag},Fn=function(e){return e&&"function"==typeof e.autoHide},Un=function(e,t){U(x.ICON,e.toString(),t)},bl=function(e){tt(x.ICON,e)},We=function(e){return"function"==typeof e.getProcedureModel&&"function"==typeof e.doProcedureUpdate&&"function"==typeof e.isProcedureDef},ct=function(e){return e&&"function"==typeof e.startPublishing&&"function"==typeof e.stopPublishing},Si=function(e){const t=e.getProcedureMap().getProcedures().filter(s=>!s.getReturnTypes()).map(s=>[s.getName(),s.getParameters().map(n=>n.getName()),!1]);e.getBlocksByType("procedures_defnoreturn",!1).forEach(s=>{!We(s)&&pi(s)&&t.push(s.getProcedureDef())});const i=e.getProcedureMap().getProcedures().filter(s=>!!s.getReturnTypes()).map(s=>[s.getName(),s.getParameters().map(n=>n.getName()),!0]);return e.getBlocksByType("procedures_defreturn",!1).forEach(s=>{!We(s)&&pi(s)&&i.push(s.getProcedureDef())}),t.sort(Hn),i.sort(Hn),[t,i]},Hn=function(e,t){return e[0].localeCompare(t[0],void 0,{sensitivity:"base"})},o.findLegalName$$module$build$src$core$procedures=function(e,t){if(t.isInFlyout)return e;for(e=e||o.Msg$$module$build$src$core$msg.UNNAMED_KEY||"unnamed";!Fo(e,t.workspace,t);){const i=e.match(/^(.*?)(\d+)$/);e=i?i[1]+(parseInt(i[2])+1):e+"2"}return e},Fo=function(e,t,i){return!Ot(e,t,i)},Ot=function(e,t,i){for(const s of t.getAllBlocks(!1))if(s!==i&&pi(s)&&o.Names$$module$build$src$core$names.equals(s.getProcedureDef()[0],e))return!0;i=i&&We(i)?i?.getProcedureModel():void 0;for(const s of t.getProcedureMap().getProcedures())if(s!==i&&o.Names$$module$build$src$core$names.equals(s.getName(),e))return!0;return!1},o.rename$$module$build$src$core$procedures=function(e){var t=this.getSourceBlock();if(!t)throw new Te;e=e.trim();const i=o.findLegalName$$module$build$src$core$procedures(e,t);We(t)&&!t.isInsertionMarker()&&t.getProcedureModel().setName(i);const s=this.getValue();if(s!==e&&s!==i)for(e=t.workspace.getAllBlocks(!1),t=0;t<e.length;t++){const n=e[t];n.renameProcedure&&n.renameProcedure(s,i)}return i},fl=function(e){function t(l,u){for(let C=0;C<l.length;C++){var $=l[C][0];const F=l[C][1],_e=o.createElement$$module$build$src$core$utils$xml("block");_e.setAttribute("type",u),_e.setAttribute("gap","16");const le=o.createElement$$module$build$src$core$utils$xml("mutation");for(le.setAttribute("name",$),_e.appendChild(le),$=0;$<F.length;$++){const je=o.createElement$$module$build$src$core$utils$xml("arg");je.setAttribute("name",F[$]),le.appendChild(je)}i.push(_e)}}const i=[];if(ue.procedures_defnoreturn){var s=o.createElement$$module$build$src$core$utils$xml("block");s.setAttribute("type","procedures_defnoreturn"),s.setAttribute("gap","16");var n=o.createElement$$module$build$src$core$utils$xml("field");n.setAttribute("name","NAME"),n.appendChild(o.createTextNode$$module$build$src$core$utils$xml(o.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_PROCEDURE)),s.appendChild(n),i.push(s)}return ue.procedures_defreturn&&((s=o.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","procedures_defreturn"),s.setAttribute("gap","16"),(n=o.createElement$$module$build$src$core$utils$xml("field")).setAttribute("name","NAME"),n.appendChild(o.createTextNode$$module$build$src$core$utils$xml(o.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_PROCEDURE)),s.appendChild(n),i.push(s)),ue.procedures_ifreturn&&((s=o.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","procedures_ifreturn"),s.setAttribute("gap","16"),i.push(s)),i.length&&i[i.length-1].setAttribute("gap","24"),t((e=Si(e))[0],"procedures_callnoreturn"),t(e[1],"procedures_callreturn"),i},Et=function(e){return Zn(e,!1)},Zn=function(e,t=!0){function i(n,l){for(const[u,$]of n)s.push({kind:"block",type:l,gap:16,extraState:{name:u,params:$}})}if(t)return Me("The XML return value of Blockly.Procedures.flyoutCategory()","v12","v13","the same method, but handle a return type of FlyoutItemInfo[] (JSON) instead."),fl(e);const s=[];return ue.procedures_defnoreturn&&s.push({kind:"block",type:"procedures_defnoreturn",gap:16,fields:{NAME:o.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_PROCEDURE}}),ue.procedures_defreturn&&s.push({kind:"block",type:"procedures_defreturn",gap:16,fields:{NAME:o.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_PROCEDURE}}),ue.procedures_ifreturn&&s.push({kind:"block",type:"procedures_ifreturn",gap:16}),s.length&&(s[s.length-1].gap=24),i((e=Si(e))[0],"procedures_callnoreturn"),i(e[1],"procedures_callreturn"),s},Vn=function(e){var t=[],i=e.getBlocksByType("procedures_mutatorarg",!1);for(let u,l=0;u=i[l];l++)t.push(u.getFieldValue("NAME"));i=o.createElement$$module$build$src$core$utils$xml("xml");const s=o.createElement$$module$build$src$core$utils$xml("block");s.setAttribute("type","procedures_mutatorarg");const n=o.createElement$$module$build$src$core$utils$xml("field");n.setAttribute("name","NAME"),t=Dr(o.DEFAULT_ARG$$module$build$src$core$procedures,t),t=o.createTextNode$$module$build$src$core$utils$xml(t),n.appendChild(t),s.appendChild(n),i.appendChild(s),e.updateToolbox(i)},As=function(e){if(oi(e)&&"mutator"===e.bubbleType&&e.isOpen&&e.blockId){var t=(e=uo(e.workspaceId).getBlockById(e.blockId)).type;("procedures_defnoreturn"===t||"procedures_defreturn"===t)&&(e=e.getIcon(o.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE).getWorkspace(),Vn(e),e.addChangeListener(Tl))}},Tl=function(e){(ao(e)||ei(e)||Pt(e)||Ki(e))&&(e=uo(e.workspaceId),Vn(e))},El=function(e,t){return t.getAllBlocks(!1).filter(i=>Gn(i,e)||Ac(i)&&o.Names$$module$build$src$core$names.equals(i.getProcedureCall(),e))},Gn=function(e,t){return We(e)&&!e.isProcedureDef()&&e.getProcedureModel()&&o.Names$$module$build$src$core$names.equals(e.getProcedureModel().getName(),t)},o.mutateCallers$$module$build$src$core$procedures=function(e){const t=Se();var i=e.getProcedureDef()[0];const s=e.mutationToDom(!0);e=El(i,e.workspace);for(let u,l=0;u=e[l];l++){i=(i=u.mutationToDom())&&as(i),u.domToMutation&&u.domToMutation(s);var n=u.mutationToDom();i!==(n=n&&as(n))&&(o.setRecordUndo$$module$build$src$core$events$utils(!1),D(new(P(f.BLOCK_CHANGE))(u,"mutation",null,i,n)),o.setRecordUndo$$module$build$src$core$events$utils(t))}},o.getDefinition$$module$build$src$core$procedures=function(e,t){for(const i of t.getAllBlocks(!1))if(We(i)&&i.isProcedureDef()&&o.Names$$module$build$src$core$names.equals(i.getProcedureModel().getName(),e)||pi(i)&&o.Names$$module$build$src$core$names.equals(i.getProcedureDef()[0],e))return i;return null},Rs=function(e){return e.isDynamic},Wn=function(e){return void 0!==e.pathDown&&void 0!==e.pathUp},qn=function(e){return void 0!==e.pathLeft&&void 0!==e.pathRight},Os=function(e,t){U(x.RENDERER,e,t)},vl=function(e){tt(x.RENDERER,e)},zn=function(e,t,i){return(e=new(ot(x.RENDERER,e))(e)).init(t,i),e},Ms=function(e){gi(e.getTargetWorkspace(),void 0,"String")},Ai=function(e){gi(e.getTargetWorkspace(),void 0,"Number")},Ri=function(e){gi(e.getTargetWorkspace(),void 0,"Colour")},jn=function(e){return Z(e,!1)},Z=function(e,t=!0){return ue.variables_set_dynamic||ue.variables_get_dynamic||console.warn("There are no dynamic variable blocks, but there is a dynamic variable category."),t?(Me("The XML return value of Blockly.VariablesDynamic.flyoutCategory()","v12","v13","the same method, but handle a return type of FlyoutItemInfo[] (JSON) instead."),z(e)):(e.registerButtonCallback("CREATE_VARIABLE_STRING",Ms),e.registerButtonCallback("CREATE_VARIABLE_NUMBER",Ai),e.registerButtonCallback("CREATE_VARIABLE_COLOUR",Ri),[{kind:"button",text:o.Msg$$module$build$src$core$msg.NEW_STRING_VARIABLE,callbackkey:"CREATE_VARIABLE_STRING"},{kind:"button",text:o.Msg$$module$build$src$core$msg.NEW_NUMBER_VARIABLE,callbackkey:"CREATE_VARIABLE_NUMBER"},{kind:"button",text:o.Msg$$module$build$src$core$msg.NEW_COLOUR_VARIABLE,callbackkey:"CREATE_VARIABLE_COLOUR"},...Lr(e,e.getVariableMap().getAllVariables(),!1,"variables_get_dynamic","variables_set_dynamic")])},z=function(e){let t=[],i=document.createElement("button");return i.setAttribute("text",o.Msg$$module$build$src$core$msg.NEW_STRING_VARIABLE),i.setAttribute("callbackKey","CREATE_VARIABLE_STRING"),t.push(i),i=document.createElement("button"),i.setAttribute("text",o.Msg$$module$build$src$core$msg.NEW_NUMBER_VARIABLE),i.setAttribute("callbackKey","CREATE_VARIABLE_NUMBER"),t.push(i),i=document.createElement("button"),i.setAttribute("text",o.Msg$$module$build$src$core$msg.NEW_COLOUR_VARIABLE),i.setAttribute("callbackKey","CREATE_VARIABLE_COLOUR"),t.push(i),e.registerButtonCallback("CREATE_VARIABLE_STRING",Ms),e.registerButtonCallback("CREATE_VARIABLE_NUMBER",Ai),e.registerButtonCallback("CREATE_VARIABLE_COLOUR",Ri),e=Ue(e),t.concat(e)},Ue=function(e){const t=[];if((e=e.getVariableMap().getAllVariables()).length>0){if(ue.variables_set_dynamic){var i=e[e.length-1];const s=o.createElement$$module$build$src$core$utils$xml("block");s.setAttribute("type","variables_set_dynamic"),s.setAttribute("gap","24"),s.appendChild($i(i)),t.push(s)}if(ue.variables_get_dynamic){e.sort(ds);for(let n,s=0;n=e[s];s++)(i=o.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","variables_get_dynamic"),i.setAttribute("gap","8"),i.appendChild($i(n)),t.push(i)}}return t},Vg=function(e){e.resizeContents()},Ca=function(e,t){const i=e.toCopyData();return ac=i,uc=ss(e)&&e.workspace instanceof ze?e.workspace:null,Pu=t,i},Ia=function(){return ac},Gg=function(e){ac=e},xa=function(){return uc},Wg=function(e){uc=e},ih=function(){return Pu},qg=function(e){Pu=e},Oi=function(e,t,i){return e&&t?sh(e,t,i):ac&&uc?sh(ac,uc,Pu):null},sh=function(e,t,i){let s,n,l;return t=t.isMutator?t:null!=(s=t.options.parentWorkspace)?s:t,null!=(l=null==(n=kt(x.PASTER,e.paster,!1))?void 0:n.paste(e,t,i))?l:null},Yn=function(e){return e&&"function"==typeof e.toCopyData},nh=function(){re.registry.register({name:jo.ESCAPE,preconditionFn:e=>!e.isReadOnly(),callback:e=>(e.hideChaff(),!0),keyCodes:[ie.ESC]})},rh=function(){re.registry.register({name:jo.DELETE,preconditionFn:(e,t)=>(t=t.focusedNode,!e.isReadOnly()&&null!=t&&Xe(t)&&t.isDeletable()&&!e.isDragging()&&!o.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()),callback:(e,t,i,s)=>(t.preventDefault(),(e=s.focusedNode)instanceof se?e.checkAndDelete():Xe(e)&&e.isDeletable()&&(o.setGroup$$module$build$src$core$events$utils(!0),e.dispose(),o.setGroup$$module$build$src$core$events$utils(!1)),!0),keyCodes:[ie.DELETE,ie.BACKSPACE]})},ka=function(e){return!!(Yn(e)&&Xe(e)&&zt(e))&&(e.isCopyable?e.isCopyable():e instanceof se||e instanceof Kt?e.isOwnDeletable()&&e.isOwnMovable():e.isDeletable()&&e.isMovable())},lh=function(e){return ka(e)&&Xe(e)&&e.isDeletable()},ch=function(){const e=re.registry.createSerializedKey(ie.C,[ie.CTRL]),t=re.registry.createSerializedKey(ie.C,[ie.META]);re.registry.register({name:jo.COPY,preconditionFn:(i,s)=>(i=i.isFlyout?i.targetWorkspace:i,!!(s=s.focusedNode)&&!!i&&!i.isDragging()&&!o.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()&&ka(s)),callback:(i,s,n,l)=>(s.preventDefault(),!!((s=l.focusedNode)&&Yn(s)&&ka(s)&&(i=i.isFlyout?i.targetWorkspace:i,i))&&(s.workspace.isFlyout||i.hideChaff(),i=zt(s)&&s.workspace==i?s.getRelativeToSurfaceXY():void 0,!!Ca(s,i))),keyCodes:[e,t]})},ah=function(){const e=re.registry.createSerializedKey(ie.X,[ie.CTRL]),t=re.registry.createSerializedKey(ie.X,[ie.META]);re.registry.register({name:jo.CUT,preconditionFn:(i,s)=>!!(s=s.focusedNode)&&!i.isReadOnly()&&!i.isDragging()&&!o.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()&&lh(s),callback:(i,s,n,l)=>!!((i=l.focusedNode)&&lh(i)&&Yn(i))&&(s=zt(i)?i.getRelativeToSurfaceXY():void 0,s=Ca(i,s),i instanceof se?i.checkAndDelete():Xe(i)&&i.dispose(),!!s),keyCodes:[e,t]})},uh=function(){const e=re.registry.createSerializedKey(ie.V,[ie.CTRL]),t=re.registry.createSerializedKey(ie.V,[ie.META]);re.registry.register({name:jo.PASTE,preconditionFn(){var i=xa();return!(!i||!i.rendered||(i=i.isFlyout?i.targetWorkspace:i,!Ia()||!i||i.isReadOnly()||i.isDragging()||o.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()))},callback(i,s){if(!(i=Ia()))return!1;var n=xa();if(!n||!(n=n.isFlyout?n.targetWorkspace:n)||n.isReadOnly())return!1;if(s instanceof PointerEvent)return s=yc(n,new k(s.clientX,s.clientY)),!!Oi(i,n,s);if(!(s=ih()))return!!Oi(i,n);const{left:l,top:u,width:$,height:C}=n.getMetricsManager().getViewMetrics(!0);return new j(u,u+C,l,l+$).contains(s.x,s.y)?!!Oi(i,n):(s=new k(l+$/2,u+C/2),!!Oi(i,n,s))},keyCodes:[e,t]})},dh=function(){const e=re.registry.createSerializedKey(ie.Z,[ie.CTRL]),t=re.registry.createSerializedKey(ie.Z,[ie.META]);re.registry.register({name:jo.UNDO,preconditionFn:i=>!i.isReadOnly()&&!i.isDragging()&&!o.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken(),callback:(i,s)=>(i.hideChaff(),i.undo(!1),s.preventDefault(),!0),keyCodes:[e,t]})},hh=function(){const e=re.registry.createSerializedKey(ie.Z,[ie.CTRL,ie.SHIFT]),t=re.registry.createSerializedKey(ie.Z,[ie.META,ie.SHIFT]),i=re.registry.createSerializedKey(ie.Y,[ie.CTRL]);re.registry.register({name:jo.REDO,preconditionFn:s=>!s.isDragging()&&!s.isReadOnly()&&!o.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken(),callback:(s,n)=>(s.hideChaff(),s.undo(!0),n.preventDefault(),!0),keyCodes:[e,t,i]})},ph=function(){nh(),rh(),ch(),ah(),uh(),dh(),hh()},gh=function(e){const t=e.saveState();return e.getParameters().length&&(t.parameters=e.getParameters().map(i=>i.saveState())),t},$h=function(e,t,i,s){if(e=e.loadState(i,s),!i.parameters)return e;for(const[n,l]of i.parameters.entries())e.insertParameter(t.loadState(l,s),n);return e},zg=function(e){const t=Object.create(null),i=ro(x.SERIALIZER,!0);for(const s in i){let n;const l=null==(n=i[s])?void 0:n.save(e);l&&(t[s]=l)}return t},jg=function(e,t,{recordUndo:i=!1}={}){var s=ro(x.SERIALIZER,!0);if(s){s=Object.entries(s).sort((l,u)=>u[1].priority-l[1].priority);var n=Se();o.setRecordUndo$$module$build$src$core$events$utils(i),(i=o.getGroup$$module$build$src$core$events$utils())||o.setGroup$$module$build$src$core$events$utils(!0),b(),t instanceof ze&&t.setResizesEnabled(!1);for(const[,l]of s.reverse()){let u;null==(u=l)||u.clear(t)}for(const[l,u]of s.reverse())if(e[l]){let $;null==($=u)||$.load(e[l],t)}t instanceof ze&&t.setResizesEnabled(!0),E(),D(new(P(f.FINISHED_LOADING))(t)),o.setGroup$$module$build$src$core$events$utils(i),o.setRecordUndo$$module$build$src$core$events$utils(n)}},mh=function(e,t){let i=null;var s;if(i="string"==typeof e?document.getElementById(e)||document.querySelector(e):e,!document.contains(i)&&document!==(null==(s=i)?void 0:s.ownerDocument))throw Error("Error: container is not in current document");e=new Jt(t||{}),s=document.createElement("div"),R(s,"injectionDiv"),null!=t&&t.rtl&&R(s,"blocklyRTL"),i.appendChild(s),t=Yg(s,e);const n=Xg(s,t,e);return Kg(n),ns(n),dt(n),s.addEventListener("focusin",function(){ns(n)}),N(s,"keydown",null,$n),n},Yg=function(e,t){e.setAttribute("dir","LTR"),$c(t.hasCss,t.pathToMedia);const i=I(T.SVG,{xmlns:Il,"xmlns:html":go,"xmlns:xlink":vt,version:"1.1",class:"blocklySvg"},e),s=I(T.DEFS,{},i),n=String(Math.random()).substring(2);return t.gridPattern=bu.createDom(n,t.gridOptions,s,e),i},Xg=function(e,t,i){i.parentWorkspace=null;const s=(i=new ze(i)).options;i.scale=s.zoomOptions.startScale,t.appendChild(i.createDom("blocklyMainBackground",e));var n=i.getRenderer().getClassName();return n&&R(e,n),(n=i.getTheme().getClassName())&&R(e,n),!s.hasCategories&&s.languageTree&&(e=i.addFlyout(T.SVG),c(e,t)),s.hasTrashcan&&i.addTrashcan(),s.zoomOptions&&s.zoomOptions.controls&&i.addZoomControls(),i.getThemeManager().subscribe(t,"workspaceBackgroundColour","background-color"),i.translate(0,0),i.addChangeListener(Pn(i)),dt(i),Xr(),Fr(),ta(),i},Kg=function(e){const t=e.options;var i=e.getParentSvg();if(N(i.parentNode,"contextmenu",null,function(s){vo(s)||s.preventDefault()}),i=N(window,"resize",null,function(){Gt(),e.hideComponents(!0),Xc(),el(),dt(e),Ss(e)}),e.setResizeHandlerWrapper(i),Jg(),t.languageTree){i=e.getToolbox();const s=e.getFlyout(!0);i?i.init():s&&(s.init(e),s.show(t.languageTree),"function"==typeof s.scrollToStart&&s.scrollToStart())}t.hasTrashcan&&e.trashcan.init(),t.zoomOptions&&t.zoomOptions.controls&&e.zoomControls_.init(),t.moveOptions&&t.moveOptions.scrollbars?(e.scrollbar=new _u(e,!0===t.moveOptions.scrollbars||!!t.moveOptions.scrollbars.horizontal,!0===t.moveOptions.scrollbars||!!t.moveOptions.scrollbars.vertical,"blocklyMainWorkspaceScrollbar"),e.scrollbar.resize()):e.setMetrics({x:.5,y:.5}),t.hasSounds&&Qg(t.pathToMedia,e)},Jg=function(){Zm||(N(document,"scroll",null,function(){const e=ui();for(let i,t=0;i=e[t];t++)i instanceof ze&&i.updateInverseScreenCTM()}),Ye(document,"touchend",null,at),Ye(document,"touchcancel",null,at)),Zm=!0},Qg=function(e,t){function i(){for(;n.length;){const l=n.pop();l&&J(l)}s.preload()}const s=t.getAudioManager();s.load([e+"click.mp3",e+"click.wav",e+"click.ogg"],"click"),s.load([e+"disconnect.wav",e+"disconnect.mp3",e+"disconnect.ogg"],"disconnect"),s.load([e+"delete.mp3",e+"delete.ogg",e+"delete.wav"],"delete");const n=[];n.push(N(document,"pointermove",null,i,!0)),n.push(N(document,"touchstart",null,i,!0))},_h=function(){q.registry.register({displayText:()=>o.Msg$$module$build$src$core$msg.UNDO,preconditionFn:e=>e.workspace.getUndoStack().length>0?"enabled":"disabled",callback(e){e.workspace.undo(!1)},scopeType:q.ScopeType.WORKSPACE,id:"undoWorkspace",weight:1})},bh=function(){q.registry.register({displayText:()=>o.Msg$$module$build$src$core$msg.REDO,preconditionFn:e=>e.workspace.getRedoStack().length>0?"enabled":"disabled",callback(e){e.workspace.undo(!0)},scopeType:q.ScopeType.WORKSPACE,id:"redoWorkspace",weight:2})},fh=function(){q.registry.register({displayText:()=>o.Msg$$module$build$src$core$msg.CLEAN_UP,preconditionFn:e=>e.workspace.isMovable()?e.workspace.getTopBlocks(!1).length>1?"enabled":"disabled":"hidden",callback(e){e.workspace.cleanUp()},scopeType:q.ScopeType.WORKSPACE,id:"cleanWorkspace",weight:3})},Th=function(e,t){function i(l){n--,l.setCollapsed(e),0===n&&o.setGroup$$module$build$src$core$events$utils(!1)}let s=0,n=0;o.setGroup$$module$build$src$core$events$utils(!0);for(let l=0;l<t.length;l++){let u=t[l];for(;u;)n++,setTimeout(i.bind(null,u),s),u=u.getNextBlock(),s+=10}},Eh=function(){q.registry.register({displayText:()=>o.Msg$$module$build$src$core$msg.COLLAPSE_ALL,preconditionFn(e){if(e.workspace.options.collapse){e=e.workspace.getTopBlocks(!1);for(let t=0;t<e.length;t++){let i=e[t];for(;i;){if(!i.isCollapsed())return"enabled";i=i.getNextBlock()}}return"disabled"}return"hidden"},callback(e){Th(!0,e.workspace.getTopBlocks(!0))},scopeType:q.ScopeType.WORKSPACE,id:"collapseWorkspace",weight:4})},vh=function(){q.registry.register({displayText:()=>o.Msg$$module$build$src$core$msg.EXPAND_ALL,preconditionFn(e){if(e.workspace.options.collapse){e=e.workspace.getTopBlocks(!1);for(let t=0;t<e.length;t++){let i=e[t];for(;i;){if(i.isCollapsed())return"enabled";i=i.getNextBlock()}}return"disabled"}return"hidden"},callback(e){Th(!1,e.workspace.getTopBlocks(!0))},scopeType:q.ScopeType.WORKSPACE,id:"expandWorkspace",weight:5})},yh=function(e,t){if(e.isDeletable())Array.prototype.push.apply(t,e.getDescendants(!1));else{e=e.getChildren(!1);for(let i=0;i<e.length;i++)yh(e[i],t)}},wa=function(e){const t=[];e=e.getTopBlocks(!0);for(let i=0;i<e.length;i++)yh(e[i],t);return t},yl=function(e,t){t?o.setGroup$$module$build$src$core$events$utils(t):(o.setGroup$$module$build$src$core$events$utils(!0),t=o.getGroup$$module$build$src$core$events$utils());const i=e.shift();i&&(i.isDeadOrDying()?yl(e,t):(i.dispose(!1,!0),setTimeout(yl,10,e,t))),o.setGroup$$module$build$src$core$events$utils(!1)},Ch=function(){q.registry.register({displayText:e=>e.workspace?1===(e=wa(e.workspace).length)?o.Msg$$module$build$src$core$msg.DELETE_BLOCK:o.Msg$$module$build$src$core$msg.DELETE_X_BLOCKS.replace("%1",`${e}`):"",preconditionFn:e=>e.workspace&&wa(e.workspace).length>0?"enabled":"disabled",callback(e){if(e.workspace){e.workspace.cancelCurrentGesture();var t=wa(e.workspace);t.length<2?yl(t):Ar(o.Msg$$module$build$src$core$msg.DELETE_ALL_BLOCKS.replace("%1",String(t.length)),function(i){i&&yl(t)})}},scopeType:q.ScopeType.WORKSPACE,id:"workspaceDelete",weight:6})},e$=function(){_h(),bh(),fh(),Eh(),vh(),Ch()},Ih=function(){q.registry.register({displayText:()=>o.Msg$$module$build$src$core$msg.DUPLICATE_BLOCK,preconditionFn:e=>!(e=e.block).isInFlyout&&e.isDeletable()&&e.isMovable()?e.isDuplicatable()?"enabled":"disabled":"hidden",callback(e){if(e.block){var t=e.block.toCopyData();t&&Oi(t,e.block.workspace)}},scopeType:q.ScopeType.BLOCK,id:"blockDuplicate",weight:1})},xh=function(){q.registry.register({displayText:e=>e.block.hasIcon(_o.TYPE)?o.Msg$$module$build$src$core$msg.REMOVE_COMMENT:o.Msg$$module$build$src$core$msg.ADD_COMMENT,preconditionFn:e=>!(e=e.block).isInFlyout&&e.workspace.options.comments&&!e.isCollapsed()&&e.isEditable()?"enabled":"hidden",callback(e){(e=e.block).hasIcon(_o.TYPE)?e.setCommentText(null):e.setCommentText("")},scopeType:q.ScopeType.BLOCK,id:"blockComment",weight:2})},kh=function(){q.registry.register({displayText:e=>e.block.getInputsInline()?o.Msg$$module$build$src$core$msg.EXTERNAL_INPUTS:o.Msg$$module$build$src$core$msg.INLINE_INPUTS,preconditionFn(e){if(!(e=e.block).isInFlyout&&e.isMovable()&&!e.isCollapsed())for(let t=1;t<e.inputList.length;t++)if(!(e.inputList[t-1]instanceof dc||e.inputList[t]instanceof dc))return"enabled";return"hidden"},callback(e){e.block.setInputsInline(!e.block.getInputsInline())},scopeType:q.ScopeType.BLOCK,id:"blockInline",weight:3})},wh=function(){q.registry.register({displayText:e=>e.block.isCollapsed()?o.Msg$$module$build$src$core$msg.EXPAND_BLOCK:o.Msg$$module$build$src$core$msg.COLLAPSE_BLOCK,preconditionFn:e=>!(e=e.block).isInFlyout&&e.isMovable()&&e.workspace.options.collapse?"enabled":"hidden",callback(e){e.block.setCollapsed(!e.block.isCollapsed())},scopeType:q.ScopeType.BLOCK,id:"blockCollapseExpand",weight:4})},Sh=function(){q.registry.register({displayText:e=>e.block.hasDisabledReason(Mt)?o.Msg$$module$build$src$core$msg.ENABLE_BLOCK:o.Msg$$module$build$src$core$msg.DISABLE_BLOCK,preconditionFn(e){if(!(e=e.block).isInFlyout&&e.workspace.options.disable&&e.isEditable()){var t=e.getDisabledReasons();return t=t.size>(t.has(Mt)?1:0),e.getInheritedDisabled()||t?"disabled":"enabled"}return"hidden"},callback(e){e=e.block;const t=o.getGroup$$module$build$src$core$events$utils();t||o.setGroup$$module$build$src$core$events$utils(!0),e.setDisabledReason(!e.hasDisabledReason(Mt),Mt),o.setGroup$$module$build$src$core$events$utils(t)},scopeType:q.ScopeType.BLOCK,id:"blockDisable",weight:5})},Ah=function(){q.registry.register({displayText(e){var t=e.block;return e=t.getDescendants(!1).length,(t=t.getNextBlock())&&(e-=t.getDescendants(!1).length),1===e?o.Msg$$module$build$src$core$msg.DELETE_BLOCK:o.Msg$$module$build$src$core$msg.DELETE_X_BLOCKS.replace("%1",`${e}`)},preconditionFn:e=>!e.block.isInFlyout&&e.block.isDeletable()?"enabled":"hidden",callback(e){e.block&&e.block.checkAndDelete()},scopeType:q.ScopeType.BLOCK,id:"blockDelete",weight:6})},Rh=function(){q.registry.register({displayText:()=>o.Msg$$module$build$src$core$msg.HELP,preconditionFn:e=>("function"==typeof(e=e.block).helpUrl?e.helpUrl():e.helpUrl)?"enabled":"hidden",callback(e){e.block.showHelp()},scopeType:q.ScopeType.BLOCK,id:"blockHelp",weight:7})},Oh=function(){q.registry.register({displayText:()=>o.Msg$$module$build$src$core$msg.REMOVE_COMMENT,preconditionFn(e){let t;return null!=(t=e.comment)&&t.isDeletable()?"enabled":"hidden"},callback(e){let t;o.setGroup$$module$build$src$core$events$utils(!0),null==(t=e.comment)||t.dispose(),o.setGroup$$module$build$src$core$events$utils(!1)},scopeType:q.ScopeType.COMMENT,id:"commentDelete",weight:6})},Mh=function(){q.registry.register({displayText:()=>o.Msg$$module$build$src$core$msg.DUPLICATE_COMMENT,preconditionFn(e){let t;return null!=(t=e.comment)&&t.isMovable()?"enabled":"hidden"},callback(e){if(e.comment){var t=e.comment.toCopyData();t&&Oi(t,e.comment.workspace)}},scopeType:q.ScopeType.COMMENT,id:"commentDuplicate",weight:1})},Nh=function(){q.registry.register({displayText:()=>o.Msg$$module$build$src$core$msg.ADD_COMMENT,preconditionFn:e=>{let t;return null!=(t=e.workspace)&&t.isMutator?"hidden":"enabled"},callback:(e,t,i,s)=>{(e=e.workspace)&&(o.setGroup$$module$build$src$core$events$utils(!0),(t=new Kt(e)).setPlaceholderText(o.Msg$$module$build$src$core$msg.WORKSPACE_COMMENT_DEFAULT_TEXT),t.moveTo(t$(new k(s.x,s.y),e)),o.getFocusManager$$module$build$src$core$focus_manager().focusNode(t),o.setGroup$$module$build$src$core$events$utils(!1))},scopeType:q.ScopeType.WORKSPACE,id:"commentCreate",weight:8})},t$=function(e,t){var i=t.getInjectionDiv().getBoundingClientRect();return e=new k(e.x-i.left,e.y-i.top),i=t.getOriginOffsetInPixels(),(e=k.difference(e,i)).scale(1/t.scale),e},o$=function(){Ih(),xh(),kh(),wh(),Sh(),Ah(),Rh()},i$=function(){Mh(),Oh(),Nh()},Lh=function(){e$(),o$()},Dh=function(e){return e&&"function"==typeof e.paste},Ph=function(e){return e&&"function"==typeof e.getSvgRoot},Bh=function(e){return e.isSelectable()},s$=function(e){st().hideChaff(e)},(y=y||{}).scope={},y.ASSUME_ES5=!1,y.ASSUME_ES6=!1,y.ASSUME_ES2020=!1,y.ASSUME_NO_NATIVE_MAP=!1,y.ASSUME_NO_NATIVE_SET=!1,y.ISOLATE_POLYFILLS=!1,y.FORCE_POLYFILL_PROMISE=!1,y.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1,y.INSTRUMENT_ASYNC_CONTEXT=!0,y.objectCreate=y.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(e){var t=function(){};return t.prototype=e,new t},y.defineProperty=y.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,i){return e==Array.prototype||e==Object.prototype||(e[t]=i.value),e},y.getGlobal=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var t=0;t<e.length;++t){var i=e[t];if(i&&i.Math==Math)return i}throw Error("Cannot find global object")},y.global=y.ASSUME_ES2020?globalThis:y.getGlobal(this),y.IS_SYMBOL_NATIVE="function"==typeof Symbol&&"symbol"==typeof Symbol("x"),y.TRUST_ES6_POLYFILLS=!y.ISOLATE_POLYFILLS||y.IS_SYMBOL_NATIVE,y.polyfills={},y.propertyToPolyfillSymbol={},y.POLYFILL_PREFIX="$jscp$",y.polyfill=function(e,t,i,s){t&&(y.ISOLATE_POLYFILLS?y.polyfillIsolated(e,t,i,s):y.polyfillUnisolated(e,t,i,s))},y.polyfillUnisolated=function(e,t,i,s){for(i=y.global,e=e.split("."),s=0;s<e.length-1;s++){var n=e[s];if(!(n in i))return;i=i[n]}(t=t(s=i[e=e[e.length-1]]))!=s&&null!=t&&y.defineProperty(i,e,{configurable:!0,writable:!0,value:t})},y.polyfillIsolated=function(e,t,i,s){var n=e.split(".");s=n[0],s=!(e=1===n.length)&&s in y.polyfills?y.polyfills:y.global;for(var l=0;l<n.length-1;l++){var u=n[l];if(!(u in s))return;s=s[u]}n=n[n.length-1],null!=(t=t(i=y.IS_SYMBOL_NATIVE&&"es6"===i?s[n]:null))&&(e?y.defineProperty(y.polyfills,n,{configurable:!0,writable:!0,value:t}):t!==i&&(void 0===y.propertyToPolyfillSymbol[n]&&(i=1e9*Math.random()>>>0,y.propertyToPolyfillSymbol[n]=y.IS_SYMBOL_NATIVE?y.global.Symbol(n):y.POLYFILL_PREFIX+i+"$"+n),y.defineProperty(s,y.propertyToPolyfillSymbol[n],{configurable:!0,writable:!0,value:t})))},y.getConstructImplementation=function(){if(y.TRUST_ES6_POLYFILLS&&typeof Reflect<"u"&&Reflect.construct){if(function e(){function i(){}return new i,Reflect.construct(i,[],function(){}),new i instanceof i}())return Reflect.construct;var t=Reflect.construct;return function(i,s,n){return i=t(i,s),n&&Reflect.setPrototypeOf(i,n.prototype),i}}return function(i,s,n){return void 0===n&&(n=i),n=y.objectCreate(n.prototype||Object.prototype),Function.prototype.apply.call(i,n,s)||n}},y.construct=y.getConstructImplementation(),y.underscoreProtoCanBeSet=function(){var t={};try{return t.__proto__={a:!0},t.a}catch{}return!1},y.setPrototypeOf=y.ASSUME_ES6||y.TRUST_ES6_POLYFILLS&&"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:y.underscoreProtoCanBeSet()?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null,y.inherits=function(e,t){if(e.prototype=y.objectCreate(t.prototype),e.prototype.constructor=e,y.ASSUME_ES6||y.setPrototypeOf){var i=y.setPrototypeOf;i(e,t)}else for(i in t)if("prototype"!=i)if(Object.defineProperties){var s=Object.getOwnPropertyDescriptor(t,i);s&&Object.defineProperty(e,i,s)}else e[i]=t[i];e.superClass_=t.prototype},y.arrayIteratorImpl=function(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}},y.arrayIterator=function(e){return{next:y.arrayIteratorImpl(e)}},y.makeIterator=function(e){var t=typeof Symbol<"u"&&Symbol.iterator&&e[Symbol.iterator];if(t)return t.call(e);if("number"==typeof e.length)return y.arrayIterator(e);throw Error(String(e)+" is not an iterable or ArrayLike")},y.arrayFromIterator=function(e){for(var t,i=[];!(t=e.next()).done;)i.push(t.value);return i},y.arrayFromIterable=function(e){return e instanceof Array?e:y.arrayFromIterator(y.makeIterator(e))},y.generator={},y.generator.ensureIteratorResultIsObject_=function(e){if(!(e instanceof Object))throw new TypeError("Iterator result "+e+" is not an object")},y.generator.Context=function(){this.isRunning_=!1,this.yieldAllIterator_=null,this.yieldResult=void 0,this.nextAddress=1,this.finallyAddress_=this.catchAddress_=0,this.finallyContexts_=this.abruptCompletion_=null},y.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0},y.generator.Context.prototype.stop_=function(){this.isRunning_=!1},y.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_},y.generator.Context.prototype.next_=function(e){this.yieldResult=e},y.generator.Context.prototype.throw_=function(e){this.abruptCompletion_={exception:e,isException:!0},this.jumpToErrorHandler_()},y.generator.Context.prototype.return=function(e){this.abruptCompletion_={return:e},this.nextAddress=this.finallyAddress_},y.generator.Context.prototype.jumpThroughFinallyBlocks=function(e){this.abruptCompletion_={jumpTo:e},this.nextAddress=this.finallyAddress_},y.generator.Context.prototype.yield=function(e,t){return this.nextAddress=t,{value:e}},y.generator.Context.prototype.yieldAll=function(e,t){var i=(e=y.makeIterator(e)).next();if(y.generator.ensureIteratorResultIsObject_(i),!i.done)return this.yieldAllIterator_=e,this.yield(i.value,t);this.yieldResult=i.value,this.nextAddress=t},y.generator.Context.prototype.jumpTo=function(e){this.nextAddress=e},y.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0},y.generator.Context.prototype.setCatchFinallyBlocks=function(e,t){this.catchAddress_=e,null!=t&&(this.finallyAddress_=t)},y.generator.Context.prototype.setFinallyBlock=function(e){this.catchAddress_=0,this.finallyAddress_=e||0},y.generator.Context.prototype.leaveTryBlock=function(e,t){this.nextAddress=e,this.catchAddress_=t||0},y.generator.Context.prototype.enterCatchBlock=function(e){return this.catchAddress_=e||0,e=this.abruptCompletion_.exception,this.abruptCompletion_=null,e},y.generator.Context.prototype.enterFinallyBlock=function(e,t,i){i?this.finallyContexts_[i]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_],this.catchAddress_=e||0,this.finallyAddress_=t||0},y.generator.Context.prototype.leaveFinallyBlock=function(e,t){if(t=this.finallyContexts_.splice(t||0)[0],t=this.abruptCompletion_=this.abruptCompletion_||t){if(t.isException)return this.jumpToErrorHandler_();null!=t.jumpTo&&this.finallyAddress_<t.jumpTo?(this.nextAddress=t.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=e},y.generator.Context.prototype.forIn=function(e){return new y.generator.Context.PropertyIterator(e)},y.generator.Context.PropertyIterator=function(e){for(var t in this.object_=e,this.properties_=[],e)this.properties_.push(t);this.properties_.reverse()},y.generator.Context.PropertyIterator.prototype.getNext=function(){for(;this.properties_.length>0;){var e=this.properties_.pop();if(e in this.object_)return e}return null},y.generator.Engine_=function(e){this.context_=new y.generator.Context,this.program_=e},y.generator.Engine_.prototype.next_=function(e){return this.context_.start_(),this.context_.yieldAllIterator_?this.yieldAllStep_(this.context_.yieldAllIterator_.next,e,this.context_.next_):(this.context_.next_(e),this.nextStep_())},y.generator.Engine_.prototype.return_=function(e){this.context_.start_();var t=this.context_.yieldAllIterator_;return t?this.yieldAllStep_("return"in t?t.return:function(i){return{value:i,done:!0}},e,this.context_.return):(this.context_.return(e),this.nextStep_())},y.generator.Engine_.prototype.throw_=function(e){return this.context_.start_(),this.context_.yieldAllIterator_?this.yieldAllStep_(this.context_.yieldAllIterator_.throw,e,this.context_.next_):(this.context_.throw_(e),this.nextStep_())},y.generator.Engine_.prototype.yieldAllStep_=function(e,t,i){try{var s=e.call(this.context_.yieldAllIterator_,t);if(y.generator.ensureIteratorResultIsObject_(s),!s.done)return this.context_.stop_(),s;var n=s.value}catch(l){return this.context_.yieldAllIterator_=null,this.context_.throw_(l),this.nextStep_()}return this.context_.yieldAllIterator_=null,i.call(this.context_,n),this.nextStep_()},y.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var e=this.program_(this.context_);if(e)return this.context_.stop_(),{value:e.value,done:!1}}catch(t){this.context_.yieldResult=void 0,this.context_.throw_(t)}if(this.context_.stop_(),this.context_.abruptCompletion_){if(e=this.context_.abruptCompletion_,this.context_.abruptCompletion_=null,e.isException)throw e.exception;return{value:e.return,done:!0}}return{value:void 0,done:!0}},y.generator.Generator_=function(e){this.next=function(t){return e.next_(t)},this.throw=function(t){return e.throw_(t)},this.return=function(t){return e.return_(t)},this[Symbol.iterator]=function(){return this}},y.generator.createGenerator=function(e,t){return t=new y.generator.Generator_(new y.generator.Engine_(t)),y.setPrototypeOf&&e.prototype&&y.setPrototypeOf(t,e.prototype),t},y.asyncExecutePromiseGenerator=function(e){function t(s){return e.next(s)}function i(s){return e.throw(s)}return new Promise(function(s,n){!function l(u){u.done?s(u.value):Promise.resolve(u.value).then(t,i).then(l,n)}(e.next())})},y.asyncExecutePromiseGeneratorFunction=function(e){return y.asyncExecutePromiseGenerator(e())},y.asyncExecutePromiseGeneratorProgram=function(e){return y.asyncExecutePromiseGenerator(new y.generator.Generator_(new y.generator.Engine_(e)))},y.polyfill("globalThis",function(e){return e||y.global},"es_2020","es3"),y.polyfill("Array.prototype.includes",function(e){return e||function(t,i){var s=this;s instanceof String&&(s=String(s));var n=s.length;for((i=i||0)<0&&(i=Math.max(i+n,0));i<n;i++){var l=s[i];if(l===t||Object.is(l,t))return!0}return!1}},"es7","es3"),y.checkEs6ConformanceViaProxy=function(){try{var e={},t=Object.create(new y.global.Proxy(e,{get:function(i,s,n){return i==e&&"q"==s&&n==t}}));return!0===t.q}catch{return!1}},y.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1,y.ES6_CONFORMANCE=y.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&y.checkEs6ConformanceViaProxy(),y.initSymbol=function(){},y.iteratorPrototype=function(e){return(e={next:e})[Symbol.iterator]=function(){return this},e},y.owns=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},y.MapEntry=function(){},y.polyfill("Set.prototype.difference",function(e){return e||function(t){y.checkIsSetInstance(this),y.checkIsSetLike(t);var i=y.getSmallerAndLargerSets(this,t);t=new Set(this);var s=i.smallerSetIterator;i=i.largerSet;for(var n=s.next();!n.done;)i.has(n.value)&&t.delete(n.value),n=s.next();return t}},"es_next","es6"),y.checkIsSetLike=function(e){if("object"!=typeof e||null===e||"number"!=typeof e.size||e.size<0||"function"!=typeof e.keys||"function"!=typeof e.has)throw new TypeError("Argument must be set-like")},y.checkIsValidIterator=function(e){if("object"!=typeof e||null===e||"function"!=typeof e.next)throw new TypeError("Invalid iterator.");return e},y.getSmallerAndLargerSets=function(e,t){return e.size<=t.size?{smallerSetIterator:e.keys(),largerSet:t}:{smallerSetIterator:y.checkIsValidIterator(t.keys()),largerSet:e}},y.checkIsSetInstance=function(e){if(!(e instanceof Set))throw new TypeError("Method must be called on an instance of Set.")},y.iteratorFromArray=function(e,t){if(y.ASSUME_ES6)return e[Symbol.iterator]();e instanceof String&&(e+="");var i=0,s=!1,n={next:function(){if(!s&&i<e.length){var l=i++;return{value:t(l,e[l]),done:!1}}return s=!0,{done:!0,value:void 0}}};return n[Symbol.iterator]=function(){return n},n},y.polyfill("Array.prototype.values",function(e){return e||function(){return y.iteratorFromArray(this,function(t,i){return i})}},"es8","es3"),y.polyfill("Array.prototype.flatMap",function(e){return e||function(t,i){var s=[];return Array.prototype.forEach.call(this,function(n,l){n=t.call(i,n,l,this),Array.isArray(n)?s.push.apply(s,n):s.push(n)}),s}},"es9","es5"),y.polyfill("Array.prototype.flat",function(e){return e||function(t){t=void 0===t?1:t;var i=[];return Array.prototype.forEach.call(this,function(s){Array.isArray(s)&&t>0?(s=Array.prototype.flat.call(s,t-1),i.push.apply(i,s)):i.push(s)}),i}},"es9","es5"),y.polyfill("Object.entries",function(e){return e||function(t){var s,i=[];for(s in t)y.owns(t,s)&&i.push([s,t[s]]);return i}},"es8","es3"),y.polyfill("Object.values",function(e){return e||function(t){var s,i=[];for(s in t)y.owns(t,s)&&i.push(t[s]);return i}},"es8","es3");var Mi=Object.create(null),T_={typeMap:Mi},Sa=Object.create(null),gt="default",x=class{constructor(e){this.name=e}toString(){return this.name}};x.CONNECTION_CHECKER=new x("connectionChecker"),x.CONNECTION_PREVIEWER=new x("connectionPreviewer"),x.CURSOR=new x("cursor"),x.EVENT=new x("event"),x.FIELD=new x("field"),x.INPUT=new x("input"),x.RENDERER=new x("renderer"),x.TOOLBOX=new x("toolbox"),x.THEME=new x("theme"),x.TOOLBOX_ITEM=new x("toolboxItem"),x.FLYOUTS_VERTICAL_TOOLBOX=new x("flyoutsVerticalToolbox"),x.FLYOUTS_HORIZONTAL_TOOLBOX=new x("flyoutsHorizontalToolbox"),x.FLYOUT_INFLATER=new x("flyoutInflater"),x.METRICS_MANAGER=new x("metricsManager"),x.BLOCK_DRAGGER=new x("blockDragger"),x.SERIALIZER=new x("serializer"),x.ICON=new x("icon"),x.PASTER=new x("paster"),x.VARIABLE_MODEL=new x("variableModel"),x.VARIABLE_MAP=new x("variableMap");var Uo={DEFAULT:gt,TEST_ONLY:T_};Uo.Type=x,Uo.getAllItems=ro,Uo.getClass=ot,Uo.getClassFromOptions=Re,Uo.getObject=kt,Uo.hasItem=Jo,Uo.register=U,Uo.unregister=tt;var Fh,l$,c$,a$,Oa,Ma,Uh,u$,d$,h$,ue=Object.create(null),E_=750,r$="ontouchstart"in globalThis||!!(globalThis.document&&document.documentElement&&"ontouchstart"in document.documentElement)||!(!globalThis.navigator||!globalThis.navigator.maxTouchPoints&&!globalThis.navigator.msMaxTouchPoints),Aa=null,Ns={mousedown:["pointerdown"],mouseenter:["pointerenter"],mouseleave:["pointerleave"],mousemove:["pointermove"],mouseout:["pointerout"],mouseover:["pointerover"],mouseup:["pointerup","pointercancel"],touchend:["pointerup"],touchcancel:["pointercancel"]},Ra=0,Ls={TOUCH_ENABLED:r$,TOUCH_MAP:Ns};Ls.checkTouchIdentifier=Qo,Ls.clearTouchIdentifier=Oe,Ls.getTouchIdentifierFromEvent=co,Ls.longStart=lo,Ls.longStop=at,Ls.shouldHandleEvent=we,function(e){function t(s){return i.includes(s.toUpperCase())}const i=(Fh=e).toUpperCase();l$=t("JavaFX"),c$=t("WebKit"),a$=t("Gecko")&&!c$,Oa=t("Android"),e=globalThis.navigator&&globalThis.navigator.maxTouchPoints,Ma=t("iPad")||t("Macintosh")&&e>0,Uh=t("iPhone")&&!Ma,u$=t("Macintosh"),d$=Ma||Oa&&!t("Mobile")||t("Silk"),h$=!d$&&(Uh||Oa)}(globalThis.navigator&&globalThis.navigator.userAgent||"");var p$=l$,g$=a$,Hh=Oa,Na=Ma,$$=Uh,Zh=u$,m$=h$,y_={ANDROID:Hh,GECKO:g$,IPAD:Na,IPHONE:$$,JavaFx:p$,MAC:Zh,MOBILE:m$,raw:Fh},_$=40,b$=125,Ho={};Ho.bind=Ye,Ho.conditionalBind=N,Ho.getScrollDeltaPixels=yo,Ho.isRightButton=it,Ho.isTargetInput=vo,Ho.mouseToSvg=wt,Ho.unbind=J;var f=function(e){return e.BLOCK_CREATE="create",e.BLOCK_DELETE="delete",e.BLOCK_CHANGE="change",e.BLOCK_FIELD_INTERMEDIATE_CHANGE="block_field_intermediate_change",e.BLOCK_MOVE="move",e.VAR_CREATE="var_create",e.VAR_DELETE="var_delete",e.VAR_RENAME="var_rename",e.VAR_TYPE_CHANGE="var_type_change",e.UI="ui",e.BLOCK_DRAG="drag",e.SELECTED="selected",e.CLICK="click",e.MARKER_MOVE="marker_move",e.BUBBLE_OPEN="bubble_open",e.TRASHCAN_OPEN="trashcan_open",e.TOOLBOX_ITEM_SELECT="toolbox_item_select",e.THEME_CHANGE="theme_change",e.VIEWPORT_CHANGE="viewport_change",e.COMMENT_CREATE="comment_create",e.COMMENT_DELETE="comment_delete",e.COMMENT_CHANGE="comment_change",e.COMMENT_MOVE="comment_move",e.COMMENT_RESIZE="comment_resize",e.COMMENT_DRAG="comment_drag",e.COMMENT_COLLAPSE="comment_collapse",e.FINISHED_LOADING="finished_loading",e}(f||{}),Vh=[f.BLOCK_CREATE,f.BLOCK_MOVE,f.COMMENT_CREATE,f.COMMENT_MOVE];({BUMP_EVENTS:Vh}).EventType=f;var f$="!#$%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",Gh={genUid:()=>{const t=[];for(let i=0;i<20;i++)t[i]=f$.charAt(88*Math.random());return t.join("")}},I_=0,Wh={TEST_ONLY:Gh};Wh.genUid=ve,Wh.getNextUniqueId=Ee;var $e={};$e.isBlockChange=Pt,$e.isBlockCreate=ao,$e.isBlockDelete=ei,$e.isBlockDrag=on,$e.isBlockFieldIntermediateChange=Ki,$e.isBlockMove=Bt,$e.isBubbleOpen=oi,$e.isClick=Qi,$e.isCommentChange=cn,$e.isCommentCollapse=dn,$e.isCommentCreate=ii,$e.isCommentDelete=ln,$e.isCommentDrag=un,$e.isCommentMove=an,$e.isCommentResize=es,$e.isFinishedLoading=si,$e.isSelected=ti,$e.isThemeChange=rn,$e.isToolboxItemSelect=nn,$e.isTrashcanOpen=sn,$e.isVarCreate=Ji,$e.isVarDelete=en,$e.isVarRename=tn,$e.isViewportChange=Co;var T$="",Cl=!0,qh=0,zh="ORPHANED_BLOCK",Zo=[],jh={FIRE_QUEUE:Zo,enqueueEvent:ts,fireNow:ni,fireInternal:hn,setGroupInternal:Ge},$t={TEST_ONLY:jh};$t.clearPendingUndo=li,$t.disable=o.disable$$module$build$src$core$events$utils,$t.disableOrphans=is,$t.enable=o.enable$$module$build$src$core$events$utils,$t.filter=ri,$t.fire=D,$t.fromJson=os,$t.get=P,$t.getDescendantIds=Io,$t.getGroup=o.getGroup$$module$build$src$core$events$utils,$t.getRecordUndo=Se,$t.isEnabled=ne,$t.setGroup=o.setGroup$$module$build$src$core$events$utils,$t.setRecordUndo=o.setRecordUndo$$module$build$src$core$events$utils;var Vo,e,Il="http://www.w3.org/2000/svg",go="http://www.w3.org/1999/xhtml",vt="http://www.w3.org/1999/xlink";(e=Vo||(Vo={}))[e.ELEMENT_NODE=1]="ELEMENT_NODE",e[e.TEXT_NODE=3]="TEXT_NODE",e[e.COMMENT_NODE=8]="COMMENT_NODE";var jt=null,Yh=0,xl=null,He={HTML_NS:go};He.NodeType=Vo,He.SVG_NS=Il,He.XLINK_NS=vt,He.addClass=R,He.createSvgElement=I,He.getFastTextWidth=he,He.getFastTextWidthWithSizeString=ut,He.getTextWidth=A,He.hasClass=ai,He.insertAfter=c,He.measureFontMetrics=pn,He.removeClass=X,He.removeClasses=ci,He.removeNode=Q,He.setCssTransform=g,He.startTextWidthCache=b,He.stopTextWidthCache=E;var Le=class{static findFocusedNode(e){var t=e.getRootFocusableNode();if(!t.canBeFocused())return null;var i=t.getFocusableElement();return ai(i,Le.ACTIVE_CLASS_NAME)||ai(i,Le.PASSIVE_CSS_CLASS_NAME)||((t=i.querySelector(this.ACTIVE_FOCUS_NODE_CSS_SELECTOR))instanceof HTMLElement||t instanceof SVGElement)&&(t=Le.findFocusableNodeFor(t,e))?t:((i=i.querySelector(this.PASSIVE_FOCUS_NODE_CSS_SELECTOR))instanceof HTMLElement||i instanceof SVGElement)&&(e=Le.findFocusableNodeFor(i,e))?e:null}static findFocusableNodeFor(e,t){if(!e.id||"null"===e.id||-1!==t.getNestedTrees().map(n=>Le.findFocusableNodeFor(e,n)).findIndex(n=>!!n))return null;var s,i=t.getRootFocusableNode();return i.canBeFocused()&&e===i.getFocusableElement()||(i=null!=(s=t.lookUpFocusableNode(e.id))?s:null)?i:(s=e.parentElement,!i&&s?Le.findFocusableNodeFor(s,t):null)}};Le.ACTIVE_CLASS_NAME="blocklyActiveFocus",Le.PASSIVE_CSS_CLASS_NAME="blocklyPassiveFocus",Le.ACTIVE_FOCUS_NODE_CSS_SELECTOR=`.${Le.ACTIVE_CLASS_NAME}`,Le.PASSIVE_FOCUS_NODE_CSS_SELECTOR=`.${Le.PASSIVE_CSS_CLASS_NAME}`;var Ze=class{constructor(e){this.previouslyFocusedNode=this.focusedNode=null,this.registeredTrees=[],this.isUpdatingFocusedNode=this.recentlyLostAllFocus=this.lockFocusStateChanges=this.currentlyHoldsEphemeralFocus=!1;const t=i=>{if(!this.isUpdatingFocusedNode){this.recentlyLostAllFocus=!i;var s=null;if(i instanceof HTMLElement||i instanceof SVGElement)for(var n of this.registeredTrees)if(s=Le.findFocusableNodeFor(i,n.tree))break;if(s&&s.canBeFocused()){let l;i=s.getFocusableTree(),n=null==(l=this.focusedNode)?void 0:l.getFocusableTree(),s===i.getRootFocusableNode()&&i!==n?this.focusTree(i):this.focusNode(s)}else this.defocusCurrentFocusedNode()}};e("focusin",i=>{i instanceof FocusEvent&&t(document.activeElement)}),e("focusout",i=>{i instanceof FocusEvent&&t(i.relatedTarget)})}registerTree(e,t=!1){if(this.ensureManagerIsUnlocked(),this.isRegistered(e))throw Error(`Attempted to re-register already registered tree: ${e}.`);this.registeredTrees.push(new class{constructor(e,t){this.tree=e,this.rootShouldBeAutoTabbable=t}}(e,t));const i=e.getRootFocusableNode().getFocusableElement();if(!i.id||"null"===i.id)throw Error(`Attempting to register a tree with a root element that has an invalid ID: ${e}.`);t&&(i.tabIndex=0)}isRegistered(e){return!!this.lookUpRegistration(e)}lookUpRegistration(e){let t;return null!=(t=this.registeredTrees.find(i=>i.tree===e))?t:null}unregisterTree(e){if(this.ensureManagerIsUnlocked(),!this.isRegistered(e))throw Error(`Attempted to unregister not registered tree: ${e}.`);var t=this.registeredTrees.findIndex(n=>n.tree===e);const i=this.registeredTrees[t];this.registeredTrees.splice(t,1),t=Le.findFocusedNode(e);const s=e.getRootFocusableNode();t&&this.removeHighlight(t),this.focusedNode!==t&&this.focusedNode!==s||this.updateFocusedNode(null),this.removeHighlight(s),i.rootShouldBeAutoTabbable&&e.getRootFocusableNode().getFocusableElement().removeAttribute("tabindex")}getFocusedTree(){let e,t;return null!=(t=null==(e=this.focusedNode)?void 0:e.getFocusableTree())?t:null}getFocusedNode(){return this.focusedNode}focusTree(e){if(this.ensureManagerIsUnlocked(),!this.isRegistered(e))throw Error(`Attempted to focus unregistered tree: ${e}.`);const t=Le.findFocusedNode(e),i=e.getRestoredFocusableNode(t);let s;e=e.getRootFocusableNode(),this.focusNode(null!=(s=i??t)?s:e)}focusNode(e){this.ensureManagerIsUnlocked();const t=!this.currentlyHoldsEphemeralFocus;t&&(this.isUpdatingFocusedNode=!0);var i,s=(null==(i=this.focusedNode)?void 0:i.getFocusableElement())!==document.activeElement;if(this.focusedNode!==e||s)if(e.canBeFocused()){if(i=e.getFocusableTree(),!this.isRegistered(i))throw Error(`Attempted to focus unregistered node: ${e}.`);(s=e.getFocusableElement()).id&&"null"!==s.id||console.warn("Trying to focus a node that has an invalid ID.");var n=Le.findFocusableNodeFor(s,i);s=Le.findFocusedNode(i);var u,l=e;n!==e&&(l=i.getRestoredFocusableNode(s),e=i.getRootFocusableNode(),l=null!=(u=l??s)?u:e),e=this.focusedNode,u=e?.getFocusableTree(),e&&this.passivelyFocusNode(e,i),i=i.getRootFocusableNode(),s&&this.removeHighlight(s),i!==l&&this.removeHighlight(i),this.currentlyHoldsEphemeralFocus||this.activelyFocusNode(l,u??null),this.updateFocusedNode(l)}else console.warn("Trying to focus a node that can't be focused.");t&&(this.isUpdatingFocusedNode=!1)}takeEphemeralFocus(e){if(this.ensureManagerIsUnlocked(),this.currentlyHoldsEphemeralFocus)throw Error(`Attempted to take ephemeral focus when it's already held, with new element: ${e}.`);this.currentlyHoldsEphemeralFocus=!0,this.focusedNode&&this.passivelyFocusNode(this.focusedNode,null),e.focus();let t=!1;return()=>{if(t)throw Error(`Attempted to finish ephemeral focus twice for element: ${e}.`);if(t=!0,this.currentlyHoldsEphemeralFocus=!1,this.focusedNode){this.activelyFocusNode(this.focusedNode,null);const i=this.focusedNode;setTimeout(()=>{!this.focusedNode&&this.previouslyFocusedNode===i&&this.recentlyLostAllFocus&&this.focusNode(i)},0)}}}ephemeralFocusTaken(){return this.currentlyHoldsEphemeralFocus}ensureManagerIsUnlocked(){if(this.lockFocusStateChanges)throw Error("FocusManager state changes cannot happen in a tree/node focus/blur callback.")}updateFocusedNode(e){this.previouslyFocusedNode=this.focusedNode,this.focusedNode=e}defocusCurrentFocusedNode(){this.focusedNode&&!this.currentlyHoldsEphemeralFocus&&(this.passivelyFocusNode(this.focusedNode,null),this.updateFocusedNode(null))}activelyFocusNode(e,t){this.lockFocusStateChanges=!0;const i=e.getFocusableTree(),s=e.getFocusableElement();let n;const l=null==(n=this.lookUpRegistration(i))?void 0:n.rootShouldBeAutoTabbable;i!==t&&(i.onTreeFocus(e,t),l&&(i.getRootFocusableNode().getFocusableElement().tabIndex=-1)),e.onNodeFocus(),this.lockFocusStateChanges=!1,l&&e===i.getRootFocusableNode()||s.hasAttribute("tabindex")||(s.tabIndex=-1),this.setNodeToVisualActiveFocus(e),s.focus()}passivelyFocusNode(e,t){this.lockFocusStateChanges=!0;const i=e.getFocusableTree();if(i!==t){let s;i.onTreeBlur(t),null!=(s=this.lookUpRegistration(i))&&s.rootShouldBeAutoTabbable&&(i.getRootFocusableNode().getFocusableElement().tabIndex=0)}e.onNodeBlur(),this.lockFocusStateChanges=!1,i!==t&&this.setNodeToVisualPassiveFocus(e)}setNodeToVisualActiveFocus(e){e=e.getFocusableElement(),R(e,Ze.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME),X(e,Ze.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME)}setNodeToVisualPassiveFocus(e){e=e.getFocusableElement(),X(e,Ze.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME),R(e,Ze.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME)}removeHighlight(e){e=e.getFocusableElement(),X(e,Ze.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME),X(e,Ze.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME)}static getFocusManager(){return Ze.focusManager||(Ze.focusManager=new Ze(document.addEventListener)),Ze.focusManager}};Ze.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME="blocklyActiveFocus",Ze.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME="blocklyPassiveFocus",Ze.focusManager=null;var E$={};E$.FocusManager=Ze,E$.getFocusManager=o.getFocusManager$$module$build$src$core$focus_manager;var v$={};v$.deepMerge=St;var re=class{constructor(){this.shortcuts=new Map,this.keyMap=new Map,this.reset()}reset(){this.shortcuts.clear(),this.keyMap.clear()}register(e,t){if(this.shortcuts.get(e.name)&&!t)throw Error(`Shortcut named "${e.name}" already exists.`);if(this.shortcuts.set(e.name,e),null!=(t=e.keyCodes)&&t.length)for(const i of t)this.addKeyMapping(i,e.name,!!e.allowCollision)}unregister(e){return this.shortcuts.get(e)?(this.removeAllKeyMappings(e),this.shortcuts.delete(e),!0):(console.warn(`Keyboard shortcut named "${e}" not found.`),!1)}addKeyMapping(e,t,i){const s=this.keyMap.get(e=`${e}`);if(s&&!i)throw Error(`Shortcut named "${t}" collides with shortcuts "${s}"`);s&&i?s.unshift(t):this.keyMap.set(e,[t])}removeKeyMapping(e,t,i){const s=this.keyMap.get(e);if(!s)return i||console.warn(`No keyboard shortcut named "${t}" registered with key code "${e}"`),!1;const n=s.indexOf(t);return n>-1?(s.splice(n,1),0===s.length&&this.keyMap.delete(e),!0):(i||console.warn(`No keyboard shortcut named "${t}" registered with key code "${e}"`),!1)}removeAllKeyMappings(e){for(const t of this.keyMap.keys())this.removeKeyMapping(t,e,!0)}setKeyMap(e){this.keyMap.clear();for(const t in e)this.keyMap.set(t,e[t])}getKeyMap(){const e=Object.create(null);for(const[t,i]of this.keyMap)e[t]=i;return e}getRegistry(){const e=Object.create(null);for(const[t,i]of this.shortcuts)e[t]=i;return St(Object.create(null),e)}onKeyDown(e,t){var i=this.serializeKeyEvent(t);if(!(i=this.getShortcutNamesByKeyCode(i)))return!1;for(const s of i){let n,l,u,$;if((i=this.shortcuts.get(s))&&(!i.preconditionFn||i.preconditionFn(e,{focusedNode:null!=(n=o.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode())?n:void 0}))&&null!=(u=(l=i).callback)&&u.call(l,e,t,i,{focusedNode:null!=($=o.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode())?$:void 0}))return!0}return!1}getShortcutNamesByKeyCode(e){let t;return(null==(t=this.keyMap.get(e))?void 0:t.slice())||[]}getKeyCodesByShortcutName(e){const t=[];for(const[i,s]of this.keyMap)s.indexOf(e)>-1&&t.push(i);return t}serializeKeyEvent(e){let t="";for(const i in re.modifierKeys)e.getModifierState(i)&&(""!==t&&(t+="+"),t+=i);return""!==t&&e.keyCode?t+="+"+e.keyCode:e.keyCode&&(t=String(e.keyCode)),t}checkModifiers(e){for(const t of e)if(!(t in re.modifierKeys))throw Error(t+" is not a valid modifier key.")}createSerializedKey(e,t){let i="";if(t){this.checkModifiers(t);for(const s in re.modifierKeys)t.includes(re.modifierKeys[s])&&(""!==i&&(i+="+"),i+=s)}return""!==i&&e?i+="+"+e:e&&(i=`${e}`),i}};re.registry=new re,function(e){(e=e.modifierKeys||(e.modifierKeys={}))[e.Shift=16]="Shift",e[e.Control=17]="Control",e[e.Alt=18]="Alt",e[e.Meta=91]="Meta"}(re||(re={}));var y$,C$,kl=Object.create(null),wl=[],I$={defineBlocksWithJsonArrayInternal:sd},De={TEST_ONLY:I$};De.createBlockDefinitionsFromJsonArray=o.createBlockDefinitionsFromJsonArray$$module$build$src$core$common,De.defineBlocks=o.defineBlocks$$module$build$src$core$common,De.defineBlocksWithJsonArray=fr,De.draggingConnections=wl,De.fireSelectedEvent=ho,De.getAllWorkspaces=ui,De.getBlockTypeCounts=ls,De.getMainWorkspace=st,De.getParentContainer=rs,De.getSelected=di,De.getWorkspaceById=uo,De.globalShortcutHandler=$n,De.registerWorkspace=_r,De.setMainWorkspace=ns,De.setParentContainer=gn,De.setSelected=gc,De.svgResize=dt,De.unregisterWorkpace=br;var Da,Ds=class{constructor(){this.workspaceId=void 0,this.isUiEvent=!1,this.type="",this.group=o.getGroup$$module$build$src$core$events$utils(),this.recordUndo=Se()}toJson(){return{type:this.type,group:this.group}}static fromJson(e,t,i){return i.isBlank=!1,i.group=e.group||"",i.workspaceId=t.id,i}isNull(){return!1}run(e){}getEventWorkspace_(){let e;if(this.workspaceId&&(e=uo(this.workspaceId)),!e)throw Error("Workspace is null. Event must have been generated from real Blockly events.");return e}},Yt=class extends Ds{constructor(e){super(),this.recordUndo=!1,this.isUiEvent=!0,this.isBlank=typeof e>"u",this.workspaceId=e||""}},La=class extends Yt{constructor(e,t,i){null===(t=e?e.workspace.id:t)&&(t=void 0),super(t),this.type=f.CLICK,this.blockId=e?e.id:void 0,this.targetType=i}toJson(){const e=super.toJson();if(!this.targetType)throw Error("The click target type is undefined. Either pass a block to the constructor, or call fromJson");return e.targetType=this.targetType,e.blockId=this.blockId,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new La)).targetType=e.targetType,t.blockId=e.blockId,t}};(function(e){e.BLOCK="block",e.WORKSPACE="workspace",e.ZOOM_CONTROLS="zoom_controls"})(Da||(Da={})),U(x.EVENT,f.CLICK,La);var x$={};x$.Click=La,x$.ClickTarget=Da;var k$={};k$.removeElem=ht;var Go=class{constructor(e){this.name=e}toString(){return this.name}};Go.POSITIONABLE=new Go("positionable"),Go.DRAG_TARGET=new Go("drag_target"),Go.DELETE_AREA=new Go("delete_area"),Go.AUTOHIDEABLE=new Go("autohideable");var de=class{constructor(){this.componentData=new Map,this.capabilityToComponentIds=new Map}addComponent(e,t){const i=e.component.id;var s;if(!t&&this.componentData.has(i))throw Error('Plugin "'+i+'" with capabilities "'+(null==(s=this.componentData.get(i))?void 0:s.capabilities)+'" already added.');for(this.componentData.set(i,e),t=[],s=0;s<e.capabilities.length;s++){const n=String(e.capabilities[s]).toLowerCase();if(t.push(n),this.capabilityToComponentIds.has(n)){let l;null==(l=this.capabilityToComponentIds.get(n))||l.push(i)}else this.capabilityToComponentIds.set(n,[i])}this.componentData.get(i).capabilities=t}removeComponent(e){const t=this.componentData.get(e);if(t){for(let i=0;i<t.capabilities.length;i++){const s=String(t.capabilities[i]).toLowerCase();ht(this.capabilityToComponentIds.get(s),e)}this.componentData.delete(e)}}addCapability(e,t){if(!this.getComponent(e))throw Error('Cannot add capability, "'+t+'". Plugin "'+e+'" has not been added to the ComponentManager');var i,s;this.hasCapability(e,t)?console.warn('Plugin "'+e+'already has capability "'+t+'"'):(t=`${t}`.toLowerCase(),null==(i=this.componentData.get(e))||i.capabilities.push(t),null==(s=this.capabilityToComponentIds.get(t))||s.push(e))}removeCapability(e,t){if(!this.getComponent(e))throw Error('Cannot remove capability, "'+t+'". Plugin "'+e+'" has not been added to the ComponentManager');this.hasCapability(e,t)?(t=`${t}`.toLowerCase(),ht(this.componentData.get(e).capabilities,t),ht(this.capabilityToComponentIds.get(t),e)):console.warn('Plugin "'+e+"doesn't have capability \""+t+'" to remove')}hasCapability(e,t){return t=`${t}`.toLowerCase(),this.componentData.has(e)&&this.componentData.get(e).capabilities.includes(t)}getComponent(e){let t;return null==(t=this.componentData.get(e))?void 0:t.component}getComponents(e,t){if(e=`${e}`.toLowerCase(),!(e=this.capabilityToComponentIds.get(e)))return[];const i=[];if(t){const s=[];e.forEach(n=>{s.push(this.componentData.get(n))}),s.sort(function(n,l){return n.weight-l.weight}),s.forEach(function(n){i.push(n.component)})}else e.forEach(s=>{i.push(this.componentData.get(s).component)});return i}};de.Capability=Go,function(e){(e=e.ComponentWeight||(e.ComponentWeight={}))[e.TOOLBOX_WEIGHT=0]="TOOLBOX_WEIGHT",e[e.FLYOUT_WEIGHT=1]="FLYOUT_WEIGHT",e[e.TRASHCAN_WEIGHT=2]="TRASHCAN_WEIGHT",e[e.ZOOM_CONTROLS_WEIGHT=3]="ZOOM_CONTROLS_WEIGHT"}(de||(de={}));var M_=de.ComponentWeight,w$={};w$.ComponentManager=de,w$.ComponentWeight=M_;var Xh=!1,Kh='\n.blocklySvg {\n  background-color: #fff;\n  outline: none;\n  overflow: hidden;  /* IE overflows by default. */\n  position: absolute;\n  display: block;\n}\n\n.blocklyWidgetDiv {\n  display: none;\n  position: absolute;\n  z-index: 99999;  /* big value for bootstrap3 compatibility */\n}\n\n.injectionDiv {\n  height: 100%;\n  position: relative;\n  overflow: hidden;  /* So blocks in drag surface disappear at edges */\n  touch-action: none;\n  user-select: none;\n  -webkit-user-select: none;\n}\n\n.blocklyBlockCanvas.blocklyCanvasTransitioning,\n.blocklyBubbleCanvas.blocklyCanvasTransitioning {\n  transition: transform .5s;\n}\n\n.blocklyEmboss {\n  filter: var(--blocklyEmbossFilter);\n}\n\n.blocklyTooltipDiv {\n  background-color: #ffffc7;\n  border: 1px solid #ddc;\n  box-shadow: 4px 4px 20px 1px rgba(0,0,0,.15);\n  color: #000;\n  display: none;\n  font: 9pt sans-serif;\n  opacity: .9;\n  padding: 2px;\n  position: absolute;\n  z-index: 100000;  /* big value for bootstrap3 compatibility */\n}\n\n.blocklyDropDownDiv {\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1000;\n  display: none;\n  border: 1px solid;\n  border-color: #dadce0;\n  background-color: #fff;\n  border-radius: 2px;\n  padding: 4px;\n  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownDiv:focus {\n  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownContent {\n  max-height: 300px;  /* @todo: spec for maximum height. */\n}\n\n.blocklyDropDownArrow {\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 16px;\n  height: 16px;\n  z-index: -1;\n  background-color: inherit;\n  border-color: inherit;\n  border-top: 1px solid;\n  border-left: 1px solid;\n  border-top-left-radius: 4px;\n  border-color: inherit;\n}\n\n.blocklyHighlighted>.blocklyPath {\n  filter: var(--blocklyEmbossFilter);\n}\n\n.blocklyHighlightedConnectionPath {\n  fill: none;\n  stroke: #fc3;\n  stroke-width: 4px;\n}\n\n.blocklyPathLight {\n  fill: none;\n  stroke-linecap: round;\n  stroke-width: 1;\n}\n\n.blocklySelected>.blocklyPathLight {\n  display: none;\n}\n\n.blocklyDraggable {\n  cursor: grab;\n  cursor: -webkit-grab;\n}\n\n.blocklyDragging {\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n  /* Drag surface disables events to not block the toolbox, so we have to\n   * reenable them here for the cursor values to work. */\n  pointer-events: auto;\n}\n\n  /* Changes cursor on mouse down. Not effective in Firefox because of\n     https://bugzilla.mozilla.org/show_bug.cgi?id=771241 */\n.blocklyDraggable:active {\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n}\n\n.blocklyDragging.blocklyDraggingDelete {\n  cursor: url("<<<PATH>>>/handdelete.cur"), auto;\n}\n\n.blocklyDragging>.blocklyPath,\n.blocklyDragging>.blocklyPathLight {\n  fill-opacity: .8;\n  stroke-opacity: .8;\n}\n\n.blocklyDragging>.blocklyPathDark {\n  display: none;\n}\n\n.blocklyDisabledPattern>.blocklyPath {\n  fill: var(--blocklyDisabledPattern);\n  fill-opacity: .5;\n  stroke-opacity: .5;\n}\n\n.blocklyDisabled>.blocklyPathLight,\n.blocklyDisabled>.blocklyPathDark {\n  display: none;\n}\n\n.blocklyInsertionMarker>.blocklyPath,\n.blocklyInsertionMarker>.blocklyPathLight,\n.blocklyInsertionMarker>.blocklyPathDark {\n  fill-opacity: .2;\n  stroke: none;\n}\n\n.blocklyNonEditableField>text {\n  pointer-events: none;\n}\n\n.blocklyFlyout {\n  position: absolute;\n  z-index: 20;\n}\n\n.blocklyText text {\n  cursor: default;\n}\n\n/*\n  Don\'t allow users to select text.  It gets annoying when trying to\n  drag a block and selected text moves instead.\n*/\n.blocklySvg text {\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n  cursor: inherit;\n}\n\n.blocklyIconGroup {\n  cursor: default;\n}\n\n.blocklyIconGroup:not(:hover),\n.blocklyIconGroupReadonly {\n  opacity: .6;\n}\n\n.blocklyIconShape {\n  fill: #00f;\n  stroke: #fff;\n  stroke-width: 1px;\n}\n\n.blocklyIconSymbol {\n  fill: #fff;\n}\n\n.blocklyMinimalBody {\n  margin: 0;\n  padding: 0;\n  height: 100%;\n}\n\n.blocklyHtmlInput {\n  border: none;\n  border-radius: 4px;\n  height: 100%;\n  margin: 0;\n  outline: none;\n  padding: 0;\n  width: 100%;\n  text-align: center;\n  display: block;\n  box-sizing: border-box;\n}\n\n/* Remove the increase and decrease arrows on the field number editor */\ninput.blocklyHtmlInput[type=number]::-webkit-inner-spin-button,\ninput.blocklyHtmlInput[type=number]::-webkit-outer-spin-button {\n  -webkit-appearance: none;\n  margin: 0;\n}\n\ninput[type=number] {\n  -moz-appearance: textfield;\n}\n\n.blocklyMainBackground {\n  stroke-width: 1;\n  stroke: #c6c6c6;  /* Equates to #ddd due to border being off-pixel. */\n}\n\n.blocklyMutatorBackground {\n  fill: #fff;\n  stroke: #ddd;\n  stroke-width: 1;\n}\n\n.blocklyFlyoutBackground {\n  fill: #ddd;\n  fill-opacity: .8;\n}\n\n.blocklyMainWorkspaceScrollbar {\n  z-index: 20;\n}\n\n.blocklyFlyoutScrollbar {\n  z-index: 30;\n}\n\n.blocklyScrollbarHorizontal,\n.blocklyScrollbarVertical {\n  position: absolute;\n  outline: none;\n}\n\n.blocklyScrollbarBackground {\n  opacity: 0;\n  pointer-events: none;\n}\n\n.blocklyScrollbarHandle {\n  fill: #ccc;\n}\n\n.blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,\n.blocklyScrollbarHandle:hover {\n  fill: #bbb;\n}\n\n/* Darken flyout scrollbars due to being on a grey background. */\n/* By contrast, workspace scrollbars are on a white background. */\n.blocklyFlyout .blocklyScrollbarHandle {\n  fill: #bbb;\n}\n\n.blocklyFlyout .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,\n.blocklyFlyout .blocklyScrollbarHandle:hover {\n  fill: #aaa;\n}\n\n.blocklyInvalidInput {\n  background: #faa;\n}\n\n.blocklyVerticalMarker {\n  stroke-width: 3px;\n  fill: rgba(255,255,255,.5);\n  pointer-events: none;\n}\n\n.blocklyComputeCanvas {\n  position: absolute;\n  width: 0;\n  height: 0;\n}\n\n.blocklyNoPointerEvents {\n  pointer-events: none;\n}\n\n.blocklyContextMenu {\n  border-radius: 4px;\n  max-height: 100%;\n}\n\n.blocklyDropdownMenu {\n  border-radius: 2px;\n  padding: 0 !important;\n}\n\n.blocklyDropdownMenu .blocklyMenuItem {\n  /* 28px on the left for icon or checkbox. */\n  padding-left: 28px;\n}\n\n/* BiDi override for the resting state. */\n.blocklyDropdownMenu .blocklyMenuItemRtl {\n  /* Flip left/right padding for BiDi. */\n  padding-left: 5px;\n  padding-right: 28px;\n}\n\n.blocklyWidgetDiv .blocklyMenu {\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n  background: #fff;\n  border: 1px solid transparent;\n  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);\n  font: normal 13px Arial, sans-serif;\n  margin: 0;\n  outline: none;\n  padding: 4px 0;\n  position: absolute;\n  overflow-y: auto;\n  overflow-x: hidden;\n  max-height: 100%;\n  z-index: 20000;  /* Arbitrary, but some apps depend on it... */\n}\n\n.blocklyWidgetDiv .blocklyMenu:focus {\n  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownDiv .blocklyMenu {\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n  background: inherit;  /* Compatibility with gapi, reset from goog-menu */\n  border: inherit;  /* Compatibility with gapi, reset from goog-menu */\n  font: normal 13px "Helvetica Neue", Helvetica, sans-serif;\n  outline: none;\n  overflow-y: auto;\n  overflow-x: hidden;\n  max-height: 100%;\n  z-index: 20000;  /* Arbitrary, but some apps depend on it... */\n}\n\n/* State: resting. */\n.blocklyMenuItem {\n  border: none;\n  color: #000;\n  cursor: pointer;\n  list-style: none;\n  margin: 0;\n  /* 7em on the right for shortcut. */\n  min-width: 7em;\n  padding: 6px 15px;\n  white-space: nowrap;\n}\n\n/* State: disabled. */\n.blocklyMenuItemDisabled {\n  color: #ccc;\n  cursor: inherit;\n}\n\n/* State: hover. */\n.blocklyMenuItemHighlight {\n  background-color: rgba(0,0,0,.1);\n}\n\n/* State: selected/checked. */\n.blocklyMenuItemCheckbox {\n  height: 16px;\n  position: absolute;\n  width: 16px;\n}\n\n.blocklyMenuItemSelected .blocklyMenuItemCheckbox {\n  background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px;\n  float: left;\n  margin-left: -24px;\n  position: static;  /* Scroll with the menu. */\n}\n\n.blocklyMenuItemRtl .blocklyMenuItemCheckbox {\n  float: right;\n  margin-right: -24px;\n}\n\n.blocklyMenuSeparator {\n  background-color: #ccc;\n  height: 1px;\n  border: 0;\n  margin-left: 4px;\n  margin-right: 4px;\n}\n\n.blocklyBlockDragSurface, .blocklyAnimationLayer {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  overflow: visible !important;\n  z-index: 80;\n  pointer-events: none;\n}\n\n.blocklyField {\n  cursor: default;\n}\n\n.blocklyInputField {\n  cursor: text;\n}\n\n.blocklyDragging .blocklyField,\n.blocklyDragging .blocklyIconGroup {\n  cursor: grabbing;\n}\n\n.blocklyActiveFocus:is(\n  .blocklyFlyout,\n  .blocklyWorkspace,\n  .blocklyField,\n  .blocklyPath,\n  .blocklyHighlightedConnectionPath,\n  .blocklyComment,\n  .blocklyBubble,\n  .blocklyIconGroup,\n  .blocklyTextarea\n) {\n  outline: none;\n}\n',Jh={};Jh.inject=$c,Jh.register=Ft;var k=class{constructor(e,t){this.x=e,this.y=t}clone(){return new k(this.x,this.y)}scale(e){return this.x*=e,this.y*=e,this}translate(e,t){return this.x+=e,this.y+=t,this}static equals(e,t){return e===t||!(!e||!t)&&e.x===t.x&&e.y===t.y}static distance(e,t){const i=e.x-t.x;return e=e.y-t.y,Math.sqrt(i*i+e*e)}static magnitude(e){return Math.sqrt(e.x*e.x+e.y*e.y)}static difference(e,t){return new k(e.x-t.x,e.y-t.y)}static sum(e,t){return new k(e.x+t.x,e.y+t.y)}},T=class{constructor(e){this.tagName=e}toString(){return this.tagName}};T.ANIMATE=new T("animate"),T.CIRCLE=new T("circle"),T.CLIPPATH=new T("clipPath"),T.DEFS=new T("defs"),T.FECOMPOSITE=new T("feComposite"),T.FECOMPONENTTRANSFER=new T("feComponentTransfer"),T.FEFLOOD=new T("feFlood"),T.FEFUNCA=new T("feFuncA"),T.FEGAUSSIANBLUR=new T("feGaussianBlur"),T.FEPOINTLIGHT=new T("fePointLight"),T.FESPECULARLIGHTING=new T("feSpecularLighting"),T.FILTER=new T("filter"),T.FOREIGNOBJECT=new T("foreignObject"),T.G=new T("g"),T.IMAGE=new T("image"),T.LINE=new T("line"),T.PATH=new T("path"),T.PATTERN=new T("pattern"),T.POLYGON=new T("polygon"),T.RECT=new T("rect"),T.SVG=new T("svg"),T.TEXT=new T("text"),T.TSPAN=new T("tspan");var j=class{constructor(e,t,i,s){this.top=e,this.bottom=t,this.left=i,this.right=s}static from(e){return new j(e.y,e.y+e.height,e.x,e.x+e.width)}clone(){return new j(this.top,this.bottom,this.left,this.right)}getHeight(){return this.bottom-this.top}getWidth(){return this.right-this.left}getOrigin(){return new k(this.left,this.top)}contains(e,t){return e>=this.left&&e<=this.right&&t>=this.top&&t<=this.bottom}intersects(e){return this.left<=e.right&&this.right>=e.left&&this.bottom>=e.top&&this.top<=e.bottom}static equals(e,t){return e===t||!(!e||!t)&&e.top===t.top&&e.bottom===t.bottom&&e.left===t.left&&e.right===t.right}static createFromPoint(e,t,i){const s=e.x;return new j(e=e.y,e+i,s,s+t)}},Y=class{constructor(e,t){this.width=e,this.height=t}static equals(e,t){return e===t||!(!e||!t)&&e.width===t.width&&e.height===t.height}static max(e,t){return new Y(Math.max(e.width,t.width),Math.max(e.height,t.height))}static min(e,t){return new Y(Math.min(e.width,t.width),Math.min(e.height,t.height))}},S$={getSizeInternal:nd},Ni={TEST_ONLY:S$};Ni.getBorderBox=bc,Ni.getComputedStyle=Ut,Ni.getContainerOffsetToScrollInto=Tc,Ni.getPageOffset=ko,Ni.getSize=mn,Ni.getViewportPageOffset=_c,Ni.scrollIntoContainerView=fc;var A$=/translate\(\s*([-+\d.e]+)([ ,]\s*([-+\d.e]+)\s*)?/,R$=/transform:\s*translate(?:3d)?\(\s*([-+\d.e]+)\s*px([ ,]\s*([-+\d.e]+)\s*px)?/,Ps={TEST_ONLY:{XY_REGEX:A$,XY_STYLE_REGEX:R$}};Ps.getDocumentScroll=vc,Ps.getInjectionDivXY=Tr,Ps.getRelativeXY=_n,Ps.getViewportBBox=Ec,Ps.screenToWsCoordinates=yc,Ps.wsToScreenCoordinates=cs;var be=class{constructor(e,t,i,s,n){this.workspace=e,this.horizontal=t,this.oldHostMetrics=null,this.ratio=1,this.origin=new k(0,0),this.startDragHandle=this.handlePosition=this.handleLength=this.scrollbarLength=this.startDragMouse=0,this.containerVisible=this.isHandleVisible=!0,this.position=new k(0,0),this.onMouseMoveWrapper_=this.onMouseUpWrapper_=null,this.pair=i||!1,this.margin=void 0!==n?n:be.DEFAULT_SCROLLBAR_MARGIN,e="blocklyScrollbar"+(this.horizontal?"Horizontal":"Vertical"),s&&(e+=" "+s),this.outerSvg=I(T.SVG,{class:e}),s=I(T.G,{},this.outerSvg),this.svgBackground=I(T.RECT,{class:"blocklyScrollbarBackground"},s),e=Math.floor((be.scrollbarThickness-5)/2),this.svgHandle=I(T.RECT,{class:"blocklyScrollbarHandle",rx:e,ry:e},s),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarColour","fill"),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarOpacity","fill-opacity"),c(this.outerSvg,this.workspace.getParentSvg()),this.setInitialThickness(),t?(this.lengthAttribute_="width",this.positionAttribute_="x"):(this.lengthAttribute_="height",this.positionAttribute_="y"),this.onMouseDownBarWrapper_=N(this.svgBackground,"pointerdown",this,this.onMouseDownBar),this.onMouseDownHandleWrapper_=N(this.svgHandle,"pointerdown",this,this.onMouseDownHandle)}setInitialThickness(){const e=be.scrollbarThickness;this.horizontal?(this.svgBackground.setAttribute("height",String(e)),this.outerSvg.setAttribute("height",String(e)),this.svgHandle.setAttribute("height",String(e-5)),this.svgHandle.setAttribute("y","2.5")):(this.svgBackground.setAttribute("width",String(e)),this.outerSvg.setAttribute("width",String(e)),this.svgHandle.setAttribute("width",String(e-5)),this.svgHandle.setAttribute("x","2.5"))}dispose(){this.cleanUp(),J(this.onMouseDownBarWrapper_),J(this.onMouseDownHandleWrapper_),Q(this.outerSvg),this.workspace.getThemeManager().unsubscribe(this.svgHandle)}constrainHandleLength(e){return e<=0||isNaN(e)?0:Math.min(e,this.scrollbarLength)}setHandleLength(e){this.handleLength=e,this.svgHandle.setAttribute(this.lengthAttribute_,String(this.handleLength))}constrainHandlePosition(e){return e<=0||isNaN(e)?0:Math.min(e,this.scrollbarLength-this.handleLength)}setHandlePosition(e){this.handlePosition=e,this.svgHandle.setAttribute(this.positionAttribute_,String(this.handlePosition))}setScrollbarLength(e){this.scrollbarLength=e,this.outerSvg.setAttribute(this.lengthAttribute_,String(this.scrollbarLength)),this.svgBackground.setAttribute(this.lengthAttribute_,String(this.scrollbarLength))}setPosition(e,t){this.position.x=e,this.position.y=t,g(this.outerSvg,"translate("+(this.position.x+this.origin.x)+"px,"+(this.position.y+this.origin.y)+"px)")}resize(e){!e&&!(e=this.workspace.getMetrics())||this.oldHostMetrics&&be.metricsAreEquivalent(e,this.oldHostMetrics)||(this.horizontal?this.resizeHorizontal(e):this.resizeVertical(e),this.oldHostMetrics=e,this.updateMetrics())}requiresViewResize(e){return!this.oldHostMetrics||this.oldHostMetrics.viewWidth!==e.viewWidth||this.oldHostMetrics.viewHeight!==e.viewHeight||this.oldHostMetrics.absoluteLeft!==e.absoluteLeft||this.oldHostMetrics.absoluteTop!==e.absoluteTop}resizeHorizontal(e){this.requiresViewResize(e)?this.resizeViewHorizontal(e):this.resizeContentHorizontal(e)}resizeViewHorizontal(e){var t=e.viewWidth-2*this.margin;this.pair&&(t-=be.scrollbarThickness),this.setScrollbarLength(Math.max(0,t)),t=e.absoluteLeft+this.margin,this.pair&&this.workspace.RTL&&(t+=be.scrollbarThickness),this.setPosition(t,e.absoluteTop+e.viewHeight-be.scrollbarThickness-this.margin),this.resizeContentHorizontal(e)}resizeContentHorizontal(e){if(e.viewWidth>=e.scrollWidth)this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(!1);else{this.pair||this.setVisible(!0);var t=this.scrollbarLength*e.viewWidth/e.scrollWidth;t=this.constrainHandleLength(t),this.setHandleLength(t);var i=this.scrollbarLength-this.handleLength;e=this.constrainHandlePosition(e=(e.viewLeft-e.scrollLeft)/(t=e.scrollWidth-e.viewWidth)*i),this.setHandlePosition(e),this.ratio=i/t}}resizeVertical(e){this.requiresViewResize(e)?this.resizeViewVertical(e):this.resizeContentVertical(e)}resizeViewVertical(e){let t=e.viewHeight-2*this.margin;this.pair&&(t-=be.scrollbarThickness),this.setScrollbarLength(Math.max(0,t)),this.setPosition(this.workspace.RTL?e.absoluteLeft+this.margin:e.absoluteLeft+e.viewWidth-be.scrollbarThickness-this.margin,e.absoluteTop+this.margin),this.resizeContentVertical(e)}resizeContentVertical(e){if(e.viewHeight>=e.scrollHeight)this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(!1);else{this.pair||this.setVisible(!0);var t=this.scrollbarLength*e.viewHeight/e.scrollHeight;t=this.constrainHandleLength(t),this.setHandleLength(t);var i=this.scrollbarLength-this.handleLength;e=this.constrainHandlePosition(e=(e.viewTop-e.scrollTop)/(t=e.scrollHeight-e.viewHeight)*i),this.setHandlePosition(e),this.ratio=i/t}}isVisible(){return this.isHandleVisible}setContainerVisible(e){const t=e!==this.containerVisible;this.containerVisible=e,t&&this.updateDisplay_()}setVisible(e){if(this.pair)throw Error("Unable to toggle visibility of paired scrollbars.");this.setVisibleInternal(e)}setVisibleInternal(e){const t=e!==this.isVisible();this.isHandleVisible=e,t&&this.updateDisplay_()}updateDisplay_(){this.containerVisible&&this.isVisible()?this.outerSvg.setAttribute("display","block"):this.outerSvg.setAttribute("display","none")}onMouseDownBar(e){if(this.workspace.markFocused(),Oe(),this.cleanUp(),it(e))e.stopPropagation();else{var t=wt(e,this.workspace.getParentSvg(),this.workspace.getInverseScreenCTM());t=this.horizontal?t.x:t.y;var i=Tr(this.svgHandle),s=this.handlePosition,n=.95*this.handleLength;t<=(i=this.horizontal?i.x:i.y)?s-=n:t>=i+this.handleLength&&(s+=n),this.setHandlePosition(this.constrainHandlePosition(s)),this.updateMetrics(),e.stopPropagation(),e.preventDefault()}}onMouseDownHandle(e){this.workspace.markFocused(),this.cleanUp(),it(e)?e.stopPropagation():(this.startDragHandle=this.handlePosition,this.startDragMouse=this.horizontal?e.clientX:e.clientY,this.onMouseUpWrapper_=N(document,"pointerup",this,this.onMouseUpHandle),this.onMouseMoveWrapper_=N(document,"pointermove",this,this.onMouseMoveHandle),e.stopPropagation(),e.preventDefault())}onMouseMoveHandle(e){this.setHandlePosition(this.constrainHandlePosition(this.startDragHandle+((this.horizontal?e.clientX:e.clientY)-this.startDragMouse))),this.updateMetrics()}onMouseUpHandle(){Oe(),this.cleanUp()}cleanUp(){this.workspace.hideChaff(!0),this.onMouseUpWrapper_&&(J(this.onMouseUpWrapper_),this.onMouseUpWrapper_=null),this.onMouseMoveWrapper_&&(J(this.onMouseMoveWrapper_),this.onMouseMoveWrapper_=null)}getRatio_(){let e=this.handlePosition/(this.scrollbarLength-this.handleLength);return isNaN(e)&&(e=0),e}updateMetrics(){const e=this.getRatio_();this.workspace.setMetrics(this.horizontal?{x:e}:{y:e})}set(e,t){this.setHandlePosition(this.constrainHandlePosition(e*this.ratio)),(t||void 0===t)&&this.updateMetrics()}setOrigin(e,t){this.origin=new k(e,t)}static metricsAreEquivalent(e,t){return e.viewWidth===t.viewWidth&&e.viewHeight===t.viewHeight&&e.viewLeft===t.viewLeft&&e.viewTop===t.viewTop&&e.absoluteTop===t.absoluteTop&&e.absoluteLeft===t.absoluteLeft&&e.scrollWidth===t.scrollWidth&&e.scrollHeight===t.scrollHeight&&e.scrollLeft===t.scrollLeft&&e.scrollTop===t.scrollTop}};be.scrollbarThickness=r$?25:15,be.DEFAULT_SCROLLBAR_MARGIN=.5;var Pa={parseFromString:function(){throw Error("DOMParser was not found in the global scope and was not properly injected using injectDependencies")}},Qh={serializeToString:function(){throw Error("XMLSerializer was not foundin the global scope and was not properly injected using injectDependencies")}},{document:Ba,DOMParser:Sl,XMLSerializer:Al}=globalThis;Sl&&(Pa=new Sl),Al&&(Qh=new Al);var O$="https://developers.google.com/blockly/xml",U_=/[\x00-\x09\x0B\x0C\x0E-\x1F]/g,Xn={NAME_SPACE:O$};Xn.createElement=o.createElement$$module$build$src$core$utils$xml,Xn.createTextNode=o.createTextNode$$module$build$src$core$utils$xml,Xn.domToText=as,Xn.injectDependencies=rd,Xn.textToDom=o.textToDom$$module$build$src$core$utils$xml;var G,ep="categoryToolbox",M$="flyoutToolbox";!function(e){e[e.TOP=0]="TOP",e[e.BOTTOM=1]="BOTTOM",e[e.LEFT=2]="LEFT",e[e.RIGHT=3]="RIGHT"}(G||(G={}));var N$={hasCategoriesInternal:ad},Li={};Li.Position=G,Li.TEST_ONLY=N$,Li.convertFlyoutDefToJsonArray=bn,Li.convertToolboxDefToJson=Er,Li.hasCategories=vr,Li.isCategoryCollapsible=yr,Li.parseToolboxTree=Ic;var Di=function(e){return e[e.TOP=0]="TOP",e[e.BOTTOM=1]="BOTTOM",e}(Di||{}),Rl=function(e){return e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT",e}(Rl||{}),Bs=function(e){return e[e.UP=0]="UP",e[e.DOWN=1]="DOWN",e}(Bs||{}),Fs={};Fs.bumpDirection=Bs,Fs.bumpPositionRect=kr,Fs.getCornerOppositeToolbox=xr,Fs.getStartPositionRect=Ir,Fs.horizontalPosition=Rl,Fs.verticalPosition=Di;var Ke_width=96,Ke_height=124,Ke_url="sprites.png",tp=class{constructor(e){this.workspace=e,this.id="zoomControls",this.boundEvents=[],this.zoomResetGroup=this.zoomOutGroup=this.zoomInGroup=null,this.HEIGHT=this.WIDTH=32,this.SMALL_SPACING=2,this.LARGE_SPACING=11,this.MARGIN_HORIZONTAL=this.MARGIN_VERTICAL=20,this.svgGroup=null,this.top=this.left=0,this.initialized=!1}createDom(){this.svgGroup=I(T.G,{});const e=String(Math.random()).substring(2);return this.createZoomOutSvg(e),this.createZoomInSvg(e),this.workspace.isMovable()&&this.createZoomResetSvg(e),this.svgGroup}init(){this.workspace.getComponentManager().addComponent({component:this,weight:de.ComponentWeight.ZOOM_CONTROLS_WEIGHT,capabilities:[de.Capability.POSITIONABLE]}),this.initialized=!0}dispose(){this.workspace.getComponentManager().removeComponent("zoomControls"),this.svgGroup&&Q(this.svgGroup);for(const e of this.boundEvents)J(e);this.boundEvents.length=0}getBoundingRectangle(){let e=this.SMALL_SPACING+2*this.HEIGHT;return this.zoomResetGroup&&(e+=this.LARGE_SPACING+this.HEIGHT),new j(this.top,this.top+e,this.left,this.left+this.WIDTH)}position(e,t){if(this.initialized){var u,i=xr(this.workspace,e),s=this.SMALL_SPACING+2*this.HEIGHT;if(this.zoomResetGroup&&(s+=this.LARGE_SPACING+this.HEIGHT),e=Ir(i,new Y(this.WIDTH,s),this.MARGIN_HORIZONTAL,this.MARGIN_VERTICAL,e,this.workspace),t=kr(e,this.MARGIN_VERTICAL,(i=i.vertical)===Di.TOP?Bs.DOWN:Bs.UP,t),i===Di.TOP){var l,n=this.SMALL_SPACING+this.HEIGHT;null==(l=this.zoomInGroup)||l.setAttribute("transform","translate(0, "+n+")"),this.zoomResetGroup&&this.zoomResetGroup.setAttribute("transform","translate(0, "+(n+this.LARGE_SPACING+this.HEIGHT)+")")}else{let $;l=this.zoomResetGroup?this.LARGE_SPACING+this.HEIGHT:0,null==($=this.zoomInGroup)||$.setAttribute("transform","translate(0, "+l+")"),l=l+this.SMALL_SPACING+this.HEIGHT,null==(n=this.zoomOutGroup)||n.setAttribute("transform","translate(0, "+l+")")}this.top=t.top,this.left=t.left,null==(u=this.svgGroup)||u.setAttribute("transform","translate("+this.left+","+this.top+")")}}createZoomOutSvg(e){this.zoomOutGroup=I(T.G,{class:"blocklyZoom blocklyZoomOut"},this.svgGroup);const t=I(T.CLIPPATH,{id:"blocklyZoomoutClipPath"+e},this.zoomOutGroup);I(T.RECT,{width:32,height:32},t),I(T.IMAGE,{width:Ke_width,height:Ke_height,x:-64,y:-92,"clip-path":"url(#blocklyZoomoutClipPath"+e+")"},this.zoomOutGroup).setAttributeNS(vt,"xlink:href",this.workspace.options.pathToMedia+Ke_url),this.boundEvents.push(N(this.zoomOutGroup,"pointerdown",null,this.zoom.bind(this,-1)))}createZoomInSvg(e){this.zoomInGroup=I(T.G,{class:"blocklyZoom blocklyZoomIn"},this.svgGroup);const t=I(T.CLIPPATH,{id:"blocklyZoominClipPath"+e},this.zoomInGroup);I(T.RECT,{width:32,height:32},t),I(T.IMAGE,{width:Ke_width,height:Ke_height,x:-32,y:-92,"clip-path":"url(#blocklyZoominClipPath"+e+")"},this.zoomInGroup).setAttributeNS(vt,"xlink:href",this.workspace.options.pathToMedia+Ke_url),this.boundEvents.push(N(this.zoomInGroup,"pointerdown",null,this.zoom.bind(this,1)))}zoom(e,t){this.workspace.markFocused(),this.workspace.zoomCenter(e),this.fireZoomEvent(),Oe(),t.stopPropagation(),t.preventDefault()}createZoomResetSvg(e){this.zoomResetGroup=I(T.G,{class:"blocklyZoom blocklyZoomReset"},this.svgGroup);const t=I(T.CLIPPATH,{id:"blocklyZoomresetClipPath"+e},this.zoomResetGroup);I(T.RECT,{width:32,height:32},t),I(T.IMAGE,{width:Ke_width,height:Ke_height,y:-92,"clip-path":"url(#blocklyZoomresetClipPath"+e+")"},this.zoomResetGroup).setAttributeNS(vt,"xlink:href",this.workspace.options.pathToMedia+Ke_url),this.boundEvents.push(N(this.zoomResetGroup,"pointerdown",null,this.resetZoom.bind(this)))}resetZoom(e){this.workspace.markFocused();const t=Math.log(this.workspace.options.zoomOptions.startScale/this.workspace.scale)/Math.log(this.workspace.options.zoomOptions.scaleSpeed);this.workspace.beginCanvasTransition(),this.workspace.zoomCenter(t),this.workspace.scrollCenter(),setTimeout(this.workspace.endCanvasTransition.bind(this.workspace),500),this.fireZoomEvent(),Oe(),e.stopPropagation(),e.preventDefault()}fireZoomEvent(){const e=new(P(f.CLICK))(null,this.workspace.id,"zoom_controls");D(e)}};Ft("\n.blocklyZoom>image, .blocklyZoom>svg>image {\n  opacity: .4;\n}\n\n.blocklyZoom>image:hover, .blocklyZoom>svg>image:hover {\n  opacity: .6;\n}\n\n.blocklyZoom>image:active, .blocklyZoom>svg>image:active {\n  opacity: .8;\n}\n");var Z_={BLOCKS:50,PROCEDURES:75,VARIABLES:100,WORKSPACE_COMMENTS:25},op={};op.register=fn,op.unregister=dd;var F$=class{constructor(){this.priority=25}save(e){const t=[];for(const i of e.getTopComments())(e=hi(i,{addCoordinates:!0,saveIds:!0}))&&t.push(e);return t.length?t:null}load(e,t){for(const i of e)Tn(i,t,{recordUndo:Se()})}clear(e){for(const t of e.getTopComments())t.dispose()}};fn("workspaceComments",new F$);var Fa={};Fa.WorkspaceCommentSerializer=F$,Fa.append=Tn,Fa.save=hi;var ip={};ip.register=wr,ip.unregister=hd;var Ol=class{paste(e,t,i){let s;e=e.commentState,i&&(e.x=i.x,e.y=i.y),o.disable$$module$build$src$core$events$utils();try{s=Tn(e,t),pd(s)}finally{o.enable$$module$build$src$core$events$utils()}return s?(ne()&&D(new(P(f.COMMENT_CREATE))(s)),o.getFocusManager$$module$build$src$core$focus_manager().focusNode(s),s):null}};Ol.TYPE="workspace-comment",wr(Ol.TYPE,new Ol),o.config$$module$build$src$core$config={dragRadius:5,flyoutDragRadius:10,snapRadius:28,connectingSnapRadius:28,currentConnectionPreference:8,bumpDelay:250};var yt,W_="aria-",q_="role";!function(e){e.GRID="grid",e.GRIDCELL="gridcell",e.GROUP="group",e.LISTBOX="listbox",e.MENU="menu",e.MENUITEM="menuitem",e.MENUITEMCHECKBOX="menuitemcheckbox",e.OPTION="option",e.PRESENTATION="presentation",e.ROW="row",e.TREE="tree",e.TREEITEM="treeitem",e.SEPARATOR="separator",e.STATUS="status"}(yt||(yt={}));var xe=function(e){return e.ACTIVEDESCENDANT="activedescendant",e.COLCOUNT="colcount",e.DISABLED="disabled",e.EXPANDED="expanded",e.INVALID="invalid",e.LABEL="label",e.LABELLEDBY="labelledby",e.LEVEL="level",e.ORIENTATION="orientation",e.POSINSET="posinset",e.ROWCOUNT="rowcount",e.SELECTED="selected",e.SETSIZE="setsize",e.VALUEMAX="valuemax",e.VALUEMIN="valuemin",e.LIVE="live",e.HIDDEN="hidden",e}(xe||{}),Ml={};Ml.Role=yt,Ml.State=xe,Ml.setRole=Ht,Ml.setState=ye;var Nl=class{constructor(e,t){this.content=e,this.opt_value=t,this.enabled=!0,this.element=null,this.rightToLeft=!1,this.roleName=null,this.highlight=this.checked=this.checkable=!1,this.actionHandler=null}createDom(){const e=document.createElement("div");e.id=Ee(),this.element=e,e.className="blocklyMenuItem "+(this.enabled?"":"blocklyMenuItemDisabled ")+(this.checked?"blocklyMenuItemSelected ":"")+(this.highlight?"blocklyMenuItemHighlight ":"")+(this.rightToLeft?"blocklyMenuItemRtl ":"");const t=document.createElement("div");if(t.className="blocklyMenuItemContent",this.checkable){var i=document.createElement("div");i.className="blocklyMenuItemCheckbox ",t.appendChild(i)}return i=this.content,"string"==typeof this.content&&(i=document.createTextNode(this.content)),t.appendChild(i),e.appendChild(t),this.roleName&&Ht(e,this.roleName),ye(e,xe.SELECTED,this.checkable&&this.checked||!1),ye(e,xe.DISABLED,!this.enabled),e}dispose(){this.element=null}getElement(){return this.element}getId(){return this.element.id}getValue(){let e;return null!=(e=this.opt_value)?e:null}setRightToLeft(e){this.rightToLeft=e}setRole(e){this.roleName=e}setCheckable(e){this.checkable=e}setChecked(e){this.checked=e}setHighlighted(e){this.highlight=e;const t=this.getElement();t&&this.isEnabled()&&(e?R(t,"blocklyMenuItemHighlight"):X(t,"blocklyMenuItemHighlight"))}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}performAction(e){this.isEnabled()&&this.actionHandler&&this.actionHandler(this,e)}onAction(e,t){this.actionHandler=e.bind(t)}},Ua=class{constructor(){this.menuItems=[],this.roleName=this.element=this.onKeyDownHandler=this.pointerLeaveHandler=this.pointerEnterHandler=this.clickHandler=this.pointerMoveHandler=this.highlightedItem=this.openingCoords=null}addChild(e){this.menuItems.push(e)}render(e){const t=document.createElement("div");t.className="blocklyMenu",t.tabIndex=0,this.roleName&&Ht(t,this.roleName),this.element=t;for(let s,i=0;s=this.menuItems[i];i++)t.appendChild(s.createDom());return this.pointerMoveHandler=N(t,"pointermove",this,this.handlePointerMove,!0),this.clickHandler=N(t,"pointerup",this,this.handleClick,!0),this.pointerEnterHandler=N(t,"pointerenter",this,this.handlePointerEnter,!0),this.pointerLeaveHandler=N(t,"pointerleave",this,this.handlePointerLeave,!0),this.onKeyDownHandler=N(t,"keydown",this,this.handleKeyEvent),e.appendChild(t),t}getElement(){return this.element}focus(){const e=this.getElement();e&&e.focus({preventScroll:!0})}blur(){const e=this.getElement();e&&e.blur()}setRole(e){this.roleName=e}dispose(){this.pointerMoveHandler&&(J(this.pointerMoveHandler),this.pointerMoveHandler=null),this.clickHandler&&(J(this.clickHandler),this.clickHandler=null),this.pointerEnterHandler&&(J(this.pointerEnterHandler),this.pointerEnterHandler=null),this.pointerLeaveHandler&&(J(this.pointerLeaveHandler),this.pointerLeaveHandler=null),this.onKeyDownHandler&&(J(this.onKeyDownHandler),this.onKeyDownHandler=null);for(let t,e=0;t=this.menuItems[e];e++)t.dispose();this.element=null}getMenuItem(e){const t=this.getElement();for(;e&&e!==t;){if(e.classList.contains("blocklyMenuItem")){const i=this.getMenuItems();for(let n,s=0;n=i[s];s++)if(n.getElement()===e)return n}e=e.parentElement}return null}setHighlighted(e){var t=this.highlightedItem;if(t&&(t.setHighlighted(!1),this.highlightedItem=null),e){e.setHighlighted(!0),this.highlightedItem=e,t=this.getElement();const i=e.getElement();t&&i&&(fc(i,t),ye(t,xe.ACTIVEDESCENDANT,e.getId()))}}highlightNext(){const e=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(e,1)}highlightPrevious(){const e=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(e<0?this.menuItems.length:e,-1)}highlightFirst(){this.highlightHelper(-1,1)}highlightLast(){this.highlightHelper(this.menuItems.length,-1)}highlightHelper(e,t){let i;e+=t;const s=this.getMenuItems();for(;i=s[e];){if(i.isEnabled()){this.setHighlighted(i);break}e+=t}}handlePointerMove(e){0!==Math.max(Math.abs(e.movementX),Math.abs(e.movementY))&&(e=this.getMenuItem(e.target))&&(e.isEnabled()?this.highlightedItem!==e&&this.setHighlighted(e):this.setHighlighted(null))}handleClick(e){var t=this.openingCoords;if(this.openingCoords=null,t&&"number"==typeof e.clientX){const i=new k(e.clientX,e.clientY);if(k.distance(t,i)<1)return}(t=this.getMenuItem(e.target))&&t.performAction(e)}handlePointerEnter(e){this.focus()}handlePointerLeave(e){this.getElement()&&this.setHighlighted(null)}handleKeyEvent(e){if(this.menuItems.length&&!(e.shiftKey||e.ctrlKey||e.metaKey||e.altKey)){var t=this.highlightedItem;switch(e.key){case"Enter":case" ":t&&t.performAction(e);break;case"ArrowUp":this.highlightPrevious();break;case"ArrowDown":this.highlightNext();break;case"PageUp":case"Home":this.highlightFirst();break;case"PageDown":case"End":this.highlightLast();break;default:return}e.preventDefault(),e.stopPropagation()}}getSize(){const e=this.getElement(),t=mn(e);return t.height=e.scrollHeight,t}getMenuItems(){return this.menuItems.filter(e=>e instanceof Nl)}},np=class{constructor(){this.element=null}createDom(){return this.element=document.createElement("hr"),this.element.className="blocklyMenuSeparator",Ht(this.element,yt.SEPARATOR),this.element}dispose(){let e;null==(e=this.element)||e.remove(),this.element=null}},Kn="_TEMP_COLLAPSED_INPUT",Ll="_TEMP_COLLAPSED_FIELD",Mt="MANUALLY_DISABLED",X_={COLLAPSED_FIELD_NAME:Ll,COLLAPSED_INPUT_NAME:Kn,MANUALLY_DISABLED:Mt};!function(e){e[e.VALUE=1]="VALUE",e[e.STATEMENT=3]="STATEMENT",e[e.DUMMY=5]="DUMMY",e[e.CUSTOM=6]="CUSTOM",e[e.END_ROW=7]="END_ROW"}(o.inputTypes$$module$build$src$core$inputs$input_types||(o.inputTypes$$module$build$src$core$inputs$input_types={}));var ap,H$,Ha=new Set,rp=new WeakSet,lp=new WeakMap,Jn=null,cp=null,U$=0,Za={};Za.finishQueuedRenders=Zt,Za.queueRender=xc,Za.triggerQueuedRenders=wo,o.Msg$$module$build$src$core$msg=Object.create(null),ap=function(e){Object.keys(e).forEach(function(t){o.Msg$$module$build$src$core$msg[t]=e[t]})},H$={Msg:o.Msg$$module$build$src$core$msg,setLocale:ap};var Dl="blocklyToast",Z$="blocklyToastMessage",V$="blocklyToastCloseButton",Pi=class{static show(e,t){if(t.oncePerSession&&t.id){if(this.shownIds.has(t.id))return;this.shownIds.add(t.id)}this.hide(e);const i=this.createDom(e,t);requestAnimationFrame(()=>{i.style.bottom="2rem"})}static createDom(e,t){const{message:i,duration:s=5,assertiveness:n=Pi.Assertiveness.POLITE}=t,l=document.createElement("div");e.getInjectionDiv().appendChild(l),l.dataset.toastId=t.id,l.className=Dl,Ht(l,yt.STATUS),ye(l,xe.LIVE,n),(t=l.appendChild(document.createElement("div"))).className=Z$,t.innerText=i,(t=l.appendChild(document.createElement("button"))).className=V$,ye(t,xe.LABEL,o.Msg$$module$build$src$core$msg.CLOSE);var u=I(T.SVG,{width:24,height:24,viewBox:"0 0 24 24",fill:"none"},t);let $;return ye(u,xe.HIDDEN,!0),I(T.RECT,{x:19.7782,y:2.80762,width:2,height:24,transform:"rotate(45, 19.7782, 2.80762)",fill:"black"},u),I(T.RECT,{x:2.80762,y:4.22183,width:2,height:24,transform:"rotate(-45, 2.80762, 4.22183)",fill:"black"},u),t.addEventListener("click",()=>{l.remove(),e.markFocused()}),t=()=>{$=setTimeout(()=>l.remove(),1e3*s)},l.addEventListener("focusin",u=()=>clearTimeout($)),l.addEventListener("focusout",t),l.addEventListener("mouseenter",u),l.addEventListener("mousemove",u),l.addEventListener("mouseleave",t),t(),l}static hide(e,t){(e=e.getInjectionDiv().querySelector(`.${Dl}`))instanceof HTMLElement&&(!t||t===e.dataset.toastId)&&e.remove()}};Pi.shownIds=new Set,function(e){(e=e.Assertiveness||(e.Assertiveness={})).ASSERTIVE="assertive",e.POLITE="polite"}(Pi||(Pi={})),Ft(`\n.${Dl} {\n  font-size: 1.2rem;\n  position: absolute;\n  bottom: -10rem;\n  right: 2rem;\n  padding: 1rem;\n  color: black;\n  background-color: white;\n  border: 2px solid black;\n  border-radius: 0.4rem;\n  z-index: 999;\n  display: flex;\n  align-items: center;\n  gap: 0.8rem;\n  line-height: 1.5;\n  transition: bottom 0.3s ease-out;\n}\n\n.${Dl} .${Z$} {\n  maxWidth: 18rem;\n}\n\n.${Dl} .${V$} {\n  margin: 0;\n  padding: 0.2rem;\n  background-color: transparent;\n  color: black;\n  border: none;\n  cursor: pointer;\n}\n`);var G$=function(e,t){window.alert(e),t&&t()},W$=G$,q$=function(e,t){t(window.confirm(e))},z$=q$,j$=function(e,t,i){i(window.prompt(e,t))},Y$=j$,X$=Pi.show.bind(Pi),K$=X$,Wo={};Wo.alert=En,Wo.confirm=Ar,Wo.prompt=Rr,Wo.setAlert=_d,Wo.setConfirm=bd,Wo.setPrompt=fd,Wo.setToast=Ed,Wo.toast=Td;var J$={};J$.isLegacyProcedureCallBlock=Ac,J$.isLegacyProcedureDefBlock=pi;var Q$=new Set,em={};em.warn=Me;var Va="VARIABLE",up="ijkmnopqrstuvwxyzabcdefgh",tm={generateUniqueNameInternal:yd},Ce={CATEGORY_NAME:Va,TEST_ONLY:tm,VAR_LETTER_OPTIONS:up};Ce.allDeveloperVariables=o.allDeveloperVariables$$module$build$src$core$variables,Ce.allUsedVarModels=o.allUsedVarModels$$module$build$src$core$variables,Ce.compareByName=ds,Ce.createVariableButtonHandler=gi,Ce.deleteVariable=o.deleteVariable$$module$build$src$core$variables,Ce.flyoutCategory=Rc,Ce.flyoutCategoryBlocks=Oc,Ce.generateUniqueName=Mc,Ce.generateUniqueNameFromOptions=Dr,Ce.generateVariableFieldDom=$i,Ce.getAddedVariables=vn,Ce.getOrCreateVariablePackage=o.getOrCreateVariablePackage$$module$build$src$core$variables,Ce.getVariable=o.getVariable$$module$build$src$core$variables,Ce.getVariableUsesById=hs,Ce.internalFlyoutCategory=Mr,Ce.jsonFlyoutCategoryBlocks=Lr,Ce.nameUsedWithAnyType=Nc,Ce.nameUsedWithConflictingParam=Lc,Ce.promptName=Pr,Ce.renameVariable=o.renameVariable$$module$build$src$core$variables;var Qn=class extends Error{},om=class extends Qn{constructor(e){super("Expected to find a 'type' property, defining the block type"),this.state=e}},Pl=class extends Qn{constructor(e,t,i){super(`The block ${t.toDevString()} is missing a(n) ${e}\nconnection`),this.block=t,this.state=i}},im=class extends Qn{constructor(e,t,i,s){super(`The block ${i.toDevString()} could not connect its\n${t} to its parent, because: ${e}`),this.childBlock=i,this.childState=s}},sm=class extends Qn{constructor(e){super("Encountered a real block which is defined as a child of a shadow\nblock. It is an invariant of Blockly that shadow blocks only have shadow\nchildren"),this.state=e}},nm=class extends Qn{constructor(e,t,i){super(`Cannot add an icon of type '${e}' to the block ${t.toDevString()}, because there is no icon registered with type '${e}'. Make sure that all of your icons have been registered.`),this.block=t,this.state=i}},Us={};Us.BadConnectionCheck=im,Us.DeserializationError=Qn,Us.MissingBlockType=om,Us.MissingConnection=Pl,Us.RealChildOfShadow=sm,Us.UnregisteredIcon=nm;var rm=class{constructor(){this.priority=50}save(e){const t=[];for(const i of e.getTopBlocks(!1))(e=pt(i,{addCoordinates:!0,doFullSerialization:!1}))&&t.push(e);return t.length?{languageVersion:0,blocks:t}:null}load(e,t){e=e.blocks;for(const i of e)So(i,t,{recordUndo:Se()})}clear(e){for(const t of e.getTopBlocks(!1))t.dispose(!1)}};fn("blocks",new rm);var Bl={};Bl.BlockSerializer=rm,Bl.append=So,Bl.appendInternal=mi,Bl.save=pt;var ke=class{constructor(e){this.name=e}toString(){return this.name}equals(e){return this.name===e.toString()}};ke.MUTATOR=new ke("mutator"),ke.WARNING=new ke("warning"),ke.COMMENT=new ke("comment");var Bi=class extends Ds{constructor(e){super(),this.isBlank=!e,e&&(this.blockId=e.id,this.workspaceId=e.workspace.id)}toJson(){const e=super.toJson();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");return e.blockId=this.blockId,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new Bi)).blockId=e.blockId,t}},Fi=class extends Bi{constructor(e,t,i,s,n){super(e),this.type=f.BLOCK_CHANGE,e&&(this.element=t,this.name=i||void 0,this.oldValue=s,this.newValue=n)}toJson(){const e=super.toJson();if(!this.element)throw Error("The changed element is undefined. Either pass an element to the constructor, or call fromJson");return e.element=this.element,e.name=this.name,e.oldValue=this.oldValue,e.newValue=this.newValue,this.disabledReason&&(e.disabledReason=this.disabledReason),e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new Fi)).element=e.element,t.name=e.name,t.oldValue=e.oldValue,t.newValue=e.newValue,void 0!==e.disabledReason&&(t.disabledReason=e.disabledReason),t}setDisabledReason(e){if("disabled"!==this.element)throw Error('Cannot set the disabled reason for a BlockChange event if the element is not "disabled".');this.disabledReason=e}isNull(){return this.oldValue===this.newValue}run(e){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");if(!(t=t.getBlockById(this.blockId)))throw Error("The associated block is undefined. Either pass a block to the constructor, or call fromJson");const i=t.getIcon(ke.MUTATOR);switch(i&&Ao(i)&&i.bubbleIsVisible()&&i.setBubbleVisible(!1),e=e?this.newValue:this.oldValue,this.element){case"field":(t=t.getField(this.name))?t.setValue(e):console.warn("Can't set non-existent field: "+this.name);break;case"comment":t.setCommentText(e||null);break;case"collapsed":t.setCollapsed(!!e);break;case"disabled":var s;t.setDisabledReason(!!e,null!=(s=this.disabledReason)?s:Mt);break;case"inline":t.setInputsInline(!!e);break;case"mutation":s=Fi.getExtraBlockState_(t),t.loadExtraState?t.loadExtraState(JSON.parse(e||"{}")):t.domToMutation&&t.domToMutation(o.textToDom$$module$build$src$core$utils$xml(e||"<mutation/>")),D(new Fi(t,"mutation",null,s,e));break;default:console.warn("Unknown change type: "+this.element)}}static getExtraBlockState_(e){return e.saveExtraState?(e=e.saveExtraState(!0))?JSON.stringify(e):"":e.mutationToDom&&(e=e.mutationToDom())?nt(e):""}};U(x.EVENT,f.BLOCK_CHANGE,Fi);var Ga={};Ga.clamp=ps,Ga.toDegrees=Wd,Ga.toRadians=Br;var fe,Ul,Zs,Fl=16,dp=1,lm=12,hp=16,Wa=.25,pp=null,Hs=null,cm="",am="",gp=null,Ui=null,um=null,qa=null,za=null,ja={getBoundsInfo:function(){const e=ko(gp),t=mn(gp);return{left:e.x,right:e.x+t.width,top:e.y,bottom:e.y+t.height,width:t.width,height:t.height}},getPositionMetrics:function(e,t,i,s){const n=ja.getBoundsInfo(),l=mn(fe);return t+l.height<n.bottom?qc(e,t,n,l):s-l.height>n.top?zc(i,s,n,l):t+l.height<document.documentElement.clientHeight?qc(e,t,n,l):s-l.height>document.documentElement.clientTop?zc(i,s,n,l):zd(e,n,l)}},qe={ANIMATION_TIME:Wa,ARROW_HORIZONTAL_PADDING:lm,ARROW_SIZE:Fl,BORDER_SIZE:dp,PADDING_Y:hp,TEST_ONLY:ja};qe.clearContent=Hr,qe.createDom=Fr,qe.getContentDiv=Ur,qe.getOwner=Uc,qe.getPositionX=gs,qe.hide=Vr,qe.hideIfOwner=Zr,qe.hideWithoutAnimation=Vt,qe.isVisible=jc,qe.repositionForWindowResize=Xc,qe.setBoundsElement=Fc,qe.setColour=_i,qe.show=Wc,qe.showPositionedByBlock=qd,qe.showPositionedByField=Hc;var er={};er.commonWordPrefix=Kc,er.commonWordSuffix=Jc,er.isNumber=o.isNumber$$module$build$src$core$utils$string,er.shortestStringLength=yn,er.wrap=o.wrap$$module$build$src$core$utils$string;var Ya=void 0,Hl=!1,tr=!1,dm=50,hm=0,Vs=0,$p=0,mp=0,Nt=null,Zl=null,_p=0,bp=10,pm=10,gm=750,Xa=5,Ae=null,Ct={HOVER_MS:gm,LIMIT:dm,MARGINS:Xa,OFFSET_X:_p,OFFSET_Y:bp,RADIUS_OK:pm};Ct.bindMouseEvents=Cn,Ct.block=ms,Ct.createDom=ta,Ct.dispose=sa,Ct.getCustomTooltip=Kd,Ct.getDiv=Qd,Ct.getTooltipOfObject=$s,Ct.hide=Gt,Ct.isVisible=Jd,Ct.setCustomTooltip=Xd,Ct.unbindMouseEvents=oa,Ct.unblock=Wr;var fp=.45,Tp=.65,$m={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00"},Lt={};Lt.blend=Mo,Lt.getHsvSaturation=qr,Lt.getHsvValue=zr,Lt.hexToRgb=In,Lt.hsvToHex=Oo,Lt.hueToHex=jr,Lt.names=$m,Lt.parse=Ro,Lt.rgbToHex=_s,Lt.setHsvSaturation=aa,Lt.setHsvValue=ua;var Vl={};Vl.checkMessageReferences=da,Vl.parseBlockColour=bi,Vl.replaceMessageReferences=ge,Vl.tokenizeInterpolation=Yr;var ee=class{get size_(){return this.size}set size_(e){this.size=e}constructor(e,t,i){this.DEFAULT_VALUE=null,this.name=void 0,this.tooltip=this.validator_=null,this.size=new Y(0,0),this.constants_=this.mouseDownWrapper=this.textContent_=this.textElement_=this.borderRect_=this.fieldGroup_=null,this.disposed=!1,this.maxDisplayLength=50,this.sourceBlock_=null,this.enabled_=this.visible_=this.isDirty_=!0,this.suffixField=this.prefixField=this.clickTarget_=null,this.EDITABLE=!0,this.SERIALIZABLE=!1,this.id_=null,this.value_="DEFAULT_VALUE"in new.target.prototype?new.target.prototype.DEFAULT_VALUE:this.DEFAULT_VALUE,this.size_=new Y(0,0),e!==ee.SKIP_SETUP&&(i&&this.configure_(i),this.setValue(e),t&&this.setValidator(t))}configure_(e){e.tooltip&&this.setTooltip(ge(e.tooltip))}setSourceBlock(e){if(this.sourceBlock_)throw Error("Field already bound to a block");if(this.sourceBlock_=e,e.id.includes("_field"))throw Error(`Field ID indicator is contained in block ID. This may cause problems with focus: ${e.id}.`);this.id_=`${e.id}_field_${Ee()}`}getConstants(){return!this.constants_&&this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&this.sourceBlock_.workspace.rendered&&(this.constants_=this.sourceBlock_.workspace.getRenderer().getConstants()),this.constants_}getSourceBlock(){return this.sourceBlock_}init(){if(!this.fieldGroup_){var e=this.id_;if(!e)throw Error("Expected ID to be defined prior to init.");this.fieldGroup_=I(T.G,{id:e}),this.isVisible()||(this.fieldGroup_.style.display="none"),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.initView(),this.updateEditable(),this.setTooltip(this.tooltip),this.bindEvents_(),this.initModel(),this.applyColour()}}initView(){this.createBorderRect_(),this.createTextElement_(),this.fieldGroup_&&R(this.fieldGroup_,"blocklyField")}initModel(){}isFullBlockField(){return!this.borderRect_}createBorderRect_(){this.borderRect_=I(T.RECT,{rx:this.getConstants().FIELD_BORDER_RECT_RADIUS,ry:this.getConstants().FIELD_BORDER_RECT_RADIUS,x:0,y:0,height:this.size_.height,width:this.size_.width,class:"blocklyFieldRect"},this.fieldGroup_)}createTextElement_(){this.textElement_=I(T.TEXT,{class:"blocklyText blocklyFieldText"},this.fieldGroup_),this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.textElement_.setAttribute("dominant-baseline","central"),this.textContent_=document.createTextNode(""),this.textElement_.appendChild(this.textContent_)}bindEvents_(){const e=this.getClickTarget_();if(!e)throw Error("A click target has not been set.");Cn(e),this.mouseDownWrapper=N(e,"pointerdown",this,this.onMouseDown_)}fromXml(e){this.setValue(e.textContent)}toXml(e){return e.textContent=this.getValue(),e}saveState(e){return null!==(e=this.saveLegacyState(ee))?e:this.getValue()}loadState(e){this.loadLegacyState(ee,e)||this.setValue(e)}saveLegacyState(e){return e.prototype.saveState===this.saveState&&e.prototype.toXml!==this.toXml?((e=o.createElement$$module$build$src$core$utils$xml("field")).setAttribute("name",this.name||""),as(this.toXml(e)).replace(' xmlns="https://developers.google.com/blockly/xml"',"")):null}loadLegacyState(e,t){return e.prototype.loadState===this.loadState&&e.prototype.fromXml!==this.fromXml&&(this.fromXml(o.textToDom$$module$build$src$core$utils$xml(t)),!0)}dispose(){let e;Zr(this),No(this),null!=(e=this.getSourceBlock())&&e.isDeadOrDying()||Q(this.fieldGroup_),this.disposed=!0}updateEditable(){const e=this.fieldGroup_,t=this.getSourceBlock();this.EDITABLE&&e&&t&&(this.enabled_&&t.isEditable()?(R(e,"blocklyEditableField"),X(e,"blocklyNonEditableField")):(R(e,"blocklyNonEditableField"),X(e,"blocklyEditableField")))}setEnabled(e){this.enabled_=e,this.updateEditable()}isEnabled(){return this.enabled_}isClickable(){return this.enabled_&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()&&this.showEditor_!==ee.prototype.showEditor_}isClickableInFlyout(e){return!e}isCurrentlyEditable(){return this.enabled_&&this.EDITABLE&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()}isSerializable(){let e=!1;return this.name&&(this.SERIALIZABLE?e=!0:this.EDITABLE&&(console.warn("Detected an editable field that was not serializable. Please define SERIALIZABLE property as true on all editable custom fields. Proceeding with serialization."),e=!0)),e}isVisible(){return this.visible_}setVisible(e){if(this.visible_!==e){this.visible_=e;var t=this.fieldGroup_;t&&(t.style.display=e?"block":"none")}}setValidator(e){this.validator_=e}getValidator(){return this.validator_}getSvgRoot(){return this.fieldGroup_}getBorderRect(){if(!this.borderRect_)throw Error(`The border rectangle is ${this.borderRect_}.`);return this.borderRect_}getTextElement(){if(!this.textElement_)throw Error(`The text element is ${this.textElement_}.`);return this.textElement_}getTextContent(){if(!this.textContent_)throw Error(`The text content is ${this.textContent_}.`);return this.textContent_}applyColour(){}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_()}showEditor(e){this.isClickable()&&this.showEditor_(e)}showEditor_(e){}repositionForWindowResize(){return!1}updateSize_(e){const t=this.getConstants();let i=2*(e=void 0!==e?e:this.isFullBlockField()?0:this.getConstants().FIELD_BORDER_RECT_X_PADDING),s=t.FIELD_TEXT_HEIGHT,n=0;this.textElement_&&(n=A(this.textElement_),i+=n),this.isFullBlockField()||(s=Math.max(s,t.FIELD_BORDER_RECT_HEIGHT)),this.size_.height=s,this.size_.width=i,this.positionTextElement_(e,n),this.positionBorderRect_()}positionTextElement_(e,t){if(this.textElement_){var n,i=this.getConstants(),s=this.size_.height/2;this.textElement_.setAttribute("x",String(null!=(n=this.getSourceBlock())&&n.RTL?this.size_.width-t-e:e)),this.textElement_.setAttribute("y",String(i.FIELD_TEXT_BASELINE_CENTER?s:s-i.FIELD_TEXT_HEIGHT/2+i.FIELD_TEXT_BASELINE))}}positionBorderRect_(){this.borderRect_&&(this.borderRect_.setAttribute("width",String(this.size_.width)),this.borderRect_.setAttribute("height",String(this.size_.height)),this.borderRect_.setAttribute("rx",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)),this.borderRect_.setAttribute("ry",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)))}getSize(){return this.isVisible()?(this.isDirty_&&(this.render_(),this.isDirty_=!1),this.size_):new Y(0,0)}getScaledBBox(){let e;var t=this.getSourceBlock();if(!t)throw new Te;if(this.isFullBlockField()){var i=this.sourceBlock_.getHeightWidth();const s=t.workspace.scale;e=this.getAbsoluteXY_(),t=(i.width+1)*s,i=(i.height+1)*s,g$?(e.x+=1.5*s,e.y+=1.5*s):(e.x-=.5*s,e.y-=.5*s)}else i=this.borderRect_.getBoundingClientRect(),e=ko(this.borderRect_),t=i.width,i=i.height;return new j(e.y,e.y+i,e.x,e.x+t)}onLocationChange(e){}getDisplayText_(){let e=this.getText();return e.length>this.maxDisplayLength&&(e=e.substring(0,this.maxDisplayLength-2)+"\u2026"),e=e.replace(/\s/g,ee.NBSP),this.sourceBlock_&&this.sourceBlock_.RTL&&(e+="\u200f"),e}getText(){const e=this.getText_();return String(null!==e?e:this.getValue())}getText_(){return null}markDirty(){this.isDirty_=!0,this.constants_=null}forceRerender(){this.isDirty_=!0,this.sourceBlock_&&this.sourceBlock_.rendered&&this.sourceBlock_.queueRender()}setValue(e,t=!0){if(null!==e){var i=o.getGroup$$module$build$src$core$events$utils();i||o.setGroup$$module$build$src$core$events$utils(!0);try{const C=this.doClassValidation_(e),F=this.processValidation(e,C,t);if(!(F instanceof Error)){var s,n=null==(s=this.getValidator())?void 0:s.call(this,F),l=this.processValidation(F,n,t);if(!(l instanceof Error)){var u=this.sourceBlock_;if(!u||!u.disposed){var $=this.getValue();$===l?this.doValueUpdate_(l):(this.doValueUpdate_(l),t&&u&&ne()&&D(new(P(f.BLOCK_CHANGE))(u,"field",this.name||null,$,l)),this.isDirty_&&this.forceRerender())}}}}finally{o.setGroup$$module$build$src$core$events$utils(i)}}}processValidation(e,t,i){return null===t?(this.doValueInvalid_(e,i),this.isDirty_&&this.forceRerender(),Error()):void 0===t?e:t}getValue(){return this.value_}doClassValidation_(e){return e??null}doValueUpdate_(e){this.value_=e,this.isDirty_=!0}doValueInvalid_(e,t){}onMouseDown_(e){this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&(e=this.sourceBlock_.workspace.getGesture(e))&&e.setStartField(this)}setTooltip(e){e||""===e||(e=this.sourceBlock_);const t=this.getClickTarget_();t?t.tooltip=e:this.tooltip=e}getTooltip(){const e=this.getClickTarget_();return $s(e||{tooltip:this.tooltip})}getClickTarget_(){return this.clickTarget_||this.getSvgRoot()}getAbsoluteXY_(){return ko(this.getClickTarget_())}referencesVariables(){return!1}refreshVariableName(){}getParentInput(){let e=null;const t=this.getSourceBlock();if(!t)throw new Te;const i=t.inputList;for(let s=0;s<t.inputList.length;s++){const n=i[s],l=n.fieldRow;for(let u=0;u<l.length;u++)if(l[u]===this){e=n;break}}return e}getFlipRtl(){return!1}onShortcut(e){return!1}getFocusableElement(){if(!this.fieldGroup_)throw Error("This field currently has no representative DOM element.");return this.fieldGroup_}getFocusableTree(){const e=this.getSourceBlock();if(!e)throw new Te;return e.workspace}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}static fromJson(e){throw Error("Attempted to instantiate a field from the registry that hasn't defined a 'fromJson' method.")}};ee.NBSP="\xa0",ee.SKIP_SETUP=Symbol("SKIP_SETUP");var Te=class extends Error{constructor(){super("The field has not yet been attached to its input. Call appendField to attach it.")}},mm={};mm.Field=ee,mm.UnattachedFieldError=Te;var It,or=null,_m=null,Ka=null,Ep="blocklyWidgetDiv",ir="",sr="",Ja=null,Xt={};Xt.createDom=Xr,Xt.getDiv=fi,Xt.hide=Ti,Xt.hideIfOwner=No,Xt.hideIfOwnerIsInWorkspace=bs,Xt.isVisible=Kr,Xt.positionWithAnchor=Qr,Xt.repositionForWindowResize=el,Xt.show=kn,Xt.testOnly_setDiv=ha;var Qa=null,bm={},eu=null,Gs={};Gs.callbackFactory=o.callbackFactory$$module$build$src$core$contextmenu,Gs.dispose=ol,Gs.getCurrentBlock=ma,Gs.hide=fs,Gs.setCurrentBlock=tl,Gs.show=Ei;var q=class{constructor(){this.registeredItems=new Map,this.reset()}reset(){this.registeredItems.clear()}register(e){if(this.registeredItems.has(e.id))throw Error('Menu item with ID "'+e.id+'" is already registered.');this.registeredItems.set(e.id,e)}unregister(e){if(!this.registeredItems.has(e))throw Error('Menu item with ID "'+e+'" not found.');this.registeredItems.delete(e)}getItem(e){let t;return null!=(t=this.registeredItems.get(e))?t:null}getContextMenuOptions(e,t){const i=[];for(const s of this.registeredItems.values()){if(s.scopeType&&(s.scopeType===tu.BLOCK&&!e.block||s.scopeType===tu.COMMENT&&!e.comment||s.scopeType===tu.WORKSPACE&&!e.workspace))continue;let n;if(n={scope:e,weight:s.weight},s.separator)n=Object.assign({},n,{separator:!0});else{const l=s.preconditionFn(e,t);if("hidden"===l)continue;const u="function"==typeof s.displayText?s.displayText(e):s.displayText;n=Object.assign({},n,{text:u,callback:s.callback,enabled:"enabled"===l})}i.push(n)}return i.sort(function(s,n){return s.weight-n.weight}),i}};!function(e){var t=e.ScopeType||(e.ScopeType={});t.BLOCK="block",t.WORKSPACE="workspace",t.COMMENT="comment",e.registry=new e}(q||(q={}));var tu=q.ScopeType,fm={};fm.ContextMenuRegistry=q,fm.ScopeType=tu;var nb={BLOCK:50,BUBBLE:100},vp=class{constructor(e){this.comment=e,this.startLoc=null,this.workspace=e.workspace}isMovable(){return this.comment.isOwnMovable()&&!this.comment.isDeadOrDying()&&!this.workspace.isReadOnly()}startDrag(){let e;this.fireDragStartEvent(),this.startLoc=this.comment.getRelativeToSurfaceXY(),this.workspace.setResizesEnabled(!1),null==(e=this.workspace.getLayerManager())||e.moveToDragLayer(this.comment),this.comment.setDragging(!0)}drag(e){this.comment.moveDuringDrag(e)}endDrag(){let e;this.fireDragEndEvent(),this.fireMoveEvent(),null==(e=this.workspace.getLayerManager())||e.moveOffDragLayer(this.comment,50),this.comment.setDragging(!1),this.comment.snapToGrid(),this.workspace.setResizesEnabled(!0)}fireDragStartEvent(){const e=new(P(f.COMMENT_DRAG))(this.comment,!0);D(e)}fireDragEndEvent(){const e=new(P(f.COMMENT_DRAG))(this.comment,!1);D(e)}fireMoveEvent(){if(!this.comment.isDeadOrDying()){var e=new(P(f.COMMENT_MOVE))(this.comment);e.setReason(["drag"]),e.oldCoordinate_=this.startLoc,e.recordNew(),D(e)}}revertDrag(){this.startLoc&&this.comment.moveDuringDrag(this.startLoc)}},Tm=new WeakMap,Em={};Em.move=w,Em.start=h;var Gl=class{constructor(e,t,i){this.id=e,this.workspace=t,this.container=i}isVisible(){return this.icon.checkVisibility()}getParentComment(){const e=this.workspace.getCommentById(this.id);if(!e)throw Error(`Comment bar button ${this.id} has no corresponding comment`);return e}getSize(e=!1){var t=this.icon.getBBox();return t=j.from(t),e&&(e=this.getMargin(),t.left-=e,t.top-=e,t.bottom+=e,t.right+=e),t}getMargin(){return(this.container.getBBox().height-this.icon.getBBox().height)/2}getFocusableElement(){return this.icon}getFocusableTree(){return this.workspace}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return this.isVisible()}},yp="_collapse_bar_button",Cp=class extends Gl{constructor(e,t,i){super(e,t,i),this.id=e,this.workspace=t,this.container=i,this.icon=I(T.IMAGE,{class:"blocklyFoldoutIcon",href:`${this.workspace.options.pathToMedia}foldout-icon.svg`,id:`${this.id}${yp}`},this.container),this.bindId=N(this.icon,"pointerdown",this,this.performAction.bind(this))}dispose(){J(this.bindId)}reposition(){const e=this.getMargin();this.icon.setAttribute("y",`${e}`),this.icon.setAttribute("x",`${e}`)}performAction(e){Oe();const t=this.getParentComment();t.view.bringToFront(),e&&e instanceof PointerEvent&&it(e)||(t.setCollapsed(!t.isCollapsed()),this.workspace.hideChaff()),e.stopPropagation()}};({COMMENT_COLLAPSE_BAR_BUTTON_FOCUS_IDENTIFIER:yp}).CollapseCommentBarButton=Cp;var iu="_comment_textarea_",Ip=class{constructor(e,t,i){this.workspace=e,this.onFinishEditing=i,this.textChangeListeners=[],this.text="",this.foreignObject=I(T.FOREIGNOBJECT,{class:"blocklyCommentForeignObject"}),(e=document.createElementNS(go,"body")).setAttribute("xmlns",go),e.className="blocklyMinimalBody",this.textArea=document.createElementNS(go,"textarea"),this.textArea.setAttribute("tabindex","-1"),R(this.textArea,"blocklyCommentText"),R(this.textArea,"blocklyTextarea"),R(this.textArea,"blocklyText"),e.appendChild(this.textArea),this.foreignObject.appendChild(e),t&&(this.id=t+iu,this.textArea.setAttribute("id",this.id)),N(this.textArea,"change",this,this.onTextChange),N(this.textArea,"pointerdown",this,s=>{s.stopPropagation(),o.getFocusManager$$module$build$src$core$focus_manager().focusNode(this),Oe()}),N(this.textArea,"keydown",this,this.handleKeyDown)}getDom(){return this.foreignObject}getText(){return this.text}setText(e){this.textArea.value=e,this.onTextChange()}onTextChange(){const e=this.text;this.text=this.textArea.value;for(let t=this.textChangeListeners.length-1;t>=0;t--)this.textChangeListeners[t](e,this.text)}handleKeyDown(e){("Escape"===e.key||"Enter"===e.key&&(e.ctrlKey||e.metaKey))&&(this.onFinishEditing&&this.onFinishEditing(),e.stopPropagation())}addTextChangeListener(e){this.textChangeListeners.push(e)}removeTextChangeListener(e){this.textChangeListeners.splice(this.textChangeListeners.indexOf(e),1)}setPlaceholderText(e){this.textArea.placeholder=e}setEditable(e){e?this.textArea.removeAttribute("readonly"):this.textArea.setAttribute("readonly","true")}updateSize(e,t){this.foreignObject.setAttribute("height",""+(e.height-t.height)),this.foreignObject.setAttribute("width",`${e.width}`),this.foreignObject.setAttribute("y",`${t.height}`),this.workspace.RTL&&this.foreignObject.setAttribute("x",""+-e.width)}getFocusableElement(){return this.textArea}getFocusableTree(){return this.workspace}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!!this.id}};({COMMENT_EDITOR_FOCUS_IDENTIFIER:iu}).CommentEditor=Ip;var xp="_delete_bar_button",kp=class extends Gl{constructor(e,t,i){super(e,t,i),this.id=e,this.workspace=t,this.container=i,this.icon=I(T.IMAGE,{class:"blocklyDeleteIcon",href:`${this.workspace.options.pathToMedia}delete-icon.svg`,id:`${this.id}${xp}`},i),this.bindId=N(this.icon,"pointerdown",this,this.performAction.bind(this))}dispose(){J(this.bindId)}reposition(){const e=this.getMargin();this.icon.setAttribute("x","0");const t=this.container.getBBox();this.icon.setAttribute("y",`${e}`),this.icon.setAttribute("x",""+(t.width-this.getSize(!0).getWidth()))}performAction(e){Oe(),e&&e instanceof PointerEvent&&it(e)?e.stopPropagation():(this.getParentComment().dispose(),e?.stopPropagation(),o.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.workspace))}};({COMMENT_DELETE_BAR_BUTTON_FOCUS_IDENTIFIER:xp}).DeleteCommentBarButton=kp;var nr=class{constructor(e,t){let i;this.workspace=e,this.commentId=t,this.collapsed=!1,this.editable=!0,this.location=new k(0,0),this.sizeChangeListeners=[],this.disposeListeners=[],this.collapseChangeListeners=[],this.resizePointerMoveListener=this.resizePointerUpListener=null,this.disposed=this.disposing=!1,this.svgRoot=I(T.G,{class:"blocklyComment blocklyEditable blocklyDraggable"}),this.highlightRect=this.createHighlightRect(this.svgRoot),({topBarGroup:this.topBarGroup,topBarBackground:this.topBarBackground,deleteButton:this.deleteButton,foldoutButton:this.foldoutButton,textPreview:this.textPreview,textPreviewNode:this.textPreviewNode}=this.createTopBar(this.svgRoot)),this.commentEditor=this.createTextArea(),this.resizeHandle=this.createResizeHandle(this.svgRoot,e),null==(i=e.getLayerManager())||i.append(this,50),this.size=nr.defaultCommentSize,this.setSizeWithoutFiringEvents(this.size),this.moveTo(new k(0,0))}createHighlightRect(e){return I(T.RECT,{class:"blocklyCommentHighlight"},e)}createTopBar(e){e=I(T.G,{class:"blocklyCommentTopbar"},e);const t=I(T.RECT,{class:"blocklyCommentTopbarBackground"},e),i=new kp(this.commentId,this.workspace,e),s=new Cp(this.commentId,this.workspace,e),n=I(T.TEXT,{class:"blocklyCommentPreview blocklyCommentText blocklyText"},e),l=document.createTextNode("");return n.appendChild(l),{topBarGroup:e,topBarBackground:t,deleteButton:i,foldoutButton:s,textPreview:n,textPreviewNode:l}}createTextArea(){const e=new Ip(this.workspace,this.commentId,()=>this.svgRoot.focus());return this.svgRoot.appendChild(e.getDom()),e.addTextChangeListener((t,i)=>{this.updateTextPreview(i),this.setSize(this.size)}),e}getEditorFocusableNode(){return this.commentEditor}createResizeHandle(e,t){return e=I(T.IMAGE,{class:"blocklyResizeHandle",href:`${t.options.pathToMedia}resize-handle.svg`},e),N(e,"pointerdown",this,this.onResizePointerDown),e}getSvgRoot(){return this.svgRoot}getSize(){return this.collapsed?this.topBarBackground.getBBox():this.size}setSizeWithoutFiringEvents(e){const t=this.topBarBackground.getBBox(),i=this.textPreview.getBBox(),s=this.resizeHandle.getBBox();this.size=e=Y.max(e,this.calcMinSize(t)),this.svgRoot.setAttribute("height",`${e.height}`),this.svgRoot.setAttribute("width",`${e.width}`),this.updateHighlightRect(e),this.updateTopBarSize(e),this.commentEditor.updateSize(e,t),this.deleteButton.reposition(),this.foldoutButton.reposition(),this.updateTextPreviewSize(e,t,i),this.updateResizeHandlePosition(e,s)}setSize(e){const t=this.preResizeSize||this.size;this.setSizeWithoutFiringEvents(e),this.onSizeChange(t,this.size)}calcMinSize(e){var t;this.updateTextPreview(null!=(t=this.commentEditor.getText())?t:"");let i=t=A(this.textPreview);return this.foldoutButton.isVisible()?i+=this.foldoutButton.getSize(!0).getWidth():t&&(i+=4),this.deleteButton.isVisible()?i+=this.deleteButton.getSize(!0).getWidth():t&&(i+=4),new Y(i,e.height+20)}updateHighlightRect(e){this.highlightRect.setAttribute("height",`${e.height}`),this.highlightRect.setAttribute("width",`${e.width}`),this.workspace.RTL&&this.highlightRect.setAttribute("x",""+-e.width)}updateTopBarSize(e){this.topBarBackground.setAttribute("width",`${e.width}`)}updateTextPreviewSize(e,t,i){t=(t.height-i.height)/2;const s=this.foldoutButton.getSize(!0),n=this.deleteButton.getSize(!0);e=e.width-s.getWidth()-n.getWidth(),this.textPreview.setAttribute("x",`${s.getWidth()}`),this.textPreview.setAttribute("y",`${t+i.height/2}`),this.textPreview.setAttribute("width",`${e}`)}updateResizeHandlePosition(e,t){this.resizeHandle.setAttribute("y",""+(e.height-t.height)),this.resizeHandle.setAttribute("x",""+(e.width-t.width))}onSizeChange(e,t){for(let i=this.sizeChangeListeners.length-1;i>=0;i--)this.sizeChangeListeners[i](e,t)}addSizeChangeListener(e){this.sizeChangeListeners.push(e)}removeSizeChangeListener(e){this.sizeChangeListeners.splice(this.sizeChangeListeners.indexOf(e),1)}onResizePointerDown(e){this.isEditable()&&(this.bringToFront(),it(e)||(this.preResizeSize=this.getSize(),h(this.workspace,e,new k(this.workspace.RTL?-this.getSize().width:this.getSize().width,this.getSize().height)),this.resizePointerUpListener=N(document,"pointerup",this,this.onResizePointerUp),this.resizePointerMoveListener=N(document,"pointermove",this,this.onResizePointerMove),this.workspace.hideChaff()),e.stopPropagation())}onResizePointerUp(e){Oe(),this.resizePointerUpListener&&(J(this.resizePointerUpListener),this.resizePointerUpListener=null),this.resizePointerMoveListener&&(J(this.resizePointerMoveListener),this.resizePointerMoveListener=null),this.setSize(this.size),this.preResizeSize=void 0}onResizePointerMove(e){e=w(this.workspace,e),this.setSizeWithoutFiringEvents(new Y(this.workspace.RTL?-e.x:e.x,e.y))}isCollapsed(){return this.collapsed}setCollapsed(e){(this.collapsed=e)?R(this.svgRoot,"blocklyCollapsed"):X(this.svgRoot,"blocklyCollapsed"),this.setSizeWithoutFiringEvents(this.size),this.onCollapse()}onCollapse(){for(let e=this.collapseChangeListeners.length-1;e>=0;e--)this.collapseChangeListeners[e](this.collapsed)}addOnCollapseListener(e){this.collapseChangeListeners.push(e)}removeOnCollapseListener(e){this.collapseChangeListeners.splice(this.collapseChangeListeners.indexOf(e),1)}isEditable(){return this.editable}setEditable(e){(this.editable=e)?(R(this.svgRoot,"blocklyEditable"),X(this.svgRoot,"blocklyReadonly")):(X(this.svgRoot,"blocklyEditable"),R(this.svgRoot,"blocklyReadonly")),this.commentEditor.setEditable(e)}getRelativeToSurfaceXY(){return this.location}moveTo(e){this.location=e,this.svgRoot.setAttribute("transform",`translate(${e.x}, ${e.y})`)}getText(){return this.commentEditor.getText()}setText(e){this.commentEditor.setText(e)}setPlaceholderText(e){this.commentEditor.setPlaceholderText(e)}addTextChangeListener(e){this.commentEditor.addTextChangeListener(e)}removeTextChangeListener(e){this.commentEditor.removeTextChangeListener(e)}updateTextPreview(e){this.textPreviewNode.textContent=this.truncateText(e)}truncateText(e){return e.length>=12?`${e.substring(0,9)}...`:e}bringToFront(){const e=this.svgRoot.parentNode,t=e.childNodes;t[t.length-1]!==this.svgRoot&&e.appendChild(this.svgRoot)}onDeleteDown(e){Oe(),it(e)||this.dispose(),e.stopPropagation()}dispose(){this.disposing=!0,this.foldoutButton.dispose(),this.deleteButton.dispose(),Q(this.svgRoot);for(let e=this.disposeListeners.length-1;e>=0;e--)this.disposeListeners[e]();this.disposed=!0}isDisposed(){return this.disposed}isDeadOrDying(){return this.disposing||this.disposed}addDisposeListener(e){this.disposeListeners.push(e)}removeDisposeListener(e){this.disposeListeners.splice(this.disposeListeners.indexOf(e),1)}getCommentBarButtons(){return[this.foldoutButton,this.deleteButton]}};nr.defaultCommentSize=new Y(120,100),Ft("\n.injectionDiv {\n  --commentFillColour: #FFFCC7;\n  --commentBorderColour: #F2E49B;\n}\n\n.blocklyComment .blocklyTextarea {\n  background-color: var(--commentFillColour);\n  border: 1px solid var(--commentBorderColour);\n  box-sizing: border-box;\n  display: block;\n  outline: 0;\n  padding: 5px;\n  resize: none;\n  width: 100%;\n  height: 100%;\n}\n\n.blocklyReadonly.blocklyComment .blocklyTextarea {\n  cursor: inherit;\n}\n\n.blocklyDeleteIcon {\n  width: 20px;\n  height: 20px;\n  display: none;\n  cursor: pointer;\n}\n\n.blocklyFoldoutIcon {\n  width: 20px;\n  height: 20px;\n  transform-origin: 12px 12px;\n  cursor: pointer;\n}\n.blocklyResizeHandle {\n  width: 12px;\n  height: 12px;\n  cursor: se-resize;\n}\n.blocklyReadonly.blocklyComment .blocklyResizeHandle {\n  cursor: inherit;\n}\n\n.blocklyCommentTopbarBackground {\n  fill: var(--commentBorderColour);\n  height: 24px;\n}\n\n.blocklyComment .blocklyCommentPreview.blocklyText {\n  fill: #000;\n  dominant-baseline: middle;\n  visibility: hidden;\n}\n\n.blocklyCollapsed.blocklyComment .blocklyCommentPreview {\n  visibility: visible;\n}\n\n.blocklyCollapsed.blocklyComment .blocklyCommentForeignObject,\n.blocklyCollapsed.blocklyComment .blocklyResizeHandle {\n  display: none;\n}\n\n.blocklyCollapsed.blocklyComment .blocklyFoldoutIcon {\n  transform: rotate(-90deg);\n}\n\n.blocklyRTL .blocklyCommentTopbar {\n  transform: scale(-1, 1);\n}\n\n.blocklyRTL .blocklyCommentForeignObject {\n  direction: rtl;\n}\n\n.blocklyRTL .blocklyCommentPreview {\n  /* Revert the scale and control RTL using direction instead. */\n  transform: scale(-1, 1);\n  direction: rtl;\n}\n\n.blocklyRTL .blocklyResizeHandle {\n  transform: scale(-1, 1);\n  cursor: sw-resize;\n}\n\n.blocklyCommentHighlight {\n  fill: none;\n}\n\n.blocklyCommentText.blocklyActiveFocus {\n  border-color: #fc3;\n  border-width: 2px;\n}\n\n.blocklySelected .blocklyCommentHighlight {\n  stroke: #fc3;\n  stroke-width: 3px;\n}\n\n.blocklyCollapsed.blocklySelected .blocklyCommentHighlight {\n  stroke: none;\n}\n\n.blocklyCollapsed.blocklySelected .blocklyCommentTopbarBackground {\n  stroke: #fc3;\n  stroke-width: 3px;\n}\n");var Wl=class{constructor(e,t){this.workspace=e,this.text="",this.collapsed=!1,this.deletable=this.movable=this.editable=!0,this.location=new k(0,0),this.disposing=this.disposed=!1,this.id=t&&!e.getCommentById(t)?t:ve(),this.size=nr.defaultCommentSize,e.addTopComment(this),this.fireCreateEvent()}fireCreateEvent(){ne()&&D(new(P(f.COMMENT_CREATE))(this))}fireDeleteEvent(){ne()&&D(new(P(f.COMMENT_DELETE))(this))}fireChangeEvent(e,t){ne()&&D(new(P(f.COMMENT_CHANGE))(this,e,t))}fireCollapseEvent(e){ne()&&D(new(P(f.COMMENT_COLLAPSE))(this,e))}setText(e){const t=this.text;this.text=e,this.fireChangeEvent(t,e)}getText(){return this.text}setSize(e){const t=new(P(f.COMMENT_RESIZE))(this);this.size=e,t.recordCurrentSizeAsNewSize(),D(t)}getSize(){return this.size}setCollapsed(e){this.collapsed=e,this.fireCollapseEvent(e)}isCollapsed(){return this.collapsed}setEditable(e){this.editable=e}isEditable(){return this.isOwnEditable()&&!this.workspace.isReadOnly()}isOwnEditable(){return this.editable}setMovable(e){this.movable=e}isMovable(){return this.isOwnMovable()&&!this.workspace.isReadOnly()&&!this.workspace.isFlyout}isOwnMovable(){return this.movable}setDeletable(e){this.deletable=e}isDeletable(){return this.isOwnDeletable()&&!this.isDeadOrDying()&&!this.workspace.isReadOnly()&&!this.workspace.isFlyout}isOwnDeletable(){return this.deletable}moveTo(e,t){const i=new(P(f.COMMENT_MOVE))(this);t&&i.setReason(t),this.location=e,i.recordNew(),D(i)}getRelativeToSurfaceXY(){return this.location}dispose(){this.disposing=!0,this.fireDeleteEvent(),this.workspace.removeTopComment(this),this.disposed=!0}isDisposed(){return this.disposed}isDeadOrDying(){return this.disposing||this.disposed}},Kt=class extends Wl{constructor(e,t){super(e,t),this.dragStrategy=new vp(this),this.workspace=e,this.view=new nr(e,this.id),this.view.setSize(this.getSize()),this.view.setEditable(this.isEditable()),this.view.getSvgRoot().setAttribute("data-id",this.id),this.view.getSvgRoot().setAttribute("id",this.id),this.addModelUpdateBindings(),N(this.view.getSvgRoot(),"pointerdown",this,this.startGesture),N(this.view.getSvgRoot(),"wheel",this,i=>{i.stopPropagation()})}addModelUpdateBindings(){this.view.addTextChangeListener((e,t)=>{super.setText(t)}),this.view.addSizeChangeListener((e,t)=>{super.setSize(t)}),this.view.addOnCollapseListener(()=>{super.setCollapsed(this.view.isCollapsed())}),this.view.addDisposeListener(()=>{this.isDeadOrDying()||this.dispose()})}setText(e){this.view.setText(e)}setPlaceholderText(e){this.view.setPlaceholderText(e)}setSize(e){this.view.setSize(e)}setCollapsed(e){this.view.setCollapsed(e)}setEditable(e){super.setEditable(e),this.view.setEditable(this.isEditable())}getSvgRoot(){return this.view.getSvgRoot()}getSize(){return super.getSize()}getBoundingRectangle(){const e=this.getRelativeToSurfaceXY();var t,i;const s=null!=(i=null==(t=this.view)?void 0:t.getSize())?i:this.getSize();return this.workspace.RTL?(t=e.x-s.width,i=e.x):(t=e.x,i=e.x+s.width),new j(e.y,e.y+s.height,t,i)}moveBy(e,t,i){const s=this.getRelativeToSurfaceXY();e=new k(s.x+e,s.y+t),this.moveTo(e,i)}moveTo(e,t){super.moveTo(e,t),this.view.moveTo(e)}moveDuringDrag(e){this.location=e,this.view.moveTo(e)}setDragging(e){e?R(this.getSvgRoot(),"blocklyDragging"):X(this.getSvgRoot(),"blocklyDragging")}dispose(){this.disposing=!0;const e=o.getFocusManager$$module$build$src$core$focus_manager();e.getFocusedNode()===this&&setTimeout(()=>e.focusTree(this.workspace),0),this.view.isDeadOrDying()||this.view.dispose(),super.dispose()}startGesture(e){const t=this.workspace.getGesture(e);t&&(t.handleCommentStart(e,this),o.getFocusManager$$module$build$src$core$focus_manager().focusNode(this))}setDeleteStyle(e){e?R(this.getSvgRoot(),"blocklyDraggingDelete"):X(this.getSvgRoot(),"blocklyDraggingDelete")}isCopyable(){return this.isOwnMovable()&&this.isOwnDeletable()}isMovable(){return this.dragStrategy.isMovable()}startDrag(){this.dragStrategy.startDrag()}drag(e){this.dragStrategy.drag(e)}endDrag(){this.dragStrategy.endDrag()}revertDrag(){this.dragStrategy.revertDrag()}select(){R(this.getSvgRoot(),"blocklySelected"),ho(this)}unselect(){X(this.getSvgRoot(),"blocklySelected"),ho(null)}toCopyData(){return{paster:Ol.TYPE,commentState:hi(this,{addCoordinates:!0})}}showContextMenu(e){const t=q.registry.getContextMenuOptions({comment:this,focusedNode:this},e);let i;i=e instanceof PointerEvent?new k(e.clientX,e.clientY):cs(this.workspace,this.getRelativeToSurfaceXY()).translate(10,10),Ei(e,t,this.workspace.RTL,this.workspace,i)}snapToGrid(){if(!this.isDeadOrDying()){var e=this.workspace.getGrid();if(null!=e&&e.shouldSnap()){var t=this.getRelativeToSurfaceXY();(e=e.alignXY(t))!==t&&this.moveTo(e,["snap"])}}}getEditorFocusableNode(){return this.view.getEditorFocusableNode()}getFocusableElement(){return this.getSvgRoot()}getFocusableTree(){return this.workspace}onNodeFocus(){let e;this.select(),null==(e=this.workspace.getLayerManager())||e.append(this,50)}onNodeBlur(){this.unselect()}canBeFocused(){return!0}},Je={};Je.appendDomToWorkspace=yi,Je.blockToDom=W,Je.blockToDomWithXY=_,Je.clearWorkspaceAndLoadFromXml=vi,Je.deleteNext=Ta,Je.domToBlock=o.domToBlock$$module$build$src$core$xml,Je.domToBlockInternal=At,Je.domToPrettyText=qt,Je.domToText=nt,Je.domToVariables=Ts,Je.domToWorkspace=o.domToWorkspace$$module$build$src$core$xml,Je.loadWorkspaceComment=Lo,Je.saveWorkspaceComment=p,Je.variablesToDom=a,Je.workspaceToDom=r;var su=class extends Bi{constructor(e){super(e),this.type=f.BLOCK_CREATE,e&&(e.isShadow()&&(this.recordUndo=!1),this.xml=_(e),this.ids=Io(e),this.json=pt(e,{addCoordinates:!0}))}toJson(){const e=super.toJson();if(!this.xml)throw Error("The block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.xml=nt(this.xml),e.ids=this.ids,e.json=this.json,this.recordUndo||(e.recordUndo=this.recordUndo),e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new su)).xml=o.textToDom$$module$build$src$core$utils$xml(e.xml),t.ids=e.ids,t.json=e.json,void 0!==e.recordUndo&&(t.recordUndo=e.recordUndo),t}run(e){const t=this.getEventWorkspace_();if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!gb(t,this.ids))if(e)So(this.json,t);else for(e=0;e<this.ids.length;e++){const i=this.ids[e],s=t.getBlockById(i);s?s.dispose(!1):i===this.blockId&&console.warn("Can't uncreate non-existent block: "+i)}}},gb=function(e,t){return t.map(i=>e.getBlockById(i)).filter(i=>i&&i.isShadow()).length===t.length};U(x.EVENT,f.BLOCK_CREATE,su);var nu=class extends Yt{constructor(e,t){super(t),this.type=f.THEME_CHANGE,this.themeName=e}toJson(){const e=super.toJson();if(!this.themeName)throw Error("The theme name is undefined. Either pass a theme name to the constructor, or call fromJson");return e.themeName=this.themeName,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new nu)).themeName=e.themeName,t}};U(x.EVENT,f.THEME_CHANGE,nu);var ru=class extends Yt{constructor(e,t,i,s,n){super(s),this.type=f.VIEWPORT_CHANGE,this.viewTop=e,this.viewLeft=t,this.scale=i,this.oldScale=n}toJson(){const e=super.toJson();if(void 0===this.viewTop)throw Error("The view top is undefined. Either pass a value to the constructor, or call fromJson");if(void 0===this.viewLeft)throw Error("The view left is undefined. Either pass a value to the constructor, or call fromJson");if(void 0===this.scale)throw Error("The scale is undefined. Either pass a value to the constructor, or call fromJson");if(void 0===this.oldScale)throw Error("The old scale is undefined. Either pass a value to the constructor, or call fromJson");return e.viewTop=this.viewTop,e.viewLeft=this.viewLeft,e.scale=this.scale,e.oldScale=this.oldScale,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new ru)).viewTop=e.viewTop,t.viewLeft=e.viewLeft,t.scale=e.scale,t.oldScale=e.oldScale,t}};U(x.EVENT,f.VIEWPORT_CHANGE,ru);var M=function(e){return e[e.INPUT_VALUE=1]="INPUT_VALUE",e[e.OUTPUT_VALUE=2]="OUTPUT_VALUE",e[e.NEXT_STATEMENT=3]="NEXT_STATEMENT",e[e.PREVIOUS_STATEMENT=4]="PREVIOUS_STATEMENT",e}(M||{}),Ws=class{constructor(e){this.connectionChecker=e,this.connections=[]}addConnection(e,t){t=this.calculateIndexForYPos(t),this.connections.splice(t,0,e)}findIndexOfConnection(e,t){if(!this.connections.length)return-1;const i=this.calculateIndexForYPos(t);if(i>=this.connections.length)return-1;t=e.y;let s=i;for(;s>=0&&this.connections[s].y===t;){if(this.connections[s]===e)return s;s--}for(s=i;s<this.connections.length&&this.connections[s].y===t;){if(this.connections[s]===e)return s;s++}return-1}calculateIndexForYPos(e){if(!this.connections.length)return 0;let t=0,i=this.connections.length;for(;t<i;){const s=Math.floor((t+i)/2);if(this.connections[s].y<e)t=s+1;else{if(!(this.connections[s].y>e)){t=s;break}i=s}}return t}removeConnection(e,t){if(-1===(e=this.findIndexOfConnection(e,t)))throw Error("Unable to find connection in connectionDB.");this.connections.splice(e,1)}getNeighbours(e,t){function i(F){const _e=n-s[F].x,le=l-s[F].y;return Math.sqrt(_e*_e+le*le)<=t&&C.push(s[F]),le<t}const s=this.connections,n=e.x,l=e.y;e=0;let u=s.length-2,$=u;for(;e<$;)s[$].y<l?e=$:u=$,$=Math.floor((e+u)/2);const C=[];if(u=e=$,s.length){for(;e>=0&&i(e);)e--;do{u++}while(u<s.length&&i(u))}return C}isInYRange(e,t,i){return Math.abs(this.connections[e].y-t)<=i}searchForClosest(e,t,i){if(!this.connections.length)return{connection:null,radius:t};const s=e.y,n=e.x;e.x=n+i.x,e.y=s+i.y;var l=this.calculateIndexForYPos(e.y);i=null;let $,u=t,C=l-1;for(;C>=0&&this.isInYRange(C,e.y,t);)$=this.connections[C],this.connectionChecker.canConnect(e,$,!0,u)&&(i=$,u=$.distanceFrom(e)),C--;for(;l<this.connections.length&&this.isInYRange(l,e.y,t);)$=this.connections[l],this.connectionChecker.canConnect(e,$,!0,u)&&(i=$,u=$.distanceFrom(e)),l++;return e.x=n,e.y=s,{connection:i,radius:u}}static init(e){const t=[];return t[M.INPUT_VALUE]=new Ws(e),t[M.OUTPUT_VALUE]=new Ws(e),t[M.NEXT_STATEMENT]=new Ws(e),t[M.PREVIOUS_STATEMENT]=new Ws(e),t}},lu=class extends Yt{constructor(e,t,i){super(i),this.type=f.SELECTED,this.oldElementId=e??void 0,this.newElementId=t??void 0}toJson(){const e=super.toJson();return e.oldElementId=this.oldElementId,e.newElementId=this.newElementId,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new lu)).oldElementId=e.oldElementId,t.newElementId=e.newElementId,t}};U(x.EVENT,f.SELECTED,lu);var cu=class extends Bi{constructor(e){if(super(e),this.type=f.BLOCK_DELETE,e){if(e.getParent())throw Error("Connected blocks cannot be deleted.");e.isShadow()&&(this.recordUndo=!1),this.oldXml=_(e),this.ids=Io(e),this.wasShadow=e.isShadow(),this.oldJson=pt(e,{addCoordinates:!0})}}toJson(){const e=super.toJson();if(!this.oldXml)throw Error("The old block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(void 0===this.wasShadow)throw Error("Whether the block was a shadow is undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.oldXml=nt(this.oldXml),e.ids=this.ids,e.wasShadow=this.wasShadow,e.oldJson=this.oldJson,this.recordUndo||(e.recordUndo=this.recordUndo),e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new cu)).oldXml=o.textToDom$$module$build$src$core$utils$xml(e.oldXml),t.ids=e.ids,t.wasShadow=e.wasShadow||"shadow"===t.oldXml.tagName.toLowerCase(),t.oldJson=e.oldJson,void 0!==e.recordUndo&&(t.recordUndo=e.recordUndo),t}run(e){const t=this.getEventWorkspace_();if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(e)for(e=0;e<this.ids.length;e++){const i=this.ids[e],s=t.getBlockById(i);s?s.dispose(!1):i===this.blockId&&console.warn("Can't delete non-existent block: "+i)}else So(this.oldJson,t)}};U(x.EVENT,f.BLOCK_DELETE,cu);var vm={fromJsonInternal:ll},au={TEST_ONLY:vm};au.fromJson=o.fromJson$$module$build$src$core$field_registry,au.register=bt,au.unregister=rl;var Ve=class extends ee{constructor(e,t,i){super(ee.SKIP_SETUP),this.svgArrow=this.arrow=this.imageElement=this.menu_=this.selectedMenuItem=null,this.SERIALIZABLE=!0,this.clickTarget_=this.suffixField=this.prefixField=this.generatedOptions=null,e!==ee.SKIP_SETUP&&(this.setOptions(e),i&&this.configure_(i),t&&this.setValidator(t))}fromXml(e){this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(e.textContent)}loadState(e){this.loadLegacyState(Ve,e)||(this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(e))}initView(){this.shouldAddBorderRect_()?this.createBorderRect_():this.clickTarget_=this.sourceBlock_.getSvgRoot(),this.createTextElement_(),this.imageElement=I(T.IMAGE,{},this.fieldGroup_),this.getConstants().FIELD_DROPDOWN_SVG_ARROW?this.createSVGArrow_():this.createTextArrow_(),this.borderRect_&&R(this.borderRect_,"blocklyDropdownRect"),this.fieldGroup_&&(R(this.fieldGroup_,"blocklyField"),R(this.fieldGroup_,"blocklyDropdownField"))}shouldAddBorderRect_(){let e;return!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW&&!(null!=(e=this.getSourceBlock())&&e.isShadow())}createTextArrow_(){let e,t;this.arrow=I(T.TSPAN,{},this.textElement_),this.arrow.appendChild(document.createTextNode(null!=(e=this.getSourceBlock())&&e.RTL?Ve.ARROW_CHAR+" ":" "+Ve.ARROW_CHAR)),this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.arrow.setAttribute("dominant-baseline","central"),null!=(t=this.getSourceBlock())&&t.RTL?this.getTextElement().insertBefore(this.arrow,this.textContent_):this.getTextElement().appendChild(this.arrow)}createSVGArrow_(){this.svgArrow=I(T.IMAGE,{height:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px",width:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px"},this.fieldGroup_),this.svgArrow.setAttributeNS(vt,"xlink:href",this.getConstants().FIELD_DROPDOWN_SVG_ARROW_DATAURI)}showEditor_(e){var t=this.getSourceBlock();if(!t)throw new Te;this.dropdownCreate(),this.menu_&&(this.menu_.openingCoords=e&&"number"==typeof e.clientX?new k(e.clientX,e.clientY):null,Hr(),e=this.menu_.render(Ur()),R(e,"blocklyDropdownMenu"),this.getConstants().FIELD_DROPDOWN_COLOURED_DIV&&(t=t.getColour(),e=this.sourceBlock_.getColourTertiary(),_i(t,e)),Hc(this,this.dropdownDispose_.bind(this)),Ur().style.height=`${this.menu_.getSize().height}px`,this.menu_.focus(),this.selectedMenuItem&&this.menu_.setHighlighted(this.selectedMenuItem),this.applyColour())}dropdownCreate(){const e=this.getSourceBlock();if(!e)throw new Te;const t=new Ua;t.setRole(yt.LISTBOX),this.menu_=t;const i=this.getOptions(!1);this.selectedMenuItem=null;for(let n=0;n<i.length;n++){var s=i[n];if(s===Ve.SEPARATOR){t.addChild(new np);continue}const[l,u]=s;ft(l)?((s=new Image(l.width,l.height)).src=l.src,s.alt=l.alt):s=l,(s=new Nl(s,u)).setRole(yt.OPTION),s.setRightToLeft(e.RTL),s.setCheckable(!0),t.addChild(s),s.setChecked(u===this.value_),u===this.value_&&(this.selectedMenuItem=s),s.onAction(this.handleMenuActionEvent,this)}}dropdownDispose_(){this.menu_&&this.menu_.dispose(),this.selectedMenuItem=this.menu_=null,this.applyColour()}handleMenuActionEvent(e){Zr(this,!0),this.onItemSelected_(this.menu_,e)}onItemSelected_(e,t){this.setValue(t.getValue())}isOptionListDynamic(){return"function"==typeof this.menuGenerator_}getOptions(e){if(!this.menuGenerator_)throw TypeError("A menu generator was never defined.");return Array.isArray(this.menuGenerator_)?this.menuGenerator_:(e&&this.generatedOptions||(this.generatedOptions=this.menuGenerator_(),this.validateOptions(this.generatedOptions)),this.generatedOptions)}setOptions(e){Array.isArray(e)?(this.validateOptions(e),e=this.trimOptions(e),this.menuGenerator_=e.options,this.prefixField=e.prefix||null,this.suffixField=e.suffix||null):this.menuGenerator_=e,this.selectedOption=this.getOptions(!1)[0],this.setValue(this.selectedOption[1])}doClassValidation_(e){return this.getOptions(!0).some(t=>t[1]===e)?e:(this.sourceBlock_&&console.warn("Cannot set the dropdown's value to an unavailable option. Block type: "+this.sourceBlock_.type+", Field name: "+this.name+", Value: "+e),null)}doValueUpdate_(e){super.doValueUpdate_(e),e=this.getOptions(!0);for(let i,t=0;i=e[t];t++)i[1]===this.value_&&(this.selectedOption=i)}applyColour(){const e=this.sourceBlock_;this.borderRect_&&(this.borderRect_.setAttribute("stroke",e.getColourTertiary()),this.borderRect_.setAttribute("fill",this.menu_?e.getColourTertiary():"transparent")),e&&this.arrow&&(this.arrow.style.fill=e.isShadow()?e.getColourSecondary():e.getColour())}render_(){this.getTextContent().nodeValue="",this.imageElement.style.display="none";const e=this.selectedOption&&this.selectedOption[0];ft(e)?this.renderSelectedImage(e):this.renderSelectedText(),this.positionBorderRect_()}renderSelectedImage(e){const t=this.getSourceBlock();if(!t)throw new Te;this.imageElement.style.display="",this.imageElement.setAttributeNS(vt,"xlink:href",e.src),this.imageElement.setAttribute("height",String(e.height)),this.imageElement.setAttribute("width",String(e.width));const i=Number(e.height);e=Number(e.width);var s=!!this.borderRect_;const n=Math.max(s?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,i+Ve.IMAGE_Y_PADDING);let l;s=s?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,l=this.svgArrow?this.positionSVGArrow(e+s,n/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2):A(this.arrow),this.size_.width=e+l+2*s,this.size_.height=n;let u=0;t.RTL?this.imageElement.setAttribute("x",`${s+l}`):(u=e+l,this.getTextElement().setAttribute("text-anchor","end"),this.imageElement.setAttribute("x",`${s}`)),this.imageElement.setAttribute("y",String(n/2-i/2)),this.positionTextElement_(u+s,e+l)}renderSelectedText(){this.getTextContent().nodeValue=this.getDisplayText_();var e=this.getTextElement();R(e,"blocklyDropdownText"),e.setAttribute("text-anchor","start");var t=!!this.borderRect_;e=Math.max(t?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,this.getConstants().FIELD_TEXT_HEIGHT);const i=A(this.getTextElement());t=t?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;let s=0;this.svgArrow&&(s=this.positionSVGArrow(i+t,e/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2)),this.size_.width=i+s+2*t,this.size_.height=e,this.positionTextElement_(t,i)}positionSVGArrow(e,t){if(!this.svgArrow)return 0;const i=this.getSourceBlock();if(!i)throw new Te;const s=this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,n=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_PADDING,l=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE;return this.svgArrow.setAttribute("transform","translate("+(i.RTL?s:e+n)+","+t+")"),l+n}getText_(){if(!this.selectedOption)return null;const e=this.selectedOption[0];if(ft(e))return e.alt;if(typeof HTMLElement<"u"&&e instanceof HTMLElement){let t,i;return null!=(i=null!=(t=e.title)?t:e.ariaLabel)?i:e.innerText}return"string"==typeof e?e:(console.warn("Can't get text for existing dropdown option. If you're using HTMLElement dropdown options in node, ensure you're using jsdom-global or similar."),null)}static fromJson(e){if(!e.options)throw Error("options are required for the dropdown field. The options property must be assigned an array of [humanReadableValue, languageNeutralValue] tuples.");return new this(e.options,void 0,e)}trimOptions(e){let t=!1;const i=e.map(u=>{if(u===Ve.SEPARATOR)return u;const[$,C]=u;return"string"==typeof $?[ge($),C]:(t=!0,[ft($)?Object.assign({},$,{alt:ge($.alt)}):Object.assign({},$),C])});if(t||e.length<2)return{options:i};var s=i.map(([u])=>u),n=yn(s);e=Kc(s,n);const l=Jc(s,n);return!e&&!l||n<=e+l?{options:i}:(n=e?s[0].substring(0,e-1):void 0,s=l?s[0].substr(1-l):void 0,{options:this.applyTrim(i,e,l),prefix:n,suffix:s})}applyTrim(e,t,i){return e.map(([s,n])=>[s.substring(t,s.length-i),n])}validateOptions(e){if(!Array.isArray(e))throw TypeError("FieldDropdown options must be an array.");if(!e.length)throw TypeError("FieldDropdown options must not be an empty array.");let t=!1;for(let i=0;i<e.length;i++){const s=e[i];Array.isArray(s)||s===Ve.SEPARATOR?"string"!=typeof s[1]?(t=!0,console.error(`Invalid option[${i}]: Each FieldDropdown option id must be a string. \n          Found ${s[1]} in: ${s}`)):!s[0]||"string"==typeof s[0]||ft(s[0])||typeof HTMLElement<"u"&&s[0]instanceof HTMLElement||(t=!0,console.error(`Invalid option[${i}]: Each FieldDropdown option must have a string \n          label, image description, or HTML element. Found ${s[0]} in: ${s}`)):(t=!0,console.error(`Invalid option[${i}]: Each FieldDropdown option must be an array or\n          the string literal 'separator'. Found: ${s}`))}if(t)throw TypeError("Found invalid FieldDropdown options.")}};Ve.SEPARATOR="separator",Ve.ARROW_CHAR="\u25be",Ve.IMAGE_Y_OFFSET=5,Ve.IMAGE_Y_PADDING=2*Ve.IMAGE_Y_OFFSET,bt("field_dropdown",Ve);var xt,Zi=class{constructor(e,t,i,s){this.name=e,this.startHats=!1,this.blockStyles=t||Object.create(null),this.categoryStyles=i||Object.create(null),this.componentStyles=s||Object.create(null),this.fontStyle=Object.create(null),U(x.THEME,e,this,!0)}getClassName(){return this.name+"-theme"}setBlockStyle(e,t){this.blockStyles[e]=t}setCategoryStyle(e,t){this.categoryStyles[e]=t}getComponentStyle(e){if(!(e=this.componentStyles[e]))return null;if("string"==typeof e){const t=this.getComponentStyle(e);if(t)return t}return`${e}`}setComponentStyle(e,t){this.componentStyles[e]=t}setFontStyle(e){this.fontStyle=e}setStartHats(e){this.startHats=e}static defineTheme(e,t){e=e.toLowerCase();const i=new Zi(e);let s=t.base;if(s){if("string"==typeof s){let n;s=null!=(n=kt(x.THEME,s))?n:void 0}s instanceof Zi&&(St(i,s),i.name=e)}return St(i.blockStyles,t.blockStyles),St(i.categoryStyles,t.categoryStyles),St(i.componentStyles,t.componentStyles),St(i.fontStyle,t.fontStyle),null!==t.startHats&&(i.startHats=t.startHats),i}},ql=new Zi("classic",{colour_blocks:{colourPrimary:"20"},list_blocks:{colourPrimary:"260"},logic_blocks:{colourPrimary:"210"},loop_blocks:{colourPrimary:"120"},math_blocks:{colourPrimary:"230"},procedure_blocks:{colourPrimary:"290"},text_blocks:{colourPrimary:"160"},variable_blocks:{colourPrimary:"330"},variable_dynamic_blocks:{colourPrimary:"310"},hat_blocks:{colourPrimary:"330",hat:"cap"}},{colour_category:{colour:"20"},list_category:{colour:"260"},logic_category:{colour:"210"},loop_category:{colour:"120"},math_category:{colour:"230"},procedure_category:{colour:"290"},text_category:{colour:"160"},variable_category:{colour:"330"},variable_dynamic_category:{colour:"310"}}),Jt=class{constructor(e){this.gridPattern=null,this.getMetrics=this.setMetrics=void 0;let t=null,i=!1;var s=!1,n=!1,l=!1,u=!1,$=!1;const C=!!e.readOnly;var F;C||(t=Er(null!=(F=e.toolbox)?F:null),i=vr(t),s=void 0===(s=e.trashcan)?i:s,n=void 0===(n=e.collapse)?i:n,l=void 0===(l=e.comments)?i:l,u=void 0===(u=e.disable)?i:u,$=void 0===($=e.sounds)||$),F=e.maxTrashcanContents,s?void 0===F&&(F=32):F=0;const _e=!!e.rtl;let le=e.horizontalLayout;void 0===le&&(le=!1);var je="end"!==e.toolboxPosition;je=le?je?G.TOP:G.BOTTOM:je===_e?G.RIGHT:G.LEFT;let Yo=e.css;void 0===Yo&&(Yo=!0);let Eo="https://blockly-demo.appspot.com/static/media/";e.media&&(Eo=e.media.endsWith("/")?e.media:e.media+"/");const m_=e.oneBasedIndex,qE=e.renderer||"geras",zE=e.plugins||{};let __,b_,f_,Zg=e.modalInputs;void 0===Zg&&(Zg=!0),this.RTL=_e,this.oneBasedIndex=void 0===m_||m_,this.collapse=n,this.comments=l,this.disable=u,this.readOnly=C,this.maxBlocks=e.maxBlocks||1/0,this.maxInstances=null!=(__=e.maxInstances)?__:null,this.modalInputs=Zg,this.pathToMedia=Eo,this.hasCategories=i,this.moveOptions=Jt.parseMoveOptions(e,i),this.hasScrollbars=!!this.moveOptions.scrollbars,this.hasTrashcan=s,this.maxTrashcanContents=F,this.hasSounds=$,this.hasCss=Yo,this.horizontalLayout=le,this.languageTree=t,this.gridOptions=Jt.parseGridOptions(e),this.zoomOptions=Jt.parseZoomOptions(e),this.toolboxPosition=je,this.theme=Jt.parseThemeOptions(e),this.renderer=qE,this.rendererOverrides=null!=(b_=e.rendererOverrides)?b_:null,this.parentWorkspace=null!=(f_=e.parentWorkspace)?f_:null,this.plugins=zE}static parseMoveOptions(e,t){const i=e.move||{},s={};return void 0===i.scrollbars&&void 0===e.scrollbars?s.scrollbars=t:"object"==typeof i.scrollbars?(s.scrollbars={horizontal:!!i.scrollbars.horizontal,vertical:!!i.scrollbars.vertical},s.scrollbars.horizontal&&s.scrollbars.vertical?s.scrollbars=!0:s.scrollbars.horizontal||s.scrollbars.vertical||(s.scrollbars=!1)):s.scrollbars=!!i.scrollbars||!!e.scrollbars,s.wheel=s.scrollbars&&void 0!==i.wheel?!!i.wheel:"object"==typeof s.scrollbars,s.drag=!(!s.scrollbars||void 0!==i.drag&&!i.drag),s}static parseZoomOptions(e){const t={};return t.controls=void 0!==(e=e.zoom||{}).controls&&!!e.controls,t.wheel=void 0!==e.wheel&&!!e.wheel,t.startScale=void 0===e.startScale?1:Number(e.startScale),t.maxScale=void 0===e.maxScale?3:Number(e.maxScale),t.minScale=void 0===e.minScale?.3:Number(e.minScale),t.scaleSpeed=void 0===e.scaleSpeed?1.2:Number(e.scaleSpeed),t.pinch=void 0===e.pinch?t.wheel||t.controls:!!e.pinch,t}static parseGridOptions(e){e=e.grid||{};const t={};return t.spacing=Number(e.spacing)||0,t.colour=e.colour||"#888",t.length=void 0===e.length?1:Number(e.length),t.snap=t.spacing>0&&!!e.snap,t}static parseThemeOptions(e){return"string"==typeof(e=e.theme||ql)?kt(x.THEME,e):e instanceof Zi?e:Zi.defineTheme(e.name||"builtin"+Ee(),e)}},wp=class{constructor(e,t){this.bubble=e,this.workspace=t,this.startLoc=null}isMovable(){return!0}startDrag(){let e;this.startLoc=this.bubble.getRelativeToSurfaceXY(),this.workspace.setResizesEnabled(!1),null==(e=this.workspace.getLayerManager())||e.moveToDragLayer(this.bubble),this.bubble.setDragging&&this.bubble.setDragging(!0)}drag(e){this.bubble.moveDuringDrag(e)}endDrag(){let e;this.workspace.setResizesEnabled(!0),null==(e=this.workspace.getLayerManager())||e.moveOffDragLayer(this.bubble,100),this.bubble.setDragging(!1)}revertDrag(){this.startLoc&&this.bubble.moveDuringDrag(this.startLoc)}},te=class{constructor(e,t,i,s){this.workspace=e,this.anchor=t,this.ownerRect=i,this.size=new Y(0,0),this.colour="#ffffff",this.disposed=!1,this.relativeLeft=this.relativeTop=0,this.dragStrategy=new wp(this,this.workspace),this.id=Ee(),this.svgRoot=I(T.G,{class:"blocklyBubble"},e.getBubbleCanvas()),e=I(T.G,{class:"blocklyEmboss"},this.svgRoot),this.tail=I(T.PATH,{class:"blocklyBubbleTail"},e),this.background=I(T.RECT,{class:"blocklyDraggable",x:0,y:0,rx:xt.BORDER_WIDTH,ry:xt.BORDER_WIDTH},e),this.contentContainer=I(T.G,{},this.svgRoot),this.focusableElement=s??this.svgRoot,this.focusableElement.setAttribute("id",this.id),N(this.background,"pointerdown",this,this.onMouseDown)}dispose(){Q(this.svgRoot),this.disposed=!0}setAnchorLocation(e,t=!1){this.anchor=e,t?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor(),this.renderTail()}setPositionRelativeToAnchor(e,t){this.relativeLeft=e,this.relativeTop=t,this.positionRelativeToAnchor(),this.renderTail()}getSize(){return this.size}setSize(e,t=!1){e.width=Math.max(e.width,xt.MIN_SIZE),e.height=Math.max(e.height,xt.MIN_SIZE),this.size=e,this.background.setAttribute("width",`${e.width}`),this.background.setAttribute("height",`${e.height}`),t?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor(),this.renderTail()}getColour(){return this.colour}setColour(e){this.colour=e,this.tail.setAttribute("fill",e),this.background.setAttribute("fill",e)}onMouseDown(e){let t;null==(t=this.workspace.getGesture(e))||t.handleBubbleStart(e,this),o.getFocusManager$$module$build$src$core$focus_manager().focusNode(this)}positionRelativeToAnchor(){let e=this.anchor.x;e=this.workspace.RTL?e-(this.relativeLeft+this.size.width):e+this.relativeLeft,this.moveTo(e,this.relativeTop+this.anchor.y)}moveTo(e,t){this.svgRoot.setAttribute("transform",`translate(${e}, ${t})`)}positionByRect(e=new j(0,0,0,0)){var t=this.workspace.getMetricsManager().getViewMetrics(!0),i=this.getOptimalRelativeLeft(t),s=this.getOptimalRelativeTop(t);const n={x:i,y:-this.size.height-this.workspace.getRenderer().getConstants().MIN_BLOCK_HEIGHT},l={x:-this.size.width-30,y:s};s={x:e.getWidth(),y:s};var u={x:i,y:e.getHeight()};i=e.getWidth()<e.getHeight()?s:u,e=e.getWidth()<e.getHeight()?u:s,s=this.getOverlap(n,t),u=this.getOverlap(l,t);const $=this.getOverlap(i,t);t=this.getOverlap(e,t),s===(t=Math.max(s,u,$,t))?(this.relativeLeft=n.x,this.relativeTop=n.y):u===t?(this.relativeLeft=l.x,this.relativeTop=l.y):$===t?(this.relativeLeft=i.x,this.relativeTop=i.y):(this.relativeLeft=e.x,this.relativeTop=e.y),this.positionRelativeToAnchor()}getOverlap(e,t){var i=this.workspace.RTL?this.anchor.x-e.x-this.size.width:e.x+this.anchor.x;return e=e.y+this.anchor.y,Math.max(0,Math.min(1,(Math.min(i+this.size.width,t.left+t.width)-Math.max(i,t.left))*(Math.min(e+this.size.height,t.top+t.height)-Math.max(e,t.top))/(this.size.width*this.size.height)))}getOptimalRelativeLeft(e){let t=-this.size.width/4;if(this.size.width>e.width)return t;if(e=this.getWorkspaceViewRect(e),this.workspace.RTL){var i=this.anchor.x-t;i-this.size.width<e.left?t=-(e.left-this.anchor.x+this.size.width):i>e.right&&(t=-(e.right-this.anchor.x))}else(i=t+this.anchor.x)<e.left?t=e.left-this.anchor.x:i+this.size.width>e.right&&(t=e.right-this.anchor.x-this.size.width);return t}getOptimalRelativeTop(e){let t=-this.size.height/4;if(this.size.height>e.height)return t;const i=this.anchor.y+t,s=i+this.size.height;return i<(e=this.getWorkspaceViewRect(e)).top?t=e.top-this.anchor.y:s>e.bottom&&(t=e.bottom-this.anchor.y-this.size.height),t}getWorkspaceViewRect(e){const t=e.top;let i=e.top+e.height,s=e.left;return e=e.left+e.width,i-=this.getScrollbarThickness(),this.workspace.RTL?s-=this.getScrollbarThickness():e-=this.getScrollbarThickness(),new j(t,i,s,e)}getScrollbarThickness(){return be.scrollbarThickness/this.workspace.scale}renderTail(){const e=[];var t=this.size.width/2,i=this.size.height/2,s=-this.relativeLeft,n=-this.relativeTop;if(t===s&&i===n)e.push("M "+t+","+i);else{n-=i,s-=t,this.workspace.RTL&&(s*=-1);var l=Math.sqrt(n*n+s*s),u=Math.acos(s/l);n<0&&(u=2*Math.PI-u);var $=u+Math.PI/2;$>2*Math.PI&&($-=2*Math.PI);var C=Math.sin($);const _e=Math.cos($);let le=(this.size.width+this.size.height)/xt.TAIL_THICKNESS;le=Math.min(le,this.size.width,this.size.height)/4,s=t+($=1-xt.ANCHOR_RADIUS/l)*s,n=i+$*n,$=t+le*_e;const je=i+le*C;t-=le*_e,i-=le*C,(C=u+(C=Br(this.workspace.RTL?-xt.TAIL_ANGLE:xt.TAIL_ANGLE)))>2*Math.PI&&(C-=2*Math.PI),u=Math.sin(C)*l/xt.TAIL_BEND,l=Math.cos(C)*l/xt.TAIL_BEND,e.push("M"+$+","+je),e.push("C"+($+l)+","+(je+u)+" "+s+","+n+" "+s+","+n),e.push("C"+s+","+n+" "+(t+l)+","+(i+u)+" "+t+","+i)}let F;e.push("z"),null==(F=this.tail)||F.setAttribute("d",e.join(" "))}bringToFront(){let e;const t=null==(e=this.svgRoot)?void 0:e.parentNode;return!(!this.svgRoot||t?.lastChild===this.svgRoot||(t?.appendChild(this.svgRoot),0))}getRelativeToSurfaceXY(){return new k(this.workspace.RTL?-this.relativeLeft+this.anchor.x-this.size.width:this.anchor.x+this.relativeLeft,this.anchor.y+this.relativeTop)}getSvgRoot(){return this.svgRoot}moveDuringDrag(e){this.moveTo(e.x,e.y),this.relativeLeft=this.workspace.RTL?this.anchor.x-e.x-this.size.width:e.x-this.anchor.x,this.relativeTop=e.y-this.anchor.y,this.renderTail()}setDragging(e){}setDeleteStyle(e){}isDeletable(){return!1}showContextMenu(e){}isMovable(){return!0}startDrag(){this.dragStrategy.startDrag()}drag(e){this.dragStrategy.drag(e)}endDrag(){this.dragStrategy.endDrag()}revertDrag(){this.dragStrategy.revertDrag()}select(){ho(this)}unselect(){ho(null)}getFocusableElement(){return this.focusableElement}getFocusableTree(){return this.workspace}onNodeFocus(){this.select(),this.bringToFront()}onNodeBlur(){this.unselect()}canBeFocused(){return!0}};xt=te,te.BORDER_WIDTH=6,te.DOUBLE_BORDER=2*xt.BORDER_WIDTH,te.MIN_SIZE=xt.DOUBLE_BORDER,te.TAIL_THICKNESS=1,te.TAIL_ANGLE=20,te.TAIL_BEND=4,te.ANCHOR_RADIUS=8;var $o=class extends te{constructor(e,t,i,s){let n,l;super(t,i,s),this.workspace=t,this.anchor=i,this.ownerRect=s,this.autoLayout=!0,t=new Jt(e),this.validateWorkspaceOptions(t),this.svgDialog=I(T.SVG,{x:te.BORDER_WIDTH,y:te.BORDER_WIDTH},this.contentContainer),e.parentWorkspace=this.workspace,this.miniWorkspace=this.newWorkspaceSvg(new Jt(e)),this.miniWorkspace.internalIsMutator=!0,e=this.miniWorkspace.createDom("blocklyMutatorBackground"),this.svgDialog.appendChild(e),t.languageTree&&(e.insertBefore(this.miniWorkspace.addFlyout(T.G),this.miniWorkspace.getCanvas()),e=this.miniWorkspace.getFlyout(),e?.init(this.miniWorkspace),e?.show(t.languageTree)),R(this.svgRoot,"blocklyMiniWorkspaceBubble"),this.miniWorkspace.addChangeListener(this.onWorkspaceChange.bind(this)),null==(n=this.miniWorkspace.getFlyout())||null==(l=n.getWorkspace())||l.addChangeListener(this.onWorkspaceChange.bind(this)),this.updateBubbleSize()}dispose(){this.miniWorkspace.dispose(),super.dispose()}getWorkspace(){return this.miniWorkspace}addWorkspaceChangeListener(e){this.miniWorkspace.addChangeListener(e)}validateWorkspaceOptions(e){if(e.hasCategories)throw Error("The miniworkspace bubble does not support toolboxes with categories");if(e.hasTrashcan)throw Error("The miniworkspace bubble does not support trashcans");if(e.zoomOptions.controls||e.zoomOptions.wheel||e.zoomOptions.pinch)throw Error("The miniworkspace bubble does not support zooming");if(e.moveOptions.scrollbars||e.moveOptions.wheel||e.moveOptions.drag)throw Error("The miniworkspace bubble does not scrolling/moving the workspace");if(e.horizontalLayout)throw Error("The miniworkspace bubble does not support horizontal layouts")}onWorkspaceChange(){this.bumpBlocksIntoBounds(),this.updateBubbleSize()}bumpBlocksIntoBounds(){if(!this.miniWorkspace.isDragging()||this.miniWorkspace.keyboardMoveInProgress)for(const e of this.miniWorkspace.getTopBlocks(!1)){const t=e.getRelativeToSurfaceXY();if(t.y<20&&e.moveBy(0,20-t.y),e.RTL){let i=-20;const s=this.miniWorkspace.getFlyout();s&&(i-=s.getWidth()),t.x>i&&e.moveBy(i-t.x,0)}else t.x<20&&e.moveBy(20-t.x,0)}}updateBubbleSize(){if(!this.miniWorkspace.isDragging()||this.miniWorkspace.keyboardMoveInProgress){this.autoLayout&&(this.autoLayout=!this.miniWorkspace.keyboardMoveInProgress);var e=this.getSize(),t=this.calculateWorkspaceSize();Math.abs(e.width-t.width)<$o.MINIMUM_VIEW_CHANGE&&Math.abs(e.height-t.height)<$o.MINIMUM_VIEW_CHANGE||(this.svgDialog.setAttribute("width",`${t.width}px`),this.svgDialog.setAttribute("height",`${t.height}px`),this.miniWorkspace.setCachedParentSvgSize(t.width,t.height),this.miniWorkspace.RTL&&this.miniWorkspace.getCanvas().setAttribute("transform",`translate(${t.width}, 0)`),this.setSize(new Y(t.width+te.DOUBLE_BORDER,t.height+te.DOUBLE_BORDER),this.autoLayout),this.miniWorkspace.resize(),this.miniWorkspace.recordDragTargets())}}calculateWorkspaceSize(){var e=this.miniWorkspace.getCanvas().getBBox();let t=e.width+$o.MARGIN;e=e.height+$o.MARGIN;const i=this.miniWorkspace.getFlyout();if(i){const s=i.getWorkspace().getMetricsManager().getScrollMetrics();e=Math.max(e,s.height+20),t+=i.getWidth()}return new Y(t,e)}updateBlockStyles(){for(var e of this.miniWorkspace.getAllBlocks(!1))e.setStyle(e.getStyleName());let t;if(e=null==(t=this.miniWorkspace.getFlyout())?void 0:t.getWorkspace())for(const i of e.getAllBlocks(!1))i.setStyle(i.getStyleName())}moveDuringDrag(e){super.moveDuringDrag(e),this.autoLayout=!1}moveTo(e,t){super.moveTo(e,t),this.miniWorkspace.recordDragTargets()}newWorkspaceSvg(e){throw Error("The implementation of newWorkspaceSvg should be monkey-patched in by blockly.ts")}};$o.MINIMUM_VIEW_CHANGE=10,$o.MARGIN=3*te.DOUBLE_BORDER;var rr=class{constructor(e){this.sourceBlock=e,this.offsetInBlock=new k(0,0),this.workspaceLocation=new k(0,0),this.svgRoot=null,this.tooltip=e,this.id=Ee()}getType(){throw Error("Icons must implement getType")}initView(e){if(!this.svgRoot){var t=this.sourceBlock;this.svgRoot=I(T.G,{class:"blocklyIconGroup",id:this.id}),t.getSvgRoot().appendChild(this.svgRoot),this.updateSvgRootOffset(),N(this.svgRoot,"pointerdown",this,e),this.svgRoot.tooltip=this,Cn(this.svgRoot)}}dispose(){oa(this.svgRoot),Q(this.svgRoot)}getWeight(){return-1}getSize(){return new Y(0,0)}setTooltip(e){this.tooltip=e??this.sourceBlock}getTooltip(){return this.tooltip}applyColour(){}updateEditable(){}updateCollapsed(){this.svgRoot&&(this.svgRoot.style.display=this.sourceBlock.isCollapsed()?"none":"block",Ao(this)&&this.setBubbleVisible(!1))}hideForInsertionMarker(){this.svgRoot&&(this.svgRoot.style.display="none")}isShownWhenCollapsed(){return!1}setOffsetInBlock(e){this.offsetInBlock=e,this.updateSvgRootOffset()}updateSvgRootOffset(){let e;null==(e=this.svgRoot)||e.setAttribute("transform",`translate(${this.offsetInBlock.x}, ${this.offsetInBlock.y})`)}onLocationChange(e){this.workspaceLocation=k.sum(e,this.offsetInBlock)}onClick(){}isClickableInFlyout(e){return!0}getFocusableElement(){const e=this.svgRoot;if(!e)throw Error("Attempting to focus uninitialized icon.");return e}getFocusableTree(){return this.sourceBlock.workspace}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}getSourceBlock(){return this.sourceBlock}};o.MutatorIcon$$module$build$src$core$icons$mutator_icon=class extends rr{constructor(e,t){super(t),this.flyoutBlockTypes=e,this.sourceBlock=t,this.saveConnectionsListener=this.updateWorkspacePid=this.rootBlock=this.miniWorkspaceBubble=null}getType(){return o.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE}initView(e){this.svgRoot||(super.initView(e),I(T.RECT,{class:"blocklyIconShape",rx:"4",ry:"4",height:"16",width:"16"},this.svgRoot),I(T.PATH,{class:"blocklyIconSymbol",d:"m4.203,7.296 0,1.368 -0.92,0.677 -0.11,0.41 0.9,1.559 0.41,0.11 1.043,-0.457 1.187,0.683 0.127,1.134 0.3,0.3 1.8,0 0.3,-0.299 0.127,-1.138 1.185,-0.682 1.046,0.458 0.409,-0.11 0.9,-1.559 -0.11,-0.41 -0.92,-0.677 0,-1.366 0.92,-0.677 0.11,-0.41 -0.9,-1.559 -0.409,-0.109 -1.046,0.458 -1.185,-0.682 -0.127,-1.138 -0.3,-0.299 -1.8,0 -0.3,0.3 -0.126,1.135 -1.187,0.682 -1.043,-0.457 -0.41,0.11 -0.899,1.559 0.108,0.409z"},this.svgRoot),I(T.CIRCLE,{class:"blocklyIconShape",r:"2.7",cx:"8",cy:"8"},this.svgRoot),R(this.svgRoot,"blocklyMutatorIcon"))}dispose(){let e;super.dispose(),null==(e=this.miniWorkspaceBubble)||e.dispose()}getWeight(){return o.MutatorIcon$$module$build$src$core$icons$mutator_icon.WEIGHT}getSize(){return new Y(17,17)}applyColour(){let e,t;super.applyColour(),null==(e=this.miniWorkspaceBubble)||e.setColour(this.sourceBlock.getColour()),null==(t=this.miniWorkspaceBubble)||t.updateBlockStyles()}updateCollapsed(){super.updateCollapsed(),this.sourceBlock.isCollapsed()&&this.setBubbleVisible(!1)}onLocationChange(e){let t;super.onLocationChange(e),null==(t=this.miniWorkspaceBubble)||t.setAnchorLocation(this.getAnchorLocation())}onClick(){super.onClick(),this.sourceBlock.isEditable()&&this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}bubbleIsVisible(){return!!this.miniWorkspaceBubble}setBubbleVisible(e){const t=this;return(0,y.asyncExecutePromiseGeneratorFunction)(function*(){if(t.bubbleIsVisible()!==e){if(yield Zt(),e){let i;t.miniWorkspaceBubble=new $o(t.getMiniWorkspaceConfig(),t.sourceBlock.workspace,t.getAnchorLocation(),t.getBubbleOwnerRect()),t.applyColour(),t.createRootBlock(),t.addSaveConnectionsListener(),null==(i=t.miniWorkspaceBubble)||i.addWorkspaceChangeListener(t.createMiniWorkspaceChangeListener())}else{let i;null==(i=t.miniWorkspaceBubble)||i.dispose(),t.miniWorkspaceBubble=null,t.saveConnectionsListener&&t.sourceBlock.workspace.removeChangeListener(t.saveConnectionsListener),t.saveConnectionsListener=null}D(new(P(f.BUBBLE_OPEN))(t.sourceBlock,e,"mutator"))}})}getBubble(){return this.miniWorkspaceBubble}getMiniWorkspaceConfig(){let e;const t={disable:!1,media:this.sourceBlock.workspace.options.pathToMedia,rtl:this.sourceBlock.RTL,renderer:this.sourceBlock.workspace.options.renderer,rendererOverrides:null!=(e=this.sourceBlock.workspace.options.rendererOverrides)?e:void 0};return this.flyoutBlockTypes.length&&(t.toolbox={kind:"flyoutToolbox",contents:this.flyoutBlockTypes.map(i=>({kind:"block",type:i}))}),t}getAnchorLocation(){return k.sum(this.workspaceLocation,new k(8.5,8.5))}getBubbleOwnerRect(){const e=this.sourceBlock.getSvgRoot().getBBox();return new j(e.y,e.y+e.height,e.x,e.x+e.width)}createRootBlock(){if(!this.sourceBlock.decompose)throw Error("Blocks with mutator icons must include a decompose method");for(var e of(this.rootBlock=this.sourceBlock.decompose(this.miniWorkspaceBubble.getWorkspace()),this.rootBlock.getDescendants(!1)))e.queueRender();let t,i,s,n;this.rootBlock.setMovable(!1),this.rootBlock.setDeletable(!1),e=null!=(n=null==(t=this.miniWorkspaceBubble)||null==(i=t.getWorkspace())||null==(s=i.getFlyout())?void 0:s.getWidth())?n:0,this.rootBlock.moveBy(this.rootBlock.RTL?-(e+16):16,16)}addSaveConnectionsListener(){this.sourceBlock.saveConnections&&this.rootBlock&&(this.saveConnectionsListener=()=>{this.sourceBlock.saveConnections&&this.rootBlock&&this.sourceBlock.saveConnections(this.rootBlock)},this.saveConnectionsListener(),this.sourceBlock.workspace.addChangeListener(this.saveConnectionsListener))}createMiniWorkspaceChangeListener(){return e=>{o.MutatorIcon$$module$build$src$core$icons$mutator_icon.isIgnorableMutatorEvent(e)||this.updateWorkspacePid||(this.updateWorkspacePid=setTimeout(()=>{this.updateWorkspacePid=null,this.recomposeSourceBlock()},0))}}static isIgnorableMutatorEvent(e){return e.isUiEvent||ao(e)||Pt(e)&&"disabled"===e.element}recomposeSourceBlock(){if(this.rootBlock){if(!this.sourceBlock.compose)throw Error("Blocks with mutator icons must include a compose method");var e=o.getGroup$$module$build$src$core$events$utils();e||o.setGroup$$module$build$src$core$events$utils(!0);var t=Fi.getExtraBlockState_(this.sourceBlock);this.sourceBlock.compose(this.rootBlock);var i=Fi.getExtraBlockState_(this.sourceBlock);t!==i&&D(new(P(f.BLOCK_CHANGE))(this.sourceBlock,"mutation",null,t,i)),o.setGroup$$module$build$src$core$events$utils(e)}}getWorkspace(){let e;return null==(e=this.miniWorkspaceBubble)?void 0:e.getWorkspace()}},o.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE=ke.MUTATOR,o.MutatorIcon$$module$build$src$core$icons$mutator_icon.WEIGHT=1;var lr=Object.create(null),Ob={allExtensions:lr};o.register$$module$build$src$core$extensions("parent_tooltip_when_inline",pl);var Qt={TEST_ONLY:Ob};Qt.apply=Is,Qt.buildTooltipForDropdown=o.buildTooltipForDropdown$$module$build$src$core$extensions,Qt.buildTooltipWithFieldText=o.buildTooltipWithFieldText$$module$build$src$core$extensions,Qt.isRegistered=Cs,Qt.register=o.register$$module$build$src$core$extensions,Qt.registerMixin=o.registerMixin$$module$build$src$core$extensions,Qt.registerMutator=o.registerMutator$$module$build$src$core$extensions,Qt.runAfterPageLoad=dl,Qt.unregister=cl;var ie=function(e){return e[e.WIN_KEY_FF_LINUX=0]="WIN_KEY_FF_LINUX",e[e.MAC_ENTER=3]="MAC_ENTER",e[e.BACKSPACE=8]="BACKSPACE",e[e.TAB=9]="TAB",e[e.NUM_CENTER=12]="NUM_CENTER",e[e.ENTER=13]="ENTER",e[e.SHIFT=16]="SHIFT",e[e.CTRL=17]="CTRL",e[e.ALT=18]="ALT",e[e.PAUSE=19]="PAUSE",e[e.CAPS_LOCK=20]="CAPS_LOCK",e[e.ESC=27]="ESC",e[e.SPACE=32]="SPACE",e[e.PAGE_UP=33]="PAGE_UP",e[e.PAGE_DOWN=34]="PAGE_DOWN",e[e.END=35]="END",e[e.HOME=36]="HOME",e[e.LEFT=37]="LEFT",e[e.UP=38]="UP",e[e.RIGHT=39]="RIGHT",e[e.DOWN=40]="DOWN",e[e.PLUS_SIGN=43]="PLUS_SIGN",e[e.PRINT_SCREEN=44]="PRINT_SCREEN",e[e.INSERT=45]="INSERT",e[e.DELETE=46]="DELETE",e[e.ZERO=48]="ZERO",e[e.ONE=49]="ONE",e[e.TWO=50]="TWO",e[e.THREE=51]="THREE",e[e.FOUR=52]="FOUR",e[e.FIVE=53]="FIVE",e[e.SIX=54]="SIX",e[e.SEVEN=55]="SEVEN",e[e.EIGHT=56]="EIGHT",e[e.NINE=57]="NINE",e[e.FF_SEMICOLON=59]="FF_SEMICOLON",e[e.FF_EQUALS=61]="FF_EQUALS",e[e.FF_DASH=173]="FF_DASH",e[e.FF_HASH=163]="FF_HASH",e[e.QUESTION_MARK=63]="QUESTION_MARK",e[e.AT_SIGN=64]="AT_SIGN",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.META=91]="META",e[e.WIN_KEY_RIGHT=92]="WIN_KEY_RIGHT",e[e.CONTEXT_MENU=93]="CONTEXT_MENU",e[e.NUM_ZERO=96]="NUM_ZERO",e[e.NUM_ONE=97]="NUM_ONE",e[e.NUM_TWO=98]="NUM_TWO",e[e.NUM_THREE=99]="NUM_THREE",e[e.NUM_FOUR=100]="NUM_FOUR",e[e.NUM_FIVE=101]="NUM_FIVE",e[e.NUM_SIX=102]="NUM_SIX",e[e.NUM_SEVEN=103]="NUM_SEVEN",e[e.NUM_EIGHT=104]="NUM_EIGHT",e[e.NUM_NINE=105]="NUM_NINE",e[e.NUM_MULTIPLY=106]="NUM_MULTIPLY",e[e.NUM_PLUS=107]="NUM_PLUS",e[e.NUM_MINUS=109]="NUM_MINUS",e[e.NUM_PERIOD=110]="NUM_PERIOD",e[e.NUM_DIVISION=111]="NUM_DIVISION",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.NUMLOCK=144]="NUMLOCK",e[e.SCROLL_LOCK=145]="SCROLL_LOCK",e[e.FIRST_MEDIA_KEY=166]="FIRST_MEDIA_KEY",e[e.LAST_MEDIA_KEY=183]="LAST_MEDIA_KEY",e[e.SEMICOLON=186]="SEMICOLON",e[e.DASH=189]="DASH",e[e.EQUALS=187]="EQUALS",e[e.COMMA=188]="COMMA",e[e.PERIOD=190]="PERIOD",e[e.SLASH=191]="SLASH",e[e.APOSTROPHE=192]="APOSTROPHE",e[e.TILDE=192]="TILDE",e[e.SINGLE_QUOTE=222]="SINGLE_QUOTE",e[e.OPEN_SQUARE_BRACKET=219]="OPEN_SQUARE_BRACKET",e[e.BACKSLASH=220]="BACKSLASH",e[e.CLOSE_SQUARE_BRACKET=221]="CLOSE_SQUARE_BRACKET",e[e.WIN_KEY=224]="WIN_KEY",e[e.MAC_FF_META=224]="MAC_FF_META",e[e.MAC_WK_CMD_LEFT=91]="MAC_WK_CMD_LEFT",e[e.MAC_WK_CMD_RIGHT=93]="MAC_WK_CMD_RIGHT",e[e.WIN_IME=229]="WIN_IME",e[e.VK_NONAME=252]="VK_NONAME",e[e.PHANTOM=255]="PHANTOM",e}(ie||{}),qo={};qo.arc=pe,qo.curve=Ne,qo.line=Po,qo.lineOnAxis=B,qo.lineTo=rt,qo.moveBy=ae,qo.moveTo=Ie,qo.point=L;var me={};me.Coordinate=k,me.KeyCodes=ie,me.Rect=j,me.Size=Y,me.Svg=T,me.aria=Ml,me.array=k$,me.browserEvents=Ho,me.colour=Lt,me.deprecation=em,me.dom=He,me.extensions=Qt,me.idGenerator=Wh,me.math=Ga,me.object=v$,me.parsing=Vl,me.string=er,me.style=Ni,me.svgMath=Ps,me.svgPaths=qo,me.toolbox=Li,me.userAgent=y_,me.xml=Xn;var K=class{constructor(e,t){if(this.type=t,this.targetConnection=null,this.disposed=!1,this.shadowDom=this.check=null,this.y=this.x=0,this.shadowState=null,this.sourceBlock_=e,e.id.includes("_connection"))throw Error(`Connection ID indicator is contained in block ID. This will cause problems with focus: ${e.id}.`);this.id=`${e.id}_connection_${Ee()}`}connect_(e){const t=M.INPUT_VALUE,i=this.getSourceBlock();var s=e.getSourceBlock();let n,l;if(e.isConnected()&&e.disconnectInternal(!1),this.isConnected()){const u=this.stashShadowState(),$=this.targetBlock();$.isShadow()?$.dispose(!1):(this.disconnectInternal(),n=$),this.applyShadowState(u)}ne()&&(l=new(P(f.BLOCK_MOVE))(s),l.setReason(["connect"])),Rn(this,e),s.setParent(i),l&&(l.recordNew(),D(l)),n&&(e=this.type===t?n.outputConnection:n.previousConnection)&&((s=K.getConnectionForOrphanedConnection(s,e))?e.connect(s):e.onFailedConnect(this))}dispose(){if(this.isConnected()){this.isSuperior()&&this.setShadowStateInternal();const e=this.targetBlock();e&&!e.isDeadOrDying()&&e.unplug()}this.disposed=!0}getSourceBlock(){return this.sourceBlock_}isSuperior(){return this.type===M.INPUT_VALUE||this.type===M.NEXT_STATEMENT}isConnected(){return!!this.targetConnection}getConnectionChecker(){return this.sourceBlock_.workspace.connectionChecker}onFailedConnect(e){}connect(e){if(this.targetConnection===e)return!0;if(this.getConnectionChecker().canConnect(this,e,!1)){const t=o.getGroup$$module$build$src$core$events$utils();t||o.setGroup$$module$build$src$core$events$utils(!0),this.isSuperior()?this.connect_(e):e.connect_(this),o.setGroup$$module$build$src$core$events$utils(t)}return this.isConnected()}disconnect(){this.disconnectInternal()}disconnectInternal(e=!0){const{parentConnection:t,childConnection:i}=this.getParentAndChildConnections();if(!t||!i)throw Error("Source connection not connected.");const s=o.getGroup$$module$build$src$core$events$utils();let n;s||o.setGroup$$module$build$src$core$events$utils(!0),ne()&&(n=new(P(f.BLOCK_MOVE))(i.getSourceBlock()),n.setReason(["disconnect"]));const l=this.targetConnection;l&&(l.targetConnection=null),this.targetConnection=null,e&&i.getSourceBlock().setParent(null),n&&(n.recordNew(),D(n)),i.getSourceBlock().isShadow()||t.respawnShadow_(),o.setGroup$$module$build$src$core$events$utils(s)}getParentAndChildConnections(){return this.targetConnection?this.isSuperior()?{parentConnection:this,childConnection:this.targetConnection}:{parentConnection:this.targetConnection,childConnection:this}:{}}respawnShadow_(){this.createShadowBlock(!0)}reconnect(e,t){return!(this.getSourceBlock().isDeadOrDying()||(t=null==(i=e.getInput(t))?void 0:i.connection,(i=this.targetBlock())&&i!==e||!t||t.targetConnection===this||(t.isConnected()&&t.disconnect(),t.connect(this),0)));var i}targetBlock(){if(this.isConnected()){let e,t;return null!=(t=null==(e=this.targetConnection)?void 0:e.getSourceBlock())?t:null}return null}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()}setCheck(e){return e?(Array.isArray(e)||(e=[e]),this.check=e,this.onCheckChanged_()):this.check=null,this}getCheck(){return this.check}setShadowDom(e){this.setShadowStateInternal({shadowDom:e})}getShadowDom(e){return e&&this.targetBlock().isShadow()?W(this.targetBlock()):this.shadowDom}setShadowState(e){this.setShadowStateInternal({shadowState:e})}getShadowState(e){return e&&this.targetBlock()&&this.targetBlock().isShadow()?pt(this.targetBlock()):this.shadowState}neighbours(e){return[]}getParentInput(){let e=null;const t=this.sourceBlock_.inputList;for(let i=0;i<t.length;i++)if(t[i].connection===this){e=t[i];break}return e}toString(){const e=this.sourceBlock_;if(!e)return"Orphan Connection";if(e.outputConnection===this)var t="Output Connection of ";else if(e.previousConnection===this)t="Previous Connection of ";else if(e.nextConnection===this)t="Next Connection of ";else{t=null;for(let s,i=0;s=e.inputList[i];i++)if(s.connection===this){t=s;break}if(!t)return console.warn("Connection not actually connected to sourceBlock_"),"Orphan Connection";t='Input "'+t.name+'" connection on '}return t+e.toDevString()}stashShadowState(){const e=this.getShadowDom(!0),t=this.getShadowState(!0);return this.shadowState=this.shadowDom=null,{shadowDom:e,shadowState:t}}applyShadowState({shadowDom:e,shadowState:t}){this.shadowDom=e,this.shadowState=t}setShadowStateInternal({shadowDom:e=null,shadowState:t=null}={}){this.shadowDom=e,this.shadowState=t,this.getSourceBlock().isDeadOrDying()||((e=this.targetBlock())?e.isShadow()?(e.dispose(!1),this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow(this.targetBlock())):(e=this.createShadowBlock(!1),this.serializeShadow(e),e&&e.dispose(!1)):(this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow(this.targetBlock())))}createShadowBlock(e){var t=this.getSourceBlock();const i=this.getShadowState(),s=this.getShadowDom();if(t.isDeadOrDying()||!i&&!s)return null;if(i)return mi(i,t.workspace,{parentConnection:e?this:void 0,isShadow:!0,recordUndo:!1});if(s){if(t=At(s,t.workspace),e)if(this.type===M.INPUT_VALUE){if(!t.outputConnection)throw Error("Shadow block is missing an output connection");if(!this.connect(t.outputConnection))throw Error("Could not connect shadow block to connection")}else{if(this.type!==M.NEXT_STATEMENT)throw Error("Cannot connect a shadow block to a previous/output connection");if(!t.previousConnection)throw Error("Shadow block is missing previous connection");if(!this.connect(t.previousConnection))throw Error("Could not connect shadow block to connection")}return t}return null}serializeShadow(e){e&&(this.shadowDom=W(e),this.shadowState=pt(e))}static getConnectionForOrphanedConnection(e,t){if(t.type===M.OUTPUT_VALUE)return $l(e,t.getSourceBlock());e=e.lastConnectionInStack(!0);const i=t.getConnectionChecker();return e&&i.canConnect(t,e,!1)?e:null}};K.CAN_CONNECT=0,K.REASON_SELF_CONNECTION=1,K.REASON_WRONG_TYPE=2,K.REASON_TARGET_NULL=3,K.REASON_CHECKS_FAILED=4,K.REASON_DIFFERENT_WORKSPACES=5,K.REASON_SHADOW_PARENT=6,K.REASON_DRAG_CHECKS_FAILED=7,K.REASON_PREVIOUS_AND_OUTPUT=8;var ym=class extends Error{constructor(e){super(`Tried to append an icon of type ${e.getType()} when an icon of that type already exists on the block. Use getIcon to access the existing icon.`),this.icon=e}},Cm={};Cm.DuplicateIconType=ym,function(e){e[e.LEFT=-1]="LEFT",e[e.CENTRE=0]="CENTRE",e[e.RIGHT=1]="RIGHT"}(o.Align$$module$build$src$core$inputs$align||(o.Align$$module$build$src$core$inputs$align={}));var Vi=class extends ee{constructor(e,t,i){super(ee.SKIP_SETUP),this.class=null,this.EDITABLE=!1,this.maxDisplayLength=1/0,e!==ee.SKIP_SETUP&&(i?this.configure_(i):this.class=t||null,this.setValue(e))}configure_(e){super.configure_(e),e.class&&(this.class=e.class)}initView(){this.createTextElement_(),this.class&&R(this.getTextElement(),this.class),this.fieldGroup_&&R(this.fieldGroup_,"blocklyLabelField")}doClassValidation_(e){return null==e?null:`${e}`}setClass(e){this.textElement_&&(this.class&&X(this.textElement_,this.class),e&&R(this.textElement_,e)),this.class=e}static fromJson(e){return new this(ge(e.text),void 0,e)}};bt("field_label",Vi),Vi.prototype.DEFAULT_VALUE="";var zo=[];zo[M.INPUT_VALUE]=M.OUTPUT_VALUE,zo[M.OUTPUT_VALUE]=M.INPUT_VALUE,zo[M.NEXT_STATEMENT]=M.PREVIOUS_STATEMENT,zo[M.PREVIOUS_STATEMENT]=M.NEXT_STATEMENT;var zl="RENAME_VARIABLE_ID",jl="DELETE_VARIABLE_ID",Pe=class extends K{constructor(e,t){super(e,t),this.highlighted=!1,this.targetConnection=null,this.db=e.workspace.connectionDBList[t],this.dbOpposite=e.workspace.connectionDBList[zo[t]],this.offsetInBlock=new k(0,0),this.trackedState=Pe.TrackedState.WILL_TRACK}dispose(){let e,t;super.dispose(),this.trackedState===Pe.TrackedState.TRACKED&&this.db.removeConnection(this,this.y),null==(t=(e=this.sourceBlock_.pathObject).removeConnectionHighlight)||t.call(e,this)}getSourceBlock(){return super.getSourceBlock()}targetBlock(){return super.targetBlock()}distanceFrom(e){const t=this.x-e.x;return e=this.y-e.y,Math.sqrt(t*t+e*e)}bumpAwayFrom(e,t=!1){if(!this.sourceBlock_.workspace.isDragging()){var i=o.config$$module$build$src$core$config.snapRadius+Math.floor(10*Math.random()),s=o.config$$module$build$src$core$config.snapRadius+Math.floor(10*Math.random()),n=e.sourceBlock_.getRootBlock(),l=this.sourceBlock_.getRootBlock();if(!n.isInFlyout&&!l.isInFlyout){var u=!0;if(l.isMovable())n.isMovable()&&t&&(s=-s);else{if(!n.isMovable())return;u=!1,i=-i,s=-s}(n=u?l:n).RTL&&(i=-i),n.moveBy((t=u?e:this).x+i-(e=u?this:e).x,t.y+s-e.y,["bump"])}}}moveTo(e,t){let i=!1;return this.trackedState===Pe.TrackedState.WILL_TRACK?(this.db.addConnection(this,t),this.trackedState=Pe.TrackedState.TRACKED,i=!0):this.trackedState===Pe.TrackedState.TRACKED&&(this.db.removeConnection(this,this.y),this.db.addConnection(this,t),i=!0),this.x=e,this.y=t,i}moveBy(e,t){return this.moveTo(this.x+e,this.y+t)}moveToOffset(e){return this.moveTo(e.x+this.offsetInBlock.x,e.y+this.offsetInBlock.y)}setOffsetInBlock(e,t){this.offsetInBlock.x=e,this.offsetInBlock.y=t}getOffsetInBlock(){return this.offsetInBlock}tightenEfficiently(){var e=this.targetConnection;const t=this.targetBlock();e&&t&&(e=k.difference(this.offsetInBlock,e.offsetInBlock),t.translate(e.x,e.y))}closest(e,t){return this.dbOpposite.searchForClosest(this,e,t)}highlight(){this.highlighted=!0;const e=this.findHighlightSvg();e&&(e.style.display="")}unhighlight(){this.highlighted=!1;const e=this.findHighlightSvg();e&&(e.style.display="none")}isHighlighted(){return this.highlighted}setTracking(e){e&&this.trackedState===Pe.TrackedState.TRACKED||!e&&this.trackedState===Pe.TrackedState.UNTRACKED||this.sourceBlock_.isInFlyout||(e?(this.db.addConnection(this,this.y),this.trackedState=Pe.TrackedState.TRACKED):(this.trackedState===Pe.TrackedState.TRACKED&&this.db.removeConnection(this,this.y),this.trackedState=Pe.TrackedState.UNTRACKED))}stopTrackingAll(){if(this.setTracking(!1),this.targetConnection){const e=this.targetBlock().getDescendants(!1);for(let t=0;t<e.length;t++){const i=e[t],s=i.getConnections_(!0);for(let n=0;n<s.length;n++)s[n].setTracking(!1);for(const n of i.getIcons())Ao(n)&&n.setBubbleVisible(!1)}}}startTrackingAll(){this.setTracking(!0);let e=[];if(this.type!==M.INPUT_VALUE&&this.type!==M.NEXT_STATEMENT)return e;const t=this.targetBlock();if(t){let i;t.isCollapsed()?(i=[],t.outputConnection&&i.push(t.outputConnection),t.nextConnection&&i.push(t.nextConnection),t.previousConnection&&i.push(t.previousConnection)):i=t.getConnections_(!0);for(let s=0;s<i.length;s++)e.push(...i[s].startTrackingAll());e.length||(e=[t])}return e}onFailedConnect(e){const t=this.getSourceBlock();if(Se()){const i=o.getGroup$$module$build$src$core$events$utils();setTimeout(function(){t.isDisposed()||t.getParent()||(o.setGroup$$module$build$src$core$events$utils(i),this.bumpAwayFrom(e),o.setGroup$$module$build$src$core$events$utils(!1))}.bind(this),o.config$$module$build$src$core$config.bumpDelay)}}disconnectInternal(e=!0){const{parentConnection:t,childConnection:i}=this.getParentAndChildConnections();if(t&&i){var s=o.getGroup$$module$build$src$core$events$utils();s||o.setGroup$$module$build$src$core$events$utils(!0);var n=t.getSourceBlock(),l=i.getSourceBlock();super.disconnectInternal(e),n.queueRender(),l.updateDisabled(),l.queueRender(),l.getSvgRoot().style.display="block",o.setGroup$$module$build$src$core$events$utils(s)}}respawnShadow_(){super.respawnShadow_();const e=this.targetBlock();e&&(e.initSvg(),e.queueRender())}neighbours(e){return this.dbOpposite.getNeighbours(this,e)}connect_(e){super.connect_(e);var t=this.getSourceBlock();e=e.getSourceBlock(),t.updateDisabled(),e.updateDisabled(),e.queueRender(),(t=t.getInputWithBlock(e))&&(t=t.isVisible(),e.getSvgRoot().style.display=t?"block":"none")}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()}setCheck(e){return super.setCheck(e),this.sourceBlock_.queueRender(),this}showContextMenu(e){const t=q.registry.getContextMenuOptions({focusedNode:this},e);if(t.length){var i=this.getSourceBlock(),s=i.workspace;if(e instanceof PointerEvent)var n=new k(e.clientX,e.clientY);else n=new k(this.x,this.y),n=cs(s,n).translate(i.RTL?-5:5,5);Ei(e,t,i.RTL,s,n)}}getFocusableElement(){const e=this.findHighlightSvg();if(e)return e;throw Error("No highlight SVG found corresponding to this connection.")}getFocusableTree(){return this.getSourceBlock().workspace}onNodeFocus(){this.highlight()}onNodeBlur(){this.unhighlight()}canBeFocused(){return!0}findHighlightSvg(){return document.getElementById(this.id)}};!function(e){(e=e.TrackedState||(e.TrackedState={}))[e.WILL_TRACK=-1]="WILL_TRACK",e[e.UNTRACKED=0]="UNTRACKED",e[e.TRACKED=1]="TRACKED"}(Pe||(Pe={}));var Pb=Pe.TrackedState,xm={};xm.RenderedConnection=Pe,xm.TrackedState=Pb;var qs=class{constructor(e,t){this.name=e,this.sourceBlock=t,this.fieldRow=[],this.align=o.Align$$module$build$src$core$inputs$align.LEFT,this.visible=!0,this.type=o.inputTypes$$module$build$src$core$inputs$input_types.CUSTOM,this.connection=null}getSourceBlock(){return this.sourceBlock}appendField(e,t){return this.insertFieldAt(this.fieldRow.length,e,t),this}insertFieldAt(e,t,i){if(e<0||e>this.fieldRow.length)throw Error("index "+e+" out of bounds.");return(t||""===t&&i)&&("string"==typeof t&&(t=o.fromJson$$module$build$src$core$field_registry({type:"field_label",text:t})),t.setSourceBlock(this.sourceBlock),this.sourceBlock.initialized&&this.initField(t),t.name=i,t.setVisible(this.isVisible()),t.prefixField&&(e=this.insertFieldAt(e,t.prefixField)),this.fieldRow.splice(e,0,t),e++,t.suffixField&&(e=this.insertFieldAt(e,t.suffixField)),this.sourceBlock.rendered&&this.sourceBlock.queueRender()),e}removeField(e,t){for(let s,i=0;s=this.fieldRow[i];i++)if(s.name===e)return s.dispose(),this.fieldRow.splice(i,1),this.sourceBlock.rendered&&this.sourceBlock.queueRender(),!0;if(t)return!1;throw Error('Field "'+e+'" not found.')}isVisible(){return this.visible}setVisible(e){let t=[];if(this.visible===e)return t;this.visible=e;for(let s,i=0;s=this.fieldRow[i];i++)s.setVisible(e);if(this.connection&&this.connection instanceof Pe){e?t=this.connection.startTrackingAll():this.connection.stopTrackingAll();const i=this.connection.targetBlock();i&&(i.getSvgRoot().style.display=e?"block":"none")}return t}markDirty(){for(let t,e=0;t=this.fieldRow[e];e++)t.markDirty()}setCheck(e){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setCheck(e),this}setAlign(e){return this.align=e,this.sourceBlock.rendered&&this.sourceBlock.queueRender(),this}setShadowDom(e){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setShadowDom(e),this}getShadowDom(){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.getShadowDom()}init(){for(const e of this.fieldRow)e.init()}initModel(){for(const e of this.fieldRow)e.initModel()}initField(e){this.sourceBlock.rendered?e.init():e.initModel()}dispose(){for(let t,e=0;t=this.fieldRow[e];e++)t.dispose();this.connection&&this.connection.dispose()}makeConnection(e){return this.sourceBlock.makeConnection_(e)}},eo=class extends qs{constructor(e,t){super(e,t),this.name=e,this.type=o.inputTypes$$module$build$src$core$inputs$input_types.DUMMY}},mo=class extends qs{constructor(e,t){super(e,t),this.name=e,this.type=o.inputTypes$$module$build$src$core$inputs$input_types.END_ROW}},mt=class extends qs{constructor(e,t){if(!e)throw Error("Statement inputs must have a non-empty name");super(e,t),this.name=e,this.type=o.inputTypes$$module$build$src$core$inputs$input_types.STATEMENT,this.connection=this.makeConnection(M.NEXT_STATEMENT)}};o.ValueInput$$module$build$src$core$inputs$value_input=class extends qs{constructor(e,t){if(!e)throw Error("Value inputs must have a non-empty name");super(e,t),this.name=e,this.type=o.inputTypes$$module$build$src$core$inputs$input_types.VALUE,this.connection=this.makeConnection(M.INPUT_VALUE)}};var zs=class{constructor(e,t,i){if(this.data=null,this.disposed=!1,this.hue=null,this.colour_="#000000",this.styleName_="",this.suppressPrefixSuffix=!1,this.previousConnection=this.nextConnection=this.outputConnection=null,this.inputList=[],this.icons=[],this.disabledReasons=new Set,this.tooltip="",this.contextMenu=!0,this.parentBlock_=null,this.childBlocks_=[],this.editable=this.movable=this.deletable=!0,this.collapsed_=this.shadow=!1,this.outputShape_=null,this.rendered=this.isInsertionMarker_=this.initialized=this.disposing=!1,this.onchangeWrapper=this.helpUrl=null,this.statementInputCount=0,this.workspace=e,this.id=i&&!e.getBlockById(i)?i:ve(),e.setBlockById(this.id,this),this.xy=new k(0,0),this.isInFlyout=e.isFlyout,this.isInMutator=e.isMutator,this.RTL=e.RTL,t){if(this.type=t,!(i=ue[t])||"object"!=typeof i)throw TypeError("Invalid block definition for type: "+t);Object.assign(this,i)}e.addTopBlock(this),e.addTypedBlock(this),new.target===zs&&this.doInit_()}doInit_(){const e=o.getGroup$$module$build$src$core$events$utils();e||o.setGroup$$module$build$src$core$events$utils(!0);const t=Se();try{"function"==typeof this.init&&(o.setRecordUndo$$module$build$src$core$events$utils(!1),this.init(),o.setRecordUndo$$module$build$src$core$events$utils(t)),ne()&&D(new(P(f.BLOCK_CREATE))(this))}finally{o.setGroup$$module$build$src$core$events$utils(e),o.setRecordUndo$$module$build$src$core$events$utils(t)}this.inputsInlineDefault=this.inputsInline,"function"==typeof this.onchange&&this.setOnChange(this.onchange)}dispose(e=!1){this.disposing=!0,this.onchangeWrapper&&this.workspace.removeChangeListener(this.onchangeWrapper),this.unplug(e),ne()&&D(new(P(f.BLOCK_DELETE))(this)),this.workspace.removeTopBlock(this),this.disposeInternal()}disposeInternal(){this.disposing=!0,this.onchangeWrapper&&this.workspace.removeChangeListener(this.onchangeWrapper),this.workspace.removeTypedBlock(this),this.workspace.removeBlockById(this.id),"function"==typeof this.destroy&&this.destroy(),this.childBlocks_.forEach(e=>e.disposeInternal()),this.inputList.forEach(e=>e.dispose()),this.inputList.length=0,this.getConnections_(!0).forEach(e=>e.dispose()),this.disposed=!0}isDeadOrDying(){return this.disposing||this.disposed}initModel(){if(!this.initialized){for(const e of this.inputList)e.initModel();this.initialized=!0}}unplug(e){this.outputConnection&&this.unplugFromRow(e),this.previousConnection&&this.unplugFromStack(e)}unplugFromRow(e){let i,t=null;null!=(i=this.outputConnection)&&i.isConnected()&&(t=this.outputConnection.targetConnection,this.outputConnection.disconnect()),t&&e&&(e=this.getOnlyValueConnection())&&e.isConnected()&&!e.targetBlock().isShadow()&&(e=e.targetConnection,e?.disconnect(),this.workspace.connectionChecker.canConnect(e,t,!1)?t.connect(e):e?.onFailedConnect(t))}getOnlyValueConnection(){let e=null;for(let t=0;t<this.inputList.length;t++){const i=this.inputList[t].connection;if(i&&i.type===M.INPUT_VALUE&&i.targetConnection){if(e)return null;e=i}}return e}unplugFromStack(e){let t=null;var i;if(null!=(i=this.previousConnection)&&i.isConnected()&&(t=this.previousConnection.targetConnection,this.previousConnection.disconnect()),i=this.getNextBlock(),e&&i&&!i.isShadow()){let s,n;e=null!=(n=null==(s=this.nextConnection)?void 0:s.targetConnection)?n:null,e?.disconnect(),t&&this.workspace.connectionChecker.canConnect(t,e,!1)&&t.connect(e)}}getConnections_(e){e=[],this.outputConnection&&e.push(this.outputConnection),this.previousConnection&&e.push(this.previousConnection),this.nextConnection&&e.push(this.nextConnection);for(let i,t=0;i=this.inputList[t];t++)i.connection&&e.push(i.connection);return e}lastConnectionInStack(e){let t=this.nextConnection;for(;t;){const i=t.targetBlock();if(!i||e&&i.isShadow())return t;t=i.nextConnection}return null}bumpNeighbours(){}getParent(){return this.parentBlock_}getInputWithBlock(e){for(let i,t=0;i=this.inputList[t];t++)if(i.connection&&i.connection.targetBlock()===e)return i;return null}getSurroundParent(){let t,e=this;do{if(t=e,e=e.getParent(),!e)return null}while(e.getNextBlock()===t);return e}getNextBlock(){return this.nextConnection&&this.nextConnection.targetBlock()}getPreviousBlock(){return this.previousConnection&&this.previousConnection.targetBlock()}getRootBlock(){let e,t=this;do{e=t,t=e.parentBlock_}while(t);return e}getTopStackBlock(){let t,e=this;do{t=e.getPreviousBlock()}while(t&&t.getNextBlock()===e&&(e=t));return e}getChildren(e){if(!e)return this.childBlocks_;e=[];for(let s,i=0;s=this.inputList[i];i++)if(s.connection){var t=s.connection.targetBlock();t&&e.push(t)}return(t=this.getNextBlock())&&e.push(t),e}setParent(e){if(e!==this.parentBlock_){var t=this.previousConnection&&this.previousConnection.targetBlock()||this.outputConnection&&this.outputConnection.targetBlock(),i=!!t;if(i&&e&&t!==e)throw Error("Block connected to superior one that is not new parent.");if(!i&&e)throw Error("Block not connected to new parent.");if(i&&!e)throw Error("Cannot set parent to null while block is still connected to superior block.");this.parentBlock_?ht(this.parentBlock_.childBlocks_,this):this.workspace.removeTopBlock(this),(this.parentBlock_=e)?e.childBlocks_.push(this):this.workspace.addTopBlock(this)}}getDescendants(e){const t=[this],i=this.getChildren(e);for(let s,n=0;s=i[n];n++)t.push(...s.getDescendants(e));return t}isDeletable(){return this.deletable&&!this.isInFlyout&&!this.shadow&&!this.isDeadOrDying()&&!this.workspace.isReadOnly()}isOwnDeletable(){return this.deletable}setDeletable(e){this.deletable=e}isMovable(){return this.movable&&!this.isInFlyout&&!this.shadow&&!this.isDeadOrDying()&&!this.workspace.isReadOnly()}isOwnMovable(){return this.movable}setMovable(e){this.movable=e}isDuplicatable(){return!this.workspace.hasBlockLimits()||this.workspace.isCapacityAvailable(ls(this,!0))}isShadow(){return this.shadow}setShadow(e){this.shadow=e}isInsertionMarker(){return this.isInsertionMarker_}setInsertionMarker(e){this.isInsertionMarker_=e}isEditable(){return this.editable&&!this.isDeadOrDying()&&!this.workspace.isReadOnly()}isOwnEditable(){return this.editable}setEditable(e){this.editable=e;for(const t of this.getFields())t.updateEditable()}isDisposed(){return this.disposed}isSimpleReporter(){if(!this.outputConnection)return!1;for(const e of this.inputList)if(e.connection||e.fieldRow.length>1)return!1;return!0}getMatchingConnection(e,t){const i=this.getConnections_(!0);if(e=e.getConnections_(!0),i.length!==e.length)throw Error("Connection lists did not match in length.");for(let s=0;s<e.length;s++)if(e[s]===t)return i[s];return null}setHelpUrl(e){this.helpUrl=e}setTooltip(e){this.tooltip=e}getTooltip(){return $s(this)}getColour(){return this.colour_}getStyleName(){return this.styleName_}getHue(){return this.hue}setColour(e){e=bi(e),this.hue=e.hue,this.colour_=e.hex}setStyle(e){this.styleName_=e}setOnChange(e){if(e&&"function"!=typeof e)throw Error("onchange must be a function.");this.onchangeWrapper&&this.workspace.removeChangeListener(this.onchangeWrapper),this.onchange=e,this.onchangeWrapper=e.bind(this),this.workspace.addChangeListener(this.onchangeWrapper)}getField(e){if("string"!=typeof e)throw TypeError("Block.prototype.getField expects a string with the field name but received "+(void 0===e?"nothing":e+" of type "+typeof e)+" instead");for(const t of this.getFields())if(t.name===e)return t;return null}*getFields(){for(const e of this.inputList)for(const t of e.fieldRow)yield t}getVars(){const e=[];for(const t of this.getFields())t.referencesVariables()&&e.push(t.getValue());return e}getVarModels(){const e=[];for(const t of this.getFields())if(t.referencesVariables()){const i=this.workspace.getVariableById(t.getValue());i&&e.push(i)}return e}updateVarName(e){for(const t of this.getFields())t.referencesVariables()&&e.getId()===t.getValue()&&t.refreshVariableName()}renameVarById(e,t){for(const i of this.getFields())i.referencesVariables()&&e===i.getValue()&&i.setValue(t)}getFieldValue(e){return(e=this.getField(e))?e.getValue():null}setFieldValue(e,t){const i=this.getField(t);if(!i)throw Error('Field "'+t+'" not found.');i.setValue(e)}setPreviousStatement(e,t){if(e)void 0===t&&(t=null),this.previousConnection||(this.previousConnection=this.makeConnection_(M.PREVIOUS_STATEMENT)),this.previousConnection.setCheck(t);else if(this.previousConnection){if(this.previousConnection.isConnected())throw Error("Must disconnect previous statement before removing connection.");this.previousConnection.dispose(),this.previousConnection=null}}setNextStatement(e,t){if(e)void 0===t&&(t=null),this.nextConnection||(this.nextConnection=this.makeConnection_(M.NEXT_STATEMENT)),this.nextConnection.setCheck(t);else if(this.nextConnection){if(this.nextConnection.isConnected())throw Error("Must disconnect next statement before removing connection.");this.nextConnection.dispose(),this.nextConnection=null}}setOutput(e,t){if(e)void 0===t&&(t=null),this.outputConnection||(this.outputConnection=this.makeConnection_(M.OUTPUT_VALUE)),this.outputConnection.setCheck(t);else if(this.outputConnection){if(this.outputConnection.isConnected())throw Error("Must disconnect output value before removing connection.");this.outputConnection.dispose(),this.outputConnection=null}}setInputsInline(e){this.inputsInline!==e&&(D(new(P(f.BLOCK_CHANGE))(this,"inline",null,this.inputsInline,e)),this.inputsInline=e)}getInputsInline(){if(void 0!==this.inputsInline)return this.inputsInline;for(var e=1;e<this.inputList.length;e++)if(this.inputList[e-1]instanceof eo&&this.inputList[e]instanceof eo)return!1;for(e=1;e<this.inputList.length;e++)if(this.inputList[e-1]instanceof o.ValueInput$$module$build$src$core$inputs$value_input&&this.inputList[e]instanceof eo)return!0;for(e=0;e<this.inputList.length;e++)if(this.inputList[e]instanceof mo)return!0;return!1}setOutputShape(e){this.outputShape_=e}getOutputShape(){return this.outputShape_}isEnabled(){return 0===this.disabledReasons.size}setDisabledReason(e,t){e||this.workspace.options.disable||!this.hasDisabledReason(Mt)||t==Mt||this.setDisabledReason(!1,Mt),this.disabledReasons.has(t)!==e&&(e?this.disabledReasons.add(t):this.disabledReasons.delete(t),(e=new(P(f.BLOCK_CHANGE))(this,"disabled",null,!e,e)).setDisabledReason(t),D(e))}getInheritedDisabled(){let e=this.getSurroundParent();for(;e;){if(!e.isEnabled())return!0;e=e.getSurroundParent()}return!1}hasDisabledReason(e){return this.disabledReasons.has(e)}getDisabledReasons(){return this.disabledReasons}isCollapsed(){return this.collapsed_}setCollapsed(e){this.collapsed_!==e&&(D(new(P(f.BLOCK_CHANGE))(this,"collapsed",null,this.collapsed_,e)),this.collapsed_=e)}toString(e,t){t=this.toTokens(t);for(let s=2;s<t.length;s++)"("===t[s-2]&&")"===t[s]&&(t[s-2]=t[s-1],t.splice(s-1,2));let i="";return t=(t=t.reduce((s,n)=>(s=s+("("===i||")"===n?"":" ")+n,i=n[n.length-1],s),"")).trim()||"???",e&&t.length>e&&(t=t.substring(0,e-3)+"..."),t}toTokens(e="?"){const t=[];for(const s of this.inputList)if(s.name!=Kn){for(const n of s.fieldRow)t.push(n.getText());if(s.connection){const n=s.connection.targetBlock();if(n){var i=s.connection;let l=i.getCheck();!l&&i.targetConnection&&(l=i.targetConnection.getCheck()),(i=!!l&&(l.includes("Boolean")||l.includes("Number")))&&t.push("("),t.push(...n.toTokens(e)),i&&t.push(")")}else t.push(e)}}return t}appendValueInput(e){return this.appendInput(new o.ValueInput$$module$build$src$core$inputs$value_input(e,this))}appendStatementInput(e){return this.statementInputCount++,this.appendInput(new mt(e,this))}appendDummyInput(e=""){return this.appendInput(new eo(e,this))}appendEndRowInput(e=""){return this.appendInput(new mo(e,this))}appendInput(e){return this.inputList.push(e),e}appendInputFromRegistry(e,t){return(e=ot(x.INPUT,e,!1))?this.appendInput(new e(t,this)):null}jsonInit(e){var t=e.type?'Block "'+e.type+'": ':"";if(e.output&&e.previousStatement)throw Error(t+"Must not have both an output and a previousStatement.");for(var i=0;e["args"+i];){if(void 0===e["message"+i])throw Error(t+`args${i} must have a corresponding message (message${i}).`);i++}if(e.style&&e.style.hat&&(this.hat=e.style.hat,e.style=null),e.style&&e.colour)throw Error(t+"Must not have both a colour and a style.");for(e.style?this.jsonInitStyle(e,t):this.jsonInitColour(e,t),i=0;void 0!==e["message"+i];)this.interpolate(e["message"+i],e["args"+i]||[],e["implicitAlign"+i]||e["lastDummyAlign"+i],t),i++;if(void 0!==e.inputsInline&&(o.disable$$module$build$src$core$events$utils(),this.setInputsInline(e.inputsInline),o.enable$$module$build$src$core$events$utils()),void 0!==e.output&&this.setOutput(!0,e.output),void 0!==e.outputShape&&this.setOutputShape(e.outputShape),void 0!==e.previousStatement&&this.setPreviousStatement(!0,e.previousStatement),void 0!==e.nextStatement&&this.setNextStatement(!0,e.nextStatement),void 0!==e.tooltip&&(i=ge(e.tooltip),this.setTooltip(i)),void 0!==e.enableContextMenu&&(this.contextMenu=!!e.enableContextMenu),void 0!==e.suppressPrefixSuffix&&(this.suppressPrefixSuffix=!!e.suppressPrefixSuffix),void 0!==e.helpUrl&&(i=ge(e.helpUrl),this.setHelpUrl(i)),"string"==typeof e.extensions&&(console.warn(t+"JSON attribute 'extensions' should be an array of strings. Found raw string in JSON for '"+e.type+"' block."),e.extensions=[e.extensions]),void 0!==e.mutator&&Is(e.mutator,this,!0),e=e.extensions,Array.isArray(e))for(t=0;t<e.length;t++)Is(e[t],this,!1)}jsonInitColour(e,t){if("colour"in e)if(void 0===e.colour)console.warn(t+"Undefined colour value.");else{e=e.colour;try{this.setColour(e)}catch{console.warn(t+"Illegal colour value: ",e)}}}jsonInitStyle(e,t){e=e.style;try{this.setStyle(e)}catch{console.warn(t+"Style does not exist: ",e)}}mixin(e,t){if(void 0!==t&&"boolean"!=typeof t)throw Error("opt_disableCheck must be a boolean if provided");if(!t){t=[];for(const i in e)void 0!==this[i]&&t.push(i);if(t.length)throw Error("Mixin will overwrite block members: "+JSON.stringify(t))}Object.assign(this,e)}interpolate(e,t,i,s){e=Yr(e),this.validateTokens(e,t.length),t=this.interpolateArguments(e,t,i),i=[];for(let l,n=0;l=t[n];n++)if(this.isInputKeyword(l.type)){if(e=this.inputFromJson(l,s)){for(let $,u=0;$=i[u];u++)e.appendField($[0],$[1]);i.length=0}}else(e=this.fieldFromJson(l))&&i.push([e,l.name])}validateTokens(e,t){const i=[];let s=0;for(let n=0;n<e.length;n++){const l=e[n];if("number"==typeof l){if(l<1||l>t)throw Error('Block "'+this.type+'": Message index %'+l+" out of range.");if(i[l])throw Error('Block "'+this.type+'": Message index %'+l+" duplicated.");i[l]=!0,s++}}if(s!==t)throw Error('Block "'+this.type+'": Message does not reference all '+t+" arg(s).")}interpolateArguments(e,t,i){const s=[];for(let l=0;l<e.length;l++){var n=e[l];if("number"==typeof n&&(n=t[n-1]),"string"==typeof n)if("\n"===n)n={type:"input_end_row"},i&&(n.align=i);else if(!(n=this.stringToFieldJson(n)))continue;s.push(n)}return(e=s.length)&&!this.isInputKeyword(s[e-1].type)&&(e={type:"input_dummy"},i&&(e.align=i),s.push(e)),s}fieldFromJson(e){const t=o.fromJson$$module$build$src$core$field_registry(e);return!t&&e.alt?"string"==typeof e.alt?(e=this.stringToFieldJson(e.alt))?this.fieldFromJson(e):null:this.fieldFromJson(e.alt):t}inputFromJson(e,t){var i={LEFT:o.Align$$module$build$src$core$inputs$align.LEFT,RIGHT:o.Align$$module$build$src$core$inputs$align.RIGHT,CENTRE:o.Align$$module$build$src$core$inputs$align.CENTRE,CENTER:o.Align$$module$build$src$core$inputs$align.CENTRE};let s;switch(e.type){case"input_value":s=this.appendValueInput(e.name);break;case"input_statement":s=this.appendStatementInput(e.name);break;case"input_dummy":s=this.appendDummyInput(e.name);break;case"input_end_row":s=this.appendEndRowInput(e.name);break;default:s=this.appendInputFromRegistry(e.type,e.name)}return s?(e.check&&s.setCheck(e.check),e.align&&(void 0===(i=i[e.align.toUpperCase()])?console.warn(t+"Illegal align value: ",e.align):s.setAlign(i)),s):null}isInputKeyword(e){return"input_value"===e||"input_statement"===e||"input_dummy"===e||"input_end_row"===e||Jo(x.INPUT,e)}stringToFieldJson(e){return(e=e.trim())?{type:"field_label",text:e}:null}moveInputBefore(e,t){if(e!==t){var i=-1,s=t?-1:this.inputList.length;for(let l,n=0;l=this.inputList[n];n++)if(l.name===e){if(i=n,-1!==s)break}else if(t&&l.name===t&&(s=n,-1!==i))break;if(-1===i)throw Error('Named input "'+e+'" not found.');if(-1===s)throw Error('Reference input "'+t+'" not found.');this.moveNumberedInputBefore(i,s)}}moveNumberedInputBefore(e,t){if(e===t)throw Error("Can't move input to itself.");if(e>=this.inputList.length)throw RangeError("Input index "+e+" out of bounds.");if(t>this.inputList.length)throw RangeError("Reference input "+t+" out of bounds.");const i=this.inputList[e];this.inputList.splice(e,1),e<t&&t--,this.inputList.splice(t,0,i)}removeInput(e,t){for(let s,i=0;s=this.inputList[i];i++)if(s.name===e)return s instanceof mt&&this.statementInputCount--,s.dispose(),this.inputList.splice(i,1),!0;if(t)return!1;throw Error("Input not found: "+e)}getInput(e){for(let i,t=0;i=this.inputList[t];t++)if(i.name===e)return i;return null}getInputTargetBlock(e){return(e=this.getInput(e))&&e.connection&&e.connection.targetBlock()}getCommentText(){let e,t;return null!=(t=null==(e=this.getIcon(ke.COMMENT))?void 0:e.getText())?t:null}setCommentText(e){var t;let i;const s=null!=(i=null==(t=this.getIcon(ke.COMMENT))?void 0:t.getText())?i:null;if(s!==e){if(null!==e){if(!(t=this.getIcon(ke.COMMENT))){if(!(t=ot(x.ICON,ke.COMMENT.toString(),!1)))throw Error("No comment icon class is registered, so a comment cannot be set");if(t=new t(this),!On(t))throw Error("The class registered as a comment icon does not conform to the ICommentIcon interface");t=this.addIcon(t)}o.disable$$module$build$src$core$events$utils(),t.setText(e),o.enable$$module$build$src$core$events$utils()}else this.removeIcon(ke.COMMENT);D(new(P(f.BLOCK_CHANGE))(this,"comment",null,s,e))}}setWarningText(e,t){}setMutator(e){}addIcon(e){if(this.hasIcon(e.getType()))throw new ym(e);return this.icons.push(e),this.icons.sort((t,i)=>t.getWeight()-i.getWeight()),e}removeIcon(e){if(!this.hasIcon(e))return!1;let t;return null==(t=this.getIcon(e))||t.dispose(),this.icons=this.icons.filter(i=>!i.getType().equals(e)),!0}hasIcon(e){return this.icons.some(t=>t.getType().equals(e))}getIcon(e){return this.icons.find(e instanceof ke?t=>t.getType().equals(e):t=>t.getType().toString()===e)}getIcons(){return[...this.icons]}getRelativeToSurfaceXY(){return this.xy}moveBy(e,t,i){if(this.parentBlock_)throw Error("Block has parent");const s=new(P(f.BLOCK_MOVE))(this);i&&s.setReason(i),this.xy.translate(e,t),s.recordNew(),D(s)}makeConnection_(e){return new K(this,e)}allInputsFilled(e){if(void 0===e&&(e=!0),!e&&this.isShadow())return!1;for(let s,i=0;s=this.inputList[i];i++)if(s.connection){var t=s.connection.targetBlock();if(!t||!t.allInputsFilled(e))return!1}return!(t=this.getNextBlock())||t.allInputsFilled(e)}toDevString(){let e=this.type?'"'+this.type+'" block':"Block";return this.id&&(e+=' (id="'+this.id+'")'),e}};zs.COLLAPSED_INPUT_NAME=Kn,zs.COLLAPSED_FIELD_NAME=Ll;var pu=null,Yl=null,Xl={};Xl.connectionUiEffect=Nn,Xl.disconnectUiEffect=Ln,Xl.disconnectUiStop=Bo,Xl.disposeUiEffect=wi;var cr=class{paste(e,t,i){if(!t.isCapacityAvailable(e.typeCounts))return null;let s;i&&(e.blockState.x=i.x,e.blockState.y=i.y),i=i||new k(e.blockState.x||0,e.blockState.y||0),o.disable$$module$build$src$core$events$utils();try{s=So(e.blockState,t),ws(s,i)}finally{o.enable$$module$build$src$core$events$utils()}if(!s)return s;ne()&&!s.isShadow()&&D(new(P(f.BLOCK_CREATE))(s));const n=s;return Zt().then(()=>o.getFocusManager$$module$build$src$core$focus_manager().focusNode(n)),s}};cr.TYPE="block",wr(cr.TYPE,new cr);var wm={};wm.BlockPaster=cr,wm.moveBlockToNotConflict=ws;var gu={};gu.bumpIntoBounds=Rt,gu.bumpIntoBoundsHandler=Pn,gu.bumpTopObjectsIntoBounds=Ss;var Sp=class{constructor(e){this.block=e,this.connectionPreviewer=this.connectionCandidate=this.startLoc=this.startChildConn=this.startParentConn=null,this.dragging=!1,this.dragOffset=new k(0,0),this.originalEventGroup="",this.workspace=e.workspace}isMovable(){if(this.block.isShadow()){let e,t;return null!=(t=null==(e=this.block.getParent())?void 0:e.isMovable())&&t}return this.block.isOwnMovable()&&!this.block.isDeadOrDying()&&!this.workspace.isReadOnly()&&!this.block.isInFlyout}startDrag(e){var t;this.block.isShadow()?this.startDraggingShadow(e):(this.dragging=!0,this.fireDragStartEvent(),this.startLoc=this.block.getRelativeToSurfaceXY(),this.connectionCandidate=null,this.connectionPreviewer=new(Re(x.CONNECTION_PREVIEWER,this.workspace.options))(this.block),b(),this.workspace.setResizesEnabled(!1),Bo(),e=this.shouldHealStack(e),this.shouldDisconnect(e)&&this.disconnectBlock(e),this.block.setDragging(!0),null==(t=this.workspace.getLayerManager())||t.moveToDragLayer(this.block))}shouldHealStack(e){return!!e&&(e.altKey||e.ctrlKey||e.metaKey)}startDraggingShadow(e){const t=this.block.getParent();if(!t)throw Error("Tried to drag a shadow block with no parent. Shadow blocks should always have parents.");this.dragOffset=k.difference(t.getRelativeToSurfaceXY(),this.block.getRelativeToSurfaceXY()),t.startDrag(e)}shouldDisconnect(e){return!!(this.block.getParent()||e&&this.block.nextConnection&&this.block.nextConnection.targetBlock())}disconnectBlock(e){let t,i,s;if(this.startParentConn=null!=(s=null==(t=this.block.outputConnection)?void 0:t.targetConnection)?s:null==(i=this.block.previousConnection)?void 0:i.targetConnection,e){let n;this.startChildConn=null==(n=this.block.nextConnection)?void 0:n.targetConnection}this.block.unplug(e),Ln(this.block)}fireDragStartEvent(){const e=new(P(f.BLOCK_DRAG))(this.block,!0,this.block.getDescendants(!1));D(e)}fireDragEndEvent(){const e=new(P(f.BLOCK_DRAG))(this.block,!1,this.block.getDescendants(!1));D(e)}fireMoveEvent(){if(!this.block.isDeadOrDying()){var e=new(P(f.BLOCK_MOVE))(this.block);e.setReason(["drag"]),e.oldCoordinate=this.startLoc,e.recordNew(),D(e)}}drag(e){if(this.block.isShadow()){let t;null==(t=this.block.getParent())||t.drag(k.sum(e,this.dragOffset))}else this.block.moveDuringDrag(e),this.updateConnectionPreview(this.block,k.difference(e,this.startLoc))}updateConnectionPreview(e,t){var i=this.connectionCandidate;const s=this.getConnectionCandidate(e,t);if(s){this.connectionCandidate=t=i&&this.currCandidateIsBetter(i,t,s)?i:s;var u,{local:n,neighbour:l}=t;if(t=n.type===M.OUTPUT_VALUE||n.type===M.PREVIOUS_STATEMENT,i=l.isConnected()&&!(null!=(u=l.targetBlock())&&u.isInsertionMarker()),t&&i&&!this.orphanCanConnectAtEnd(e,l.targetBlock(),n.type)){let C;null==(C=this.connectionPreviewer)||C.previewReplacement(n,l,l.targetBlock())}else{var $;null==($=this.connectionPreviewer)||$.previewConnection(n,l)}}else{let C;null==(C=this.connectionPreviewer)||C.hidePreview(),this.connectionCandidate=null}}orphanCanConnectAtEnd(e,t,i){return!!K.getConnectionForOrphanedConnection(e,i===M.OUTPUT_VALUE?t.outputConnection:t.previousConnection)}currCandidateIsBetter(e,t,i){const{local:s,neighbour:n}=e;e=new k(s.x,s.y);const l=new k(n.x,n.y);return t=k.distance(k.sum(e,t),l),i.distance>t-o.config$$module$build$src$core$config.currentConnectionPreference}getConnectionCandidate(e,t){e=this.getLocalConnections(e);let i=this.getSearchRadius(),s=null;for(const n of e){const{connection:l,radius:u}=n.closest(i,t);l&&(s={local:n,neighbour:l,distance:u},i=u)}return s}getSearchRadius(){return this.connectionCandidate?o.config$$module$build$src$core$config.connectingSnapRadius:o.config$$module$build$src$core$config.snapRadius}getLocalConnections(e){const t=e.getConnections_(!1),i=e.lastConnectionInStack(!0);return i&&i!==e.nextConnection&&t.push(i),t}endDrag(e){if(this.block.isShadow()){let i;null==(i=this.block.getParent())||i.endDrag(e)}else{var t;if(this.originalEventGroup=o.getGroup$$module$build$src$core$events$utils(),this.fireDragEndEvent(),this.fireMoveEvent(),E(),Bo(),null==(t=this.connectionPreviewer)||t.hidePreview(),!this.block.isDeadOrDying()&&this.dragging){let i;null==(i=this.workspace.getLayerManager())||i.moveOffDragLayer(this.block,50),this.block.setDragging(!1)}this.connectionCandidate?(this.applyConnections(this.connectionCandidate),this.disposeStep()):this.block.queueRender().then(()=>this.disposeStep())}}disposeStep(){const e=o.getGroup$$module$build$src$core$events$utils();let t;o.setGroup$$module$build$src$core$events$utils(this.originalEventGroup),this.block.snapToGrid(),null==(t=this.connectionPreviewer)||t.dispose(),this.workspace.setResizesEnabled(!0),o.setGroup$$module$build$src$core$events$utils(e)}applyConnections(e){const{local:t,neighbour:i}=e;t.connect(i);const s=t.isSuperior()?i:t,n=this.block.getRootBlock();Zt().then(()=>{Nn(s.getSourceBlock()),setTimeout(()=>{n.bringToFront()},0)})}revertDrag(){if(this.block.isShadow()){let i;null==(i=this.block.getParent())||i.revertDrag()}else{var e,t;if(null==(e=this.connectionPreviewer)||e.hidePreview(),this.connectionCandidate=null,null==(t=this.startChildConn)||t.connect(this.block.nextConnection),this.startParentConn)switch(this.startParentConn.type){case M.INPUT_VALUE:this.startParentConn.connect(this.block.outputConnection);break;case M.NEXT_STATEMENT:this.startParentConn.connect(this.block.previousConnection)}else{let i;this.block.moveTo(this.startLoc,["drag"]),null==(i=this.workspace.getLayerManager())||i.moveOffDragLayer(this.block,50),Rt(this.workspace,this.workspace.getMetricsManager().getScrollMetrics(!0),this.block)}this.startParentConn=this.startChildConn=null,this.block.setDragging(!1),this.dragging=!1}}},Ap=class extends te{constructor(e,t,i,s){super(t,i,s),this.text=e,this.workspace=t,this.anchor=i,this.ownerRect=s,this.paragraph=this.stringToSvg(e,this.contentContainer),this.updateBubbleSize(),R(this.svgRoot,"blocklyTextBubble")}getText(){return this.text}setText(e){this.text=e,Q(this.paragraph),this.paragraph=this.stringToSvg(e,this.contentContainer),this.updateBubbleSize()}stringToSvg(e,t){return t=this.createParagraph(t),e=this.createTextFragments(t,e),this.workspace.RTL&&this.rightAlignTextFragments(t.getBBox().width,e),t}createParagraph(e){return I(T.G,{class:"blocklyText blocklyBubbleText blocklyNoPointerEvents",transform:`translate(0,${te.BORDER_WIDTH})`,style:"direction: "+(this.workspace.RTL?"rtl":"ltr")},e)}createTextFragments(e,t){let i=1;return t.split("\n").map(s=>{const n=I(T.TEXT,{y:`${i}em`,x:te.BORDER_WIDTH},e);return s=document.createTextNode(s),n.appendChild(s),i+=1,n})}rightAlignTextFragments(e,t){for(const i of t)i.setAttribute("text-anchor","start"),i.setAttribute("x",`${e+te.BORDER_WIDTH}`)}updateBubbleSize(){const e=this.paragraph.getBBox();this.setSize(new Y(e.width+2*te.BORDER_WIDTH,e.height+2*te.BORDER_WIDTH),!0)}},to=class extends rr{constructor(e){super(e),this.sourceBlock=e,this.textMap=new Map,this.textBubble=null}getType(){return to.TYPE}initView(e){this.svgRoot||(super.initView(e),I(T.PATH,{class:"blocklyIconShape",d:"M2,15Q-1,15 0.5,12L6.5,1.7Q8,-1 9.5,1.7L15.5,12Q17,15 14,15z"},this.svgRoot),I(T.PATH,{class:"blocklyIconSymbol",d:"m7,4.8v3.16l0.27,2.27h1.46l0.27,-2.27v-3.16z"},this.svgRoot),I(T.RECT,{class:"blocklyIconSymbol",x:"7",y:"11",height:"2",width:"2"},this.svgRoot),R(this.svgRoot,"blocklyWarningIcon"))}dispose(){let e;super.dispose(),null==(e=this.textBubble)||e.dispose()}getWeight(){return to.WEIGHT}getSize(){return new Y(17,17)}applyColour(){let e;super.applyColour(),null==(e=this.textBubble)||e.setColour(this.sourceBlock.getColour())}updateCollapsed(){}isShownWhenCollapsed(){return!0}onLocationChange(e){let t;super.onLocationChange(e),null==(t=this.textBubble)||t.setAnchorLocation(this.getAnchorLocation())}addMessage(e,t){if(this.textMap.get(t)===e)return this;let i;return e?this.textMap.set(t,e):this.textMap.delete(t),null==(i=this.textBubble)||i.setText(this.getText()),this}getText(){return[...this.textMap.values()].join("\n")}onClick(){super.onClick(),this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}bubbleIsVisible(){return!!this.textBubble}setBubbleVisible(e){const t=this;return(0,y.asyncExecutePromiseGeneratorFunction)(function*(){if(t.bubbleIsVisible()!==e){if(yield Zt(),e)t.textBubble=new Ap(t.getText(),t.sourceBlock.workspace,t.getAnchorLocation(),t.getBubbleOwnerRect()),t.applyColour();else{let i;null==(i=t.textBubble)||i.dispose(),t.textBubble=null}D(new(P(f.BUBBLE_OPEN))(t.sourceBlock,e,"warning"))}})}getBubble(){return this.textBubble}getAnchorLocation(){return k.sum(this.workspaceLocation,new k(8.5,8.5))}getBubbleOwnerRect(){const e=this.sourceBlock.getSvgRoot().getBBox();return new j(e.y,e.y+e.height,e.x,e.x+e.width)}};to.TYPE=ke.WARNING,to.WEIGHT=2;var se=class extends zs{constructor(e,t,i){if(super(e,t,i),this.childlessWidth=this.width=this.height=0,this.warningTextDb=new Map,this.mutator=null,this.rendered=!0,this.visuallyDisabled=!1,this.translation="",this.dragging=!1,this.relativeCoords=new k(0,0),this.dragStrategy=new Sp(this),!e.rendered)throw TypeError("Cannot create a rendered block in a headless workspace");this.workspace=e,this.svgGroup=I(T.G,{}),t&&R(this.svgGroup,t),this.style=e.getRenderer().getConstants().getBlockStyle(null),this.pathObject=e.getRenderer().makePathObject(this.svgGroup,this.style),(e=this.pathObject.svgPath).tooltip=this,Cn(e),this.svgGroup.setAttribute("data-id",this.id),e.id=Ee(),this.doInit_()}initSvg(){if(!this.initialized){for(var e of this.inputList)e.init();for(const t of this.getIcons())t.initView(this.createIconPointerDownListener(t)),t.updateEditable();this.applyColour(),this.pathObject.updateMovable(this.isMovable()||this.isInFlyout),(e=this.getSvgRoot())&&N(e,"pointerdown",this,this.onMouseDown),e.parentNode||this.workspace.getCanvas().appendChild(e),this.initialized=!0}}getColourSecondary(){return this.style.colourSecondary}getColourTertiary(){return this.style.colourTertiary}select(){this.addSelect(),ho(this)}unselect(){this.removeSelect(),ho(null)}setParent(e){var t=this.parentBlock_;if(e!==t){b(),super.setParent(e),E();var i=this.getSvgRoot();if(!this.workspace.isClearing&&i){var l,s=this.getRelativeToSurfaceXY(),n=o.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode(),u=this.getSvgRoot().contains(null!=(l=n?.getFocusableElement())?l:null);e?(e.getSvgRoot().appendChild(i),u&&n&&o.getFocusManager$$module$build$src$core$focus_manager().focusNode(n)):t&&(e=this.workspace.getCanvas().querySelector(".blocklyDragging"),t=e?.parentElement,t===(l=this.workspace.getCanvas())?l.insertBefore(i,e):(l.appendChild(i),u&&n&&o.getFocusManager$$module$build$src$core$focus_manager().focusNode(n)),this.translate(s.x,s.y)),this.applyColour()}}}getRelativeToSurfaceXY(){const e=this.workspace.getLayerManager();if(!e)throw Error("Cannot calculate position because the workspace has not been appended");let t=0,i=0,s=this.getSvgRoot();if(s)do{const n=_n(s);t+=n.x,i+=n.y,s=s.parentNode}while(s&&!e.hasLayer(s));return new k(t,i)}moveBy(e,t,i){if(this.parentBlock_)throw Error("Block has parent");const s=ne();let n=null;s&&(n=new(P(f.BLOCK_MOVE))(this),i&&n.setReason(i)),e=new k(e,t),t=this.getRelativeToSurfaceXY(),e=k.sum(t,e),this.translate(e.x,e.y),this.updateComponentLocations(e),s&&n&&(n.recordNew(),D(n)),this.workspace.resizeContents()}translate(e,t){this.translation=`translate(${e}, ${t})`,this.relativeCoords=new k(e,t),this.getSvgRoot().setAttribute("transform",this.getTranslation())}getTranslation(){return this.translation}moveTo(e,t){const i=this.getRelativeToSurfaceXY();this.moveBy(e.x-i.x,e.y-i.y,t)}moveDuringDrag(e){this.translate(e.x,e.y),this.getSvgRoot().setAttribute("transform",this.getTranslation()),this.updateComponentLocations(e)}snapToGrid(){if(!this.isDeadOrDying()&&!this.getParent()&&!this.isInFlyout){var e=this.workspace.getGrid();if(null!=e&&e.shouldSnap()){var t=this.getRelativeToSurfaceXY();(e=e.alignXY(t))!==t&&this.moveTo(e,["snap"])}}}getBoundingRectangle(){return this.getBoundingRectangleWithDimensions(this.getHeightWidth())}getBoundingRectangleWithoutChildren(){return this.getBoundingRectangleWithDimensions({height:this.height,width:this.childlessWidth})}getBoundingRectangleWithDimensions(e){const t=this.getRelativeToSurfaceXY();let i,s;return this.RTL?(i=t.x-e.width,s=t.x):(i=t.x,s=t.x+e.width),new j(t.y,t.y+e.height,i,s)}markDirty(){this.pathObject.constants=this.workspace.getRenderer().getConstants();for(let t,e=0;t=this.inputList[e];e++)t.markDirty()}setCollapsed(e){this.collapsed_!==e&&(super.setCollapsed(e),this.updateCollapsed())}childHasWarning(){const e=this.getChildren(!1);for(const t of e)if(t.getIcon(to.TYPE)||t.childHasWarning())return!0;return!1}updateCollapsed(){var e=this.isCollapsed();const t=Kn,i=Ll;for(let l,n=0;l=this.inputList[n];n++)l.name!==t&&l.setVisible(!e);for(var s of this.getIcons())s.updateCollapsed();e?(R(this.svgGroup,"blocklyCollapsed"),this.childHasWarning()&&this.setWarningText(o.Msg$$module$build$src$core$msg.COLLAPSED_WARNINGS_WARNING,se.COLLAPSED_WARNING_ID),e=this.toString(30),(s=this.getField(i))?s.setValue(e):(this.getInput(t)||this.appendDummyInput(t)).appendField(new Vi(e),i)):(this.updateDisabled(),this.removeInput(t),X(this.svgGroup,"blocklyCollapsed"),this.setWarningText(null,se.COLLAPSED_WARNING_ID))}onMouseDown(e){if(!this.workspace.isReadOnly()){var t=this.workspace.getGesture(e);t&&t.handleBlockStart(e,this)}}showHelp(){const e="function"==typeof this.helpUrl?this.helpUrl():this.helpUrl;e&&window.open(e)}generateContextMenu(e){return this.workspace.isReadOnly()||!this.contextMenu?null:(e=q.registry.getContextMenuOptions({block:this,focusedNode:this},e),this.customContextMenu&&this.customContextMenu(e),e)}calculateContextMenuLocation(e){if(e instanceof PointerEvent)return new k(e.clientX,e.clientY);let t,i;e=cs(this.workspace,this.getRelativeToSurfaceXY());const s=null==(t=this.inputList.filter(n=>n.isVisible()).flatMap(n=>n.fieldRow).find(n=>n.isVisible()))||null==(i=t.getSvgRoot())?void 0:i.getBoundingClientRect();return new k(this.RTL?e.x-5:e.x+5,(s&&s.height?s.y+s.height:e.y+this.height)+5)}showContextMenu(e){const t=this.generateContextMenu(e),i=this.calculateContextMenuLocation(e);t&&t.length&&(Ei(e,t,this.RTL,this.workspace,i),tl(this))}updateComponentLocations(e){this.dragging||this.updateConnectionLocations(e),this.updateIconLocations(e),this.updateFieldLocations(e);for(const t of this.getChildren(!1))t.updateComponentLocations(k.sum(e,t.relativeCoords))}updateConnectionLocations(e){for(const t of this.getConnections_(!1))t.moveToOffset(e)}updateIconLocations(e){for(const t of this.getIcons())t.onLocationChange(e)}updateFieldLocations(e){for(const t of this.inputList)for(const i of t.fieldRow)i.onLocationChange(e)}addClass(e){R(this.svgGroup,e)}removeClass(e){X(this.svgGroup,e)}setDragging(e){(this.dragging=e)?(this.translation="",wl.push(...this.getConnections_(!0)),this.addClass("blocklyDragging")):(wl.length=0,this.removeClass("blocklyDragging"));for(let t=0;t<this.childBlocks_.length;t++)this.childBlocks_[t].setDragging(e)}setMovable(e){super.setMovable(e),this.pathObject.updateMovable(e)}setEditable(e){super.setEditable(e),e?X(this.svgGroup,"blocklyNotEditable"):R(this.svgGroup,"blocklyNotEditable"),e=this.getIcons();for(let t=0;t<e.length;t++)e[t].updateEditable()}setShadow(e){super.setShadow(e),this.applyColour()}setInsertionMarker(e){this.isInsertionMarker_!==e&&(this.isInsertionMarker_=e)&&(this.setColour(this.workspace.getRenderer().getConstants().INSERTION_MARKER_COLOUR),this.pathObject.updateInsertionMarker(!0))}getSvgRoot(){return this.svgGroup}dispose(e,t){this.disposing=!0,sa(),fs();const i=o.getFocusManager$$module$build$src$core$focus_manager();var s,n;if(this.getSvgRoot().contains(null!=(n=null==(s=i.getFocusedNode())?void 0:s.getFocusableElement())?n:null)){if(!(s=this.getParent())){let l;if(n=null!=(l=this.outputConnection)?l:this.previousConnection){let u;s=null==(u=n.closest(0,new k(0,0)).connection)?void 0:u.getSourceBlock()}}s?i.focusNode(s):setTimeout(()=>i.focusTree(this.workspace),0)}t&&(this.unplug(e),wi(this)),super.dispose(!!e),Q(this.svgGroup)}disposeInternal(){this.disposing=!0,super.disposeInternal(),o.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode()===this&&this.workspace.cancelCurrentGesture(),[...this.warningTextDb.values()].forEach(e=>clearTimeout(e)),this.warningTextDb.clear(),this.getIcons().forEach(e=>e.dispose())}checkAndDelete(){this.workspace.isFlyout||(o.setGroup$$module$build$src$core$events$utils(!0),this.workspace.hideChaff(),this.dispose(!this.outputConnection,!0),o.setGroup$$module$build$src$core$events$utils(!1))}toCopyData(){return this.isInsertionMarker_?null:{paster:cr.TYPE,blockState:pt(this,{addCoordinates:!0,addNextBlocks:!1}),typeCounts:ls(this,!0)}}applyColour(){var e,t;for(null==(t=(e=this.pathObject).applyColour)||t.call(e,this),e=this.getIcons(),t=0;t<e.length;t++)e[t].applyColour();for(const i of this.getFields())i.applyColour()}updateDisabled(){const e=!this.isEnabled()||this.getInheritedDisabled();if(this.visuallyDisabled===e){let t;null==(t=this.getNextBlock())||t.updateDisabled()}else{this.applyColour(),this.visuallyDisabled=e;for(const t of this.getChildren(!1))t.updateDisabled()}}setWarningText(e,t=""){if(t)this.warningTextDb.has(t)&&(clearTimeout(this.warningTextDb.get(t)),this.warningTextDb.delete(t));else{for(var i of this.warningTextDb.values())clearTimeout(i);this.warningTextDb.clear()}if(this.workspace.isDragging())this.warningTextDb.set(t,setTimeout(()=>{this.isDeadOrDying()||(this.warningTextDb.delete(t),this.setWarningText(e,t))},100));else if(this.isInFlyout&&(e=null),i=this.getIcon(to.TYPE),e){let s=this.getSurroundParent(),n=null;for(;s;)s.isCollapsed()&&(n=s),s=s.getSurroundParent();n&&n.setWarningText(o.Msg$$module$build$src$core$msg.COLLAPSED_WARNINGS_WARNING,se.COLLAPSED_WARNING_ID),i?i.addMessage(e,t):this.addIcon(new to(this).addMessage(e,t))}else i&&(t?(i.addMessage("",t),i.getText()||this.removeIcon(to.TYPE)):this.removeIcon(to.TYPE))}setMutator(e){this.removeIcon(o.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE),e&&this.addIcon(e)}addIcon(e){return super.addIcon(e),e instanceof o.MutatorIcon$$module$build$src$core$icons$mutator_icon&&(this.mutator=e),e.initView(this.createIconPointerDownListener(e)),e.applyColour(),e.updateEditable(),this.queueRender(),e}createIconPointerDownListener(e){return t=>{this.isDeadOrDying()||(t=this.workspace.getGesture(t))&&t.setStartIcon(e)}}removeIcon(e){const t=super.removeIcon(e);return e.equals(o.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE)&&(this.mutator=null),this.queueRender(),t}setDisabledReason(e,t){const i=this.isEnabled();super.setDisabledReason(e,t),this.isEnabled()===i||this.getInheritedDisabled()||this.updateDisabled()}setDeletable(e){super.setDeletable(e),e?X(this.svgGroup,"blocklyNotDeletable"):R(this.svgGroup,"blocklyNotDeletable")}setHighlighted(e){this.pathObject.updateHighlighted(e)}addSelect(){this.pathObject.updateSelected(!0)}removeSelect(){this.pathObject.updateSelected(!1)}setDeleteStyle(e){this.pathObject.updateDraggingDelete(e)}getColour(){return this.style.colourPrimary}setColour(e){let t,i;super.setColour(e),e=this.workspace.getRenderer().getConstants().getBlockStyleForColour(this.colour_),null==(i=(t=this.pathObject).setStyle)||i.call(t,e.style),this.style=e.style,this.styleName_=e.name,this.applyColour()}setStyle(e){const t=this.workspace.getRenderer().getConstants().getBlockStyle(e);if(this.styleName_&&X(this.svgGroup,this.styleName_),!t)throw Error("Invalid style name: "+e);{let i,s;this.hat=t.hat,null==(s=(i=this.pathObject).setStyle)||s.call(i,t),this.colour_=t.colourPrimary,this.style=t,this.applyColour(),R(this.svgGroup,e),this.styleName_=e}}getStyle(){return this.style}bringToFront(e=!1){const t=o.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode();let i=this;if(!i.isDeadOrDying()){do{const s=i.getSvgRoot(),n=s.parentNode,l=n.childNodes;if(l[l.length-1]!==s&&n.appendChild(s),e)break;i=i.getParent()}while(i);t&&o.getFocusManager$$module$build$src$core$focus_manager().focusNode(t)}}setPreviousStatement(e,t){super.setPreviousStatement(e,t),this.queueRender()}setNextStatement(e,t){super.setNextStatement(e,t),this.queueRender()}setOutput(e,t){super.setOutput(e,t),this.queueRender()}setInputsInline(e){super.setInputsInline(e),this.queueRender()}removeInput(e,t){return e=super.removeInput(e,t),this.queueRender(),e}moveNumberedInputBefore(e,t){super.moveNumberedInputBefore(e,t),this.queueRender()}appendInput(e){return super.appendInput(e),this.queueRender(),e}setConnectionTracking(e){if(this.previousConnection&&this.previousConnection.setTracking(e),this.outputConnection&&this.outputConnection.setTracking(e),this.nextConnection){this.nextConnection.setTracking(e);var t=this.nextConnection.targetBlock();t&&t.setConnectionTracking(e)}if(!this.collapsed_)for(t=0;t<this.inputList.length;t++){var i=this.inputList[t].connection;i&&(i.setTracking(e),(i=i.targetBlock())&&i.setConnectionTracking(e))}}getConnections_(e){const t=[];if(this.outputConnection&&t.push(this.outputConnection),this.previousConnection&&t.push(this.previousConnection),this.nextConnection&&t.push(this.nextConnection),e||!this.collapsed_)for(let s,i=0;s=this.inputList[i];i++)s.connection&&t.push(s.connection);return t}lastConnectionInStack(e){return super.lastConnectionInStack(e)}getMatchingConnection(e,t){return super.getMatchingConnection(e,t)}makeConnection_(e){return new Pe(this,e)}getNextBlock(){return super.getNextBlock()}getPreviousBlock(){return super.getPreviousBlock()}bumpNeighbours(){const e=this.getRootBlock();if(!(this.isDeadOrDying()||this.workspace.isDragging()||e.isInFlyout))for(const t of this.getConnections_(!1)){if(t.isSuperior()){let i;null==(i=t.targetBlock())||i.bumpNeighbours()}for(const i of t.neighbours(o.config$$module$build$src$core$config.snapRadius))i.getSourceBlock().getRootBlock()!==e&&(t.isConnected()&&i.isConnected()||(t.isSuperior()?i.bumpAwayFrom(t,!1):t.bumpAwayFrom(i,!0)))}}scheduleSnapAndBump(){this.snapToGrid(),this.bumpNeighbours()}positionNearConnection(e,t,i){if(e.type===M.NEXT_STATEMENT||e.type===M.INPUT_VALUE){let s=t.x;t=t.y,s+=i.x-e.getOffsetInBlock().x,t+=i.y-e.getOffsetInBlock().y,this.moveBy(s,t)}}getChildren(e){return super.getChildren(e)}queueRender(){return xc(this)}render(){this.queueRender(),wo()}renderEfficiently(){b(),this.isCollapsed()&&this.updateCollapsed(),this.isEnabled()||this.updateDisabled(),this.workspace.getRenderer().render(this),this.tightenChildrenEfficiently(),E()}tightenChildrenEfficiently(){for(const e of this.inputList){const t=e.connection;t&&t.tightenEfficiently()}this.nextConnection&&this.nextConnection.tightenEfficiently()}getHeightWidth(){let e=this.height,t=this.width;var i=this.getNextBlock();if(i){i=i.getHeightWidth();const s=this.workspace.getRenderer().getConstants().NOTCH_HEIGHT;e+=i.height-s,t=Math.max(t,i.width)}return{height:e,width:t}}fadeForReplacement(e){this.pathObject.updateReplacementFade(e)}highlightShapeForInput(e,t){this.pathObject.updateShapeForInputHighlight(e,t)}getDragStrategy(){return this.dragStrategy}setDragStrategy(e){this.dragStrategy=e}isCopyable(){return this.isOwnDeletable()&&this.isOwnMovable()}isMovable(){return this.dragStrategy.isMovable()}startDrag(e){this.dragStrategy.startDrag(e)}drag(e,t){this.dragStrategy.drag(e,t)}endDrag(e){this.dragStrategy.endDrag(e)}revertDrag(){this.dragStrategy.revertDrag()}toFlyoutInfo(){const e=Object.assign({},{kind:"BLOCK"},pt(this)),t=new Set(["id","height","width","pinned","enabled"]),i=function(s){for(const n in s)t.has(n)?delete s[n]:"object"==typeof s[n]&&i(s[n])};return i(e),[e]}jsonInit(e){super.jsonInit(e),e.classes&&this.addClass(Array.isArray(e.classes)?e.classes.join(" "):e.classes)}getFocusableElement(){return this.pathObject.svgPath}getFocusableTree(){return this.workspace}onNodeFocus(){this.select()}onNodeBlur(){this.unselect()}canBeFocused(){return!0}};se.INLINE=-1,se.COLLAPSED_WARNING_ID="TEMP_COLLAPSED_WARNING_";var Op=class{constructor(){}onDragEnter(e){}onDragOver(e){}onDragExit(e){}onDrop(e){}getClientRect(){return null}shouldPreventMove(e){return!1}},Kl=class extends Op{constructor(){super(),this.wouldDelete_=!1}wouldDelete(e){return e instanceof se?(e=!e.getParent()&&e.isDeletable(),this.updateWouldDelete_(e)):this.updateWouldDelete_(Xe(e)&&e.isDeletable()),this.wouldDelete_}updateWouldDelete_(e){this.wouldDelete_=e}},js=class{constructor(e,t){this.element=e,this.type=t}getElement(){return this.element}getType(){return this.type}},$u=class{constructor(e){this.workspace_=e}getDimensionsPx_(e){let t=0,i=0;return e&&(t=e.getWidth(),i=e.getHeight()),new Y(t,i)}getFlyoutMetrics(e){return{width:(e=this.getDimensionsPx_(this.workspace_.getFlyout(e))).width,height:e.height,position:this.workspace_.toolboxPosition}}getToolboxMetrics(){const e=this.getDimensionsPx_(this.workspace_.getToolbox());return{width:e.width,height:e.height,position:this.workspace_.toolboxPosition}}getSvgMetrics(){return this.workspace_.getCachedParentSvgSize()}getAbsoluteMetrics(){let e=0,t=0;const i=this.getToolboxMetrics(),s=this.getFlyoutMetrics(),n=!!this.workspace_.getToolbox();var l;const u=!(null!=(l=this.workspace_.getFlyout())&&l.autoClose);return(l=n?i.position:s.position)===G.LEFT&&(n&&(e+=i.width),u&&(e+=s.width)),l===G.TOP&&(n&&(t+=i.height),u&&(t+=s.height)),{top:t,left:e}}getViewMetrics(e){e=e?this.workspace_.scale:1;const t=this.getSvgMetrics(),i=this.getToolboxMetrics(),s=this.getFlyoutMetrics(),n=!!this.workspace_.getToolbox();var l;const u=!(null!=(l=this.workspace_.getFlyout())&&l.autoClose),$=(l=n?i.position:s.position)===G.LEFT||l===G.RIGHT;return(l===G.TOP||l===G.BOTTOM)&&(n&&(t.height-=i.height),u&&(t.height-=s.height)),$&&(n&&(t.width-=i.width),u&&(t.width-=s.width)),{height:t.height/e,width:t.width/e,top:-this.workspace_.scrollY/e,left:-this.workspace_.scrollX/e}}getContentMetrics(e){e=e?1:this.workspace_.scale;const t=this.workspace_.getBlocksBoundingBox();return{height:(t.bottom-t.top)*e,width:(t.right-t.left)*e,top:t.top*e,left:t.left*e}}hasFixedEdges(){return!this.workspace_.isMovableHorizontally()||!this.workspace_.isMovableVertically()}getComputedFixedEdges_(e){if(!this.hasFixedEdges())return{};const t=this.workspace_.isMovableHorizontally(),i=this.workspace_.isMovableVertically();e=e||this.getViewMetrics(!1);const s={};return i||(s.top=e.top,s.bottom=e.top+e.height),t||(s.left=e.left,s.right=e.left+e.width),s}getPaddedContent_(e,t){const i=t.top+t.height,s=t.left+t.width,n=e.width,l=n/2,u=(e=e.height)/2;return{top:Math.min(t.top-u,i-e),bottom:Math.max(i+u,t.top+e),left:Math.min(t.left-l,s-n),right:Math.max(s+l,t.left+n)}}getScrollMetrics(e,t,i){e=e?this.workspace_.scale:1,t=t||this.getViewMetrics(!1);var s=i||this.getContentMetrics();i=this.getComputedFixedEdges_(t),t=this.getPaddedContent_(t,s);const n=void 0!==i.left?i.left:t.left;return{top:(s=void 0!==i.top?i.top:t.top)/e,left:n/e,width:((void 0!==i.right?i.right:t.right)-n)/e,height:((void 0!==i.bottom?i.bottom:t.bottom)-s)/e}}getUiMetrics(){return{viewMetrics:this.getViewMetrics(),absoluteMetrics:this.getAbsoluteMetrics(),toolboxMetrics:this.getToolboxMetrics()}}getMetrics(){const e=this.getToolboxMetrics(),t=this.getFlyoutMetrics(!0),i=this.getSvgMetrics(),s=this.getAbsoluteMetrics(),n=this.getViewMetrics(),l=this.getContentMetrics(),u=this.getScrollMetrics(!1,n,l);return{contentHeight:l.height,contentWidth:l.width,contentTop:l.top,contentLeft:l.left,scrollHeight:u.height,scrollWidth:u.width,scrollTop:u.top,scrollLeft:u.left,viewHeight:n.height,viewWidth:n.width,viewTop:n.top,viewLeft:n.left,absoluteTop:s.top,absoluteLeft:s.left,svgHeight:i.height,svgWidth:i.width,toolboxWidth:e.width,toolboxHeight:e.height,toolboxPosition:e.position,flyoutWidth:t.width,flyoutHeight:t.height}}};U(x.METRICS_MANAGER,gt,$u);var Mp=class extends $u{constructor(e,t){super(e),this.flyout_=t}getBoundingBox(){let e;try{e=this.workspace_.getCanvas().getBBox()}catch{e={height:0,y:0,width:0,x:0}}return e}getContentMetrics(e){const t=this.getBoundingBox();return{height:t.height*(e=e?1:this.workspace_.scale),width:t.width*e,top:t.y*e,left:t.x*e}}getScrollMetrics(e,t,i){return{height:((t=i||this.getContentMetrics()).height+2*(i=this.flyout_.MARGIN*this.workspace_.scale))/(e=e?this.workspace_.scale:1),width:(t.width+t.left+i)/e,top:0,left:0}}},Qe=class{constructor(e,t,i,s){let n;this.workspace=e,this.targetWorkspace=t,this.isFlyoutLabel=s,this.height=this.width=0,this.cursorSvg=this.svgText=null,this.text=i.text,this.position=new k(0,0),this.callbackKey=i.callbackKey||i.callbackkey,this.cssClass=i["web-class"]||null,this.info=i,e=this.isFlyoutLabel?"blocklyFlyoutLabel":"blocklyFlyoutButton",this.cssClass&&(e+=" "+this.cssClass),this.id=Ee(),this.svgGroup=I(T.G,{id:this.id,class:e},this.workspace.getCanvas()),this.isFlyoutLabel||(n=I(T.RECT,{class:"blocklyFlyoutButtonShadow",rx:Qe.BORDER_RADIUS,ry:Qe.BORDER_RADIUS,x:1,y:1},this.svgGroup)),e=I(T.RECT,{class:this.isFlyoutLabel?"blocklyFlyoutLabelBackground":"blocklyFlyoutButtonBackground",rx:Qe.BORDER_RADIUS,ry:Qe.BORDER_RADIUS},this.svgGroup),t=I(T.TEXT,{class:this.isFlyoutLabel?"blocklyFlyoutLabelText":"blocklyText",x:0,y:0,"text-anchor":"middle"},this.svgGroup),i=ge(this.text),this.workspace.RTL&&(i+="\u200f"),t.textContent=i,this.isFlyoutLabel&&(this.svgText=t,this.workspace.getThemeManager().subscribe(this.svgText,"flyoutForegroundColour","fill")),s=Ut(t,"fontSize");const l=Ut(t,"fontWeight"),u=Ut(t,"fontFamily");if(this.width=ut(t,s,l,u),i=pn(i,s,l,u),this.height=this.height||i.height,!this.isFlyoutLabel){let $,C;this.width+=2*Qe.TEXT_MARGIN_X,this.height+=2*Qe.TEXT_MARGIN_Y,null==($=n)||$.setAttribute("width",String(this.width)),null==(C=n)||C.setAttribute("height",String(this.height))}e.setAttribute("width",String(this.width)),e.setAttribute("height",String(this.height)),t.setAttribute("x",String(this.width/2)),t.setAttribute("y",String(this.height/2-i.height/2+i.baseline)),this.updateTransform(),this.onMouseDownWrapper=N(this.svgGroup,"pointerdown",this,this.onMouseDown),this.onMouseUpWrapper=N(this.svgGroup,"pointerup",this,this.onMouseUp)}createDom(){return this.svgGroup}show(){this.updateTransform(),this.svgGroup.setAttribute("display","block")}updateTransform(){this.svgGroup.setAttribute("transform","translate("+this.position.x+","+this.position.y+")")}moveTo(e,t){this.position.x=e,this.position.y=t,this.updateTransform()}moveBy(e,t,i){this.moveTo(this.position.x+e,this.position.y+t)}isLabel(){return this.isFlyoutLabel}getPosition(){return this.position}getBoundingRectangle(){return new j(this.position.y,this.position.y+this.height,this.position.x,this.position.x+this.width)}getButtonText(){return this.text}getTargetWorkspace(){return this.targetWorkspace}getWorkspace(){return this.workspace}dispose(){J(this.onMouseDownWrapper),J(this.onMouseUpWrapper),this.svgGroup&&Q(this.svgGroup),this.svgText&&this.workspace.getThemeManager().unsubscribe(this.svgText)}setCursorSvg(e){e?this.svgGroup&&(this.svgGroup.appendChild(e),this.cursorSvg=e):this.cursorSvg=null}onMouseUp(e){(e=this.targetWorkspace.getGesture(e))&&e.cancel(),this.isFlyoutLabel&&this.callbackKey?console.warn("Labels should not have callbacks. Label text: "+this.text):this.isFlyoutLabel||this.callbackKey&&this.targetWorkspace.getButtonCallback(this.callbackKey)?this.isFlyoutLabel||(e=this.targetWorkspace.getButtonCallback(this.callbackKey))&&e(this):console.warn("Buttons should have callbacks. Button text: "+this.text)}onMouseDown(e){const t=this.targetWorkspace.getGesture(e),i=this.targetWorkspace.getFlyout();t&&i&&t.handleFlyoutStart(e,i)}getSvgRoot(){return this.svgGroup}getFocusableElement(){return this.svgGroup}getFocusableTree(){return this.workspace}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}};Qe.TEXT_MARGIN_X=5,Qe.TEXT_MARGIN_Y=2,Qe.BORDER_RADIUS=4,Ft("\n.blocklyFlyoutButton {\n  fill: #888;\n  cursor: default;\n}\n\n.blocklyFlyoutButtonShadow {\n  fill: #666;\n}\n\n.blocklyFlyoutButton:hover {\n  fill: #aaa;\n}\n\n.blocklyFlyoutLabel {\n  cursor: default;\n}\n\n.blocklyFlyoutLabelBackground {\n  opacity: 0;\n}\n");var Np=class{getFirstChild(e){return null}getParent(e){return e.getWorkspace()}getNextSibling(e){return null}getPreviousSibling(e){return null}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof Qe}},Lp=class{constructor(e,t){this.policy=e,this.flyout=t}getFirstChild(e){return null}getParent(e){return this.policy.getParent(e)}getNextSibling(e){const t=this.flyout.getContents();if(!t)return null;let i=t.findIndex(s=>s.getElement()===e);return-1===i?null:(i++,i>=t.length&&(i=0),t[i].getElement())}getPreviousSibling(e){const t=this.flyout.getContents();if(!t)return null;let i=t.findIndex(s=>s.getElement()===e);return-1===i?null:(i--,i<0&&(i=t.length-1),t[i].getElement())}isNavigable(e){return this.policy.isNavigable(e)}isApplicable(e){return this.policy.isApplicable(e)}},Jl=class{constructor(e,t){this.gap=e,this.axis=t,this.y=this.x=0}getBoundingRectangle(){switch(this.axis){case"x":return new j(this.y,this.y,this.x,this.x+this.gap);case"y":return new j(this.y,this.y+this.gap,this.x,this.x)}}moveBy(e,t,i){this.x+=e,this.y+=t}isNavigable(){return!1}getFocusableElement(){throw Error("Cannot be focused")}getFocusableTree(){throw Error("Cannot be focused")}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!1}},Dp=class{getFirstChild(e){return null}getParent(e){return null}getNextSibling(e){return null}getPreviousSibling(e){return null}isNavigable(e){return!1}isApplicable(e){return e instanceof Jl}},Pp=class{getFirstChild(e){return Bn(e,!0)[0]}getParent(e){var t;if(null!=(t=e.previousConnection)&&t.targetBlock()){if(t=e.getSurroundParent())return t}else{let i;if(null!=(i=e.outputConnection)&&i.targetBlock())return e.outputConnection.targetBlock()}return e.workspace}getNextSibling(e){let t,i;if(null!=(t=e.nextConnection)&&t.targetBlock()){let s;return null==(s=e.nextConnection)?void 0:s.targetBlock()}return null!=(i=e.outputConnection)&&i.targetBlock()?lt(e,1):e.getSurroundParent()?lt(e.getTopStackBlock(),1):this.getParent(e)instanceof ze?po(e,1):null}getPreviousSibling(e){let t,i;if(null!=(t=e.previousConnection)&&t.targetBlock()){let s;return null==(s=e.previousConnection)?void 0:s.targetBlock()}return null!=(i=e.outputConnection)&&i.targetBlock()?lt(e,-1):this.getParent(e)instanceof ze?po(e,-1):null}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof se}},Bp={};Bp.BlockNavigationPolicy=Pp,Bp.navigateBlock=lt,Bp.navigateStacks=po;var Sm=class{getFirstChild(e){return null}getParent(e){return e.getParentComment()}getNextSibling(e){const t=e.getParentComment().view.getCommentBarButtons();return(e=t.indexOf(e))>=0&&e+1<t.length?t[e+1]:null}getPreviousSibling(e){const t=e.getParentComment().view.getCommentBarButtons();return(e=t.indexOf(e))>0?t[e-1]:null}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof Gl}},Fp=class{getFirstChild(e){return e.getParentInput()?e.targetConnection:null}getParent(e){return e.getSourceBlock()}getNextSibling(e){if(e.getParentInput())return lt(e,1);if(e.type===M.NEXT_STATEMENT){const i=e.targetConnection;var t=e.getSourceBlock();if(!i&&t.getRootBlock().lastConnectionInStack(!1)===e){let s;return e=t.workspace.getTopBlocks(!0),(t=e.indexOf(t.getRootBlock())+1)>=e.length&&(t=0),null!=(s=this.getParentConnection(t=e[t]))?s:t}return i}return e.getSourceBlock()}getPreviousSibling(e){if(e.getParentInput())return lt(e,-1);if(e.type===M.PREVIOUS_STATEMENT||e.type===M.OUTPUT_VALUE){const i=e.targetConnection&&!e.targetConnection.getParentInput()?e.targetConnection:null;var t=e.getSourceBlock();if(!i&&this.getParentConnection(t.getRootBlock())===e){let s;return e=t.workspace.getTopBlocks(!0),(t=e.indexOf(t.getRootBlock())-1)<0&&(t=e.length-1),null!=(s=(t=e[t]).lastConnectionInStack(!1))?s:t}return i}return e.type===M.NEXT_STATEMENT?e.getSourceBlock():null}getParentConnection(e){let t;return!e.outputConnection||null!=(t=e.previousConnection)&&t.isConnected()?e.previousConnection:e.outputConnection}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof Pe}},Up=class{getFirstChild(e){return null}getParent(e){return e.getSourceBlock()}getNextSibling(e){return lt(e,1)}getPreviousSibling(e){return lt(e,-1)}isNavigable(e){let t;return e.canBeFocused()&&e.isVisible()&&(e.isClickable()||e.isCurrentlyEditable())&&!(null!=(t=e.getSourceBlock())&&t.isSimpleReporter()&&e.isFullBlockField())&&e.getParentInput().isVisible()}isApplicable(e){return e instanceof ee}},Am=class{getFirstChild(e){if(e instanceof o.MutatorIcon$$module$build$src$core$icons$mutator_icon&&e.bubbleIsVisible()&&o.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode()===e){let t,i;return null!=(i=null==(t=e.getBubble())?void 0:t.getWorkspace())?i:null}return null}getParent(e){return e.getSourceBlock()}getNextSibling(e){return lt(e,1)}getPreviousSibling(e){return lt(e,-1)}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof rr}},Rm=class{getFirstChild(e){return e.view.getCommentBarButtons()[0]}getParent(e){return e.workspace}getNextSibling(e){return po(e,1)}getPreviousSibling(e){return po(e,-1)}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof Kt}},Hp=class{getFirstChild(e){return(e=e.getTopBlocks(!0)).length?e[0]:null}getParent(e){return null}getNextSibling(e){return null}getPreviousSibling(e){return null}isNavigable(e){return e.canBeFocused()&&!e.isMutator}isApplicable(e){return e instanceof ze}},mu=class{constructor(){this.rules=[new Pp,new Up,new Fp,new Hp,new Am,new Rm,new Sm]}addNavigationPolicy(e){this.rules.push(e)}get(e){return this.rules.find(t=>t.isApplicable(e))}getFirstChild(e){let t;const i=null==(t=this.get(e))?void 0:t.getFirstChild(e);if(!i)return null;let s;return null!=(s=this.get(i))&&s.isNavigable(i)?i:this.getFirstChild(i)||this.getNextSibling(i)}getParent(e){let t;const i=null==(t=this.get(e))?void 0:t.getParent(e);if(!i)return null;let s;return null!=(s=this.get(i))&&s.isNavigable(i)?i:this.getParent(i)}getNextSibling(e){let t;const i=null==(t=this.get(e))?void 0:t.getNextSibling(e);if(!i)return null;let s;return null!=(s=this.get(i))&&s.isNavigable(i)?i:this.getNextSibling(i)}getPreviousSibling(e){let t;const i=null==(t=this.get(e))?void 0:t.getPreviousSibling(e);if(!i)return null;let s;return null!=(s=this.get(i))&&s.isNavigable(i)?i:this.getPreviousSibling(i)}},Zp=class extends mu{constructor(e){super(),this.rules.push(new Np,new Dp),this.rules=this.rules.map(t=>new Lp(t,e))}},_u=class{constructor(e,t,i,s,n){this.workspace=e,this.oldHostMetrics=this.corner_=this.vScroll=this.hScroll=null,i=void 0===i||i;const l=(t=void 0===t||t)&&i;t&&(this.hScroll=new be(e,!0,l,s,n)),i&&(this.vScroll=new be(e,!1,l,s,n)),l&&(this.corner_=I(T.RECT,{height:be.scrollbarThickness,width:be.scrollbarThickness,class:"blocklyScrollbarBackground"}),c(this.corner_,e.getBubbleCanvas()))}dispose(){Q(this.corner_),this.oldHostMetrics=this.corner_=null,this.hScroll&&(this.hScroll.dispose(),this.hScroll=null),this.vScroll&&(this.vScroll.dispose(),this.vScroll=null)}resize(){const e=this.workspace.getMetrics();if(e){var t=!1,i=!1;if(this.oldHostMetrics&&this.oldHostMetrics.viewWidth===e.viewWidth&&this.oldHostMetrics.viewHeight===e.viewHeight&&this.oldHostMetrics.absoluteTop===e.absoluteTop&&this.oldHostMetrics.absoluteLeft===e.absoluteLeft?(this.oldHostMetrics&&this.oldHostMetrics.scrollWidth===e.scrollWidth&&this.oldHostMetrics.viewLeft===e.viewLeft&&this.oldHostMetrics.scrollLeft===e.scrollLeft||(t=!0),this.oldHostMetrics&&this.oldHostMetrics.scrollHeight===e.scrollHeight&&this.oldHostMetrics.viewTop===e.viewTop&&this.oldHostMetrics.scrollTop===e.scrollTop||(i=!0)):i=t=!0,t||i){try{o.disable$$module$build$src$core$events$utils(),this.hScroll&&t&&this.hScroll.resize(e),this.vScroll&&i&&this.vScroll.resize(e)}finally{o.enable$$module$build$src$core$events$utils()}this.workspace.maybeFireViewportChangeEvent()}if(this.hScroll&&this.vScroll){if(!this.oldHostMetrics||this.oldHostMetrics.viewWidth!==e.viewWidth||this.oldHostMetrics.absoluteLeft!==e.absoluteLeft){let s;null==(s=this.corner_)||s.setAttribute("x",String(this.vScroll.position.x))}if(!this.oldHostMetrics||this.oldHostMetrics.viewHeight!==e.viewHeight||this.oldHostMetrics.absoluteTop!==e.absoluteTop){let s;null==(s=this.corner_)||s.setAttribute("y",String(this.hScroll.position.y))}}this.oldHostMetrics=e}}canScrollHorizontally(){return!!this.hScroll}canScrollVertically(){return!!this.vScroll}setOrigin(e,t){this.hScroll&&this.hScroll.setOrigin(e,t),this.vScroll&&this.vScroll.setOrigin(e,t)}set(e,t,i){this.hScroll&&this.hScroll.set(e,!1),this.vScroll&&this.vScroll.set(t,!1),(i||void 0===i)&&(e={},this.hScroll&&(e.x=this.hScroll.getRatio_()),this.vScroll&&(e.y=this.vScroll.getRatio_()),this.workspace.setMetrics(e))}setX(e){this.hScroll&&this.hScroll.set(e,!0)}setY(e){this.vScroll&&this.vScroll.set(e,!0)}setContainerVisible(e){this.hScroll&&this.hScroll.setContainerVisible(e),this.vScroll&&this.vScroll.setContainerVisible(e)}isVisible(){let e=!1;return this.hScroll&&(e=this.hScroll.isVisible()),this.vScroll&&(e=e||this.vScroll.isVisible()),e}setVisible(e){this.hScroll&&this.hScroll.setVisibleInternal(e),this.vScroll&&this.vScroll.setVisibleInternal(e)}resizeContent(e){this.hScroll&&this.hScroll.resizeContentHorizontal(e),this.vScroll&&this.vScroll.resizeContentVertical(e)}resizeView(e){this.hScroll&&this.hScroll.resizeViewHorizontal(e),this.vScroll&&this.vScroll.resizeViewVertical(e)}},Ys="sep",Vp=class{load(e,t){return e=new Jl(0,t.horizontalLayout?"x":"y"),new js(e,Ys)}gapForItem(e,t){let i;return null!=(i=parseInt(String(e.gap)))?i:t}disposeItem(e){}getType(){return Ys}};U(x.FLYOUT_INFLATER,Ys,Vp),{SEPARATOR_TYPE:Ys}.SeparatorFlyoutInflater=Vp;var Ql=class extends Kl{constructor(e){super(),this.horizontalLayout=!1,this.boundEvents=[],this.reflowWrapper=null,this.contents=[],this.autoClose=!0,this.visible=!1,this.containerVisible=!0,this.CORNER_RADIUS=8,this.SCROLLBAR_MARGIN=2.5,this.height_=this.width_=0,this.dragAngleRange_=70,this.svgGroup_=this.svgBackground_=null,this.inflaters=new Map,e.setMetrics=this.setMetrics_.bind(this),this.workspace_=new ze(e),this.workspace_.setMetricsManager(new Mp(this.workspace_,this)),this.workspace_.internalIsFlyout=!0,this.workspace_.setVisible(this.visible),this.workspace_.setNavigator(new Zp(this)),this.id=ve(),this.RTL=!!e.RTL,this.toolboxPosition_=e.toolboxPosition,this.tabWidth_=this.workspace_.getRenderer().getConstants().TAB_WIDTH,this.MARGIN=this.CORNER_RADIUS,this.GAP_X=3*this.MARGIN,this.GAP_Y=3*this.MARGIN}createDom(e){return this.svgGroup_=I(e,{class:"blocklyFlyout"}),this.svgGroup_.style.display="none",this.svgBackground_=I(T.PATH,{class:"blocklyFlyoutBackground"},this.svgGroup_),this.svgGroup_.appendChild(this.workspace_.createDom()),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutBackgroundColour","fill"),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutOpacity","fill-opacity"),this.svgGroup_}init(e){this.targetWorkspace=e,this.workspace_.targetWorkspace=e,this.workspace_.scrollbar=new _u(this.workspace_,this.horizontalLayout,!this.horizontalLayout,"blocklyFlyoutScrollbar",this.SCROLLBAR_MARGIN),this.hide(),this.boundEvents.push(N(this.svgGroup_,"wheel",this,this.wheel_)),this.boundEvents.push(N(this.svgBackground_,"pointerdown",this,this.onMouseDown)),this.workspace_.getGesture=this.targetWorkspace.getGesture.bind(this.targetWorkspace),this.workspace_.setVariableMap(this.targetWorkspace.getVariableMap()),this.workspace_.createPotentialVariableMap(),e.getComponentManager().addComponent({component:this,weight:de.ComponentWeight.FLYOUT_WEIGHT,capabilities:[de.Capability.AUTOHIDEABLE,de.Capability.DELETE_AREA,de.Capability.DRAG_TARGET]})}dispose(){this.hide(),this.targetWorkspace.getComponentManager().removeComponent(this.id);for(const e of this.boundEvents)J(e);this.boundEvents.length=0,this.workspace_&&(this.workspace_.getThemeManager().unsubscribe(this.svgBackground_),this.workspace_.dispose()),this.svgGroup_&&Q(this.svgGroup_)}getWidth(){return this.width_}getHeight(){return this.height_}getFlyoutScale(){return this.targetWorkspace.scale}getWorkspace(){return this.workspace_}setAutoClose(e){this.autoClose=e,this.targetWorkspace.recordDragTargets(),this.targetWorkspace.resizeContents()}autoHide(e){!e&&this.targetWorkspace.getFlyout(!0)===this&&this.autoClose&&this.hide()}getTargetWorkspace(){return this.targetWorkspace}isVisible(){return this.visible}setVisible(e){const t=e!==this.isVisible();this.visible=e,t&&(this.autoClose||this.targetWorkspace.recordDragTargets(),this.updateDisplay())}setContainerVisible(e){const t=e!==this.containerVisible;this.containerVisible=e,t&&this.updateDisplay()}getContents(){return this.contents}setContents(e){this.contents=e}updateDisplay(){let e,t;e=!!this.containerVisible&&this.isVisible(),this.svgGroup_&&(this.svgGroup_.style.display=e?"block":"none"),null==(t=this.workspace_.scrollbar)||t.setContainerVisible(e)}positionAt_(e,t,i,s){let n,l;null==(n=this.svgGroup_)||n.setAttribute("width",`${e}`),null==(l=this.svgGroup_)||l.setAttribute("height",`${t}`),this.workspace_.setCachedParentSvgSize(e,t),this.svgGroup_&&g(this.svgGroup_,"translate("+i+"px,"+s+"px)"),(e=this.workspace_.scrollbar)&&(e.setOrigin(i,s),e.resize(),e.hScroll&&e.hScroll.setPosition(e.hScroll.position.x,e.hScroll.position.y),e.vScroll&&e.vScroll.setPosition(e.vScroll.position.x,e.vScroll.position.y))}hide(){this.isVisible()&&(this.setVisible(!1),this.reflowWrapper&&(this.workspace_.removeChangeListener(this.reflowWrapper),this.reflowWrapper=null))}show(e){this.workspace_.setResizesEnabled(!1),this.hide(),this.clearOldBlocks(),"string"==typeof e&&(e=this.getDynamicCategoryContents(e)),this.setVisible(!0),e=bn(e),e=this.createFlyoutInfo(e),wo(this.workspace_),this.setContents(e),this.layout_(e),this.horizontalLayout?this.height_=0:this.width_=0,this.reflow(),this.workspace_.setResizesEnabled(!0),this.reflowWrapper=t=>{t.type!==f.BLOCK_CHANGE&&t.type!==f.BLOCK_FIELD_INTERMEDIATE_CHANGE||this.reflow()},this.workspace_.addChangeListener(this.reflowWrapper)}createFlyoutInfo(e){const t=[],i=this.horizontalLayout?this.GAP_X:this.GAP_Y;for(const s of e)"custom"in s&&(e=this.getDynamicCategoryContents(s.custom),e=bn(e),t.push(...this.createFlyoutInfo(e))),e=s.kind.toLowerCase(),(e=this.getInflaterForType(e))&&(t.push(e.load(s,this)),(e=e.gapForItem(s,i))&&t.push(new js(new Jl(e,this.horizontalLayout?"x":"y"),Ys)));return this.normalizeSeparators(t)}normalizeSeparators(e){for(let t=e.length-1;t>0;t--){const i=e[t].getType().toLowerCase(),s=e[t-1].getType().toLowerCase();i===Ys&&s===Ys&&e.splice(t-1,1)}return e}getDynamicCategoryContents(e){if("function"!=typeof(e=this.workspace_.targetWorkspace.getToolboxCategoryCallback(e)))throw TypeError("Couldn't find a callback function when opening a toolbox category.");return e(this.workspace_.targetWorkspace)}clearOldBlocks(){let e;this.getContents().forEach(t=>{let i;null==(i=this.getInflaterForType(t.getType()))||i.disposeItem(t)}),null==(e=this.workspace_.getPotentialVariableMap())||e.clear()}onMouseDown(e){const t=this.targetWorkspace.getGesture(e);t&&t.handleFlyoutStart(e,this)}isBlockCreatable(e){return e.isEnabled()&&!this.getTargetWorkspace().isReadOnly()}createBlock(e){let t=null;o.disable$$module$build$src$core$events$utils();var i=this.targetWorkspace.getAllVariables();this.targetWorkspace.setResizesEnabled(!1);try{t=this.placeNewBlock(e)}finally{o.enable$$module$build$src$core$events$utils()}if(this.targetWorkspace.hideChaff(),e=vn(this.targetWorkspace,i),ne()){for(o.setGroup$$module$build$src$core$events$utils(!0),i=0;i<e.length;i++){const s=e[i];D(new(P(f.VAR_CREATE))(s))}D(new(P(f.BLOCK_CREATE))(t))}return this.autoClose&&this.hide(),t}reflow(){this.reflowWrapper&&this.workspace_.removeChangeListener(this.reflowWrapper),this.reflowInternal_(),this.reflowWrapper&&this.workspace_.addChangeListener(this.reflowWrapper)}isScrollable(){return!!this.workspace_.scrollbar&&this.workspace_.scrollbar.isVisible()}placeNewBlock(e){var t=this.targetWorkspace;if(!e.getSvgRoot())throw Error("oldBlock is not rendered");const i=this.serializeBlock(e);return t.setResizesEnabled(!1),t=So(i,t),this.positionNewBlock(e,t),t}serializeBlock(e){return pt(e)}positionNewBlock(e,t){const i=this.targetWorkspace;var s=i.getOriginOffsetInPixels(),n=this.workspace_.getOriginOffsetInPixels();(e=e.getRelativeToSurfaceXY()).scale(this.workspace_.scale),n=k.sum(n,e),(s=k.difference(n,s)).scale(1/i.scale),t.moveTo(new k(s.x,s.y))}getInflaterForType(e){var t;return this.inflaters.has(e)?null!=(t=this.inflaters.get(e))?t:null:(t=ot(x.FLYOUT_INFLATER,e))?(t=new t,this.inflaters.set(e,t),t):null}getFocusableElement(){throw Error("Flyouts are not directly focusable.")}getFocusableTree(){throw Error("Flyouts are not directly focusable.")}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!1}getRootFocusableNode(){throw Error("Flyouts are not directly focusable.")}getRestoredFocusableNode(e){throw Error("Flyouts are not directly focusable.")}getNestedTrees(){throw Error("Flyouts are not directly focusable.")}lookUpFocusableNode(e){throw Error("Flyouts are not directly focusable.")}onTreeFocus(e,t){}onTreeBlur(e){throw Error("Flyouts are not directly focusable.")}},Gp=class{constructor(){this.isActive=!1,this.activeClassName="blocklyKeyboardNavigation"}setIsActive(e=!0){this.isActive=e,this.updateActiveVisualization()}getIsActive(){return this.isActive}updateActiveVisualization(){this.isActive?document.body.classList.add(this.activeClassName):document.body.classList.remove(this.activeClassName)}},ec=new Gp,Om={};Om.KeyboardNavigationController=Gp,Om.keyboardNavigationController=ec;var Wp=class{constructor(e){this.workspace=e,this.horizontalScrollEnabled=this.workspace.isMovableHorizontally(),this.verticalScrollEnabled=this.workspace.isMovableVertically(),this.startScrollXY_=new k(e.scrollX,e.scrollY)}dispose(){this.workspace=null}startDrag(){}endDrag(e){this.drag(e)}drag(e){if(e=k.sum(this.startScrollXY_,e),this.horizontalScrollEnabled&&this.verticalScrollEnabled)this.workspace.scroll(e.x,e.y);else if(this.horizontalScrollEnabled)this.workspace.scroll(e.x,this.workspace.scrollY);else{if(!this.verticalScrollEnabled)throw new TypeError("Invalid state.");this.workspace.scroll(this.workspace.scrollX,e.y)}}},tc=class{constructor(e,t){this.creatorWorkspace=t,this.mouseDownXY=new k(0,0),this.startWorkspace_=this.targetBlock=this.startComment=this.startBlock=this.startIcon=this.startField=this.startBubble=null,this.hasExceededDragRadius=!1,this.boundEvents=[],this.workspaceDragger=this.dragger=null,this.dragging=!1,this.flyout=null,this.multiTouch=this.isEnding_=this.gestureHasStarted=this.calledUpdateIsDragging=!1,this.cachedPoints=new Map,this.startDistance=this.previousScale=0,this.currentDropdownOwner=this.isPinchZoomEnabled=null,this.mostRecentEvent=e,this.currentDragDeltaXY=new k(0,0)}dispose(){Oe(),Wr(),this.creatorWorkspace.clearGesture();for(const e of this.boundEvents)J(e);this.boundEvents.length=0,this.workspaceDragger&&this.workspaceDragger.dispose()}updateFromEvent(e){const t=new k(e.clientX,e.clientY);this.updateDragDelta(t)&&(this.updateIsDragging(e),at()),this.mostRecentEvent=e}updateDragDelta(e){return this.currentDragDeltaXY=k.difference(e,this.mouseDownXY),!this.hasExceededDragRadius&&(this.hasExceededDragRadius=k.magnitude(this.currentDragDeltaXY)>(this.flyout?o.config$$module$build$src$core$config.flyoutDragRadius:o.config$$module$build$src$core$config.dragRadius))}updateIsDraggingFromFlyout(){let e;if(!this.targetBlock||null==(e=this.flyout)||!e.isBlockCreatable(this.targetBlock))return!1;if(!this.flyout.targetWorkspace)throw Error("Cannot update dragging from the flyout because the ' +\n          'flyout's target workspace is undefined");return!(this.flyout.isScrollable()&&!this.flyout.isDragTowardWorkspace(this.currentDragDeltaXY)||(this.startWorkspace_=this.flyout.targetWorkspace,this.startWorkspace_.updateScreenCalculationsIfScrolled(),o.getGroup$$module$build$src$core$events$utils()||o.setGroup$$module$build$src$core$events$utils(!0),this.startBlock=null,this.targetBlock=this.flyout.createBlock(this.targetBlock),o.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.targetBlock),0))}updateIsDraggingWorkspace(){if(!this.startWorkspace_)throw Error("Cannot update dragging the workspace because the start workspace is undefined");(this.flyout?this.flyout.isScrollable():this.startWorkspace_&&this.startWorkspace_.isDraggable())&&(this.dragging=!0,this.workspaceDragger=new Wp(this.startWorkspace_),this.workspaceDragger.startDrag())}updateIsDragging(e){if(!this.startWorkspace_)throw Error("Cannot update dragging because the start workspace is undefined");if(this.calledUpdateIsDragging)throw Error("updateIsDragging_ should only be called once per gesture.");this.calledUpdateIsDragging=!0,this.flyout&&this.updateIsDraggingFromFlyout();const t=di();t&&zt(t)&&t.isMovable()?(this.dragging=!0,this.dragger=this.createDragger(t,this.startWorkspace_),this.dragger.onDragStart(e),this.dragger.onDrag(e,this.currentDragDeltaXY)):this.updateIsDraggingWorkspace()}createDragger(e,t){return new(Re(x.BLOCK_DRAGGER,this.creatorWorkspace.options,!0))(e,t)}doStart(e){if(!this.startWorkspace_)throw Error("Cannot start the touch gesture becauase the start workspace is undefined");this.isPinchZoomEnabled=this.startWorkspace_.options.zoomOptions&&this.startWorkspace_.options.zoomOptions.pinch,vo(e)?this.cancel():(this.gestureHasStarted=!0,Bo(),this.startWorkspace_.updateScreenCalculationsIfScrolled(),this.startWorkspace_.isMutator&&this.startWorkspace_.resize(),this.currentDropdownOwner=Uc(),this.startWorkspace_.hideChaff(!!this.flyout),this.startWorkspace_.markFocused(),this.mostRecentEvent=e,ms(),it(e)?this.handleRightClick(e):("pointerdown"===e.type.toLowerCase()&&"mouse"!==e.pointerType&&lo(e,this),this.mouseDownXY=new k(e.clientX,e.clientY),this.bindMouseEvents(e),this.isEnding_||this.handleTouchStart(e)))}bindMouseEvents(e){this.boundEvents.push(N(document,"pointerdown",null,this.handleStart.bind(this),!0)),this.boundEvents.push(N(document,"pointermove",null,this.handleMove.bind(this),!0)),this.boundEvents.push(N(document,"pointerup",null,this.handleUp.bind(this),!0)),e.preventDefault(),e.stopPropagation()}handleStart(e){this.isDragging()||(this.handleTouchStart(e),this.isMultiTouch()&&at())}handleMove(e){this.isDragging()&&we(e)||!this.isMultiTouch()?(this.updateFromEvent(e),this.workspaceDragger?this.workspaceDragger.drag(this.currentDragDeltaXY):this.dragger&&this.dragger.onDrag(this.mostRecentEvent,this.currentDragDeltaXY),e.preventDefault(),e.stopPropagation()):this.isMultiTouch()&&(this.handleTouchMove(e),at())}handleUp(e){if(this.isDragging()||this.handleTouchEnd(e),!this.isMultiTouch()||this.isDragging()){if(!we(e))return;if(this.updateFromEvent(e),at(),this.isEnding_)return void console.log("Trying to end a gesture recursively.");this.isEnding_=!0,this.dragger?(ec.setIsActive(!1),this.dragger.onDragEnd(e,this.currentDragDeltaXY)):this.workspaceDragger?(ec.setIsActive(!1),this.workspaceDragger.endDrag(this.currentDragDeltaXY)):this.isBubbleClick()||this.isCommentClick()||(this.isFieldClick()?this.doFieldClick():this.isIconClick()?this.doIconClick():this.isBlockClick()?this.doBlockClick():this.isWorkspaceClick()&&this.doWorkspaceClick(e))}e.preventDefault(),e.stopPropagation(),this.dispose()}handleTouchStart(e){var t=co(e);this.cachedPoints.set(t,this.getTouchPoint(e));var i=Array.from(this.cachedPoints.keys());2===i.length&&(t=this.cachedPoints.get(i[0]),i=this.cachedPoints.get(i[1]),this.startDistance=k.distance(t,i),this.multiTouch=!0,e.preventDefault())}handleTouchMove(e){const t=co(e);this.cachedPoints.set(t,this.getTouchPoint(e)),this.isPinchZoomEnabled&&2===this.cachedPoints.size?this.handlePinch(e):(this.updateFromEvent(e),this.workspaceDragger?this.workspaceDragger.drag(this.currentDragDeltaXY):this.dragger&&this.dragger.onDrag(this.mostRecentEvent,this.currentDragDeltaXY),e.preventDefault(),e.stopPropagation())}handlePinch(e){var t=Array.from(this.cachedPoints.keys()),i=this.cachedPoints.get(t[0]);if(t=this.cachedPoints.get(t[1]),i=k.distance(i,t)/this.startDistance,this.previousScale>0&&this.previousScale<1/0){if(t=(t=i-this.previousScale)>0?5*t:6*t,!this.startWorkspace_)throw Error("Cannot handle a pinch because the start workspace is undefined");const s=this.startWorkspace_,n=wt(e,s.getParentSvg(),s.getInverseScreenCTM());s.zoom(n.x,n.y,t)}this.previousScale=i,e.preventDefault()}handleTouchEnd(e){e=co(e),this.cachedPoints.has(e)&&this.cachedPoints.delete(e),this.cachedPoints.size<2&&(this.cachedPoints.clear(),this.previousScale=0)}getTouchPoint(e){return this.startWorkspace_?new k(e.pageX,e.pageY):null}isMultiTouch(){return this.multiTouch}cancel(){this.isEnding_||(at(),this.dragger?this.dragger.onDragEnd(this.mostRecentEvent,this.currentDragDeltaXY):this.workspaceDragger&&this.workspaceDragger.endDrag(this.currentDragDeltaXY),this.dispose())}handleRightClick(e){this.targetBlock?(this.bringBlockToFront(),this.targetBlock.workspace.hideChaff(!!this.flyout),this.targetBlock.showContextMenu(e)):this.startBubble?this.startBubble.showContextMenu(e):this.startComment?(this.startComment.workspace.hideChaff(),this.startComment.showContextMenu(e)):this.startWorkspace_&&!this.flyout&&(this.startWorkspace_.hideChaff(),o.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.startWorkspace_),this.startWorkspace_.showContextMenu(e)),e.preventDefault(),e.stopPropagation(),ec.setIsActive(!1),this.dispose()}handleWsStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleWsStart, but the gesture had already been started.");this.setStartWorkspace(t),this.mostRecentEvent=e,this.startBlock||this.startBubble||this.startComment?this.startBlock&&o.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.startBlock):o.getFocusManager$$module$build$src$core$focus_manager().focusNode(t),this.doStart(e)}fireWorkspaceClick(e){D(new(P(f.CLICK))(null,e.id,"workspace"))}handleFlyoutStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleFlyoutStart, but the gesture had already been started.");this.setStartFlyout(t),this.handleWsStart(e,t.getWorkspace())}handleBlockStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleBlockStart, but the gesture had already been started.");this.setStartBlock(t),this.mostRecentEvent=e}handleBubbleStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleBubbleStart, but the gesture had already been started.");this.setStartBubble(t),this.mostRecentEvent=e}handleCommentStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleCommentStart, but the gesture had already been started.");this.setStartComment(t),this.mostRecentEvent=e}doFieldClick(){if(!this.startField)throw Error("Cannot do a field click because the start field is undefined");this.bringBlockToFront(),this.currentDropdownOwner!==this.startField&&this.startField.showEditor(this.mostRecentEvent)}doIconClick(){if(!this.startIcon)throw Error("Cannot do an icon click because the start icon is undefined");this.bringBlockToFront(),this.startIcon.onClick()}doBlockClick(){if(this.flyout&&this.flyout.autoClose){if(!this.targetBlock)throw Error("Cannot do a block click because the target block is undefined");if(this.flyout.isBlockCreatable(this.targetBlock)){o.getGroup$$module$build$src$core$events$utils()||o.setGroup$$module$build$src$core$events$utils(!0);var e=this.flyout.createBlock(this.targetBlock);e.snapToGrid(),e.bumpNeighbours(),o.getFocusManager$$module$build$src$core$focus_manager().focusNode(e)}}else{if(!this.startWorkspace_)throw Error("Cannot do a block click because the start workspace is undefined");e=new(P(f.CLICK))(this.startBlock,this.startWorkspace_.id,"block"),D(e)}this.bringBlockToFront(),o.setGroup$$module$build$src$core$events$utils(!1)}doWorkspaceClick(e){this.fireWorkspaceClick(this.startWorkspace_||this.creatorWorkspace)}bringBlockToFront(){this.targetBlock&&!this.flyout&&(o.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.targetBlock),this.targetBlock.bringToFront())}setStartField(e){if(this.gestureHasStarted)throw Error("Tried to call gesture.setStartField, but the gesture had already been started.");this.startField||(this.startField=e)}setStartIcon(e){if(this.gestureHasStarted)throw Error("Tried to call gesture.setStartIcon, but the gesture had already been started.");this.startIcon||(this.startIcon=e)}setStartBubble(e){this.startBubble||(this.startBubble=e)}setStartComment(e){this.startComment||(this.startComment=e)}setStartBlock(e){this.startBlock||this.startBubble||(this.startBlock=e,e.isInFlyout&&e!==e.getRootBlock()?this.setTargetBlock(e.getRootBlock()):this.setTargetBlock(e))}setTargetBlock(e){e.isShadow()?this.setTargetBlock(e.getParent()):(this.targetBlock=e,o.getFocusManager$$module$build$src$core$focus_manager().focusNode(e))}setStartWorkspace(e){this.startWorkspace_||(this.startWorkspace_=e)}setStartFlyout(e){this.flyout||(this.flyout=e)}isBubbleClick(){return!!this.startBubble&&!this.hasExceededDragRadius}isCommentClick(){return!!this.startComment&&!this.hasExceededDragRadius}isBlockClick(){return!(!this.startBlock||this.hasExceededDragRadius||this.isFieldClick()||this.isIconClick())}isFieldClick(){return!!this.startField&&this.startField.isClickable()&&!this.hasExceededDragRadius&&(!this.flyout||this.startField.isClickableInFlyout(this.flyout.autoClose))}isIconClick(){if(!this.startIcon)return!1;const e=!this.flyout||!this.startIcon.isClickableInFlyout||this.startIcon.isClickableInFlyout(this.flyout.autoClose);return!this.hasExceededDragRadius&&e}isWorkspaceClick(){return!(this.startBlock||this.startBubble||this.startField||this.hasExceededDragRadius)}getCurrentDragger(){let e,t;return null!=(t=null!=(e=this.workspaceDragger)?e:this.dragger)?t:null}isDragging(){return this.dragging}hasStarted(){return this.gestureHasStarted}static inProgress(){const e=ui();for(let i,t=0;i=e[t];t++)if(i.currentGesture_)return!0;return!1}},bu=class{constructor(e,t){let i,s,n;this.pattern=e,this.scale=1,this.spacing=null!=(i=t.spacing)?i:0,this.length=null!=(s=t.length)?s:1,this.line2=(this.line1=e.firstChild)&&this.line1.nextSibling,this.snapToGrid=null!=(n=t.snap)&&n}setSpacing(e){this.spacing=e,this.update(this.scale)}getSpacing(){return this.spacing}setLength(e){this.length=e,this.update(this.scale)}getLength(){return this.length}setSnapToGrid(e){this.snapToGrid=e}shouldSnap(){return this.snapToGrid}getPatternId(){return this.pattern.id}update(e){this.scale=e;var t=this.spacing*e;this.pattern.setAttribute("width",`${t}`),this.pattern.setAttribute("height",`${t}`);let i=(t=Math.floor(this.spacing/2)+.5)-this.length/2,s=t+this.length/2;i*=e,s*=e,this.setLineAttributes(this.line1,e,i,s,t*=e,t),this.setLineAttributes(this.line2,e,t,t,i,s)}setLineAttributes(e,t,i,s,n,l){e&&(e.setAttribute("stroke-width",`${t}`),e.setAttribute("x1",`${i}`),e.setAttribute("y1",`${n}`),e.setAttribute("x2",`${s}`),e.setAttribute("y2",`${l}`))}moveTo(e,t){this.pattern.setAttribute("x",`${e}`),this.pattern.setAttribute("y",`${t}`)}alignXY(e){var t=this.getSpacing();const i=t/2,s=Math.round(Math.round((e.x-i)/t)*t+i);return t=Math.round(Math.round((e.y-i)/t)*t+i),s===e.x&&t===e.y?e:new k(s,t)}static createDom(e,t,i,s){let n,l;if(e=I(T.PATTERN,{id:"blocklyGridPattern"+e,patternUnits:"userSpaceOnUse"},i),(null!=(n=t.length)?n:1)>0&&(null!=(l=t.spacing)?l:0)>0){let u;I(T.LINE,{stroke:t.colour},e),null!=(u=t.length)&&u&&I(T.LINE,{stroke:t.colour},e)}else I(T.LINE,{},e);return s&&s.style.setProperty("--blocklyGridPattern",`url(#${e.id})`),e}},qp=class{constructor(){this.curNode=this.colour=null,this.type="marker"}getCurNode(){return this.curNode}setCurNode(e){this.curNode=e}dispose(){this.curNode=null}getSourceBlockFromNode(e){return e instanceof se?e:e instanceof ee||e instanceof Pe?e.getSourceBlock():null}getSourceBlock(){return this.getSourceBlockFromNode(this.getCurNode())}},fu=class extends qp{constructor(e){super(),this.workspace=e,this.type="cursor",this.potentialNodes=null}next(){var e=this.getCurNode();return e?((e=this.getNextNode(e,t=>{let i;return t instanceof se&&!(null!=(i=t.outputConnection)&&i.targetBlock())||t instanceof Kt},!0))&&this.setCurNode(e),e):null}in(){var e=this.getCurNode();return e?((e=this.getNextNode(e,()=>!0,!0))&&this.setCurNode(e),e):null}prev(){var e=this.getCurNode();return e?((e=this.getPreviousNode(e,t=>{let i;return t instanceof se&&!(null!=(i=t.outputConnection)&&i.targetBlock())||t instanceof Kt},!0))&&this.setCurNode(e),e):null}out(){var e=this.getCurNode();return e?((e=this.getPreviousNode(e,()=>!0,!0))&&this.setCurNode(e),e):null}atEndOfLine(){var e=this.getCurNode();return!!e&&this.getNextNode(e,()=>!0,!0)===this.getNextNode(e,i=>{let s;return i instanceof se&&!(null!=(s=i.outputConnection)&&s.targetBlock())},!0)}getNextNodeImpl(e,t,i=new Set){if(!e||i.has(e))return null;let s=this.workspace.getNavigator().getFirstChild(e)||this.workspace.getNavigator().getNextSibling(e);for(var n=e;n&&!s&&(n=this.workspace.getNavigator().getParent(n));)s=this.workspace.getNavigator().getNextSibling(n);return t(s)?s:s?(i.add(e),this.getNextNodeImpl(s,t,i)):null}getNextNode(e,t,i){return!e||!i&&this.getLastNode()===e?null:this.getNextNodeImpl(e,t)}getPreviousNodeImpl(e,t,i=new Set){if(!e||i.has(e))return null;const s=this.getRightMostChild(this.workspace.getNavigator().getPreviousSibling(e),e)||this.workspace.getNavigator().getParent(e);return t(s)?s:s?(i.add(e),this.getPreviousNodeImpl(s,t,i)):null}getPreviousNode(e,t,i){return!e||!i&&this.getFirstNode()===e?null:this.getPreviousNodeImpl(e,t)}getRightMostChild(e,t){if(!e)return e;let i=this.workspace.getNavigator().getFirstChild(e);if(!i||i===t)return e;for(e=i;e&&e!==t;e=this.workspace.getNavigator().getNextSibling(i))i=e;return this.getRightMostChild(i,t)}preDelete(e){var i,t=this.getCurNode();let s,n;t=t?[t]:[];const l=null!=(n=null==(i=e.previousConnection)?void 0:i.targetConnection)?n:null==(s=e.outputConnection)?void 0:s.targetConnection;l&&t.push(l),(i=e.getNextBlock())&&t.push(i),(e=e.getParent())&&t.push(e),t.push(this.workspace),this.potentialNodes=t}postDelete(){const e=this.potentialNodes;if(this.potentialNodes=null,!e)throw Error("must call preDelete first");for(const t of e){let i;if(null==(i=this.getSourceBlockFromNode(t))||!i.disposed)return void this.setCurNode(t)}throw Error("no valid nodes in this.potentialNodes")}getCurNode(){return o.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode()}setCurNode(e){o.getFocusManager$$module$build$src$core$focus_manager().focusNode(e),e instanceof se?e.workspace.scrollBoundsIntoView(e.getBoundingRectangleWithoutChildren()):e instanceof ee?(e=e.getSourceBlock()).workspace.scrollBoundsIntoView(e.getBoundingRectangleWithoutChildren()):e instanceof Kt&&e.workspace.scrollBoundsIntoView(e.getBoundingRectangle())}getFirstNode(){return this.workspace.getNavigator().getFirstChild(this.workspace)}getLastNode(){const e=this.getFirstNode();return this.getPreviousNode(e,()=>!0,!0)}};U(x.CURSOR,gt,fu);var Tu=class{constructor(e){this.workspace=e,this.markers=new Map,this.cursor=new fu(this.workspace)}registerMarker(e,t){this.markers.has(e)&&this.unregisterMarker(e),this.markers.set(e,t)}unregisterMarker(e){const t=this.markers.get(e);if(!t)throw Error("Marker with ID "+e+" does not exist. Can only unregister markers that exist.");t.dispose(),this.markers.delete(e)}getCursor(){return this.cursor}getMarker(e){return this.markers.get(e)||null}setCursor(e){this.cursor=e}dispose(){const e=Object.keys(this.markers);for(let i,t=0;i=e[t];t++)this.unregisterMarker(i);this.markers.clear(),this.cursor.dispose()}};Tu.LOCAL_MARKER="local_marker_1";var Eu=class extends te{constructor(e,t,i){super(e,t,i,Eu.createTextArea()),this.workspace=e,this.anchor=t,this.ownerRect=i,this.resizePointerMoveListener=this.resizePointerUpListener=null,this.textChangeListeners=[],this.sizeChangeListeners=[],this.locationChangeListeners=[],this.text="",this.DEFAULT_SIZE=new Y(160+te.DOUBLE_BORDER,80+te.DOUBLE_BORDER),this.MIN_SIZE=new Y(45+te.DOUBLE_BORDER,20+te.DOUBLE_BORDER),this.editable=!0,R(this.svgRoot,"blocklyTextInputBubble"),this.textArea=this.getFocusableElement(),this.inputRoot=this.createEditor(this.contentContainer,this.textArea),this.resizeGroup=this.createResizeHandle(this.svgRoot,e),this.setSize(this.DEFAULT_SIZE,!0)}getText(){return this.text}setText(e){this.text=e,this.textArea.value=e,this.onTextChange()}setEditable(e){(this.editable=e)?this.textArea.removeAttribute("readonly"):this.textArea.setAttribute("readonly","")}isEditable(){return this.editable}addTextChangeListener(e){this.textChangeListeners.push(e)}addSizeChangeListener(e){this.sizeChangeListeners.push(e)}addLocationChangeListener(e){this.locationChangeListeners.push(e)}static createTextArea(){const e=document.createElementNS(go,"textarea");return e.className="blocklyTextarea blocklyText",e}createEditor(e,t){e=I(T.FOREIGNOBJECT,{x:te.BORDER_WIDTH,y:te.BORDER_WIDTH},e);const i=document.createElementNS(go,"body");return i.setAttribute("xmlns",go),i.className="blocklyMinimalBody",t.setAttribute("dir",this.workspace.RTL?"RTL":"LTR"),i.appendChild(t),e.appendChild(i),this.bindTextAreaEvents(t),e}bindTextAreaEvents(e){N(e,"wheel",this,t=>{t.stopPropagation()}),N(e,"pointerdown",this,t=>{t.stopPropagation(),Oe()}),N(e,"change",this,this.onTextChange)}createResizeHandle(e,t){return e=I(T.IMAGE,{class:"blocklyResizeHandle",href:`${t.options.pathToMedia}resize-handle.svg`},e),N(e,"pointerdown",this,this.onResizePointerDown),e}setSize(e,t=!1){e.width=Math.max(e.width,this.MIN_SIZE.width),e.height=Math.max(e.height,this.MIN_SIZE.height);const i=e.width-te.DOUBLE_BORDER,s=e.height-te.DOUBLE_BORDER;this.inputRoot.setAttribute("width",`${i}`),this.inputRoot.setAttribute("height",`${s}`),this.resizeGroup.setAttribute("y",`${s}`),this.resizeGroup.setAttribute("x",this.workspace.RTL?""+-te.DOUBLE_BORDER:`${i}`),super.setSize(e,t),this.onSizeChange()}getSize(){return super.getSize()}moveDuringDrag(e){super.moveDuringDrag(e),this.onLocationChange()}setPositionRelativeToAnchor(e,t){super.setPositionRelativeToAnchor(e,t),this.onLocationChange()}positionByRect(e=new j(0,0,0,0)){super.positionByRect(e),this.onLocationChange()}onResizePointerDown(e){this.bringToFront(),it(e)||(h(this.workspace,e,new k(this.workspace.RTL?-this.getSize().width:this.getSize().width,this.getSize().height)),this.resizePointerUpListener=N(document,"pointerup",this,this.onResizePointerUp),this.resizePointerMoveListener=N(document,"pointermove",this,this.onResizePointerMove),this.workspace.hideChaff()),e.stopPropagation()}onResizePointerUp(e){Oe(),this.resizePointerUpListener&&(J(this.resizePointerUpListener),this.resizePointerUpListener=null),this.resizePointerMoveListener&&(J(this.resizePointerMoveListener),this.resizePointerMoveListener=null)}onResizePointerMove(e){e=w(this.workspace,e),this.setSize(new Y(this.workspace.RTL?-e.x:e.x,e.y),!1),this.onSizeChange()}onTextChange(){this.text=this.textArea.value;for(const e of this.textChangeListeners)e()}onSizeChange(){for(const e of this.sizeChangeListeners)e()}onLocationChange(){for(const e of this.locationChangeListeners)e()}};Ft("\n.blocklyTextInputBubble .blocklyTextarea {\n  background-color: var(--commentFillColour);\n  border: 0;\n  box-sizing: border-box;\n  display: block;\n  outline: 0;\n  padding: 5px;\n  resize: none;\n  width: 100%;\n  height: 100%;\n}\n");var zp={};zp.register=Un,zp.unregister=bl;var _o=class extends rr{constructor(e){super(e),this.sourceBlock=e,this.textInputBubble=null,this.text="",this.bubbleSize=new Y(160,80),this.bubbleVisiblity=!1}getType(){return _o.TYPE}initView(e){this.svgRoot||(super.initView(e),I(T.CIRCLE,{class:"blocklyIconShape",r:"8",cx:"8",cy:"8"},this.svgRoot),I(T.PATH,{class:"blocklyIconSymbol",d:"m6.8,10h2c0.003,-0.617 0.271,-0.962 0.633,-1.266 2.875,-2.4050.607,-5.534 -3.765,-3.874v1.7c3.12,-1.657 3.698,0.118 2.336,1.25-1.201,0.998 -1.201,1.528 -1.204,2.19z"},this.svgRoot),I(T.RECT,{class:"blocklyIconSymbol",x:"6.8",y:"10.78",height:"2",width:"2"},this.svgRoot),R(this.svgRoot,"blocklyCommentIcon"))}dispose(){let e;super.dispose(),null==(e=this.textInputBubble)||e.dispose()}getWeight(){return _o.WEIGHT}getSize(){return new Y(17,17)}applyColour(){super.applyColour();const e=this.sourceBlock.getColour();let t;null==(t=this.textInputBubble)||t.setColour(e)}updateEditable(){const e=this,t=()=>super.updateEditable;return(0,y.asyncExecutePromiseGeneratorFunction)(function*(){t().call(e),e.bubbleIsVisible()&&(yield e.setBubbleVisible(!1),yield e.setBubbleVisible(!0))})}onLocationChange(e){const t=this.workspaceLocation;let i;super.onLocationChange(e),this.bubbleLocation&&(e=k.difference(this.workspaceLocation,t),this.bubbleLocation=k.sum(this.bubbleLocation,e)),e=this.getAnchorLocation(),null==(i=this.textInputBubble)||i.setAnchorLocation(e)}setText(e){const t=this.text;let i;D(new(P(f.BLOCK_CHANGE))(this.sourceBlock,"comment",null,t,e)),this.text=e,null==(i=this.textInputBubble)||i.setText(this.text)}getText(){return this.text}setBubbleSize(e){let t;this.bubbleSize=e,null==(t=this.textInputBubble)||t.setSize(this.bubbleSize,!0)}getBubbleSize(){return this.bubbleSize}setBubbleLocation(e){let t;this.bubbleLocation=e,null==(t=this.textInputBubble)||t.moveDuringDrag(e)}getBubbleLocation(){return this.bubbleLocation}saveState(){if(this.text){const e={text:this.text,pinned:this.bubbleIsVisible(),height:this.bubbleSize.height,width:this.bubbleSize.width},t=this.getBubbleLocation();return t&&(e.x=this.sourceBlock.workspace.RTL?this.sourceBlock.workspace.getWidth()-(t.x+this.bubbleSize.width):t.x,e.y=t.y),e}return null}loadState(e){let t,i,s,n;this.text=null!=(t=e.text)?t:"",this.bubbleSize=new Y(null!=(i=e.width)?i:160,null!=(s=e.height)?s:80),this.bubbleVisiblity=null!=(n=e.pinned)&&n,this.setBubbleVisible(this.bubbleVisiblity);let l=e.x;const u=e.y;Zt().then(()=>{l&&u&&(l=this.sourceBlock.workspace.RTL?this.sourceBlock.workspace.getWidth()-(l+this.bubbleSize.width):l,this.setBubbleLocation(new k(l,u)))})}onClick(){super.onClick(),this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}onTextChange(){if(this.textInputBubble){var e=this.textInputBubble.getText();this.text!==e&&(D(new(P(f.BLOCK_CHANGE))(this.sourceBlock,"comment",null,this.text,e)),this.text=e)}}onSizeChange(){this.textInputBubble&&(this.bubbleSize=this.textInputBubble.getSize())}onBubbleLocationChange(){this.textInputBubble&&(this.bubbleLocation=this.textInputBubble.getRelativeToSurfaceXY())}bubbleIsVisible(){return this.bubbleVisiblity}setBubbleVisible(e){const t=this;return(0,y.asyncExecutePromiseGeneratorFunction)(function*(){t.bubbleVisiblity!==e&&(t.bubbleVisiblity=e,yield Zt(),!t.sourceBlock.rendered||t.sourceBlock.isInFlyout||t.sourceBlock.isInsertionMarker()||(e?(t.sourceBlock.isEditable()?t.showEditableBubble():t.showNonEditableBubble(),t.applyColour()):t.hideBubble(),D(new(P(f.BUBBLE_OPEN))(t.sourceBlock,e,"comment"))))})}getBubble(){return this.textInputBubble}showEditableBubble(){let e,t;this.createBubble(),null==(e=this.textInputBubble)||e.addTextChangeListener(()=>this.onTextChange()),null==(t=this.textInputBubble)||t.addSizeChangeListener(()=>this.onSizeChange())}showNonEditableBubble(){let e;this.createBubble(),null==(e=this.textInputBubble)||e.setEditable(!1)}createBubble(){this.textInputBubble=new Eu(this.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect()),this.textInputBubble.setText(this.getText()),this.textInputBubble.setSize(this.bubbleSize,!0),this.bubbleLocation&&this.textInputBubble.moveDuringDrag(this.bubbleLocation),this.textInputBubble.addTextChangeListener(()=>this.onTextChange()),this.textInputBubble.addSizeChangeListener(()=>this.onSizeChange()),this.textInputBubble.addLocationChangeListener(()=>this.onBubbleLocationChange())}hideBubble(){let e;null==(e=this.textInputBubble)||e.dispose(),this.textInputBubble=null}getAnchorLocation(){return k.sum(this.workspaceLocation,new k(8.5,8.5))}getBubbleOwnerRect(){return this.sourceBlock.getBoundingRectangleWithoutChildren()}};_o.TYPE=ke.COMMENT,_o.WEIGHT=3,Un(_o.TYPE,_o);var Gi={};Gi.CommentIcon=_o,Gi.Icon=rr,Gi.IconType=ke,Gi.MutatorIcon=o.MutatorIcon$$module$build$src$core$icons$mutator_icon,Gi.WarningIcon=to,Gi.exceptions=Cm,Gi.registry=zp,o.Names$$module$build$src$core$names=class{constructor(e,t){this.db=new Map,this.dbReverse=new Set,this.variableMap=null,this.variablePrefix=t||"",this.reservedWords=new Set(e?e.split(","):[])}reset(){this.db.clear(),this.dbReverse.clear(),this.variableMap=null}setVariableMap(e){this.variableMap=e}getNameForUserVariable(e){return this.variableMap?(e=this.variableMap.getVariableById(e))?e.getName():null:(console.warn("Deprecated call to Names.prototype.getName without defining a variable map. To fix, add the following code in your generator's init() function:\nBlockly.YourGeneratorName.nameDB_.setVariableMap(workspace.getVariableMap());"),null)}populateVariables(e){e=o.allUsedVarModels$$module$build$src$core$variables(e);for(let t=0;t<e.length;t++)this.getName(e[t].getId(),o.NameType$$module$build$src$core$names.VARIABLE)}populateProcedures(e){throw Error("The implementation of populateProcedures should be monkey-patched in by blockly.ts")}getName(e,t){let i=e;t===o.NameType$$module$build$src$core$names.VARIABLE&&(e=this.getNameForUserVariable(e))&&(i=e),e=i.toLowerCase();const s=t===o.NameType$$module$build$src$core$names.VARIABLE||t===o.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix:"";this.db.has(t)||this.db.set(t,new Map);const n=this.db.get(t);return n.has(e)?s+n.get(e):(t=this.getDistinctName(i,t),n.set(e,t.substr(s.length)),t)}getUserNames(e){let t;return(e=null==(t=this.db.get(e))?void 0:t.keys())?Array.from(e):[]}getDistinctName(e,t){e=this.safeName(e);let s,n,l,i=null;for(;this.dbReverse.has(e+(null!=(s=i)?s:""))||this.reservedWords.has(e+(null!=(n=i)?n:""));)i=i?i+1:2;return e+=null!=(l=i)?l:"",this.dbReverse.add(e),(t===o.NameType$$module$build$src$core$names.VARIABLE||t===o.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix:"")+e}safeName(e){return e?(e=encodeURI(e.replace(/ /g,"_")).replace(/[^\w]/g,"_"),"0123456789".includes(e[0])&&(e="my_"+e)):e=o.Msg$$module$build$src$core$msg.UNNAMED_KEY||"unnamed",e}static equals(e,t){return e.toLowerCase()===t.toLowerCase()}},function(e){(e=e.NameType||(e.NameType={})).DEVELOPER_VARIABLE="DEVELOPER_VARIABLE",e.VARIABLE="VARIABLE",e.PROCEDURE="PROCEDURE"}(o.Names$$module$build$src$core$names||(o.Names$$module$build$src$core$names={})),o.NameType$$module$build$src$core$names=o.Names$$module$build$src$core$names.NameType,o.Names$$module$build$src$core$names.DEVELOPER_VARIABLE_TYPE=o.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE,{NameType:o.NameType$$module$build$src$core$names}.Names=o.Names$$module$build$src$core$names;var oc,et,Yp=class extends Map{constructor(){super()}set(e,t){return this.get(e)===t||(super.set(e,t),ct(t)&&t.startPublishing()),this}delete(e){const t=this.get(e);return(e=super.delete(e))&&(ct(t)&&t.stopPublishing(),e)}clear(){if(this.size)for(const e of this.keys())this.delete(e)}add(e){return this.set(e.getId(),e)}getProcedures(){return[...this.values()]}};oc="PROCEDURE",o.DEFAULT_ARG$$module$build$src$core$procedures="x",(et={CATEGORY_NAME:oc,DEFAULT_ARG:o.DEFAULT_ARG$$module$build$src$core$procedures}).ObservableProcedureMap=Yp,et.allProcedures=Si,et.findLegalName=o.findLegalName$$module$build$src$core$procedures,et.flyoutCategory=Zn,et.getCallers=El,et.getDefinition=o.getDefinition$$module$build$src$core$procedures,et.internalFlyoutCategory=Et,et.isNameUsed=Ot,et.isProcedureBlock=We,et.mutateCallers=o.mutateCallers$$module$build$src$core$procedures,et.mutatorOpenListener=As,et.rename=o.rename$$module$build$src$core$procedures;var m=new class{constructor(){this.NONE=0,this.FIELD=1,this.HAT=2,this.ICON=4,this.SPACER=8,this.BETWEEN_ROW_SPACER=16,this.IN_ROW_SPACER=32,this.EXTERNAL_VALUE_INPUT=64,this.INPUT=128,this.INLINE_INPUT=256,this.STATEMENT_INPUT=512,this.CONNECTION=1024,this.PREVIOUS_CONNECTION=2048,this.NEXT_CONNECTION=4096,this.OUTPUT_CONNECTION=8192,this.CORNER=16384,this.LEFT_SQUARE_CORNER=32768,this.LEFT_ROUND_CORNER=65536,this.RIGHT_SQUARE_CORNER=131072,this.RIGHT_ROUND_CORNER=262144,this.JAGGED_EDGE=524288,this.ROW=1048576,this.TOP_ROW=2097152,this.BOTTOM_ROW=4194304,this.INPUT_ROW=8388608,this.LEFT_CORNER=this.LEFT_SQUARE_CORNER|this.LEFT_ROUND_CORNER,this.RIGHT_CORNER=this.RIGHT_SQUARE_CORNER|this.RIGHT_ROUND_CORNER,this.nextTypeValue_=16777216}getType(e){return Object.prototype.hasOwnProperty.call(this,e)||(this[e]=this.nextTypeValue_,this.nextTypeValue_<<=1),this[e]}isField(e){return(e.type&this.FIELD)>=1}isHat(e){return(e.type&this.HAT)>=1}isIcon(e){return(e.type&this.ICON)>=1}isSpacer(e){return(e.type&this.SPACER)>=1}isInRowSpacer(e){return(e.type&this.IN_ROW_SPACER)>=1}isSpacerRow(e){return(e.type&this.BETWEEN_ROW_SPACER)>=1}isInput(e){return(e.type&this.INPUT)>=1}isExternalInput(e){return(e.type&this.EXTERNAL_VALUE_INPUT)>=1}isInlineInput(e){return(e.type&this.INLINE_INPUT)>=1}isStatementInput(e){return(e.type&this.STATEMENT_INPUT)>=1}isPreviousConnection(e){return(e.type&this.PREVIOUS_CONNECTION)>=1}isNextConnection(e){return(e.type&this.NEXT_CONNECTION)>=1}isPreviousOrNextConnection(e){return this.isPreviousConnection(e)||this.isNextConnection(e)}isRoundCorner(e){return(e.type&this.LEFT_ROUND_CORNER)>=1||(e.type&this.RIGHT_ROUND_CORNER)>=1}isLeftRoundedCorner(e){return this.isRoundCorner(e)&&(e.type&this.LEFT_ROUND_CORNER)>=1}isRightRoundedCorner(e){return this.isRoundCorner(e)&&(e.type&this.RIGHT_ROUND_CORNER)>=1}isLeftSquareCorner(e){return(e.type&this.LEFT_SQUARE_CORNER)>=1}isRightSquareCorner(e){return(e.type&this.RIGHT_SQUARE_CORNER)>=1}isCorner(e){return(e.type&this.CORNER)>=1}isJaggedEdge(e){return(e.type&this.JAGGED_EDGE)>=1}isRow(e){return(e.type&this.ROW)>=1}isBetweenRowSpacer(e){return(e.type&this.BETWEEN_ROW_SPACER)>=1}isTopRow(e){return(e.type&this.TOP_ROW)>=1}isBottomRow(e){return(e.type&this.BOTTOM_ROW)>=1}isTopOrBottomRow(e){return this.isTopRow(e)||this.isBottomRow(e)}isInputRow(e){return(e.type&this.INPUT_ROW)>=1}},oo=class{constructor(e){this.centerline=this.xPos=this.height=this.width=0,this.constants_=e,this.type=m.NONE,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}},ar=class{constructor(e){this.elements=[],this.xPos=this.yPos=this.widthWithConnectedBlocks=this.minWidth=this.minHeight=this.width=this.height=0,this.hasStatement=this.hasExternalInput=!1,this.statementEdge=0,this.hasJaggedEdge=this.hasDummyInput=this.hasInlineInput=!1,this.align=null,this.constants_=e,this.type=m.ROW,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}getLastInput(){for(let e=this.elements.length-1;e>=0;e--){const t=this.elements[e];if(m.isInput(t))return t}return null}measure(){throw Error("Unexpected attempt to measure a base Row.")}startsWithElemSpacer(){return!0}endsWithElemSpacer(){return!0}getFirstSpacer(){for(let e=0;e<this.elements.length;e++){const t=this.elements[e];if(m.isInRowSpacer(t))return t}return null}getLastSpacer(){for(let e=this.elements.length-1;e>=0;e--){const t=this.elements[e];if(m.isInRowSpacer(t))return t}return null}},vu=class extends ar{constructor(e){super(e),this.hasNextConnection=!1,this.connection=null,this.baseline=this.descenderHeight=0,this.type|=m.BOTTOM_ROW}hasLeftSquareCorner(e){return!!e.outputConnection||!!e.getNextBlock()}hasRightSquareCorner(e){return!0}measure(){let e=0,t=0,i=0;for(let s=0;s<this.elements.length;s++){const n=this.elements[s];t+=n.width,m.isSpacer(n)||(m.isNextConnection(n)?i=Math.max(i,n.height):e=Math.max(e,n.height))}this.width=Math.max(this.minWidth,t),this.height=Math.max(this.minHeight,e)+i,this.descenderHeight=i,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return!1}endsWithElemSpacer(){return!1}},Wi=class extends oo{constructor(e,t){super(e),this.connectionModel=t,this.type|=m.CONNECTION,this.shape=this.constants_.shapeFor(t),this.isDynamicShape="isDynamic"in this.shape&&this.shape.isDynamic,this.highlighted=t.isHighlighted()}},ic=class extends Wi{constructor(e,t){super(e,t.connection),this.input=t,this.connectionOffsetY=this.connectionOffsetX=0,this.type|=m.INPUT,this.align=t.align,(this.connectedBlock=t.connection&&t.connection.targetBlock()?t.connection.targetBlock():null)?(e=this.connectedBlock.getHeightWidth(),this.connectedBlockWidth=e.width,this.connectedBlockHeight=e.height):this.connectedBlockHeight=this.connectedBlockWidth=0}},yu=class extends ic{constructor(e,t){super(e,t),this.height=0,this.type|=m.EXTERNAL_VALUE_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight-this.constants_.TAB_OFFSET_FROM_TOP-this.constants_.MEDIUM_PADDING:this.shape.height,this.width=this.shape.width+this.constants_.EXTERNAL_VALUE_INPUT_PADDING,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP,this.connectionHeight=this.shape.height,this.connectionWidth=this.shape.width}},Cu=class extends oo{constructor(e,t,i){super(e),this.field=t,this.parentInput=i,this.isEditable=t.EDITABLE,this.flipRtl=t.getFlipRtl(),this.type|=m.FIELD,e=this.field.getSize(),this.height=e.height,this.width=e.width}},Xp=class extends oo{constructor(e){super(e),this.type|=m.HAT,this.height=this.constants_.START_HAT.height,this.width=this.constants_.START_HAT.width,this.ascenderHeight=this.height}},Kp=class extends oo{constructor(e,t){super(e),this.icon=t,this.flipRtl=!1,this.type|=m.ICON,e=t.getSize(),this.height=e.height,this.width=e.width}},_t=class extends oo{constructor(e,t){super(e),this.type|=m.SPACER|m.IN_ROW_SPACER,this.width=t,this.height=this.constants_.SPACER_DEFAULT_HEIGHT}},Iu=class extends ic{constructor(e,t){super(e,t),this.type|=m.INLINE_INPUT,this.connectedBlock?(this.width=this.connectedBlockWidth,this.height=this.connectedBlockHeight):(this.height=this.constants_.EMPTY_INLINE_INPUT_HEIGHT,this.width=this.constants_.EMPTY_INLINE_INPUT_PADDING),this.connectionHeight=this.isDynamicShape?this.shape.height(this.height):this.shape.height,this.connectionWidth=this.isDynamicShape?this.shape.width(this.height):this.shape.width,this.connectedBlock||(this.width+=this.connectionWidth*(this.isDynamicShape?2:1)),this.connectionOffsetY="connectionOffsetY"in this.shape?this.shape.connectionOffsetY(this.connectionHeight):this.constants_.TAB_OFFSET_FROM_TOP,this.connectionOffsetX="connectionOffsetX"in this.shape?this.shape.connectionOffsetX(this.connectionWidth):0}},xu=class extends ar{constructor(e){super(e),this.connectedBlockWidths=0,this.type|=m.INPUT_ROW}measure(){this.width=this.minWidth,this.height=this.minHeight;let e=0;for(let t=0;t<this.elements.length;t++){const i=this.elements[t];this.width+=i.width,m.isInput(i)&&(m.isStatementInput(i)?e+=i.connectedBlockWidth:m.isExternalInput(i)&&0!==i.connectedBlockWidth&&(e+=i.connectedBlockWidth-i.connectionWidth)),m.isSpacer(i)||(this.height=Math.max(this.height,i.height))}this.connectedBlockWidths=e,this.widthWithConnectedBlocks=this.width+e}endsWithElemSpacer(){return!this.hasExternalInput&&!this.hasStatement}},Jp=class extends oo{constructor(e){super(e),this.type|=m.JAGGED_EDGE,this.height=this.constants_.JAGGED_TEETH.height,this.width=this.constants_.JAGGED_TEETH.width}},Qp=class extends Wi{constructor(e,t){super(e,t),this.type|=m.NEXT_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},eg=class extends Wi{constructor(e,t){super(e,t),this.connectionOffsetX=0,this.type|=m.OUTPUT_CONNECTION,this.height=this.isDynamicShape?0:this.shape.height,this.startX=this.width=this.isDynamicShape?0:this.shape.width,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP}},tg=class extends Wi{constructor(e,t){super(e,t),this.type|=m.PREVIOUS_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},ur=class extends oo{constructor(e,t){super(e),this.type=(t&&"left"!==t?m.RIGHT_ROUND_CORNER:m.LEFT_ROUND_CORNER)|m.CORNER,this.width=this.constants_.CORNER_RADIUS,this.height=this.constants_.CORNER_RADIUS/2}},ku=class extends ar{constructor(e,t,i){super(e),this.height=t,this.width=i,this.precedesStatement=this.followsStatement=!1,this.widthWithConnectedBlocks=0,this.type|=m.SPACER|m.BETWEEN_ROW_SPACER,this.elements=[new _t(this.constants_,i)]}measure(){}},dr=class extends oo{constructor(e,t){super(e),this.type=(t&&"left"!==t?m.RIGHT_SQUARE_CORNER:m.LEFT_SQUARE_CORNER)|m.CORNER,this.width=this.height=this.constants_.NO_PADDING}},sc=class extends ic{constructor(e,t){super(e,t),this.type|=m.STATEMENT_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight+this.constants_.STATEMENT_BOTTOM_SPACER:this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT,this.width=this.constants_.STATEMENT_INPUT_NOTCH_OFFSET+this.shape.width}},wu=class extends ar{constructor(e){super(e),this.ascenderHeight=this.capline=0,this.hasPreviousConnection=!1,this.connection=null,this.type|=m.TOP_ROW}hasLeftSquareCorner(e){const t=(e.hat?"cap"===e.hat:this.constants_.ADD_START_HATS)&&!e.outputConnection&&!e.previousConnection,i=e.getPreviousBlock();return!!e.outputConnection||t||!!i&&i.getNextBlock()===e}hasRightSquareCorner(e){return!0}measure(){let e=0,t=0,i=0;for(let s=0;s<this.elements.length;s++){const n=this.elements[s];t+=n.width,m.isSpacer(n)||(m.isHat(n)?i=Math.max(i,n.ascenderHeight):e=Math.max(e,n.height))}this.width=Math.max(this.minWidth,t),this.height=Math.max(this.minHeight,e)+i,this.capline=this.ascenderHeight=i,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return!1}endsWithElemSpacer(){return!1}},nc=class{constructor(){this.NO_PADDING=0,this.SMALL_PADDING=3,this.MEDIUM_PADDING=5,this.MEDIUM_LARGE_PADDING=8,this.LARGE_PADDING=10,this.TAB_HEIGHT=15,this.TAB_OFFSET_FROM_TOP=5,this.TAB_VERTICAL_OVERLAP=2.5,this.TAB_WIDTH=8,this.NOTCH_WIDTH=15,this.NOTCH_HEIGHT=4,this.MIN_BLOCK_WIDTH=12,this.EMPTY_BLOCK_SPACER_HEIGHT=16,this.CORNER_RADIUS=8,this.NOTCH_OFFSET_LEFT=15,this.STATEMENT_BOTTOM_SPACER=0,this.STATEMENT_INPUT_PADDING_LEFT=20,this.BETWEEN_STATEMENT_PADDING_Y=4,this.ADD_START_HATS=!1,this.START_HAT_HEIGHT=15,this.START_HAT_WIDTH=100,this.SPACER_DEFAULT_HEIGHT=15,this.MIN_BLOCK_HEIGHT=24,this.EMPTY_INLINE_INPUT_PADDING=14.5,this.EXTERNAL_VALUE_INPUT_PADDING=2,this.JAGGED_TEETH_HEIGHT=12,this.JAGGED_TEETH_WIDTH=6,this.FIELD_TEXT_FONTSIZE=11,this.FIELD_TEXT_FONTWEIGHT="normal",this.FIELD_TEXT_FONTFAMILY="sans-serif",this.FIELD_TEXT_BASELINE=this.FIELD_TEXT_HEIGHT=-1,this.FIELD_BORDER_RECT_RADIUS=4,this.FIELD_BORDER_RECT_HEIGHT=16,this.FIELD_BORDER_RECT_X_PADDING=5,this.FIELD_BORDER_RECT_Y_PADDING=3,this.FIELD_BORDER_RECT_COLOUR="#fff",this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!1,this.FIELD_DROPDOWN_SVG_ARROW_SIZE=12,this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=!1,this.FIELD_COLOUR_DEFAULT_WIDTH=26,this.defs=null,this.embossFilterId="",this.embossFilter=null,this.disabledPatternId="",this.disabledPattern=null,this.debugFilterId="",this.cssNode=this.debugFilter=null,this.CURSOR_COLOUR="#cc0a0a",this.MARKER_COLOUR="#4286f4",this.CURSOR_WS_WIDTH=100,this.WS_CURSOR_HEIGHT=5,this.CURSOR_STACK_PADDING=10,this.CURSOR_BLOCK_PADDING=2,this.CURSOR_STROKE_WIDTH=4,this.FULL_BLOCK_FIELDS=!1,this.INSERTION_MARKER_COLOUR="#000000",this.INSERTION_MARKER_OPACITY=.2,this.SHAPES={PUZZLE:1,NOTCH:2},this.TALL_INPUT_FIELD_OFFSET_Y=this.MEDIUM_PADDING,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=this.DUMMY_INPUT_MIN_HEIGHT=this.TAB_HEIGHT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT,this.TOP_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.EMPTY_INLINE_INPUT_HEIGHT=this.TAB_HEIGHT+11,this.EMPTY_STATEMENT_INPUT_HEIGHT=this.MIN_BLOCK_HEIGHT,this.START_POINT=ae(0,0),this.FIELD_TEXT_BASELINE_CENTER=!0,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_DROPDOWN_SVG_ARROW_DATAURI="data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMi43MSIgaGVpZ2h0PSI4Ljc5IiB2aWV3Qm94PSIwIDAgMTIuNzEgOC43OSI+PHRpdGxlPmRyb3Bkb3duLWFycm93PC90aXRsZT48ZyBvcGFjaXR5PSIwLjEiPjxwYXRoIGQ9Ik0xMi43MSwyLjQ0QTIuNDEsMi40MSwwLDAsMSwxMiw0LjE2TDguMDgsOC4wOGEyLjQ1LDIuNDUsMCwwLDEtMy40NSwwTDAuNzIsNC4xNkEyLjQyLDIuNDIsMCwwLDEsMCwyLjQ0LDIuNDgsMi40OCwwLDAsMSwuNzEuNzFDMSwwLjQ3LDEuNDMsMCw2LjM2LDBTMTEuNzUsMC40NiwxMiwuNzFBMi40NCwyLjQ0LDAsMCwxLDEyLjcxLDIuNDRaIiBmaWxsPSIjMjMxZjIwIi8+PC9nPjxwYXRoIGQ9Ik02LjM2LDcuNzlhMS40MywxLjQzLDAsMCwxLTEtLjQyTDEuNDIsMy40NWExLjQ0LDEuNDQsMCwwLDEsMC0yYzAuNTYtLjU2LDkuMzEtMC41Niw5Ljg3LDBhMS40NCwxLjQ0LDAsMCwxLDAsMkw3LjM3LDcuMzdBMS40MywxLjQzLDAsMCwxLDYuMzYsNy43OVoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=",this.FIELD_COLOUR_DEFAULT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_CHECKBOX_X_OFFSET=this.FIELD_BORDER_RECT_X_PADDING-3,this.randomIdentifier=String(Math.random()).substring(2)}init(){this.JAGGED_TEETH=this.makeJaggedTeeth(),this.NOTCH=this.makeNotch(),this.START_HAT=this.makeStartHat(),this.PUZZLE_TAB=this.makePuzzleTab(),this.INSIDE_CORNERS=this.makeInsideCorners(),this.OUTSIDE_CORNERS=this.makeOutsideCorners()}setTheme(e){this.blockStyles=Object.create(null);const t=e.blockStyles;for(const i in t)this.blockStyles[i]=this.validatedBlockStyle_(t[i]);this.setDynamicProperties_(e)}setDynamicProperties_(e){this.setFontConstants_(e),this.setComponentConstants_(e),this.ADD_START_HATS=void 0!==e.startHats?e.startHats:this.ADD_START_HATS}setFontConstants_(e){e.fontStyle&&e.fontStyle.family&&(this.FIELD_TEXT_FONTFAMILY=e.fontStyle.family),e.fontStyle&&e.fontStyle.weight&&(this.FIELD_TEXT_FONTWEIGHT=e.fontStyle.weight),e.fontStyle&&e.fontStyle.size&&(this.FIELD_TEXT_FONTSIZE=e.fontStyle.size),e=pn("Hg",this.FIELD_TEXT_FONTSIZE+"pt",this.FIELD_TEXT_FONTWEIGHT,this.FIELD_TEXT_FONTFAMILY),this.FIELD_TEXT_HEIGHT=e.height,this.FIELD_TEXT_BASELINE=e.baseline}setComponentConstants_(e){this.CURSOR_COLOUR=e.getComponentStyle("cursorColour")||this.CURSOR_COLOUR,this.MARKER_COLOUR=e.getComponentStyle("markerColour")||this.MARKER_COLOUR,this.INSERTION_MARKER_COLOUR=e.getComponentStyle("insertionMarkerColour")||this.INSERTION_MARKER_COLOUR,this.INSERTION_MARKER_OPACITY=Number(e.getComponentStyle("insertionMarkerOpacity"))||this.INSERTION_MARKER_OPACITY}getBlockStyleForColour(e){const t="auto_"+e;return this.blockStyles[t]||(this.blockStyles[t]=this.createBlockStyle_(e)),{style:this.blockStyles[t],name:t}}getBlockStyle(e){return this.blockStyles[e||""]||(e&&e.startsWith("auto_")?this.getBlockStyleForColour(e.substring(5)).style:this.createBlockStyle_("#000000"))}createBlockStyle_(e){return this.validatedBlockStyle_({colourPrimary:e})}validatedBlockStyle_(e){const t={};return e&&Object.assign(t,e),e=bi(t.colourPrimary||"#000"),t.colourPrimary=e.hex,t.colourSecondary=t.colourSecondary?bi(t.colourSecondary).hex:this.generateSecondaryColour_(t.colourPrimary),t.colourTertiary=t.colourTertiary?bi(t.colourTertiary).hex:this.generateTertiaryColour_(t.colourPrimary),t.hat=t.hat||"",t}generateSecondaryColour_(e){return Mo("#fff",e,.6)||e}generateTertiaryColour_(e){return Mo("#fff",e,.3)||e}dispose(){this.embossFilter&&Q(this.embossFilter),this.disabledPattern&&Q(this.disabledPattern),this.debugFilter&&Q(this.debugFilter),this.cssNode=null}makeJaggedTeeth(){const e=this.JAGGED_TEETH_HEIGHT,t=this.JAGGED_TEETH_WIDTH;return{height:e,width:t,path:Po([L(t,e/4),L(2*-t,e/2),L(t,e/4)])}}makeStartHat(){const e=this.START_HAT_HEIGHT,t=this.START_HAT_WIDTH;return{height:.75*e,width:t,path:Ne("c",[L(30,-e),L(70,-e),L(t,0)])}}makePuzzleTab(){function e(l){const u=-(l=l?-1:1);var $=i/2;const C=$+2.5,F=$+.5,_e=L(-t,l*$);return $=L(t,l*$),Ne("c",[L(0,l*C),L(-t,u*F),_e])+Ne("s",[L(t,2.5*u),$])}const t=this.TAB_WIDTH,i=this.TAB_HEIGHT,s=e(!0),n=e(!1);return{type:this.SHAPES.PUZZLE,width:t,height:i,pathDown:n,pathUp:s}}makeNotch(){function e(u){return Po([L(u*s,i),L(3*u,0),L(u*s,-i)])}const t=this.NOTCH_WIDTH,i=this.NOTCH_HEIGHT,s=(t-3)/2,n=e(1),l=e(-1);return{type:this.SHAPES.NOTCH,width:t,height:i,pathLeft:n,pathRight:l}}makeInsideCorners(){const e=this.CORNER_RADIUS;return{width:e,height:e,pathTop:pe("a","0 0,0",e,L(-e,e)),pathBottom:pe("a","0 0,0",e,L(e,e))}}makeOutsideCorners(){const e=this.CORNER_RADIUS,t=ae(0,e)+pe("a","0 0,1",e,L(e,-e)),i=pe("a","0 0,1",e,L(e,e)),s=pe("a","0 0,1",e,L(-e,-e));return{topLeft:t,topRight:i,bottomRight:pe("a","0 0,1",e,L(-e,e)),bottomLeft:s,rightHeight:e}}shapeFor(e){switch(e.type){case M.INPUT_VALUE:case M.OUTPUT_VALUE:return this.PUZZLE_TAB;case M.PREVIOUS_STATEMENT:case M.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown connection type")}}createDom(e,t,i,s){this.injectCSS_(t,i),this.defs=I(T.DEFS,{},e),e=I(T.FILTER,{id:"blocklyEmbossFilter"+this.randomIdentifier},this.defs),I(T.FEGAUSSIANBLUR,{in:"SourceAlpha",stdDeviation:1,result:"blur"},e),t=I(T.FESPECULARLIGHTING,{in:"blur",surfaceScale:1,specularConstant:.5,specularExponent:10,"lighting-color":"white",result:"specOut"},e),I(T.FEPOINTLIGHT,{x:-5e3,y:-1e4,z:2e4},t),I(T.FECOMPOSITE,{in:"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"},e),I(T.FECOMPOSITE,{in:"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:0,k2:1,k3:1,k4:0},e),this.embossFilterId=e.id,this.embossFilter=e,e=I(T.PATTERN,{id:"blocklyDisabledPattern"+this.randomIdentifier,patternUnits:"userSpaceOnUse",width:10,height:10},this.defs),I(T.RECT,{width:10,height:10,fill:"#aaa"},e),I(T.PATH,{d:"M 0 0 L 10 10 M 10 0 L 0 10",stroke:"#cc0"},e),this.disabledPatternId=e.id,this.disabledPattern=e,this.createDebugFilter(),s&&(s.style.setProperty("--blocklyEmbossFilter",`url(#${this.embossFilterId})`),s.style.setProperty("--blocklyDisabledPattern",`url(#${this.disabledPatternId})`),s.style.setProperty("--blocklyDebugFilter",`url(#${this.debugFilterId})`))}createDebugFilter(){if(!this.debugFilter){const e=I(T.FILTER,{id:"blocklyDebugFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},this.defs),t=I(T.FECOMPONENTTRANSFER,{result:"outBlur"},e);I(T.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},t),I(T.FEFLOOD,{"flood-color":"#ff0000","flood-opacity":.5,result:"outColor"},e),I(T.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},e),this.debugFilterId=e.id,this.debugFilter=e}}injectCSS_(e,t){t=this.getCSS_(t),e="blockly-renderer-style-"+e,this.cssNode=document.getElementById(e);const i=t.join("\n");this.cssNode?this.cssNode.firstChild.textContent=i:((t=document.createElement("style")).id=e,e=document.createTextNode(i),t.appendChild(e),document.head.insertBefore(t,document.head.firstChild),this.cssNode=t)}getCSS_(e){return[`${e} .blocklyText, `,`${e} .blocklyFlyoutLabelText {`,`font: ${this.FIELD_TEXT_FONTWEIGHT} ${this.FIELD_TEXT_FONTSIZE}pt ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${e} .blocklyText {`,"fill: #fff;","}",`${e} .blocklyNonEditableField>rect,`,`${e} .blocklyEditableField>rect {`,`fill: ${this.FIELD_BORDER_RECT_COLOUR};`,"fill-opacity: .6;","stroke: none;","}",`${e} .blocklyNonEditableField>text,`,`${e} .blocklyEditableField>text {`,"fill: #000;","}",`${e} .blocklyFlyoutLabelText {`,"fill: #000;","}",`${e} .blocklyText.blocklyBubbleText {`,"fill: #000;","}",`${e} .blocklyEditableField:not(.blocklyEditing):hover>rect {`,"stroke: #fff;","stroke-width: 2;","}",`${e} .blocklyHtmlInput {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,`font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,"}",`${e} .blocklySelected>.blocklyPath {`,"stroke: #fc3;","stroke-width: 3px;","}",`${e} .blocklyHighlightedConnectionPath {`,"stroke: #fc3;","}",`${e} .blocklyReplaceable .blocklyPath {`,"fill-opacity: .5;","}",`${e} .blocklyReplaceable .blocklyPathLight,`,`${e} .blocklyReplaceable .blocklyPathDark {`,"display: none;","}",`${e} .blocklyInsertionMarker>.blocklyPath {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"]}},Su={};Su.ConstantProvider=nc,Su.isDynamicShape=Rs,Su.isNotch=qn,Su.isPuzzleTab=Wn;var rc=class{constructor(e,t){this.inlinePath_=this.outlinePath_="",this.block_=e,this.info_=t,this.topLeft_=e.getRelativeToSurfaceXY(),this.constants_=t.getRenderer().getConstants()}draw(){this.drawOutline_(),this.drawInternals_(),this.updateConnectionHighlights(),this.block_.pathObject.setPath(this.outlinePath_+"\n"+this.inlinePath_),this.info_.RTL&&this.block_.pathObject.flipRTL(),this.recordSizeOnBlock_()}recordSizeOnBlock_(){this.block_.height=this.info_.height,this.block_.width=this.info_.widthWithChildren,this.block_.childlessWidth=this.info_.width}drawOutline_(){this.drawTop_();for(let e=1;e<this.info_.rows.length-1;e++){const t=this.info_.rows[e];t.hasJaggedEdge?this.drawJaggedEdge_(t):t.hasStatement?this.drawStatementInput_(t):t.hasExternalInput?this.drawValueInput_(t):this.drawRightSideRow_(t)}this.drawBottom_(),this.drawLeft_()}drawTop_(){const e=this.info_.topRow,t=e.elements;this.positionPreviousConnection_(),this.outlinePath_+=ae(e.xPos,this.info_.startY);for(let s,i=0;s=t[i];i++)m.isLeftRoundedCorner(s)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topLeft:m.isRightRoundedCorner(s)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topRight:m.isPreviousConnection(s)?this.outlinePath_+=s.shape.pathLeft:m.isHat(s)?this.outlinePath_+=this.constants_.START_HAT.path:m.isSpacer(s)&&(this.outlinePath_+=B("h",s.width));this.outlinePath_+=B("v",e.height)}drawJaggedEdge_(e){this.outlinePath_+=this.constants_.JAGGED_TEETH.path+B("v",e.height-this.constants_.JAGGED_TEETH.height)}drawValueInput_(e){const t=e.getLastInput();this.positionExternalValueConnection_(e);const i=Rs(t.shape)?t.shape.pathDown(t.height):t.shape.pathDown;this.outlinePath_+=B("H",t.xPos+t.width)+i+B("v",e.height-t.connectionHeight)}drawStatementInput_(e){var t=e.getLastInput();if(t){var i=t.xPos+t.notchOffset+t.shape.width;t=t.shape.pathRight+B("h",-(t.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop;var s=e.height-2*this.constants_.INSIDE_CORNERS.height;this.outlinePath_+=B("H",i)+t+B("v",s)+this.constants_.INSIDE_CORNERS.pathBottom+B("H",e.xPos+e.width),this.positionStatementInputConnection_(e)}}drawRightSideRow_(e){this.outlinePath_+=B("V",e.yPos+e.height)}drawBottom_(){const e=this.info_.bottomRow,t=e.elements;this.positionNextConnection_();let i=0,s="";for(let l,n=t.length-1;l=t[n];n--)m.isNextConnection(l)?s+=l.shape.pathRight:m.isLeftSquareCorner(l)?s+=B("H",e.xPos):m.isLeftRoundedCorner(l)?s+=this.constants_.OUTSIDE_CORNERS.bottomLeft:m.isRightRoundedCorner(l)?(s+=this.constants_.OUTSIDE_CORNERS.bottomRight,i=this.constants_.OUTSIDE_CORNERS.rightHeight):m.isSpacer(l)&&(s+=B("h",-1*l.width));this.outlinePath_+=B("V",e.baseline-i),this.outlinePath_+=s}drawLeft_(){var e=this.info_.outputConnection;if(this.positionOutputConnection_(),e){const t=e.connectionOffsetY+e.height;e=Rs(e.shape)?e.shape.pathUp(e.height):e.shape.pathUp,this.outlinePath_+=B("V",t)+e}this.outlinePath_+="z"}drawInternals_(){for(let t,e=0;t=this.info_.rows[e];e++)for(let s,i=0;s=t.elements[i];i++)m.isInlineInput(s)?this.drawInlineInput_(s):(m.isIcon(s)||m.isField(s))&&this.layoutField_(s)}layoutField_(e){const t=e.centerline-e.height/2;let i=e.xPos;var s="";this.info_.RTL&&(i=-(i+e.width),e.flipRtl&&(i+=e.width,s="scale(-1 1)")),m.isIcon(e)?((s=e.icon).setOffsetInBlock(new k(i,t)),this.info_.isInsertionMarker&&s.hideForInsertionMarker()):((e=e.field.getSvgRoot()).setAttribute("transform","translate("+i+","+t+")"+s),this.info_.isInsertionMarker&&e.setAttribute("display","none"))}drawInlineInput_(e){const t=e.width,i=e.height,s=e.connectionOffsetY,n=e.connectionHeight+s;this.inlinePath_+=Ie(e.xPos+e.connectionWidth,e.centerline-i/2)+B("v",s)+e.shape.pathDown+B("v",i-n)+B("h",t-e.connectionWidth)+B("v",-i)+"z",this.positionInlineInputConnection_(e)}positionInlineInputConnection_(e){if(e.connectionModel){let i=e.xPos+e.connectionWidth+e.connectionOffsetX;this.info_.RTL&&(i*=-1),e.connectionModel.setOffsetInBlock(i,e.centerline-e.height/2+e.connectionOffsetY)}}positionStatementInputConnection_(e){const t=e.getLastInput();if(null!=t&&t.connectionModel){let i=e.xPos+e.statementEdge+t.notchOffset;this.info_.RTL&&(i*=-1),t.connectionModel.setOffsetInBlock(i,e.yPos)}}positionExternalValueConnection_(e){const t=e.getLastInput();if(t&&t.connectionModel){let i=e.xPos+e.width;this.info_.RTL&&(i*=-1),t.connectionModel.setOffsetInBlock(i,e.yPos)}}positionPreviousConnection_(){const e=this.info_.topRow;if(e.connection){const t=e.xPos+e.notchOffset;e.connection.connectionModel.setOffsetInBlock(this.info_.RTL?-t:t,0)}}positionNextConnection_(){const e=this.info_.bottomRow;if(e.connection){const t=e.connection,i=t.xPos;t.connectionModel.setOffsetInBlock(this.info_.RTL?-i:i,e.baseline)}}positionOutputConnection_(){if(this.info_.outputConnection){const e=this.info_.startX+this.info_.outputConnection.connectionOffsetX;this.block_.outputConnection.setOffsetInBlock(this.info_.RTL?-e:e,this.info_.outputConnection.connectionOffsetY)}}updateConnectionHighlights(){for(const e of this.info_.rows)for(const t of e.elements){if(!(t instanceof Wi))continue;const i=this.drawConnectionHighlightPath(t);i&&(i.style.display=t.highlighted?"":"none")}}drawConnectionHighlightPath(e){const t=e.connectionModel;e=t.type===M.INPUT_VALUE||t.type===M.OUTPUT_VALUE?this.getExpressionConnectionHighlightPath(e):this.getStatementConnectionHighlightPath(e);const i=t.getSourceBlock();let s,n;return null==(n=(s=i.pathObject).addConnectionHighlight)?void 0:n.call(s,t,e,t.getOffsetInBlock(),i.RTL)}getExpressionConnectionHighlightPath(e){let t="";return Rs(e.shape)?t=e.shape.pathDown(e.height):Wn(e.shape)&&(t=e.shape.pathDown),ae(0,-(e=this.constants_.TAB_OFFSET_FROM_TOP))+B("v",e)+t+B("v",e)}getStatementConnectionHighlightPath(e){if(!qn(e.shape))throw Error("Statement connections should have notch shapes");const t=this.constants_.NOTCH_OFFSET_LEFT-this.constants_.CORNER_RADIUS;return ae(-t,0)+B("h",t)+e.shape.pathLeft+B("h",t)}},hr=class{constructor(e,t){this.statementEdge=this.width=this.widthWithChildren=this.height=0,this.rows=[],this.inputRows=[],this.startY=this.startX=0,this.renderer_=e,this.block_=t,this.constants_=this.renderer_.getConstants(),this.outputConnection=t.outputConnection?new eg(this.constants_,t.outputConnection):null,this.isInline=t.getInputsInline()&&!t.isCollapsed(),this.isCollapsed=t.isCollapsed(),this.isInsertionMarker=t.isInsertionMarker(),this.RTL=t.RTL,this.topRow=new wu(this.constants_),this.bottomRow=new vu(this.constants_)}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}createRows_(){this.populateTopRow_(),this.rows.push(this.topRow);let e=new xu(this.constants_);this.inputRows.push(e);var t=this.block_.getIcons();for(let s,i=0;s=t[i];i++){const n=new Kp(this.constants_,s);this.isCollapsed&&!s.isShownWhenCollapsed()||e.elements.push(n)}t=void 0;for(let s,i=0;s=this.block_.inputList[i];i++)if(s.isVisible()){this.shouldStartNewRow_(s,t)&&(this.rows.push(e),e=new xu(this.constants_),this.inputRows.push(e));for(let l,n=0;l=s.fieldRow[n];n++)e.elements.push(new Cu(this.constants_,l,s));this.addInput_(s,e),t=s}this.isCollapsed&&(e.hasJaggedEdge=!0,e.elements.push(new Jp(this.constants_))),(e.elements.length||e.hasDummyInput)&&this.rows.push(e),this.populateBottomRow_(),this.rows.push(this.bottomRow)}populateTopRow_(){var e=!!this.block_.previousConnection;const t=(this.block_.hat?"cap"===this.block_.hat:this.constants_.ADD_START_HATS)&&!this.outputConnection&&!e;let i=this.topRow.hasLeftSquareCorner(this.block_)?dr:ur;this.topRow.elements.push(new i(this.constants_)),t?(e=new Xp(this.constants_),this.topRow.elements.push(e)):e&&(this.topRow.hasPreviousConnection=!0,this.topRow.connection=new tg(this.constants_,this.block_.previousConnection),this.topRow.elements.push(this.topRow.connection)),this.topRow.minHeight=this.block_.inputList.length&&this.block_.inputList[0]instanceof mt&&!this.block_.isCollapsed()?this.constants_.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT:this.constants_.TOP_ROW_MIN_HEIGHT,i=this.topRow.hasRightSquareCorner(this.block_)?dr:ur,this.topRow.elements.push(new i(this.constants_,"right"))}populateBottomRow_(){this.bottomRow.hasNextConnection=!!this.block_.nextConnection,this.bottomRow.minHeight=this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1]instanceof mt?this.constants_.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT:this.constants_.BOTTOM_ROW_MIN_HEIGHT,this.bottomRow.hasLeftSquareCorner(this.block_)?this.bottomRow.elements.push(new dr(this.constants_)):this.bottomRow.elements.push(new ur(this.constants_)),this.bottomRow.hasNextConnection&&(this.bottomRow.connection=new Qp(this.constants_,this.block_.nextConnection),this.bottomRow.elements.push(this.bottomRow.connection)),this.bottomRow.hasRightSquareCorner(this.block_)?this.bottomRow.elements.push(new dr(this.constants_,"right")):this.bottomRow.elements.push(new ur(this.constants_,"right"))}addInput_(e,t){this.isInline&&e instanceof o.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new Iu(this.constants_,e)),t.hasInlineInput=!0):e instanceof mt?(t.elements.push(new sc(this.constants_,e)),t.hasStatement=!0):e instanceof o.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new yu(this.constants_,e)),t.hasExternalInput=!0):(e instanceof eo||e instanceof mo)&&(t.minHeight=Math.max(t.minHeight,e.getSourceBlock()&&e.getSourceBlock().isShadow()?this.constants_.DUMMY_INPUT_SHADOW_MIN_HEIGHT:this.constants_.DUMMY_INPUT_MIN_HEIGHT),t.hasDummyInput=!0),null===t.align&&(t.align=e.align)}shouldStartNewRow_(e,t){return!!t&&(t instanceof mo||e instanceof mt||t instanceof mt||(e instanceof o.ValueInput$$module$build$src$core$inputs$value_input||e instanceof eo||t instanceof o.ValueInput$$module$build$src$core$inputs$value_input)&&!this.isInline)}addElemSpacing_(){for(let t,e=0;t=this.rows[e];e++){const i=t.elements;if(t.elements=[],t.startsWithElemSpacer()&&t.elements.push(new _t(this.constants_,this.getInRowSpacing_(null,i[0]))),i.length){for(let s=0;s<i.length-1;s++){t.elements.push(i[s]);const n=this.getInRowSpacing_(i[s],i[s+1]);t.elements.push(new _t(this.constants_,n))}t.elements.push(i[i.length-1]),t.endsWithElemSpacer()&&t.elements.push(new _t(this.constants_,this.getInRowSpacing_(i[i.length-1],null)))}}}getInRowSpacing_(e,t){if(!e&&t&&m.isStatementInput(t))return this.constants_.STATEMENT_INPUT_PADDING_LEFT;if(e&&m.isInput(e)&&!t){if(m.isExternalInput(e))return this.constants_.NO_PADDING;if(m.isInlineInput(e))return this.constants_.LARGE_PADDING;if(m.isStatementInput(e))return this.constants_.NO_PADDING}return e&&m.isLeftSquareCorner(e)&&t&&(m.isPreviousConnection(t)||m.isNextConnection(t))?t.notchOffset:e&&m.isLeftRoundedCorner(e)&&t&&(m.isPreviousConnection(t)||m.isNextConnection(t))?t.notchOffset-this.constants_.CORNER_RADIUS:e&&m.isField(e)&&0===e.width?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING}computeBounds_(){let e=0,t=0,i=0;for(let l,n=0;l=this.rows[n];n++){if(l.measure(),t=Math.max(t,l.width),l.hasStatement){var s=l.getLastInput();let u,$;s=l.width-(null!=($=null==(u=s)?void 0:u.width)?$:0),e=Math.max(e,s)}i=Math.max(i,l.widthWithConnectedBlocks)}this.statementEdge=e,this.width=t;for(let l,n=0;l=this.rows[n];n++)l.hasStatement&&(l.statementEdge=this.statementEdge);this.widthWithChildren=Math.max(t,i),this.outputConnection&&(this.startX=this.outputConnection.width,this.width+=this.outputConnection.width,this.widthWithChildren+=this.outputConnection.width)}alignRowElements_(){for(let i,t=0;i=this.rows[t];t++)if(i.hasStatement)this.alignStatementRow_(i);else{var e=i.width;(e=this.getDesiredRowWidth_(i)-e)>0&&this.addAlignmentPadding_(i,e),m.isTopOrBottomRow(i)&&(i.widthWithConnectedBlocks=i.width)}}getDesiredRowWidth_(e){return this.width-this.startX}addAlignmentPadding_(e,t){const i=e.getFirstSpacer(),s=e.getLastSpacer();if((e.hasExternalInput||e.hasStatement)&&(e.widthWithConnectedBlocks+=t),e.align===o.Align$$module$build$src$core$inputs$align.LEFT&&s)s.width+=t;else if(e.align===o.Align$$module$build$src$core$inputs$align.CENTRE&&i&&s)i.width+=t/2,s.width+=t/2;else if(e.align===o.Align$$module$build$src$core$inputs$align.RIGHT&&i)i.width+=t;else{if(!s)return;s.width+=t}e.width+=t}alignStatementRow_(e){const t=e.getLastInput();if(t){var i=e.width-t.width,s=this.statementEdge;(i=s-i)>0&&this.addAlignmentPadding_(e,i),i=e.width,s=this.getDesiredRowWidth_(e),t.width+=s-i,t.height=Math.max(t.height,e.height),e.width+=s-i,e.widthWithConnectedBlocks=Math.max(e.width,this.statementEdge+e.connectedBlockWidths)}}addRowSpacing_(){const e=this.rows;this.rows=[];for(let t=0;t<e.length;t++)this.rows.push(e[t]),t!==e.length-1&&this.rows.push(this.makeSpacerRow_(e[t],e[t+1]))}makeSpacerRow_(e,t){var i=this.getSpacerRowHeight_(e,t);const s=this.getSpacerRowWidth_(e,t);return i=new ku(this.constants_,i,s),e.hasStatement&&(i.followsStatement=!0),t.hasStatement&&(i.precedesStatement=!0),i}getSpacerRowWidth_(e,t){return this.width-this.startX}getSpacerRowHeight_(e,t){return this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){return m.isSpacer(t)?e.yPos+t.height/2:m.isBottomRow(e)?(e=e.yPos+e.height-e.descenderHeight,m.isNextConnection(t)?e+t.height/2:e-t.height/2):m.isTopRow(e)?m.isHat(t)?e.capline-t.height/2:e.capline+t.height/2:e.yPos+e.height/2}recordElemPositions_(e){let t=e.xPos;for(let s,i=0;s=e.elements[i];i++)m.isSpacer(s)&&(s.height=e.height),s.xPos=t,s.centerline=this.getElemCenterline_(e,s),t+=s.width}finalize_(){let e=0,t=0;for(let s,i=0;s=this.rows[i];i++)s.yPos=t,s.xPos=this.startX,t+=s.height,e=Math.max(e,s.widthWithConnectedBlocks),this.recordElemPositions_(s);if(this.outputConnection&&this.block_.nextConnection){const i=this.block_.nextConnection.targetBlock();i&&(e=Math.max(e,i.getHeightWidth().width))}this.widthWithChildren=e+this.startX,this.height=t,this.startY=this.topRow.capline,this.bottomRow.baseline=t-this.bottomRow.descenderHeight}getMeasureableForConnection(e){let t;if((null==(t=this.outputConnection)?void 0:t.connectionModel)===e)return this.outputConnection;for(const i of this.rows)for(const s of i.elements)if(s instanceof Wi&&s.connectionModel===e)return s;return null}},lc=class{constructor(e,t,i){this.connectionHighlights=new WeakMap,this.highlightOffsets=new WeakMap,this.constants=i,this.style=t,this.svgRoot=e,this.svgPath=I(T.PATH,{class:"blocklyPath"},this.svgRoot),this.setClass_("blocklyBlock",!0)}setPath(e){this.svgPath.setAttribute("d",e)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)")}applyColour(e){this.svgPath.setAttribute("stroke",this.style.colourTertiary),this.svgPath.setAttribute("fill",this.style.colourPrimary),this.updateShadow_(e.isShadow()),this.updateDisabled_(!e.isEnabled()||e.getInheritedDisabled())}setStyle(e){this.style=e}setClass_(e,t){e&&(t?R(this.svgRoot,e):X(this.svgRoot,e))}updateHighlighted(e){this.setClass_("blocklyHighlighted",!!e)}updateShadow_(e){e?(this.setClass_("blocklyShadow",!0),this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary)):this.setClass_("blocklyShadow",!1)}updateDisabled_(e){this.setClass_("blocklyDisabled",e),this.setClass_("blocklyDisabledPattern",e)}updateSelected(e){this.setClass_("blocklySelected",e)}updateDraggingDelete(e){this.setClass_("blocklyDraggingDelete",e)}updateInsertionMarker(e){this.setClass_("blocklyInsertionMarker",e)}updateMovable(e){this.setClass_("blocklyDraggable",e)}updateReplacementFade(e){this.setClass_("blocklyReplaceable",e)}updateShapeForInputHighlight(e,t){}addConnectionHighlight(e,t,i,s){return i=`translate(${i.x}, ${i.y})`+(s?" scale(-1 1)":""),(s=this.connectionHighlights.get(e))?(s.setAttribute("d",t),s.setAttribute("transform",i),s):(t=I(T.PATH,{id:e.id,class:"blocklyHighlightedConnectionPath",style:"display: none;",d:t,transform:i},this.svgRoot),this.connectionHighlights.set(e,t),t)}removeConnectionHighlight(e){const t=this.connectionHighlights.get(e);t&&(Q(t),this.connectionHighlights.delete(e))}},cc=class{constructor(e){this.overrides=null,this.name=e}getClassName(){return this.name+"-renderer"}init(e,t){this.constants_=this.makeConstants_(),t&&(this.overrides=t,Object.assign(this.constants_,t)),this.constants_.setTheme(e),this.constants_.init()}createDom(e,t,i){this.constants_.createDom(e,this.name+"-"+t.name,"."+this.getClassName()+"."+t.getClassName(),i)}refreshDom(e,t,i){const s=this.getConstants();s.dispose(),this.constants_=this.makeConstants_(),this.overrides&&Object.assign(this.constants_,this.overrides),this.constants_.randomIdentifier=s.randomIdentifier,this.constants_.setTheme(t),this.constants_.init(),this.createDom(e,t,i)}dispose(){this.constants_&&this.constants_.dispose()}makeConstants_(){return new nc}makeRenderInfo_(e){return new hr(this,e)}makeDrawer_(e,t){return new rc(e,t)}makePathObject(e,t){return new lc(e,t,this.constants_)}getConstants(){return this.constants_}shouldHighlightConnection(e){return!0}orphanCanConnectAtEnd(e,t,i){return!!K.getConnectionForOrphanedConnection(e,i===M.OUTPUT_VALUE?t.outputConnection:t.previousConnection)}render(e){const t=this.makeRenderInfo_(e);t.measure(),this.makeDrawer_(e,t).draw()}},oe={};oe.BottomRow=vu,oe.Connection=Wi,oe.ConstantProvider=nc,oe.Drawer=rc,oe.ExternalValueInput=yu,oe.Field=Cu,oe.Hat=Xp,oe.Icon=Kp,oe.InRowSpacer=_t,oe.InlineInput=Iu,oe.InputConnection=ic,oe.InputRow=xu,oe.JaggedEdge=Jp,oe.Measurable=oo,oe.NextConnection=Qp,oe.OutputConnection=eg,oe.PathObject=lc,oe.PreviousConnection=tg,oe.RenderInfo=hr,oe.Renderer=cc,oe.RoundCorner=ur,oe.Row=ar,oe.SpacerRow=ku,oe.SquareCorner=dr,oe.StatementInput=sc,oe.TopRow=wu,oe.Types=m,oe.init=zn,oe.register=Os,oe.unregister=vl;var og=class{constructor(e,t){this.workspace=e,this.theme=t,this.subscribedWorkspaces=[],this.componentDB=new Map}getTheme(){return this.theme}setTheme(e){var t=this.theme;this.theme=e,(e=this.workspace.getInjectionDiv())&&(t&&(t=t.getClassName())&&X(e,t),(t=this.theme.getClassName())&&R(e,t));for(let s,i=0;s=this.subscribedWorkspaces[i];i++)s.refreshTheme();for(const[i,s]of this.componentDB)for(const n of s){e=n.element,t=n.propertyName;const l=this.theme&&this.theme.getComponentStyle(i);e.style.setProperty(t,l||"")}for(const i of this.subscribedWorkspaces)i.hideChaff()}subscribeWorkspace(e){this.subscribedWorkspaces.push(e)}unsubscribeWorkspace(e){if(!ht(this.subscribedWorkspaces,e))throw Error("Cannot unsubscribe a workspace that hasn't been subscribed.")}subscribe(e,t,i){this.componentDB.has(t)||this.componentDB.set(t,[]),this.componentDB.get(t).push({element:e,propertyName:i}),t=this.theme&&this.theme.getComponentStyle(t),e.style.setProperty(i,t||"")}unsubscribe(e){if(e)for(const[t,i]of this.componentDB){for(let s=i.length-1;s>=0;s--)i[s].element===e&&i.splice(s,1);i.length||this.componentDB.delete(t)}}dispose(){this.subscribedWorkspaces.length=0,this.componentDB.clear()}},Au="VARIABLE_DYNAMIC",qi={CATEGORY_NAME:Au};qi.flyoutCategory=Z,qi.flyoutCategoryBlocks=Ue,qi.internalFlyoutCategory=jn,qi.onCreateVariableButtonClick_Colour=Ri,qi.onCreateVariableButtonClick_Number=Ai,qi.onCreateVariableButtonClick_String=Ms;var ig=class{canConnect(e,t,i,s){return this.canConnectWithReason(e,t,i,s)===K.CAN_CONNECT}canConnectWithReason(e,t,i,s){const n=this.doSafetyChecks(e,t);return n!==K.CAN_CONNECT?n:this.doTypeChecks(e,t)?i&&!this.doDragChecks(e,t,s||0)?K.REASON_DRAG_CHECKS_FAILED:K.CAN_CONNECT:K.REASON_CHECKS_FAILED}getErrorMessage(e,t,i){switch(e){case K.REASON_SELF_CONNECTION:return"Attempted to connect a block to itself.";case K.REASON_DIFFERENT_WORKSPACES:return"Blocks not on same workspace.";case K.REASON_WRONG_TYPE:return"Attempt to connect incompatible types.";case K.REASON_TARGET_NULL:return"Target connection is null.";case K.REASON_CHECKS_FAILED:return"Connection checks failed. "+t+" expected "+t.getCheck()+", found "+i.getCheck();case K.REASON_SHADOW_PARENT:return"Connecting non-shadow to shadow block.";case K.REASON_DRAG_CHECKS_FAILED:return"Drag checks failed.";case K.REASON_PREVIOUS_AND_OUTPUT:return"Block would have an output and a previous connection.";default:return"Unknown connection failure: this should never happen!"}}doSafetyChecks(e,t){if(!e||!t)return K.REASON_TARGET_NULL;let i,s,n;return e.isSuperior()?(i=e.getSourceBlock(),s=t.getSourceBlock(),n=t):(s=e.getSourceBlock(),i=t.getSourceBlock(),n=e,e=t),i===s?K.REASON_SELF_CONNECTION:n.type!==zo[e.type]?K.REASON_WRONG_TYPE:i.workspace!==s.workspace?K.REASON_DIFFERENT_WORKSPACES:i.isShadow()&&!s.isShadow()?K.REASON_SHADOW_PARENT:n.type===M.OUTPUT_VALUE&&s.previousConnection&&s.previousConnection.isConnected()||n.type===M.PREVIOUS_STATEMENT&&s.outputConnection&&s.outputConnection.isConnected()?K.REASON_PREVIOUS_AND_OUTPUT:K.CAN_CONNECT}doTypeChecks(e,t){if(e=e.getCheck(),t=t.getCheck(),!e||!t)return!0;for(let i=0;i<e.length;i++)if(t.includes(e[i]))return!0;return!1}doDragChecks(e,t,i){if(e.distanceFrom(t)>i||t.getSourceBlock().isInsertionMarker())return!1;switch(t.type){case M.PREVIOUS_STATEMENT:return this.canConnectToPrevious_(e,t);case M.OUTPUT_VALUE:if(t.isConnected()&&!t.targetBlock().isInsertionMarker()||e.isConnected())return!1;break;case M.INPUT_VALUE:if(t.isConnected()&&!t.targetBlock().isMovable()&&!t.targetBlock().isShadow())return!1;break;case M.NEXT_STATEMENT:if(t.isConnected()&&!e.getSourceBlock().nextConnection&&!t.targetBlock().isShadow()&&t.targetBlock().nextConnection||t.targetBlock()&&!t.targetBlock().isMovable()&&!t.targetBlock().isShadow())return!1;break;default:return!1}return!wl.includes(t)}canConnectToPrevious_(e,t){return!(e.targetConnection||wl.includes(t)||t.targetConnection&&(!(e=t.targetBlock()).isInsertionMarker()||e.getPreviousBlock()))}};U(x.CONNECTION_CHECKER,gt,ig);var Xs=class{get isFlyout(){return this.internalIsFlyout}get isMutator(){return this.internalIsMutator}constructor(e){this.isClearing=this.internalIsMutator=this.internalIsFlyout=this.rendered=!1,this.MAX_UNDO=1024,this.connectionDBList=[],this.topBlocks=[],this.topComments=[],this.commentDB=new Map,this.listeners=[],this.undoStack_=[],this.redoStack_=[],this.blockDB=new Map,this.typedBlocksDB=new Map,this.procedureMap=new Yp,this.readOnly=!1,this.potentialVariableMap=null,this.id=ve(),_r(this),this.options=e||new Jt({}),this.RTL=!!this.options.RTL,this.horizontalLayout=!!this.options.horizontalLayout,this.toolboxPosition=this.options.toolboxPosition,this.connectionChecker=new(Re(x.CONNECTION_CHECKER,this.options,!0))(this),this.variableMap=new(this.getVariableMapClass())(this),this.setIsReadOnly(this.options.readOnly)}dispose(){this.listeners.length=0,this.clear(),br(this)}sortObjects(e,t){const i=s=>({getBoundingRectangle:()=>{const n=s.getRelativeToSurfaceXY();return new j(n.y,n.y,n.x,n.x)},moveBy:()=>{}});return this.sortByOrigin(i(e),i(t))}sortByOrigin(e,t){const i=Math.sin(Br(Xs.SCAN_ANGLE))*(this.RTL?-1:1);return e=e.getBoundingRectangle().getOrigin(),t=t.getBoundingRectangle().getOrigin(),e.y+i*e.x-(t.y+i*t.x)}addTopBlock(e){this.topBlocks.push(e)}removeTopBlock(e){if(!ht(this.topBlocks,e))throw Error("Block not present in workspace's list of top-most blocks.")}getTopBlocks(e=!1){const t=[].concat(this.topBlocks);return e&&t.length>1&&t.sort(this.sortObjects.bind(this)),t}addTypedBlock(e){this.typedBlocksDB.has(e.type)||this.typedBlocksDB.set(e.type,[]),this.typedBlocksDB.get(e.type).push(e)}removeTypedBlock(e){ht(this.typedBlocksDB.get(e.type),e),this.typedBlocksDB.get(e.type).length||this.typedBlocksDB.delete(e.type)}getBlocksByType(e,t=!1){return this.typedBlocksDB.has(e)?(e=this.typedBlocksDB.get(e).slice(0),t&&e&&e.length>1&&e.sort(this.sortObjects.bind(this)),e.filter(i=>!i.isInsertionMarker())):[]}addTopComment(e){this.topComments.push(e),this.commentDB.has(e.id)&&console.warn('Overriding an existing comment on this workspace, with id "'+e.id+'"'),this.commentDB.set(e.id,e)}removeTopComment(e){if(!ht(this.topComments,e))throw Error("Comment not present in workspace's list of top-most comments.");this.commentDB.delete(e.id)}getTopComments(e=!1){const t=[].concat(this.topComments);return e&&t.length>1&&t.sort(this.sortObjects.bind(this)),t}getAllBlocks(e=!1){if(e){var t=this.getTopBlocks(!0);e=[];for(let i=0;i<t.length;i++)e.push(...t[i].getDescendants(!0))}else for(e=this.getTopBlocks(!1),t=0;t<e.length;t++)e.push(...e[t].getChildren(!1));return e.filter(i=>!i.isInsertionMarker())}clear(){this.isClearing=!0;try{const e=o.getGroup$$module$build$src$core$events$utils();for(e||o.setGroup$$module$build$src$core$events$utils(!0);this.topBlocks.length;)this.topBlocks[0].dispose(!1);for(;this.topComments.length;)this.topComments[this.topComments.length-1].dispose();o.setGroup$$module$build$src$core$events$utils(e),this.isFlyout||this.variableMap.clear(),this.potentialVariableMap&&this.potentialVariableMap.clear()}finally{this.isClearing=!1}}renameVariableById(e,t){Me("Blockly.Workspace.renameVariableById","v12","v13","Blockly.Workspace.getVariableMap().renameVariable"),(e=this.variableMap.getVariableById(e))&&this.variableMap.renameVariable(e,t)}createVariable(e,t,i){return Me("Blockly.Workspace.createVariable","v12","v13","Blockly.Workspace.getVariableMap().createVariable"),this.variableMap.createVariable(e,t??void 0,i??void 0)}getVariableUsesById(e){return Me("Blockly.Workspace.getVariableUsesById","v12","v13","Blockly.Workspace.getVariableMap().getVariableUsesById"),hs(this,e)}deleteVariableById(e){Me("Blockly.Workspace.deleteVariableById","v12","v13","Blockly.Workspace.getVariableMap().deleteVariable");const t=this.variableMap.getVariableById(e);t?o.deleteVariable$$module$build$src$core$variables(this,t):console.warn(`Can't delete non-existent variable: ${e}`)}getVariable(e,t){return Me("Blockly.Workspace.getVariable","v12","v13","Blockly.Workspace.getVariableMap().getVariable"),this.variableMap.getVariable(e,t)}getVariableById(e){return Me("Blockly.Workspace.getVariableById","v12","v13","Blockly.Workspace.getVariableMap().getVariableById"),this.variableMap.getVariableById(e)}getVariablesOfType(e){return Me("Blockly.Workspace.getVariablesOfType","v12","v13","Blockly.Workspace.getVariableMap().getVariablesOfType"),this.variableMap.getVariablesOfType(e??"")}getAllVariables(){return Me("Blockly.Workspace.getAllVariables","v12","v13","Blockly.Workspace.getVariableMap().getAllVariables"),this.variableMap.getAllVariables()}getAllVariableNames(){return Me("Blockly.Workspace.getAllVariableNames","v12","v13","Blockly.Workspace.getVariableMap().getAllVariables"),this.variableMap.getAllVariables().map(e=>e.getName())}getWidth(){return 0}newBlock(e,t){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}newComment(e){throw Error("The implementation of newComment should be monkey-patched in by blockly.ts")}remainingCapacity(){return isNaN(this.options.maxBlocks)?1/0:this.options.maxBlocks-this.getAllBlocks(!1).length}remainingCapacityOfType(e){return this.options.maxInstances?(void 0!==this.options.maxInstances[e]?this.options.maxInstances[e]:1/0)-this.getBlocksByType(e,!1).length:1/0}isCapacityAvailable(e){if(!this.hasBlockLimits())return!0;let t=0;for(const i in e){if(e[i]>this.remainingCapacityOfType(i))return!1;t+=e[i]}return!(t>this.remainingCapacity())}hasBlockLimits(){return this.options.maxBlocks!==1/0||!!this.options.maxInstances}getUndoStack(){return this.undoStack_}getRedoStack(){return this.redoStack_}undo(e){var t=e?this.redoStack_:this.undoStack_,i=e?this.undoStack_:this.redoStack_;const s=t.pop();if(s){for(var n=[s];t.length&&s.group&&s.group===t[t.length-1].group;){const l=t.pop();l&&n.push(l)}for(t=0;t<n.length;t++)i.push(n[t]);o.setRecordUndo$$module$build$src$core$events$utils(!1);try{for(i=0;i<n.length;i++)n[i].run(e)}finally{o.setRecordUndo$$module$build$src$core$events$utils(!0)}}}clearUndo(){this.undoStack_.length=0,this.redoStack_.length=0,li()}addChangeListener(e){return this.listeners.push(e),e}removeChangeListener(e){ht(this.listeners,e)}fireChangeListener(e){if(e.recordUndo)for(this.undoStack_.push(e),this.redoStack_.length=0;this.undoStack_.length>this.MAX_UNDO&&this.MAX_UNDO>=0;)this.undoStack_.shift();for(let t=0;t<this.listeners.length;t++)(0,this.listeners[t])(e)}getBlockById(e){return this.blockDB.get(e)||null}setBlockById(e,t){this.blockDB.set(e,t)}removeBlockById(e){this.blockDB.delete(e)}getCommentById(e){let t;return null!=(t=this.commentDB.get(e))?t:null}allInputsFilled(e){const t=this.getTopBlocks(!1);for(let i=0;i<t.length;i++)if(!t[i].allInputsFilled(e))return!1;return!0}getPotentialVariableMap(){return this.potentialVariableMap}createPotentialVariableMap(){this.potentialVariableMap=new(this.getVariableMapClass())(this,!0)}getVariableMap(){return this.variableMap}setVariableMap(e){this.variableMap=e}getProcedureMap(){return this.procedureMap}getRootWorkspace(){let e=null;const t=this.options.parentWorkspace;return this.isFlyout?t&&t.options&&(e=t.options.parentWorkspace):t&&(e=t),e}static getById(e){return uo(e)}static getAll(){return ui()}getVariableMapClass(){const e=Re(x.VARIABLE_MAP,this.options,!0);if(!e)throw Error("No variable map is registered.");return e}isReadOnly(){return this.readOnly}setIsReadOnly(e){this.readOnly=e,this.options.readOnly=e}};Xs.SCAN_ANGLE=3;var sg=class{constructor(e){this.parentWorkspace=e,this.sounds=new Map,this.lastSound=null,this.muted=!1}dispose(){this.sounds.clear()}load(e,t){if(e.length){try{var i=new globalThis.Audio}catch{return}for(let n=0;n<e.length;n++){const l=e[n],u=l.match(/\.(\w+)$/);if(u&&i.canPlayType("audio/"+u[1])){var s=new globalThis.Audio(l);break}}s&&this.sounds.set(t,s)}}preload(){for(const e of this.sounds.values()){e.volume=.01;const t=e.play();if(void 0!==t?t.then(e.pause).catch(function(){}):e.pause(),Na||$$)break}}play(e,t){if(!this.muted){var i=this.sounds.get(e);i?(e=new Date,null!==this.lastSound&&e.getTime()-this.lastSound.getTime()<100||(this.lastSound=e,(i=Na||Hh?i:i.cloneNode()).volume=void 0===t?1:t,i.play())):this.parentWorkspace&&this.parentWorkspace.getAudioManager().play(e,t)}}setMuted(e){this.muted=e}getMuted(){return this.muted}},ze=class extends Xs{constructor(e){let t;super(e),this.resizeHandlerWrapper=null,this.resizesEnabled=this.visible=this.rendered=!0,this.startScrollY=this.startScrollX=this.scrollY=this.scrollX=0,this.oldScale=this.scale=1,this.oldLeft=this.oldTop=0,this.inverseScreenCTM=this.targetWorkspace=this.dummyWheelListener=this.configureContextMenu=this.lastRecordedPageScroll=this.injectionDiv=this.currentGesture_=this.toolbox=this.flyout=this.scrollbar=this.trashcan=null,this.inverseScreenCTMDirty=!0,this.highlightedBlocks=[],this.toolboxCategoryCallbacks=new Map,this.flyoutButtonCallbacks=new Map,this.cachedParentSvg=null,this.keyboardMoveInProgress=this.keyboardAccessibilityMode=!1,this.topBoundedElements=[],this.dragTargetAreas=[],this.zoomControls_=this.layerManager=null,this.navigator=new mu,this.metricsManager=new(Re(x.METRICS_MANAGER,e,!0))(this),this.getMetrics=e.getMetrics||this.metricsManager.getMetrics.bind(this.metricsManager),this.setMetrics=e.setMetrics||ze.setTopLevelWorkspaceMetrics,this.componentManager=new de,this.connectionDBList=Ws.init(this.connectionChecker),this.audioManager=new sg(e.parentWorkspace),this.grid=this.options.gridPattern?new bu(this.options.gridPattern,e.gridOptions):null,this.markerManager=new Tu(this),Ce&&Mr&&this.registerToolboxCategoryCallback(Va,Mr),qi&&jn&&this.registerToolboxCategoryCallback(Au,jn),et&&Et&&(this.registerToolboxCategoryCallback(oc,Et),this.addChangeListener(As)),this.addChangeListener(this.variableChangeCallback.bind(this)),this.themeManager_=this.options.parentWorkspace?this.options.parentWorkspace.getThemeManager():new og(this,this.options.theme||ql),this.themeManager_.subscribeWorkspace(this),this.renderer=zn(this.options.renderer||"geras",this.getTheme(),null!=(t=this.options.rendererOverrides)?t:void 0),this.cachedParentSvgSize=new Y(0,0)}getMarkerManager(){return this.markerManager}getMetricsManager(){return this.metricsManager}setMetricsManager(e){this.metricsManager=e,this.getMetrics=this.metricsManager.getMetrics.bind(this.metricsManager)}getComponentManager(){return this.componentManager}getMarker(e){return this.markerManager.getMarker(e)}getCursor(){return this.markerManager.getCursor()}getRenderer(){return this.renderer}getThemeManager(){return this.themeManager_}getTheme(){return this.themeManager_.getTheme()}setTheme(e){e||(e=ql),this.themeManager_.setTheme(e)}refreshTheme(){if(this.svgGroup_){var e=null===this.options.parentWorkspace;this.renderer.refreshDom(this.svgGroup_,this.getTheme(),e?this.getInjectionDiv():void 0)}this.updateBlockStyles(this.getAllBlocks(!1).filter(t=>!!t.getStyleName())),this.refreshToolboxSelection(),this.toolbox&&this.toolbox.refreshTheme(),this.isVisible()&&this.setVisible(!0),e=new(P(f.THEME_CHANGE))(this.getTheme().name,this.id),D(e)}updateBlockStyles(e){for(let i,t=0;i=e[t];t++){const s=i.getStyleName();s&&i.setStyle(s)}}getInverseScreenCTM(){if(this.inverseScreenCTMDirty){const e=this.getParentSvg().getScreenCTM();e&&(this.inverseScreenCTM=e.inverse(),this.inverseScreenCTMDirty=!1)}return this.inverseScreenCTM}updateInverseScreenCTM(){this.inverseScreenCTMDirty=!0}isVisible(){return this.visible}getSvgXY(e){let t=0,i=0,s=1;(this.getCanvas().contains(e)||this.getBubbleCanvas().contains(e))&&(s=this.scale);do{const n=_n(e);(e===this.getCanvas()||e===this.getBubbleCanvas())&&(s=1),t+=n.x*s,i+=n.y*s,e=e.parentNode}while(e&&e!==this.getParentSvg()&&e!==this.getInjectionDiv());return new k(t,i)}getCachedParentSvgSize(){const e=this.cachedParentSvgSize;return new Y(e.width,e.height)}getOriginOffsetInPixels(){return Tr(this.getCanvas())}getInjectionDiv(){if(!this.injectionDiv){let e=this.svgGroup_;for(;e;){if((" "+(e.getAttribute("class")||"")+" ").includes(" injectionDiv ")){this.injectionDiv=e;break}e=e.parentNode}}return this.injectionDiv}getSvgGroup(){return this.svgGroup_}getBlockCanvas(){return this.getCanvas()}setResizeHandlerWrapper(e){this.resizeHandlerWrapper=e}createDom(e,t){return this.injectionDiv||(this.injectionDiv=t??null),this.svgGroup_=I(T.G,{class:"blocklyWorkspace",id:this.id}),t&&ye(this.svgGroup_,xe.LABEL,o.Msg$$module$build$src$core$msg.WORKSPACE_ARIA_LABEL),e&&(this.svgBackground_=I(T.RECT,{height:"100%",width:"100%",class:e},this.svgGroup_),"blocklyMainBackground"===e&&this.grid?this.svgBackground_.style.fill="var(--blocklyGridPattern)":this.themeManager_.subscribe(this.svgBackground_,"workspaceBackgroundColour","fill")),this.layerManager=new class{constructor(e){this.workspace=e,this.layers=new Map,(e=e.getInjectionDiv())&&(this.dragLayer=this.createDragLayer(e),this.animationLayer=this.createAnimationLayer(e)),e=this.createLayer(50),R(e,"blocklyBlockCanvas"),e=this.createLayer(100),R(e,"blocklyBubbleCanvas")}createDragLayer(e){const t=I(T.SVG,{class:"blocklyBlockDragSurface",xmlns:Il,"xmlns:html":go,"xmlns:xlink":vt,version:"1.1"});return e.append(t),I(T.G,{},t)}createAnimationLayer(e){const t=I(T.SVG,{class:"blocklyAnimationLayer",xmlns:Il,"xmlns:html":go,"xmlns:xlink":vt,version:"1.1"});return e.append(t),I(T.G,{},t)}appendToAnimationLayer(e){let t;const i=null==(t=this.dragLayer)?void 0:t.getAttribute("transform");if(i){let n;null==(n=this.animationLayer)||n.setAttribute("transform",i)}let s;null==(s=this.animationLayer)||s.appendChild(e.getSvgRoot())}translateLayers(e,t){let i;e=`translate(${e.x}, ${e.y}) scale(${t})`,null==(i=this.dragLayer)||i.setAttribute("transform",e);for(const[,s]of this.layers)s.setAttribute("transform",e)}moveToDragLayer(e){let t;null==(t=this.dragLayer)||t.appendChild(e.getSvgRoot()),e.canBeFocused()&&o.getFocusManager$$module$build$src$core$focus_manager().focusNode(e)}moveOffDragLayer(e,t){this.append(e,t),e.canBeFocused()&&o.getFocusManager$$module$build$src$core$focus_manager().focusNode(e)}append(e,t){let i;if(this.layers.has(t)||this.createLayer(t),e=e.getSvgRoot(),(null==(i=this.layers.get(t))?void 0:i.lastChild)!==e){let s;null==(s=this.layers.get(t))||s.appendChild(e)}}createLayer(e){const t=this.workspace.getSvgGroup(),i=I(T.G,{});let s=!1;const n=[...this.layers].sort((l,u)=>l[0]-u[0]);for(const[l,u]of n)if(e<l){t.insertBefore(i,u),s=!0;break}return s||t.appendChild(i),this.layers.set(e,i),i}hasLayer(e){return e===this.dragLayer||new Set(this.layers.values()).has(e)}getBlockLayer(){return this.layers.get(50)}getBubbleLayer(){return this.layers.get(100)}}(this),this.svgBlockCanvas_=this.layerManager.getBlockLayer(),this.svgBubbleCanvas_=this.layerManager.getBubbleLayer(),this.isFlyout||(N(this.svgGroup_,"pointerdown",this,this.onMouseDown,!1),this.dummyWheelListener=()=>{},document.body.addEventListener("wheel",this.dummyWheelListener),N(this.svgGroup_,"wheel",this,this.onMouseWheel)),this.options.hasCategories&&(this.toolbox=new(Re(x.TOOLBOX,this.options,!0))(this)),this.grid&&this.grid.update(this.scale),this.recordDragTargets(),(e=Re(x.CURSOR,this.options))&&this.markerManager.setCursor(new e(this)),e=null===this.options.parentWorkspace,this.renderer.createDom(this.svgGroup_,this.getTheme(),e?this.getInjectionDiv():void 0),o.getFocusManager$$module$build$src$core$focus_manager().registerTree(this,!!this.injectionDiv||this.isFlyout),this.svgGroup_}dispose(){if(this.rendered=!1,this.currentGesture_&&this.currentGesture_.cancel(),this.svgGroup_&&Q(this.svgGroup_),this.toolbox&&(this.toolbox.dispose(),this.toolbox=null),this.flyout&&(this.flyout.dispose(),this.flyout=null),this.trashcan&&(this.trashcan.dispose(),this.trashcan=null),this.scrollbar&&(this.scrollbar.dispose(),this.scrollbar=null),this.zoomControls_&&this.zoomControls_.dispose(),this.audioManager&&this.audioManager.dispose(),this.grid&&(this.grid=null),this.renderer.dispose(),this.markerManager.dispose(),super.dispose(),this.themeManager_&&(this.themeManager_.unsubscribeWorkspace(this),this.themeManager_.unsubscribe(this.svgBackground_),this.options.parentWorkspace||this.themeManager_.dispose()),this.connectionDBList.length=0,this.toolboxCategoryCallbacks.clear(),this.flyoutButtonCallbacks.clear(),!this.options.parentWorkspace){const e=this.getParentSvg();e&&e.parentNode&&Q(e.parentNode)}this.resizeHandlerWrapper&&(J(this.resizeHandlerWrapper),this.resizeHandlerWrapper=null),this.dummyWheelListener&&(document.body.removeEventListener("wheel",this.dummyWheelListener),this.dummyWheelListener=null),o.getFocusManager$$module$build$src$core$focus_manager().isRegistered(this)&&o.getFocusManager$$module$build$src$core$focus_manager().unregisterTree(this)}addTrashcan(){this.trashcan=ze.newTrashcan(this);const e=this.trashcan.createDom();this.svgGroup_.insertBefore(e,this.getCanvas())}static newTrashcan(e){throw Error("The implementation of newTrashcan should be monkey-patched in by blockly.ts")}addZoomControls(){this.zoomControls_=new tp(this);const e=this.zoomControls_.createDom();this.svgGroup_.appendChild(e)}copyOptionsForFlyout(){return new Jt({parentWorkspace:this,rtl:this.RTL,oneBasedIndex:this.options.oneBasedIndex,horizontalLayout:this.horizontalLayout,renderer:this.options.renderer,rendererOverrides:this.options.rendererOverrides,plugins:this.options.plugins,modalInputs:this.options.modalInputs,move:{scrollbars:!0}})}addFlyout(e){const t=this.copyOptionsForFlyout();return t.toolboxPosition=this.options.toolboxPosition,this.flyout=this.horizontalLayout?new(Re(x.FLYOUTS_HORIZONTAL_TOOLBOX,this.options,!0))(t):new(Re(x.FLYOUTS_VERTICAL_TOOLBOX,this.options,!0))(t),this.flyout.autoClose=!1,this.flyout.getWorkspace().setVisible(!0),this.flyout.createDom(e)}getFlyout(e){return this.flyout||e?this.flyout:this.toolbox?this.toolbox.getFlyout():null}getToolbox(){return this.toolbox}updateScreenCalculations(){this.updateInverseScreenCTM(),this.recordDragTargets()}resizeContents(){this.resizesEnabled&&this.rendered&&(this.scrollbar&&this.scrollbar.resize(),this.updateInverseScreenCTM())}resize(){this.toolbox?this.toolbox.position():this.flyout&&this.flyout.position();const e=this.componentManager.getComponents(de.Capability.POSITIONABLE,!0),t=this.getMetricsManager().getUiMetrics(),i=[];for(let n,s=0;n=e[s];s++){n.position(t,i);const l=n.getBoundingRectangle();l&&i.push(l)}this.scrollbar&&this.scrollbar.resize(),this.updateScreenCalculations()}updateScreenCalculationsIfScrolled(){const e=vc();k.equals(this.lastRecordedPageScroll,e)||(this.lastRecordedPageScroll=e,this.updateScreenCalculations())}getLayerManager(){return this.layerManager}getCanvas(){return this.layerManager.getBlockLayer()}setCachedParentSvgSize(e,t){const i=this.getParentSvg();null!=e&&(this.cachedParentSvgSize.width=e,i.setAttribute("data-cached-width",`${e}`)),null!=t&&(this.cachedParentSvgSize.height=t,i.setAttribute("data-cached-height",`${t}`))}getBubbleCanvas(){return this.layerManager.getBubbleLayer()}getParentSvg(){if(!this.cachedParentSvg){let e=this.svgGroup_;for(;e;){if("svg"===e.tagName){this.cachedParentSvg=e;break}e=e.parentNode}}return this.cachedParentSvg}maybeFireViewportChangeEvent(){if(ne()){var e=this.scale,t=-this.scrollY,i=-this.scrollX;if(!(e===this.oldScale&&Math.abs(t-this.oldTop)<1&&Math.abs(i-this.oldLeft)<1)){var s=new(P(f.VIEWPORT_CHANGE))(t,i,e,this.id,this.oldScale);this.oldScale=e,this.oldTop=t,this.oldLeft=i,D(s)}}}translate(e,t){let i,s;null==(i=this.layerManager)||i.translateLayers(new k(e,t),this.scale),null==(s=this.grid)||s.moveTo(e,t),this.maybeFireViewportChangeEvent()}getWidth(){const e=this.getMetrics();return e?e.viewWidth/this.scale:0}setVisible(e){this.visible=e,this.svgGroup_&&(this.scrollbar&&this.scrollbar.setContainerVisible(e),this.getFlyout()&&this.getFlyout().setContainerVisible(e),this.getParentSvg().style.display=e?"block":"none",this.toolbox&&this.toolbox.setVisible(e),e||this.hideChaff(!0))}render(){const e=this.getAllBlocks(!1);for(let t=e.length-1;t>=0;t--)e[t].queueRender();this.getTopBlocks().flatMap(t=>t.getDescendants(!1)).filter(t=>t.isInsertionMarker()).forEach(t=>t.queueRender())}highlightBlock(e,t){if(void 0===t){for(let s,i=0;s=this.highlightedBlocks[i];i++)s.setHighlighted(!1);this.highlightedBlocks.length=0}(e=e?this.getBlockById(e):null)&&((t=void 0===t||t)?this.highlightedBlocks.includes(e)||this.highlightedBlocks.push(e):ht(this.highlightedBlocks,e),e.setHighlighted(t))}variableChangeCallback(e){switch(e.type){case f.VAR_CREATE:case f.VAR_DELETE:case f.VAR_RENAME:case f.VAR_TYPE_CHANGE:this.refreshToolboxSelection()}}refreshToolboxSelection(){const e=this.isFlyout?this.targetWorkspace:this;e&&!e.currentGesture_&&e.toolbox&&e.toolbox.getFlyout()&&e.toolbox.refreshSelection()}recordDragTargets(){const e=this.componentManager.getComponents(de.Capability.DRAG_TARGET,!0);this.dragTargetAreas=[];for(let i,t=0;i=e[t];t++){const s=i.getClientRect();s&&this.dragTargetAreas.push({component:i,clientRect:s})}}newBlock(e,t){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}newComment(e){throw Error("The implementation of newComment should be monkey-patched in by blockly.ts")}getDragTarget(e){for(let i,t=0;i=this.dragTargetAreas[t];t++)if(i.clientRect.contains(e.clientX,e.clientY))return i.component;return null}onMouseDown(e){const t=this.getGesture(e);t&&t.handleWsStart(e,this)}startDrag(e,t){h(this,e,t)}moveDrag(e){return w(this,e)}setKeyboardMoveInProgress(e){this.keyboardMoveInProgress=e}isDragging(){return this.keyboardMoveInProgress||null!==this.currentGesture_&&this.currentGesture_.isDragging()}isDraggable(){return this.options.moveOptions&&this.options.moveOptions.drag}isMovable(){return this.options.moveOptions&&!!this.options.moveOptions.scrollbars||this.options.moveOptions&&this.options.moveOptions.wheel||this.options.moveOptions&&this.options.moveOptions.drag||this.options.zoomOptions&&this.options.zoomOptions.wheel||this.options.zoomOptions&&this.options.zoomOptions.pinch}isMovableHorizontally(){const e=!!this.scrollbar;return this.isMovable()&&(!e||e&&this.scrollbar.canScrollHorizontally())}isMovableVertically(){const e=!!this.scrollbar;return this.isMovable()&&(!e||e&&this.scrollbar.canScrollVertically())}onMouseWheel(e){if(tc.inProgress())e.preventDefault(),e.stopPropagation();else{var t=this.options.zoomOptions&&this.options.zoomOptions.wheel,i=this.options.moveOptions&&this.options.moveOptions.wheel;if(t||i){var s=yo(e);if(Zh)var n=e.metaKey;t&&(e.ctrlKey||n||!i)?(s=-s.y/50,t=wt(e,this.getParentSvg(),this.getInverseScreenCTM()),this.zoom(t.x,t.y,s)):(t=this.scrollX-s.x,i=this.scrollY-s.y,e.shiftKey&&!s.x&&(t=this.scrollX-s.y,i=this.scrollY),this.scroll(t,i)),e.preventDefault()}}}getBlocksBoundingBox(){const e=this.getTopBoundedElements();if(!e.length)return new j(0,0,0,0);const t=e[0].getBoundingRectangle();for(let s=1;s<e.length;s++){var i=e[s];i.isInsertionMarker&&i.isInsertionMarker()||((i=i.getBoundingRectangle()).top<t.top&&(t.top=i.top),i.bottom>t.bottom&&(t.bottom=i.bottom),i.left<t.left&&(t.left=i.left),i.right>t.right&&(t.right=i.right))}return t}cleanUp(){this.setResizesEnabled(!1),o.setGroup$$module$build$src$core$events$utils(!0);var e=this.getTopBlocks(!0),t=e.filter(l=>l.isMovable());const i=e.filter(l=>!l.isMovable()).map(l=>l.getBoundingRectangle());e=function(l){for(const u of i)if(l.intersects(u))return u;return null};var s=0;const n=this.renderer.getConstants().MIN_BLOCK_HEIGHT;for(const l of t){for(t=l.getBoundingRectangle(),l.moveBy(-t.left,s-t.top,["cleanup"]),l.snapToGrid(),s=e(t=l.getBoundingRectangle());null!=s;)s=s.top+s.getHeight()+n,l.moveBy(0,s-t.top,["cleanup"]),l.snapToGrid(),s=e(t=l.getBoundingRectangle());s=l.getRelativeToSurfaceXY().y+l.getHeightWidth().height+n}o.setGroup$$module$build$src$core$events$utils(!1),this.setResizesEnabled(!0)}showContextMenu(e){if(!this.isReadOnly()&&!this.isFlyout){var t=q.registry.getContextMenuOptions({workspace:this,focusedNode:this},e);this.configureContextMenu&&this.configureContextMenu(t,e);var i=e instanceof PointerEvent?new k(e.clientX,e.clientY):cs(this,new k(5,5));Ei(e,t,this.RTL,this,i)}}updateToolbox(e){if(e=Er(e)){if(!this.options.languageTree)throw Error("Existing toolbox is null.  Can't create new toolbox.");if(vr(e)){if(!this.toolbox)throw Error("Existing toolbox has no categories.  Can't change mode.");this.options.languageTree=e,this.toolbox.render(e)}else{if(!this.flyout)throw Error("Existing toolbox has categories.  Can't change mode.");this.options.languageTree=e,this.flyout.show(e)}}else if(this.options.languageTree)throw Error("Can't nullify an existing toolbox.")}markFocused(){this.options.parentWorkspace?this.options.parentWorkspace.markFocused():(ns(this),this.getParentSvg().focus({preventScroll:!0}))}zoom(e,t,i){i=Math.pow(this.options.zoomOptions.scaleSpeed,i);const s=this.scale*i;if(this.scale!==s){s>this.options.zoomOptions.maxScale?i=this.options.zoomOptions.maxScale/this.scale:s<this.options.zoomOptions.minScale&&(i=this.options.zoomOptions.minScale/this.scale);var n=this.getCanvas().getCTM(),l=this.getParentSvg().createSVGPoint();l.x=e,l.y=t,l=l.matrixTransform(n.inverse()),n=n.translate((e=l.x)*(1-i),(t=l.y)*(1-i)).scale(i),this.scrollX=n.e,this.scrollY=n.f,this.setScale(s)}}zoomCenter(e){var t=this.getMetrics();let i;this.flyout?(i=t.svgWidth?t.svgWidth/2:0,t=t.svgHeight?t.svgHeight/2:0):(i=t.viewWidth/2+t.absoluteLeft,t=t.viewHeight/2+t.absoluteTop),this.zoom(i,t,e)}zoomToFit(){if(this.isMovable()){var e=this.getMetrics(),t=e.viewWidth;e=e.viewHeight;var i=this.getBlocksBoundingBox(),n=i.right-i.left+40;if(i=i.bottom-i.top+40,n){this.flyout&&(this.horizontalLayout?(e+=this.flyout.getHeight(),i+=this.flyout.getHeight()/this.scale):(t+=this.flyout.getWidth(),n+=this.flyout.getWidth()/this.scale)),t/=n,e/=i,o.disable$$module$build$src$core$events$utils();try{this.setScale(Math.min(t,e)),this.scrollCenter()}finally{o.enable$$module$build$src$core$events$utils()}this.maybeFireViewportChangeEvent()}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}beginCanvasTransition(){R(this.getCanvas(),"blocklyCanvasTransitioning"),R(this.getBubbleCanvas(),"blocklyCanvasTransitioning")}endCanvasTransition(){X(this.getCanvas(),"blocklyCanvasTransitioning"),X(this.getBubbleCanvas(),"blocklyCanvasTransitioning")}scrollCenter(){if(this.isMovable()){var e=this.getMetrics(),t=(e.scrollWidth-e.viewWidth)/2,i=(e.scrollHeight-e.viewHeight)/2;this.scroll(t=-t-e.scrollLeft,i=-i-e.scrollTop)}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}centerOnBlock(e,t){if(this.isMovable()){var i=e?this.getBlockById(e):null;if(i){e=i.getRelativeToSurfaceXY(),i=t?{height:i.height,width:i.width}:i.getHeightWidth();var s=this.scale;t=(e.x+(this.RTL?-1:1)*i.width/2)*s,e=(e.y+i.height/2)*s,i=this.getMetrics(),this.scroll(-(t-i.viewWidth/2),-(e-i.viewHeight/2))}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}setScale(e){this.options.zoomOptions.maxScale&&e>this.options.zoomOptions.maxScale?e=this.options.zoomOptions.maxScale:this.options.zoomOptions.minScale&&e<this.options.zoomOptions.minScale&&(e=this.options.zoomOptions.minScale),this.scale=e,this.hideChaff(!1),(e=this.getFlyout(!1))&&e.isVisible()&&(e.reflow(),this.recordDragTargets()),this.grid&&this.grid.update(this.scale),e=this.getMetrics(),this.scrollX-=e.absoluteLeft,this.scrollY-=e.absoluteTop,e.viewLeft+=e.absoluteLeft,e.viewTop+=e.absoluteTop,this.scroll(this.scrollX,this.scrollY),this.scrollbar&&(this.flyout?this.scrollbar.resizeView(e):this.scrollbar.resizeContent(e))}getScale(){return this.scale}getAbsoluteScale(){const e=i=>{if(i.isFlyout){let s;const n=null==(s=i.targetWorkspace)?void 0:s.getFlyout();if(n instanceof Ql)return n.getFlyoutScale()}return i.getScale()},t=(i,s)=>i.options.parentWorkspace&&i.options.parentWorkspace.getSvgGroup().contains(i.getSvgGroup())?t(i.options.parentWorkspace,s*e(i)):s*e(i);return t(this,1)}scroll(e,t){this.hideChaff(!0);const i=this.getMetrics();e=Math.min(e,-i.scrollLeft),t=Math.min(t,-i.scrollTop);const s=i.scrollTop+Math.max(0,i.scrollHeight-i.viewHeight);e=Math.max(e,-(i.scrollLeft+Math.max(0,i.scrollWidth-i.viewWidth))),t=Math.max(t,-s),this.scrollX=e,this.scrollY=t,this.scrollbar&&this.scrollbar.set(-(e+i.scrollLeft),-(t+i.scrollTop),!1),this.translate(e+=i.absoluteLeft,t+=i.absoluteTop)}getBlockById(e){return super.getBlockById(e)}getAllBlocks(e=!1){return super.getAllBlocks(e)}getTopBlocks(e=!1){return super.getTopBlocks(e)}addTopBlock(e){this.addTopBoundedElement(e),super.addTopBlock(e)}removeTopBlock(e){this.removeTopBoundedElement(e),super.removeTopBlock(e)}addTopComment(e){this.addTopBoundedElement(e),super.addTopComment(e)}removeTopComment(e){this.removeTopBoundedElement(e),super.removeTopComment(e)}getTopComments(e=!1){return super.getTopComments(e)}getCommentById(e){return super.getCommentById(e)}getRootWorkspace(){return super.getRootWorkspace()}addTopBoundedElement(e){this.topBoundedElements.push(e)}removeTopBoundedElement(e){ht(this.topBoundedElements,e)}getTopBoundedElements(e=!1){const t=[].concat(this.topBoundedElements);return e&&t.sort(this.sortByOrigin.bind(this)),t}setResizesEnabled(e){const t=!this.resizesEnabled&&e;this.resizesEnabled=e,t&&this.resizeContents()}clear(){this.setResizesEnabled(!1),super.clear(),this.topBoundedElements=[],this.setResizesEnabled(!0)}registerButtonCallback(e,t){if("function"!=typeof t)throw TypeError("Button callbacks must be functions.");this.flyoutButtonCallbacks.set(e,t)}getButtonCallback(e){let t;return null!=(t=this.flyoutButtonCallbacks.get(e))?t:null}removeButtonCallback(e){this.flyoutButtonCallbacks.delete(e)}registerToolboxCategoryCallback(e,t){if("function"!=typeof t)throw TypeError("Toolbox category callbacks must be functions.");this.toolboxCategoryCallbacks.set(e,t)}getToolboxCategoryCallback(e){return this.toolboxCategoryCallbacks.get(e)||null}removeToolboxCategoryCallback(e){this.toolboxCategoryCallbacks.delete(e)}getGesture(e){if(this.keyboardMoveInProgress)return e.preventDefault(),e.stopPropagation(),null;const t="pointerdown"===e.type;let i;return t&&null!=(i=this.currentGesture_)&&i.hasStarted()&&(console.warn("Tried to start the same gesture twice."),this.currentGesture_.cancel()),!this.currentGesture_&&t&&(this.currentGesture_=new tc(e,this)),this.currentGesture_}clearGesture(){this.currentGesture_=null}cancelCurrentGesture(){this.currentGesture_&&this.currentGesture_.cancel()}getAudioManager(){return this.audioManager}getGrid(){return this.grid}hideChaff(e=!1){Gt(),bs(this),Vt(),this.hideComponents(e)}hideComponents(e=!1){this.getComponentManager().getComponents(de.Capability.AUTOHIDEABLE,!0).forEach(t=>t.autoHide(e))}static setTopLevelWorkspaceMetrics(e){const t=this.getMetrics();"number"==typeof e.x&&(this.scrollX=-(t.scrollLeft+(t.scrollWidth-t.viewWidth)*e.x)),"number"==typeof e.y&&(this.scrollY=-(t.scrollTop+(t.scrollHeight-t.viewHeight)*e.y)),this.translate(this.scrollX+t.absoluteLeft,this.scrollY+t.absoluteTop)}addClass(e){this.injectionDiv&&R(this.injectionDiv,e)}removeClass(e){this.injectionDiv&&X(this.injectionDiv,e)}setIsReadOnly(e){super.setIsReadOnly(e),e?this.addClass("blocklyReadOnly"):this.removeClass("blocklyReadOnly")}scrollBoundsIntoView(e,t=10){if(!tc.inProgress()){var i=this.getScale(),s=this.getMetricsManager().getViewMetrics(!0);if(s=new j(s.top,s.top+s.height,s.left,s.left+s.width),!(e.left>=s.left&&e.top>=s.top&&e.right<=s.right&&e.bottom<=s.bottom)){(e=e.clone()).top-=t,e.bottom+=t,e.left-=t,e.right+=t;var n=t=0;e.left<s.left?t=this.RTL?Math.min(s.left-e.left,s.right-e.right):s.left-e.left:e.right>s.right&&(t=this.RTL?s.right-e.right:Math.max(s.right-e.right,s.left-e.left)),e.top<s.top?n=s.top-e.top:e.bottom>s.bottom&&(n=Math.max(s.bottom-e.bottom,s.top-e.top)),this.scroll(this.scrollX+t*i,this.scrollY+n*i)}}}getFocusableElement(){return this.svgGroup_}getFocusableTree(){return this.isMutator&&this.options.parentWorkspace||this}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}getRootFocusableNode(){return this}getRestoredFocusableNode(e){if(e)return null;let t;return null!=(t=this.getTopBlocks(!0)[0])?t:null}getNestedTrees(){const e=this.getAllBlocks().map(i=>i.getIcons()).flat().filter(i=>i instanceof o.MutatorIcon$$module$build$src$core$icons$mutator_icon&&i.bubbleIsVisible()).map(i=>{let s;return null==(s=i.getBubble())?void 0:s.getWorkspace()}).filter(i=>!!i),t=this.getFlyout(!0);return t&&e.push(t.getWorkspace()),e}searchForWorkspaceComment(e){for(const t of this.getTopComments())if(t instanceof Kt&&t.canBeFocused()&&t.getFocusableElement().id===e)return t}lookUpFocusableNode(e){var t;const i=null==(t=this.targetWorkspace)?void 0:t.getFlyout();if(this.isFlyout&&i)for(var s of i.getContents())if(t=s.getElement(),xo(t)&&t.canBeFocused()&&t.getFocusableElement().id===e)return t;if(s=e.indexOf("_field_"),t=e.indexOf("_connection_"),-1!==s){var n=e.substring(0,s);if(n=this.getBlockById(n))for(var l of n.getFields())if(l.canBeFocused()&&l.getFocusableElement().id===e)return l;return null}if(-1!==t){if(n=e.substring(0,t),n=this.getBlockById(n))for(const $ of n.getConnections_(!0))if($.id===e)return $;return null}var u;if(-1!==(l=Math.max(e.indexOf(iu),e.indexOf(yp),e.indexOf(xp)))&&(l=e.substring(0,l),l=this.searchForWorkspaceComment(l)))return e.indexOf(iu)>-1?l.getEditorFocusableNode():null!=(u=l.view.getCommentBarButtons().find($=>$.getFocusableElement().id.includes(e)))?u:null;if((u=this.getAllBlocks(!1).find($=>$.getFocusableElement().id===e))||(u=this.searchForWorkspaceComment(e)))return u;for(n of u=this.getAllBlocks().map($=>$.getIcons()).flat()){if(n.canBeFocused()&&n.getFocusableElement().id===e)return n;if(Ao(n)&&(u=n.getBubble())&&u.canBeFocused()&&u.getFocusableElement().id===e)return u}return null}onTreeFocus(e,t){}onTreeBlur(e){if(this.isFlyout&&this.targetWorkspace&&!o.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()){var t=this.targetWorkspace.getFlyout(),i=this.targetWorkspace.getToolbox();i&&e===i||(i&&i.clearSelection(),t&&Fn(t)&&t.autoHide(!1))}}getNavigator(){return this.navigator}setNavigator(e){this.navigator=e}},Dm={};Dm.WorkspaceSvg=ze,Dm.resizeSvgContents=Vg;var Ks=class extends Ds{constructor(e){super(),this.isBlank=typeof e>"u",e&&(this.varId=e.getId(),this.workspaceId=e.getWorkspace().id)}toJson(){const e=super.toJson();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");return e.varId=this.varId,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new Ks)).varId=e.varId,t}},Ru=class extends Ks{constructor(e){super(e),this.type=f.VAR_CREATE,e&&(this.varType=e.getType(),this.varName=e.getName())}toJson(){const e=super.toJson();if(void 0===this.varType)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");return e.varType=this.varType,e.varName=this.varName,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new Ru)).varType=e.varType,t.varName=e.varName,t}run(e){var t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");t=t.getVariableMap(),e?t.createVariable(this.varName,this.varType,this.varId):(e=t.getVariableById(this.varId))&&t.deleteVariable(e)}};U(x.EVENT,f.VAR_CREATE,Ru);var ng=class{constructor(e,t,i,s){this.workspace=e,this.name=t,this.type=i||"",this.id=s||ve()}getId(){return this.id}getName(){return this.name}setName(e){return this.name=e,this}getType(){return this.type}setType(e){return this.type=e,this}getWorkspace(){return this.workspace}save(){const e={name:this.getName(),id:this.getId()},t=this.getType();return t&&(e.type=t),e}static load(e,t){e=new this(t,e.name,e.type,e.id),t.getVariableMap().addVariable(e),D(new(P(f.VAR_CREATE))(e))}};U(x.VARIABLE_MODEL,gt,ng);var Ou=class extends Ks{constructor(e){super(e),this.type=f.VAR_DELETE,e&&(this.varType=e.getType(),this.varName=e.getName())}toJson(){const e=super.toJson();if(void 0===this.varType)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");return e.varType=this.varType,e.varName=this.varName,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new Ou)).varType=e.varType,t.varName=e.varName,t}run(e){var t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");t=t.getVariableMap(),e?(e=t.getVariableById(this.varId))&&t.deleteVariable(e):t.createVariable(this.varName,this.varType,this.varId)}};U(x.EVENT,f.VAR_DELETE,Ou);var Mu=class extends Ks{constructor(e,t){super(e),this.type=f.VAR_RENAME,e&&(this.oldName=e.getName(),this.newName=typeof t>"u"?"":t)}toJson(){const e=super.toJson();if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");return e.oldName=this.oldName,e.newName=this.newName,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new Mu)).oldName=e.oldName,t.newName=e.newName,t}run(e){var t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");const i=(t=t.getVariableMap()).getVariableById(this.varId);e?i&&t.renameVariable(i,this.newName):i&&t.renameVariable(i,this.oldName)}};U(x.EVENT,f.VAR_RENAME,Mu);var rg=class{constructor(e,t=!1){this.workspace=e,this.potentialMap=t,this.variableMap=new Map}clear(){for(const e of this.variableMap.values())for(const t of e.values())this.deleteVariable(t);if(0!==this.variableMap.size)throw Error("Non-empty variable map")}renameVariable(e,t){if(e.getName()===t)return e;var i=e.getType();i=this.getVariable(t,i);const s=this.workspace.getAllBlocks(!1);let n="";this.potentialMap||(n=o.getGroup$$module$build$src$core$events$utils())||o.setGroup$$module$build$src$core$events$utils(!0);try{i&&i.getId()!==e.getId()?this.renameVariableWithConflict(e,t,i,s):this.renameVariableAndUses(e,t,s)}finally{this.potentialMap||o.setGroup$$module$build$src$core$events$utils(n)}return e}changeVariableType(e,t){var i;let s;return null==(i=this.variableMap.get(e.getType()))||i.delete(e.getId()),e.setType(t),(i=null!=(s=this.variableMap.get(t))?s:new Map).set(e.getId(),e),this.variableMap.has(t)||this.variableMap.set(t,i),e}renameVariableById(e,t){Me("VariableMap.renameVariableById","v12","v13","VariableMap.renameVariable");const i=this.getVariableById(e);if(!i)throw Error("Tried to rename a variable that didn't exist. ID: "+e);this.renameVariable(i,t)}renameVariableAndUses(e,t,i){for(this.potentialMap||D(new(P(f.VAR_RENAME))(e,t)),e.setName(t),t=0;t<i.length;t++)i[t].updateVarName(e)}renameVariableWithConflict(e,t,i,s){const n=e.getType();for(t!==i.getName()&&this.renameVariableAndUses(i,t,s),t=0;t<s.length;t++)s[t].renameVarById(e.getId(),i.getId());let u;this.potentialMap||D(new(P(f.VAR_DELETE))(e)),null==(u=this.variableMap.get(n))||u.delete(e.getId())}createVariable(e,t,i){var s=this.getVariable(e,t);if(s){if(i&&s.getId()!==i)throw Error('Variable "'+e+'" is already in use and its id is "'+s.getId()+'" which conflicts with the passed in id, "'+i+'".');return s}if(i&&this.getVariableById(i))throw Error('Variable id, "'+i+'", is already in use.');if(s=i||ve(),t=t||"",!(i=kt(x.VARIABLE_MODEL,gt,!0)))throw Error("No variable model is registered.");let n;return s=new i(this.workspace,e,t,s),(e=null!=(n=this.variableMap.get(t))?n:new Map).set(s.getId(),s),this.variableMap.has(t)||this.variableMap.set(t,e),this.potentialMap||D(new(P(f.VAR_CREATE))(s)),s}addVariable(e){const t=e.getType();let i;this.variableMap.has(t)||this.variableMap.set(t,new Map),null==(i=this.variableMap.get(t))||i.set(e.getId(),e)}deleteVariable(e){const t=hs(this.workspace,e.getId());let i="";this.potentialMap||(i=o.getGroup$$module$build$src$core$events$utils())||o.setGroup$$module$build$src$core$events$utils(!0);try{for(let n=0;n<t.length;n++)t[n].dispose(!0);const s=this.variableMap.get(e.getType());s&&s.has(e.getId())&&(s.delete(e.getId()),this.potentialMap||D(new(P(f.VAR_DELETE))(e)),0===s.size&&this.variableMap.delete(e.getType()))}finally{this.potentialMap||o.setGroup$$module$build$src$core$events$utils(i)}}deleteVariableById(e){Me("VariableMap.deleteVariableById","v12","v13","Blockly.Variables.deleteVariable"),(e=this.getVariableById(e))&&o.deleteVariable$$module$build$src$core$variables(this.workspace,e)}getVariable(e,t){if(!(t=this.variableMap.get(t||"")))return null;let i;return null!=(i=[...t.values()].find(s=>o.Names$$module$build$src$core$names.equals(s.getName(),e)))?i:null}getVariableById(e){for(const t of this.variableMap.values())if(t.has(e)){let i;return null!=(i=t.get(e))?i:null}return null}getVariablesOfType(e){return(e=this.variableMap.get(e||""))?[...e.values()]:[]}getTypes(){return[...this.variableMap.keys()]}getAllVariables(){let e=[];for(const t of this.variableMap.values())e=e.concat(...t.values());return e}getAllVariableNames(){Me("VariableMap.getAllVariableNames","v12","v13","Blockly.Variables.getAllVariables");const e=[];for(const t of this.variableMap.values())for(const i of t.values())e.push(i.getName());return e}getVariableUsesById(e){return Me("VariableMap.getVariableUsesById","v12","v13","Blockly.Variables.getVariableUsesById"),hs(this.workspace,e)}};U(x.VARIABLE_MAP,gt,rg);var Nu=class extends Yt{constructor(e,t){super(t),this.type=f.TRASHCAN_OPEN,this.isOpen=e}toJson(){const e=super.toJson();if(void 0===this.isOpen)throw Error("Whether this is already open or not is undefined. Either pass a value to the constructor, or call fromJson");return e.isOpen=this.isOpen,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new Nu)).isOpen=e.isOpen,t}};U(x.EVENT,f.TRASHCAN_OPEN,Nu);var lg=class extends Kl{constructor(e){super(),this.workspace=e,this.id="trashcan",this.contents=[],this.flyout=null,this.isLidOpen=!1,this.minOpenness=0,this.lidTask=this.svgLid=this.svgGroup=null,this.top=this.left=this.lidOpen=0,this.initialized=!1,this.workspace.options.maxTrashcanContents<=0||(e=this.workspace.copyOptionsForFlyout(),this.workspace.horizontalLayout?(e.toolboxPosition=this.workspace.toolboxPosition===G.TOP?G.BOTTOM:G.TOP,this.flyout=new(Re(x.FLYOUTS_HORIZONTAL_TOOLBOX,this.workspace.options,!0))(e)):(e.toolboxPosition=this.workspace.toolboxPosition===G.RIGHT?G.LEFT:G.RIGHT,this.flyout=new(Re(x.FLYOUTS_VERTICAL_TOOLBOX,this.workspace.options,!0))(e)),this.workspace.addChangeListener(this.onDelete.bind(this)))}createDom(){let e;this.svgGroup=I(T.G,{class:"blocklyTrash"});const t=String(Math.random()).substring(2);e=I(T.CLIPPATH,{id:"blocklyTrashBodyClipPath"+t},this.svgGroup),I(T.RECT,{width:pr,height:Lu,y:gr},e);const i=I(T.IMAGE,{width:Ke_width,x:-cg,height:Ke_height,y:-ag,"clip-path":"url(#blocklyTrashBodyClipPath"+t+")"},this.svgGroup);return i.setAttributeNS(vt,"xlink:href",this.workspace.options.pathToMedia+Ke_url),e=I(T.CLIPPATH,{id:"blocklyTrashLidClipPath"+t},this.svgGroup),I(T.RECT,{width:pr,height:gr},e),this.svgLid=I(T.IMAGE,{width:Ke_width,x:-cg,height:Ke_height,y:-ag,"clip-path":"url(#blocklyTrashLidClipPath"+t+")"},this.svgGroup),this.svgLid.setAttributeNS(vt,"xlink:href",this.workspace.options.pathToMedia+Ke_url),Ye(this.svgGroup,"pointerdown",this,this.blockMouseDownWhenOpenable),Ye(this.svgGroup,"pointerup",this,this.click),Ye(i,"pointerover",this,this.mouseOver),Ye(i,"pointerout",this,this.mouseOut),this.animateLid(),this.svgGroup}init(){if(this.workspace.options.maxTrashcanContents>0){const e=this.flyout.createDom(T.SVG);R(e,"blocklyTrashcanFlyout"),c(e,this.workspace.getParentSvg()),this.flyout.init(this.workspace)}this.workspace.getComponentManager().addComponent({component:this,weight:de.ComponentWeight.TRASHCAN_WEIGHT,capabilities:[de.Capability.AUTOHIDEABLE,de.Capability.DELETE_AREA,de.Capability.DRAG_TARGET,de.Capability.POSITIONABLE]}),this.initialized=!0,this.setLidOpen(!1)}dispose(){this.workspace.getComponentManager().removeComponent("trashcan"),this.svgGroup&&Q(this.svgGroup),this.lidTask&&clearTimeout(this.lidTask)}hasContents(){return!!this.contents.length}contentsIsOpen(){return!!this.flyout&&this.flyout.isVisible()}openFlyout(){if(!this.contentsIsOpen()){var e=this.contents.map(function(i){return JSON.parse(i)}),t=this.workspace.getParentSvg().style;t.cursor="wait",setTimeout(()=>{let i,s;null==(i=this.flyout)||i.show(e),t.cursor="",null==(s=this.workspace.scrollbar)||s.setVisible(!1)},10),this.fireUiEvent(!0)}}closeFlyout(){var e,t;this.contentsIsOpen()&&(null==(e=this.flyout)||e.hide(),null==(t=this.workspace.scrollbar)||t.setVisible(!0),this.fireUiEvent(!1),this.workspace.recordDragTargets())}autoHide(e){!e&&this.flyout&&this.closeFlyout()}emptyContents(){this.hasContents()&&(this.contents.length=0,this.setMinOpenness(0),this.closeFlyout())}position(e,t){if(this.initialized){var s,n,i=xr(this.workspace,e);e=Ir(i,new Y(pr,Lu+gr),TT,Pm,e,this.workspace),t=kr(e,Pm,i.vertical===Di.TOP?Bs.DOWN:Bs.UP,t),this.top=t.top,this.left=t.left,null==(s=this.svgGroup)||s.setAttribute("transform","translate("+this.left+","+this.top+")"),null==(n=this.flyout)||n.position()}}getBoundingRectangle(){return new j(this.top,this.top+Lu+gr,this.left,this.left+pr)}getClientRect(){if(!this.svgGroup)return null;var e=this.svgGroup.getBoundingClientRect();const t=e.top+ag-Du;return new j(t,t+gr+Lu+2*Du,e=e.left+cg-Du,e+pr+2*Du)}onDragOver(e){this.setLidOpen(this.wouldDelete_)}onDragExit(e){this.setLidOpen(!1)}onDrop(e){setTimeout(this.setLidOpen.bind(this,!1),100)}setLidOpen(e){this.isLidOpen!==e&&(this.lidTask&&clearTimeout(this.lidTask),this.isLidOpen=e,this.animateLid())}animateLid(){const e=yT;var t=1/(e+1);this.lidOpen+=this.isLidOpen?t:-t,this.lidOpen=Math.min(Math.max(this.lidOpen,this.minOpenness),1),this.setLidAngle(this.lidOpen*Fm),t=Bm+this.lidOpen*(CT-Bm),this.svgGroup&&(this.svgGroup.style.opacity=`${t}`),this.lidOpen>this.minOpenness&&this.lidOpen<1&&(this.lidTask=setTimeout(this.animateLid.bind(this),vT/e))}setLidAngle(e){const t=this.workspace.toolboxPosition===G.RIGHT||this.workspace.horizontalLayout&&this.workspace.RTL;let i;null==(i=this.svgLid)||i.setAttribute("transform","rotate("+(t?-e:e)+","+(t?4:pr-4)+","+(gr-2)+")")}setMinOpenness(e){this.minOpenness=e,this.isLidOpen||this.setLidAngle(e*Fm)}closeLid(){this.setLidOpen(!1)}click(){this.hasContents()&&!this.workspace.isDragging()&&this.openFlyout()}fireUiEvent(e){e=new(P(f.TRASHCAN_OPEN))(e,this.workspace.id),D(e)}blockMouseDownWhenOpenable(e){!this.contentsIsOpen()&&this.hasContents()&&e.stopPropagation()}mouseOver(){this.hasContents()&&this.setLidOpen(!0)}mouseOut(){this.setLidOpen(!1)}onDelete(e){if(!(this.workspace.options.maxTrashcanContents<=0||!ei(e)||e.wasShadow)){if(!e.oldJson)throw Error("Encountered a delete event without proper oldJson");if(e=JSON.stringify(this.cleanBlockJson(e.oldJson)),!this.contents.includes(e)){for(this.contents.unshift(e);this.contents.length>this.workspace.options.maxTrashcanContents;)this.contents.pop();this.setMinOpenness(ET)}}}cleanBlockJson(e){return function t(i){if(i){if(delete i.id,delete i.x,delete i.y,delete i.enabled,delete i.disabledReasons,i.icons&&i.icons.comment){var s=i.icons.comment;delete s.height,delete s.width,delete s.pinned}for(var n in s=i.inputs){var l=s[n];const u=l.block;l=l.shadow,u&&t(u),l&&t(l)}i.next&&(i=(n=i.next).block,n=n.shadow,i&&t(i),n&&t(n))}}(e=JSON.parse(JSON.stringify(e))),Object.assign({},{kind:"BLOCK"},e)}},pr=47,Lu=44,gr=16,Pm=20,TT=20,Du=10,cg=0,ag=32,ET=.1,vT=80,yT=4,Bm=.4,CT=.8,Fm=45,ac=null,uc=null,Pu=void 0,io={};io.BlockPaster=cr,io.copy=Ca,io.getLastCopiedData=Ia,io.getLastCopiedLocation=ih,io.getLastCopiedWorkspace=xa,io.paste=Oi,io.registry=ip,io.setLastCopiedData=Gg,io.setLastCopiedLocation=qg,io.setLastCopiedWorkspace=Wg;var zi={};zi.CollapseCommentBarButton=Cp,zi.CommentBarButton=Gl,zi.CommentEditor=Ip,zi.CommentView=nr,zi.DeleteCommentBarButton=kp,zi.RenderedWorkspaceComment=Kt,zi.WorkspaceComment=Wl;var jo=function(e){return e.ESCAPE="escape",e.DELETE="delete",e.COPY="copy",e.CUT="cut",e.PASTE="paste",e.UNDO="undo",e.REDO="redo",e}(jo||{});ph();var bo={};bo.names=jo,bo.registerCopy=ch,bo.registerCut=ah,bo.registerDefaultShortcuts=ph,bo.registerDelete=rh,bo.registerEscape=nh,bo.registerPaste=uh,bo.registerRedo=hh,bo.registerUndo=dh;var Bu={ProcedureSerializer:class{constructor(e,t){this.procedureModelClass=e,this.parameterModelClass=t,this.priority=75}save(e){return(e=e.getProcedureMap().getProcedures().map(t=>gh(t))).length?e:null}load(e,t){const i=t.getProcedureMap();for(const s of e)i.add($h(this.procedureModelClass,this.parameterModelClass,s,t))}clear(e){e.getProcedureMap().clear()}}};Bu.loadProcedure=$h,Bu.saveProcedure=gh;var Um=class{constructor(){this.priority=100}save(e){return(e=e.getAllVariables().map(t=>t.save())).length?e:null}load(e,t){const i=kt(x.VARIABLE_MODEL,gt);e.forEach(s=>{i?.load(s,t)})}clear(e){e.getVariableMap().clear()}};fn("variables",new Um);var Hm={};Hm.VariableSerializer=Um;var ug={};ug.load=jg,ug.save=zg;var wT={blocks:Bl,exceptions:Us,priorities:Z_,procedures:Bu,registry:op,variables:Hm,workspaceComments:Fa,workspaces:ug};"Blockly"in globalThis||(globalThis.Blockly={Msg:H$});var dg="label",hg=class{load(e,t){return(e=new Qe(t.getWorkspace(),t.targetWorkspace,e,!0)).show(),new js(e,dg)}gapForItem(e,t){return t}disposeItem(e){(e=e.getElement())instanceof Qe&&e.dispose()}getType(){return dg}};U(x.FLYOUT_INFLATER,dg,hg);var pg=class extends nc{constructor(e){super(),this.GRID_UNIT=4,this.CURSOR_COLOUR="#ffa200",this.CURSOR_RADIUS=5,this.JAGGED_TEETH_WIDTH=this.JAGGED_TEETH_HEIGHT=0,this.START_HAT_HEIGHT=22,this.START_HAT_WIDTH=96,this.SHAPES={HEXAGONAL:1,ROUND:2,SQUARE:3,PUZZLE:4,NOTCH:5},this.SHAPE_IN_SHAPE_PADDING={1:{0:5*this.GRID_UNIT,1:2*this.GRID_UNIT,2:5*this.GRID_UNIT,3:5*this.GRID_UNIT},2:{0:3*this.GRID_UNIT,1:3*this.GRID_UNIT,2:1*this.GRID_UNIT,3:2*this.GRID_UNIT},3:{0:2*this.GRID_UNIT,1:2*this.GRID_UNIT,2:2*this.GRID_UNIT,3:2*this.GRID_UNIT}},this.FULL_BLOCK_FIELDS=!0,this.FIELD_TEXT_FONTWEIGHT="bold",this.FIELD_TEXT_FONTFAMILY='"Helvetica Neue", "Segoe UI", Helvetica, sans-serif',this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!0,this.SELECTED_GLOW_COLOUR="#fff200",this.SELECTED_GLOW_SIZE=.5,this.REPLACEMENT_GLOW_COLOUR="#fff200",this.REPLACEMENT_GLOW_SIZE=2,this.selectedGlowFilterId="",this.selectedGlowFilter=null,this.replacementGlowFilterId="",this.SQUARED=this.ROUNDED=this.HEXAGONAL=this.replacementGlowFilter=null,e&&(this.GRID_UNIT=e),this.SMALL_PADDING=this.GRID_UNIT,this.MEDIUM_PADDING=2*this.GRID_UNIT,this.MEDIUM_LARGE_PADDING=3*this.GRID_UNIT,this.LARGE_PADDING=4*this.GRID_UNIT,this.CORNER_RADIUS=1*this.GRID_UNIT,this.NOTCH_WIDTH=9*this.GRID_UNIT,this.NOTCH_HEIGHT=2*this.GRID_UNIT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT=3*this.GRID_UNIT,this.MIN_BLOCK_WIDTH=2*this.GRID_UNIT,this.MIN_BLOCK_HEIGHT=12*this.GRID_UNIT,this.EMPTY_STATEMENT_INPUT_HEIGHT=6*this.GRID_UNIT,this.TOP_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=6*this.GRID_UNIT,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT,this.STATEMENT_INPUT_SPACER_MIN_WIDTH=40*this.GRID_UNIT,this.STATEMENT_INPUT_PADDING_LEFT=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_PADDING=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_MIN_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=6*this.GRID_UNIT,this.CURSOR_WS_WIDTH=20*this.GRID_UNIT,this.FIELD_TEXT_FONTSIZE=3*this.GRID_UNIT,this.FIELD_BORDER_RECT_RADIUS=this.CORNER_RADIUS,this.FIELD_BORDER_RECT_X_PADDING=2*this.GRID_UNIT,this.FIELD_BORDER_RECT_Y_PADDING=1.625*this.GRID_UNIT,this.FIELD_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_COLOUR_DEFAULT_WIDTH=6*this.GRID_UNIT,this.FIELD_COLOUR_DEFAULT_HEIGHT=8*this.GRID_UNIT,this.FIELD_CHECKBOX_X_OFFSET=1*this.GRID_UNIT,this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH=12*this.GRID_UNIT}setFontConstants_(e){super.setFontConstants_(e),this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT=this.FIELD_TEXT_HEIGHT+2*this.FIELD_BORDER_RECT_Y_PADDING}init(){super.init(),this.HEXAGONAL=this.makeHexagonal(),this.ROUNDED=this.makeRounded(),this.SQUARED=this.makeSquared(),this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT+this.INSIDE_CORNERS.rightWidth}setDynamicProperties_(e){super.setDynamicProperties_(e),this.SELECTED_GLOW_COLOUR=e.getComponentStyle("selectedGlowColour")||this.SELECTED_GLOW_COLOUR;const t=Number(e.getComponentStyle("selectedGlowSize"));this.SELECTED_GLOW_SIZE=t&&!isNaN(t)?t:this.SELECTED_GLOW_SIZE,this.REPLACEMENT_GLOW_COLOUR=e.getComponentStyle("replacementGlowColour")||this.REPLACEMENT_GLOW_COLOUR,this.REPLACEMENT_GLOW_SIZE=(e=Number(e.getComponentStyle("replacementGlowSize")))&&!isNaN(e)?e:this.REPLACEMENT_GLOW_SIZE}dispose(){super.dispose(),this.selectedGlowFilter&&Q(this.selectedGlowFilter),this.replacementGlowFilter&&Q(this.replacementGlowFilter)}makeStartHat(){const e=this.START_HAT_HEIGHT,t=this.START_HAT_WIDTH;return{height:.75*e,width:t,path:Ne("c",[L(25,-e),L(71,-e),L(t,0)])}}makeHexagonal(){function e(i,s,n){var l=i/2;return rt(-(n=n?-1:1)*(l=l>t?t:l),i=(s?-1:1)*i/2)+rt(n*l,i)}const t=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;return{type:this.SHAPES.HEXAGONAL,isDynamic:!0,width:i=>(i/=2)>t?t:i,height:i=>i,connectionOffsetY:i=>i/2,connectionOffsetX:i=>-i,pathDown:i=>e(i,!1,!1),pathUp:i=>e(i,!0,!1),pathRightDown:i=>e(i,!1,!0),pathRightUp:i=>e(i,!1,!0)}}makeRounded(){function e(s,n,l){const u=s>i?s-i:0,$=l===n?"0":"1";return pe("a","0 0,"+$,s=(s>i?i:s)/2,L((l?1:-1)*s,(n?-1:1)*s))+B("v",(n?-1:1)*u)+pe("a","0 0,"+$,s,L((l?-1:1)*s,(n?-1:1)*s))}const t=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,i=2*t;return{type:this.SHAPES.ROUND,isDynamic:!0,width:s=>(s/=2)>t?t:s,height:s=>s,connectionOffsetY:s=>s/2,connectionOffsetX:s=>-s,pathDown:s=>e(s,!1,!1),pathUp:s=>e(s,!0,!1),pathRightDown:s=>e(s,!1,!0),pathRightUp:s=>e(s,!1,!0)}}makeSquared(){function e(i,s,n){i-=2*t;const l=n===s?"0":"1";return pe("a","0 0,"+l,t,L((n?1:-1)*t,(s?-1:1)*t))+B("v",(s?-1:1)*i)+pe("a","0 0,"+l,t,L((n?-1:1)*t,(s?-1:1)*t))}const t=this.CORNER_RADIUS;return{type:this.SHAPES.SQUARE,isDynamic:!0,width:i=>t,height:i=>i,connectionOffsetY:i=>i/2,connectionOffsetX:i=>-i,pathDown:i=>e(i,!1,!1),pathUp:i=>e(i,!0,!1),pathRightDown:i=>e(i,!1,!0),pathRightUp:i=>e(i,!1,!0)}}shapeFor(e){let t=e.getCheck();switch(!t&&e.targetConnection&&(t=e.targetConnection.getCheck()),e.type){case M.INPUT_VALUE:case M.OUTPUT_VALUE:if(null!==(e=e.getSourceBlock().getOutputShape()))switch(e){case this.SHAPES.HEXAGONAL:return this.HEXAGONAL;case this.SHAPES.ROUND:return this.ROUNDED;case this.SHAPES.SQUARE:return this.SQUARED}return t&&t.includes("Boolean")?this.HEXAGONAL:(t&&t.includes("Number")||t&&t.includes("String"),this.ROUNDED);case M.PREVIOUS_STATEMENT:case M.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown type")}}makeNotch(){function e(F){return Ne("c",[L(F*n/2,0),L(F*n*3/4,u/2),L(F*n,u)])+Po([L(F*n,l)])+Ne("c",[L(F*n/4,u/2),L(F*n/2,u),L(F*n,u)])+B("h",F*s)+Ne("c",[L(F*n/2,0),L(F*n*3/4,-u/2),L(F*n,-u)])+Po([L(F*n,-l)])+Ne("c",[L(F*n/4,-u/2),L(F*n/2,-u),L(F*n,-u)])}const t=this.NOTCH_WIDTH,i=this.NOTCH_HEIGHT,s=t/3,n=s/3,l=i/2,u=l/2,$=e(1),C=e(-1);return{type:this.SHAPES.NOTCH,width:t,height:i,pathLeft:$,pathRight:C}}makeInsideCorners(){const e=this.CORNER_RADIUS,t=pe("a","0 0,0",e,L(-e,e)),i=pe("a","0 0,1",e,L(-e,e));return{width:e,height:e,pathTop:t,pathBottom:pe("a","0 0,0",e,L(e,e)),rightWidth:e,rightHeight:e,pathTopRight:i,pathBottomRight:pe("a","0 0,1",e,L(e,e))}}generateSecondaryColour_(e){return Mo("#000",e,.15)||e}generateTertiaryColour_(e){return Mo("#000",e,.25)||e}createDom(e,t,i,s){super.createDom(e,t,i,s),e=I(T.DEFS,{},e),t=I(T.FILTER,{id:"blocklySelectedGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e),I(T.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.SELECTED_GLOW_SIZE},t),i=I(T.FECOMPONENTTRANSFER,{result:"outBlur"},t),I(T.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},i),I(T.FEFLOOD,{"flood-color":this.SELECTED_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},t),I(T.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},t),this.selectedGlowFilterId=t.id,this.selectedGlowFilter=t,e=I(T.FILTER,{id:"blocklyReplacementGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e),I(T.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.REPLACEMENT_GLOW_SIZE},e),t=I(T.FECOMPONENTTRANSFER,{result:"outBlur"},e),I(T.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},t),I(T.FEFLOOD,{"flood-color":this.REPLACEMENT_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},e),I(T.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},e),I(T.FECOMPOSITE,{in:"SourceGraphic",in2:"outGlow",operator:"over"},e),this.replacementGlowFilterId=e.id,this.replacementGlowFilter=e,s&&(s.style.setProperty("--blocklySelectedGlowFilter",`url(#${this.selectedGlowFilterId})`),s.style.setProperty("--blocklyReplacementGlowFilter",`url(#${this.replacementGlowFilterId})`))}getCSS_(e){return[`${e} .blocklyText,`,`${e} .blocklyFlyoutLabelText {`,`font: ${this.FIELD_TEXT_FONTWEIGHT} ${this.FIELD_TEXT_FONTSIZE}pt ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${e} .blocklyTextInputBubble textarea {`,"font-weight: normal;","}",`${e} .blocklyText {`,"fill: #fff;","}",`${e} .blocklyNonEditableField>rect:not(.blocklyDropdownRect),`,`${e} .blocklyEditableField>rect:not(.blocklyDropdownRect) {`,`fill: ${this.FIELD_BORDER_RECT_COLOUR};`,"}",`${e} .blocklyNonEditableField>text,`,`${e} .blocklyEditableField>text,`,`${e} .blocklyNonEditableField>g>text,`,`${e} .blocklyEditableField>g>text {`,"fill: #575E75;","}",`${e} .blocklyFlyoutLabelText {`,"fill: #575E75;","}",`${e} .blocklyText.blocklyBubbleText {`,"fill: #575E75;","}",`${e} .blocklyDraggable:not(.blocklyDisabled)`," .blocklyEditableField:not(.blocklyEditing):hover>rect,",`${e} .blocklyDraggable:not(.blocklyDisabled)`," .blocklyEditableField:not(.blocklyEditing):hover>.blocklyPath {","stroke: #fff;","stroke-width: 2;","}",`${e} .blocklyHtmlInput {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,`font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,"color: #575E75;","}",`${e} .blocklyDropdownText {`,"fill: #fff !important;","}",`${e}.blocklyWidgetDiv .blocklyMenuItem,`,`${e}.blocklyDropDownDiv .blocklyMenuItem {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${e}.blocklyDropDownDiv .blocklyMenuItemContent {`,"color: #fff;","}",`${e} .blocklyHighlightedConnectionPath {`,`stroke: ${this.SELECTED_GLOW_COLOUR};`,"}",`${e} .blocklyDisabledPattern > .blocklyOutlinePath {`,"fill: var(--blocklyDisabledPattern)","}",`${e} .blocklyInsertionMarker>.blocklyPath {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}",`${e} .blocklySelected>.blocklyPath.blocklyPathSelected {`,"fill: none;","filter: var(--blocklySelectedGlowFilter);","}",`${e} .blocklyReplaceable>.blocklyPath {`,"filter: var(--blocklyReplacementGlowFilter);","}"]}},gg=class extends rc{constructor(e,t){super(e,t)}draw(){const e=this.block_.pathObject;e.beginDrawing(),this.drawOutline_(),this.drawInternals_(),this.updateConnectionHighlights(),e.setPath(this.outlinePath_+"\n"+this.inlinePath_),this.info_.RTL&&e.flipRTL(),this.recordSizeOnBlock_(),this.info_.outputConnection&&(e.outputShapeType=this.info_.outputConnection.shape.type),e.endDrawing()}drawOutline_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape&&!this.info_.hasStatementInput&&!this.info_.bottomRow.hasNextConnection?(this.drawFlatTop_(),this.drawRightDynamicConnection_(),this.drawFlatBottom_(),this.drawLeftDynamicConnection_()):super.drawOutline_()}drawLeft_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape?this.drawLeftDynamicConnection_():super.drawLeft_()}drawRightSideRow_(e){if(!(e.height<=0)){if(m.isSpacer(e)){const s=e.precedesStatement;var t=e.followsStatement;if(s||t){const n=this.constants_.INSIDE_CORNERS;var i=n.rightHeight;return t=t?n.pathBottomRight:"",e=(i=e.height-(s?i:0))>0?B("V",e.yPos+i):"",void(this.outlinePath_+=t+e+(s?n.pathTopRight:""))}}this.outlinePath_+=B("V",e.yPos+e.height)}}drawRightDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.outlinePath_+=this.info_.outputConnection.shape.pathRightDown(this.info_.outputConnection.height)}drawLeftDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.positionOutputConnection_(),this.outlinePath_+=this.info_.outputConnection.shape.pathUp(this.info_.outputConnection.height),this.outlinePath_+="z"}drawFlatTop_(){const e=this.info_.topRow;this.positionPreviousConnection_(),this.outlinePath_+=ae(e.xPos,this.info_.startY),this.outlinePath_+=B("h",e.width)}drawFlatBottom_(){const e=this.info_.bottomRow;this.positionNextConnection_(),this.outlinePath_+=B("V",e.baseline),this.outlinePath_+=B("h",-e.width)}drawInlineInput_(e){this.positionInlineInputConnection_(e);const t=e.input.name;e.connectedBlock||this.info_.isInsertionMarker||(e=Ie(e.xPos+e.connectionWidth,e.centerline-e.height/2)+this.getInlineInputPath(e),this.block_.pathObject.setOutlinePath(t,e))}getInlineInputPath(e){const t=e.width-2*e.connectionWidth,i=e.height;return B("h",t)+e.shape.pathRightDown(i)+B("h",-t)+e.shape.pathUp(i)+"z"}drawStatementInput_(e){var t=e.getLastInput();const i=t.xPos+t.notchOffset+t.shape.width,s=this.constants_.INSIDE_CORNERS,n=t.shape.pathRight+B("h",-(t.notchOffset-s.width))+s.pathTop,l=e.height-2*s.height;t=s.pathBottom+B("h",t.notchOffset-s.width)+(t.connectedBottomNextConnection?"":t.shape.pathLeft),this.outlinePath_+=B("H",i)+n+B("v",l)+t+B("H",e.xPos+e.width),this.positionStatementInputConnection_(e)}drawConnectionHighlightPath(e){const t=e.connectionModel;if(t.type===M.NEXT_STATEMENT||t.type===M.PREVIOUS_STATEMENT||t.type===M.OUTPUT_VALUE&&!e.isDynamicShape)return super.drawConnectionHighlightPath(e);e=t.type===M.INPUT_VALUE?Ie(e.connectionWidth,-e.height/2)+this.getInlineInputPath(e):Ie(e.width,-e.height/2)+e.shape.pathDown(e.height);const i=t.getSourceBlock();let s,n;return null==(n=(s=i.pathObject).addConnectionHighlight)?void 0:n.call(s,t,e,t.getOffsetInBlock(),i.RTL)}},ji=class extends ee{constructor(e,t,i,s,n,l,u){if(super(ee.SKIP_SETUP),this.imageElement=this.clickHandler=null,this.flipRtl=this.isDirty_=this.EDITABLE=!1,this.altText="",i=Number(ge(i)),t=Number(ge(t)),isNaN(i)||isNaN(t))throw Error("Height and width values of an image field must cast to numbers.");if(i<=0||t<=0)throw Error("Height and width values of an image field must be greater than 0.");this.size_=new Y(t,i+ji.Y_PADDING),this.imageHeight=i,"function"==typeof n&&(this.clickHandler=n),e!==ee.SKIP_SETUP&&(u?this.configure_(u):(this.flipRtl=!!l,this.altText=ge(s)||""),this.setValue(ge(e)))}configure_(e){super.configure_(e),e.flipRtl&&(this.flipRtl=e.flipRtl),e.alt&&(this.altText=ge(e.alt))}initView(){this.imageElement=I(T.IMAGE,{height:this.imageHeight+"px",width:this.size_.width+"px",alt:this.altText},this.fieldGroup_),this.imageElement.setAttributeNS(vt,"xlink:href",this.value_),this.fieldGroup_&&R(this.fieldGroup_,"blocklyImageField"),this.clickHandler&&(this.imageElement.style.cursor="pointer")}updateSize_(){}doClassValidation_(e){return"string"!=typeof e?null:e}doValueUpdate_(e){this.value_=e,this.imageElement&&this.imageElement.setAttributeNS(vt,"xlink:href",this.value_)}getFlipRtl(){return this.flipRtl}setAlt(e){e!==this.altText&&(this.altText=e||"",this.imageElement&&this.imageElement.setAttribute("alt",this.altText))}isClickable(){return super.isClickable()&&!!this.clickHandler}showEditor_(){this.clickHandler&&this.clickHandler(this)}setOnClickHandler(e){this.clickHandler=e}getText_(){return this.altText}static fromJson(e){if(!e.src||!e.width||!e.height)throw Error("src, width, and height values for an image field arerequired. The width and height must be non-zero.");return new this(e.src,e.width,e.height,void 0,void 0,void 0,e)}};ji.Y_PADDING=1,bt("field_image",ji),ji.prototype.DEFAULT_VALUE="";var Js=class extends ee{set size_(e){super.size_=e}get size_(){const e=super.size_;return e.width<14&&(e.width=14),e}constructor(e,t,i){super(ee.SKIP_SETUP),this.spellcheck_=!0,this.htmlInput_=null,this.isTextValid_=this.isBeingEdited_=!1,this.onInputWrapper=this.onKeyDownWrapper=this.valueWhenEditorWasOpened_=null,this.fullBlockClickTarget_=!1,this.workspace_=null,this.SERIALIZABLE=!0,e!==ee.SKIP_SETUP&&(i&&this.configure_(i),this.setValue(e),t&&this.setValidator(t))}configure_(e){super.configure_(e),void 0!==e.spellcheck&&(this.spellcheck_=e.spellcheck)}initView(){if(!this.getSourceBlock())throw new Te;super.initView(),this.isFullBlockField()&&(this.clickTarget_=this.sourceBlock_.getSvgRoot()),this.fieldGroup_&&R(this.fieldGroup_,"blocklyInputField")}isFullBlockField(){const e=this.getSourceBlock();if(!e)throw new Te;let t;return this.fullBlockClickTarget_=!(null==(t=this.getConstants())||!t.FULL_BLOCK_FIELDS)&&e.isSimpleReporter()}doValueInvalid_(e,t=!0){this.isBeingEdited_&&(this.isDirty_=!0,this.isTextValid_=!1,e=this.value_,this.value_=this.valueWhenEditorWasOpened_,this.sourceBlock_&&ne()&&this.value_!==e&&t&&D(new(P(f.BLOCK_CHANGE))(this.sourceBlock_,"field",this.name||null,e,this.value_)))}doValueUpdate_(e){this.isTextValid_=this.isDirty_=!0,this.value_=e}applyColour(){const e=this.getSourceBlock();if(!e)throw new Te;this.getConstants().FULL_BLOCK_FIELDS&&this.fieldGroup_&&(!this.isFullBlockField()&&this.borderRect_?(this.borderRect_.style.display="block",this.borderRect_.setAttribute("stroke",e.getColourTertiary())):(this.borderRect_.style.display="none",e.pathObject.svgPath.setAttribute("fill",this.getConstants().FIELD_BORDER_RECT_COLOUR)))}getSize(){let e;return null!=(e=this.getConstants())&&e.FULL_BLOCK_FIELDS&&(this.render_(),this.isDirty_=!1),super.getSize()}onLocationChange(){this.isBeingEdited_&&this.resizeEditor_()}render_(){if(super.render_(),this.isBeingEdited_){var e=this.htmlInput_;this.isTextValid_?(X(e,"blocklyInvalidInput"),ye(e,xe.INVALID,!1)):(R(e,"blocklyInvalidInput"),ye(e,xe.INVALID,!0))}if(!(e=this.getSourceBlock()))throw new Te;this.getConstants().FULL_BLOCK_FIELDS&&e.applyColour()}setSpellcheck(e){e!==this.spellcheck_&&(this.spellcheck_=e,this.htmlInput_&&this.htmlInput_.setAttribute("spellcheck",this.spellcheck_))}showEditor_(e,t=!1,i=!0){this.workspace_=this.sourceBlock_.workspace,!t&&this.workspace_.options.modalInputs&&(m$||Hh||Na)?this.showPromptEditor():this.showInlineEditor(t,i)}showPromptEditor(){Rr(o.Msg$$module$build$src$core$msg.CHANGE_VALUE_TITLE,this.getText(),e=>{null!==e&&this.setValue(this.getValueFromEditorText_(e)),this.onFinishEditing_(this.value_)})}showInlineEditor(e,t){const i=this.getSourceBlock();if(!i)throw new Te;kn(this,i.RTL,this.widgetDispose_.bind(this),this.workspace_,t),this.htmlInput_=this.widgetCreate_(),this.isBeingEdited_=!0,this.valueWhenEditorWasOpened_=this.value_,e||(this.htmlInput_.focus({preventScroll:!0}),this.htmlInput_.select())}widgetCreate_(){var e=this.getSourceBlock();if(!e)throw new Te;o.setGroup$$module$build$src$core$events$utils(!0);const t=fi();var i=this.getClickTarget_();if(!i)throw Error("A click target has not been set.");R(i,"blocklyEditing"),(i=document.createElement("input")).className="blocklyHtmlInput",i.setAttribute("spellcheck",this.spellcheck_);const s=this.workspace_.getAbsoluteScale();var n=this.getConstants().FIELD_TEXT_FONTSIZE*s+"pt";return t.style.fontSize=n,i.style.fontSize=n,n=Js.BORDERRADIUS*s+"px",this.isFullBlockField()&&(n=((n=this.getScaledBBox()).bottom-n.top)/2+"px",e=e.getParent()?e.getParent().getColourTertiary():this.sourceBlock_.getColourTertiary(),i.style.border=1*s+"px solid "+e,t.style.borderRadius=n,t.style.transition="box-shadow 0.25s ease 0s",this.getConstants().FIELD_TEXTINPUT_BOX_SHADOW&&(t.style.boxShadow="rgba(255, 255, 255, 0.3) 0 0 0 "+4*s+"px")),i.style.borderRadius=n,t.appendChild(i),i.value=i.defaultValue=this.getEditorText_(this.value_),i.setAttribute("data-untyped-default-value",String(this.value_)),this.resizeEditor_(),this.bindInputEvents_(i),i}widgetDispose_(){this.isBeingEdited_=!1,this.isTextValid_=!0,this.forceRerender(),this.onFinishEditing_(this.value_),this.sourceBlock_&&ne()&&null!==this.valueWhenEditorWasOpened_&&this.valueWhenEditorWasOpened_!==this.value_&&(D(new(P(f.BLOCK_CHANGE))(this.sourceBlock_,"field",this.name||null,this.valueWhenEditorWasOpened_,this.value_)),this.valueWhenEditorWasOpened_=null),o.setGroup$$module$build$src$core$events$utils(!1),this.unbindInputEvents_();var e=fi().style;if(e.width="auto",e.height="auto",e.fontSize="",e.transition="",e.boxShadow="",this.htmlInput_=null,!(e=this.getClickTarget_()))throw Error("A click target has not been set.");X(e,"blocklyEditing")}onFinishEditing_(e){}bindInputEvents_(e){this.onKeyDownWrapper=N(e,"keydown",this,this.onHtmlInputKeyDown_),this.onInputWrapper=N(e,"input",this,this.onHtmlInputChange)}unbindInputEvents_(){this.onKeyDownWrapper&&(J(this.onKeyDownWrapper),this.onKeyDownWrapper=null),this.onInputWrapper&&(J(this.onInputWrapper),this.onInputWrapper=null)}onHtmlInputKeyDown_(e){if("Enter"===e.key)No(this),Vt();else if("Escape"===e.key)this.setValue(this.htmlInput_.getAttribute("data-untyped-default-value"),!1),No(this),Vt();else if("Tab"===e.key){e.preventDefault();var t,i=null==(t=this.workspace_)?void 0:t.getCursor();t=s=>(s instanceof Js||s instanceof se&&s.isSimpleReporter())&&s!==this.getSourceBlock(),(e=(e=e.shiftKey?i?.getPreviousNode(this,t,!1):i?.getNextNode(this,t,!1))instanceof se&&e.isSimpleReporter()?e.getFields().next().value:e)instanceof Js&&(No(this),Vt(),i=e.getSourceBlock(),e.isFullBlockField()&&i&&i instanceof se?o.getFocusManager$$module$build$src$core$focus_manager().focusNode(i):o.getFocusManager$$module$build$src$core$focus_manager().focusNode(e),e.showEditor())}}onHtmlInputChange(e){e=this.value_,this.setValue(this.getValueFromEditorText_(this.htmlInput_.value),!1),this.sourceBlock_&&ne()&&this.value_!==e&&D(new(P(f.BLOCK_FIELD_INTERMEDIATE_CHANGE))(this.sourceBlock_,this.name||null,e,this.value_))}setEditorValue_(e,t=!0){this.isDirty_=!0,this.isBeingEdited_&&(this.htmlInput_.value=this.getEditorText_(e)),this.setValue(e,t)}resizeEditor_(){Zt().then(()=>{const e=this.getSourceBlock();if(!e)throw new Te;const t=fi(),i=this.getScaledBBox();t.style.width=i.right-i.left+"px",t.style.height=i.bottom-i.top+"px";const s=i.top;t.style.left=`${e.RTL?i.right-t.offsetWidth:i.left}px`,t.style.top=`${s}px`})}repositionForWindowResize(){let e;const t=null==(e=this.getSourceBlock())?void 0:e.getRootBlock();return t instanceof se&&(Rt(this.workspace_,this.workspace_.getMetricsManager().getViewMetrics(!0),t)||this.resizeEditor_(),!0)}getText_(){return this.isBeingEdited_&&this.htmlInput_?this.htmlInput_.value:null}getEditorText_(e){return`${e}`}getValueFromEditorText_(e){return e}};Js.BORDERRADIUS=4,o.FieldTextInput$$module$build$src$core$field_textinput=class extends Js{constructor(e,t,i){super(e,t,i)}initView(){super.initView(),this.fieldGroup_&&R(this.fieldGroup_,"blocklyTextInputField")}doClassValidation_(e){return void 0===e?null:`${e}`}static fromJson(e){return new this(ge(e.text),void 0,e)}},bt("field_input",o.FieldTextInput$$module$build$src$core$field_textinput),o.FieldTextInput$$module$build$src$core$field_textinput.prototype.DEFAULT_VALUE="";var $g=class extends vu{constructor(e){super(e)}endsWithElemSpacer(){return!1}hasLeftSquareCorner(e){return!!e.outputConnection}hasRightSquareCorner(e){return!!e.outputConnection&&!e.statementInputCount&&!e.nextConnection}},dc=class extends sc{constructor(e,t){if(super(e,t),this.connectedBottomNextConnection=!1,this.connectedBlock){for(e=this.connectedBlock;t=e.getNextBlock();)e=t;e.nextConnection||(this.height=this.connectedBlockHeight,this.connectedBottomNextConnection=!0)}}},mg=class extends oo{constructor(e){super(e),this.width=this.height=0,this.type|=m.getType("RIGHT_CONNECTION")}},_g=class extends wu{constructor(e){super(e)}endsWithElemSpacer(){return!1}hasLeftSquareCorner(e){return!!e.outputConnection||(e.hat?"cap"===e.hat:this.constants_.ADD_START_HATS)&&!e.outputConnection&&!e.previousConnection}hasRightSquareCorner(e){return!!e.outputConnection&&!e.statementInputCount&&!e.nextConnection}},bg=class extends hr{constructor(e,t){super(e,t),this.isInline=!0,this.renderer_=e,this.constants_=this.renderer_.getConstants(),this.topRow=new _g(this.constants_),this.bottomRow=new $g(this.constants_),this.isMultiRow=!t.getInputsInline()||t.isCollapsed(),this.hasStatementInput=t.statementInputCount>0,this.rightSide=this.outputConnection?new mg(this.constants_):null,this.rightAlignedDummyInputs=new WeakMap}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.adjustXPosition_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}shouldStartNewRow_(e,t){return!!t&&(t instanceof mo||e instanceof mt||t instanceof mt||(e instanceof o.ValueInput$$module$build$src$core$inputs$value_input||e instanceof eo||e instanceof mo)&&(!this.isInline||this.isMultiRow))}getDesiredRowWidth_(e){return e.hasStatement?this.width-this.startX-(this.constants_.INSIDE_CORNERS.rightWidth||0):super.getDesiredRowWidth_(e)}getInRowSpacing_(e,t){return e&&t||!this.outputConnection||!this.outputConnection.isDynamicShape||this.hasStatementInput||this.bottomRow.hasNextConnection?!e&&t&&m.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:e&&m.isLeftRoundedCorner(e)&&t&&(m.isPreviousConnection(t)||m.isNextConnection(t))?t.notchOffset-this.constants_.CORNER_RADIUS:e&&m.isLeftSquareCorner(e)&&t&&m.isHat(t)||e&&m.isField(e)&&0===e.width?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:this.constants_.NO_PADDING}getSpacerRowHeight_(e,t){if(m.isTopRow(e)&&m.isBottomRow(t))return this.constants_.EMPTY_BLOCK_SPACER_HEIGHT;const i=m.isInputRow(e)&&e.hasStatement,s=m.isInputRow(t)&&t.hasStatement;return s||i?(e=Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.INSIDE_CORNERS.rightHeight||0),s&&i?Math.max(e,this.constants_.DUMMY_INPUT_MIN_HEIGHT):e):m.isTopRow(e)?e.hasPreviousConnection||this.outputConnection&&!this.hasStatementInput?this.constants_.NO_PADDING:Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):m.isBottomRow(t)?this.outputConnection?!t.hasNextConnection&&this.hasStatementInput?Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):this.constants_.NO_PADDING:Math.max(this.topRow.minHeight,Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.CORNER_RADIUS))-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING}getSpacerRowWidth_(e,t){const i=this.width-this.startX;return m.isInputRow(e)&&e.hasStatement||m.isInputRow(t)&&t.hasStatement?Math.max(i,this.constants_.STATEMENT_INPUT_SPACER_MIN_WIDTH):i}getElemCenterline_(e,t){if(e.hasStatement&&!m.isSpacer(t)&&!m.isStatementInput(t))return e.yPos+this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT/2;if(m.isInlineInput(t)){const i=t.connectedBlock;if(i&&i.outputConnection&&i.nextConnection)return e.yPos+i.height/2}return super.getElemCenterline_(e,t)}addInput_(e,t){if((e instanceof eo||e instanceof mo)&&t.hasDummyInput&&t.align===o.Align$$module$build$src$core$inputs$align.LEFT&&e.align===o.Align$$module$build$src$core$inputs$align.RIGHT)this.rightAlignedDummyInputs.set(t,e);else if(e instanceof mt)return t.elements.push(new dc(this.constants_,e)),t.hasStatement=!0,void(null===t.align&&(t.align=e.align));super.addInput_(e,t)}addAlignmentPadding_(e,t){if(this.rightAlignedDummyInputs.get(e)){let i;for(let s=0;s<e.elements.length;s++){const n=e.elements[s];if(m.isSpacer(n)&&(i=n),m.isField(n)&&n.parentInput===this.rightAlignedDummyInputs.get(e))break}if(i)return i.width+=t,void(e.width+=t)}super.addAlignmentPadding_(e,t)}adjustXPosition_(){const e=this.constants_.NOTCH_OFFSET_LEFT+this.constants_.NOTCH_WIDTH;let t=e;for(let n=2;n<this.rows.length-1;n+=2){var i=this.rows[n-1];const l=this.rows[n];var s=this.rows[n+1];if(i=2===n?!!this.topRow.hasPreviousConnection:!!i.followsStatement,s=n+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!s.precedesStatement,m.isInputRow(l)&&l.hasStatement){let u,$;l.measure(),t=l.width-(null!=($=null==(u=l.getLastInput())?void 0:u.width)?$:0)+e}else if(i&&(2===n||s)&&m.isInputRow(l)&&!l.hasStatement){s=l.xPos,i=null;for(let u=0;u<l.elements.length;u++){const $=l.elements[u];m.isSpacer($)&&(i=$),!(i&&(m.isField($)||m.isInput($))&&s<t)||m.isField($)&&($.field instanceof Vi||$.field instanceof ji)||(i.width+=t-s),s+=$.width}}}}finalizeOutputConnection_(){if(this.outputConnection&&this.outputConnection.isDynamicShape){var e=this.outputConnection.shape;if("isDynamic"in e&&e.isDynamic){for(var t=0,i=0;i<this.rows.length;i++){const s=this.rows[i];s.yPos=t,t+=s.height}this.height=t,t=e.height(i=this.bottomRow.hasNextConnection?this.height-this.bottomRow.descenderHeight:this.height),i=e.width(i),this.outputConnection.height=t,this.outputConnection.width=i,this.outputConnection.startX=i,this.outputConnection.connectionOffsetY=e.connectionOffsetY(t),this.outputConnection.connectionOffsetX=e.connectionOffsetX(i),e=0,this.hasStatementInput||this.bottomRow.hasNextConnection||(e=i,this.rightSide.height=t,this.rightSide.width=e,this.rightSide.centerline=t/2,this.rightSide.xPos=this.width+e),this.startX=i,this.width+=i+e,this.widthWithChildren+=i+e}}}finalizeHorizontalAlignment_(){if(this.outputConnection&&!this.hasStatementInput&&!this.bottomRow.hasNextConnection){for(var e=0,t=0;t<this.rows.length;t++){var i=this.rows[t];if(!m.isInputRow(i))continue;e=i.elements[i.elements.length-2];let s=this.getNegativeSpacing_(i.elements[1]),n=this.getNegativeSpacing_(e);const l=this.constants_.MIN_BLOCK_WIDTH+2*this.outputConnection.width;this.width-(e=s+n)<l&&(s=(e=this.width-l)/2,n=e/2),i.elements.unshift(new _t(this.constants_,-s)),i.elements.push(new _t(this.constants_,-n))}if(e)for(this.width-=e,this.widthWithChildren-=e,this.rightSide.xPos-=e,t=0;t<this.rows.length;t++)m.isTopOrBottomRow(i=this.rows[t])&&(i.elements[1].width-=e),i.width-=e,i.widthWithConnectedBlocks-=e}}getNegativeSpacing_(e){if(!e||!this.outputConnection)return 0;const t=this.outputConnection.width;var i=this.outputConnection.shape.type;const s=this.constants_;if(this.inputRows.length>1)return i===s.SHAPES.ROUND?t-(i=this.height/2>(i=this.constants_.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH)?i:this.height/2)*(1-Math.sin(Math.acos((i-this.constants_.SMALL_PADDING)/i))):0;if(m.isInlineInput(e)){const n=e.connectedBlock;return null==(e=n?n.pathObject.outputShapeType:e.shape.type)||n&&n.outputConnection&&(n.statementInputCount||n.nextConnection)||i===s.SHAPES.HEXAGONAL&&i!==e?0:t-this.constants_.SHAPE_IN_SHAPE_PADDING[i][e]}return m.isField(e)?i===s.SHAPES.ROUND&&e.field instanceof o.FieldTextInput$$module$build$src$core$field_textinput?t-2.75*s.GRID_UNIT:t-this.constants_.SHAPE_IN_SHAPE_PADDING[i][0]:m.isIcon(e)?this.constants_.SMALL_PADDING:0}finalizeVerticalAlignment_(){if(!this.outputConnection)for(let s=2;s<this.rows.length-1;s+=2){const n=this.rows[s-1],l=this.rows[s],u=this.rows[s+1];var e=2===s,t=s+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!u.precedesStatement;if(e?this.topRow.hasPreviousConnection:n.followsStatement){var i=l.elements[1];if(i=3===l.elements.length&&i instanceof Cu&&(i.field instanceof Vi||i.field instanceof ji),!e&&i)n.height-=this.constants_.SMALL_PADDING,u.height-=this.constants_.SMALL_PADDING,l.height-=this.constants_.MEDIUM_PADDING;else if(e||t){if(t){for(e=!1,t=0;t<l.elements.length;t++)if(m.isInlineInput(i=l.elements[t])&&i.connectedBlock&&!i.connectedBlock.isShadow()&&i.connectedBlock.getHeightWidth().height>=40){e=!0;break}e&&(n.height-=this.constants_.SMALL_PADDING,u.height-=this.constants_.SMALL_PADDING)}}else n.height+=this.constants_.SMALL_PADDING}}}finalize_(){this.finalizeOutputConnection_(),this.finalizeHorizontalAlignment_(),this.finalizeVerticalAlignment_(),super.finalize_(),this.rightSide&&(this.widthWithChildren+=this.rightSide.width)}},fg=class extends lc{constructor(e,t,i){super(e,t,i),this.svgPathSelected=null,this.outlines=new Map,this.remainingOutlines=new Set,this.outputShapeType=null,this.constants=i}setPath(e){super.setPath(e),this.svgPathSelected&&this.svgPathSelected.setAttribute("d",e)}applyColour(e){super.applyColour(e);const t=e.getParent();e.isShadow()&&t&&this.svgPath.setAttribute("stroke",t.getColourTertiary());for(const i of this.outlines.values())i.setAttribute("fill",this.style.colourTertiary)}flipRTL(){super.flipRTL();for(const e of this.outlines.values())e.setAttribute("transform","scale(-1 1)")}updateSelected(e){this.setClass_("blocklySelected",e),e?this.svgPathSelected||(this.svgPathSelected=this.svgPath.cloneNode(!0),this.svgPathSelected.classList.add("blocklyPathSelected"),X(this.svgPathSelected,Ze.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME),X(this.svgPathSelected,Ze.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME),this.svgPathSelected.removeAttribute("tabindex"),this.svgPathSelected.removeAttribute("id"),this.svgRoot.appendChild(this.svgPathSelected)):this.svgPathSelected&&(this.svgRoot.removeChild(this.svgPathSelected),this.svgPathSelected=null)}updateReplacementFade(e){this.setClass_("blocklyReplaceable",e)}updateShapeForInputHighlight(e,t){e=e.getParentInput().name,(e=this.getOutlinePath(e))&&(t?e.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):e.removeAttribute("filter"))}beginDrawing(){this.remainingOutlines.clear();for(const e of this.outlines.keys())this.remainingOutlines.add(e)}endDrawing(){if(this.remainingOutlines.size)for(const e of this.remainingOutlines)this.removeOutlinePath(e);this.remainingOutlines.clear()}setOutlinePath(e,t){(e=this.getOutlinePath(e)).setAttribute("d",t),e.setAttribute("fill",this.style.colourTertiary)}getOutlinePath(e){return this.outlines.has(e)||this.outlines.set(e,I(T.PATH,{class:"blocklyOutlinePath",d:""},this.svgRoot)),this.remainingOutlines.delete(e),this.outlines.get(e)}removeOutlinePath(e){let t,i;null==(t=this.outlines.get(e))||null==(i=t.parentNode)||i.removeChild(this.outlines.get(e)),this.outlines.delete(e)}},Fu=class extends cc{constructor(e){super(e)}makeConstants_(){return new pg}makeRenderInfo_(e){return new bg(this,e)}makeDrawer_(e,t){return new gg(e,t)}makePathObject(e,t){return new fg(e,t,this.getConstants())}getConstants(){return this.constants_}};Os("zelos",Fu);var Tg=class{constructor(e){this.staticConn=this.draggedConn=this.markerConn=this.fadedBlock=null,this.workspace=e.workspace}previewReplacement(e,t,i){o.disable$$module$build$src$core$events$utils();try{this.hidePreview(),this.fadedBlock=i,i.fadeForReplacement(!0),this.workspace.getRenderer().shouldHighlightConnection(t)&&(t.highlight(),this.staticConn=t)}finally{o.enable$$module$build$src$core$events$utils()}}previewConnection(e,t){if(e!==this.draggedConn||t!==this.staticConn){o.disable$$module$build$src$core$events$utils();try{this.hidePreview(),this.shouldUseMarkerPreview(e,t)&&(this.markerConn=this.previewMarker(e,t)),this.workspace.getRenderer().shouldHighlightConnection(t)&&t.highlight(),this.draggedConn=e,this.staticConn=t}finally{o.enable$$module$build$src$core$events$utils()}}}shouldUseMarkerPreview(e,t){return t.type===M.PREVIOUS_STATEMENT||t.type===M.NEXT_STATEMENT||!(this.workspace.getRenderer()instanceof Fu)}previewMarker(e,t){const i=e.getSourceBlock(),s=this.createInsertionMarker(i),n=this.getMatchingConnection(i,s,e);if(!n)return null;s.queueRender(),wo(),n.connect(t);const l={x:t.x-n.x,y:t.y-n.y},u=n.getOffsetInBlock().clone();return Zt().then(()=>{if(!s.isDeadOrDying()){o.disable$$module$build$src$core$events$utils();try{s?.positionNearConnection(n,l,u),s?.getSvgRoot().setAttribute("visibility","visible")}finally{o.enable$$module$build$src$core$events$utils()}}}),n}createInsertionMarker(e){const t=pt(e,{addCoordinates:!1,addInputBlocks:!1,addNextBlocks:!1,doFullSerialization:!1});if(!t)throw Error(`Failed to serialize source block. ${e.toDevString()}`);e=So(t,this.workspace);for(const i of e.getDescendants(!1))i.setInsertionMarker(!0);return e.initSvg(),e.getSvgRoot().setAttribute("visibility","hidden"),e}getMatchingConnection(e,t,i){if(e=e.getConnections_(!0),t=t.getConnections_(!0),e.length!==t.length)return null;for(let s=0;s<e.length;s++)if(e[s]===i)return t[s];return null}hidePreview(){o.disable$$module$build$src$core$events$utils();try{this.staticConn&&(this.staticConn.unhighlight(),this.staticConn=null),this.fadedBlock&&(this.fadedBlock.fadeForReplacement(!1),this.fadedBlock=null),this.markerConn&&(this.hideInsertionMarker(this.markerConn),this.draggedConn=this.markerConn=null)}finally{o.enable$$module$build$src$core$events$utils()}}hideInsertionMarker(e){const t=e.getSourceBlock(),i=t.outputConnection;let s;if(null!=(s=t.previousConnection)&&s.targetConnection||null!=i&&i.targetConnection)t.unplug(!0);else{let n;null==(n=e.targetBlock())||n.unplug(!1)}t.dispose()}dispose(){this.hidePreview()}};U(x.CONNECTION_PREVIEWER,gt,Tg);var Yi={};Yi.Align=o.Align$$module$build$src$core$inputs$align,Yi.DummyInput=eo,Yi.EndRowInput=mo,Yi.Input=qs,Yi.StatementInput=mt,Yi.ValueInput=o.ValueInput$$module$build$src$core$inputs$value_input,Yi.inputTypes=o.inputTypes$$module$build$src$core$inputs$input_types;var Zm=!1;o.CodeGenerator$$module$build$src$core$generator=class{constructor(e){this.forBlock=Object.create(null),this.FUNCTION_NAME_PLACEHOLDER_="{leCUI8hutHZI4480Dc}",this.STATEMENT_SUFFIX=this.STATEMENT_PREFIX=this.INFINITE_LOOP_TRAP=null,this.INDENT="  ",this.COMMENT_WRAP=60,this.ORDER_OVERRIDES=[],this.isInitialized=null,this.RESERVED_WORDS_="",this.definitions_=Object.create(null),this.functionNames_=Object.create(null),this.nameDB_=void 0,this.name_=e,this.FUNCTION_NAME_PLACEHOLDER_REGEXP_=new RegExp(this.FUNCTION_NAME_PLACEHOLDER_,"g")}workspaceToCode(e){e||(console.warn("No workspace specified in workspaceToCode call.  Guessing."),e=st());var t=[];this.init(e),e=e.getTopBlocks(!0);for(let s,i=0;s=e[i];i++){let n=this.blockToCode(s);Array.isArray(n)&&(n=n[0]),n&&(s.outputConnection&&(n=this.scrubNakedValue(n),this.STATEMENT_PREFIX&&!s.suppressPrefixSuffix&&(n=this.injectId(this.STATEMENT_PREFIX,s)+n),this.STATEMENT_SUFFIX&&!s.suppressPrefixSuffix&&(n+=this.injectId(this.STATEMENT_SUFFIX,s))),t.push(n))}return t=t.join("\n"),(t=(t=(t=this.finish(t)).replace(/^\s+\n/,"")).replace(/\n\s+$/,"\n")).replace(/[ \t]+\n/g,"\n")}prefixLines(e,t){return t+e.replace(/(?!\n$)\n/g,"\n"+t)}allNestedComments(e){const t=[];e=e.getDescendants(!0);for(let i=0;i<e.length;i++){const s=e[i].getCommentText();s&&t.push(s)}return t.length&&t.push(""),t.join("\n")}blockToCode(e,t){if(!1===this.isInitialized&&console.warn("CodeGenerator init was not called before blockToCode was called."),!e)return"";if(!e.isEnabled())return t?"":this.blockToCode(e.getNextBlock());if(e.isInsertionMarker())return t?"":this.blockToCode(e.getChildren(!1)[0]);var i=this.forBlock[e.type];if("function"!=typeof i)throw Error(`${this.name_} generator does not know how to generate code for block type "${e.type}".`);if(i=i.call(e,e,this),Array.isArray(i)){if(!e.outputConnection)throw TypeError("Expecting string from statement block: "+e.type);return[this.scrub_(e,i[0],t),i[1]]}if("string"==typeof i)return this.STATEMENT_PREFIX&&!e.suppressPrefixSuffix&&(i=this.injectId(this.STATEMENT_PREFIX,e)+i),this.STATEMENT_SUFFIX&&!e.suppressPrefixSuffix&&(i+=this.injectId(this.STATEMENT_SUFFIX,e)),this.scrub_(e,i,t);if(null===i)return"";throw SyntaxError("Invalid code generated: "+i)}valueToCode(e,t,i){if(isNaN(i))throw TypeError("Expecting valid order from block: "+e.type);var s=e.getInputTargetBlock(t);if(!s&&!e.getInput(t))throw ReferenceError(`Input "${t}" doesn't exist on "${e.type}"`);if(!s||""===(t=this.blockToCode(s)))return"";if(!Array.isArray(t))throw TypeError(`Expecting tuple from value block: ${s.type} See developers.google.com/blockly/guides/create-custom-blocks/generating-code for more information`);if(e=t[0],t=t[1],isNaN(t))throw TypeError("Expecting valid order from value block: "+s.type);if(!e)return"";s=!1;var n=Math.floor(i);const l=Math.floor(t);if(n<=l&&(n!==l||0!==n&&99!==n))for(s=!0,n=0;n<this.ORDER_OVERRIDES.length;n++)if(this.ORDER_OVERRIDES[n][0]===i&&this.ORDER_OVERRIDES[n][1]===t){s=!1;break}return s&&(e="("+e+")"),e}statementToCode(e,t){const i=e.getInputTargetBlock(t);if(!i&&!e.getInput(t))throw ReferenceError(`Input "${t}" doesn't exist on "${e.type}"`);if("string"!=typeof(e=this.blockToCode(i)))throw TypeError("Expecting code from statement block: "+(i&&i.type));return e&&(e=this.prefixLines(e,this.INDENT)),e}addLoopTrap(e,t){return this.INFINITE_LOOP_TRAP&&(e=this.prefixLines(this.injectId(this.INFINITE_LOOP_TRAP,t),this.INDENT)+e),this.STATEMENT_SUFFIX&&!t.suppressPrefixSuffix&&(e=this.prefixLines(this.injectId(this.STATEMENT_SUFFIX,t),this.INDENT)+e),this.STATEMENT_PREFIX&&!t.suppressPrefixSuffix&&(e+=this.prefixLines(this.injectId(this.STATEMENT_PREFIX,t),this.INDENT)),e}injectId(e,t){return t=t.id.replace(/\$/g,"$$$$"),e.replace(/%1/g,"'"+t+"'")}addReservedWords(e){this.RESERVED_WORDS_+=e+","}provideFunction_(e,t){if(!this.definitions_[e]){const i=this.nameDB_.getDistinctName(e,o.NameType$$module$build$src$core$names.PROCEDURE);let s;for(this.functionNames_[e]=i,Array.isArray(t)&&(t=t.join("\n")),t=t.trim().replace(this.FUNCTION_NAME_PLACEHOLDER_REGEXP_,i);s!==t;)s=t,t=t.replace(/^(( {2})*) {2}/gm,"$1\0");t=t.replace(/\0/g,this.INDENT),this.definitions_[e]=t}return this.functionNames_[e]}getVariableName(e){return this.getName(e,o.NameType$$module$build$src$core$names.VARIABLE)}getProcedureName(e){return this.getName(e,o.NameType$$module$build$src$core$names.PROCEDURE)}getName(e,t){if(!this.nameDB_)throw Error("Name database is not defined. You must initialize `nameDB_` in your generator class and call `init` first.");return this.nameDB_.getName(e,t)}init(e){this.definitions_=Object.create(null),this.functionNames_=Object.create(null)}scrub_(e,t,i){return t}finish(e){return this.definitions_=Object.create(null),this.functionNames_=Object.create(null),e}scrubNakedValue(e){return e}};var Uu=class extends Ql{constructor(e){super(e)}setMetrics_(e){if(this.isVisible()){var t=this.workspace_.getMetricsManager(),i=t.getScrollMetrics(),s=t.getViewMetrics();t=t.getAbsoluteMetrics(),"number"==typeof e.y&&(this.workspace_.scrollY=-(i.top+(i.height-s.height)*e.y)),this.workspace_.translate(this.workspace_.scrollX+t.left,this.workspace_.scrollY+t.top)}}getX(){if(!this.isVisible())return 0;var e=this.targetWorkspace.getMetricsManager();const t=e.getAbsoluteMetrics(),i=e.getViewMetrics();return e=e.getToolboxMetrics(),this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?this.toolboxPosition_===G.LEFT?e.width:i.width-this.getWidth():this.toolboxPosition_===G.LEFT?0:i.width:this.toolboxPosition_===G.LEFT?0:i.width+t.left-this.getWidth()}getY(){return 0}position(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var e=this.targetWorkspace.getMetricsManager().getViewMetrics();this.height_=e.height;var t=this.getWidth()-this.CORNER_RADIUS;this.setBackgroundPath(t,e.height-2*this.CORNER_RADIUS),e=this.getX(),t=this.getY(),this.positionAt_(this.getWidth(),this.getHeight(),e,t)}}setBackgroundPath(e,t){const i=this.toolboxPosition_===G.RIGHT;var s=e+this.CORNER_RADIUS;(s=["M "+(i?s:0)+",0"]).push("h",i?-e:e),s.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,i?0:1,i?-this.CORNER_RADIUS:this.CORNER_RADIUS,this.CORNER_RADIUS),s.push("v",Math.max(0,t)),s.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,i?0:1,i?this.CORNER_RADIUS:-this.CORNER_RADIUS,this.CORNER_RADIUS),s.push("h",i?e:-e),s.push("z"),this.svgBackground_.setAttribute("d",s.join(" "))}scrollToStart(){let e;null==(e=this.workspace_.scrollbar)||e.setY(0)}wheel_(e){var t=yo(e);if(t.y){const i=this.workspace_.getMetricsManager(),s=i.getScrollMetrics();let n;t=i.getViewMetrics().top-s.top+t.y,null==(n=this.workspace_.scrollbar)||n.setY(t),bs(this.workspace_),Vt()}e.preventDefault(),e.stopPropagation()}layout_(e){this.workspace_.scale=this.targetWorkspace.scale;var t=this.MARGIN;const i=this.RTL?t:t+this.tabWidth_;for(const s of e)s.getElement().moveBy(i,t),t+=s.getElement().getBoundingRectangle().getHeight()}isDragTowardWorkspace(e){e=Math.atan2(e.y,e.x)/Math.PI*180;const t=this.dragAngleRange_;return e<t&&e>-t||e<-180+t||e>180-t}getClientRect(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;const e=this.svgGroup_.getBoundingClientRect(),t=e.left;return this.toolboxPosition_===G.LEFT?new j(-1e9,1e9,-1e9,t+e.width):new j(-1e9,1e9,t,1e9)}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();let e=this.getContents().reduce((t,i)=>Math.max(t,i.getElement().getBoundingRectangle().getWidth()),0);if(e+=1.5*this.MARGIN+this.tabWidth_,e*=this.workspace_.scale,e+=be.scrollbarThickness,this.getWidth()!==e){if(this.RTL)for(const t of this.getContents()){const i=t.getElement().getBoundingRectangle().left,s=e/this.workspace_.scale-t.getElement().getBoundingRectangle().getWidth()-this.MARGIN-this.tabWidth_;t.getElement().moveBy(s-i,0)}this.targetWorkspace.scrollbar||this.autoClose||this.targetWorkspace.getFlyout()!==this||this.toolboxPosition_!==G.LEFT||this.targetWorkspace.translate(this.targetWorkspace.scrollX+e,this.targetWorkspace.scrollY),this.width_=e,this.position(),this.targetWorkspace.resizeContents(),this.targetWorkspace.recordDragTargets()}}};Uu.registryName="verticalFlyout",U(x.FLYOUTS_VERTICAL_TOOLBOX,gt,Uu);var Eg=class extends Ql{constructor(e){super(e),this.horizontalLayout=!0}setMetrics_(e){if(this.isVisible()){var t=this.workspace_.getMetricsManager(),i=t.getScrollMetrics(),s=t.getViewMetrics();t=t.getAbsoluteMetrics(),"number"==typeof e.x&&(this.workspace_.scrollX=-(i.left+(i.width-s.width)*e.x)),this.workspace_.translate(this.workspace_.scrollX+t.left,this.workspace_.scrollY+t.top)}}getX(){return 0}getY(){if(!this.isVisible())return 0;var e=this.targetWorkspace.getMetricsManager();const t=e.getAbsoluteMetrics(),i=e.getViewMetrics();e=e.getToolboxMetrics();const s=this.toolboxPosition_===G.TOP;return this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?s?e.height:i.height-this.getHeight():s?0:i.height:s?0:i.height+t.top-this.getHeight()}position(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var e=this.targetWorkspace.getMetricsManager().getViewMetrics();this.width_=e.width,e=e.width-2*this.CORNER_RADIUS;var t=this.getHeight()-this.CORNER_RADIUS;this.setBackgroundPath(e,t),e=this.getX(),t=this.getY(),this.positionAt_(this.getWidth(),this.getHeight(),e,t)}}setBackgroundPath(e,t){const i=this.toolboxPosition_===G.TOP,s=["M 0,"+(i?0:this.CORNER_RADIUS)];i?(s.push("h",e+2*this.CORNER_RADIUS),s.push("v",t),s.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,this.CORNER_RADIUS),s.push("h",-e),s.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,-this.CORNER_RADIUS)):(s.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,-this.CORNER_RADIUS),s.push("h",e),s.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,this.CORNER_RADIUS),s.push("v",t),s.push("h",-e-2*this.CORNER_RADIUS)),s.push("z"),this.svgBackground_.setAttribute("d",s.join(" "))}scrollToStart(){let e;null==(e=this.workspace_.scrollbar)||e.setX(this.RTL?1/0:0)}wheel_(e){var t=yo(e);if(t=t.x||t.y){const i=this.workspace_.getMetricsManager(),s=i.getScrollMetrics();let n;t=i.getViewMetrics().left-s.left+t,null==(n=this.workspace_.scrollbar)||n.setX(t),bs(this.workspace_),Vt()}e.preventDefault(),e.stopPropagation()}layout_(e){this.workspace_.scale=this.targetWorkspace.scale;const t=this.MARGIN;let i=t+this.tabWidth_;this.RTL&&(e=e.reverse());for(const s of e)e=s.getElement().getBoundingRectangle(),e=this.RTL?i+e.getWidth():i,s.getElement().moveBy(e,t),i+=s.getElement().getBoundingRectangle().getWidth()}isDragTowardWorkspace(e){e=Math.atan2(e.y,e.x)/Math.PI*180;const t=this.dragAngleRange_;return e<90+t&&e>90-t||e>-90-t&&e<-90+t}getClientRect(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;const e=this.svgGroup_.getBoundingClientRect(),t=e.top;return this.toolboxPosition_===G.TOP?new j(-1e9,t+e.height,-1e9,1e9):new j(t,1e9,-1e9,1e9)}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();let e=this.getContents().reduce((t,i)=>Math.max(t,i.getElement().getBoundingRectangle().getHeight()),0);e+=1.5*this.MARGIN,e*=this.workspace_.scale,e+=be.scrollbarThickness,this.getHeight()!==e&&(this.targetWorkspace.scrollbar||this.autoClose||this.targetWorkspace.getFlyout()!==this||this.toolboxPosition_!==G.TOP||this.targetWorkspace.translate(this.targetWorkspace.scrollX,this.targetWorkspace.scrollY+e),this.height_=e,this.position(),this.targetWorkspace.resizeContents(),this.targetWorkspace.recordDragTargets())}};U(x.FLYOUTS_HORIZONTAL_TOOLBOX,gt,Eg);var $r=class extends Ve{constructor(e,t,i,s,n){super(ee.SKIP_SETUP),this.defaultType="",this.variableTypes=[],this.variable=null,this.SERIALIZABLE=!0,this.menuGenerator_=$r.dropdownCreate,this.defaultVariableName="string"==typeof e?e:"",this.size_=new Y(0,0),e!==ee.SKIP_SETUP&&(n?this.configure_(n):this.setTypes(i,s),t&&this.setValidator(t))}configure_(e){super.configure_(e),this.setTypes(e.variableTypes,e.defaultType)}initModel(){var e=this.getSourceBlock();if(!e)throw new Te;this.variable||(e=o.getOrCreateVariablePackage$$module$build$src$core$variables(e.workspace,null,this.defaultVariableName,this.defaultType),this.doValueUpdate_(e.getId()))}initView(){super.initView(),R(this.fieldGroup_,"blocklyVariableField")}shouldAddBorderRect_(){const e=this.getSourceBlock();if(!e)throw new Te;return super.shouldAddBorderRect_()&&(!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||"variables_get"!==e.type)}fromXml(e){var t=this.getSourceBlock();if(!t)throw new Te;const i=e.getAttribute("id"),s=e.textContent,n=e.getAttribute("variabletype")||e.getAttribute("variableType")||"";if(t=o.getOrCreateVariablePackage$$module$build$src$core$variables(t.workspace,i,s,n),null!==n&&n!==t.getType())throw Error("Serialized variable type with id '"+t.getId()+"' had type "+t.getType()+", and does not match variable field that references it: "+nt(e)+".");this.setValue(t.getId())}toXml(e){return this.initModel(),e.id=this.variable.getId(),e.textContent=this.variable.getName(),this.variable.getType()&&e.setAttribute("variabletype",this.variable.getType()),e}saveState(e){var t=this.saveLegacyState($r);return null!==t||(this.initModel(),t={id:this.variable.getId()},e&&(t.name=this.variable.getName(),t.type=this.variable.getType())),t}loadState(e){const t=this.getSourceBlock();if(!t)throw new Te;this.loadLegacyState($r,e)||(e=o.getOrCreateVariablePackage$$module$build$src$core$variables(t.workspace,e.id||null,e.name,e.type||""),this.setValue(e.getId()))}setSourceBlock(e){if(e.isShadow())throw Error("Variable fields are not allowed to exist on shadow blocks.");super.setSourceBlock(e)}getValue(){return this.variable?this.variable.getId():null}getText(){return this.variable?this.variable.getName():""}getVariable(){return this.variable}getDefaultType(){return this.defaultType}getValidator(){return this.variable?this.validator_:null}doClassValidation_(e){if(null===e)return null;var t=this.getSourceBlock();if(!t)throw new Te;return(t=o.getVariable$$module$build$src$core$variables(t.workspace,e))?(t=t.getType(),this.typeIsAllowed(t)?e:(console.warn("Variable type doesn't match this field!  Type was "+t),null)):(console.warn("Variable id doesn't point to a real variable! ID was "+e),null)}doValueUpdate_(e){const t=this.getSourceBlock();if(!t)throw new Te;this.variable=o.getVariable$$module$build$src$core$variables(t.workspace,e),super.doValueUpdate_(e)}typeIsAllowed(e){const t=this.getVariableTypes();if(!t)return!0;for(let i=0;i<t.length;i++)if(e===t[i])return!0;return!1}getVariableTypes(){if(this.variableTypes)return this.variableTypes;if(!this.sourceBlock_||this.sourceBlock_.isDeadOrDying())return[""];let e=this.sourceBlock_.workspace.getVariableMap().getTypes();if(this.sourceBlock_.isInFlyout){const t=this.sourceBlock_.workspace.getPotentialVariableMap();if(!t)return e;e=Array.from(new Set([...e,...t.getTypes()]))}return e}setTypes(e=null,t=""){var i=this.getText();if(Array.isArray(e)){if(0===e.length)throw Error(`'variableTypes' of field variable ${i} was an empty list. If you want to include all variable types, pass 'null' instead.`);i=!1;for(let s=0;s<e.length;s++)e[s]===t&&(i=!0);if(!i)throw Error("Invalid default type '"+t+"' in the definition of a FieldVariable")}else if(null!==e)throw Error(`'variableTypes' was not an array or null in the definition of FieldVariable ${i}`);this.defaultType=t,this.variableTypes=e}refreshVariableName(){this.forceRerender()}onItemSelected_(e,t){if(e=t.getValue(),this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()){if(e===zl&&this.variable)return void o.renameVariable$$module$build$src$core$variables(this.sourceBlock_.workspace,this.variable);if(e===jl&&this.variable)return e=this.variable.getWorkspace(),void o.deleteVariable$$module$build$src$core$variables(e,this.variable,this.sourceBlock_)}this.setValue(e)}referencesVariables(){return!0}static fromJson(e){return new this(ge(e.variable),void 0,void 0,void 0,e)}static dropdownCreate(){if(!this.variable)throw Error("Tried to call dropdownCreate on a variable field with no variable selected.");const e=this.getText();let t=[];var i=this.getSourceBlock();if(i&&!i.isDeadOrDying()){i=i.workspace;const l=this.getVariableTypes();for(let u=0;u<l.length;u++){const $=l[u],C=i.getVariableMap().getVariablesOfType($);if(t=t.concat(C),i.isFlyout){var s=void 0,n=void 0;t=t.concat(null!=(n=null==(s=i.getPotentialVariableMap())?void 0:s.getVariablesOfType($))?n:[])}}}for(t.sort(ds),s=[],n=0;n<t.length;n++)s[n]=[t[n].getName(),t[n].getId()];return s.push([o.Msg$$module$build$src$core$msg.RENAME_VARIABLE,zl]),o.Msg$$module$build$src$core$msg.DELETE_VARIABLE&&s.push([o.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",e),jl]),s}};bt("field_variable",$r);var Hu=class extends Js{constructor(e,t,i,s,n,l){super(ee.SKIP_SETUP),this.min_=-1/0,this.max_=1/0,this.precision_=0,this.decimalPlaces=null,this.spellcheck_=!1,e!==ee.SKIP_SETUP&&(l?this.configure_(l):this.setConstraints(t,i,s),this.setValue(e),n&&this.setValidator(n))}configure_(e){super.configure_(e),this.setMinInternal(e.min),this.setMaxInternal(e.max),this.setPrecisionInternal(e.precision)}setConstraints(e,t,i){this.setMinInternal(e),this.setMaxInternal(t),this.setPrecisionInternal(i),this.setValue(this.getValue())}setMin(e){this.setMinInternal(e),this.setValue(this.getValue())}setMinInternal(e){null==e?this.min_=-1/0:(e=Number(e),isNaN(e)||(this.min_=e))}getMin(){return this.min_}setMax(e){this.setMaxInternal(e),this.setValue(this.getValue())}setMaxInternal(e){null==e?this.max_=1/0:(e=Number(e),isNaN(e)||(this.max_=e))}getMax(){return this.max_}setPrecision(e){this.setPrecisionInternal(e),this.setValue(this.getValue())}setPrecisionInternal(e){this.precision_=Number(e)||0;let t=String(this.precision_);t.includes("e")&&(t=this.precision_.toLocaleString("en-US",{maximumFractionDigits:20}));const i=t.indexOf(".");this.decimalPlaces=-1===i?e?0:null:t.length-i-1}getPrecision(){return this.precision_}doClassValidation_(e){return null===e||(e=(e=(e=`${e}`.replace(/O/gi,"0")).replace(/,/g,"")).replace(/infinity/i,"Infinity"),e=Number(e||0),isNaN(e))?null:(e=Math.min(Math.max(e,this.min_),this.max_),this.precision_&&isFinite(e)&&(e=Math.round(e/this.precision_)*this.precision_),null!==this.decimalPlaces&&(e=Number(e.toFixed(this.decimalPlaces))),e)}widgetCreate_(){const e=super.widgetCreate_();return this.min_>-1/0&&(e.min=`${this.min_}`,ye(e,xe.VALUEMIN,this.min_)),this.max_<1/0&&(e.max=`${this.max_}`,ye(e,xe.VALUEMAX,this.max_)),e}initView(){super.initView(),this.fieldGroup_&&R(this.fieldGroup_,"blocklyNumberField")}static fromJson(e){return new this(e.value,void 0,void 0,void 0,void 0,e)}};bt("field_number",Hu),Hu.prototype.DEFAULT_VALUE=0;var vg=class extends Vi{constructor(e,t,i){super(String(e??""),t,i),this.EDITABLE=!1,this.SERIALIZABLE=!0}static fromJson(e){return new this(ge(e.text),void 0,e)}};bt("field_label_serializable",vg);var Xi=class extends ee{constructor(e,t,i){super(ee.SKIP_SETUP),this.SERIALIZABLE=!0,this.value_=this.value_,this.checkChar=Xi.CHECK_CHAR,e!==ee.SKIP_SETUP&&(i&&this.configure_(i),this.setValue(e),t&&this.setValidator(t))}configure_(e){super.configure_(e),e.checkCharacter&&(this.checkChar=e.checkCharacter)}saveState(){const e=this.saveLegacyState(Xi);return null!==e?e:this.getValueBoolean()}initView(){super.initView();const e=this.getTextElement();R(this.fieldGroup_,"blocklyCheckboxField"),e.style.display=this.value_?"block":"none"}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_(this.getConstants().FIELD_CHECKBOX_X_OFFSET)}getDisplayText_(){return this.checkChar}setCheckCharacter(e){this.checkChar=e||Xi.CHECK_CHAR,this.forceRerender()}showEditor_(){this.setValue(!this.value_)}doClassValidation_(e){return!0===e||"TRUE"===e?"TRUE":!1===e||"FALSE"===e?"FALSE":null}doValueUpdate_(e){this.value_=this.convertValueToBool(e),this.textElement_&&(this.textElement_.style.display=this.value_?"block":"none")}getValue(){return this.value_?"TRUE":"FALSE"}getValueBoolean(){return this.value_}getText(){return String(this.convertValueToBool(this.value_))}convertValueToBool(e){return"string"==typeof e?"TRUE"===e:!!e}static fromJson(e){return new this(e.checked,void 0,e)}};Xi.CHECK_CHAR="\u2713",bt("field_checkbox",Xi),Xi.prototype.DEFAULT_VALUE=!1;var yg=class{constructor(e,t){this.draggable=e,this.workspace=t,this.dragTarget=null,this.startLoc=e.getRelativeToSurfaceXY()}onDragStart(e){o.getGroup$$module$build$src$core$events$utils()||o.setGroup$$module$build$src$core$events$utils(!0),this.draggable.startDrag(e)}onDrag(e,t){this.moveDraggable(e,t),t=this.getRoot(this.draggable),Xe(t)&&t.setDeleteStyle(this.wouldDeleteDraggable(e,t)),this.updateDragTarget(e)}updateDragTarget(e){e=this.workspace.getDragTarget(e);const t=this.getRoot(this.draggable);if(this.dragTarget!==e){let i;null==(i=this.dragTarget)||i.onDragExit(t),e?.onDragEnter(t)}e?.onDragOver(t),this.dragTarget=e}moveDraggable(e,t){t=this.pixelsToWorkspaceUnits(t),t=k.sum(this.startLoc,t),this.draggable.drag(t,e)}wouldDeleteDraggable(e,t){return!(!(e=this.workspace.getDragTarget(e))||!this.workspace.getComponentManager().hasCapability(e.id,de.Capability.DELETE_AREA))&&e.wouldDelete(t)}onDragEnd(e){const t=o.getGroup$$module$build$src$core$events$utils();var i=this.workspace.getDragTarget(e);const s=this.getRoot(this.draggable);if(i){let n;null==(n=this.dragTarget)||n.onDrop(s)}this.shouldReturnToStart(e,s)&&this.draggable.revertDrag(),(i=Xe(s)&&this.wouldDeleteDraggable(e,s))&&this.draggable instanceof se&&wi(this.draggable.getRootBlock()),this.draggable.endDrag(e),i&&Xe(s)&&(o.setGroup$$module$build$src$core$events$utils(t),s.dispose()),o.setGroup$$module$build$src$core$events$utils(!1),!i&&xo(this.draggable)&&o.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.draggable)}getRoot(e){return e instanceof se?e.getRootBlock():e}shouldReturnToStart(e,t){return!!(e=this.workspace.getDragTarget(e))&&e.shouldPreventMove(t)}pixelsToWorkspaceUnits(e){return e=new k(e.x/this.workspace.scale,e.y/this.workspace.scale),this.workspace.isMutator&&e.scale(1/this.workspace.options.parentWorkspace.scale),e}};U(x.BLOCK_DRAGGER,gt,yg);var hc={};hc.BlockDragStrategy=Sp,hc.BubbleDragStrategy=wp,hc.CommentDragStrategy=vp,hc.Dragger=yg;var Zu=class extends Yt{constructor(e,t,i){super(e?e.workspace.id:void 0),this.type=f.BLOCK_DRAG,e&&(this.blockId=e.id,this.isStart=t,this.blocks=i)}toJson(){const e=super.toJson();if(void 0===this.isStart)throw Error("Whether this event is the start of a drag is undefined. Either pass the value to the constructor, or call fromJson");if(void 0===this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");return e.isStart=this.isStart,e.blockId=this.blockId,e.blocks=this.blocks,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new Zu)).isStart=e.isStart,t.blockId=e.blockId,t.blocks=e.blocks,t}};U(x.EVENT,f.BLOCK_DRAG,Zu);var Vu=class extends Bi{constructor(e,t,i,s){super(e),this.type=f.BLOCK_FIELD_INTERMEDIATE_CHANGE,this.recordUndo=!1,e&&(this.name=t,this.oldValue=i,this.newValue=s)}toJson(){const e=super.toJson();if(!this.name)throw Error("The changed field name is undefined. Either pass a name to the constructor, or call fromJson.");return e.name=this.name,e.oldValue=this.oldValue,e.newValue=this.newValue,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new Vu)).name=e.name,t.oldValue=e.oldValue,t.newValue=e.newValue,t}isNull(){return this.oldValue===this.newValue}run(e){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");if(!(t=t.getBlockById(this.blockId)))throw Error("The associated block is undefined. Either pass a block to the constructor, or call fromJson");e=e?this.newValue:this.oldValue,(t=t.getField(this.name))?t.setValue(e):console.warn("Can't set non-existent field: "+this.name)}};U(x.EVENT,f.BLOCK_FIELD_INTERMEDIATE_CHANGE,Vu);var Gu=class extends Bi{constructor(e){super(e),this.type=f.BLOCK_MOVE,e&&(e.isShadow()&&(this.recordUndo=!1),e=this.currentLocation(),this.oldParentId=e.parentId,this.oldInputName=e.inputName,this.oldCoordinate=e.coordinate)}toJson(){const e=super.toJson();return e.oldParentId=this.oldParentId,e.oldInputName=this.oldInputName,this.oldCoordinate&&(e.oldCoordinate=`${Math.round(this.oldCoordinate.x)}, ${Math.round(this.oldCoordinate.y)}`),e.newParentId=this.newParentId,e.newInputName=this.newInputName,this.newCoordinate&&(e.newCoordinate=`${Math.round(this.newCoordinate.x)}, ${Math.round(this.newCoordinate.y)}`),this.reason&&(e.reason=this.reason),this.recordUndo||(e.recordUndo=this.recordUndo),e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new Gu)).oldParentId=e.oldParentId,t.oldInputName=e.oldInputName,e.oldCoordinate&&(i=e.oldCoordinate.split(","),t.oldCoordinate=new k(Number(i[0]),Number(i[1]))),t.newParentId=e.newParentId,t.newInputName=e.newInputName,e.newCoordinate&&(i=e.newCoordinate.split(","),t.newCoordinate=new k(Number(i[0]),Number(i[1]))),void 0!==e.reason&&(t.reason=e.reason),void 0!==e.recordUndo&&(t.recordUndo=e.recordUndo),t}recordNew(){const e=this.currentLocation();this.newParentId=e.parentId,this.newInputName=e.inputName,this.newCoordinate=e.coordinate}setReason(e){this.reason=e}currentLocation(){var e=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var t=e.getBlockById(this.blockId);if(!t)throw Error("The block associated with the block move event could not be found");e={};const i=t.getParent();return i?(e.parentId=i.id,(t=i.getInputWithBlock(t))&&(e.inputName=t.name)):e.coordinate=t.getRelativeToSurfaceXY(),e}isNull(){return this.oldParentId===this.newParentId&&this.oldInputName===this.newInputName&&k.equals(this.oldCoordinate,this.newCoordinate)}run(e){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var i=t.getBlockById(this.blockId);if(i){var s=e?this.newParentId:this.oldParentId,n=e?this.newInputName:this.oldInputName;if(e=e?this.newCoordinate:this.oldCoordinate,s){var l=t.getBlockById(s);if(!l)return void console.warn("Can't connect to non-existent block: "+s)}if(i.getParent()&&i.unplug(),e)n=i.getRelativeToSurfaceXY(),i.moveBy(e.x-n.x,e.y-n.y,this.reason);else{let u,$;(!(t=i.outputConnection)||i.previousConnection&&i.previousConnection.isConnected())&&(t=i.previousConnection),i=null==($=t)?void 0:$.type,n?(i=l.getInput(n))&&(u=i.connection):i===M.PREVIOUS_STATEMENT&&(u=l.nextConnection),u&&t?t.connect(u):console.warn("Can't connect to non-existent input: "+n)}}else console.warn("Can't move non-existent block: "+this.blockId)}};U(x.EVENT,f.BLOCK_MOVE,Gu);var qu,Wu=class extends Yt{constructor(e,t,i){super(e?e.workspace.id:void 0),this.type=f.BUBBLE_OPEN,e&&(this.blockId=e.id,this.isOpen=t,this.bubbleType=i)}toJson(){const e=super.toJson();if(void 0===this.isOpen)throw Error("Whether this event is for opening the bubble is undefined. Either pass the value to the constructor, or call fromJson");if(!this.bubbleType)throw Error("The type of bubble is undefined. Either pass the value to the constructor, or call fromJson");return e.isOpen=this.isOpen,e.bubbleType=this.bubbleType,e.blockId=this.blockId||"",e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new Wu)).isOpen=e.isOpen,t.bubbleType=e.bubbleType,t.blockId=e.blockId,t}};(function(e){e.MUTATOR="mutator",e.COMMENT="comment",e.WARNING="warning"})(qu||(qu={})),U(x.EVENT,f.BUBBLE_OPEN,Wu);var Gm={};Gm.BubbleOpen=Wu,Gm.BubbleType=qu;var so=class extends Ds{constructor(e){super(),this.isBlank=!e,e&&(this.commentId=e.id,this.workspaceId=e.workspace.id,this.group=o.getGroup$$module$build$src$core$events$utils(),this.recordUndo=Se())}toJson(){const e=super.toJson();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");return e.commentId=this.commentId,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new so)).commentId=e.commentId,t}static CommentCreateDeleteHelper(e,t){const i=e.getEventWorkspace_();if(t){if(!e.json)throw Error("Encountered a comment event without proper json");Tn(e.json,i)}else{if(!e.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");(t=i.getCommentById(e.commentId))?t.dispose():console.warn("Can't delete non-existent comment: "+e.commentId)}}},zu=class extends so{constructor(e,t,i){super(e),this.type=f.COMMENT_CHANGE,e&&(this.oldContents_=typeof t>"u"?"":t,this.newContents_=typeof i>"u"?"":i)}toJson(){const e=super.toJson();if(!this.oldContents_)throw Error("The old contents is undefined. Either pass a value to the constructor, or call fromJson");if(!this.newContents_)throw Error("The new contents is undefined. Either pass a value to the constructor, or call fromJson");return e.oldContents=this.oldContents_,e.newContents=this.newContents_,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new zu)).oldContents_=e.oldContents,t.newContents_=e.newContents,t}isNull(){return this.oldContents_===this.newContents_}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(t=t.getCommentById(this.commentId)){var i=e?this.newContents_:this.oldContents_;if(void 0===i)throw Error(e?"The new contents is undefined. Either pass a value to the constructor, or call fromJson":"The old contents is undefined. Either pass a value to the constructor, or call fromJson");t.setText(i)}else console.warn("Can't change non-existent comment: "+this.commentId)}};U(x.EVENT,f.COMMENT_CHANGE,zu);var ju=class extends so{constructor(e,t){super(e),this.newCollapsed=t,this.type=f.COMMENT_COLLAPSE}toJson(){const e=super.toJson();if(void 0===this.newCollapsed)throw Error("The new collapse value undefined. Either call recordNew, or call fromJson");return e.newCollapsed=this.newCollapsed,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new ju)).newCollapsed=e.newCollapsed,t}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");(t=t.getCommentById(this.commentId))?t.setCollapsed(e?!!this.newCollapsed:!this.newCollapsed):console.warn("Can't collapse or uncollapse non-existent comment: "+this.commentId)}};U(x.EVENT,f.COMMENT_COLLAPSE,ju);var Yu=class extends so{constructor(e){super(e),this.type=f.COMMENT_CREATE,e&&(this.xml=p(e),this.json=hi(e,{addCoordinates:!0}))}toJson(){const e=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.json)throw Error("The comment JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.xml=nt(this.xml),e.json=this.json,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new Yu)).xml=o.textToDom$$module$build$src$core$utils$xml(e.xml),t.json=e.json,t}run(e){so.CommentCreateDeleteHelper(this,e)}};U(x.EVENT,f.COMMENT_CREATE,Yu);var Xu=class extends so{constructor(e){super(e),this.type=f.COMMENT_DELETE,e&&(this.xml=p(e),this.json=hi(e,{addCoordinates:!0}))}run(e){so.CommentCreateDeleteHelper(this,!e)}toJson(){const e=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.json)throw Error("The comment JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.xml=nt(this.xml),e.json=this.json,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new Xu)).xml=o.textToDom$$module$build$src$core$utils$xml(e.xml),t.json=e.json,t}};U(x.EVENT,f.COMMENT_DELETE,Xu);var Ku=class extends Yt{constructor(e,t){super(e?e.workspace.id:void 0),this.type=f.COMMENT_DRAG,e&&(this.commentId=e.id,this.isStart=t)}toJson(){const e=super.toJson();if(void 0===this.isStart)throw Error("Whether this event is the start of a drag is undefined. Either pass the value to the constructor, or call fromJson");if(void 0===this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");return e.isStart=this.isStart,e.commentId=this.commentId,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new Ku)).isStart=e.isStart,t.commentId=e.commentId,t}};U(x.EVENT,f.COMMENT_DRAG,Ku);var Ju=class extends so{constructor(e){super(e),this.type=f.COMMENT_MOVE,e&&(this.comment_=e,this.oldCoordinate_=e.getRelativeToSurfaceXY())}recordNew(){if(this.newCoordinate_)throw Error("Tried to record the new position of a comment on the same event twice.");if(!this.comment_)throw Error("The comment is undefined. Pass a comment to the constructor if you want to use the record functionality");this.newCoordinate_=this.comment_.getRelativeToSurfaceXY()}setReason(e){this.reason=e}setOldCoordinate(e){this.oldCoordinate_=e}toJson(){const e=super.toJson();if(!this.oldCoordinate_)throw Error("The old comment position is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.newCoordinate_)throw Error("The new comment position is undefined. Either call recordNew, or call fromJson");return e.oldCoordinate=`${Math.round(this.oldCoordinate_.x)}, ${Math.round(this.oldCoordinate_.y)}`,e.newCoordinate=Math.round(this.newCoordinate_.x)+","+Math.round(this.newCoordinate_.y),e}static fromJson(e,t,i){return t=super.fromJson(e,t,i??new Ju),i=e.oldCoordinate.split(","),t.oldCoordinate_=new k(Number(i[0]),Number(i[1])),i=e.newCoordinate.split(","),t.newCoordinate_=new k(Number(i[0]),Number(i[1])),t}isNull(){return k.equals(this.oldCoordinate_,this.newCoordinate_)}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(t=t.getCommentById(this.commentId)){if(!(e=e?this.newCoordinate_:this.oldCoordinate_))throw Error("Either oldCoordinate_ or newCoordinate_ is undefined. Either pass a comment to the constructor and call recordNew, or call fromJson");t.moveTo(e)}else console.warn("Can't move non-existent comment: "+this.commentId)}};U(x.EVENT,f.COMMENT_MOVE,Ju);var Qu=class extends so{constructor(e){super(e),this.type=f.COMMENT_RESIZE,e&&(this.oldSize=e.getSize())}recordCurrentSizeAsNewSize(){if(this.newSize)throw Error("Tried to record the new size of a comment on the same event twice.");var e=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(!(e=e.getCommentById(this.commentId)))throw Error("The comment associated with the comment resize event could not be found");this.newSize=e.getSize()}toJson(){const e=super.toJson();if(!this.oldSize)throw Error("The old comment size is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.newSize)throw Error("The new comment size is undefined. Either call recordCurrentSizeAsNewSize, or call fromJson");return e.oldWidth=Math.round(this.oldSize.width),e.oldHeight=Math.round(this.oldSize.height),e.newWidth=Math.round(this.newSize.width),e.newHeight=Math.round(this.newSize.height),e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new Qu)).oldSize=new Y(e.oldWidth,e.oldHeight),t.newSize=new Y(e.newWidth,e.newHeight),t}isNull(){return Y.equals(this.oldSize,this.newSize)}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(t=t.getCommentById(this.commentId)){if(!(e=e?this.newSize:this.oldSize))throw Error("Either oldSize or newSize is undefined. Either pass a comment to the constructor and call recordCurrentSizeAsNewSize, or call fromJson");t.setSize(e)}else console.warn("Can't resize non-existent comment: "+this.commentId)}};U(x.EVENT,f.COMMENT_RESIZE,Qu);var ed=class extends Yt{constructor(e,t,i){super(i),this.type=f.TOOLBOX_ITEM_SELECT,this.oldItem=e??void 0,this.newItem=t??void 0}toJson(){const e=super.toJson();return e.oldItem=this.oldItem,e.newItem=this.newItem,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new ed)).oldItem=e.oldItem,t.newItem=e.newItem,t}};U(x.EVENT,f.TOOLBOX_ITEM_SELECT,ed);var td=class extends Ks{constructor(e,t,i){super(e),this.oldType=t,this.newType=i,this.type=f.VAR_TYPE_CHANGE}toJson(){const e=super.toJson();if(!this.oldType||!this.newType)throw Error("The variable's types are undefined. Either pass them to the constructor, or call fromJson");return e.oldType=this.oldType,e.newType=this.newType,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new td)).oldType=e.oldType,t.newType=e.newType,t}run(e){const t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.oldType||!this.newType)throw Error("The variable's types are undefined. Either pass them to the constructor, or call fromJson");const i=t.getVariableMap().getVariableById(this.varId);i&&(e?t.getVariableMap().changeVariableType(i,this.newType):t.getVariableMap().changeVariableType(i,this.oldType))}};U(x.EVENT,f.VAR_TYPE_CHANGE,td);var Wm,qm,zm,jm,Ym,Xm,Km,Jm,Qm,e_,t_,o_,i_,s_,n_,r_,l_,c_,a_,u_,d_,h_,p_,g_,O,Cg=class extends Ds{constructor(e){super(),this.isBlank=!0,this.recordUndo=!1,this.type=f.FINISHED_LOADING,this.isBlank=!!e,e&&(this.workspaceId=e.id)}};U(x.EVENT,f.FINISHED_LOADING,Cg),o.BLOCK_CHANGE$$module$build$src$core$events$events=f.BLOCK_CHANGE,o.BLOCK_CREATE$$module$build$src$core$events$events=f.BLOCK_CREATE,o.BLOCK_DELETE$$module$build$src$core$events$events=f.BLOCK_DELETE,Wm=f.BLOCK_DRAG,o.BLOCK_MOVE$$module$build$src$core$events$events=f.BLOCK_MOVE,qm=f.BLOCK_FIELD_INTERMEDIATE_CHANGE,zm=f.BUBBLE_OPEN,jm=f.BLOCK_CHANGE,Ym=f.CLICK,Xm=f.COMMENT_CHANGE,Km=f.COMMENT_CREATE,Jm=f.COMMENT_DELETE,Qm=f.COMMENT_MOVE,e_=f.COMMENT_RESIZE,t_=f.COMMENT_DRAG,o_=f.BLOCK_CREATE,i_=f.BLOCK_DELETE,s_=f.FINISHED_LOADING,n_=f.BLOCK_MOVE,r_=f.SELECTED,l_=f.THEME_CHANGE,c_=f.TOOLBOX_ITEM_SELECT,a_=f.TRASHCAN_OPEN,u_=f.UI,d_=f.VAR_CREATE,h_=f.VAR_DELETE,p_=f.VAR_RENAME,g_=f.VIEWPORT_CHANGE,(O={}).Abstract=Ds,O.BLOCK_CHANGE=o.BLOCK_CHANGE$$module$build$src$core$events$events,O.BLOCK_CREATE=o.BLOCK_CREATE$$module$build$src$core$events$events,O.BLOCK_DELETE=o.BLOCK_DELETE$$module$build$src$core$events$events,O.BLOCK_DRAG=Wm,O.BLOCK_FIELD_INTERMEDIATE_CHANGE=qm,O.BLOCK_MOVE=o.BLOCK_MOVE$$module$build$src$core$events$events,O.BUBBLE_OPEN=zm,O.BUMP_EVENTS=Vh,O.BlockBase=Bi,O.BlockChange=Fi,O.BlockCreate=su,O.BlockDelete=cu,O.BlockDrag=Zu,O.BlockFieldIntermediateChange=Vu,O.BlockMove=Gu,O.BubbleOpen=Wu,O.BubbleType=qu,O.CHANGE=jm,O.CLICK=Ym,O.COMMENT_CHANGE=Xm,O.COMMENT_CREATE=Km,O.COMMENT_DELETE=Jm,O.COMMENT_DRAG=t_,O.COMMENT_MOVE=Qm,O.COMMENT_RESIZE=e_,O.CREATE=o_,O.Click=La,O.ClickTarget=Da,O.CommentBase=so,O.CommentChange=zu,O.CommentCollapse=ju,O.CommentCreate=Yu,O.CommentDelete=Xu,O.CommentDrag=Ku,O.CommentMove=Ju,O.CommentResize=Qu,O.DELETE=i_,O.FINISHED_LOADING=s_,O.FinishedLoading=Cg,O.MOVE=n_,O.SELECTED=r_,O.Selected=lu,O.THEME_CHANGE=l_,O.TOOLBOX_ITEM_SELECT=c_,O.TRASHCAN_OPEN=a_,O.ThemeChange=nu,O.ToolboxItemSelect=ed,O.TrashcanOpen=Nu,O.UI=u_,O.UiBase=Yt,O.VAR_CREATE=d_,O.VAR_DELETE=h_,O.VAR_RENAME=p_,O.VIEWPORT_CHANGE=g_,O.VarBase=Ks,O.VarCreate=Ru,O.VarDelete=Ou,O.VarRename=Mu,O.VarTypeChange=td,O.ViewportChange=ru,O.clearPendingUndo=li,O.disable=o.disable$$module$build$src$core$events$utils,O.disableOrphans=is,O.enable=o.enable$$module$build$src$core$events$utils,O.filter=ri,O.fire=D,O.fromJson=os,O.get=P,O.getDescendantIds=Io,O.getGroup=o.getGroup$$module$build$src$core$events$utils,O.getRecordUndo=Se,O.isEnabled=ne,O.setGroup=o.setGroup$$module$build$src$core$events$utils,O.setRecordUndo=o.setRecordUndo$$module$build$src$core$events$utils;var fo={};fo.BottomRow=$g,fo.ConstantProvider=pg,fo.Drawer=gg,fo.PathObject=fg,fo.RenderInfo=bg,fo.Renderer=Fu,fo.RightConnectionShape=mg,fo.StatementInput=dc,fo.TopRow=_g,Lh();var Be={};Be.registerCleanup=fh,Be.registerCollapse=Eh,Be.registerCollapseExpandBlock=wh,Be.registerComment=xh,Be.registerCommentCreate=Nh,Be.registerCommentDelete=Oh,Be.registerCommentDuplicate=Mh,Be.registerCommentOptions=i$,Be.registerDefaultOptions=Lh,Be.registerDelete=Ah,Be.registerDeleteAll=Ch,Be.registerDisable=Sh,Be.registerDuplicate=Ih,Be.registerExpand=vh,Be.registerHelp=Rh,Be.registerInline=kh,Be.registerRedo=bh,Be.registerUndo=_h;var Ig="button",xg=class{load(e,t){return(e=new Qe(t.getWorkspace(),t.targetWorkspace,e,!1)).show(),new js(e,Ig)}gapForItem(e,t){return t}disposeItem(e){(e=e.getElement())instanceof Qe&&e.dispose()}getType(){return Ig}};U(x.FLYOUT_INFLATER,Ig,xg);var pc={};pc.Bubble=te,pc.MiniWorkspaceBubble=$o,pc.TextBubble=Ap,pc.TextInputBubble=Eu;var kg="block",wg=class{constructor(){this.permanentlyDisabledBlocks=new Set,this.listeners=new Map,this.capacityWrapper=this.filterFlyoutBasedOnCapacity.bind(this)}load(e,t){return this.setFlyout(t),(e=this.createBlock(e,t.getWorkspace())).isEnabled()?this.updateStateBasedOnCapacity(e):this.permanentlyDisabledBlocks.add(e),e.getDescendants(!1).forEach(i=>i.isInFlyout=!0),this.addBlockListeners(e),new js(e,kg)}createBlock(e,t){return e.blockxml?(e="string"==typeof e.blockxml?o.textToDom$$module$build$src$core$utils$xml(e.blockxml):e.blockxml,t=At(e,t)):(void 0===e.enabled&&(e.enabled="true"!==e.disabled&&!0!==e.disabled),void 0===e.disabledReasons&&!1===e.enabled&&(e.disabledReasons=[Mt]),"x"in e&&delete e.x,"y"in e&&delete e.y,t=mi(e,t)),t}gapForItem(e,t){let i;return e.gap?i=parseInt(String(e.gap)):e.blockxml&&(e="string"==typeof e.blockxml?o.textToDom$$module$build$src$core$utils$xml(e.blockxml):e.blockxml,i=parseInt(e.getAttribute("gap"))),!i||isNaN(i)?t:i}disposeItem(e){(e=e.getElement())instanceof se&&(this.removeListeners(e.id),e.dispose(!1,!1))}removeListeners(e){let t;(null!=(t=this.listeners.get(e))?t:[]).forEach(i=>J(i)),this.listeners.delete(e)}setFlyout(e){if(this.flyout!==e){if(this.flyout){let i;null==(i=this.flyout.targetWorkspace)||i.removeChangeListener(this.capacityWrapper)}var t;this.flyout=e,null==(t=this.flyout.targetWorkspace)||t.addChangeListener(this.capacityWrapper)}}updateStateBasedOnCapacity(e){let t,i;const s=null==(t=this.flyout)||null==(i=t.targetWorkspace)?void 0:i.isCapacityAvailable(ls(e));for(;e;)e.setDisabledReason(!s,"WORKSPACE_AT_BLOCK_CAPACITY"),e=e.getNextBlock()}addBlockListeners(e){const t=[];t.push(N(e.getSvgRoot(),"pointerdown",e,i=>{let s,n;const l=null==(s=this.flyout)||null==(n=s.targetWorkspace)?void 0:n.getGesture(i);l&&this.flyout&&(l.setStartBlock(e),l.handleFlyoutStart(i,this.flyout))})),t.push(Ye(e.getSvgRoot(),"pointermove",null,()=>{let i,s;null!=(i=this.flyout)&&null!=(s=i.targetWorkspace)&&s.isDragging()||e.addSelect()})),t.push(Ye(e.getSvgRoot(),"pointerleave",null,()=>{let i,s;null!=(i=this.flyout)&&null!=(s=i.targetWorkspace)&&s.isDragging()||e.removeSelect()})),this.listeners.set(e.id,t)}filterFlyoutBasedOnCapacity(e){!this.flyout||e&&e.type!==f.BLOCK_CREATE&&e.type!==f.BLOCK_DELETE||this.flyout.getWorkspace().getTopBlocks(!1).forEach(t=>{this.permanentlyDisabledBlocks.has(t)||this.updateStateBasedOnCapacity(t)})}getType(){return kg}};U(x.FLYOUT_INFLATER,kg,wg);var Sg=class extends nc{constructor(){super(),this.FIELD_TEXT_BASELINE_CENTER=!1,this.DARK_PATH_OFFSET=1,this.MAX_BOTTOM_WIDTH=30,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT/2}getCSS_(e){return super.getCSS_(e).concat([`${e} .blocklyInsertionMarker>.blocklyPathLight,`,`${e} .blocklyInsertionMarker>.blocklyPathDark {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"])}},Ag=class{constructor(e){this.inlineSteps_=this.steps_="",this.info_=e,this.RTL_=this.info_.RTL,e=e.getRenderer(),this.constants_=e.getConstants(),this.highlightConstants_=e.getHighlightConstants(),this.highlightOffset=this.highlightConstants_.OFFSET,this.outsideCornerPaths_=this.highlightConstants_.OUTSIDE_CORNER,this.insideCornerPaths_=this.highlightConstants_.INSIDE_CORNER,this.puzzleTabPaths_=this.highlightConstants_.PUZZLE_TAB,this.notchPaths_=this.highlightConstants_.NOTCH,this.startPaths_=this.highlightConstants_.START_HAT,this.jaggedTeethPaths_=this.highlightConstants_.JAGGED_TEETH}getPath(){return this.steps_+"\n"+this.inlineSteps_}drawTopCorner(e){this.steps_+=ae(e.xPos,this.info_.startY);for(let i,t=0;i=e.elements[t];t++)m.isLeftSquareCorner(i)?this.steps_+=this.highlightConstants_.START_POINT:m.isLeftRoundedCorner(i)?this.steps_+=this.outsideCornerPaths_.topLeft(this.RTL_):m.isPreviousConnection(i)?this.steps_+=this.notchPaths_.pathLeft:m.isHat(i)?this.steps_+=this.startPaths_.path(this.RTL_):m.isSpacer(i)&&0!==i.width&&(this.steps_+=B("H",i.xPos+i.width-this.highlightOffset));this.steps_+=B("H",e.xPos+e.width-this.highlightOffset)}drawJaggedEdge_(e){this.info_.RTL&&(this.steps_+=this.jaggedTeethPaths_.pathLeft+B("v",e.height-this.jaggedTeethPaths_.height-this.highlightOffset))}drawValueInput(e){const t=e.getLastInput();if(this.RTL_){const i=e.height-t.connectionHeight;this.steps_+=Ie(t.xPos+t.width-this.highlightOffset,e.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)+B("v",i)}else this.steps_+=Ie(t.xPos+t.width,e.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)}drawStatementInput(e){const t=e.getLastInput();if(t)if(this.RTL_){const i=e.height-2*this.insideCornerPaths_.height;this.steps_+=Ie(t.xPos,e.yPos)+this.insideCornerPaths_.pathTop(this.RTL_)+B("v",i)+this.insideCornerPaths_.pathBottom(this.RTL_)+rt(e.width-t.xPos-this.insideCornerPaths_.width,0)}else this.steps_+=Ie(t.xPos,e.yPos+e.height)+this.insideCornerPaths_.pathBottom(this.RTL_)+rt(e.width-t.xPos-this.insideCornerPaths_.width,0)}drawRightSideRow(e){const t=e.xPos+e.width-this.highlightOffset;e instanceof ku&&e.followsStatement&&(this.steps_+=B("H",t)),this.RTL_&&(this.steps_+=B("H",t),e.height>this.highlightOffset&&(this.steps_+=B("V",e.yPos+e.height-this.highlightOffset)))}drawBottomRow(e){if(this.RTL_)this.steps_+=B("V",e.baseline-this.highlightOffset);else{const t=this.info_.bottomRow.elements[0];m.isLeftSquareCorner(t)?this.steps_+=Ie(e.xPos+this.highlightOffset,e.baseline-this.highlightOffset):m.isLeftRoundedCorner(t)&&(this.steps_+=Ie(e.xPos,e.baseline),this.steps_+=this.outsideCornerPaths_.bottomLeft())}}drawLeft(){var e=this.info_.outputConnection;e&&(e=e.connectionOffsetY+e.height,this.RTL_?this.steps_+=Ie(this.info_.startX,e):(this.steps_+=Ie(this.info_.startX+this.highlightOffset,this.info_.bottomRow.baseline-this.highlightOffset),this.steps_+=B("V",e)),this.steps_+=this.puzzleTabPaths_.pathUp(this.RTL_)),this.RTL_||(m.isLeftRoundedCorner((e=this.info_.topRow).elements[0])?this.steps_+=B("V",this.outsideCornerPaths_.height):this.steps_+=B("V",e.capline+this.highlightOffset))}drawInlineInput(e){const t=this.highlightOffset,i=e.xPos+e.connectionWidth;var s=e.centerline-e.height/2;const n=e.width-e.connectionWidth,l=s+t;this.RTL_?(s=e.connectionOffsetY-t,e=e.height-(e.connectionOffsetY+e.connectionHeight)+t,this.inlineSteps_+=Ie(i-t,l)+B("v",s)+this.puzzleTabPaths_.pathDown(this.RTL_)+B("v",e)+B("h",n)):this.inlineSteps_+=Ie(e.xPos+e.width+t,l)+B("v",e.height)+B("h",-n)+Ie(i,s+e.connectionOffsetY)+this.puzzleTabPaths_.pathDown(this.RTL_)}},Rg=class extends rc{constructor(e,t){super(e,t),this.highlighter_=new Ag(t)}draw(){this.drawOutline_(),this.drawInternals_(),this.updateConnectionHighlights();const e=this.block_.pathObject;e.setPath(this.outlinePath_+"\n"+this.inlinePath_),e.setHighlightPath(this.highlighter_.getPath()),this.info_.RTL&&e.flipRTL(),this.recordSizeOnBlock_()}drawTop_(){this.highlighter_.drawTopCorner(this.info_.topRow),this.highlighter_.drawRightSideRow(this.info_.topRow),super.drawTop_()}drawJaggedEdge_(e){this.highlighter_.drawJaggedEdge_(e),super.drawJaggedEdge_(e)}drawValueInput_(e){this.highlighter_.drawValueInput(e),super.drawValueInput_(e)}drawStatementInput_(e){this.highlighter_.drawStatementInput(e),super.drawStatementInput_(e)}drawRightSideRow_(e){this.highlighter_.drawRightSideRow(e),this.outlinePath_+=B("H",e.xPos+e.width)+B("V",e.yPos+e.height)}drawBottom_(){this.highlighter_.drawBottomRow(this.info_.bottomRow),super.drawBottom_()}drawLeft_(){this.highlighter_.drawLeft(),super.drawLeft_()}drawInlineInput_(e){this.highlighter_.drawInlineInput(e),super.drawInlineInput_(e)}positionInlineInputConnection_(e){if(e.connectionModel){let i=e.xPos+e.connectionWidth+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(i*=-1),e.connectionModel.setOffsetInBlock(i,e.centerline-e.height/2+e.connectionOffsetY+this.constants_.DARK_PATH_OFFSET)}}positionStatementInputConnection_(e){const t=e.getLastInput();if(null!=t&&t.connectionModel){let i=e.xPos+e.statementEdge+t.notchOffset;i=this.info_.RTL?-1*i:i+this.constants_.DARK_PATH_OFFSET,t.connectionModel.setOffsetInBlock(i,e.yPos+this.constants_.DARK_PATH_OFFSET)}}positionExternalValueConnection_(e){const t=e.getLastInput();if(t&&t.connectionModel){let i=e.xPos+e.width+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(i*=-1),t.connectionModel.setOffsetInBlock(i,e.yPos)}}positionNextConnection_(){const e=this.info_.bottomRow;if(e.connection){const t=e.connection,i=t.xPos;t.connectionModel.setOffsetInBlock((this.info_.RTL?-i:i)+this.constants_.DARK_PATH_OFFSET/2,e.baseline+this.constants_.DARK_PATH_OFFSET)}}},Og=class{constructor(e){this.OFFSET=.5,this.constantProvider=e,this.START_POINT=ae(this.OFFSET,this.OFFSET)}init(){this.INSIDE_CORNER=this.makeInsideCorner(),this.OUTSIDE_CORNER=this.makeOutsideCorner(),this.PUZZLE_TAB=this.makePuzzleTab(),this.NOTCH=this.makeNotch(),this.JAGGED_TEETH=this.makeJaggedTeeth(),this.START_HAT=this.makeStartHat()}makeInsideCorner(){const e=this.constantProvider.CORNER_RADIUS,t=this.OFFSET,i=(1-Math.SQRT1_2)*(e+t)-t,s=ae(i,i)+pe("a","0 0,0",e,L(-i-t,e-i)),n=pe("a","0 0,0",e+t,L(e+t,e+t)),l=ae(i,-i)+pe("a","0 0,0",e+t,L(e-i,i+t));return{width:e+t,height:e,pathTop:u=>u?s:"",pathBottom:u=>u?n:l}}makeOutsideCorner(){const e=this.constantProvider.CORNER_RADIUS,t=this.OFFSET,i=(1-Math.SQRT1_2)*(e-t)+t,s=ae(i,i)+pe("a","0 0,1",e-t,L(e-i,-i+t)),n=ae(t,e)+pe("a","0 0,1",e-t,L(e,-e+t)),l=-i,u=ae(i,l)+pe("a","0 0,1",e-t,L(-i+t,-l-e));return{height:e,topLeft:$=>$?s:n,bottomLeft:()=>u}}makePuzzleTab(){const e=this.constantProvider.TAB_WIDTH,t=this.constantProvider.TAB_HEIGHT,i=ae(-2,2.5-t+.9)+rt(-.45*e,-2.1),s=B("v",2.5)+ae(.97*-e,2.5)+Ne("q",[L(.05*-e,10),L(.3*e,9.5)])+ae(.67*e,-1.9)+B("v",2.5),n=B("v",-1.5)+ae(-.92*e,-.5)+Ne("q",[L(-.19*e,-5.5),L(0,-11)])+ae(.92*e,1),l=ae(-5,t-.7)+rt(.46*e,-2.1);return{width:e,height:t,pathUp:u=>u?i:n,pathDown:u=>u?s:l}}makeNotch(){return{pathLeft:B("h",this.OFFSET)+this.constantProvider.NOTCH.pathLeft}}makeJaggedTeeth(){return{pathLeft:rt(5.1,2.6)+ae(-10.2,6.8)+rt(5.1,2.6),height:12,width:10.2}}makeStartHat(){const e=this.constantProvider.START_HAT.height,t=ae(25,-8.7)+Ne("c",[L(29.7,-6.2),L(57.2,-.5),L(75,8.7)]),i=Ne("c",[L(17.8,-9.2),L(45.3,-14.9),L(75,-8.7)])+Ie(100.5,e+.5);return{path:s=>s?t:i}}},Mg=class extends Iu{constructor(e,t){super(e,t),this.constants_=e,this.connectedBlock&&(this.width+=this.constants_.DARK_PATH_OFFSET,this.height+=this.constants_.DARK_PATH_OFFSET)}},Ng=class extends sc{constructor(e,t){super(e,t),this.constants_=e,this.connectedBlock&&(this.height+=this.constants_.DARK_PATH_OFFSET)}},Lg=class extends hr{constructor(e,t){super(e,t),this.renderer_=e}getRenderer(){return this.renderer_}populateBottomRow_(){super.populateBottomRow_(),this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1]instanceof mt||(this.bottomRow.minHeight=this.constants_.MEDIUM_PADDING-this.constants_.DARK_PATH_OFFSET)}addInput_(e,t){this.isInline&&e instanceof o.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new Mg(this.constants_,e)),t.hasInlineInput=!0):e instanceof mt?(t.elements.push(new Ng(this.constants_,e)),t.hasStatement=!0):e instanceof o.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new yu(this.constants_,e)),t.hasExternalInput=!0):(e instanceof eo||e instanceof mo)&&(t.minHeight=Math.max(t.minHeight,this.constants_.DUMMY_INPUT_MIN_HEIGHT),t.hasDummyInput=!0),this.isInline||null!==t.align||(t.align=e.align)}addElemSpacing_(){let e=!1;for(let s,i=0;s=this.rows[i];i++)s.hasExternalInput&&(e=!0);for(let s,i=0;s=this.rows[i];i++){var t=s.elements;if(s.elements=[],s.startsWithElemSpacer()&&s.elements.push(new _t(this.constants_,this.getInRowSpacing_(null,t[0]))),t.length){for(let n=0;n<t.length-1;n++){s.elements.push(t[n]);const l=this.getInRowSpacing_(t[n],t[n+1]);s.elements.push(new _t(this.constants_,l))}s.elements.push(t[t.length-1]),s.endsWithElemSpacer()&&(t=this.getInRowSpacing_(t[t.length-1],null),e&&s.hasDummyInput&&(t+=this.constants_.TAB_WIDTH),s.elements.push(new _t(this.constants_,t)))}}}getInRowSpacing_(e,t){if(!e)return t&&m.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:t&&m.isInlineInput(t)?this.constants_.MEDIUM_LARGE_PADDING:t&&m.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!m.isInput(e)&&(!t||m.isStatementInput(t)))return m.isField(e)&&e.isEditable?0===e.width?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:m.isIcon(e)?2*this.constants_.LARGE_PADDING+1:m.isHat(e)?this.constants_.NO_PADDING:m.isPreviousOrNextConnection(e)?this.constants_.LARGE_PADDING:m.isLeftRoundedCorner(e)?this.constants_.MIN_BLOCK_WIDTH:m.isJaggedEdge(e)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(m.isInput(e)&&!t){if(m.isExternalInput(e))return this.constants_.NO_PADDING;if(m.isInlineInput(e))return this.constants_.LARGE_PADDING;if(m.isStatementInput(e))return this.constants_.NO_PADDING}if(!m.isInput(e)&&t&&m.isInput(t)){if(m.isField(e)&&e.isEditable){if(m.isInlineInput(t)||m.isExternalInput(t))return this.constants_.SMALL_PADDING}else{if(m.isInlineInput(t)||m.isExternalInput(t))return this.constants_.MEDIUM_LARGE_PADDING;if(m.isStatementInput(t))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(m.isIcon(e)&&t&&!m.isInput(t))return this.constants_.LARGE_PADDING;if(m.isInlineInput(e)&&t&&m.isField(t))return t.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(m.isLeftSquareCorner(e)&&t){if(m.isHat(t))return this.constants_.NO_PADDING;if(m.isPreviousConnection(t))return t.notchOffset;if(m.isNextConnection(t))return t.notchOffset+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}if(m.isLeftRoundedCorner(e)&&t){if(m.isPreviousConnection(t))return t.notchOffset-this.constants_.CORNER_RADIUS;if(m.isNextConnection(t))return t.notchOffset-this.constants_.CORNER_RADIUS+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}return m.isField(e)&&t&&m.isField(t)&&e.isEditable===t.isEditable?0===e.width?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING:t&&m.isJaggedEdge(t)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(e,t){return m.isTopRow(e)&&m.isBottomRow(t)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:m.isTopRow(e)||m.isBottomRow(t)?this.constants_.NO_PADDING:e.hasExternalInput&&t.hasExternalInput?this.constants_.LARGE_PADDING:!e.hasStatement&&t.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:e.hasStatement&&t.hasStatement||!e.hasStatement&&t.hasDummyInput||e.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){if(m.isSpacer(t))return e.yPos+t.height/2;if(m.isBottomRow(e))return e=e.yPos+e.height-e.descenderHeight,m.isNextConnection(t)?e+t.height/2:e-t.height/2;if(m.isTopRow(e))return m.isHat(t)?e.capline-t.height/2:e.capline+t.height/2;let i=e.yPos;return m.isField(t)||m.isIcon(t)?(i+=t.height/2,(e.hasInlineInput||e.hasStatement)&&t.height+this.constants_.TALL_INPUT_FIELD_OFFSET_Y<=e.height&&(i+=this.constants_.TALL_INPUT_FIELD_OFFSET_Y)):i=m.isInlineInput(t)?i+t.height/2:i+e.height/2,i}alignRowElements_(){if(this.isInline){var e=0,t=new WeakMap,i=null;for(let n,s=this.rows.length-1;n=this.rows[s];s--)t.set(n,e),m.isInputRow(n)&&(n.hasStatement&&this.alignStatementRow_(n),i&&i.hasStatement&&n.width<i.width?t.set(n,i.width):e=n.hasStatement?n.width:Math.max(e,n.width),i=n);e=0;for(let n,s=0;n=this.rows[s];s++)n.hasStatement?e=this.getDesiredRowWidth_(n):m.isSpacer(n)?n.width=Math.max(e,t.get(n)):(i=n.width,(e=Math.max(e,t.get(n))-i)>0&&this.addAlignmentPadding_(n,e),e=n.width)}else super.alignRowElements_()}getDesiredRowWidth_(e){return this.isInline&&e.hasStatement?this.statementEdge+this.constants_.MAX_BOTTOM_WIDTH+this.startX:super.getDesiredRowWidth_(e)}finalize_(){let e=0,t=0;for(let n,s=0;n=this.rows[s];s++){n.yPos=t,n.xPos=this.startX,t+=n.height,e=Math.max(e,n.widthWithConnectedBlocks);var i=t-this.topRow.ascenderHeight;n===this.bottomRow&&i<this.constants_.MIN_BLOCK_HEIGHT&&(this.bottomRow.height+=i=this.constants_.MIN_BLOCK_HEIGHT-i,t+=i),this.recordElemPositions_(n)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(i=this.block_.nextConnection.targetBlock())&&(e=Math.max(e,i.getHeightWidth().width-this.constants_.DARK_PATH_OFFSET)),this.bottomRow.baseline=t-this.bottomRow.descenderHeight,this.widthWithChildren=e+this.startX+this.constants_.DARK_PATH_OFFSET,this.width+=this.constants_.DARK_PATH_OFFSET,this.height=t+this.constants_.DARK_PATH_OFFSET,this.startY=this.topRow.capline}},Dg=class extends lc{constructor(e,t,i){super(e,t,i),this.constants=i,this.colourDark="#000000",this.svgPathDark=I(T.PATH,{class:"blocklyPathDark",transform:"translate(1,1)"}),this.svgRoot.insertBefore(this.svgPathDark,this.svgPath),this.svgPathLight=I(T.PATH,{class:"blocklyPathLight"},this.svgRoot)}setPath(e){this.svgPath.setAttribute("d",e),this.svgPathDark.setAttribute("d",e)}setHighlightPath(e){this.svgPathLight.setAttribute("d",e)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)"),this.svgPathLight.setAttribute("transform","scale(-1 1)"),this.svgPathDark.setAttribute("transform","translate(1,1) scale(-1 1)")}applyColour(e){if(this.svgPathLight.style.display="",this.svgPathDark.style.display="",!this.style.colourTertiary)throw Error("The renderer did not properly initialize the tertiary colour of the block style");this.svgPathLight.setAttribute("stroke",this.style.colourTertiary),this.svgPathDark.setAttribute("fill",this.colourDark),super.applyColour(e),this.svgPath.setAttribute("stroke","none")}setStyle(e){this.style=e,this.colourDark=Mo("#000",this.style.colourPrimary,.2)||this.colourDark}updateHighlighted(e){super.updateHighlighted(e),this.svgPathLight.style.display=e?"none":"inline"}updateShadow_(e){if(e){if(this.svgPathLight.style.display="none",!this.style.colourSecondary)throw Error("The renderer did not properly initialize the secondary colour of the block style block style");this.svgPathDark.setAttribute("fill",this.style.colourSecondary),this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary)}}updateDisabled_(e){super.updateDisabled_(e),e&&this.svgPath.setAttribute("stroke","none")}},Pg=class extends cc{constructor(e){super(e),this.highlightConstants=null}init(e,t){super.init(e,t),this.highlightConstants=this.makeHighlightConstants_(),this.highlightConstants.init()}refreshDom(e,t,i){super.refreshDom(e,t,i),this.getHighlightConstants().init()}makeConstants_(){return new Sg}makeRenderInfo_(e){return new Lg(this,e)}makeDrawer_(e,t){return new Rg(e,t)}makePathObject(e,t){return new Dg(e,t,this.getConstants())}makeHighlightConstants_(){return new Og(this.getConstants())}getHighlightConstants(){if(!this.highlightConstants)throw Error("Cannot access the highlight constants because init has not been called");return this.highlightConstants}};Os("geras",Pg);var To={};To.ConstantProvider=Sg,To.Drawer=Rg,To.HighlightConstantProvider=Og,To.Highlighter=Ag,To.InlineInput=Mg,To.PathObject=Dg,To.RenderInfo=Lg,To.Renderer=Pg,To.StatementInput=Ng;var Bg=class extends hr{constructor(e,t){super(e,t)}getRenderer(){return this.renderer_}addElemSpacing_(){let e=!1;for(var t=0;t<this.rows.length;t++)if(this.rows[t].hasExternalInput){e=!0;break}for(t=0;t<this.rows.length;t++){const s=this.rows[t];var i=s.elements;if(s.elements=[],s.startsWithElemSpacer()&&s.elements.push(new _t(this.constants_,this.getInRowSpacing_(null,i[0]))),i.length){for(let n=0;n<i.length-1;n++){s.elements.push(i[n]);const l=this.getInRowSpacing_(i[n],i[n+1]);s.elements.push(new _t(this.constants_,l))}s.elements.push(i[i.length-1]),s.endsWithElemSpacer()&&(i=this.getInRowSpacing_(i[i.length-1],null),e&&s.hasDummyInput&&(i+=this.constants_.TAB_WIDTH),s.elements.push(new _t(this.constants_,i)))}}}getInRowSpacing_(e,t){if(!e)return t&&m.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:t&&m.isInlineInput(t)?this.constants_.MEDIUM_LARGE_PADDING:t&&m.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!m.isInput(e)&&!t)return m.isField(e)&&e.isEditable?0===e.width?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:m.isIcon(e)?2*this.constants_.LARGE_PADDING+1:m.isHat(e)?this.constants_.NO_PADDING:m.isPreviousOrNextConnection(e)?this.constants_.LARGE_PADDING:m.isLeftRoundedCorner(e)?this.constants_.MIN_BLOCK_WIDTH:m.isJaggedEdge(e)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(m.isInput(e)&&!t){if(m.isExternalInput(e))return this.constants_.NO_PADDING;if(m.isInlineInput(e))return this.constants_.LARGE_PADDING;if(m.isStatementInput(e))return this.constants_.NO_PADDING}if(!m.isInput(e)&&t&&m.isInput(t)){if(m.isField(e)&&e.isEditable){if(m.isInlineInput(t)||m.isExternalInput(t))return this.constants_.SMALL_PADDING}else{if(m.isInlineInput(t)||m.isExternalInput(t))return this.constants_.MEDIUM_LARGE_PADDING;if(m.isStatementInput(t))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(m.isIcon(e)&&t&&!m.isInput(t))return this.constants_.LARGE_PADDING;if(m.isInlineInput(e)&&t&&m.isField(t))return t.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(m.isLeftSquareCorner(e)&&t){if(m.isHat(t))return this.constants_.NO_PADDING;if(m.isPreviousConnection(t)||m.isNextConnection(t))return t.notchOffset}return m.isLeftRoundedCorner(e)&&t?t.notchOffset-this.constants_.CORNER_RADIUS:m.isField(e)&&t&&m.isField(t)&&e.isEditable===t.isEditable?0===e.width?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING:t&&m.isJaggedEdge(t)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(e,t){return m.isTopRow(e)&&m.isBottomRow(t)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:m.isTopRow(e)||m.isBottomRow(t)?this.constants_.NO_PADDING:e.hasExternalInput&&t.hasExternalInput?this.constants_.LARGE_PADDING:!e.hasStatement&&t.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:e.hasStatement&&t.hasStatement||e.hasDummyInput||t.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){if(m.isSpacer(t))return e.yPos+t.height/2;if(m.isBottomRow(e))return e=e.yPos+e.height-e.descenderHeight,m.isNextConnection(t)?e+t.height/2:e-t.height/2;if(m.isTopRow(e))return m.isHat(t)?e.capline-t.height/2:e.capline+t.height/2;let i=e.yPos;return m.isField(t)&&e.hasStatement?i+(this.constants_.TALL_INPUT_FIELD_OFFSET_Y+t.height/2):i+e.height/2}finalize_(){let e=0,t=0;for(var i=0;i<this.rows.length;i++){const n=this.rows[i];n.yPos=t,n.xPos=this.startX,t+=n.height,e=Math.max(e,n.widthWithConnectedBlocks);var s=t-this.topRow.ascenderHeight;n===this.bottomRow&&s<this.constants_.MIN_BLOCK_HEIGHT&&(this.bottomRow.height+=s=this.constants_.MIN_BLOCK_HEIGHT-s,t+=s),this.recordElemPositions_(n)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(i=this.block_.nextConnection.targetBlock())&&(e=Math.max(e,i.getHeightWidth().width)),this.bottomRow.baseline=t-this.bottomRow.descenderHeight,this.widthWithChildren=e+this.startX,this.height=t,this.startY=this.topRow.capline}},Fg=class extends cc{constructor(e){super(e)}makeRenderInfo_(e){return new Bg(this,e)}};Os("thrasos",Fg);var Ug={};Ug.RenderInfo=Bg,Ug.Renderer=Fg;var $_=new Zi("zelos",{colour_blocks:{colourPrimary:"#CF63CF",colourSecondary:"#C94FC9",colourTertiary:"#BD42BD"},list_blocks:{colourPrimary:"#9966FF",colourSecondary:"#855CD6",colourTertiary:"#774DCB"},logic_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC"},loop_blocks:{colourPrimary:"#0fBD8C",colourSecondary:"#0DA57A",colourTertiary:"#0B8E69"},math_blocks:{colourPrimary:"#59C059",colourSecondary:"#46B946",colourTertiary:"#389438"},procedure_blocks:{colourPrimary:"#FF6680",colourSecondary:"#FF4D6A",colourTertiary:"#FF3355"},text_blocks:{colourPrimary:"#FFBF00",colourSecondary:"#E6AC00",colourTertiary:"#CC9900"},variable_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},variable_dynamic_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},hat_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC",hat:"cap"}},{colour_category:{colour:"#CF63CF"},list_category:{colour:"#9966FF"},logic_category:{colour:"#4C97FF"},loop_category:{colour:"#0fBD8C"},math_category:{colour:"#59C059"},procedure_category:{colour:"#FF6680"},text_category:{colour:"#FFBF00"},variable_category:{colour:"#FF8C1A"},variable_dynamic_category:{colour:"#FF8C1A"}}),SE={Classic:ql,Zelos:$_},od=class{constructor(e,t,i){this.id_=e.toolboxitemid||Ee(),this.level_=(this.parent_=i||null)?this.parent_.getLevel()+1:0,this.toolboxItemDef_=e,this.parentToolbox_=t,this.workspace_=this.parentToolbox_.getWorkspace()}init(){}getDiv(){return null}getClickTarget(){return null}getId(){return this.id_}getParent(){return null}getLevel(){return this.level_}isSelectable(){return!1}isCollapsible(){return!1}dispose(){}setVisible_(e){}getFocusableElement(){const e=this.getDiv();if(!e)throw Error("Trying to access toolbox item before DOM is initialized.");if(!(e instanceof HTMLElement))throw Error("Toolbox item div is unexpectedly not an HTML element.");return e}getFocusableTree(){return this.parentToolbox_}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}},Dt=class extends od{constructor(e,t,i){super(e,t,i),this.colour_=this.name_="",this.labelDom_=this.iconDom_=this.rowContents_=this.rowDiv_=this.htmlDiv_=null,this.isDisabled_=this.isHidden_=!1,this.flyoutItems_=[],this.cssConfig_=this.makeDefaultCssConfig_()}init(){this.parseCategoryDef_(this.toolboxItemDef_),this.parseContents_(this.toolboxItemDef_),this.createDom_(),"true"===this.toolboxItemDef_.hidden&&this.hide()}makeDefaultCssConfig_(){return{container:"blocklyToolboxCategoryContainer",row:"blocklyToolboxCategory",rowcontentcontainer:"blocklyTreeRowContentContainer",icon:"blocklyToolboxCategoryIcon",label:"blocklyToolboxCategoryLabel",contents:"blocklyToolboxCategoryGroup",selected:"blocklyToolboxSelected",openicon:"blocklyToolboxCategoryIconOpen",closedicon:"blocklyToolboxCategoryIconClosed"}}parseContents_(e){if("custom"in e)this.flyoutItems_=e.custom;else if(e=e.contents)for(let t=0;t<e.length;t++){const i=e[t];Array.isArray(this.flyoutItems_)&&this.flyoutItems_.push(i)}}parseCategoryDef_(e){this.name_="name"in e?ge(e.name):"",this.colour_=this.getColour_(e),Object.assign(this.cssConfig_,e.cssconfig||e.cssConfig)}createDom_(){this.htmlDiv_=this.createContainer_(),Ht(this.htmlDiv_,yt.TREEITEM),ye(this.htmlDiv_,xe.SELECTED,!1),ye(this.htmlDiv_,xe.LEVEL,this.level_+1),this.rowDiv_=this.createRowContainer_(),this.rowDiv_.style.pointerEvents="auto",this.htmlDiv_.appendChild(this.rowDiv_),this.rowContents_=this.createRowContentsContainer_(),this.rowContents_.style.pointerEvents="none",this.rowDiv_.appendChild(this.rowContents_),this.iconDom_=this.createIconDom_(),Ht(this.iconDom_,yt.PRESENTATION),this.rowContents_.appendChild(this.iconDom_),this.labelDom_=this.createLabelDom_(this.name_),this.rowContents_.appendChild(this.labelDom_);const e=this.labelDom_.getAttribute("id");return e&&ye(this.htmlDiv_,xe.LABELLEDBY,e),this.addColourBorder_(this.colour_),this.htmlDiv_}createContainer_(){const e=document.createElement("div");e.tabIndex=-1,e.id=this.getId();const t=this.cssConfig_.container;return t&&R(e,t),e}createRowContainer_(){const e=document.createElement("div");var t=this.cssConfig_.row;return t&&R(e,t),t=Dt.nestedPadding*this.getLevel()+"px",this.workspace_.RTL?e.style.paddingRight=t:e.style.paddingLeft=t,e}createRowContentsContainer_(){const e=document.createElement("div"),t=this.cssConfig_.rowcontentcontainer;return t&&R(e,t),e}createIconDom_(){const e=document.createElement("span");if(!this.parentToolbox_.isHorizontal()){const t=this.cssConfig_.icon;t&&R(e,t)}return e.style.display="inline-block",e}createLabelDom_(e){const t=document.createElement("span");return t.setAttribute("id",this.getId()+".label"),t.textContent=e,(e=this.cssConfig_.label)&&R(t,e),t}refreshTheme(){this.colour_=this.getColour_(this.toolboxItemDef_),this.addColourBorder_(this.colour_)}addColourBorder_(e){e&&(e=Dt.borderWidth+"px solid "+(e||"#ddd"),this.workspace_.RTL?this.rowDiv_.style.borderRight=e:this.rowDiv_.style.borderLeft=e)}getColour_(e){const t=e.categorystyle||e.categoryStyle;if((e=e.colour)&&t)console.warn('Toolbox category "'+this.name_+'" must not have both a style and a colour');else{if(t)return this.getColourfromStyle(t);if(e)return this.parseColour(e)}return""}getColourfromStyle(e){var t=this.workspace_.getTheme();if(e&&t){if((t=t.categoryStyles[e])&&t.colour)return this.parseColour(t.colour);console.warn('Style "'+e+'" must exist and contain a colour value')}return""}getClickTarget(){return this.rowDiv_}parseColour(e){if(null==(e=ge(e))||""===e)return"";var t=Number(e);return isNaN(t)?(t=Ro(e))?t:(console.warn('Toolbox category "'+this.name_+'" has unrecognized colour attribute: '+e),""):jr(t)}openIcon_(e){if(e){var t=this.cssConfig_.closedicon;t&&ci(e,t),(t=this.cssConfig_.openicon)&&R(e,t)}}closeIcon_(e){if(e){var t=this.cssConfig_.openicon;t&&ci(e,t),(t=this.cssConfig_.closedicon)&&R(e,t)}}setVisible_(e){this.htmlDiv_.style.display=e?"block":"none",this.isHidden_=!e,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}hide(){this.setVisible_(!1)}show(){this.setVisible_(!0)}isVisible(){return!this.isHidden_&&this.allAncestorsExpanded_()}allAncestorsExpanded_(){let e=this;for(;e.getParent();)if(e=e.getParent(),!e.isExpanded())return!1;return!0}isSelectable(){return this.isVisible()&&!this.isDisabled_}onClick(e){}setSelected(e){if(this.rowDiv_){var t=this.cssConfig_.selected;if(e){const i=this.parseColour(Dt.defaultBackgroundColour);this.rowDiv_.style.backgroundColor=this.colour_||i,t&&R(this.rowDiv_,t)}else this.rowDiv_.style.backgroundColor="",t&&X(this.rowDiv_,t);ye(this.htmlDiv_,xe.SELECTED,e)}}setDisabled(e){this.isDisabled_=e,this.getDiv().setAttribute("disabled",`${e}`),e?this.getDiv().setAttribute("disabled","true"):this.getDiv().removeAttribute("disabled")}getName(){return this.name_}getParent(){return this.parent_}getDiv(){return this.htmlDiv_}getContents(){return this.flyoutItems_}updateFlyoutContents(e){this.flyoutItems_=[],this.toolboxItemDef_="string"==typeof e?{kind:this.toolboxItemDef_.kind,custom:e,id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden}:{kind:this.toolboxItemDef_.kind,name:"name"in this.toolboxItemDef_?this.toolboxItemDef_.name:"",contents:bn(e),id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden},this.parseContents_(this.toolboxItemDef_)}dispose(){Q(this.htmlDiv_)}};Dt.registrationName="category",Dt.nestedPadding=19,Dt.borderWidth=8,Dt.defaultBackgroundColour="#57e",Ft('\n.blocklyToolboxCategory:not(.blocklyToolboxSelected):hover {\n  background-color: rgba(255, 255, 255, .2);\n}\n\n.blocklyToolbox[layout="h"] .blocklyToolboxCategoryContainer {\n  margin: 1px 5px 1px 0;\n}\n\n.blocklyToolbox[dir="RTL"][layout="h"] .blocklyToolboxCategoryContainer {\n  margin: 1px 0 1px 5px;\n}\n\n.blocklyToolboxCategory {\n  height: 22px;\n  line-height: 22px;\n  margin-bottom: 3px;\n  padding-right: 8px;\n  white-space: nowrap;\n}\n\n.blocklyToolbox[dir="RTL"] .blocklyToolboxCategory {\n  margin-left: 8px;\n  padding-right: 0;\n}\n\n.blocklyToolboxCategoryIcon {\n  background-image: url(<<<PATH>>>/sprites.png);\n  height: 16px;\n  vertical-align: middle;\n  visibility: hidden;\n  width: 16px;\n}\n\n.blocklyToolboxCategoryIconClosed {\n  background-position: -32px -1px;\n}\n\n.blocklyToolbox[dir="RTL"] .blocklyToolboxCategoryIconClosed {\n  background-position: 0 -1px;\n}\n\n.blocklyToolboxSelected>.blocklyToolboxCategoryIconClosed {\n  background-position: -32px -17px;\n}\n\n.blocklyToolbox[dir="RTL"] .blocklyToolboxSelected>.blocklyToolboxCategoryIconClosed {\n  background-position: 0 -17px;\n}\n\n.blocklyToolboxCategoryIconOpen {\n  background-position: -16px -1px;\n}\n\n.blocklyToolboxSelected>.blocklyToolboxCategoryIconOpen {\n  background-position: -16px -17px;\n}\n\n.blocklyToolboxCategoryLabel {\n  cursor: default;\n  font: 16px sans-serif;\n  padding: 0 3px;\n  vertical-align: middle;\n}\n\n.blocklyToolboxDelete .blocklyToolboxCategoryLabel {\n  cursor: url("<<<PATH>>>/handdelete.cur"), auto;\n}\n\n.blocklyToolboxSelected .blocklyToolboxCategoryLabel {\n  color: #fff;\n}\n'),U(x.TOOLBOX_ITEM,Dt.registrationName,Dt);var mr=class extends od{constructor(e,t){super(e,t),this.cssConfig_={container:"blocklyTreeSeparator"},this.htmlDiv=null,Object.assign(this.cssConfig_,e.cssconfig||e.cssConfig)}init(){this.createDom_()}createDom_(){const e=document.createElement("div");e.tabIndex=-1,e.id=this.getId();const t=this.cssConfig_.container;return t&&R(e,t),this.htmlDiv=e}getDiv(){return this.htmlDiv}dispose(){Q(this.htmlDiv)}};mr.registrationName="sep",Ft('\n.blocklyTreeSeparator {\n  border-bottom: solid #e5e5e5 1px;\n  height: 0;\n  margin: 5px 0;\n}\n\n.blocklyToolbox[layout="h"] .blocklyTreeSeparator {\n  border-right: solid #e5e5e5 1px;\n  border-bottom: none;\n  height: auto;\n  margin: 0 5px 0 5px;\n  padding: 5px 0;\n  width: 0;\n}\n'),U(x.TOOLBOX_ITEM,mr.registrationName,mr);var Qs=class extends Dt{constructor(e,t,i){super(e,t,i),this.subcategoriesDiv_=null,this.expanded_=!1,this.toolboxItems_=[]}makeDefaultCssConfig_(){const e=super.makeDefaultCssConfig_();return e.contents="blocklyToolboxCategoryGroup",e}parseContents_(e){if("custom"in e)this.flyoutItems_=e.custom;else{const t=e.contents;if(t){this.flyoutItems_=[],e=!0;for(let i=0;i<t.length;i++){const s=t[i];!Jo(x.TOOLBOX_ITEM,s.kind)||s.kind.toLowerCase()===mr.registrationName&&e?(this.flyoutItems_.push(s),e=!0):(this.createToolboxItem(s),e=!1)}}}}createToolboxItem(e){let t=e.kind;"CATEGORY"===t.toUpperCase()&&yr(e)&&(t=Qs.registrationName),e=new(ot(x.TOOLBOX_ITEM,t))(e,this.parentToolbox_,this),this.toolboxItems_.push(e)}init(){super.init(),this.setExpanded("true"===this.toolboxItemDef_.expanded||!0===this.toolboxItemDef_.expanded)}createDom_(){super.createDom_();const e=this.getChildToolboxItems();return this.subcategoriesDiv_=this.createSubCategoriesDom_(e),Ht(this.subcategoriesDiv_,yt.GROUP),this.htmlDiv_.appendChild(this.subcategoriesDiv_),this.closeIcon_(this.iconDom_),ye(this.htmlDiv_,xe.EXPANDED,!1),this.htmlDiv_}createIconDom_(){const e=document.createElement("span");if(!this.parentToolbox_.isHorizontal()){const t=this.cssConfig_.icon;t&&R(e,t),e.style.visibility="visible"}return e.style.display="inline-block",e}createSubCategoriesDom_(e){const t=document.createElement("div");t.style.display="none";var i=this.cssConfig_.contents;for(i&&R(t,i),i=0;i<e.length;i++){const s=e[i];s.init();const n=s.getDiv();if(t.appendChild(n),s.getClickTarget){let l;null==(l=s.getClickTarget())||l.setAttribute("id",s.getId())}}return t}setExpanded(e){if(this.expanded_!==e){if(this.expanded_=e)this.subcategoriesDiv_.style.display="block",this.openIcon_(this.iconDom_);else{let t;null==(t=this.parentToolbox_.getFlyout())||t.setVisible(!1),this.subcategoriesDiv_.style.display="none",this.closeIcon_(this.iconDom_)}ye(this.htmlDiv_,xe.EXPANDED,e),this.parentToolbox_.handleToolboxItemResize()}}setVisible_(e){this.htmlDiv_.style.display=e?"block":"none";const t=this.getChildToolboxItems();for(let i=0;i<t.length;i++)t[i].setVisible_(e);this.isHidden_=!e,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}isExpanded(){return this.expanded_}isCollapsible(){return!0}onClick(e){this.toggleExpanded()}toggleExpanded(){this.setExpanded(!this.expanded_)}getDiv(){return this.htmlDiv_}getChildToolboxItems(){return this.toolboxItems_}};Qs.registrationName="collapsibleCategory",U(x.TOOLBOX_ITEM,Qs.registrationName,Qs);var Hg=class extends Kl{constructor(e){super(),this.id="toolbox",this.contentsDiv_=this.HtmlDiv=null,this.isVisible_=!1,this.height_=this.width_=0,this.flyout=null,this.contents=new Map,this.previouslySelectedItem_=this.selectedItem_=null,this.boundEvents_=[],this.workspace_=e,this.toolboxDef_=e.options.languageTree||{contents:[]},this.horizontalLayout=e.options.horizontalLayout,this.RTL=e.options.RTL,this.toolboxPosition=e.options.toolboxPosition}onShortcut(e){return!1}init(){var e=this.workspace_;const t=e.getParentSvg();this.flyout=this.createFlyout_(),this.HtmlDiv=this.createDom_(this.workspace_);const i=this.flyout.createDom("svg");R(i,"blocklyToolboxFlyout"),c(i,t),this.setVisible(!0),this.flyout.init(e),this.render(this.toolboxDef_),(e=e.getThemeManager()).subscribe(this.HtmlDiv,"toolboxBackgroundColour","background-color"),e.subscribe(this.HtmlDiv,"toolboxForegroundColour","color"),this.workspace_.getComponentManager().addComponent({component:this,weight:de.ComponentWeight.TOOLBOX_WEIGHT,capabilities:[de.Capability.AUTOHIDEABLE,de.Capability.DELETE_AREA,de.Capability.DRAG_TARGET]}),o.getFocusManager$$module$build$src$core$focus_manager().registerTree(this,!0)}createDom_(e){e=e.getParentSvg();const t=this.createContainer_();return t.id=Ee(),this.contentsDiv_=this.createContentsContainer_(),Ht(this.contentsDiv_,yt.TREE),t.appendChild(this.contentsDiv_),e.parentNode.insertBefore(t,e),this.attachEvents_(t,this.contentsDiv_),t}createContainer_(){const e=document.createElement("div");return e.setAttribute("layout",this.isHorizontal()?"h":"v"),R(e,"blocklyToolbox"),e.setAttribute("dir",this.RTL?"RTL":"LTR"),e}createContentsContainer_(){const e=document.createElement("div");return R(e,"blocklyToolboxCategoryGroup"),this.isHorizontal()&&(e.style.flexDirection="row"),e}attachEvents_(e,t){e=N(e,"pointerdown",this,this.onClick_,!1),this.boundEvents_.push(e),t=N(t,"keydown",this,this.onKeyDown_,!1),this.boundEvents_.push(t)}onClick_(e){if(it(e)||e.target===this.HtmlDiv)st().hideChaff(!1);else{var t=e.target.getAttribute("id");t&&(t=this.getToolboxItemById(t)).isSelectable()&&(this.setSelectedItem(t),t.onClick(e)),st().hideChaff(!0)}Oe()}onKeyDown_(e){let t=!1;switch(e.key){case"ArrowDown":t=this.selectNext();break;case"ArrowUp":t=this.selectPrevious();break;case"ArrowLeft":t=this.selectParent();break;case"ArrowRight":t=this.selectChild();break;case"Enter":case" ":this.selectedItem_&&this.selectedItem_.isCollapsible()&&(this.selectedItem_.toggleExpanded(),t=!0);break;default:t=!1}!t&&this.selectedItem_&&this.selectedItem_.onKeyDown&&(t=this.selectedItem_.onKeyDown(e)),t&&e.preventDefault()}createFlyout_(){const e=this.workspace_,t=e.copyOptionsForFlyout();return t.toolboxPosition=e.options.toolboxPosition,new(Re(e.horizontalLayout?x.FLYOUTS_HORIZONTAL_TOOLBOX:x.FLYOUTS_VERTICAL_TOOLBOX,e.options,!0))(t)}render(e){this.toolboxDef_=e,this.contents.forEach(t=>t.dispose()),this.contents.clear(),this.renderContents_(e.contents),this.position(),this.handleToolboxItemResize()}renderContents_(e){const t=document.createDocumentFragment();for(let i=0;i<e.length;i++)this.createToolboxItem(e[i],t);this.contentsDiv_.appendChild(t)}createToolboxItem(e,t){var i=e.kind;"CATEGORY"===i.toUpperCase()&&yr(e)&&(i=Qs.registrationName),(i=ot(x.TOOLBOX_ITEM,i.toLowerCase()))&&((e=new i(e,this)).init(),this.addToolboxItem_(e),(i=e.getDiv())&&t.appendChild(i),e.getClickTarget()&&e.getClickTarget().setAttribute("id",e.getId()))}addToolboxItem_(e){if(this.contents.set(e.getId(),e),e.isCollapsible()){e=e.getChildToolboxItems();for(let t=0;t<e.length;t++)this.addToolboxItem_(e[t])}}getToolboxItems(){return[...this.contents.values()]}addStyle(e){e&&this.HtmlDiv&&R(this.HtmlDiv,e)}removeStyle(e){e&&this.HtmlDiv&&X(this.HtmlDiv,e)}getClientRect(){if(!this.HtmlDiv||!this.isVisible_)return null;var e=this.HtmlDiv.getBoundingClientRect();const t=e.top,i=t+e.height,s=e.left;return e=s+e.width,this.toolboxPosition===G.TOP?new j(-1e7,i,-1e7,1e7):this.toolboxPosition===G.BOTTOM?new j(t,1e7,-1e7,1e7):this.toolboxPosition===G.LEFT?new j(-1e7,1e7,-1e7,e):new j(-1e7,1e7,s,1e7)}wouldDelete(e){return this.updateWouldDelete_(e instanceof se?!e.getParent()&&e.isDeletable():Xe(e)&&e.isDeletable()),this.wouldDelete_}onDragEnter(e){this.updateCursorDeleteStyle_(!0)}onDragExit(e){this.updateCursorDeleteStyle_(!1)}onDrop(e){this.updateCursorDeleteStyle_(!1)}updateWouldDelete_(e){e!==this.wouldDelete_&&(this.updateCursorDeleteStyle_(!1),this.wouldDelete_=e,this.updateCursorDeleteStyle_(!0))}updateCursorDeleteStyle_(e){const t=this.wouldDelete_?"blocklyToolboxDelete":"blocklyToolboxGrab";e?this.addStyle(t):this.removeStyle(t)}getToolboxItemById(e){return this.contents.get(e)||null}getWidth(){return this.width_}getHeight(){return this.height_}getFlyout(){return this.flyout}getWorkspace(){return this.workspace_}getSelectedItem(){return this.selectedItem_}getPreviouslySelectedItem(){return this.previouslySelectedItem_}isHorizontal(){return this.horizontalLayout}position(){const e=this.workspace_.getMetrics(),t=this.HtmlDiv;t&&(this.horizontalLayout?(t.style.left="0",t.style.height="auto",t.style.width="100%",this.height_=t.offsetHeight,this.width_=e.viewWidth,this.toolboxPosition===G.TOP?t.style.top="0":t.style.bottom="0"):(this.toolboxPosition===G.RIGHT?t.style.right="0":t.style.left="0",t.style.height="100%",this.width_=t.offsetWidth,this.height_=e.viewHeight),this.flyout.position())}handleToolboxItemResize(){const e=this.workspace_;var t=this.HtmlDiv.getBoundingClientRect();const i=this.getFlyout(),s=this.toolboxPosition===G.LEFT?e.scrollX+t.width+(null!=i&&i.isVisible()?i.getWidth():0):e.scrollX;t=this.toolboxPosition===G.TOP?e.scrollY+t.height+(null!=i&&i.isVisible()?i.getHeight():0):e.scrollY,e.translate(s,t),dt(e)}clearSelection(){this.setSelectedItem(null)}refreshTheme(){this.contents.forEach(e=>{e.refreshTheme&&e.refreshTheme()})}refreshSelection(){this.selectedItem_&&this.selectedItem_.isSelectable()&&this.selectedItem_.getContents().length&&this.flyout.show(this.selectedItem_.getContents())}setVisible(e){this.isVisible_!==e&&(this.HtmlDiv.style.display=e?"block":"none",this.isVisible_=e,this.workspace_.recordDragTargets())}autoHide(e){!e&&this.flyout&&this.flyout.autoClose&&this.clearSelection()}setSelectedItem(e){const t=this.selectedItem_;!e&&!t||e&&!Bh(e)||(this.shouldDeselectItem_(t,e)&&null!==t&&this.deselectItem_(t),this.shouldSelectItem_(t,e)&&null!==e&&this.selectItem_(t,e),this.updateFlyout_(t,e),this.fireSelectEvent(t,e))}shouldDeselectItem_(e,t){return null!==e&&(!e.isCollapsible()||e!==t)}shouldSelectItem_(e,t){return null!==t&&t!==e}deselectItem_(e){this.selectedItem_=null,this.previouslySelectedItem_=e,e.setSelected(!1),ye(this.contentsDiv_,xe.ACTIVEDESCENDANT,"")}selectItem_(e,t){this.selectedItem_=t,this.previouslySelectedItem_=e,t.setSelected(!0),ye(this.contentsDiv_,xe.ACTIVEDESCENDANT,t.getId())}selectItemByPosition(e){(e=this.getToolboxItems()[e])&&this.setSelectedItem(e)}updateFlyout_(e,t){t&&(e!==t||t.isCollapsible())&&t.getContents().length?(this.flyout.show(t.getContents()),this.flyout.scrollToStart()):this.flyout.hide()}fireSelectEvent(e,t){const i=e&&e.getName();let s=t&&t.getName();e===t&&(s=null),e=new(P(f.TOOLBOX_ITEM_SELECT))(i,s,this.workspace_.id),D(e)}selectParent(){return!(!this.selectedItem_||(this.selectedItem_.isCollapsible()&&this.selectedItem_.isExpanded()?(this.selectedItem_.toggleExpanded(),0):!this.selectedItem_.getParent()||!this.selectedItem_.getParent().isSelectable()||(this.setSelectedItem(this.selectedItem_.getParent()),0)))}selectChild(){if(!this.selectedItem_||!this.selectedItem_.isCollapsible())return!1;const e=this.selectedItem_;return e.isExpanded()?this.selectNext():e.toggleExpanded(),!0}selectNext(){if(!this.selectedItem_)return!1;const e=[...this.contents.values()];let t=e.indexOf(this.selectedItem_)+1;if(t>-1&&t<e.length){let i=e[t];for(;i&&!i.isSelectable();)i=e[++t];if(i&&i.isSelectable())return this.setSelectedItem(i),!0}return!1}selectPrevious(){if(!this.selectedItem_)return!1;const e=[...this.contents.values()];let t=e.indexOf(this.selectedItem_)-1;if(t>-1&&t<e.length){let i=e[t];for(;i&&!i.isSelectable();)i=e[--t];if(i&&i.isSelectable())return this.setSelectedItem(i),!0}return!1}dispose(){this.workspace_.getComponentManager().removeComponent("toolbox"),this.flyout.dispose(),this.contents.forEach(e=>e.dispose());for(let e=0;e<this.boundEvents_.length;e++)J(this.boundEvents_[e]);this.boundEvents_=[],this.contents.clear(),this.HtmlDiv&&(this.workspace_.getThemeManager().unsubscribe(this.HtmlDiv),Q(this.HtmlDiv)),o.getFocusManager$$module$build$src$core$focus_manager().unregisterTree(this)}getFocusableElement(){if(!this.HtmlDiv)throw Error("Toolbox DOM has not yet been created.");return this.HtmlDiv}getFocusableTree(){return this}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}getRootFocusableNode(){return this}getRestoredFocusableNode(e){if(!e||e===this){let t;return null!=(t=this.getToolboxItems().find(i=>i.isSelectable()))?t:null}return null}getNestedTrees(){return[]}lookUpFocusableNode(e){return this.getToolboxItemById(e)}onTreeFocus(e,t){e!==this?this.getSelectedItem()!==e&&this.setSelectedItem(e):this.clearSelection()}onTreeBlur(e){let t;e&&e===(null==(t=this.flyout)?void 0:t.getWorkspace())||(this.clearSelection(),this.flyout&&Fn(this.flyout)&&this.flyout.autoHide(!1))}};Ft('\n.blocklyToolboxDelete {\n  cursor: url("<<<PATH>>>/handdelete.cur"), auto;\n}\n\n.blocklyToolboxGrab {\n  cursor: url("<<<PATH>>>/handclosed.cur"), auto;\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n}\n\n/* Category tree in Toolbox. */\n.blocklyToolbox {\n  box-sizing: border-box;\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n  background-color: #ddd;\n  overflow-x: visible;\n  overflow-y: auto;\n  padding: 4px 0 4px 0;\n  position: absolute;\n  z-index: 70;  /* so blocks go under toolbox when dragging */\n  -webkit-tap-highlight-color: transparent;  /* issue #1345 */\n}\n\n.blocklyToolboxCategoryGroup {\n  display: flex;\n  flex-wrap: wrap;\n  flex-direction: column;\n}\n\n.blocklyToolboxCategoryGroup:focus {\n  outline: none;\n}\n'),U(x.TOOLBOX,gt,Hg);var PE=M.INPUT_VALUE,BE=M.OUTPUT_VALUE,FE=M.NEXT_STATEMENT,UE=M.PREVIOUS_STATEMENT,HE=G.TOP,ZE=G.BOTTOM,VE=G.LEFT,GE=G.RIGHT;Xs.prototype.newBlock=function(e,t){return new zs(this,e,t)},ze.prototype.newBlock=function(e,t){return new se(this,e,t)},Xs.prototype.newComment=function(e){return new Wl(this,e)},ze.prototype.newComment=function(e){return new Kt(this,e)},ze.newTrashcan=function(e){return new lg(e)},$o.prototype.newWorkspaceSvg=function(e){return new ze(e)},o.Names$$module$build$src$core$names.prototype.populateProcedures=function(e){e=(e=Si(e))[0].concat(e[1]);for(let t=0;t<e.length;t++)this.getName(e[t][0],o.Names$$module$build$src$core$names.NameType.PROCEDURE)};var v={};return v.Block=zs,v.BlockFlyoutInflater=wg,v.BlockNavigationPolicy=Pp,v.BlockSvg=se,v.Blocks=ue,v.ButtonFlyoutInflater=xg,v.COLLAPSED_FIELD_NAME=Ll,v.COLLAPSED_INPUT_NAME=Kn,v.COLLAPSE_CHARS=30,v.CodeGenerator=o.CodeGenerator$$module$build$src$core$generator,v.CollapsibleToolboxCategory=Qs,v.ComponentManager=de,v.Connection=K,v.ConnectionChecker=ig,v.ConnectionDB=Ws,v.ConnectionNavigationPolicy=Fp,v.ConnectionType=M,v.ContextMenu=Gs,v.ContextMenuItems=Be,v.ContextMenuRegistry=q,v.Css=Jh,v.DELETE_VARIABLE_ID=jl,v.DeleteArea=Kl,v.DragTarget=Op,v.DropDownDiv=qe,v.Events=O,v.Extensions=Qt,v.Field=ee,v.FieldCheckbox=Xi,v.FieldDropdown=Ve,v.FieldImage=ji,v.FieldLabel=Vi,v.FieldLabelSerializable=vg,v.FieldNavigationPolicy=Up,v.FieldNumber=Hu,v.FieldTextInput=o.FieldTextInput$$module$build$src$core$field_textinput,v.FieldVariable=$r,v.Flyout=Ql,v.FlyoutButton=Qe,v.FlyoutButtonNavigationPolicy=Np,v.FlyoutItem=js,v.FlyoutMetricsManager=Mp,v.FlyoutNavigationPolicy=Lp,v.FlyoutNavigator=Zp,v.FlyoutSeparator=Jl,v.FlyoutSeparatorNavigationPolicy=Dp,v.FocusManager=Ze,v.FocusableTreeTraverser=Le,v.Generator=o.CodeGenerator$$module$build$src$core$generator,v.Gesture=tc,v.Grid=bu,v.HorizontalFlyout=Eg,v.INPUT_VALUE=PE,v.Input=qs,v.InsertionMarkerPreviewer=Tg,v.KeyboardNavigationController=Gp,v.LabelFlyoutInflater=hg,v.LineCursor=fu,v.Marker=qp,v.MarkerManager=Tu,v.Menu=Ua,v.MenuItem=Nl,v.MetricsManager=$u,v.Msg=o.Msg$$module$build$src$core$msg,v.NEXT_STATEMENT=FE,v.Names=o.Names$$module$build$src$core$names,v.Navigator=mu,v.OPPOSITE_TYPE=zo,v.OUTPUT_VALUE=BE,v.Options=Jt,v.PREVIOUS_STATEMENT=UE,v.PROCEDURE_CATEGORY_NAME=oc,v.Procedures=et,v.RENAME_VARIABLE_ID=zl,v.RenderedConnection=Pe,v.Scrollbar=be,v.ScrollbarPair=_u,v.SeparatorFlyoutInflater=Vp,v.ShortcutItems=bo,v.ShortcutRegistry=re,v.TOOLBOX_AT_BOTTOM=ZE,v.TOOLBOX_AT_LEFT=VE,v.TOOLBOX_AT_RIGHT=GE,v.TOOLBOX_AT_TOP=HE,v.Theme=Zi,v.ThemeManager=og,v.Themes=SE,v.Toast=Pi,v.Toolbox=Hg,v.ToolboxCategory=Dt,v.ToolboxItem=od,v.ToolboxSeparator=mr,v.Tooltip=Ct,v.Touch=Ls,v.Trashcan=lg,v.UnattachedFieldError=Te,v.VARIABLE_CATEGORY_NAME=Va,v.VARIABLE_DYNAMIC_CATEGORY_NAME=Au,v.VERSION="12.2.0",v.VariableMap=rg,v.VariableModel=ng,v.Variables=Ce,v.VariablesDynamic=qi,v.VerticalFlyout=Uu,v.WidgetDiv=Xt,v.Workspace=Xs,v.WorkspaceAudio=sg,v.WorkspaceDragger=Wp,v.WorkspaceNavigationPolicy=Hp,v.WorkspaceSvg=ze,v.Xml=Je,v.ZoomControls=tp,v.blockAnimations=Xl,v.blockRendering=oe,v.browserEvents=Ho,v.bubbles=pc,v.bumpObjects=gu,v.clipboard=io,v.comments=zi,v.common=De,v.config=o.config$$module$build$src$core$config,v.constants=X_,v.defineBlocksWithJsonArray=fr,v.dialog=Wo,v.dragging=hc,v.fieldRegistry=au,v.geras=To,v.getFocusManager=o.getFocusManager$$module$build$src$core$focus_manager,v.getMainWorkspace=st,v.getSelected=di,v.hasBubble=Ao,v.hideChaff=s$,v.icons=Gi,v.inject=mh,v.inputs=Yi,v.isCopyable=Yn,v.isDeletable=Xe,v.isDraggable=zt,v.isIcon=ks,v.isObservable=ct,v.isPaster=Dh,v.isRenderedElement=Ph,v.isSelectable=ss,v.isSerializable=us,v.isVariableBackedParameterModel=Or,v.keyboardNavigationController=ec,v.layers=nb,v.navigateBlock=lt,v.navigateStacks=po,v.procedures=et,v.registry=Uo,v.renderManagement=Za,v.serialization=wT,v.setLocale=ap,v.setParentContainer=gn,v.svgResize=dt,v.thrasos=Ug,v.uiPosition=Fs,v.utils=me,v.zelos=fo,v.__namespace__=o,v})?ce.apply(no,[]):ce)&&(Xo.exports=Fe)},8927:function(Xo,no,ce){var V,Fe,o;Fe=[ce(7519)],V=function(U){var d=U.__namespace__,tt=d.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"variables_get_dynamic",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_dynamic_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableDynamicSetterGetter"]},{type:"variables_set_dynamic",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_dynamic_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableDynamicSetterGetter"]}]),Ko={customContextMenu:function(c){if(this.isInFlyout)("variables_get_dynamic"===this.type||"variables_get_reporter_dynamic"===this.type)&&(b={text:d.Msg$$module$build$src$core$msg.RENAME_VARIABLE,enabled:!0,callback:Jo(this)},E=this.getField("VAR").getText(),E={text:d.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",E),enabled:!0,callback:ot(this)},c.unshift(b),c.unshift(E));else{if("variables_get_dynamic"===this.type)var g="variables_set_dynamic",b=d.Msg$$module$build$src$core$msg.VARIABLES_GET_CREATE_SET;else g="variables_get_dynamic",b=d.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET;var E=this.getField("VAR");g={type:g,fields:{VAR:E.saveState(!0)}},c.push({enabled:this.workspace.remainingCapacity()>0,text:b.replace("%1",E.getText()),callback:d.callbackFactory$$module$build$src$core$contextmenu(this,g)})}},onchange:function(c){c=this.getFieldValue("VAR"),c=d.getVariable$$module$build$src$core$variables(this.workspace,c),"variables_get_dynamic"===this.type?this.outputConnection.setCheck(c.getType()):this.getInput("VALUE").connection.setCheck(c.getType())}},Jo=function(c){return function(){const g=c.workspace,b=c.getField("VAR").getVariable();d.renameVariable$$module$build$src$core$variables(g,b)}},ot=function(c){return function(){const g=c.getField("VAR").getVariable();g&&d.deleteVariable$$module$build$src$core$variables(g.getWorkspace(),g,c)}};d.registerMixin$$module$build$src$core$extensions("contextMenu_variableDynamicSetterGetter",Ko),d.defineBlocks$$module$build$src$core$common(tt);var kt={blocks:tt},ro=d.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"variables_get",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableSetterGetter"]},{type:"variables_set",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableSetterGetter"]}]),Re={customContextMenu:function(c){if(this.isInFlyout)("variables_get"===this.type||"variables_get_reporter"===this.type)&&(b={text:d.Msg$$module$build$src$core$msg.RENAME_VARIABLE,enabled:!0,callback:lo(this)},E=this.getField("VAR").getText(),E={text:d.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",E),enabled:!0,callback:at(this)},c.unshift(b),c.unshift(E));else{if("variables_get"===this.type)var g="variables_set",b=d.Msg$$module$build$src$core$msg.VARIABLES_GET_CREATE_SET;else g="variables_get",b=d.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET;var E=this.getField("VAR");g={type:g,fields:{VAR:E.saveState(!0)}},c.push({enabled:this.workspace.remainingCapacity()>0,text:b.replace("%1",E.getText()),callback:d.callbackFactory$$module$build$src$core$contextmenu(this,g)})}}},lo=function(c){return function(){const g=c.workspace,b=c.getField("VAR").getVariable();d.renameVariable$$module$build$src$core$variables(g,b)}},at=function(c){return function(){const g=c.getField("VAR").getVariable();g&&d.deleteVariable$$module$build$src$core$variables(g.getWorkspace(),g,c)}};d.registerMixin$$module$build$src$core$extensions("contextMenu_variableSetterGetter",Re),d.defineBlocks$$module$build$src$core$common(ro);var Oe={blocks:ro},we=d.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"text",message0:"%1",args0:[{type:"field_input",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["text_quotes","parent_tooltip_when_inline"]},{type:"text_join",message0:"",output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_JOIN_HELPURL}",tooltip:"%{BKY_TEXT_JOIN_TOOLTIP}",mutator:"text_join_mutator"},{type:"text_create_join_container",message0:"%{BKY_TEXT_CREATE_JOIN_TITLE_JOIN} %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"STACK"}],style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_TOOLTIP}",enableContextMenu:!1},{type:"text_create_join_item",message0:"%{BKY_TEXT_CREATE_JOIN_ITEM_TITLE_ITEM}",previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_ITEM_TOOLTIP}",enableContextMenu:!1},{type:"text_append",message0:"%{BKY_TEXT_APPEND_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_TEXT_APPEND_VARIABLE}"},{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",extensions:["text_append_tooltip"]},{type:"text_length",message0:"%{BKY_TEXT_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"text_blocks",tooltip:"%{BKY_TEXT_LENGTH_TOOLTIP}",helpUrl:"%{BKY_TEXT_LENGTH_HELPURL}"},{type:"text_isEmpty",message0:"%{BKY_TEXT_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"text_blocks",tooltip:"%{BKY_TEXT_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_TEXT_ISEMPTY_HELPURL}"},{type:"text_indexOf",message0:"%{BKY_TEXT_INDEXOF_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"END",options:[["%{BKY_TEXT_INDEXOF_OPERATOR_FIRST}","FIRST"],["%{BKY_TEXT_INDEXOF_OPERATOR_LAST}","LAST"]]},{type:"input_value",name:"FIND",check:"String"}],output:"Number",style:"text_blocks",helpUrl:"%{BKY_TEXT_INDEXOF_HELPURL}",inputsInline:!0,extensions:["text_indexOf_tooltip"]},{type:"text_charAt",message0:"%{BKY_TEXT_CHARAT_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"WHERE",options:[["%{BKY_TEXT_CHARAT_FROM_START}","FROM_START"],["%{BKY_TEXT_CHARAT_FROM_END}","FROM_END"],["%{BKY_TEXT_CHARAT_FIRST}","FIRST"],["%{BKY_TEXT_CHARAT_LAST}","LAST"],["%{BKY_TEXT_CHARAT_RANDOM}","RANDOM"]]}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_CHARAT_HELPURL}",inputsInline:!0,mutator:"text_charAt_mutator"}]);we.text_getSubstring={init:function(){this.WHERE_OPTIONS_1=[[d.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FROM_START,"FROM_START"],[d.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FROM_END,"FROM_END"],[d.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[d.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_FROM_START,"FROM_START"],[d.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_FROM_END,"FROM_END"],[d.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_LAST,"LAST"]],this.setHelpUrl(d.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("STRING").setCheck("String").appendField(d.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT);const c=g=>{const b=d.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this["WHERE_OPTIONS_"+g]});return b.setValidator(function(E){const A=this.getValue();(E="FROM_START"===E||"FROM_END"===E)!=("FROM_START"===A||"FROM_END"===A)&&this.getSourceBlock().updateAt_(g,E)}),b};this.appendDummyInput("WHERE1_INPUT").appendField(c(1),"WHERE1"),this.appendDummyInput("AT1"),this.appendDummyInput("WHERE2_INPUT").appendField(c(2),"WHERE2"),this.appendDummyInput("AT2"),d.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL&&this.appendDummyInput("TAIL").appendField(d.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL),this.setInputsInline(!0),this.setOutput(!0,"String"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(d.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TOOLTIP)},mutationToDom:function(){const c=d.createElement$$module$build$src$core$utils$xml("mutation");var g=this.getInput("AT1")instanceof d.ValueInput$$module$build$src$core$inputs$value_input;return c.setAttribute("at1",`${g}`),g=this.getInput("AT2")instanceof d.ValueInput$$module$build$src$core$inputs$value_input,c.setAttribute("at2",`${g}`),c},domToMutation:function(c){const g="true"===c.getAttribute("at1");c="true"===c.getAttribute("at2"),this.updateAt_(1,g),this.updateAt_(2,c)},updateAt_:function(c,g){this.removeInput("AT"+c),this.removeInput("ORDINAL"+c,!0),g?(this.appendValueInput("AT"+c).setCheck("Number"),d.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+c).appendField(d.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+c),2===c&&d.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(d.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL)),1===c&&(this.moveInputBefore("AT1","WHERE2_INPUT"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","WHERE2_INPUT"))}},we.text_changeCase={init:function(){const c=[[d.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE,"UPPERCASE"],[d.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE,"LOWERCASE"],[d.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_TITLECASE,"TITLECASE"]];this.setHelpUrl(d.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(d.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:c}),"CASE"),this.setOutput(!0,"String"),this.setTooltip(d.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_TOOLTIP)}},we.text_trim={init:function(){const c=[[d.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_BOTH,"BOTH"],[d.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_LEFT,"LEFT"],[d.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_RIGHT,"RIGHT"]];this.setHelpUrl(d.Msg$$module$build$src$core$msg.TEXT_TRIM_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(d.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:c}),"MODE"),this.setOutput(!0,"String"),this.setTooltip(d.Msg$$module$build$src$core$msg.TEXT_TRIM_TOOLTIP)}},we.text_print={init:function(){this.jsonInit({message0:d.Msg$$module$build$src$core$msg.TEXT_PRINT_TITLE,args0:[{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:d.Msg$$module$build$src$core$msg.TEXT_PRINT_TOOLTIP,helpUrl:d.Msg$$module$build$src$core$msg.TEXT_PRINT_HELPURL})}};var Qo={updateType_:function(c){this.outputConnection.setCheck("NUMBER"===c?"Number":"String")},mutationToDom:function(){const c=d.createElement$$module$build$src$core$utils$xml("mutation");return c.setAttribute("type",this.getFieldValue("TYPE")),c},domToMutation:function(c){this.updateType_(c.getAttribute("type"))}};we.text_prompt_ext=Object.assign({},Qo,{init:function(){var c=[[d.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[d.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(d.Msg$$module$build$src$core$msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),(c=d.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:c})).setValidator(g=>{this.updateType_(g)}),this.appendValueInput("TEXT").appendField(c,"TYPE"),this.setOutput(!0,"String"),this.setTooltip(()=>"TEXT"===this.getFieldValue("TYPE")?d.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_TEXT:d.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_NUMBER)}}),we.text_prompt=Object.assign({},Qo,{init:function(){this.mixin(N);var c=[[d.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[d.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(d.Msg$$module$build$src$core$msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),(c=d.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:c})).setValidator(g=>{this.updateType_(g)}),this.appendDummyInput().appendField(c,"TYPE").appendField(this.newQuote_(!0)).appendField(d.fromJson$$module$build$src$core$field_registry({type:"field_input",text:""}),"TEXT").appendField(this.newQuote_(!1)),this.setOutput(!0,"String"),this.setTooltip(()=>"TEXT"===this.getFieldValue("TYPE")?d.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_TEXT:d.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_NUMBER)}}),we.text_count={init:function(){this.jsonInit({message0:d.Msg$$module$build$src$core$msg.TEXT_COUNT_MESSAGE0,args0:[{type:"input_value",name:"SUB",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"Number",inputsInline:!0,style:"text_blocks",tooltip:d.Msg$$module$build$src$core$msg.TEXT_COUNT_TOOLTIP,helpUrl:d.Msg$$module$build$src$core$msg.TEXT_COUNT_HELPURL})}},we.text_replace={init:function(){this.jsonInit({message0:d.Msg$$module$build$src$core$msg.TEXT_REPLACE_MESSAGE0,args0:[{type:"input_value",name:"FROM",check:"String"},{type:"input_value",name:"TO",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:d.Msg$$module$build$src$core$msg.TEXT_REPLACE_TOOLTIP,helpUrl:d.Msg$$module$build$src$core$msg.TEXT_REPLACE_HELPURL})}},we.text_reverse={init:function(){this.jsonInit({message0:d.Msg$$module$build$src$core$msg.TEXT_REVERSE_MESSAGE0,args0:[{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:d.Msg$$module$build$src$core$msg.TEXT_REVERSE_TOOLTIP,helpUrl:d.Msg$$module$build$src$core$msg.TEXT_REVERSE_HELPURL})}};var N={QUOTE_IMAGE_LEFT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAn0lEQVQI1z3OMa5BURSF4f/cQhAKjUQhuQmFNwGJEUi0RKN5rU7FHKhpjEH3TEMtkdBSCY1EIv8r7nFX9e29V7EBAOvu7RPjwmWGH/VuF8CyN9/OAdvqIXYLvtRaNjx9mMTDyo+NjAN1HNcl9ZQ5oQMM3dgDUqDo1l8DzvwmtZN7mnD+PkmLa+4mhrxVA9fRowBWmVBhFy5gYEjKMfz9AylsaRRgGzvZAAAAAElFTkSuQmCC",QUOTE_IMAGE_RIGHT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAqUlEQVQI1z3KvUpCcRiA8ef9E4JNHhI0aFEacm1o0BsI0Slx8wa8gLauoDnoBhq7DcfWhggONDmJJgqCPA7neJ7p934EOOKOnM8Q7PDElo/4x4lFb2DmuUjcUzS3URnGib9qaPNbuXvBO3sGPHJDRG6fGVdMSeWDP2q99FQdFrz26Gu5Tq7dFMzUvbXy8KXeAj57cOklgA+u1B5AoslLtGIHQMaCVnwDnADZIFIrXsoXrgAAAABJRU5ErkJggg==",QUOTE_IMAGE_WIDTH:12,QUOTE_IMAGE_HEIGHT:12,quoteField_:function(c){for(let b,g=0;b=this.inputList[g];g++)for(let A,E=0;A=b.fieldRow[E];E++)if(c===A.name)return b.insertFieldAt(E,this.newQuote_(!0)),void b.insertFieldAt(E+2,this.newQuote_(!1));console.warn('field named "'+c+'" not found in '+this.toDevString())},newQuote_:function(c){return d.fromJson$$module$build$src$core$field_registry({type:"field_image",src:(c=this.RTL?!c:c)?this.QUOTE_IMAGE_LEFT_DATAURI:this.QUOTE_IMAGE_RIGHT_DATAURI,width:this.QUOTE_IMAGE_WIDTH,height:this.QUOTE_IMAGE_HEIGHT,alt:c?"\u201c":"\u201d"})}},J={itemCount_:0,mutationToDom:function(){const c=d.createElement$$module$build$src$core$utils$xml("mutation");return c.setAttribute("items",`${this.itemCount_}`),c},domToMutation:function(c){this.itemCount_=parseInt(c.getAttribute("items"),10),this.updateShape_()},saveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function(c){this.itemCount_=c.itemCount,this.updateShape_()},decompose:function(c){const g=c.newBlock("text_create_join_container");g.initSvg();let b=g.getInput("STACK").connection;for(let E=0;E<this.itemCount_;E++){const A=c.newBlock("text_create_join_item");A.initSvg(),b.connect(A.previousConnection),b=A.nextConnection}return g},compose:function(c){var g=c.getInputTargetBlock("STACK");for(c=[];g;)g.isInsertionMarker()||c.push(g.valueConnection_),g=g.getNextBlock();for(g=0;g<this.itemCount_;g++){const b=this.getInput("ADD"+g).connection.targetConnection;b&&!c.includes(b)&&b.disconnect()}for(this.itemCount_=c.length,this.updateShape_(),g=0;g<this.itemCount_;g++){let b;null==(b=c[g])||b.reconnect(this,"ADD"+g)}},saveConnections:function(c){c=c.getInputTargetBlock("STACK");let g=0;for(;c;){if(c.isInsertionMarker()){c=c.getNextBlock();continue}const b=this.getInput("ADD"+g);c.valueConnection_=b&&b.connection.targetConnection,c=c.getNextBlock(),g++}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(this.newQuote_(!0)).appendField(this.newQuote_(!1));for(var c=0;c<this.itemCount_;c++)if(!this.getInput("ADD"+c)){const g=this.appendValueInput("ADD"+c).setAlign(d.Align$$module$build$src$core$inputs$align.RIGHT);0===c&&g.appendField(d.Msg$$module$build$src$core$msg.TEXT_JOIN_TITLE_CREATEWITH)}for(c=this.itemCount_;this.getInput("ADD"+c);c++)this.removeInput("ADD"+c)}};d.register$$module$build$src$core$extensions("text_append_tooltip",d.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_TEXT_APPEND_TOOLTIP}","VAR"));var wt={isAt_:!1,mutationToDom:function(){const c=d.createElement$$module$build$src$core$utils$xml("mutation");return c.setAttribute("at",`${this.isAt_}`),c},domToMutation:function(c){c="false"!==c.getAttribute("at"),this.updateAt_(c)},updateAt_:function(c){this.removeInput("AT",!0),this.removeInput("ORDINAL",!0),c&&(this.appendValueInput("AT").setCheck("Number"),d.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(d.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)),d.Msg$$module$build$src$core$msg.TEXT_CHARAT_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(d.Msg$$module$build$src$core$msg.TEXT_CHARAT_TAIL)),this.isAt_=c}};d.register$$module$build$src$core$extensions("text_indexOf_tooltip",function(){this.setTooltip(()=>d.Msg$$module$build$src$core$msg.TEXT_INDEXOF_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"0":"-1"))}),d.register$$module$build$src$core$extensions("text_quotes",function(){this.mixin(N),this.quoteField_("TEXT")}),d.registerMixin$$module$build$src$core$extensions("quote_image_mixin",N),d.registerMutator$$module$build$src$core$extensions("text_join_mutator",J,function(){this.mixin(N),this.itemCount_=2,this.updateShape_(),this.setMutator(new d.MutatorIcon$$module$build$src$core$icons$mutator_icon(["text_create_join_item"],this))}),d.registerMutator$$module$build$src$core$extensions("text_charAt_mutator",wt,function(){this.getField("WHERE").setValidator(function(c){c="FROM_START"===c||"FROM_END"===c;const g=this.getSourceBlock();c!==g.isAt_&&g.updateAt_(c)}),this.updateAt_(!0),this.setTooltip(()=>{var c=this.getFieldValue("WHERE");let g=d.Msg$$module$build$src$core$msg.TEXT_CHARAT_TOOLTIP;return("FROM_START"===c||"FROM_END"===c)&&(c="FROM_START"===c?d.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP:d.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_END_TOOLTIP)&&(g+="  "+c.replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),g})}),d.defineBlocks$$module$build$src$core$common(we);var Ee={blocks:we},ve={},ao={setStatements_:function(c){this.hasStatements_!==c&&(c?(this.appendStatementInput("STACK").appendField(d.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_DO),this.getInput("RETURN")&&this.moveInputBefore("STACK","RETURN")):this.removeInput("STACK",!0),this.hasStatements_=c)},updateParams_:function(){let c="";this.arguments_.length&&(c=d.Msg$$module$build$src$core$msg.PROCEDURES_BEFORE_PARAMS+" "+this.arguments_.join(", ")),d.disable$$module$build$src$core$events$utils();try{this.setFieldValue(c,"PARAMS")}finally{d.enable$$module$build$src$core$events$utils()}},mutationToDom:function(c){const g=d.createElement$$module$build$src$core$utils$xml("mutation");c&&g.setAttribute("name",this.getFieldValue("NAME"));for(let b=0;b<this.argumentVarModels_.length;b++){const E=d.createElement$$module$build$src$core$utils$xml("arg"),A=this.argumentVarModels_[b];E.setAttribute("name",A.getName()),E.setAttribute("varid",A.getId()),c&&this.paramIds_&&E.setAttribute("paramId",this.paramIds_[b]),g.appendChild(E)}return this.hasStatements_||g.setAttribute("statements","false"),g},domToMutation:function(c){this.arguments_=[],this.argumentVarModels_=[];for(let E,b=0;E=c.childNodes[b];b++)if("arg"===E.nodeName.toLowerCase()){var g=E;const A=g.getAttribute("name");g=g.getAttribute("varid")||g.getAttribute("varId"),this.arguments_.push(A),null!==(g=d.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,g,A,""))?this.argumentVarModels_.push(g):console.log(`Failed to create a variable named "${A}", ignoring.`)}this.updateParams_(),d.mutateCallers$$module$build$src$core$procedures(this),this.setStatements_("false"!==c.getAttribute("statements"))},saveExtraState:function(){if(!this.argumentVarModels_.length&&this.hasStatements_)return null;const c=Object.create(null);if(this.argumentVarModels_.length){c.params=[];for(let g=0;g<this.argumentVarModels_.length;g++)c.params.push({name:this.argumentVarModels_[g].getName(),id:this.argumentVarModels_[g].getId()})}return this.hasStatements_||(c.hasStatements=!1),c},loadExtraState:function(c){if(this.arguments_=[],this.argumentVarModels_=[],c.params)for(let b=0;b<c.params.length;b++){var g=c.params[b];g=d.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,g.id,g.name,""),this.arguments_.push(g.getName()),this.argumentVarModels_.push(g)}this.updateParams_(),d.mutateCallers$$module$build$src$core$procedures(this),this.setStatements_(!1!==c.hasStatements)},decompose:function(c){const g=d.createElement$$module$build$src$core$utils$xml("block");g.setAttribute("type","procedures_mutatorcontainer");var b=d.createElement$$module$build$src$core$utils$xml("statement");b.setAttribute("name","STACK"),g.appendChild(b);for(let A=0;A<this.arguments_.length;A++){const he=d.createElement$$module$build$src$core$utils$xml("block");he.setAttribute("type","procedures_mutatorarg");var E=d.createElement$$module$build$src$core$utils$xml("field");E.setAttribute("name","NAME");const ut=d.createTextNode$$module$build$src$core$utils$xml(this.arguments_[A]);E.appendChild(ut),he.appendChild(E),E=d.createElement$$module$build$src$core$utils$xml("next"),he.appendChild(E),b.appendChild(he),b=E}return c=d.domToBlock$$module$build$src$core$xml(g,c),"procedures_defreturn"===this.type?c.setFieldValue(this.hasStatements_,"STATEMENTS"):c.removeInput("STATEMENT_INPUT"),d.mutateCallers$$module$build$src$core$procedures(this),c},compose:function(c){this.arguments_=[],this.paramIds_=[],this.argumentVarModels_=[];let g=c.getInputTargetBlock("STACK");for(;g&&!g.isInsertionMarker();){var b=g.getFieldValue("NAME");this.arguments_.push(b),b=this.workspace.getVariable(b,""),this.argumentVarModels_.push(b),this.paramIds_.push(g.id),g=g.nextConnection&&g.nextConnection.targetBlock()}if(this.updateParams_(),d.mutateCallers$$module$build$src$core$procedures(this),null!==(c=c.getFieldValue("STATEMENTS"))&&this.hasStatements_!==(c="TRUE"===c))if(c){var E;this.setStatements_(!0),null==(E=this.statementConnection_)||E.reconnect(this,"STACK"),this.statementConnection_=null}else E=this.getInput("STACK").connection,(this.statementConnection_=E.targetConnection)&&((E=E.targetBlock()).unplug(),E.bumpNeighbours()),this.setStatements_(!1)},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},renameVarById:function(c,g){var b=this.workspace.getVariableById(c);if(""===b.getType()){b=b.getName(),g=this.workspace.getVariableById(g);var E=!1;for(let A=0;A<this.argumentVarModels_.length;A++)this.argumentVarModels_[A].getId()===c&&(this.arguments_[A]=g.getName(),this.argumentVarModels_[A]=g,E=!0);E&&(this.displayRenamedVar_(b,g.getName()),d.mutateCallers$$module$build$src$core$procedures(this))}},updateVarName:function(c){const g=c.getName();let E,b=!1;for(let A=0;A<this.argumentVarModels_.length;A++)this.argumentVarModels_[A].getId()===c.getId()&&(E=this.arguments_[A],this.arguments_[A]=g,b=!0);b&&(this.displayRenamedVar_(E,g),d.mutateCallers$$module$build$src$core$procedures(this))},displayRenamedVar_:function(c,g){this.updateParams_();var b=this.getIcon(d.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE);if(b&&b.bubbleIsVisible()){b=b.getWorkspace().getAllBlocks(!1);for(let A,E=0;A=b[E];E++)"procedures_mutatorarg"===A.type&&d.Names$$module$build$src$core$names.equals(c,A.getFieldValue("NAME"))&&A.setFieldValue(g,"NAME")}},customContextMenu:function(c){if(!this.isInFlyout){var g=this.getFieldValue("NAME"),b={type:this.callType_,extraState:{name:g,params:this.arguments_}};if(c.push({enabled:!0,text:d.Msg$$module$build$src$core$msg.PROCEDURES_CREATE_DO.replace("%1",g),callback:d.callbackFactory$$module$build$src$core$contextmenu(this,b)}),!this.isCollapsed())for(g=0;g<this.argumentVarModels_.length;g++){const E={type:"variables_get",fields:{VAR:{name:(b=this.argumentVarModels_[g]).getName(),id:b.getId(),type:b.getType()}}};c.push({enabled:!0,text:d.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET.replace("%1",b.getName()),callback:d.callbackFactory$$module$build$src$core$contextmenu(this,E)})}}}};ve.procedures_defnoreturn=Object.assign({},ao,{init:function(){var c=d.findLegalName$$module$build$src$core$procedures("",this);(c=d.fromJson$$module$build$src$core$field_registry({type:"field_input",text:c})).setValidator(d.rename$$module$build$src$core$procedures),c.setSpellcheck(!1),this.appendDummyInput().appendField(d.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_TITLE).appendField(c,"NAME").appendField("","PARAMS"),this.setMutator(new d.MutatorIcon$$module$build$src$core$icons$mutator_icon(["procedures_mutatorarg"],this)),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&d.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_COMMENT&&this.setCommentText(d.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(d.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_TOOLTIP),this.setHelpUrl(d.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!1]},callType_:"procedures_callnoreturn"}),ve.procedures_defreturn=Object.assign({},ao,{init:function(){var c=d.findLegalName$$module$build$src$core$procedures("",this);(c=d.fromJson$$module$build$src$core$field_registry({type:"field_input",text:c})).setValidator(d.rename$$module$build$src$core$procedures),c.setSpellcheck(!1),this.appendDummyInput().appendField(d.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_TITLE).appendField(c,"NAME").appendField("","PARAMS"),this.appendValueInput("RETURN").setAlign(d.Align$$module$build$src$core$inputs$align.RIGHT).appendField(d.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.setMutator(new d.MutatorIcon$$module$build$src$core$icons$mutator_icon(["procedures_mutatorarg"],this)),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&d.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_COMMENT&&this.setCommentText(d.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(d.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_TOOLTIP),this.setHelpUrl(d.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!0]},callType_:"procedures_callreturn"}),ve.procedures_mutatorcontainer={init:function(){this.appendDummyInput().appendField(d.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORCONTAINER_TITLE),this.appendStatementInput("STACK"),this.appendDummyInput("STATEMENT_INPUT").appendField(d.Msg$$module$build$src$core$msg.PROCEDURES_ALLOW_STATEMENTS).appendField(d.fromJson$$module$build$src$core$field_registry({type:"field_checkbox",checked:!0}),"STATEMENTS"),this.setStyle("procedure_blocks"),this.setTooltip(d.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP),this.contextMenu=!1}};var Pt=class extends d.FieldTextInput$$module$build$src$core$field_textinput{constructor(){super(...arguments),this.editingInteractively=!1}showEditor_(c){super.showEditor_(c),this.editingInteractively=!0,this.editingVariable=void 0}onFinishEditing_(c){super.onFinishEditing_(c),this.editingInteractively=!1}};ve.procedures_mutatorarg={init:function(){const c=new Pt(d.DEFAULT_ARG$$module$build$src$core$procedures,this.validator_);this.appendDummyInput().appendField(d.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORARG_TITLE).appendField(c,"NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(d.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORARG_TOOLTIP),this.contextMenu=!1},validator_:function(c){var g=this.getSourceBlock();const b=g.workspace.getRootWorkspace();if(!(c=c.replace(/[\s\xa0]+/g," ").replace(/^ | $/g,"")))return null;const E=(g.workspace.targetWorkspace||g.workspace).getAllBlocks(!1),A=c.toLowerCase();for(let he=0;he<E.length;he++){if(E[he].id===this.getSourceBlock().id)continue;const ut=E[he].getFieldValue("NAME");if(ut&&ut.toLowerCase()===A)return null}return g.isInFlyout||((g=b.getVariable(c,""))&&g.getName()!==c&&b.renameVariableById(g.getId(),c),g||(this.editingInteractively?this.editingVariable?b.renameVariableById(this.editingVariable.getId(),c):this.editingVariable=b.createVariable(c,""):b.createVariable(c,""))),c}};var Bt="DISABLED_PROCEDURE_DEFINITION",Ji={getProcedureCall:function(){return this.getFieldValue("NAME")},renameProcedure:function(c,g){d.Names$$module$build$src$core$names.equals(c,this.getProcedureCall())&&(this.setFieldValue(g,"NAME"),this.setTooltip((this.outputConnection?d.Msg$$module$build$src$core$msg.PROCEDURES_CALLRETURN_TOOLTIP:d.Msg$$module$build$src$core$msg.PROCEDURES_CALLNORETURN_TOOLTIP).replace("%1",g)))},setProcedureParameters_:function(c,g){var b=d.getDefinition$$module$build$src$core$procedures(this.getProcedureCall(),this.workspace);if((b=(b=b&&b.getIcon(d.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE))&&b.bubbleIsVisible())?this.setCollapsed(!1):(this.quarkConnections_={},this.quarkIds_=null),c.join("\n")===this.arguments_.join("\n"))this.quarkIds_=g;else{if(g.length!==c.length)throw RangeError("paramNames and paramIds must be the same length.");this.quarkIds_||(this.quarkConnections_={},this.quarkIds_=[]);for(let A=0;A<this.arguments_.length;A++){var E=this.getInput("ARG"+A);E&&(this.quarkConnections_[this.quarkIds_[A]]=E=E.connection.targetConnection,b&&E&&!g.includes(this.quarkIds_[A])&&(E.disconnect(),E.getSourceBlock().bumpNeighbours()))}for(this.arguments_=[].concat(c),this.argumentVarModels_=[],c=0;c<this.arguments_.length;c++)b=d.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,null,this.arguments_[c],""),this.argumentVarModels_.push(b);if(this.updateShape_(),this.quarkIds_=g)for(g=0;g<this.arguments_.length;g++)if((c=this.quarkIds_[g])in this.quarkConnections_){let A;null!=(A=this.quarkConnections_[c])&&A.reconnect(this,"ARG"+g)||delete this.quarkConnections_[c]}}},updateShape_:function(){for(var c=0;c<this.arguments_.length;c++){var g=this.getField("ARGNAME"+c);if(g){d.disable$$module$build$src$core$events$utils();try{g.setValue(this.arguments_[c])}finally{d.enable$$module$build$src$core$events$utils()}}else g=d.fromJson$$module$build$src$core$field_registry({type:"field_label",text:this.arguments_[c]}),this.appendValueInput("ARG"+c).setAlign(d.Align$$module$build$src$core$inputs$align.RIGHT).appendField(g,"ARGNAME"+c)}for(c=this.arguments_.length;this.getInput("ARG"+c);c++)this.removeInput("ARG"+c);(c=this.getInput("TOPROW"))&&(this.arguments_.length?this.getField("WITH")||c.appendField(d.Msg$$module$build$src$core$msg.PROCEDURES_CALL_BEFORE_PARAMS,"WITH"):this.getField("WITH")&&c.removeField("WITH"))},mutationToDom:function(){const c=d.createElement$$module$build$src$core$utils$xml("mutation");c.setAttribute("name",this.getProcedureCall());for(let g=0;g<this.arguments_.length;g++){const b=d.createElement$$module$build$src$core$utils$xml("arg");b.setAttribute("name",this.arguments_[g]),c.appendChild(b)}return c},domToMutation:function(c){var g=c.getAttribute("name");this.renameProcedure(this.getProcedureCall(),g),g=[];const b=[];for(let A,E=0;A=c.childNodes[E];E++)"arg"===A.nodeName.toLowerCase()&&(g.push(A.getAttribute("name")),b.push(A.getAttribute("paramId")));this.setProcedureParameters_(g,b)},saveExtraState:function(){const c=Object.create(null);return c.name=this.getProcedureCall(),this.arguments_.length&&(c.params=this.arguments_),c},loadExtraState:function(c){if(this.renameProcedure(this.getProcedureCall(),c.name),c=c.params){const g=[];g.length=c.length,g.fill(null),this.setProcedureParameters_(c,g)}},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},onchange:function(c){if(this.workspace&&!this.workspace.isFlyout&&c.recordUndo)if(c.type===d.BLOCK_CREATE$$module$build$src$core$events$events&&c.ids.includes(this.id)){var g=this.getProcedureCall(),b=d.getDefinition$$module$build$src$core$procedures(g,this.workspace);if(!b||b.type===this.defType_&&JSON.stringify(b.getVars())===JSON.stringify(this.arguments_)||(b=null),b)b.isEnabled()||(this.setDisabledReason(!0,Bt),this.setWarningText(d.Msg$$module$build$src$core$msg.PROCEDURES_CALL_DISABLED_DEF_WARNING.replace("%1",g)));else{d.setGroup$$module$build$src$core$events$utils(c.group),c=d.createElement$$module$build$src$core$utils$xml("xml"),(g=d.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type",this.defType_);var E=(b=this.getRelativeToSurfaceXY()).y+2*d.config$$module$build$src$core$config.snapRadius;g.setAttribute("x",`${b.x+d.config$$module$build$src$core$config.snapRadius*(this.RTL?-1:1)}`),g.setAttribute("y",`${E}`),b=this.mutationToDom(),g.appendChild(b),(b=d.createElement$$module$build$src$core$utils$xml("field")).setAttribute("name","NAME"),E=this.getProcedureCall();const A=d.findLegalName$$module$build$src$core$procedures(E,this);E!==A&&this.renameProcedure(E,A),b.appendChild(d.createTextNode$$module$build$src$core$utils$xml(E)),g.appendChild(b),c.appendChild(g),d.domToWorkspace$$module$build$src$core$xml(c,this.workspace),d.setGroup$$module$build$src$core$events$utils(!1)}}else c.type===d.BLOCK_DELETE$$module$build$src$core$events$events?(g=this.getProcedureCall(),d.getDefinition$$module$build$src$core$procedures(g,this.workspace)||(d.setGroup$$module$build$src$core$events$utils(c.group),this.dispose(!0),d.setGroup$$module$build$src$core$events$utils(!1))):c.type===d.BLOCK_CHANGE$$module$build$src$core$events$events&&"disabled"===c.element&&(g=this.getProcedureCall(),(E=d.getDefinition$$module$build$src$core$procedures(g,this.workspace))&&E.id===c.blockId&&((b=d.getGroup$$module$build$src$core$events$utils())&&console.log("Saw an existing group while responding to a definition change"),d.setGroup$$module$build$src$core$events$utils(c.group),c=E.isEnabled(),this.setDisabledReason(!c,Bt),this.setWarningText(c?null:d.Msg$$module$build$src$core$msg.PROCEDURES_CALL_DISABLED_DEF_WARNING.replace("%1",g)),d.setGroup$$module$build$src$core$events$utils(b)))},customContextMenu:function(c){if(this.workspace.isMovable()){var g=this.getProcedureCall(),b=this.workspace;c.push({enabled:!0,text:d.Msg$$module$build$src$core$msg.PROCEDURES_HIGHLIGHT_DEF,callback:function(){const E=d.getDefinition$$module$build$src$core$procedures(g,b);E&&(b.centerOnBlock(E.id),d.getFocusManager$$module$build$src$core$focus_manager().focusNode(E))}})}}};ve.procedures_callnoreturn=Object.assign({},Ji,{init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(d.Msg$$module$build$src$core$msg.PROCEDURES_CALLNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null},defType_:"procedures_defnoreturn"}),ve.procedures_callreturn=Object.assign({},Ji,{init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setOutput(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(d.Msg$$module$build$src$core$msg.PROCEDURES_CALLRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null},defType_:"procedures_defreturn"});ve.procedures_ifreturn={init:function(){this.appendValueInput("CONDITION").setCheck("Boolean").appendField(d.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_IF),this.appendValueInput("VALUE").appendField(d.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(d.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_TOOLTIP),this.setHelpUrl(d.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_HELPURL),this.hasReturnValue_=!0},mutationToDom:function(){const c=d.createElement$$module$build$src$core$utils$xml("mutation");return c.setAttribute("value",String(Number(this.hasReturnValue_))),c},domToMutation:function(c){this.hasReturnValue_="1"===c.getAttribute("value"),this.hasReturnValue_||(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(d.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN))},onchange:function(c){if(!(this.workspace.isDragging&&this.workspace.isDragging()||c.type!==d.BLOCK_MOVE$$module$build$src$core$events$events&&c.type!==d.BLOCK_CREATE$$module$build$src$core$events$events)){c=!1;var g=this;do{if(this.FUNCTION_TYPES.includes(g.type)){c=!0;break}g=g.getSurroundParent()}while(g);if(c?("procedures_defnoreturn"===g.type&&this.hasReturnValue_?(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(d.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!1):"procedures_defreturn"!==g.type||this.hasReturnValue_||(this.removeInput("VALUE"),this.appendValueInput("VALUE").appendField(d.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!0),this.setWarningText(null)):this.setWarningText(d.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_WARNING),!this.isInFlyout)try{d.setRecordUndo$$module$build$src$core$events$utils(!1),this.setDisabledReason(!c,"UNPARENTED_IFRETURN")}finally{d.setRecordUndo$$module$build$src$core$events$utils(!0)}}},FUNCTION_TYPES:["procedures_defnoreturn","procedures_defreturn"]},d.defineBlocks$$module$build$src$core$common(ve);var on={blocks:ve},ti=d.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"math_number",message0:"%1",args0:[{type:"field_number",name:"NUM",value:0}],output:"Number",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",style:"math_blocks",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"math_arithmetic",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Number"},{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ADDITION_SYMBOL}","ADD"],["%{BKY_MATH_SUBTRACTION_SYMBOL}","MINUS"],["%{BKY_MATH_MULTIPLICATION_SYMBOL}","MULTIPLY"],["%{BKY_MATH_DIVISION_SYMBOL}","DIVIDE"],["%{BKY_MATH_POWER_SYMBOL}","POWER"]]},{type:"input_value",name:"B",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ARITHMETIC_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_single",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_SINGLE_OP_ROOT}","ROOT"],["%{BKY_MATH_SINGLE_OP_ABSOLUTE}","ABS"],["-","NEG"],["ln","LN"],["log10","LOG10"],["e^","EXP"],["10^","POW10"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_SINGLE_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_trig",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_TRIG_SIN}","SIN"],["%{BKY_MATH_TRIG_COS}","COS"],["%{BKY_MATH_TRIG_TAN}","TAN"],["%{BKY_MATH_TRIG_ASIN}","ASIN"],["%{BKY_MATH_TRIG_ACOS}","ACOS"],["%{BKY_MATH_TRIG_ATAN}","ATAN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_TRIG_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_constant",message0:"%1",args0:[{type:"field_dropdown",name:"CONSTANT",options:[["\u03c0","PI"],["e","E"],["\u03c6","GOLDEN_RATIO"],["sqrt(2)","SQRT2"],["sqrt(\xbd)","SQRT1_2"],["\u221e","INFINITY"]]}],output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTANT_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTANT_HELPURL}"},{type:"math_number_property",message0:"%1 %2",args0:[{type:"input_value",name:"NUMBER_TO_CHECK",check:"Number"},{type:"field_dropdown",name:"PROPERTY",options:[["%{BKY_MATH_IS_EVEN}","EVEN"],["%{BKY_MATH_IS_ODD}","ODD"],["%{BKY_MATH_IS_PRIME}","PRIME"],["%{BKY_MATH_IS_WHOLE}","WHOLE"],["%{BKY_MATH_IS_POSITIVE}","POSITIVE"],["%{BKY_MATH_IS_NEGATIVE}","NEGATIVE"],["%{BKY_MATH_IS_DIVISIBLE_BY}","DIVISIBLE_BY"]]}],inputsInline:!0,output:"Boolean",style:"math_blocks",tooltip:"%{BKY_MATH_IS_TOOLTIP}",mutator:"math_is_divisibleby_mutator"},{type:"math_change",message0:"%{BKY_MATH_CHANGE_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_MATH_CHANGE_TITLE_ITEM}"},{type:"input_value",name:"DELTA",check:"Number"}],previousStatement:null,nextStatement:null,style:"variable_blocks",helpUrl:"%{BKY_MATH_CHANGE_HELPURL}",extensions:["math_change_tooltip"]},{type:"math_round",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ROUND_OPERATOR_ROUND}","ROUND"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDUP}","ROUNDUP"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDDOWN}","ROUNDDOWN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ROUND_HELPURL}",tooltip:"%{BKY_MATH_ROUND_TOOLTIP}"},{type:"math_on_list",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ONLIST_OPERATOR_SUM}","SUM"],["%{BKY_MATH_ONLIST_OPERATOR_MIN}","MIN"],["%{BKY_MATH_ONLIST_OPERATOR_MAX}","MAX"],["%{BKY_MATH_ONLIST_OPERATOR_AVERAGE}","AVERAGE"],["%{BKY_MATH_ONLIST_OPERATOR_MEDIAN}","MEDIAN"],["%{BKY_MATH_ONLIST_OPERATOR_MODE}","MODE"],["%{BKY_MATH_ONLIST_OPERATOR_STD_DEV}","STD_DEV"],["%{BKY_MATH_ONLIST_OPERATOR_RANDOM}","RANDOM"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ONLIST_HELPURL}",mutator:"math_modes_of_list_mutator",extensions:["math_op_tooltip"]},{type:"math_modulo",message0:"%{BKY_MATH_MODULO_TITLE}",args0:[{type:"input_value",name:"DIVIDEND",check:"Number"},{type:"input_value",name:"DIVISOR",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_MODULO_TOOLTIP}",helpUrl:"%{BKY_MATH_MODULO_HELPURL}"},{type:"math_constrain",message0:"%{BKY_MATH_CONSTRAIN_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"Number"},{type:"input_value",name:"LOW",check:"Number"},{type:"input_value",name:"HIGH",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTRAIN_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTRAIN_HELPURL}"},{type:"math_random_int",message0:"%{BKY_MATH_RANDOM_INT_TITLE}",args0:[{type:"input_value",name:"FROM",check:"Number"},{type:"input_value",name:"TO",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_INT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_INT_HELPURL}"},{type:"math_random_float",message0:"%{BKY_MATH_RANDOM_FLOAT_TITLE_RANDOM}",output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_FLOAT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_FLOAT_HELPURL}"},{type:"math_atan2",message0:"%{BKY_MATH_ATAN2_TITLE}",args0:[{type:"input_value",name:"X",check:"Number"},{type:"input_value",name:"Y",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_ATAN2_TOOLTIP}",helpUrl:"%{BKY_MATH_ATAN2_HELPURL}"}]);d.register$$module$build$src$core$extensions("math_op_tooltip",d.buildTooltipForDropdown$$module$build$src$core$extensions("OP",{ADD:"%{BKY_MATH_ARITHMETIC_TOOLTIP_ADD}",MINUS:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MINUS}",MULTIPLY:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MULTIPLY}",DIVIDE:"%{BKY_MATH_ARITHMETIC_TOOLTIP_DIVIDE}",POWER:"%{BKY_MATH_ARITHMETIC_TOOLTIP_POWER}",ROOT:"%{BKY_MATH_SINGLE_TOOLTIP_ROOT}",ABS:"%{BKY_MATH_SINGLE_TOOLTIP_ABS}",NEG:"%{BKY_MATH_SINGLE_TOOLTIP_NEG}",LN:"%{BKY_MATH_SINGLE_TOOLTIP_LN}",LOG10:"%{BKY_MATH_SINGLE_TOOLTIP_LOG10}",EXP:"%{BKY_MATH_SINGLE_TOOLTIP_EXP}",POW10:"%{BKY_MATH_SINGLE_TOOLTIP_POW10}",SIN:"%{BKY_MATH_TRIG_TOOLTIP_SIN}",COS:"%{BKY_MATH_TRIG_TOOLTIP_COS}",TAN:"%{BKY_MATH_TRIG_TOOLTIP_TAN}",ASIN:"%{BKY_MATH_TRIG_TOOLTIP_ASIN}",ACOS:"%{BKY_MATH_TRIG_TOOLTIP_ACOS}",ATAN:"%{BKY_MATH_TRIG_TOOLTIP_ATAN}",SUM:"%{BKY_MATH_ONLIST_TOOLTIP_SUM}",MIN:"%{BKY_MATH_ONLIST_TOOLTIP_MIN}",MAX:"%{BKY_MATH_ONLIST_TOOLTIP_MAX}",AVERAGE:"%{BKY_MATH_ONLIST_TOOLTIP_AVERAGE}",MEDIAN:"%{BKY_MATH_ONLIST_TOOLTIP_MEDIAN}",MODE:"%{BKY_MATH_ONLIST_TOOLTIP_MODE}",STD_DEV:"%{BKY_MATH_ONLIST_TOOLTIP_STD_DEV}",RANDOM:"%{BKY_MATH_ONLIST_TOOLTIP_RANDOM}"}));var oi={mutationToDom:function(){const c=d.createElement$$module$build$src$core$utils$xml("mutation"),g="DIVISIBLE_BY"===this.getFieldValue("PROPERTY");return c.setAttribute("divisor_input",String(g)),c},domToMutation:function(c){c="true"===c.getAttribute("divisor_input"),this.updateShape_(c)},updateShape_:function(c){const g=this.getInput("DIVISOR");c?g||this.appendValueInput("DIVISOR").setCheck("Number"):g&&this.removeInput("DIVISOR")}};d.registerMutator$$module$build$src$core$extensions("math_is_divisibleby_mutator",oi,function(){this.getField("PROPERTY").setValidator(function(c){c="DIVISIBLE_BY"===c,this.getSourceBlock().updateShape_(c)})}),d.register$$module$build$src$core$extensions("math_change_tooltip",d.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_MATH_CHANGE_TOOLTIP}","VAR"));var nn={updateType_:function(c){this.outputConnection.setCheck("MODE"===c?"Array":"Number")},mutationToDom:function(){const c=d.createElement$$module$build$src$core$utils$xml("mutation");return c.setAttribute("op",this.getFieldValue("OP")),c},domToMutation:function(c){if(null===(c=c.getAttribute("op")))throw new TypeError("xmlElement had no op attribute");this.updateType_(c)}};d.registerMutator$$module$build$src$core$extensions("math_modes_of_list_mutator",nn,function(){this.getField("OP").setValidator(function(c){this.updateType_(c)}.bind(this))}),d.defineBlocks$$module$build$src$core$common(ti);var Co={blocks:ti},ii=d.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"controls_repeat_ext",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"input_value",name:"TIMES",check:"Number"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_repeat",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"field_number",name:"TIMES",value:10,min:0,precision:1}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_whileUntil",message0:"%1 %2",args0:[{type:"field_dropdown",name:"MODE",options:[["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_WHILE}","WHILE"],["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_UNTIL}","UNTIL"]]},{type:"input_value",name:"BOOL",check:"Boolean"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_WHILEUNTIL_HELPURL}",extensions:["controls_whileUntil_tooltip"]},{type:"controls_for",message0:"%{BKY_CONTROLS_FOR_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"FROM",check:"Number",align:"RIGHT"},{type:"input_value",name:"TO",check:"Number",align:"RIGHT"},{type:"input_value",name:"BY",check:"Number",align:"RIGHT"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],inputsInline:!0,previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOR_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_for_tooltip"]},{type:"controls_forEach",message0:"%{BKY_CONTROLS_FOREACH_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"LIST",check:"Array"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOREACH_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_forEach_tooltip"]},{type:"controls_flow_statements",message0:"%1",args0:[{type:"field_dropdown",name:"FLOW",options:[["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK}","BREAK"],["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE}","CONTINUE"]]}],previousStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FLOW_STATEMENTS_HELPURL}",suppressPrefixSuffix:!0,extensions:["controls_flow_tooltip","controls_flow_in_loop_check"]}]);d.register$$module$build$src$core$extensions("controls_whileUntil_tooltip",d.buildTooltipForDropdown$$module$build$src$core$extensions("MODE",{WHILE:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_WHILE}",UNTIL:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL}"})),d.register$$module$build$src$core$extensions("controls_flow_tooltip",d.buildTooltipForDropdown$$module$build$src$core$extensions("FLOW",{BREAK:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK}",CONTINUE:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE}"}));var an={customContextMenu:function(c){if(!this.isInFlyout){var g=this.getField("VAR"),b=g.getVariable().getName();this.isCollapsed()||null===b||(g={type:"variables_get",fields:{VAR:g.saveState(!0)}},c.push({enabled:!0,text:d.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET.replace("%1",b),callback:d.callbackFactory$$module$build$src$core$contextmenu(this,g)}))}}};d.registerMixin$$module$build$src$core$extensions("contextMenu_newGetVariableBlock",an),d.register$$module$build$src$core$extensions("controls_for_tooltip",d.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_CONTROLS_FOR_TOOLTIP}","VAR")),d.register$$module$build$src$core$extensions("controls_forEach_tooltip",d.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_CONTROLS_FOREACH_TOOLTIP}","VAR"));var es=new Set(["controls_repeat","controls_repeat_ext","controls_forEach","controls_for","controls_whileUntil"]),dn={getSurroundLoop:function(){let c=this;do{if(es.has(c.type))return c;c=c.getSurroundParent()}while(c);return null},onchange:function(c){const g=this.workspace;if(g.isDragging&&!g.isDragging()&&(c.type===d.BLOCK_MOVE$$module$build$src$core$events$events||c.type===d.BLOCK_CREATE$$module$build$src$core$events$events)&&(c=!!this.getSurroundLoop(),this.setWarningText(c?null:d.Msg$$module$build$src$core$msg.CONTROLS_FLOW_STATEMENTS_WARNING),!this.isInFlyout))try{d.setRecordUndo$$module$build$src$core$events$utils(!1),this.setDisabledReason(!c,"CONTROL_FLOW_NOT_IN_LOOP")}finally{d.setRecordUndo$$module$build$src$core$events$utils(!0)}}};d.registerMixin$$module$build$src$core$extensions("controls_flow_in_loop_check",dn),d.defineBlocks$$module$build$src$core$common(ii);var si={blocks:ii,loopTypes:es},Se=d.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"logic_boolean",message0:"%1",args0:[{type:"field_dropdown",name:"BOOL",options:[["%{BKY_LOGIC_BOOLEAN_TRUE}","TRUE"],["%{BKY_LOGIC_BOOLEAN_FALSE}","FALSE"]]}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_BOOLEAN_TOOLTIP}",helpUrl:"%{BKY_LOGIC_BOOLEAN_HELPURL}"},{type:"controls_if",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],previousStatement:null,nextStatement:null,style:"logic_blocks",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",suppressPrefixSuffix:!0,mutator:"controls_if_mutator",extensions:["controls_if_tooltip"]},{type:"controls_ifelse",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],message2:"%{BKY_CONTROLS_IF_MSG_ELSE} %1",args2:[{type:"input_statement",name:"ELSE"}],previousStatement:null,nextStatement:null,style:"logic_blocks",tooltip:"%{BKYCONTROLS_IF_TOOLTIP_2}",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",suppressPrefixSuffix:!0,extensions:["controls_if_tooltip"]},{type:"logic_compare",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A"},{type:"field_dropdown",name:"OP",options:[["=","EQ"],["\u2260","NEQ"],["\u200f<","LT"],["\u200f\u2264","LTE"],["\u200f>","GT"],["\u200f\u2265","GTE"]]},{type:"input_value",name:"B"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_COMPARE_HELPURL}",extensions:["logic_compare","logic_op_tooltip"]},{type:"logic_operation",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Boolean"},{type:"field_dropdown",name:"OP",options:[["%{BKY_LOGIC_OPERATION_AND}","AND"],["%{BKY_LOGIC_OPERATION_OR}","OR"]]},{type:"input_value",name:"B",check:"Boolean"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_OPERATION_HELPURL}",extensions:["logic_op_tooltip"]},{type:"logic_negate",message0:"%{BKY_LOGIC_NEGATE_TITLE}",args0:[{type:"input_value",name:"BOOL",check:"Boolean"}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_NEGATE_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NEGATE_HELPURL}"},{type:"logic_null",message0:"%{BKY_LOGIC_NULL}",output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_NULL_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NULL_HELPURL}"},{type:"logic_ternary",message0:"%{BKY_LOGIC_TERNARY_CONDITION} %1",args0:[{type:"input_value",name:"IF",check:"Boolean"}],message1:"%{BKY_LOGIC_TERNARY_IF_TRUE} %1",args1:[{type:"input_value",name:"THEN"}],message2:"%{BKY_LOGIC_TERNARY_IF_FALSE} %1",args2:[{type:"input_value",name:"ELSE"}],output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_TERNARY_TOOLTIP}",helpUrl:"%{BKY_LOGIC_TERNARY_HELPURL}",extensions:["logic_ternary"]},{type:"controls_if_if",message0:"%{BKY_CONTROLS_IF_IF_TITLE_IF}",nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_IF_TOOLTIP}"},{type:"controls_if_elseif",message0:"%{BKY_CONTROLS_IF_ELSEIF_TITLE_ELSEIF}",previousStatement:null,nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSEIF_TOOLTIP}"},{type:"controls_if_else",message0:"%{BKY_CONTROLS_IF_ELSE_TITLE_ELSE}",previousStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSE_TOOLTIP}"}]);d.register$$module$build$src$core$extensions("logic_op_tooltip",d.buildTooltipForDropdown$$module$build$src$core$extensions("OP",{EQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_EQ}",NEQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_NEQ}",LT:"%{BKY_LOGIC_COMPARE_TOOLTIP_LT}",LTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_LTE}",GT:"%{BKY_LOGIC_COMPARE_TOOLTIP_GT}",GTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_GTE}",AND:"%{BKY_LOGIC_OPERATION_TOOLTIP_AND}",OR:"%{BKY_LOGIC_OPERATION_TOOLTIP_OR}"}));var hn={elseifCount_:0,elseCount_:0,mutationToDom:function(){if(!this.elseifCount_&&!this.elseCount_)return null;const c=d.createElement$$module$build$src$core$utils$xml("mutation");return this.elseifCount_&&c.setAttribute("elseif",String(this.elseifCount_)),this.elseCount_&&c.setAttribute("else","1"),c},domToMutation:function(c){this.elseifCount_=parseInt(c.getAttribute("elseif"),10)||0,this.elseCount_=parseInt(c.getAttribute("else"),10)||0,this.rebuildShape_()},saveExtraState:function(){if(!this.elseifCount_&&!this.elseCount_)return null;const c=Object.create(null);return this.elseifCount_&&(c.elseIfCount=this.elseifCount_),this.elseCount_&&(c.hasElse=!0),c},loadExtraState:function(c){this.elseifCount_=c.elseIfCount||0,this.elseCount_=c.hasElse?1:0,this.updateShape_()},decompose:function(c){const g=c.newBlock("controls_if_if");g.initSvg();let b=g.nextConnection;for(let E=1;E<=this.elseifCount_;E++){const A=c.newBlock("controls_if_elseif");A.initSvg(),b.connect(A.previousConnection),b=A.nextConnection}return this.elseCount_&&((c=c.newBlock("controls_if_else")).initSvg(),b.connect(c.previousConnection)),g},compose:function(c){c=c.nextConnection.targetBlock(),this.elseCount_=this.elseifCount_=0;const g=[null],b=[null];let E=null;for(;c;){if(!c.isInsertionMarker())switch(c.type){case"controls_if_elseif":this.elseifCount_++,g.push(c.valueConnection_),b.push(c.statementConnection_);break;case"controls_if_else":this.elseCount_++,E=c.statementConnection_;break;default:throw TypeError("Unknown block type: "+c.type)}c=c.getNextBlock()}this.updateShape_(),this.reconnectChildBlocks_(g,b,E)},saveConnections:function(c){c=c.nextConnection.targetBlock();let g=1;for(;c;){if(!c.isInsertionMarker())switch(c.type){case"controls_if_elseif":var b=this.getInput("IF"+g);const E=this.getInput("DO"+g);c.valueConnection_=b&&b.connection.targetConnection,c.statementConnection_=E&&E.connection.targetConnection,g++;break;case"controls_if_else":b=this.getInput("ELSE"),c.statementConnection_=b&&b.connection.targetConnection;break;default:throw TypeError("Unknown block type: "+c.type)}c=c.getNextBlock()}},rebuildShape_:function(){const c=[null],g=[null];let b=null;this.getInput("ELSE")&&(b=this.getInput("ELSE").connection.targetConnection);for(let E=1;this.getInput("IF"+E);E++){const A=this.getInput("IF"+E),he=this.getInput("DO"+E);c.push(A.connection.targetConnection),g.push(he.connection.targetConnection)}this.updateShape_(),this.reconnectChildBlocks_(c,g,b)},updateShape_:function(){this.getInput("ELSE")&&this.removeInput("ELSE");for(var c=1;this.getInput("IF"+c);c++)this.removeInput("IF"+c),this.removeInput("DO"+c);for(c=1;c<=this.elseifCount_;c++)this.appendValueInput("IF"+c).setCheck("Boolean").appendField(d.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_ELSEIF),this.appendStatementInput("DO"+c).appendField(d.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_THEN);this.elseCount_&&this.appendStatementInput("ELSE").appendField(d.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_ELSE)},reconnectChildBlocks_:function(c,g,b){for(let E=1;E<=this.elseifCount_;E++){let A,he;null==(A=c[E])||A.reconnect(this,"IF"+E),null==(he=g[E])||he.reconnect(this,"DO"+E)}b?.reconnect(this,"ELSE")}};d.registerMutator$$module$build$src$core$extensions("controls_if_mutator",hn,null,["controls_if_elseif","controls_if_else"]);d.register$$module$build$src$core$extensions("controls_if_tooltip",function(){this.setTooltip(function(){return this.elseifCount_||this.elseCount_?!this.elseifCount_&&this.elseCount_?d.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_2:this.elseifCount_&&!this.elseCount_?d.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_3:this.elseifCount_&&this.elseCount_?d.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_4:"":d.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_1}.bind(this))});var ts={onchange:function(c){this.prevBlocks_||(this.prevBlocks_=[null,null]);var g=this.getInputTargetBlock("A");const b=this.getInputTargetBlock("B");g&&b&&!this.workspace.connectionChecker.doTypeChecks(g.outputConnection,b.outputConnection)&&(d.setGroup$$module$build$src$core$events$utils(c.group),(c=this.prevBlocks_[0])!==g&&(g.unplug(),!c||c.isDisposed()||c.isShadow()||this.getInput("A").connection.connect(c.outputConnection)),(g=this.prevBlocks_[1])!==b&&(b.unplug(),!g||g.isDisposed()||g.isShadow()||this.getInput("B").connection.connect(g.outputConnection)),this.bumpNeighbours(),d.setGroup$$module$build$src$core$events$utils(!1)),this.prevBlocks_[0]=this.getInputTargetBlock("A"),this.prevBlocks_[1]=this.getInputTargetBlock("B")}};d.register$$module$build$src$core$extensions("logic_compare",function(){this.mixin(ts)});var li={prevParentConnection_:null,onchange:function(c){const g=this.getInputTargetBlock("THEN"),b=this.getInputTargetBlock("ELSE"),E=this.outputConnection.targetConnection;if((g||b)&&E)for(let A=0;A<2;A++){const he=1===A?g:b;he&&!he.workspace.connectionChecker.doTypeChecks(he.outputConnection,E)&&(d.setGroup$$module$build$src$core$events$utils(c.group),E===this.prevParentConnection_?(this.unplug(),E.getSourceBlock().bumpNeighbours()):(he.unplug(),he.bumpNeighbours()),d.setGroup$$module$build$src$core$events$utils(!1))}this.prevParentConnection_=E}};d.registerMixin$$module$build$src$core$extensions("logic_ternary",li),d.defineBlocks$$module$build$src$core$common(Se);var ne={blocks:Se},Ge=d.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"lists_create_empty",message0:"%{BKY_LISTS_CREATE_EMPTY_TITLE}",output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_CREATE_EMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_CREATE_EMPTY_HELPURL}"},{type:"lists_repeat",message0:"%{BKY_LISTS_REPEAT_TITLE}",args0:[{type:"input_value",name:"ITEM"},{type:"input_value",name:"NUM",check:"Number"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_LISTS_REPEAT_HELPURL}"},{type:"lists_reverse",message0:"%{BKY_LISTS_REVERSE_MESSAGE0}",args0:[{type:"input_value",name:"LIST",check:"Array"}],output:"Array",inputsInline:!0,style:"list_blocks",tooltip:"%{BKY_LISTS_REVERSE_TOOLTIP}",helpUrl:"%{BKY_LISTS_REVERSE_HELPURL}"},{type:"lists_isEmpty",message0:"%{BKY_LISTS_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"list_blocks",tooltip:"%{BKY_LISTS_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_ISEMPTY_HELPURL}"},{type:"lists_length",message0:"%{BKY_LISTS_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"list_blocks",tooltip:"%{BKY_LISTS_LENGTH_TOOLTIP}",helpUrl:"%{BKY_LISTS_LENGTH_HELPURL}"}]);Ge.lists_create_with={init:function(){this.setHelpUrl(d.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_HELPURL),this.setStyle("list_blocks"),this.itemCount_=3,this.updateShape_(),this.setOutput(!0,"Array"),this.setMutator(new d.MutatorIcon$$module$build$src$core$icons$mutator_icon(["lists_create_with_item"],this)),this.setTooltip(d.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_TOOLTIP)},mutationToDom:function(){const c=d.createElement$$module$build$src$core$utils$xml("mutation");return c.setAttribute("items",String(this.itemCount_)),c},domToMutation:function(c){if(!(c=c.getAttribute("items")))throw new TypeError("element did not have items");this.itemCount_=parseInt(c,10),this.updateShape_()},saveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function(c){this.itemCount_=c.itemCount,this.updateShape_()},decompose:function(c){const g=c.newBlock("lists_create_with_container");g.initSvg();let b=g.getInput("STACK").connection;for(let E=0;E<this.itemCount_;E++){const A=c.newBlock("lists_create_with_item");if(A.initSvg(),!A.previousConnection)throw Error("itemBlock has no previousConnection");b.connect(A.previousConnection),b=A.nextConnection}return g},compose:function(c){var g=c.getInputTargetBlock("STACK");for(c=[];g;)g.isInsertionMarker()||c.push(g.valueConnection_),g=g.getNextBlock();for(g=0;g<this.itemCount_;g++){const b=this.getInput("ADD"+g).connection.targetConnection;b&&!c.includes(b)&&b.disconnect()}for(this.itemCount_=c.length,this.updateShape_(),g=0;g<this.itemCount_;g++){let b;null==(b=c[g])||b.reconnect(this,"ADD"+g)}},saveConnections:function(c){c=c.getInputTargetBlock("STACK");let g=0;for(;c;){if(c.isInsertionMarker()){c=c.getNextBlock();continue}const b=this.getInput("ADD"+g);let E;c.valueConnection_=null==(E=b)?void 0:E.connection.targetConnection,c=c.getNextBlock(),g++}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(d.Msg$$module$build$src$core$msg.LISTS_CREATE_EMPTY_TITLE);for(var c=0;c<this.itemCount_;c++)if(!this.getInput("ADD"+c)){const g=this.appendValueInput("ADD"+c).setAlign(d.Align$$module$build$src$core$inputs$align.RIGHT);0===c&&g.appendField(d.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_INPUT_WITH)}for(c=this.itemCount_;this.getInput("ADD"+c);c++)this.removeInput("ADD"+c)}},Ge.lists_create_with_container={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(d.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD),this.appendStatementInput("STACK"),this.setTooltip(d.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP),this.contextMenu=!1}},Ge.lists_create_with_item={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(d.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_ITEM_TITLE),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(d.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_ITEM_TOOLTIP),this.contextMenu=!1}},Ge.lists_indexOf={init:function(){var c=[[d.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_FIRST,"FIRST"],[d.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_LAST,"LAST"]];if(this.setHelpUrl(d.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_HELPURL),this.setStyle("list_blocks"),this.setOutput(!0,"Number"),this.appendValueInput("VALUE").setCheck("Array").appendField(d.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_INPUT_IN_LIST),!(c=d.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:c})))throw Error("field_dropdown not found");this.appendValueInput("FIND").appendField(c,"END"),this.setInputsInline(!0),this.setTooltip(()=>d.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"0":"-1"))}},Ge.lists_getIndex={init:function(){var c=[[d.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_GET,"GET"],[d.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_GET_REMOVE,"GET_REMOVE"],[d.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_REMOVE,"REMOVE"]];this.WHERE_OPTIONS=[[d.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[d.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[d.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FIRST,"FIRST"],[d.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_LAST,"LAST"],[d.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(d.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_HELPURL),this.setStyle("list_blocks"),(c=d.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:c})).setValidator(function(g){g="REMOVE"===g,this.getSourceBlock().updateStatement_(g)}),this.appendValueInput("VALUE").setCheck("Array").appendField(d.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(c,"MODE").appendField("","SPACE"),(c=d.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this.WHERE_OPTIONS})).setValidator(function(g){const b=this.getValue();(g="FROM_START"===g||"FROM_END"===g)!=("FROM_START"===b||"FROM_END"===b)&&this.getSourceBlock().updateAt_(g)}),this.appendDummyInput().appendField(c,"WHERE"),this.appendDummyInput("AT"),d.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL&&this.appendDummyInput("TAIL").appendField(d.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL),this.setInputsInline(!0),this.setOutput(!0),this.updateAt_(!0),this.setTooltip(()=>{const g=this.getFieldValue("MODE"),b=this.getFieldValue("WHERE");let E="";switch(g+" "+b){case"GET FROM_START":case"GET FROM_END":E=d.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM;break;case"GET FIRST":E=d.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST;break;case"GET LAST":E=d.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST;break;case"GET RANDOM":E=d.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM;break;case"GET_REMOVE FROM_START":case"GET_REMOVE FROM_END":E=d.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM;break;case"GET_REMOVE FIRST":E=d.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST;break;case"GET_REMOVE LAST":E=d.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST;break;case"GET_REMOVE RANDOM":E=d.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM;break;case"REMOVE FROM_START":case"REMOVE FROM_END":E=d.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM;break;case"REMOVE FIRST":E=d.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST;break;case"REMOVE LAST":E=d.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST;break;case"REMOVE RANDOM":E=d.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM}return("FROM_START"===b||"FROM_END"===b)&&(E+="  "+("FROM_START"===b?d.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP:d.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_END_TOOLTIP).replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),E})},mutationToDom:function(){const c=d.createElement$$module$build$src$core$utils$xml("mutation");c.setAttribute("statement",String(!this.outputConnection));const g=this.getInput("AT")instanceof d.ValueInput$$module$build$src$core$inputs$value_input;return c.setAttribute("at",String(g)),c},domToMutation:function(c){const g="true"===c.getAttribute("statement");this.updateStatement_(g),c="false"!==c.getAttribute("at"),this.updateAt_(c)},saveExtraState:function(){return this.outputConnection?null:{isStatement:!0}},loadExtraState:function(c){c.isStatement?this.updateStatement_(!0):"string"==typeof c&&this.domToMutation(d.textToDom$$module$build$src$core$utils$xml(c))},updateStatement_:function(c){c!==!this.outputConnection&&(this.unplug(!0,!0),c?(this.setOutput(!1),this.setPreviousStatement(!0),this.setNextStatement(!0)):(this.setPreviousStatement(!1),this.setNextStatement(!1),this.setOutput(!0)))},updateAt_:function(c){this.removeInput("AT"),this.removeInput("ORDINAL",!0),c?(this.appendValueInput("AT").setCheck("Number"),d.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(d.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"),d.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL&&this.moveInputBefore("TAIL",null)}},Ge.lists_setIndex={init:function(){var c=[[d.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_SET,"SET"],[d.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INSERT,"INSERT"]];this.WHERE_OPTIONS=[[d.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[d.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[d.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FIRST,"FIRST"],[d.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_LAST,"LAST"],[d.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(d.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(d.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INPUT_IN_LIST),c=d.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:c}),this.appendDummyInput().appendField(c,"MODE").appendField("","SPACE"),(c=d.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this.WHERE_OPTIONS})).setValidator(function(g){const b=this.getValue();(g="FROM_START"===g||"FROM_END"===g)!=("FROM_START"===b||"FROM_END"===b)&&this.getSourceBlock().updateAt_(g)}),this.appendDummyInput().appendField(c,"WHERE"),this.appendDummyInput("AT"),this.appendValueInput("TO").appendField(d.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INPUT_TO),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(d.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP),this.updateAt_(!0),this.setTooltip(()=>{const g=this.getFieldValue("MODE"),b=this.getFieldValue("WHERE");let E="";switch(g+" "+b){case"SET FROM_START":case"SET FROM_END":E=d.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM;break;case"SET FIRST":E=d.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST;break;case"SET LAST":E=d.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST;break;case"SET RANDOM":E=d.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM;break;case"INSERT FROM_START":case"INSERT FROM_END":E=d.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM;break;case"INSERT FIRST":E=d.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST;break;case"INSERT LAST":E=d.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST;break;case"INSERT RANDOM":E=d.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM}return("FROM_START"===b||"FROM_END"===b)&&(E+="  "+d.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),E})},mutationToDom:function(){const c=d.createElement$$module$build$src$core$utils$xml("mutation"),g=this.getInput("AT")instanceof d.ValueInput$$module$build$src$core$inputs$value_input;return c.setAttribute("at",String(g)),c},domToMutation:function(c){c="false"!==c.getAttribute("at"),this.updateAt_(c)},saveExtraState:function(){return null},loadExtraState:function(){},updateAt_:function(c){this.removeInput("AT"),this.removeInput("ORDINAL",!0),c?(this.appendValueInput("AT").setCheck("Number"),d.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(d.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"),this.moveInputBefore("AT","TO"),this.getInput("ORDINAL")&&this.moveInputBefore("ORDINAL","TO")}},Ge.lists_getSublist={init:function(){this.WHERE_OPTIONS_1=[[d.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FROM_START,"FROM_START"],[d.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FROM_END,"FROM_END"],[d.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[d.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_FROM_START,"FROM_START"],[d.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_FROM_END,"FROM_END"],[d.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_LAST,"LAST"]],this.setHelpUrl(d.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(d.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_INPUT_IN_LIST);const c=g=>{const b=d.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this["WHERE_OPTIONS_"+g]});return b.setValidator(function(E){const A=this.getValue();(E="FROM_START"===E||"FROM_END"===E)!=("FROM_START"===A||"FROM_END"===A)&&this.getSourceBlock().updateAt_(g,E)}),b};this.appendDummyInput("WHERE1_INPUT").appendField(c(1),"WHERE1"),this.appendDummyInput("AT1"),this.appendDummyInput("WHERE2_INPUT").appendField(c(2),"WHERE2"),this.appendDummyInput("AT2"),d.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL&&this.appendDummyInput("TAIL").appendField(d.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(d.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TOOLTIP)},mutationToDom:function(){const c=d.createElement$$module$build$src$core$utils$xml("mutation");var g=this.getInput("AT1")instanceof d.ValueInput$$module$build$src$core$inputs$value_input;return c.setAttribute("at1",String(g)),g=this.getInput("AT2")instanceof d.ValueInput$$module$build$src$core$inputs$value_input,c.setAttribute("at2",String(g)),c},domToMutation:function(c){const g="true"===c.getAttribute("at1");c="true"===c.getAttribute("at2"),this.updateAt_(1,g),this.updateAt_(2,c)},saveExtraState:function(){return null},loadExtraState:function(){},updateAt_:function(c,g){this.removeInput("AT"+c),this.removeInput("ORDINAL"+c,!0),g?(this.appendValueInput("AT"+c).setCheck("Number"),d.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+c).appendField(d.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+c),1===c&&(this.moveInputBefore("AT1","WHERE2_INPUT"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","WHERE2_INPUT")),d.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL&&this.moveInputBefore("TAIL",null)}},Ge.lists_sort={init:function(){this.jsonInit({message0:"%{BKY_LISTS_SORT_TITLE}",args0:[{type:"field_dropdown",name:"TYPE",options:[["%{BKY_LISTS_SORT_TYPE_NUMERIC}","NUMERIC"],["%{BKY_LISTS_SORT_TYPE_TEXT}","TEXT"],["%{BKY_LISTS_SORT_TYPE_IGNORECASE}","IGNORE_CASE"]]},{type:"field_dropdown",name:"DIRECTION",options:[["%{BKY_LISTS_SORT_ORDER_ASCENDING}","1"],["%{BKY_LISTS_SORT_ORDER_DESCENDING}","-1"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_SORT_TOOLTIP}",helpUrl:"%{BKY_LISTS_SORT_HELPURL}"})}},Ge.lists_split={init:function(){const c=d.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:[[d.Msg$$module$build$src$core$msg.LISTS_SPLIT_LIST_FROM_TEXT,"SPLIT"],[d.Msg$$module$build$src$core$msg.LISTS_SPLIT_TEXT_FROM_LIST,"JOIN"]]});if(!c)throw Error("field_dropdown not found");c.setValidator(g=>{this.updateType_(g)}),this.setHelpUrl(d.Msg$$module$build$src$core$msg.LISTS_SPLIT_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("INPUT").setCheck("String").appendField(c,"MODE"),this.appendValueInput("DELIM").setCheck("String").appendField(d.Msg$$module$build$src$core$msg.LISTS_SPLIT_WITH_DELIMITER),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.setTooltip(()=>{const g=this.getFieldValue("MODE");if("SPLIT"===g)return d.Msg$$module$build$src$core$msg.LISTS_SPLIT_TOOLTIP_SPLIT;if("JOIN"===g)return d.Msg$$module$build$src$core$msg.LISTS_SPLIT_TOOLTIP_JOIN;throw Error("Unknown mode: "+g)})},updateType_:function(c){if(this.getFieldValue("MODE")!==c){const g=this.getInput("INPUT").connection;g.setShadowDom(null);const b=g.targetBlock();b&&(g.disconnect(),b.isShadow()?b.dispose(!1):this.bumpNeighbours())}"SPLIT"===c?(this.outputConnection.setCheck("Array"),this.getInput("INPUT").setCheck("String")):(this.outputConnection.setCheck("String"),this.getInput("INPUT").setCheck("Array"))},mutationToDom:function(){const c=d.createElement$$module$build$src$core$utils$xml("mutation");return c.setAttribute("mode",this.getFieldValue("MODE")),c},domToMutation:function(c){this.updateType_(c.getAttribute("mode"))},saveExtraState:function(){return{mode:this.getFieldValue("MODE")}},loadExtraState:function(c){this.updateType_(c.mode)}},d.defineBlocks$$module$build$src$core$common(Ge);var X={blocks:Ge},Q={blocks:Object.assign({},Ge,Se,ii,ti,ve,we,ro,tt),lists:X,logic:ne,loops:si,math:Co,procedures:on,texts:Ee,variables:Oe,variablesDynamic:kt};return Q.__namespace__=d,Q},void 0!==(o=V.apply(no,Fe))&&(Xo.exports=o)},3329:function(Xo,no,ce){var V,Fe,o;Fe=[ce(7519),ce(8905),ce(8927)],void 0!==(o="function"==typeof(V=function(U,d,tt){"use strict";return U.setLocale(d),U})?V.apply(no,Fe):V)&&(Xo.exports=o)},8905:function(Xo,no){var ce,Fe;void 0!==(Fe="function"==typeof(ce=function(){"use strict";var o=o||{Msg:Object.create(null)};return o.Msg.ADD_COMMENT="Add Comment",o.Msg.ALT_KEY="Alt",o.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE="Can't delete the variable '%1' because it's part of the definition of the function '%2'",o.Msg.CHANGE_VALUE_TITLE="Change value:",o.Msg.CHROME_OS="ChromeOS",o.Msg.CLEAN_UP="Clean up Blocks",o.Msg.CLOSE="Close",o.Msg.COLLAPSED_WARNINGS_WARNING="Collapsed blocks contain warnings.",o.Msg.COLLAPSE_ALL="Collapse Blocks",o.Msg.COLLAPSE_BLOCK="Collapse Block",o.Msg.COLOUR_BLEND_COLOUR1="colour 1",o.Msg.COLOUR_BLEND_COLOUR2="colour 2",o.Msg.COLOUR_BLEND_HELPURL="https://meyerweb.com/eric/tools/color-blend/#:::rgbp",o.Msg.COLOUR_BLEND_RATIO="ratio",o.Msg.COLOUR_BLEND_TITLE="blend",o.Msg.COLOUR_BLEND_TOOLTIP="Blends two colours together with a given ratio (0.0 - 1.0).",o.Msg.COLOUR_PICKER_HELPURL="https://en.wikipedia.org/wiki/Color",o.Msg.COLOUR_PICKER_TOOLTIP="Choose a colour from the palette.",o.Msg.COLOUR_RANDOM_HELPURL="http://randomcolour.com",o.Msg.COLOUR_RANDOM_TITLE="random colour",o.Msg.COLOUR_RANDOM_TOOLTIP="Choose a colour at random.",o.Msg.COLOUR_RGB_BLUE="blue",o.Msg.COLOUR_RGB_GREEN="green",o.Msg.COLOUR_RGB_HELPURL="https://www.december.com/html/spec/colorpercompact.html",o.Msg.COLOUR_RGB_RED="red",o.Msg.COLOUR_RGB_TITLE="colour with",o.Msg.COLOUR_RGB_TOOLTIP="Create a colour with the specified amount of red, green, and blue. All values must be between 0 and 100.",o.Msg.COMMAND_KEY="\u2318 Command",o.Msg.CONTROLS_FLOW_STATEMENTS_HELPURL="https://github.com/google/blockly/wiki/Loops#loop-termination-blocks",o.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK="break out of loop",o.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE="continue with next iteration of loop",o.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK="Break out of the containing loop.",o.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE="Skip the rest of this loop, and continue with the next iteration.",o.Msg.CONTROLS_FLOW_STATEMENTS_WARNING="Warning: This block may only be used within a loop.",o.Msg.CONTROLS_FOREACH_HELPURL="https://github.com/google/blockly/wiki/Loops#for-each",o.Msg.CONTROLS_FOREACH_TITLE="for each item %1 in list %2",o.Msg.CONTROLS_FOREACH_TOOLTIP="For each item in a list, set the variable '%1' to the item, and then do some statements.",o.Msg.CONTROLS_FOR_HELPURL="https://github.com/google/blockly/wiki/Loops#count-with",o.Msg.CONTROLS_FOR_TITLE="count with %1 from %2 to %3 by %4",o.Msg.CONTROLS_FOR_TOOLTIP="Have the variable '%1' take on the values from the start number to the end number, counting by the specified interval, and do the specified blocks.",o.Msg.CONTROLS_IF_ELSEIF_TOOLTIP="Add a condition to the if block.",o.Msg.CONTROLS_IF_ELSE_TOOLTIP="Add a final, catch-all condition to the if block.",o.Msg.CONTROLS_IF_HELPURL="https://github.com/google/blockly/wiki/IfElse",o.Msg.CONTROLS_IF_IF_TOOLTIP="Add, remove, or reorder sections to reconfigure this if block.",o.Msg.CONTROLS_IF_MSG_ELSE="else",o.Msg.CONTROLS_IF_MSG_ELSEIF="else if",o.Msg.CONTROLS_IF_MSG_IF="if",o.Msg.CONTROLS_IF_TOOLTIP_1="If a value is true, then do some statements.",o.Msg.CONTROLS_IF_TOOLTIP_2="If a value is true, then do the first block of statements. Otherwise, do the second block of statements.",o.Msg.CONTROLS_IF_TOOLTIP_3="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements.",o.Msg.CONTROLS_IF_TOOLTIP_4="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements. If none of the values are true, do the last block of statements.",o.Msg.CONTROLS_REPEAT_HELPURL="https://en.wikipedia.org/wiki/For_loop",o.Msg.CONTROLS_REPEAT_INPUT_DO="do",o.Msg.CONTROLS_REPEAT_TITLE="repeat %1 times",o.Msg.CONTROLS_REPEAT_TOOLTIP="Do some statements several times.",o.Msg.CONTROLS_WHILEUNTIL_HELPURL="https://github.com/google/blockly/wiki/Loops#repeat",o.Msg.CONTROLS_WHILEUNTIL_OPERATOR_UNTIL="repeat until",o.Msg.CONTROLS_WHILEUNTIL_OPERATOR_WHILE="repeat while",o.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL="While a value is false, then do some statements.",o.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_WHILE="While a value is true, then do some statements.",o.Msg.CONTROL_KEY="Ctrl",o.Msg.COPY_SHORTCUT="Copy",o.Msg.CUT_SHORTCUT="Cut",o.Msg.DELETE_ALL_BLOCKS="Delete all %1 blocks?",o.Msg.DELETE_BLOCK="Delete Block",o.Msg.DELETE_VARIABLE="Delete the '%1' variable",o.Msg.DELETE_VARIABLE_CONFIRMATION="Delete %1 uses of the '%2' variable?",o.Msg.DELETE_X_BLOCKS="Delete %1 Blocks",o.Msg.DIALOG_CANCEL="Cancel",o.Msg.DIALOG_OK="OK",o.Msg.DISABLE_BLOCK="Disable Block",o.Msg.DUPLICATE_BLOCK="Duplicate",o.Msg.DUPLICATE_COMMENT="Duplicate Comment",o.Msg.EDIT_BLOCK_CONTENTS="Edit Block contents",o.Msg.ENABLE_BLOCK="Enable Block",o.Msg.EXPAND_ALL="Expand Blocks",o.Msg.EXPAND_BLOCK="Expand Block",o.Msg.EXTERNAL_INPUTS="External Inputs",o.Msg.HELP="Help",o.Msg.HELP_PROMPT="Press %1 for help on keyboard controls",o.Msg.INLINE_INPUTS="Inline Inputs",o.Msg.KEYBOARD_NAV_CONSTRAINED_MOVE_HINT="Use the arrow keys to move, then %1 to accept the position",o.Msg.KEYBOARD_NAV_COPIED_HINT="Copied. Press %1 to paste.",o.Msg.KEYBOARD_NAV_CUT_HINT="Cut. Press %1 to paste.",o.Msg.KEYBOARD_NAV_UNCONSTRAINED_MOVE_HINT="Hold %1 and use arrow keys to move freely, then %2 to accept the position",o.Msg.LINUX="Linux",o.Msg.LISTS_CREATE_EMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#create-empty-list",o.Msg.LISTS_CREATE_EMPTY_TITLE="create empty list",o.Msg.LISTS_CREATE_EMPTY_TOOLTIP="Returns a list, of length 0, containing no data records",o.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD="list",o.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP="Add, remove, or reorder sections to reconfigure this list block.",o.Msg.LISTS_CREATE_WITH_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",o.Msg.LISTS_CREATE_WITH_INPUT_WITH="create list with",o.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP="Add an item to the list.",o.Msg.LISTS_CREATE_WITH_TOOLTIP="Create a list with any number of items.",o.Msg.LISTS_GET_INDEX_FIRST="first",o.Msg.LISTS_GET_INDEX_FROM_END="# from end",o.Msg.LISTS_GET_INDEX_FROM_START="#",o.Msg.LISTS_GET_INDEX_GET="get",o.Msg.LISTS_GET_INDEX_GET_REMOVE="get and remove",o.Msg.LISTS_GET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-items-from-a-list",o.Msg.LISTS_GET_INDEX_LAST="last",o.Msg.LISTS_GET_INDEX_RANDOM="random",o.Msg.LISTS_GET_INDEX_REMOVE="remove",o.Msg.LISTS_GET_INDEX_TAIL="",o.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST="Returns the first item in a list.",o.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM="Returns the item at the specified position in a list.",o.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST="Returns the last item in a list.",o.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM="Returns a random item in a list.",o.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST="Removes and returns the first item in a list.",o.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM="Removes and returns the item at the specified position in a list.",o.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST="Removes and returns the last item in a list.",o.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM="Removes and returns a random item in a list.",o.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST="Removes the first item in a list.",o.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM="Removes the item at the specified position in a list.",o.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST="Removes the last item in a list.",o.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM="Removes a random item in a list.",o.Msg.LISTS_GET_SUBLIST_END_FROM_END="to # from end",o.Msg.LISTS_GET_SUBLIST_END_FROM_START="to #",o.Msg.LISTS_GET_SUBLIST_END_LAST="to last",o.Msg.LISTS_GET_SUBLIST_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-a-sublist",o.Msg.LISTS_GET_SUBLIST_START_FIRST="get sub-list from first",o.Msg.LISTS_GET_SUBLIST_START_FROM_END="get sub-list from # from end",o.Msg.LISTS_GET_SUBLIST_START_FROM_START="get sub-list from #",o.Msg.LISTS_GET_SUBLIST_TAIL="",o.Msg.LISTS_GET_SUBLIST_TOOLTIP="Creates a copy of the specified portion of a list.",o.Msg.LISTS_INDEX_FROM_END_TOOLTIP="%1 is the last item.",o.Msg.LISTS_INDEX_FROM_START_TOOLTIP="%1 is the first item.",o.Msg.LISTS_INDEX_OF_FIRST="find first occurrence of item",o.Msg.LISTS_INDEX_OF_HELPURL="https://github.com/google/blockly/wiki/Lists#finding-items-in-a-list",o.Msg.LISTS_INDEX_OF_LAST="find last occurrence of item",o.Msg.LISTS_INDEX_OF_TOOLTIP="Returns the index of the first/last occurrence of the item in the list. Returns %1 if item is not found.",o.Msg.LISTS_INLIST="in list",o.Msg.LISTS_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#is-empty",o.Msg.LISTS_ISEMPTY_TITLE="%1 is empty",o.Msg.LISTS_ISEMPTY_TOOLTIP="Returns true if the list is empty.",o.Msg.LISTS_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Lists#length-of",o.Msg.LISTS_LENGTH_TITLE="length of %1",o.Msg.LISTS_LENGTH_TOOLTIP="Returns the length of a list.",o.Msg.LISTS_REPEAT_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",o.Msg.LISTS_REPEAT_TITLE="create list with item %1 repeated %2 times",o.Msg.LISTS_REPEAT_TOOLTIP="Creates a list consisting of the given value repeated the specified number of times.",o.Msg.LISTS_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Lists#reversing-a-list",o.Msg.LISTS_REVERSE_MESSAGE0="reverse %1",o.Msg.LISTS_REVERSE_TOOLTIP="Reverse a copy of a list.",o.Msg.LISTS_SET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#in-list--set",o.Msg.LISTS_SET_INDEX_INPUT_TO="as",o.Msg.LISTS_SET_INDEX_INSERT="insert at",o.Msg.LISTS_SET_INDEX_SET="set",o.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST="Inserts the item at the start of a list.",o.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM="Inserts the item at the specified position in a list.",o.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST="Append the item to the end of a list.",o.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM="Inserts the item randomly in a list.",o.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST="Sets the first item in a list.",o.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM="Sets the item at the specified position in a list.",o.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST="Sets the last item in a list.",o.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM="Sets a random item in a list.",o.Msg.LISTS_SORT_HELPURL="https://github.com/google/blockly/wiki/Lists#sorting-a-list",o.Msg.LISTS_SORT_ORDER_ASCENDING="ascending",o.Msg.LISTS_SORT_ORDER_DESCENDING="descending",o.Msg.LISTS_SORT_TITLE="sort %1 %2 %3",o.Msg.LISTS_SORT_TOOLTIP="Sort a copy of a list.",o.Msg.LISTS_SORT_TYPE_IGNORECASE="alphabetic, ignore case",o.Msg.LISTS_SORT_TYPE_NUMERIC="numeric",o.Msg.LISTS_SORT_TYPE_TEXT="alphabetic",o.Msg.LISTS_SPLIT_HELPURL="https://github.com/google/blockly/wiki/Lists#splitting-strings-and-joining-lists",o.Msg.LISTS_SPLIT_LIST_FROM_TEXT="make list from text",o.Msg.LISTS_SPLIT_TEXT_FROM_LIST="make text from list",o.Msg.LISTS_SPLIT_TOOLTIP_JOIN="Join a list of texts into one text, separated by a delimiter.",o.Msg.LISTS_SPLIT_TOOLTIP_SPLIT="Split text into a list of texts, breaking at each delimiter.",o.Msg.LISTS_SPLIT_WITH_DELIMITER="with delimiter",o.Msg.LOGIC_BOOLEAN_FALSE="false",o.Msg.LOGIC_BOOLEAN_HELPURL="https://github.com/google/blockly/wiki/Logic#values",o.Msg.LOGIC_BOOLEAN_TOOLTIP="Returns either true or false.",o.Msg.LOGIC_BOOLEAN_TRUE="true",o.Msg.LOGIC_COMPARE_HELPURL="https://en.wikipedia.org/wiki/Inequality_(mathematics)",o.Msg.LOGIC_COMPARE_TOOLTIP_EQ="Return true if both inputs equal each other.",o.Msg.LOGIC_COMPARE_TOOLTIP_GT="Return true if the first input is greater than the second input.",o.Msg.LOGIC_COMPARE_TOOLTIP_GTE="Return true if the first input is greater than or equal to the second input.",o.Msg.LOGIC_COMPARE_TOOLTIP_LT="Return true if the first input is smaller than the second input.",o.Msg.LOGIC_COMPARE_TOOLTIP_LTE="Return true if the first input is smaller than or equal to the second input.",o.Msg.LOGIC_COMPARE_TOOLTIP_NEQ="Return true if both inputs are not equal to each other.",o.Msg.LOGIC_NEGATE_HELPURL="https://github.com/google/blockly/wiki/Logic#not",o.Msg.LOGIC_NEGATE_TITLE="not %1",o.Msg.LOGIC_NEGATE_TOOLTIP="Returns true if the input is false. Returns false if the input is true.",o.Msg.LOGIC_NULL="null",o.Msg.LOGIC_NULL_HELPURL="https://en.wikipedia.org/wiki/Nullable_type",o.Msg.LOGIC_NULL_TOOLTIP="Returns null.",o.Msg.LOGIC_OPERATION_AND="and",o.Msg.LOGIC_OPERATION_HELPURL="https://github.com/google/blockly/wiki/Logic#logical-operations",o.Msg.LOGIC_OPERATION_OR="or",o.Msg.LOGIC_OPERATION_TOOLTIP_AND="Return true if both inputs are true.",o.Msg.LOGIC_OPERATION_TOOLTIP_OR="Return true if at least one of the inputs is true.",o.Msg.LOGIC_TERNARY_CONDITION="test",o.Msg.LOGIC_TERNARY_HELPURL="https://en.wikipedia.org/wiki/%3F:",o.Msg.LOGIC_TERNARY_IF_FALSE="if false",o.Msg.LOGIC_TERNARY_IF_TRUE="if true",o.Msg.LOGIC_TERNARY_TOOLTIP="Check the condition in 'test'. If the condition is true, returns the 'if true' value; otherwise returns the 'if false' value.",o.Msg.MAC_OS="macOS",o.Msg.MATH_ADDITION_SYMBOL="+",o.Msg.MATH_ARITHMETIC_HELPURL="https://en.wikipedia.org/wiki/Arithmetic",o.Msg.MATH_ARITHMETIC_TOOLTIP_ADD="Return the sum of the two numbers.",o.Msg.MATH_ARITHMETIC_TOOLTIP_DIVIDE="Return the quotient of the two numbers.",o.Msg.MATH_ARITHMETIC_TOOLTIP_MINUS="Return the difference of the two numbers.",o.Msg.MATH_ARITHMETIC_TOOLTIP_MULTIPLY="Return the product of the two numbers.",o.Msg.MATH_ARITHMETIC_TOOLTIP_POWER="Return the first number raised to the power of the second number.",o.Msg.MATH_ATAN2_HELPURL="https://en.wikipedia.org/wiki/Atan2",o.Msg.MATH_ATAN2_TITLE="atan2 of X:%1 Y:%2",o.Msg.MATH_ATAN2_TOOLTIP="Return the arctangent of point (X, Y) in degrees from -180 to 180.",o.Msg.MATH_CHANGE_HELPURL="https://en.wikipedia.org/wiki/Programming_idiom#Incrementing_a_counter",o.Msg.MATH_CHANGE_TITLE="change %1 by %2",o.Msg.MATH_CHANGE_TOOLTIP="Add a number to variable '%1'.",o.Msg.MATH_CONSTANT_HELPURL="https://en.wikipedia.org/wiki/Mathematical_constant",o.Msg.MATH_CONSTANT_TOOLTIP="Return one of the common constants: \u03c0 (3.141\u2026), e (2.718\u2026), \u03c6 (1.618\u2026), sqrt(2) (1.414\u2026), sqrt(\xbd) (0.707\u2026), or \u221e (infinity).",o.Msg.MATH_CONSTRAIN_HELPURL="https://en.wikipedia.org/wiki/Clamping_(graphics)",o.Msg.MATH_CONSTRAIN_TITLE="constrain %1 low %2 high %3",o.Msg.MATH_CONSTRAIN_TOOLTIP="Constrain a number to be between the specified limits (inclusive).",o.Msg.MATH_DIVISION_SYMBOL="\xf7",o.Msg.MATH_IS_DIVISIBLE_BY="is divisible by",o.Msg.MATH_IS_EVEN="is even",o.Msg.MATH_IS_NEGATIVE="is negative",o.Msg.MATH_IS_ODD="is odd",o.Msg.MATH_IS_POSITIVE="is positive",o.Msg.MATH_IS_PRIME="is prime",o.Msg.MATH_IS_TOOLTIP="Check if a number is an even, odd, prime, whole, positive, negative, or if it is divisible by certain number. Returns true or false.",o.Msg.MATH_IS_WHOLE="is whole",o.Msg.MATH_MODULO_HELPURL="https://en.wikipedia.org/wiki/Modulo_operation",o.Msg.MATH_MODULO_TITLE="remainder of %1 \xf7 %2",o.Msg.MATH_MODULO_TOOLTIP="Return the remainder from dividing the two numbers.",o.Msg.MATH_MULTIPLICATION_SYMBOL="\xd7",o.Msg.MATH_NUMBER_HELPURL="https://en.wikipedia.org/wiki/Number",o.Msg.MATH_NUMBER_TOOLTIP="A number.",o.Msg.MATH_ONLIST_HELPURL="",o.Msg.MATH_ONLIST_OPERATOR_AVERAGE="average of list",o.Msg.MATH_ONLIST_OPERATOR_MAX="max of list",o.Msg.MATH_ONLIST_OPERATOR_MEDIAN="median of list",o.Msg.MATH_ONLIST_OPERATOR_MIN="min of list",o.Msg.MATH_ONLIST_OPERATOR_MODE="modes of list",o.Msg.MATH_ONLIST_OPERATOR_RANDOM="random item of list",o.Msg.MATH_ONLIST_OPERATOR_STD_DEV="standard deviation of list",o.Msg.MATH_ONLIST_OPERATOR_SUM="sum of list",o.Msg.MATH_ONLIST_TOOLTIP_AVERAGE="Return the average (arithmetic mean) of the numeric values in the list.",o.Msg.MATH_ONLIST_TOOLTIP_MAX="Return the largest number in the list.",o.Msg.MATH_ONLIST_TOOLTIP_MEDIAN="Return the median number in the list.",o.Msg.MATH_ONLIST_TOOLTIP_MIN="Return the smallest number in the list.",o.Msg.MATH_ONLIST_TOOLTIP_MODE="Return a list of the most common item(s) in the list.",o.Msg.MATH_ONLIST_TOOLTIP_RANDOM="Return a random element from the list.",o.Msg.MATH_ONLIST_TOOLTIP_STD_DEV="Return the standard deviation of the list.",o.Msg.MATH_ONLIST_TOOLTIP_SUM="Return the sum of all the numbers in the list.",o.Msg.MATH_POWER_SYMBOL="^",o.Msg.MATH_RANDOM_FLOAT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",o.Msg.MATH_RANDOM_FLOAT_TITLE_RANDOM="random fraction",o.Msg.MATH_RANDOM_FLOAT_TOOLTIP="Return a random fraction between 0.0 (inclusive) and 1.0 (exclusive).",o.Msg.MATH_RANDOM_INT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",o.Msg.MATH_RANDOM_INT_TITLE="random integer from %1 to %2",o.Msg.MATH_RANDOM_INT_TOOLTIP="Return a random integer between the two specified limits, inclusive.",o.Msg.MATH_ROUND_HELPURL="https://en.wikipedia.org/wiki/Rounding",o.Msg.MATH_ROUND_OPERATOR_ROUND="round",o.Msg.MATH_ROUND_OPERATOR_ROUNDDOWN="round down",o.Msg.MATH_ROUND_OPERATOR_ROUNDUP="round up",o.Msg.MATH_ROUND_TOOLTIP="Round a number up or down.",o.Msg.MATH_SINGLE_HELPURL="https://en.wikipedia.org/wiki/Square_root",o.Msg.MATH_SINGLE_OP_ABSOLUTE="absolute",o.Msg.MATH_SINGLE_OP_ROOT="square root",o.Msg.MATH_SINGLE_TOOLTIP_ABS="Return the absolute value of a number.",o.Msg.MATH_SINGLE_TOOLTIP_EXP="Return e to the power of a number.",o.Msg.MATH_SINGLE_TOOLTIP_LN="Return the natural logarithm of a number.",o.Msg.MATH_SINGLE_TOOLTIP_LOG10="Return the base 10 logarithm of a number.",o.Msg.MATH_SINGLE_TOOLTIP_NEG="Return the negation of a number.",o.Msg.MATH_SINGLE_TOOLTIP_POW10="Return 10 to the power of a number.",o.Msg.MATH_SINGLE_TOOLTIP_ROOT="Return the square root of a number.",o.Msg.MATH_SUBTRACTION_SYMBOL="-",o.Msg.MATH_TRIG_ACOS="acos",o.Msg.MATH_TRIG_ASIN="asin",o.Msg.MATH_TRIG_ATAN="atan",o.Msg.MATH_TRIG_COS="cos",o.Msg.MATH_TRIG_HELPURL="https://en.wikipedia.org/wiki/Trigonometric_functions",o.Msg.MATH_TRIG_SIN="sin",o.Msg.MATH_TRIG_TAN="tan",o.Msg.MATH_TRIG_TOOLTIP_ACOS="Return the arccosine of a number.",o.Msg.MATH_TRIG_TOOLTIP_ASIN="Return the arcsine of a number.",o.Msg.MATH_TRIG_TOOLTIP_ATAN="Return the arctangent of a number.",o.Msg.MATH_TRIG_TOOLTIP_COS="Return the cosine of a degree (not radian).",o.Msg.MATH_TRIG_TOOLTIP_SIN="Return the sine of a degree (not radian).",o.Msg.MATH_TRIG_TOOLTIP_TAN="Return the tangent of a degree (not radian).",o.Msg.MOVE_BLOCK="Move Block",o.Msg.NEW_COLOUR_VARIABLE="Create colour variable...",o.Msg.NEW_NUMBER_VARIABLE="Create number variable...",o.Msg.NEW_STRING_VARIABLE="Create string variable...",o.Msg.NEW_VARIABLE="Create variable...",o.Msg.NEW_VARIABLE_TITLE="New variable name:",o.Msg.NEW_VARIABLE_TYPE_TITLE="New variable type:",o.Msg.OPTION_KEY="\u2325 Option",o.Msg.ORDINAL_NUMBER_SUFFIX="",o.Msg.PASTE_SHORTCUT="Paste",o.Msg.PROCEDURES_ALLOW_STATEMENTS="allow statements",o.Msg.PROCEDURES_BEFORE_PARAMS="with:",o.Msg.PROCEDURES_CALLNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",o.Msg.PROCEDURES_CALLNORETURN_TOOLTIP="Run the user-defined function '%1'.",o.Msg.PROCEDURES_CALLRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",o.Msg.PROCEDURES_CALLRETURN_TOOLTIP="Run the user-defined function '%1' and use its output.",o.Msg.PROCEDURES_CALL_BEFORE_PARAMS="with:",o.Msg.PROCEDURES_CALL_DISABLED_DEF_WARNING="Can't run the user-defined function '%1' because the definition block is disabled.",o.Msg.PROCEDURES_CREATE_DO="Create '%1'",o.Msg.PROCEDURES_DEFNORETURN_COMMENT="Describe this function...",o.Msg.PROCEDURES_DEFNORETURN_DO="",o.Msg.PROCEDURES_DEFNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",o.Msg.PROCEDURES_DEFNORETURN_PROCEDURE="do something",o.Msg.PROCEDURES_DEFNORETURN_TITLE="to",o.Msg.PROCEDURES_DEFNORETURN_TOOLTIP="Creates a function with no output.",o.Msg.PROCEDURES_DEFRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",o.Msg.PROCEDURES_DEFRETURN_RETURN="return",o.Msg.PROCEDURES_DEFRETURN_TOOLTIP="Creates a function with an output.",o.Msg.PROCEDURES_DEF_DUPLICATE_WARNING="Warning: This function has duplicate parameters.",o.Msg.PROCEDURES_HIGHLIGHT_DEF="Highlight function definition",o.Msg.PROCEDURES_IFRETURN_HELPURL="https://c2.com/cgi/wiki?GuardClause",o.Msg.PROCEDURES_IFRETURN_TOOLTIP="If a value is true, then return a second value.",o.Msg.PROCEDURES_IFRETURN_WARNING="Warning: This block may be used only within a function definition.",o.Msg.PROCEDURES_MUTATORARG_TITLE="input name:",o.Msg.PROCEDURES_MUTATORARG_TOOLTIP="Add an input to the function.",o.Msg.PROCEDURES_MUTATORCONTAINER_TITLE="inputs",o.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP="Add, remove, or reorder inputs to this function.",o.Msg.REDO="Redo",o.Msg.REMOVE_COMMENT="Remove Comment",o.Msg.RENAME_VARIABLE="Rename variable...",o.Msg.RENAME_VARIABLE_TITLE="Rename all '%1' variables to:",o.Msg.SHORTCUTS_CODE_NAVIGATION="Code navigation",o.Msg.SHORTCUTS_EDITING="Editing",o.Msg.SHORTCUTS_GENERAL="General",o.Msg.TEXT_APPEND_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",o.Msg.TEXT_APPEND_TITLE="to %1 append text %2",o.Msg.TEXT_APPEND_TOOLTIP="Append some text to variable '%1'.",o.Msg.TEXT_CHANGECASE_HELPURL="https://github.com/google/blockly/wiki/Text#adjusting-text-case",o.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE="to lower case",o.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE="to Title Case",o.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE="to UPPER CASE",o.Msg.TEXT_CHANGECASE_TOOLTIP="Return a copy of the text in a different case.",o.Msg.TEXT_CHARAT_FIRST="get first letter",o.Msg.TEXT_CHARAT_FROM_END="get letter # from end",o.Msg.TEXT_CHARAT_FROM_START="get letter #",o.Msg.TEXT_CHARAT_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-text",o.Msg.TEXT_CHARAT_LAST="get last letter",o.Msg.TEXT_CHARAT_RANDOM="get random letter",o.Msg.TEXT_CHARAT_TAIL="",o.Msg.TEXT_CHARAT_TITLE="in text %1 %2",o.Msg.TEXT_CHARAT_TOOLTIP="Returns the letter at the specified position.",o.Msg.TEXT_COUNT_HELPURL="https://github.com/google/blockly/wiki/Text#counting-substrings",o.Msg.TEXT_COUNT_MESSAGE0="count %1 in %2",o.Msg.TEXT_COUNT_TOOLTIP="Count how many times some text occurs within some other text.",o.Msg.TEXT_CREATE_JOIN_ITEM_TOOLTIP="Add an item to the text.",o.Msg.TEXT_CREATE_JOIN_TITLE_JOIN="join",o.Msg.TEXT_CREATE_JOIN_TOOLTIP="Add, remove, or reorder sections to reconfigure this text block.",o.Msg.TEXT_GET_SUBSTRING_END_FROM_END="to letter # from end",o.Msg.TEXT_GET_SUBSTRING_END_FROM_START="to letter #",o.Msg.TEXT_GET_SUBSTRING_END_LAST="to last letter",o.Msg.TEXT_GET_SUBSTRING_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-a-region-of-text",o.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT="in text",o.Msg.TEXT_GET_SUBSTRING_START_FIRST="get substring from first letter",o.Msg.TEXT_GET_SUBSTRING_START_FROM_END="get substring from letter # from end",o.Msg.TEXT_GET_SUBSTRING_START_FROM_START="get substring from letter #",o.Msg.TEXT_GET_SUBSTRING_TAIL="",o.Msg.TEXT_GET_SUBSTRING_TOOLTIP="Returns a specified portion of the text.",o.Msg.TEXT_INDEXOF_HELPURL="https://github.com/google/blockly/wiki/Text#finding-text",o.Msg.TEXT_INDEXOF_OPERATOR_FIRST="find first occurrence of text",o.Msg.TEXT_INDEXOF_OPERATOR_LAST="find last occurrence of text",o.Msg.TEXT_INDEXOF_TITLE="in text %1 %2 %3",o.Msg.TEXT_INDEXOF_TOOLTIP="Returns the index of the first/last occurrence of the first text in the second text. Returns %1 if text is not found.",o.Msg.TEXT_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Text#checking-for-empty-text",o.Msg.TEXT_ISEMPTY_TITLE="%1 is empty",o.Msg.TEXT_ISEMPTY_TOOLTIP="Returns true if the provided text is empty.",o.Msg.TEXT_JOIN_HELPURL="https://github.com/google/blockly/wiki/Text#text-creation",o.Msg.TEXT_JOIN_TITLE_CREATEWITH="create text with",o.Msg.TEXT_JOIN_TOOLTIP="Create a piece of text by joining together any number of items.",o.Msg.TEXT_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",o.Msg.TEXT_LENGTH_TITLE="length of %1",o.Msg.TEXT_LENGTH_TOOLTIP="Returns the number of letters (including spaces) in the provided text.",o.Msg.TEXT_PRINT_HELPURL="https://github.com/google/blockly/wiki/Text#printing-text",o.Msg.TEXT_PRINT_TITLE="print %1",o.Msg.TEXT_PRINT_TOOLTIP="Print the specified text, number or other value.",o.Msg.TEXT_PROMPT_HELPURL="https://github.com/google/blockly/wiki/Text#getting-input-from-the-user",o.Msg.TEXT_PROMPT_TOOLTIP_NUMBER="Prompt for user for a number.",o.Msg.TEXT_PROMPT_TOOLTIP_TEXT="Prompt for user for some text.",o.Msg.TEXT_PROMPT_TYPE_NUMBER="prompt for number with message",o.Msg.TEXT_PROMPT_TYPE_TEXT="prompt for text with message",o.Msg.TEXT_REPLACE_HELPURL="https://github.com/google/blockly/wiki/Text#replacing-substrings",o.Msg.TEXT_REPLACE_MESSAGE0="replace %1 with %2 in %3",o.Msg.TEXT_REPLACE_TOOLTIP="Replace all occurances of some text within some other text.",o.Msg.TEXT_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Text#reversing-text",o.Msg.TEXT_REVERSE_MESSAGE0="reverse %1",o.Msg.TEXT_REVERSE_TOOLTIP="Reverses the order of the characters in the text.",o.Msg.TEXT_TEXT_HELPURL="https://en.wikipedia.org/wiki/String_(computer_science)",o.Msg.TEXT_TEXT_TOOLTIP="A letter, word, or line of text.",o.Msg.TEXT_TRIM_HELPURL="https://github.com/google/blockly/wiki/Text#trimming-removing-spaces",o.Msg.TEXT_TRIM_OPERATOR_BOTH="trim spaces from both sides of",o.Msg.TEXT_TRIM_OPERATOR_LEFT="trim spaces from left side of",o.Msg.TEXT_TRIM_OPERATOR_RIGHT="trim spaces from right side of",o.Msg.TEXT_TRIM_TOOLTIP="Return a copy of the text with spaces removed from one or both ends.",o.Msg.TODAY="Today",o.Msg.UNDO="Undo",o.Msg.UNKNOWN="Unknown",o.Msg.UNNAMED_KEY="unnamed",o.Msg.VARIABLES_DEFAULT_NAME="item",o.Msg.VARIABLES_GET_CREATE_SET="Create 'set %1'",o.Msg.VARIABLES_GET_HELPURL="https://github.com/google/blockly/wiki/Variables#get",o.Msg.VARIABLES_GET_TOOLTIP="Returns the value of this variable.",o.Msg.VARIABLES_SET="set %1 to %2",o.Msg.VARIABLES_SET_CREATE_GET="Create 'get %1'",o.Msg.VARIABLES_SET_HELPURL="https://github.com/google/blockly/wiki/Variables#set",o.Msg.VARIABLES_SET_TOOLTIP="Sets this variable to be equal to the input.",o.Msg.VARIABLE_ALREADY_EXISTS="A variable named '%1' already exists.",o.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE="A variable named '%1' already exists for another type: '%2'.",o.Msg.VARIABLE_ALREADY_EXISTS_FOR_A_PARAMETER="A variable named '%1' already exists as a parameter in the procedure '%2'.",o.Msg.WINDOWS="Windows",o.Msg.WORKSPACE_ARIA_LABEL="Blockly Workspace",o.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT="Say something...",o.Msg.CONTROLS_FOREACH_INPUT_DO=o.Msg.CONTROLS_REPEAT_INPUT_DO,o.Msg.CONTROLS_FOR_INPUT_DO=o.Msg.CONTROLS_REPEAT_INPUT_DO,o.Msg.CONTROLS_IF_ELSEIF_TITLE_ELSEIF=o.Msg.CONTROLS_IF_MSG_ELSEIF,o.Msg.CONTROLS_IF_ELSE_TITLE_ELSE=o.Msg.CONTROLS_IF_MSG_ELSE,o.Msg.CONTROLS_IF_IF_TITLE_IF=o.Msg.CONTROLS_IF_MSG_IF,o.Msg.CONTROLS_IF_MSG_THEN=o.Msg.CONTROLS_REPEAT_INPUT_DO,o.Msg.CONTROLS_WHILEUNTIL_INPUT_DO=o.Msg.CONTROLS_REPEAT_INPUT_DO,o.Msg.LISTS_CREATE_WITH_ITEM_TITLE=o.Msg.VARIABLES_DEFAULT_NAME,o.Msg.LISTS_GET_INDEX_HELPURL=o.Msg.LISTS_INDEX_OF_HELPURL,o.Msg.LISTS_GET_INDEX_INPUT_IN_LIST=o.Msg.LISTS_INLIST,o.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST=o.Msg.LISTS_INLIST,o.Msg.LISTS_INDEX_OF_INPUT_IN_LIST=o.Msg.LISTS_INLIST,o.Msg.LISTS_SET_INDEX_INPUT_IN_LIST=o.Msg.LISTS_INLIST,o.Msg.MATH_CHANGE_TITLE_ITEM=o.Msg.VARIABLES_DEFAULT_NAME,o.Msg.PROCEDURES_DEFRETURN_COMMENT=o.Msg.PROCEDURES_DEFNORETURN_COMMENT,o.Msg.PROCEDURES_DEFRETURN_DO=o.Msg.PROCEDURES_DEFNORETURN_DO,o.Msg.PROCEDURES_DEFRETURN_PROCEDURE=o.Msg.PROCEDURES_DEFNORETURN_PROCEDURE,o.Msg.PROCEDURES_DEFRETURN_TITLE=o.Msg.PROCEDURES_DEFNORETURN_TITLE,o.Msg.TEXT_APPEND_VARIABLE=o.Msg.VARIABLES_DEFAULT_NAME,o.Msg.TEXT_CREATE_JOIN_ITEM_TITLE_ITEM=o.Msg.VARIABLES_DEFAULT_NAME,o.Msg.MATH_HUE="230",o.Msg.LOOPS_HUE="120",o.Msg.LISTS_HUE="260",o.Msg.LOGIC_HUE="210",o.Msg.VARIABLES_HUE="330",o.Msg.TEXTS_HUE="160",o.Msg.PROCEDURES_HUE="290",o.Msg.COLOUR_HUE="20",o.Msg.VARIABLES_DYNAMIC_HUE="310",o.Msg})?ce.apply(no,[]):ce)&&(Xo.exports=Fe)}}]);