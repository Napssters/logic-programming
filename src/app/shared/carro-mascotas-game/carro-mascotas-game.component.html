<div class="container" *ngIf="nivelActual">

  <header class="header">
    <h1 class="title">Carro Recolector</h1>
    <p class="level-indicator">Nivel {{ indiceNivel + 1 }}: {{ nivelActual.nombre }}</p>
  </header>

  <div class="game-area">
    <main class="game-board" [ngStyle]="getGridStyles()">

      <!-- Celdas del mapa -->

      <div *ngFor="let cell of flatLayout; let i = index"
           [class]="'cell ' + cell.type + ' ' + cell.orientation">

        <!-- Indicador de ruta √≥ptima -->
        <div *ngIf="cell.isOptimal" class="optimal-path-indicator"></div>

        <!-- Elementos del juego en la celda con color de fondo -->
        <div *ngIf="cell.entity === 'house'"
             class="game-element house"
             [ngStyle]="{'background-color': getEntityColor(cell)}">
          <span style="font-size:2.2rem;">üè†</span>
        </div>
        <div *ngIf="cell.entity === 'pet'"
             class="game-element pet"
             [ngStyle]="{'background-color': getEntityColor(cell)}">
          <span style="font-size:2.2rem;">{{ getEmojiAnimal(cell.entityName) }}</span>
        </div>
      </div>

      <!-- Carro (elemento m√≥vil) sin fondo -->
      <div class="game-element car" [ngStyle]="getCarStyles()">
        <span style="font-size:2.2rem; background: none;">{{ getEmojiCarro() }}</span>
      </div>

      <!-- Overlay para mensajes -->
      <div *ngIf="mensaje" class="message-overlay">
        <div class="message-box">
          <h2>{{ mensaje }}</h2>
          <button class="action-btn" (click)="siguienteNivel()">Siguiente Nivel</button>
        </div>
      </div>

    </main>

    <aside class="sidebar">
      <div class="info-box">
        <h3>Gasolina</h3>
        <p class="value">{{ gasolinaRestante }}</p>
      </div>

      <div class="info-box">
        <h3>Controles</h3>
        <p class="controls-info">Usa las <strong>flechas</strong> del teclado para moverte.</p>
      </div>

      <div class="info-box">
        <h3>Mascotas</h3>
        <p *ngIf="mascotasRecogidas.length === 0">Ninguna a bordo</p>
        <p *ngFor="let pet of mascotasRecogidas" class="value">{{ getEmojiAnimal(pet) }}</p>
      </div>

      <div class="action-buttons">
        <button class="action-btn" (click)="reiniciarNivel()">Reiniciar</button>
        <button class="action-btn" *ngIf="esEjemplo()" (click)="toggleRuta()">
          {{ mostrarRuta ? 'Ocultar Ruta' : 'Mostrar Ruta' }}
        </button>
  <button class="action-btn" (click)="anteriorNivel()">Anterior</button>
  <button class="action-btn" (click)="siguienteNivel()">Siguiente</button>
      </div>
    </aside>
  </div>

</div>
