(self.webpackChunklogic_programming=self.webpackChunklogic_programming||[]).push([[577],{577:(Qo,oo,le)=>{"use strict";le.r(oo),le.d(oo,{HomeModule:()=>Vr});var Z=le(6814),Be=le(9310),o=le(4946);let U=(()=>{class g{constructor(l){this.router=l}isElectron(){return!!(window&&window.process&&window.process.type||window&&window.require||typeof navigator<"u"&&navigator.userAgent.toLowerCase().indexOf("electron")>-1||"file:"===window.location.protocol)}isGitHubPages(){return"napssters.github.io"===window.location.hostname}isLocalDevelopment(){return"localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname}navigateTo(l){if(console.log("Environment check:",{isElectron:this.isElectron(),isGitHubPages:this.isGitHubPages(),isLocalDevelopment:this.isLocalDevelopment(),protocol:window.location.protocol,hostname:window.location.hostname}),this.isElectron())console.log("Using Angular Router for Electron:",l),this.router.navigate([l]);else if(this.isGitHubPages()){const p=`/logic-programming${l}`;console.log("Using window.location for GitHub Pages:",p),window.location.href=p}else console.log("Using Angular Router for local development:",l),this.router.navigate([l])}static{this.\u0275fac=function(p){return new(p||g)(o.LFG(Be.F0))}}static{this.\u0275prov=o.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"})}}return g})(),u=(()=>{class g{transform(l){return l?"funciones y modularidad"===l.trim().toLowerCase()?"Funciones/Modularidad":"abstracci\xf3n y simplificaci\xf3n"===l.trim().toLowerCase()?"Abstracci\xf3n/Simplificaci\xf3n":l:""}static{this.\u0275fac=function(p){return new(p||g)}}static{this.\u0275pipe=o.Yjl({name:"cardTitleFormat",type:g,pure:!0})}}return g})();function et(g,x){if(1&g){const l=o.EpF();o.TgZ(0,"div",2)(1,"button",3),o.NdJ("click",function(){const v=o.CHM(l).$implicit,O=o.oxw();return o.KtG(O.redirigir(v.url))}),o.TgZ(2,"div",4)(3,"div",5)(4,"div",6),o._UZ(5,"img",7),o.qZA(),o.TgZ(6,"h3",8),o.ALo(7,"cardTitleFormat"),o._uU(8),o.ALo(9,"cardTitleFormat"),o.qZA()(),o.TgZ(10,"div",9)(11,"span",10),o._uU(12),o.qZA(),o.TgZ(13,"p",11),o._uU(14),o.qZA()()()()()}if(2&g){const l=x.$implicit,p=x.index;o.xp6(4),o.Udp("background",l.color),o.xp6(1),o.Q6J("src",l.image,o.LSH)("alt",l.title),o.xp6(1),o.Q6J("ngClass","Abstracci\xf3n/Simplificaci\xf3n"===o.lcZ(7,8,l.title)?"text-left":"text-center justify-center mx-auto"),o.xp6(2),o.Oqu(o.lcZ(9,10,l.title)),o.xp6(4),o.hij("M\xf3dulo ",p+1,""),o.xp6(2),o.Oqu(l.description)}}let ei=(()=>{class g{constructor(l){this.navigationService=l,this.cards=[]}redirigir(l){this.navigationService.navigateTo(l)}static{this.\u0275fac=function(p){return new(p||g)(o.Y36(U))}}static{this.\u0275cmp=o.Xpm({type:g,selectors:[["app-cards"]],inputs:{cards:"cards"},decls:2,vars:1,consts:[[1,"grid","grid-cols-1","md:grid-cols-3","md:gap-x-0.5","md:gap-y-6","justify-center"],["class","card-flip-container",4,"ngFor","ngForOf"],[1,"card-flip-container"],[1,"card-link",3,"click"],[1,"card-flip"],[1,"card-flip-front","flex","flex-col","items-center","justify-center","rounded-xl","shadow-lg","p-6","h-[292px]","w-[286px]","cursor-pointer","bg-white"],[1,"w-[153px]","h-[153px]","mb-4","rounded-full","shadow-md","flex","items-center","justify-center"],[1,"w-[145px]","h-[145px]","rounded-full","object-cover",3,"src","alt"],[1,"text-base","font-semibold","text-gray-900","drop-shadow","max-w-[250px]","line-clamp-2","h-12","flex","items-center",3,"ngClass"],[1,"card-flip-back","flex","flex-col","items-center","justify-center","rounded-xl","shadow-lg","p-6","h-[292px]","w-[286px]","cursor-pointer","bg-white/90"],[1,"text-sm","font-bold","text-cyan-700","mb-2"],[1,"text-base","text-gray-800","w-full","text-justify"]],template:function(p,d){1&p&&(o.TgZ(0,"div",0),o.YNc(1,et,15,12,"div",1),o.qZA()),2&p&&(o.xp6(1),o.Q6J("ngForOf",d.cards))},dependencies:[Z.mk,Z.sg,u],styles:[".card-flip-container[_ngcontent-%COMP%]{perspective:1000px;display:flex;justify-content:center;align-items:center}.card-link[_ngcontent-%COMP%]{text-decoration:none}.card-flip[_ngcontent-%COMP%]{width:224px;height:256px;position:relative;transition:transform .6s;transform-style:preserve-3d;cursor:pointer}.card-flip-container[_ngcontent-%COMP%]:hover   .card-flip[_ngcontent-%COMP%]{transform:rotateY(180deg)}.card-flip-front[_ngcontent-%COMP%], .card-flip-back[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;backface-visibility:hidden;border-radius:1rem;box-shadow:0 8px 32px #1f26875e;display:flex;flex-direction:column;align-items:center;justify-content:center}.card-flip-back[_ngcontent-%COMP%]{transform:rotateY(180deg)}"]})}}return g})(),ti=(()=>{class g{static{this.\u0275fac=function(p){return new(p||g)}}static{this.\u0275cmp=o.Xpm({type:g,selectors:[["app-tutorial"]],decls:88,vars:0,consts:[[1,"p-4","max-w-2xl","mx-auto"],[1,"text-3xl","font-extrabold","mb-4","text-cyan-700"],[1,"mb-6","text-lg","text-gray-700"],[1,"mb-8"],[1,"text-xl","font-bold","text-cyan-600","mb-2"],[1,"flex","gap-4","flex-wrap"],["src","assets/img/tutorial/menu-flotante.png","alt","Men\xfa flotante",1,"tutorial-img"],["src","assets/img/tutorial/menu-flotante-2.png","alt","Men\xfa flotante 2",1,"tutorial-img"],["src","assets/img/tutorial/pantalla-ppal.png","alt","Pantalla principal",1,"tutorial-img"],["src","assets/img/tutorial/modulos.png","alt","M\xf3dulos",1,"tutorial-img"],["src","assets/img/tutorial/modulos-card-girado.png","alt","M\xf3dulo girado",1,"tutorial-img"],["src","assets/img/tutorial/ejemplos.png","alt","Ejemplos",1,"tutorial-img"],["src","assets/img/tutorial/ejercicios.png","alt","Ejercicios",1,"tutorial-img"],["src","assets/img/tutorial/seccion-ejemplo.png","alt","Controles de ejercicios y ejemplos",1,"tutorial-img"],[1,"list-disc","ml-6"],[1,"mt-2"],["src","assets/img/tutorial/paso-a-paso.png","alt","Diagrama de flujo",1,"tutorial-img"],["src","assets/img/tutorial/blockly.png","alt","Blockly",1,"tutorial-img"],["src","assets/img/tutorial/seleccionar-opcion.png","alt","Selecci\xf3n de opci\xf3n",1,"tutorial-img"],[1,"mt-8","text-center","text-lg","text-cyan-700","font-semibold"]],template:function(p,d){1&p&&(o.TgZ(0,"div",0)(1,"h2",1),o._uU(2,"Tutorial de uso del aplicativo"),o.qZA(),o.TgZ(3,"p",2),o._uU(4,"Bienvenido. Aqu\xed aprender\xe1s c\xf3mo usar cada parte del aplicativo paso a paso, con im\xe1genes y explicaciones sencillas. Si nunca has usado una app de l\xf3gica de programaci\xf3n, este tutorial es para ti."),o.qZA(),o.TgZ(5,"div",3)(6,"h3",4),o._uU(7,"1. Navegaci\xf3n flotante"),o.qZA(),o.TgZ(8,"div",5),o._UZ(9,"img",6)(10,"img",7),o.qZA(),o.TgZ(11,"p"),o._uU(12,"En la esquina inferior derecha ver\xe1s un bot\xf3n flotante. Haz clic para moverte entre los m\xf3dulos del curso. Puedes ir al siguiente, anterior o volver al inicio f\xe1cilmente."),o._UZ(13,"br"),o._uU(14," Si pones el mouse encima de cada bot\xf3n, aparecer\xe1 un peque\xf1o mensaje que te explica para qu\xe9 sirve cada uno. As\xed sabr\xe1s si el bot\xf3n te lleva al siguiente m\xf3dulo, al anterior o al inicio."),o.qZA()(),o.TgZ(15,"div",3)(16,"h3",4),o._uU(17,"2. Pantalla principal y m\xf3dulos"),o.qZA(),o.TgZ(18,"div",5),o._UZ(19,"img",8)(20,"img",9)(21,"img",10),o.qZA(),o.TgZ(22,"p"),o._uU(23,"En la pantalla principal ver\xe1s tarjetas de colores. Cada tarjeta es un m\xf3dulo. Haz clic en una para abrir su contenido y empezar a aprender."),o._UZ(24,"br"),o._uU(25," Si pones el mouse encima de una tarjeta, ver\xe1s una animaci\xf3n donde la tarjeta gira y te muestra m\xe1s detalles. Adem\xe1s, aparecer\xe1 un mensaje que te explica qu\xe9 informaci\xf3n ver\xe1s al girar la tarjeta."),o.qZA()(),o.TgZ(26,"div",3)(27,"h3",4),o._uU(28,"3. Ejercicios y ejemplos"),o.qZA(),o.TgZ(29,"div",5),o._UZ(30,"img",11)(31,"img",12),o.qZA(),o.TgZ(32,"p"),o._uU(33,"Dentro de cada m\xf3dulo encontrar\xe1s ejemplos y ejercicios. Los ejemplos te muestran c\xf3mo funciona la l\xf3gica. Los ejercicios te permiten practicar y resolver problemas."),o.qZA()(),o.TgZ(34,"div",3)(35,"h3",4),o._uU(36,"4. Controles de ejercicios y ejemplos"),o.qZA(),o._UZ(37,"img",13),o.TgZ(38,"ul",14)(39,"li")(40,"b"),o._uU(41,"Avanzar:"),o.qZA(),o._uU(42,' Pasa al siguiente paso del ejercicio. Si pones el mouse encima del bot\xf3n, ver\xe1s un mensaje que te dice "Avanzar".'),o.qZA(),o.TgZ(43,"li")(44,"b"),o._uU(45,"Retroceder:"),o.qZA(),o._uU(46,' Vuelve al paso anterior. Al poner el mouse encima, ver\xe1s el mensaje "Retroceder".'),o.qZA(),o.TgZ(47,"li")(48,"b"),o._uU(49,"Reiniciar:"),o.qZA(),o._uU(50,' Vuelve a empezar el ejercicio desde cero. El mensaje "Reiniciar" te ayuda a saber para qu\xe9 sirve el bot\xf3n.'),o.qZA()(),o.TgZ(51,"p",15),o._uU(52,"Usa estos botones para controlar el ritmo y repetir los ejercicios cuantas veces quieras. Siempre que pongas el mouse encima de un bot\xf3n, aparecer\xe1 un mensaje que te explica su funci\xf3n."),o.qZA()(),o.TgZ(53,"div",3)(54,"h3",4),o._uU(55,"5. Diagrama de flujo"),o.qZA(),o._UZ(56,"img",16),o.TgZ(57,"p"),o._uU(58,"Muchos ejercicios muestran un diagrama de flujo. Este te ayuda a visualizar la l\xf3gica y el orden de los pasos. Observa c\xf3mo se conectan los bloques y sigue el flujo para entender el proceso."),o.qZA()(),o.TgZ(59,"div",3)(60,"h3",4),o._uU(61,"6. Uso de Blockly"),o.qZA(),o._UZ(62,"img",17),o.TgZ(63,"p"),o._uU(64,'Blockly es una herramienta visual para programar con bloques. Arrastra los bloques, \xfanelos y arma tu soluci\xf3n. Haz clic en "Ejecutar" para ver el resultado y comprobar si tu l\xf3gica es correcta.'),o.qZA()(),o.TgZ(65,"div",3)(66,"h3",4),o._uU(67,"7. Selecci\xf3n de opciones en Concepto de Variables"),o.qZA(),o._UZ(68,"img",18),o.TgZ(69,"p"),o._uU(70,"En el m\xf3dulo de Concepto de Variables, ver\xe1s una lista de opciones. Haz clic en una para abrir ejemplos y ejercicios espec\xedficos de ese tema."),o.qZA()(),o.TgZ(71,"div",3)(72,"h3",4),o._uU(73,"8. Consejos para aprender mejor"),o.qZA(),o.TgZ(74,"ul",14)(75,"li"),o._uU(76,"Lee cada explicaci\xf3n con calma y sigue los pasos."),o.qZA(),o.TgZ(77,"li"),o._uU(78,"Practica los ejercicios varias veces para dominar la l\xf3gica."),o.qZA(),o.TgZ(79,"li"),o._uU(80,"Usa los diagramas de flujo para entender el proceso antes de programar."),o.qZA(),o.TgZ(81,"li"),o._uU(82,"No tengas miedo de equivocarte, cada error es una oportunidad para aprender."),o.qZA(),o.TgZ(83,"li"),o._uU(84,"Si tienes dudas, revisa el tutorial o pregunta a tu profesor."),o.qZA()()(),o.TgZ(85,"div",19)(86,"p"),o._uU(87,"\xa1Listo! Ya sabes c\xf3mo usar el aplicativo. Explora, practica y aprende l\xf3gica de programaci\xf3n de forma visual y divertida."),o.qZA()()())},styles:[".tutorial-img[_ngcontent-%COMP%]{box-shadow:0 4px 16px #0000001f;border-radius:1rem}",".tutorial-img[_ngcontent-%COMP%] {\n    width: 180px;\n    max-width: 100%;\n    border-radius: 0.75rem;\n    box-shadow: 0 2px 8px rgba(0,0,0,0.12);\n    margin-bottom: 0.5rem;\n    transition: transform 0.3s cubic-bezier(.4,2,.3,1), box-shadow 0.3s;\n    cursor: pointer;\n  }\n  .tutorial-img[_ngcontent-%COMP%]:hover {\n    transform: scale(3);\n    box-shadow: 0 12px 48px rgba(0,0,0,0.28);\n    z-index: 100;\n  }\n  .tutorial-modal-bg[_ngcontent-%COMP%] {\n    position: fixed;\n    top: 0; left: 0; right: 0; bottom: 0;\n    background: rgba(0,0,0,0.7);\n    z-index: 1000;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n  .tutorial-modal-img[_ngcontent-%COMP%] {\n    max-width: 90vw;\n    max-height: 90vh;\n    border-radius: 1rem;\n    box-shadow: 0 8px 32px rgba(0,0,0,0.32);\n    background: #fff;\n    padding: 1rem;\n  }"]})}}return g})();const tt=JSON.parse('{"_":[{"title":"Introducci\xf3n a la L\xf3gica de Programaci\xf3n","description":"Fundamentos esenciales para entender c\xf3mo funcionan los programas, comparados con recetas detalladas.","image":"assets/img/landing/m1.png","url":"/home/introduccion","color":"linear-gradient(135deg, #38bdf8 0%, #6366f1 50%, #a78bfa 100%)"},{"title":"Concepto de Variables","description":"Explicaci\xf3n sobre c\xf3mo las variables almacenan datos como n\xfameros, palabras o im\xe1genes, esenciales en programaci\xf3n.","image":"assets/img/landing/m2.png","url":"/home/concepto-variables","color":"linear-gradient(135deg, #38bdf8 0%, #6366f1 50%, #a78bfa 100%)"},{"title":"Estructuras de Control: Condicionales","description":"Uso de estructuras para tomar decisiones en programas seg\xfan condiciones espec\xedficas.","image":"assets/img/landing/m3.png","url":"/home/condicionales","color":"linear-gradient(135deg, #38bdf8 0%, #6366f1 50%, #a78bfa 100%)"},{"title":"Estructuras de Control: Bucles","description":"Repetici\xf3n eficiente de acciones en programas usando bucles \'for\' y \'while\'.","image":"assets/img/landing/m4.png","url":"/home/bucles","color":"linear-gradient(135deg, #fbbf24 0%, #f472b6 100%)"},{"title":"Funciones y Modularidad","description":"Organizaci\xf3n del c\xf3digo mediante funciones para facilitar su mantenimiento y reutilizaci\xf3n.","image":"assets/img/landing/m5.png","url":"/home/modularidad","color":"linear-gradient(135deg, #fbbf24 0%, #f472b6 100%)"},{"title":"Abstracci\xf3n y Simplificaci\xf3n","description":"M\xe9todos para dividir problemas complejos en partes m\xe1s simples y manejables.","image":"assets/img/landing/m6.png","url":"/home/abstraccion","color":"linear-gradient(135deg, #fbbf24 0%, #f472b6 100%)"},{"title":"Pensamiento L\xf3gico y Deductivo","description":"Aplicaci\xf3n de razonamiento l\xf3gico para resolver problemas usando premisas y conclusiones.","image":"assets/img/landing/m7.png","url":"/home/pensamiento-logico","color":"linear-gradient(135deg, #22c55e 0%, #06b6d4 100%)"},{"title":"Toma de Decisiones y Evaluaci\xf3n de Opciones","description":"Proceso sistem\xe1tico para evaluar diferentes opciones y tomar decisiones informadas.","image":"assets/img/landing/m8.png","url":"/home/toma-de-decisiones","color":"linear-gradient(135deg, #22c55e 0%, #06b6d4 100%)"},{"title":"Soluci\xf3n Creativa de Problemas","description":"Enfoque pr\xe1ctico y creativo para resolver desaf\xedos mediante ideas originales y efectivas.","image":"assets/img/landing/m9.png","url":"/home/solucion-creativa","color":"linear-gradient(135deg, #22c55e 0%, #06b6d4 100%)"}]}');var Tt=le(2593);const io=["dynamicComponentContainer"];function xe(g,x){if(1&g){const l=o.EpF();o.TgZ(0,"div",1),o.NdJ("click",function(d){o.CHM(l);const v=o.oxw();return o.KtG(v.onBackdropClick(d))}),o.TgZ(1,"div",2),o.NdJ("click",function(d){o.CHM(l);const v=o.oxw();return o.KtG(v.onModalContentClick(d))}),o.TgZ(2,"div",3)(3,"div")(4,"h2",4),o._uU(5),o.qZA()(),o.TgZ(6,"div",5)(7,"button",6),o.NdJ("click",function(){o.CHM(l);const d=o.oxw();return o.KtG(d.closeModal())}),o.O4$(),o.TgZ(8,"svg",7),o._UZ(9,"path",8),o.qZA(),o.kcU(),o.TgZ(10,"div",9),o._uU(11," Cerrar "),o._UZ(12,"div",10),o.qZA()()()(),o.TgZ(13,"div",11)(14,"div",12),o.GkF(15,null,13),o.qZA()()()()}if(2&g){const l=o.oxw();o.xp6(1),o.Tol(l.maxWidth+" "+l.maxHeight),o.xp6(4),o.Oqu(l.title)}}let so=(()=>{class g{constructor(){this.isVisible=!1,this.title="",this.componentType=null,this.componentInputs={},this.maxWidth="max-w-4xl",this.maxHeight="max-h-[90vh]",this.onClose=new o.vpe,this.componentRef=null}ngOnChanges(l){l.isVisible&&this.isVisible&&this.componentType&&setTimeout(()=>{this.loadComponent()},0)}ngOnDestroy(){this.destroyComponent()}loadComponent(){!this.dynamicComponentContainer||!this.componentType||(this.destroyComponent(),this.componentRef=this.dynamicComponentContainer.createComponent(this.componentType),this.componentInputs&&Object.keys(this.componentInputs).forEach(l=>{this.componentRef?.instance.hasOwnProperty(l)&&(this.componentRef.instance[l]=this.componentInputs[l])}),this.componentRef.changeDetectorRef.detectChanges())}destroyComponent(){this.componentRef&&(this.componentRef.destroy(),this.componentRef=null),this.dynamicComponentContainer&&this.dynamicComponentContainer.clear()}closeModal(){this.onClose.emit()}onBackdropClick(l){this.closeModal()}onModalContentClick(l){l.stopPropagation()}static{this.\u0275fac=function(p){return new(p||g)}}static{this.\u0275cmp=o.Xpm({type:g,selectors:[["app-modal"]],viewQuery:function(p,d){if(1&p&&o.Gf(io,5,o.s_b),2&p){let v;o.iGM(v=o.CRH())&&(d.dynamicComponentContainer=v.first)}},inputs:{isVisible:"isVisible",title:"title",componentType:"componentType",componentInputs:"componentInputs",maxWidth:"maxWidth",maxHeight:"maxHeight"},outputs:{onClose:"onClose"},features:[o.TTD],decls:1,vars:1,consts:[["class","fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",3,"click",4,"ngIf"],[1,"fixed","inset-0","z-50","flex","items-center","justify-center","bg-black","bg-opacity-50",3,"click"],[1,"bg-white","rounded-lg","shadow-xl","w-full","mx-4","overflow-auto",3,"click"],[1,"flex","justify-between","items-center","p-6","border-b","border-gray-200","sticky","top-0","bg-white","z-10"],[1,"text-2xl","font-bold","text-gray-800"],[1,"relative"],[1,"w-10","h-10","text-white","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border-2","group",2,"background-color","#f3ae22","border-color","#d18c00",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7"],[1,"absolute","top-12","left-1/2","transform","-translate-x-1/2","bg-gray-800","text-white","text-xs","px-2","py-1","rounded","shadow-lg","opacity-0","group-hover:opacity-100","transition-opacity","duration-200","whitespace-nowrap","pointer-events-none","z-50"],[1,"absolute","bottom-full","left-1/2","transform","-translate-x-1/2","w-0","h-0","border-l-2","border-r-2","border-b-4","border-transparent","border-b-gray-800"],[1,"p-6"],[1,"min-h-[400px]"],["dynamicComponentContainer",""]],template:function(p,d){1&p&&o.YNc(0,xe,17,3,"div",0),2&p&&o.Q6J("ngIf",d.isVisible)},dependencies:[Z.O5],styles:[".modal-overlay[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px)}.modal-content[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_modalSlideIn .3s ease-out}@keyframes _ngcontent-%COMP%_modalSlideIn{0%{opacity:0;transform:translateY(-20px) scale(.95)}to{opacity:1;transform:translateY(0) scale(1)}}"]})}}return g})();const it=function(g){return{cards:g}};let Ae=(()=>{class g{constructor(l,p,d){this.router=l,this.navigationService=p,this.modalService=d,this.cards=[],this.showModal=!1,this.modalComponentType=ei,this.modalTitle="M\xf3dulos disponibles"}redirigir(l){this.navigationService.navigateTo(l)}ngOnInit(){this.loadData(),this.modalSubscription=this.modalService.onOpenModal().subscribe(()=>{this.openCardsModal()})}ngOnDestroy(){this.modalSubscription&&this.modalSubscription.unsubscribe()}loadData(){this.cards=tt._}openCardsModal(){this.modalComponentType=ei,this.modalTitle="M\xf3dulos disponibles",this.showModal=!0}openTutorialModal(){this.modalComponentType=ti,this.modalTitle="Tutorial de uso del aplicativo",this.showModal=!0}closeCardsModal(){this.showModal=!1}static{this.\u0275fac=function(p){return new(p||g)(o.Y36(Be.F0),o.Y36(U),o.Y36(Tt.Z))}}static{this.\u0275cmp=o.Xpm({type:g,selectors:[["app-start-page"]],decls:21,vars:8,consts:[[1,"min-h-screen","w-full","bg-gradient-to-br","from-cyan-100","via-white","to-blue-100","relative","overflow-hidden","flex","flex-col"],[1,"absolute","inset-0","w-full","h-full","z-0"],["src","assets/img/landing/logica_de_programacion.jpeg","alt","L\xf3gica de Programaci\xf3n",1,"w-full","h-full","object-cover"],[1,"flex","flex-col","justify-center","items-start","p-8","z-10","w-full","md:w-2/3","relative",2,"margin-left","4rem","min-height","100vh","justify-content","center"],[2,"border-radius","2rem","width","87%","max-width","none","max-height","480px","background","rgba(255,255,255,0.18)","backdrop-filter","blur(16px)","box-shadow","0 8px 32px 0 rgba(31,38,135,0.37)","border","1px solid rgba(255,255,255,0.18)","padding","2.5rem 2rem","display","flex","flex-direction","column","align-items","flex-start","justify-content","center","margin-left","-2rem"],[2,"margin-left","2rem","margin-right","2rem"],[1,"w-32","h-32","rounded-full","shadow-xl","mb-6","flex","items-center","justify-center","bg-white/30","animate-bounce"],["src","assets/img/landing/utp.png","alt","utp",1,"w-28","h-28","object-contain"],[1,"text-4xl","md:text-5xl","font-extrabold","text-white","drop-shadow-lg","mb-4","leading-tight"],[1,"text-xl","md:text-2xl","text-white","drop-shadow-lg","mb-4","font-semibold"],[1,"text-base","text-white","drop-shadow-lg","mb-6","w-full","text-justify"],[1,"flex","items-center","gap-4"],[1,"bg-cyan-600","hover:bg-cyan-700","text-white","font-bold","py-2","px-6","rounded-full","shadow","transition-all","duration-300",3,"click"],[1,"flex","flex-col","items-start"],[1,"text-cyan-700","hover:text-white","hover:underline","font-semibold","text-base","cursor-pointer",3,"click"],[3,"isVisible","title","componentType","componentInputs","maxWidth","maxHeight","onClose"]],template:function(p,d){1&p&&(o.TgZ(0,"section",0)(1,"div",1),o._UZ(2,"img",2),o.qZA(),o.TgZ(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6),o._UZ(7,"img",7),o.qZA(),o.TgZ(8,"h1",8),o._uU(9,"Pensamiento b\xe1sico de Programador"),o.qZA(),o.TgZ(10,"p",9),o._uU(11,"Explorando la L\xf3gica de la Programaci\xf3n"),o.qZA(),o.TgZ(12,"p",10),o._uU(13,"Aprende l\xf3gica de programaci\xf3n de forma visual, interactiva y divertida. Descubre los m\xf3dulos y comienza tu viaje en el pensamiento computacional."),o.qZA(),o.TgZ(14,"div",11)(15,"button",12),o.NdJ("click",function(){return d.openCardsModal()}),o._uU(16,"Comenzar ahora"),o.qZA(),o.TgZ(17,"div",13)(18,"a",14),o.NdJ("click",function(){return d.openTutorialModal()}),o._uU(19,"\xbfC\xf3mo usar el aplicativo?"),o.qZA()()()()()(),o.TgZ(20,"app-modal",15),o.NdJ("onClose",function(){return d.closeCardsModal()}),o.qZA()()),2&p&&(o.xp6(20),o.Q6J("isVisible",d.showModal)("title",d.modalTitle)("componentType",d.modalComponentType)("componentInputs",o.VKq(6,it,d.cards))("maxWidth","max-w-5xl")("maxHeight","max-h-[90vh]"))},dependencies:[so]})}}return g})();function Ie(g,x){1&g&&(o.TgZ(0,"section",12)(1,"div",13)(2,"h2",14),o._uU(3,"\u{1f4cd} "),o.TgZ(4,"b"),o._uU(5,"\xbfQu\xe9 es la soluci\xf3n creativa de problemas?"),o.qZA()(),o.TgZ(6,"p",15),o._uU(7," La soluci\xf3n creativa de problemas es la capacidad de encontrar caminos innovadores para resolver desaf\xedos, combinando pensamiento l\xf3gico con imaginaci\xf3n."),o._UZ(8,"br"),o._uU(9," No se trata \xfanicamente de \u201cpensar diferente\u201d por el simple hecho de ser original, sino de encontrar soluciones que sean originales y, al mismo tiempo, efectivas."),o.qZA(),o.TgZ(10,"p",15),o._uU(11,"En programaci\xf3n, muchas veces un problema puede resolverse con t\xe9cnicas ya conocidas, pero cuando estas no funcionan o no son \xf3ptimas, entra en juego la creatividad para encontrar un enfoque alternativo."),o.qZA(),o.TgZ(12,"div",16)(13,"h3",17),o._uU(14,"\u{1f4e6} Met\xe1fora: El chef improvisador"),o.qZA(),o.TgZ(15,"p",18),o._uU(16,"Imagina que eres un chef y est\xe1s cocinando un plato especial para un cliente."),o._UZ(17,"br"),o._uU(18," De repente, te das cuenta de que falta un ingrediente clave."),o.qZA(),o.TgZ(19,"ul",19)(20,"li"),o._uU(21,"Opci\xf3n tradicional: cancelar el plato o retrasar el pedido para ir a comprarlo."),o.qZA(),o.TgZ(22,"li"),o._uU(23,"Opci\xf3n creativa: sustituir el ingrediente por otro que tengas a mano y que aporte un sabor similar o incluso mejor."),o.qZA()(),o.TgZ(24,"p",18),o._uU(25,"La creatividad en la soluci\xf3n de problemas es exactamente eso: adaptarte a la situaci\xf3n y buscar nuevas combinaciones que cumplan el objetivo, incluso mejorando el resultado esperado."),o.qZA()(),o.TgZ(26,"div",20)(27,"h2",21),o._uU(28,"\u{1f504} Soluci\xf3n creativa y la vida real"),o.qZA(),o.TgZ(29,"ul",22)(30,"li"),o._uU(31,"En casa: Si se rompe el control remoto, puedes cambiar de canal usando los botones de la TV o incluso una app en el tel\xe9fono."),o.qZA(),o.TgZ(32,"li"),o._uU(33,"En el trabajo: Si un archivo es demasiado pesado para enviarlo por correo, puedes comprimirlo, subirlo a la nube o dividirlo en partes."),o.qZA(),o.TgZ(34,"li"),o._uU(35,"En la escuela: Si olvidaste tu cuaderno, puedes pedirle a un compa\xf1ero una foto de las notas."),o.qZA()(),o.TgZ(36,"p",18),o._uU(37,"La creatividad no siempre es \u201cinventar algo nuevo\u201d desde cero, muchas veces es usar lo que tienes de una forma distinta."),o.qZA()(),o.TgZ(38,"div",23)(39,"h2",24),o._uU(40,"\u{1f9e9} Elementos clave de la soluci\xf3n creativa"),o.qZA(),o.TgZ(41,"ul",22)(42,"li"),o._uU(43,"Identificaci\xf3n precisa del problema"),o._UZ(44,"br"),o.TgZ(45,"span",18),o._uU(46,"No se puede encontrar una soluci\xf3n efectiva si no se entiende exactamente qu\xe9 se quiere resolver."),o._UZ(47,"br"),o._uU(48,"Ejemplo: \u201cEl sistema es lento\u201d es muy general. \u201cEl sistema tarda 5 segundos en cargar la lista de productos\u201d es espec\xedfico y accionable."),o.qZA()(),o.TgZ(49,"li"),o._uU(50,"An\xe1lisis desde diferentes perspectivas"),o._UZ(51,"br"),o.TgZ(52,"span",18),o._uU(53,"Ver el problema desde distintos \xe1ngulos. A veces la soluci\xf3n aparece cuando lo miras desde el punto de vista de otro usuario, otro equipo o incluso otra cultura."),o.qZA()(),o.TgZ(54,"li"),o._uU(55,"Generaci\xf3n de m\xfaltiples ideas"),o._UZ(56,"br"),o.TgZ(57,"span",18),o._uU(58,"Cuantas m\xe1s ideas tengas, m\xe1s probabilidades de encontrar una soluci\xf3n innovadora. Aqu\xed no se juzga si son \u201cbuenas\u201d o \u201cmalas\u201d, la prioridad es cantidad."),o.qZA()(),o.TgZ(59,"li"),o._uU(60,"Pensar fuera del patr\xf3n (out of the box)"),o._UZ(61,"br"),o.TgZ(62,"span",18),o._uU(63,"Se trata de romper las rutas mentales comunes y atreverse a probar lo que, en principio, podr\xeda parecer extra\xf1o."),o.qZA()(),o.TgZ(64,"li"),o._uU(65,"Combinar conceptos"),o._UZ(66,"br"),o.TgZ(67,"span",18),o._uU(68,"La fusi\xf3n de dos ideas distintas suele producir soluciones poderosas. Ejemplo: las \u201cbicicletas el\xe9ctricas\u201d combinan el transporte tradicional con tecnolog\xeda el\xe9ctrica."),o.qZA()(),o.TgZ(69,"li"),o._uU(70,"Evaluaci\xf3n pr\xe1ctica"),o._UZ(71,"br"),o.TgZ(72,"span",18),o._uU(73,"No toda idea creativa es viable. Hay que considerar recursos, tiempo, riesgos y beneficios antes de implementarla."),o.qZA()(),o.TgZ(74,"li"),o._uU(75,"Iteraci\xf3n y mejora"),o._UZ(76,"br"),o.TgZ(77,"span",18),o._uU(78,"La primera versi\xf3n rara vez es perfecta. La creatividad tambi\xe9n incluye la capacidad de mejorar la soluci\xf3n con base en pruebas y retroalimentaci\xf3n."),o.qZA()()()(),o.TgZ(79,"div",16)(80,"h2",25),o._uU(81,"\u{1f9e0} Enfoques creativos usados en programaci\xf3n"),o.qZA(),o.TgZ(82,"ul",22)(83,"li"),o._uU(84,"Reutilizaci\xf3n de c\xf3digo en contextos distintos al que fue creado."),o.qZA(),o.TgZ(85,"li"),o._uU(86,"Uso de librer\xedas de forma no tradicional, combinando funciones para lograr nuevos resultados."),o.qZA(),o.TgZ(87,"li"),o._uU(88,"Aplicar conceptos de un lenguaje de programaci\xf3n en otro para obtener ventajas t\xe9cnicas."),o.qZA(),o.TgZ(89,"li"),o._uU(90,"Pensar en soluciones visuales (UI/UX) para problemas que no son puramente t\xe9cnicos."),o.qZA()()(),o.TgZ(91,"div",26)(92,"h2",27),o._uU(93,"\u{1f680} Beneficios de aplicar soluciones creativas"),o.qZA(),o.TgZ(94,"ul",22)(95,"li"),o._uU(96,"Mayor eficiencia y reducci\xf3n de costos."),o.qZA(),o.TgZ(97,"li"),o._uU(98,"Respuestas r\xe1pidas a problemas imprevistos."),o.qZA(),o.TgZ(99,"li"),o._uU(100,"Mayor competitividad y diferenciaci\xf3n en el mercado."),o.qZA(),o.TgZ(101,"li"),o._uU(102,"Mejor experiencia para el usuario final."),o.qZA(),o.TgZ(103,"li"),o._uU(104,"Incremento de la satisfacci\xf3n personal y del equipo al resolver desaf\xedos de forma ingeniosa."),o.qZA()()()()())}function no(g,x){1&g&&(o.TgZ(0,"section",12)(1,"h1",28),o._uU(2,"Ejemplos"),o.qZA()())}function oi(g,x){1&g&&(o.TgZ(0,"section",12)(1,"h1",28),o._uU(2,"Ejercicios"),o.qZA()())}const L=function(g){return{"button-with-point":g}};let qe=(()=>{class g{constructor(){this.selectedSection=1}static{this.\u0275fac=function(p){return new(p||g)}}static{this.\u0275cmp=o.Xpm({type:g,selectors:[["app-solucion-creativa"]],decls:23,vars:24,consts:[[1,"text-center","mb-6","mt-6"],[1,"text-3xl","font-bold","text-gray-800","mb-2","drop-shadow-md"],[1,"flex","items-center","justify-center","mb-1"],[1,"h-0.5","bg-gradient-to-r","from-transparent","via-blue-500","to-transparent","w-96","shadow-sm"],[1,"flex","items-center","justify-center"],[1,"h-px","bg-gradient-to-r","from-transparent","via-gray-300","to-transparent","w-64","opacity-60"],[1,"flex","flex-col","items-center","mb-6"],[1,"sticky","top-0","z-20","w-auto","flex","justify-center","bg-transparent","backdrop-blur-md","py-2","rounded-xl"],[1,"flex","gap-72"],[1,"relative","px-4","py-2","rounded-lg","font-semibold","text-gray-700","hover:text-green-500","transition",3,"ngClass","click"],[1,"flex","flex-col","gap-6","items-center","w-full","px-2","md:px-0"],["class","bg-gray-500/20 backdrop-blur-md p-8 rounded-lg border border-gray-400/30 shadow-lg w-full max-w-7xl mt-2 mb-8",4,"ngIf"],[1,"bg-gray-500/20","backdrop-blur-md","p-8","rounded-lg","border","border-gray-400/30","shadow-lg","w-full","max-w-7xl","mt-2","mb-8"],[1,"flex","flex-col","gap-6","mb-8","justify-start","items-start"],[1,"text-xl","font-bold","text-blue-500","mb-2","flex","items-center","gap-2"],[1,"text-gray-800","ml-8"],[1,"bg-gradient-to-br","from-blue-100","via-blue-50","to-white","border-l-4","border-blue-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"text-lg","font-semibold","text-gray-700","mt-4","mb-2","flex","items-center","gap-2"],[1,"text-gray-700"],[1,"list-disc","pl-6","text-gray-700","mb-2"],[1,"bg-gradient-to-br","from-green-100","via-green-50","to-white","border-l-4","border-green-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"text-xl","font-bold","text-green-600","mb-2","flex","items-center","gap-2"],[1,"list-disc","ml-6","text-gray-800","mb-2"],[1,"bg-gradient-to-br","from-yellow-100","via-yellow-50","to-white","border-l-4","border-yellow-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"text-xl","font-bold","text-yellow-600","mb-2","flex","items-center","gap-2"],[1,"text-xl","font-bold","text-blue-600","mb-2","flex","items-center","gap-2"],[1,"bg-gradient-to-br","from-pink-100","via-pink-50","to-white","border-l-4","border-pink-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"text-xl","font-bold","text-pink-600","mb-2","flex","items-center","gap-2"],[1,"mt-6"]],template:function(p,d){1&p&&(o.TgZ(0,"div",0)(1,"h1",1),o._uU(2,"\u{1f3a8} Soluci\xf3n Creativa de Problemas"),o.qZA(),o.TgZ(3,"div",2),o._UZ(4,"div",3),o.qZA(),o.TgZ(5,"div",4),o._UZ(6,"div",5),o.qZA()(),o.TgZ(7,"div",6)(8,"nav",7)(9,"ul",8)(10,"li")(11,"button",9),o.NdJ("click",function(){return d.selectedSection=1}),o._uU(12," Teor\xeda "),o.qZA()(),o.TgZ(13,"li")(14,"button",9),o.NdJ("click",function(){return d.selectedSection=2}),o._uU(15," Ejemplos "),o.qZA()(),o.TgZ(16,"li")(17,"button",9),o.NdJ("click",function(){return d.selectedSection=3}),o._uU(18," Ejercicios "),o.qZA()()()()(),o.TgZ(19,"div",10),o.YNc(20,Ie,105,0,"section",11),o.YNc(21,no,3,0,"section",11),o.YNc(22,oi,3,0,"section",11),o.qZA()),2&p&&(o.xp6(11),o.ekj("border-b-4",1===d.selectedSection)("border-blue-500",1===d.selectedSection),o.Q6J("ngClass",o.VKq(18,L,1===d.selectedSection)),o.xp6(3),o.ekj("border-b-4",2===d.selectedSection)("border-blue-500",2===d.selectedSection),o.Q6J("ngClass",o.VKq(20,L,2===d.selectedSection)),o.xp6(3),o.ekj("border-b-4",3===d.selectedSection)("border-blue-500",3===d.selectedSection),o.Q6J("ngClass",o.VKq(22,L,3===d.selectedSection)),o.xp6(3),o.Q6J("ngIf",1===d.selectedSection),o.xp6(1),o.Q6J("ngIf",2===d.selectedSection),o.xp6(1),o.Q6J("ngIf",3===d.selectedSection))},dependencies:[Z.mk,Z.O5],styles:[".button-with-point[_ngcontent-%COMP%]{border-bottom-width:4px!important;border-bottom-color:#22c55e!important}"]})}}return g})();function K(g,x){1&g&&(o.TgZ(0,"section",12)(1,"div",13)(2,"h2",14),o._uU(3,"\u{1f9e0} \xbfQu\xe9 es la toma de decisiones?"),o.qZA(),o.TgZ(4,"p",15),o._uU(5,"La toma de decisiones es el proceso consciente de elegir entre varias alternativas (opciones) analizando informaci\xf3n, premisas y consecuencias. En programaci\xf3n y en la vida real implica evaluar datos, aplicar reglas l\xf3gicas y seleccionar la acci\xf3n m\xe1s adecuada seg\xfan objetivos y restricciones."),o.qZA(),o.TgZ(6,"div",16)(7,"h3",17),o._uU(8,"\u{1f527} Elementos fundamentales de todo proceso de decisi\xf3n"),o.qZA(),o.TgZ(9,"ul",18)(10,"li")(11,"b"),o._uU(12,"Opciones (alternativas):"),o.qZA(),o._uU(13," las posibilidades entre las que puedes elegir."),o.qZA(),o.TgZ(14,"li")(15,"b"),o._uU(16,"Premisas / datos:"),o.qZA(),o._uU(17," hechos o suposiciones sobre la situaci\xf3n (lo que sabes)."),o.qZA(),o.TgZ(18,"li")(19,"b"),o._uU(20,"Criterios:"),o.qZA(),o._uU(21," lo que valoras para elegir (rapidez, coste, seguridad, calidad)."),o.qZA(),o.TgZ(22,"li")(23,"b"),o._uU(24,"Restricciones:"),o.qZA(),o._uU(25," l\xedmites reales (presupuesto, tiempo, recursos)."),o.qZA(),o.TgZ(26,"li")(27,"b"),o._uU(28,"Consecuencias:"),o.qZA(),o._uU(29," resultados esperados para cada opci\xf3n."),o.qZA(),o.TgZ(30,"li")(31,"b"),o._uU(32,"Incertidumbre:"),o.qZA(),o._uU(33," grado de desconocimiento o probabilidad de distintos resultados."),o.qZA()()(),o.TgZ(34,"div",19)(35,"h2",20),o._uU(36,"\u{1f4da} Tipos de decisiones"),o.qZA(),o.TgZ(37,"ul",21)(38,"li")(39,"b"),o._uU(40,"Determin\xedsticas:"),o.qZA(),o._uU(41," resultado claro si se cumplen condiciones (ej. sem\xe1foro)."),o.qZA(),o.TgZ(42,"li")(43,"b"),o._uU(44,"Probabil\xedsticas:"),o.qZA(),o._uU(45," resultado incierto (ej. clima, mercado)."),o.qZA(),o.TgZ(46,"li")(47,"b"),o._uU(48,"Simples / aisladas:"),o.qZA(),o._uU(49," una sola elecci\xf3n moment\xe1nea."),o.qZA(),o.TgZ(50,"li")(51,"b"),o._uU(52,"Secuenciales:"),o.qZA(),o._uU(53," m\xfaltiples decisiones encadenadas (planificaci\xf3n)."),o.qZA(),o.TgZ(54,"li")(55,"b"),o._uU(56,"\xd3ptimas vs. satisficing:"),o.qZA(),o._uU(57," buscar la mejor soluci\xf3n o una suficientemente buena (por tiempo/recursos)."),o.qZA()()(),o.TgZ(58,"div",22)(59,"h2",23),o._uU(60,"\u{1f9ed} Met\xe1foras cotidianas"),o.qZA(),o.TgZ(61,"ul",21)(62,"li")(63,"b"),o._uU(64,"Bifurcaci\xf3n en el camino:"),o.qZA(),o._uU(65," llegas a un cruce y tomas la ruta seg\xfan se\xf1ales (condicional)."),o.qZA(),o.TgZ(66,"li")(67,"b"),o._uU(68,"Carta de restaurante:"),o.qZA(),o._uU(69," eliges plato seg\xfan hambre, tiempo y dinero (ponderar criterios)."),o.qZA(),o.TgZ(70,"li")(71,"b"),o._uU(72,"GPS con tr\xe1fico:"),o.qZA(),o._uU(73," elige la ruta m\xe1s r\xe1pida en tiempo real (evaluaci\xf3n din\xe1mica con datos)."),o.qZA(),o.TgZ(74,"li")(75,"b"),o._uU(76,"Comprar en oferta:"),o.qZA(),o._uU(77," comparas precio y necesidad; si el descuento compensa, compras (an\xe1lisis coste-beneficio)."),o.qZA()()(),o.TgZ(78,"div",24)(79,"h2",25),o._uU(80,"\u{1f517} C\xf3mo se conectan premisas y conclusiones"),o.qZA(),o.TgZ(81,"ul",21)(82,"li"),o._uU(83,"Premisa: \u201cSi llueve, llevar\xe9 paraguas.\u201d"),o.qZA(),o.TgZ(84,"li"),o._uU(85,"Hecho observado: \u201cEst\xe1 lloviendo.\u201d"),o.qZA(),o.TgZ(86,"li"),o._uU(87,"Conclusi\xf3n: \u201cLlevo paraguas.\u201d"),o.qZA()(),o.TgZ(88,"p",26),o._uU(89,"En l\xf3gica: premisas \u2192 reglas (si\u2026 entonces, y, o, no) \u2192 conclusi\xf3n. En programaci\xf3n esto se traduce en condiciones ("),o.TgZ(90,"code"),o._uU(91,"if"),o.qZA(),o._uU(92,"), combinaciones ("),o.TgZ(93,"code"),o._uU(94,"&&"),o.qZA(),o._uU(95,", "),o.TgZ(96,"code"),o._uU(97,"||"),o.qZA(),o._uU(98,") y negaciones ("),o.TgZ(99,"code"),o._uU(100,"!"),o.qZA(),o._uU(101,")."),o.qZA()(),o.TgZ(102,"div",27)(103,"h2",28),o._uU(104,"\u{1f9e0} Modelos mentales y t\xe9cnicas l\xf3gicas \xfatiles"),o.qZA(),o.TgZ(105,"ul",21)(106,"li")(107,"b"),o._uU(108,"Si \u2026 entonces (implicaci\xf3n):"),o.qZA(),o._uU(109," estructura b\xe1sica para decisiones."),o.qZA(),o.TgZ(110,"li")(111,"b"),o._uU(112,"AND (y) / OR (o) / NOT (no):"),o.qZA(),o._uU(113," combinar condiciones."),o.qZA(),o.TgZ(114,"li")(115,"b"),o._uU(116,"\xc1rbol de decisi\xf3n:"),o.qZA(),o._uU(117," representar opciones y sus resultados en ramas."),o.qZA(),o.TgZ(118,"li")(119,"b"),o._uU(120,"Funci\xf3n de utilidad / puntuaci\xf3n:"),o.qZA(),o._uU(121," asignar valor num\xe9rico a cada opci\xf3n y elegir la de mayor puntaje."),o.qZA(),o.TgZ(122,"li")(123,"b"),o._uU(124,"Reglas heur\xedsticas:"),o.qZA(),o._uU(125," atajos para decidir r\xe1pido (p. ej. \u201csi tengo menos de 5 minutos, elijo la opci\xf3n r\xe1pida\u201d)."),o.qZA(),o.TgZ(126,"li")(127,"b"),o._uU(128,"B\xfasqueda y optimizaci\xf3n:"),o.qZA(),o._uU(129," cuando hay muchas opciones, aplicar estrategias (greedy, b\xfasqueda por puntaje, backtracking)."),o.qZA()()(),o.TgZ(130,"div",16)(131,"h2",29),o._uU(132,"\u{1f9fe} Herramientas pr\xe1cticas para evaluar opciones"),o.qZA(),o.TgZ(133,"h3",30),o._uU(134,"1) Matriz de decisi\xf3n ponderada"),o.qZA(),o.TgZ(135,"ol",31)(136,"li"),o._uU(137,"Listar criterios relevantes."),o.qZA(),o.TgZ(138,"li"),o._uU(139,"Asignar peso a cada criterio (suma 1 o 100)."),o.qZA(),o.TgZ(140,"li"),o._uU(141,"Puntuar cada opci\xf3n por criterio (0\u20135)."),o.qZA(),o.TgZ(142,"li"),o._uU(143,"Multiplicar y sumar para obtener la puntuaci\xf3n total."),o.qZA()(),o.TgZ(144,"div",32)(145,"table",33)(146,"thead")(147,"tr",34)(148,"th",35),o._uU(149,"Opci\xf3n"),o.qZA(),o.TgZ(150,"th",36),o._uU(151,"Rapidez (0.4)"),o.qZA(),o.TgZ(152,"th",36),o._uU(153,"Costo (0.3)"),o.qZA(),o.TgZ(154,"th",36),o._uU(155,"Facilidad (0.3)"),o.qZA(),o.TgZ(156,"th",37),o._uU(157,"Score total"),o.qZA()()(),o.TgZ(158,"tbody")(159,"tr",38)(160,"td",39),o._uU(161,"Opci\xf3n A"),o.qZA(),o.TgZ(162,"td",39),o._uU(163,"4 \u2192 1.6"),o.qZA(),o.TgZ(164,"td",39),o._uU(165,"3 \u2192 0.9"),o.qZA(),o.TgZ(166,"td",39),o._uU(167,"5 \u2192 1.5"),o.qZA(),o.TgZ(168,"td",39),o._uU(169,"4.0"),o.qZA()(),o.TgZ(170,"tr",40)(171,"td",39),o._uU(172,"Opci\xf3n B"),o.qZA(),o.TgZ(173,"td",39),o._uU(174,"3 \u2192 1.2"),o.qZA(),o.TgZ(175,"td",39),o._uU(176,"5 \u2192 1.5"),o.qZA(),o.TgZ(177,"td",39),o._uU(178,"2 \u2192 0.6"),o.qZA(),o.TgZ(179,"td",39),o._uU(180,"3.3"),o.qZA()()()()(),o.TgZ(181,"h3",30),o._uU(182,"2) Pros / Cons"),o.qZA(),o.TgZ(183,"p",26),o._uU(184,"Lista simple de ventajas y desventajas; \xfatil para decisiones con pocos criterios."),o.qZA(),o.TgZ(185,"h3",30),o._uU(186,"3) \xc1rbol de decisi\xf3n b\xe1sico"),o.qZA(),o.TgZ(187,"p",26),o._uU(188,"Dibuja nodos: en cada nodo una condici\xf3n; en hojas la consecuencia o recompensa. Muy \xfatil para decisiones secuenciales."),o.qZA(),o.TgZ(189,"h3",30),o._uU(190,"4) Sensitivity / An\xe1lisis de sensibilidad"),o.qZA(),o.TgZ(191,"p",26),o._uU(192,"Modificar pesos o supuestos para ver si la decisi\xf3n se mantiene estable."),o.qZA()(),o.TgZ(193,"div",22)(194,"h2",23),o._uU(195,"\u26a0\ufe0f Sesgos y errores comunes"),o.qZA(),o.TgZ(196,"ul",21)(197,"li")(198,"b"),o._uU(199,"Anclaje:"),o.qZA(),o._uU(200," fijarse en la primera informaci\xf3n recibida."),o.qZA(),o.TgZ(201,"li")(202,"b"),o._uU(203,"Confirmaci\xf3n:"),o.qZA(),o._uU(204," buscar solo datos que confirmen nuestra idea."),o.qZA(),o.TgZ(205,"li")(206,"b"),o._uU(207,"Disponibilidad:"),o.qZA(),o._uU(208," sobrevalorar ejemplos recientes o memorables."),o.qZA(),o.TgZ(209,"li")(210,"b"),o._uU(211,"Exceso de confianza:"),o.qZA(),o._uU(212," subestimar la incertidumbre."),o.qZA()(),o.TgZ(213,"p",26),o._uU(214,"Ense\xf1ar a preguntar: \u201c\xbfQu\xe9 supongo?\u201d y \u201c\xbfQu\xe9 pasa si esa suposici\xf3n falla?\u201d ayuda a mitigarlos."),o.qZA()(),o.TgZ(215,"div",24)(216,"h2",25),o._uU(217,"\u{1f5a5} C\xf3mo mapear todo esto en programaci\xf3n"),o.qZA(),o.TgZ(218,"ul",21)(219,"li")(220,"b"),o._uU(221,"Condicionales ("),o.TgZ(222,"code"),o._uU(223,"if/else"),o.qZA(),o._uU(224,"):"),o.qZA(),o._uU(225," decisiones simples."),o.qZA(),o.TgZ(226,"li")(227,"b"),o._uU(228,"Switch / case:"),o.qZA(),o._uU(229," elegir entre varias alternativas discretas."),o.qZA(),o.TgZ(230,"li")(231,"b"),o._uU(232,"Funciones que devuelven puntajes:"),o.qZA(),o._uU(233," implementar matriz ponderada ("),o.TgZ(234,"code"),o._uU(235,"score(option)"),o.qZA(),o._uU(236,")."),o.qZA(),o.TgZ(237,"li")(238,"b"),o._uU(239,"Estructuras de datos (arrays / objetos):"),o.qZA(),o._uU(240," almacenar opciones, criterios y resultados."),o.qZA(),o.TgZ(241,"li")(242,"b"),o._uU(243,"\xc1rboles (estructuras recursivas):"),o.qZA(),o._uU(244," modelar decisiones secuenciales."),o.qZA(),o.TgZ(245,"li")(246,"b"),o._uU(247,"Simulaci\xf3n / Monte Carlo:"),o.qZA(),o._uU(248," cuando hay incertidumbre usar simulaciones para estimar probabilidades. "),o.qZA()(),o.TgZ(249,"h3",41),o._uU(250,"Pseudoc\xf3digo ejemplo (score):"),o.qZA(),o.TgZ(251,"pre",42)(252,"code"),o._uU(253),o.qZA()()()()()),2&g&&(o.xp6(253),o.AsE("// criterios = ","{"," rapidez:0.4, costo:0.3, facilidad:0.3 ","}","\n// opciones = [A,B,C]\nfor opcion in opciones:\n    score = 0\n    for criterio in criterios:\n        score += puntaje(opcion, criterio) * criterios[criterio]\n    escoger opcion con max(score)\n"))}function Eo(g,x){1&g&&(o.TgZ(0,"section",12)(1,"h1",43),o._uU(2,"Ejemplos"),o.qZA()())}function ot(g,x){1&g&&(o.TgZ(0,"section",12)(1,"h1",43),o._uU(2,"Ejercicios"),o.qZA()())}const Et=function(g){return{"button-with-point":g}};let vo=(()=>{class g{constructor(){this.selectedSection=1}static{this.\u0275fac=function(p){return new(p||g)}}static{this.\u0275cmp=o.Xpm({type:g,selectors:[["app-toma-decisiones"]],decls:23,vars:24,consts:[[1,"text-center","mb-6","mt-6"],[1,"text-3xl","font-bold","text-gray-800","mb-2","drop-shadow-md"],[1,"flex","items-center","justify-center","mb-1"],[1,"h-0.5","bg-gradient-to-r","from-transparent","via-blue-500","to-transparent","w-96","shadow-sm"],[1,"flex","items-center","justify-center"],[1,"h-px","bg-gradient-to-r","from-transparent","via-gray-300","to-transparent","w-64","opacity-60"],[1,"flex","flex-col","items-center","mb-6"],[1,"sticky","top-0","z-20","w-auto","flex","justify-center","bg-transparent","backdrop-blur-md","py-2","rounded-xl"],[1,"flex","gap-72"],[1,"relative","px-4","py-2","rounded-lg","font-semibold","text-gray-700","hover:text-blue-500","transition",3,"ngClass","click"],[1,"flex","flex-col","gap-6","items-center","w-full","px-2","md:px-0"],["class","bg-gray-500/20 backdrop-blur-md p-8 rounded-lg border border-gray-400/30 shadow-lg w-full max-w-7xl mt-2 mb-8",4,"ngIf"],[1,"bg-gray-500/20","backdrop-blur-md","p-8","rounded-lg","border","border-gray-400/30","shadow-lg","w-full","max-w-7xl","mt-2","mb-8"],[1,"flex","flex-col","gap-6","mb-8","justify-start","items-start"],[1,"text-xl","font-bold","text-blue-500","mb-2","flex","items-center","gap-2"],[1,"text-gray-800","ml-8"],[1,"bg-gradient-to-br","from-blue-100","via-blue-50","to-white","border-l-4","border-blue-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"text-lg","font-semibold","text-gray-700","mt-4","mb-2","flex","items-center","gap-2"],[1,"list-disc","pl-6","text-gray-700","mb-2"],[1,"bg-gradient-to-br","from-green-100","via-green-50","to-white","border-l-4","border-green-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"text-xl","font-bold","text-green-600","mb-2","flex","items-center","gap-2"],[1,"list-disc","ml-6","text-gray-800","mb-2"],[1,"bg-gradient-to-br","from-yellow-100","via-yellow-50","to-white","border-l-4","border-yellow-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"text-xl","font-bold","text-yellow-600","mb-2","flex","items-center","gap-2"],[1,"bg-gradient-to-br","from-purple-100","via-purple-50","to-white","border-l-4","border-purple-400","shadow-lg","rounded-xl","p-6","w-full","mt-2","mb-2"],[1,"text-xl","font-bold","text-purple-600","mb-2","flex","items-center","gap-2"],[1,"text-gray-700"],[1,"bg-gradient-to-br","from-pink-100","via-pink-50","to-white","border-l-4","border-pink-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"text-xl","font-bold","text-pink-600","mb-2","flex","items-center","gap-2"],[1,"text-xl","font-bold","text-blue-600","mb-2","flex","items-center","gap-2"],[1,"font-semibold","text-blue-700"],[1,"list-decimal","ml-8","text-gray-700","mb-2"],[1,"overflow-x-auto","mb-4"],[1,"min-w-full","text-sm","text-left","border-separate","border-spacing-0","rounded-xl","shadow-lg","bg-white"],[1,"bg-gradient-to-r","from-blue-500","via-cyan-400","to-green-300"],[1,"py-3","px-6","font-bold","text-white","rounded-tl-xl","text-center"],[1,"py-3","px-6","font-bold","text-white","text-center"],[1,"py-3","px-6","font-bold","text-white","rounded-tr-xl","text-center"],[1,"hover:bg-red-50","transition"],[1,"py-3","px-6","border-b","border-gray-200"],[1,"hover:bg-blue-50","transition"],[1,"font-semibold","text-purple-700"],[1,"bg-gray-900","text-green-200","rounded-lg","p-4","text-sm","overflow-x-auto"],[1,"mt-6"]],template:function(p,d){1&p&&(o.TgZ(0,"div",0)(1,"h1",1),o._uU(2,"\u{1f5c2}\ufe0f Toma de Decisiones y Evaluaci\xf3n de Opciones"),o.qZA(),o.TgZ(3,"div",2),o._UZ(4,"div",3),o.qZA(),o.TgZ(5,"div",4),o._UZ(6,"div",5),o.qZA()(),o.TgZ(7,"div",6)(8,"nav",7)(9,"ul",8)(10,"li")(11,"button",9),o.NdJ("click",function(){return d.selectedSection=1}),o._uU(12," Teor\xeda "),o.qZA()(),o.TgZ(13,"li")(14,"button",9),o.NdJ("click",function(){return d.selectedSection=2}),o._uU(15," Ejemplos "),o.qZA()(),o.TgZ(16,"li")(17,"button",9),o.NdJ("click",function(){return d.selectedSection=3}),o._uU(18," Ejercicios "),o.qZA()()()()(),o.TgZ(19,"div",10),o.YNc(20,K,254,2,"section",11),o.YNc(21,Eo,3,0,"section",11),o.YNc(22,ot,3,0,"section",11),o.qZA()),2&p&&(o.xp6(11),o.ekj("border-b-4",1===d.selectedSection)("border-blue-500",1===d.selectedSection),o.Q6J("ngClass",o.VKq(18,Et,1===d.selectedSection)),o.xp6(3),o.ekj("border-b-4",2===d.selectedSection)("border-blue-500",2===d.selectedSection),o.Q6J("ngClass",o.VKq(20,Et,2===d.selectedSection)),o.xp6(3),o.ekj("border-b-4",3===d.selectedSection)("border-blue-500",3===d.selectedSection),o.Q6J("ngClass",o.VKq(22,Et,3===d.selectedSection)),o.xp6(3),o.Q6J("ngIf",1===d.selectedSection),o.xp6(1),o.Q6J("ngIf",2===d.selectedSection),o.xp6(1),o.Q6J("ngIf",3===d.selectedSection))},dependencies:[Z.mk,Z.O5]})}}return g})();function ze(g,x){1&g&&(o.TgZ(0,"section",12)(1,"div",13)(2,"h2",14),o._uU(3,"\u{1f4cd} \xbfQu\xe9 es el pensamiento l\xf3gico?"),o.qZA(),o.TgZ(4,"p",15),o._uU(5,"El pensamiento l\xf3gico es la habilidad de analizar un problema, dividirlo en partes m\xe1s peque\xf1as y organizarlas para llegar a una soluci\xf3n. En programaci\xf3n, es el proceso mental que usamos para decirle a la computadora qu\xe9 hacer y en qu\xe9 orden hacerlo."),o.qZA(),o.TgZ(6,"div",16)(7,"h3",17),o._uU(8,"\u{1f4e6} Met\xe1fora: El constructor de LEGO"),o.qZA(),o.TgZ(9,"p",18),o._uU(10,"Imagina que quieres construir un castillo con piezas LEGO:"),o.qZA(),o.TgZ(11,"ul",19)(12,"li"),o._uU(13,"Primero revisas las instrucciones (el plan)."),o.qZA(),o.TgZ(14,"li"),o._uU(15,"Luego buscas las piezas necesarias (datos y recursos)."),o.qZA(),o.TgZ(16,"li"),o._uU(17,"Despu\xe9s las unes en el orden correcto (algoritmo)."),o.qZA()(),o.TgZ(18,"p",18),o._uU(19,"Si te saltas un paso o pones una pieza en el lugar equivocado, el castillo no quedar\xe1 como esperas. En programaci\xf3n pasa lo mismo: si no sigues una l\xf3gica clara, el programa no funcionar\xe1 correctamente."),o.qZA()(),o.TgZ(20,"div",20)(21,"h2",21),o._uU(22,"\u{1f504} Pensamiento l\xf3gico y la vida real "),o.qZA(),o.TgZ(23,"ul",22)(24,"li"),o._uU(25,"Si me levanto temprano \u2192 desayuno tranquilo."),o.qZA(),o.TgZ(26,"li"),o._uU(27,"Si no \u2192 desayuno r\xe1pido o no desayuno."),o.qZA(),o.TgZ(28,"li"),o._uU(29,"Si llueve \u2192 llevo paraguas."),o.qZA(),o.TgZ(30,"li"),o._uU(31,"Si no \u2192 salgo sin paraguas."),o.qZA()(),o.TgZ(32,"p",18),o._uU(33,"El pensamiento l\xf3gico es b\xe1sicamente seguir pasos, verificar condiciones y actuar en consecuencia."),o.qZA()(),o.TgZ(34,"div",23)(35,"h2",14),o._uU(36,"\u{1f4dc} Premisas y Conclusiones"),o.qZA(),o.TgZ(37,"h3",24),o._uU(38,"\u{1f9fe} \xbfQu\xe9 es una premisa?"),o.qZA(),o.TgZ(39,"p",18),o._uU(40,"Una premisa es una afirmaci\xf3n o hecho que aceptamos como verdadero y que sirve de base para razonar."),o.qZA(),o.TgZ(41,"p",18),o._uU(42,'Ejemplo: "Si estudio, aprobar\xe9 el examen".'),o._UZ(43,"br"),o._uU(44,"Aqu\xed estamos asumiendo que esta relaci\xf3n es cierta."),o.qZA(),o.TgZ(45,"h3",24),o._uU(46,"\u{1f3c1} \xbfQu\xe9 es una conclusi\xf3n?"),o.qZA(),o.TgZ(47,"p",18),o._uU(48,"Una conclusi\xf3n es el resultado que obtenemos despu\xe9s de analizar una o m\xe1s premisas. "),o.qZA(),o.TgZ(49,"p",18),o._uU(50,"Ejemplo:"),o._UZ(51,"br"),o._uU(52,'Premisa 1: "Si estudio, aprobar\xe9 el examen".'),o._UZ(53,"br"),o._uU(54,'Premisa 2: "Estudi\xe9".'),o._UZ(55,"br"),o._uU(56,'Conclusi\xf3n: "Aprobar\xe9 el examen".'),o.qZA()(),o.TgZ(57,"div",25)(58,"h2",26),o._uU(59,"\u{1f517} C\xf3mo se conectan las premisas y conclusiones"),o.qZA(),o.TgZ(60,"ul",22)(61,"li")(62,"b"),o._uU(63,"SI... ENTONCES (implicaci\xf3n):"),o.qZA(),o._uU(64," Si la condici\xf3n es verdadera, entonces ejecuta una acci\xf3n."),o._UZ(65,"br"),o._uU(66,"Ej: Si llueve, llevo paraguas."),o.qZA(),o.TgZ(67,"li")(68,"b"),o._uU(69,"Y (conjunci\xf3n):"),o.qZA(),o._uU(70," Ambas condiciones deben cumplirse para que algo pase."),o._UZ(71,"br"),o._uU(72,"Ej: Si tengo hambre y hay comida, entonces como."),o.qZA(),o.TgZ(73,"li")(74,"b"),o._uU(75,"O (disyunci\xf3n):"),o.qZA(),o._uU(76," Basta con que una condici\xf3n sea cierta para que algo ocurra."),o._UZ(77,"br"),o._uU(78,"Ej: Si es s\xe1bado o es domingo, descanso."),o.qZA(),o.TgZ(79,"li")(80,"b"),o._uU(81,"NO (negaci\xf3n):"),o.qZA(),o._uU(82," Invierte el valor l\xf3gico de una condici\xf3n."),o._UZ(83,"br"),o._uU(84,"Ej: Si no est\xe1 encendido, enci\xe9ndelo. "),o.qZA()()(),o.TgZ(85,"div",27)(86,"h2",28),o._uU(87,"\u{1f50d} Met\xe1fora: Detectives de la l\xf3gica "),o.qZA(),o.TgZ(88,"ul",22)(89,"li"),o._uU(90,"Las premisas son las pistas que ha encontrado."),o.qZA(),o.TgZ(91,"li"),o._uU(92,"La conclusi\xf3n es el resultado que obtiene al juntar esas pistas."),o.qZA(),o.TgZ(93,"li"),o._uU(94,"Si una pista es falsa, la conclusi\xf3n tambi\xe9n puede fallar."),o.qZA()()(),o.TgZ(95,"div",16)(96,"h2",29),o._uU(97,"\u{1f9e9} Elementos clave del pensamiento l\xf3gico"),o.qZA(),o.TgZ(98,"ul",22)(99,"li")(100,"b"),o._uU(101,"Observaci\xf3n:"),o.qZA(),o._uU(102," entender qu\xe9 est\xe1 pasando o qu\xe9 se necesita."),o.qZA(),o.TgZ(103,"li")(104,"b"),o._uU(105,"An\xe1lisis:"),o.qZA(),o._uU(106," separar el problema en partes peque\xf1as."),o.qZA(),o.TgZ(107,"li")(108,"b"),o._uU(109,"Secuencias:"),o.qZA(),o._uU(110," ordenar las acciones paso a paso."),o.qZA(),o.TgZ(111,"li")(112,"b"),o._uU(113,"Condiciones:"),o.qZA(),o._uU(114," decidir qu\xe9 hacer dependiendo de una situaci\xf3n."),o.qZA(),o.TgZ(115,"li")(116,"b"),o._uU(117,"Repeticiones:"),o.qZA(),o._uU(118," repetir acciones hasta que se cumpla un objetivo."),o.qZA(),o.TgZ(119,"li")(120,"b"),o._uU(121,"Optimizaci\xf3n:"),o.qZA(),o._uU(122," buscar la manera m\xe1s simple y r\xe1pida de resolverlo."),o.qZA()()()()())}function Te(g,x){1&g&&(o.TgZ(0,"section",12)(1,"h1",30),o._uU(2,"Ejemplos"),o.qZA()())}function ro(g,x){1&g&&(o.TgZ(0,"section",12)(1,"h1",30),o._uU(2,"Ejercicios"),o.qZA()())}const lo=function(g){return{"button-with-point":g}};let Mt=(()=>{class g{constructor(){this.selectedSection=1}static{this.\u0275fac=function(p){return new(p||g)}}static{this.\u0275cmp=o.Xpm({type:g,selectors:[["app-pensamiento-logico"]],decls:23,vars:24,consts:[[1,"text-center","mb-6","mt-6"],[1,"text-3xl","font-bold","text-gray-800","mb-2","drop-shadow-md"],[1,"flex","items-center","justify-center","mb-1"],[1,"h-0.5","bg-gradient-to-r","from-transparent","via-blue-500","to-transparent","w-96","shadow-sm"],[1,"flex","items-center","justify-center"],[1,"h-px","bg-gradient-to-r","from-transparent","via-gray-300","to-transparent","w-64","opacity-60"],[1,"flex","flex-col","items-center","mb-6"],[1,"sticky","top-0","z-20","w-auto","flex","justify-center","bg-transparent","backdrop-blur-md","py-2","rounded-xl"],[1,"flex","gap-72"],[1,"relative","px-4","py-2","rounded-lg","font-semibold","text-gray-700","hover:text-[#facc15]","transition",3,"ngClass","click"],[1,"flex","flex-col","gap-6","items-center","w-full","px-2","md:px-0"],["class","bg-gray-500/20 backdrop-blur-md p-8 rounded-lg border border-gray-400/30 shadow-lg w-full max-w-7xl mt-2 mb-8",4,"ngIf"],[1,"bg-gray-500/20","backdrop-blur-md","p-8","rounded-lg","border","border-gray-400/30","shadow-lg","w-full","max-w-7xl","mt-2","mb-8"],[1,"flex","flex-col","gap-6","mb-8","justify-start","items-start"],[1,"text-xl","font-bold","text-yellow-600","mb-2","flex","items-center","gap-2"],[1,"text-gray-800","ml-8"],[1,"bg-gradient-to-br","from-blue-100","via-blue-50","to-white","border-l-4","border-blue-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"text-lg","font-semibold","text-gray-700","mt-4","mb-2","flex","items-center","gap-2"],[1,"text-gray-700"],[1,"list-disc","pl-6","text-gray-700","mb-2"],[1,"bg-gradient-to-br","from-green-100","via-green-50","to-white","border-l-4","border-green-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"text-xl","font-bold","text-green-600","mb-2","flex","items-center","gap-2"],[1,"list-disc","ml-6","text-gray-800","mb-2"],[1,"bg-gradient-to-br","from-yellow-100","via-yellow-50","to-white","border-l-4","border-yellow-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"font-semibold","text-yellow-700"],[1,"bg-gradient-to-br","from-purple-100","via-purple-50","to-white","border-l-4","border-purple-400","shadow-lg","rounded-xl","p-6","w-full","mt-2","mb-2"],[1,"text-xl","font-bold","text-purple-600","mb-2","flex","items-center","gap-2"],[1,"bg-gradient-to-br","from-pink-100","via-pink-50","to-white","border-l-4","border-pink-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"text-xl","font-bold","text-pink-600","mb-2","flex","items-center","gap-2"],[1,"text-xl","font-bold","text-blue-600","mb-2","flex","items-center","gap-2"],[1,"mt-6"]],template:function(p,d){1&p&&(o.TgZ(0,"div",0)(1,"h1",1),o._uU(2,"\u{1f4a1} Pensamiento L\xf3gico en Programaci\xf3n"),o.qZA(),o.TgZ(3,"div",2),o._UZ(4,"div",3),o.qZA(),o.TgZ(5,"div",4),o._UZ(6,"div",5),o.qZA()(),o.TgZ(7,"div",6)(8,"nav",7)(9,"ul",8)(10,"li")(11,"button",9),o.NdJ("click",function(){return d.selectedSection=1}),o._uU(12," Teor\xeda "),o.qZA()(),o.TgZ(13,"li")(14,"button",9),o.NdJ("click",function(){return d.selectedSection=2}),o._uU(15," Ejemplos "),o.qZA()(),o.TgZ(16,"li")(17,"button",9),o.NdJ("click",function(){return d.selectedSection=3}),o._uU(18," Ejercicios "),o.qZA()()()()(),o.TgZ(19,"div",10),o.YNc(20,ze,123,0,"section",11),o.YNc(21,Te,3,0,"section",11),o.YNc(22,ro,3,0,"section",11),o.qZA()),2&p&&(o.xp6(11),o.ekj("border-b-4",1===d.selectedSection)("border-blue-500",1===d.selectedSection),o.Q6J("ngClass",o.VKq(18,lo,1===d.selectedSection)),o.xp6(3),o.ekj("border-b-4",2===d.selectedSection)("border-blue-500",2===d.selectedSection),o.Q6J("ngClass",o.VKq(20,lo,2===d.selectedSection)),o.xp6(3),o.ekj("border-b-4",3===d.selectedSection)("border-blue-500",3===d.selectedSection),o.Q6J("ngClass",o.VKq(22,lo,3===d.selectedSection)),o.xp6(3),o.Q6J("ngIf",1===d.selectedSection),o.xp6(1),o.Q6J("ngIf",2===d.selectedSection),o.xp6(1),o.Q6J("ngIf",3===d.selectedSection))},dependencies:[Z.mk,Z.O5],styles:[".button-with-point[_ngcontent-%COMP%]{border-bottom-width:4px!important;border-bottom-color:#facc15!important}"]})}}return g})();var vt=le(9862);function Nt(g,x){1&g&&(o.O4$(),o._UZ(0,"path",32))}function Zi(g,x){1&g&&(o.O4$(),o._UZ(0,"path",33))}function Us(g,x){1&g&&(o.O4$(),o._UZ(0,"path",34))}function Hs(g,x){if(1&g){const l=o.EpF();o.TgZ(0,"div",35),o.NdJ("dragstart",function(d){const O=o.CHM(l).$implicit,q=o.oxw(2);return o.KtG(q.onDragStart(d,O))})("drop",function(d){o.CHM(l);const v=o.oxw(2);return o.KtG(v.onDropToDrag(d))})("dragover",function(d){return d.preventDefault()}),o._uU(1),o.qZA()}if(2&g){const l=x.$implicit;o.xp6(1),o.hij(" ",l.text," ")}}function Vs(g,x){1&g&&(o.ynx(0),o.O4$(),o.TgZ(1,"svg",40),o._UZ(2,"path",41),o.qZA(),o.BQk())}function ii(g,x){if(1&g&&(o.ynx(0),o.TgZ(1,"div",42),o._uU(2),o.qZA(),o.BQk()),2&g){const l=o.oxw().$implicit;o.xp6(2),o.hij(" ",(null==l?null:l.text)||l," ")}}const Wi=function(g,x){return{width:g,height:x,display:"flex",alignItems:"center",justifyContent:"center"}};function si(g,x){if(1&g){const l=o.EpF();o.TgZ(0,"div",38),o.NdJ("drop",function(d){const O=o.CHM(l).index,q=o.oxw().index,ce=o.oxw(2);return o.KtG(ce.onDrop(d,q,O))})("dragover",function(d){return d.preventDefault()})("dragstart",function(d){const v=o.CHM(l),O=v.$implicit,q=v.index,ce=o.oxw().index,Ct=o.oxw(2);return o.KtG(O?Ct.onDragStart(d,O,ce,q):null)}),o.YNc(1,Vs,3,0,"ng-container",39),o.YNc(2,ii,3,1,"ng-container",39),o.qZA()}if(2&g){const l=x.$implicit,p=o.oxw(3);o.Q6J("draggable",!!l)("ngStyle",o.WLB(4,Wi,4===p.n?"113px":"161px",4===p.n?"113px":"161px")),o.xp6(1),o.Q6J("ngIf",!l),o.xp6(1),o.Q6J("ngIf",l)}}function Gs(g,x){if(1&g&&(o.TgZ(0,"div")(1,"div",36),o.YNc(2,si,3,7,"div",37),o.qZA()()),2&g){const l=x.$implicit;o.xp6(2),o.Q6J("ngForOf",l)}}const Zs=function(g){return{"grid-template-columns":g,"justify-content":"center",margin:"0 auto",width:"max-content"}};function Ws(g,x){if(1&g){const l=o.EpF();o.TgZ(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"div",6),o.O4$(),o.TgZ(6,"svg",7),o.YNc(7,Nt,1,0,"path",8),o.YNc(8,Zi,1,0,"path",9),o.YNc(9,Us,1,0,"path",10),o.qZA()(),o.kcU(),o.TgZ(10,"div",11),o._uU(11),o.qZA()(),o.TgZ(12,"h2",12),o._uU(13),o.qZA()(),o.TgZ(14,"p",13),o._uU(15),o.qZA(),o.TgZ(16,"div",14)(17,"h3",15),o._uU(18,"\u{1f4cb} Instrucciones:"),o.qZA(),o.TgZ(19,"p",16),o._uU(20),o.qZA()(),o._UZ(21,"div",17),o.TgZ(22,"div",18)(23,"button",19),o.NdJ("click",function(){o.CHM(l);const d=o.oxw();return o.KtG(d.onPreviousExercise())}),o.O4$(),o.TgZ(24,"svg",7),o._UZ(25,"path",20),o.qZA()(),o.kcU(),o.TgZ(26,"span",21),o._uU(27),o.qZA(),o.TgZ(28,"button",22),o.NdJ("click",function(){o.CHM(l);const d=o.oxw();return o.KtG(d.onNextExercise())}),o.O4$(),o.TgZ(29,"svg",7),o._UZ(30,"path",23),o.qZA()()()()(),o.kcU(),o.TgZ(31,"div",24)(32,"div",25)(33,"h3",26)(34,"b"),o._uU(35,"Tomar Bloques"),o.qZA()(),o.TgZ(36,"div",27),o.YNc(37,Hs,2,1,"div",28),o.qZA()(),o.TgZ(38,"div",29)(39,"h3",26)(40,"b"),o._uU(41,"Soltar Bloques"),o.qZA()(),o.TgZ(42,"div",30),o.YNc(43,Gs,3,1,"div",31),o.qZA()()()()}if(2&g){const l=o.oxw();o.xp6(5),o.Udp("background-color",l.getDifficultyColor(l.currentDifficulty))("border-color",l.getDifficultyBorderColor(l.currentDifficulty)),o.xp6(2),o.Q6J("ngIf","easy"===l.currentDifficulty),o.xp6(1),o.Q6J("ngIf","medium"===l.currentDifficulty),o.xp6(1),o.Q6J("ngIf","hard"===l.currentDifficulty),o.xp6(2),o.hij(" ",l.getDifficultyText(l.currentDifficulty)," "),o.xp6(2),o.Oqu(l.currentTitle),o.xp6(2),o.Oqu(l.currentDescription),o.xp6(5),o.Oqu(l.currentInstructions),o.xp6(3),o.Udp("background-color",l.canGoPrevious?"#f3ae22":"")("border-color",l.canGoPrevious?"#d18c00":""),o.ekj("opacity-50",!l.canGoPrevious)("cursor-not-allowed",!l.canGoPrevious),o.Q6J("disabled",!l.canGoPrevious),o.xp6(4),o.AsE(" ",l.currentExampleIndex+1," de ",l.examples.length," "),o.xp6(1),o.ekj("opacity-50",!l.canGoNext)("cursor-not-allowed",!l.canGoNext),o.Q6J("disabled",!l.canGoNext),o.xp6(9),o.Q6J("ngForOf",l.blocks),o.xp6(5),o.Q6J("ngStyle",o.VKq(30,Zs,"repeat("+l.n+", 1fr)")),o.xp6(1),o.Q6J("ngForOf",l.dropMatrix)}}let yo=(()=>{class g{constructor(){this.n=3,this.description="",this.blocks=[],this.currentExampleIndex=0,this.examples=[],this.validationResult="",this.previousExample=new o.vpe,this.nextExample=new o.vpe,this.validatePuzzle=new o.vpe,this.dropMatrix=[],this.dragSource=null}ngOnInit(){let p=Math.sqrt(this.currentExample?.answer?.length||9);this.n=Number.isInteger(p)&&p>1?p:3,this.dropMatrix=Array.from({length:this.n},()=>Array(this.n).fill(null)),this.blocks=this.blocks&&this.blocks.length>0?[...this.blocks]:Array.from({length:this.n*this.n},(d,v)=>({id:v+1,text:`Bloque ${v+1}`}))}onDrop(l,p,d){const v=l.dataTransfer.getData("text");if(this.dragSource&&"matrix"===this.dragSource.type){const O=this.dragSource.row,q=this.dragSource.col,ce=this.dropMatrix[p][d];this.dropMatrix[p][d]=this.dropMatrix[O][q],this.dropMatrix[O][q]=ce}else if(this.dragSource&&"block"===this.dragSource.type){const O=this.blocks.find(q=>q.text===v);if(O)if(this.dropMatrix[p][d]){const q=this.dropMatrix[p][d];this.dropMatrix[p][d]=O,this.blocks=this.blocks.filter(ce=>ce.text!==v),this.blocks.push(q)}else this.dropMatrix[p][d]=O,this.blocks=this.blocks.filter(q=>q.text!==v)}this.dragSource=null}onDropToDrag(l){const p=l.dataTransfer.getData("text");for(let d=0;d<this.n;d++)for(let v=0;v<this.n;v++){const O=this.dropMatrix[d][v];if(O&&O.text===p){this.blocks.push(O),this.dropMatrix[d][v]=null;break}}this.dragSource=null}onDragStart(l,p,d,v){l.dataTransfer.setData("text",p.text),this.dragSource=void 0!==d&&void 0!==v?{type:"matrix",row:d,col:v,value:p.text}:{type:"block",value:p.text}}onPreviousExercise(){this.previousExample.emit()}onNextExercise(){this.nextExample.emit()}onValidatePuzzle(){this.validatePuzzle.emit()}get canGoPrevious(){return this.currentExampleIndex>0}get canGoNext(){return this.currentExampleIndex<this.examples.length-1}get currentTitle(){return this.currentExample?.title||""}get currentDescription(){return this.currentExample?.description||""}get currentInstructions(){return this.currentExample?.instructions||""}get currentDifficulty(){return this.currentExample?.difficulty||"easy"}getDifficultyColor(l){return"easy"===l?"#4ade80":"medium"===l?"#fbbf24":"hard"===l?"#ef4444":"#a3a3a3"}getDifficultyBorderColor(l){return"easy"===l?"#22c55e":"medium"===l?"#d97706":"hard"===l?"#b91c1c":"#737373"}getDifficultyText(l){return"easy"===l?"F\xe1cil":"medium"===l?"Intermedio":"hard"===l?"Dif\xedcil":"Desconocido"}static{this.\u0275fac=function(p){return new(p||g)}}static{this.\u0275cmp=o.Xpm({type:g,selectors:[["app-puzzle"]],inputs:{n:"n",description:"description",blocks:"blocks",currentExample:"currentExample",currentExampleIndex:"currentExampleIndex",examples:"examples",validationResult:"validationResult"},outputs:{previousExample:"previousExample",nextExample:"nextExample",validatePuzzle:"validatePuzzle"},decls:1,vars:1,consts:[["class","w-full",4,"ngIf"],[1,"w-full"],[1,"w-full","flex","flex-col","items-center","mt-2"],[1,"px-4","py-3","w-full","max-w-xl"],[1,"flex","items-center","space-x-3","mb-1"],[1,"relative","group"],[1,"w-8","h-8","text-white","rounded-full","shadow-lg","flex","items-center","justify-center","border-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 10V3L4 14h7v7l9-11h-7z",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17.657 18.657A8 8 0 016.343 7.343S7 9 9 10c0-2 .5-5 2.986-7C14 5 16.09 5.777 17.656 7.343A7.975 7.975 0 0120 13a7.975 7.975 0 01-2.343 5.657z",4,"ngIf"],[1,"absolute","left-1/2","transform","-translate-x-1/2","-top-8","bg-gray-800","text-white","text-xs","rounded","py-1","px-2","opacity-0","group-hover:opacity-100","transition-opacity","duration-200","whitespace-nowrap","z-10"],[1,"text-xl","font-bold","text-gray-800"],[1,"text-gray-600","text-sm","mb-2","text-justify"],[1,"bg-blue-50","border-l-4","border-blue-400","p-2","rounded-r-lg","mb-4"],[1,"font-semibold","text-blue-800","mb-1","text-sm"],[1,"text-blue-700","text-sm","text-justify"],[1,"border-t","border-gray-200","w-full"],[1,"flex","justify-between","items-center","pt-4"],[1,"w-10","h-10","text-white","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border-2","disabled:bg-gray-400","disabled:border-gray-300","disabled:hover:bg-gray-400",3,"disabled","click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[1,"text-sm","text-green-600","font-bold"],[1,"w-10","h-10","bg-blue-600","hover:bg-blue-700","text-white","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border-2","border-blue-800","disabled:bg-gray-400","disabled:border-gray-300","disabled:hover:bg-gray-400",3,"disabled","click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],[1,"flex","flex-row","gap-8","items-start","w-full","mb-6"],[1,"drag-box","w-1/2"],[1,"mb-2","text-center"],[1,"blocks","grid","grid-cols-4","gap-2",2,"display","grid","grid-template-columns","repeat(4, 1fr)","justify-content","center","width","100%","max-width","460px","margin","0 auto"],["class","block","draggable","true","style","width:110px;height:100px;display:flex;align-items:center;justify-content:center;text-align:center;font-size:0.85rem;color:#333;font-weight:500;overflow-wrap:break-word;word-break:break-word;white-space:pre-line;line-height:1.1;padding:0;",3,"dragstart","drop","dragover",4,"ngFor","ngForOf"],[1,"drop-box","w-1/2"],[1,"matrix","mt-[1002px]","grid","gap-x-2",3,"ngStyle"],[4,"ngFor","ngForOf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 10V3L4 14h7v7l9-11h-7z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17.657 18.657A8 8 0 016.343 7.343S7 9 9 10c0-2 .5-5 2.986-7C14 5 16.09 5.777 17.656 7.343A7.975 7.975 0 0120 13a7.975 7.975 0 01-2.343 5.657z"],["draggable","true",1,"block",2,"width","110px","height","100px","display","flex","align-items","center","justify-content","center","text-align","center","font-size","0.85rem","color","#333","font-weight","500","overflow-wrap","break-word","word-break","break-word","white-space","pre-line","line-height","1.1","padding","0",3,"dragstart","drop","dragover"],[1,"flex","flex-row",2,"gap","8px","margin-bottom","0"],["class","cell",3,"draggable","ngStyle","drop","dragover","dragstart",4,"ngFor","ngForOf"],[1,"cell",3,"draggable","ngStyle","drop","dragover","dragstart"],[4,"ngIf"],["width","80","height","80","viewBox","0 0 80 80"],["d","M7,7 Q7,40 40,40 Q73,40 73,7 Q40,7 40,40 Q40,73 7,73 Q7,40 40,40 Q73,40 73,73 Q40,73 40,40 Q7,40 7,7 Z","fill","#fafafa","stroke","#90caf9","stroke-width","3"],[2,"width","80px","height","80px","display","flex","align-items","center","justify-content","center","text-align","center","font-size","0.95rem","color","#333","padding","4px","overflow-wrap","break-word","word-break","break-word"]],template:function(p,d){1&p&&o.YNc(0,Ws,44,32,"div",0),2&p&&o.Q6J("ngIf",d.currentExample)},dependencies:[Z.sg,Z.O5,Z.PC],styles:[".puzzle-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:1rem}.flex-row-box[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:flex-start;gap:3rem;width:100%;justify-content:center}.drag-box[_ngcontent-%COMP%]{min-width:180px;background:#f5f5f5;border-radius:8px;box-shadow:0 2px 8px #0001;padding:1rem}.drop-box[_ngcontent-%COMP%]{background:#f5f5f5;border-radius:8px;box-shadow:0 2px 8px #0001;padding:1rem}.blocks[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.75rem}.block[_ngcontent-%COMP%]{background:#e0e0e0;border:2px solid #bdbdbd;padding:1.2rem 2.5rem;border-radius:10px;cursor:grab;font-size:2rem}.matrix[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem}.row[_ngcontent-%COMP%]{display:flex;gap:2rem}.cell[_ngcontent-%COMP%]{width:160px;height:160px;background:#fafafa;border:4px dashed #90caf9;display:flex;align-items:center;justify-content:center;border-radius:16px;font-size:2.2rem;transition:background .2s}.cell[_ngcontent-%COMP%]:hover{background:#e3f2fd}.controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1.5rem;margin-top:2rem}.description[_ngcontent-%COMP%]{font-weight:700;font-size:1.1rem}"]})}}return g})();const ni=["puzzleRef"];function qs(g,x){1&g&&(o.TgZ(0,"section",12)(1,"div",13)(2,"h2",14),o._uU(3,"\u{1f393} \xbfQu\xe9 es la Abstracci\xf3n?"),o.qZA(),o.TgZ(4,"p",15),o._uU(5,"La abstracci\xf3n es el proceso de enfocarse en los aspectos m\xe1s importantes de un problema, ignorando todo lo que no es esencial para resolverlo."),o.qZA(),o.TgZ(6,"div",16)(7,"h3",17),o._uU(8,"\u{1f9e9} Explicaci\xf3n:"),o.qZA(),o.TgZ(9,"p",18),o._uU(10,"Imagina que explicas c\xf3mo llegar a tu casa: das solo los pasos clave y eliminas detalles innecesarios. As\xed aplicas abstracci\xf3n, qued\xe1ndote con lo esencial para no perderse."),o.qZA(),o.TgZ(11,"h3",17),o._uU(12,"\u{1f3e1} Ejemplo cotidiano:"),o.qZA(),o.TgZ(13,"p",18),o._uU(14,"Al pensar en \u201cpreparar desayuno\u201d, tu mente abstrae y simplifica la acci\xf3n en pasos importantes, sin cada movimiento exacto."),o.qZA()(),o.TgZ(15,"div",19)(16,"h2",20),o._uU(17,"\u{1f6e0} \xbfQu\xe9 es la Simplificaci\xf3n?"),o.qZA(),o.TgZ(18,"p",21),o._uU(19,"Simplificaci\xf3n es organizar lo esencial en estructuras claras, reducir la complejidad y hacerlo m\xe1s f\xe1cil de comprender o resolver."),o.qZA(),o.TgZ(20,"h3",17),o._uU(21,"\u{1f50e} Explicaci\xf3n:"),o.qZA(),o.TgZ(22,"p",18),o._uU(23,"Si tienes muchas opciones para preparar el desayuno y lo haces todo a la vez, te enredas. Pero si lo simplificas en una secuencia ordenada, es m\xe1s f\xe1cil y menos propenso a errores."),o.qZA(),o.TgZ(24,"h3",17),o._uU(25,"\u{1f4dd} Ejemplo cotidiano:"),o.qZA(),o.TgZ(26,"p",18),o._uU(27,"Hacer una lista de tareas es simplificar tu d\xeda: organizas qu\xe9 hacer, en qu\xe9 orden y con qu\xe9 prioridad."),o.qZA()(),o.TgZ(28,"div",22)(29,"h2",23),o._uU(30,"\u{1f9e0} \xbfPor qu\xe9 son importantes en programaci\xf3n?"),o.qZA(),o.TgZ(31,"ul",24)(32,"li"),o._uU(33,"Permiten enfocarse en lo que realmente importa."),o.qZA(),o.TgZ(34,"li"),o._uU(35,"Ayudan a dividir tareas complejas en pasos manejables."),o.qZA(),o.TgZ(36,"li"),o._uU(37,"El c\xf3digo es m\xe1s limpio, claro y reutilizable."),o.qZA()(),o.TgZ(38,"p",18),o._uU(39,"En programaci\xf3n, abstraer y simplificar hace que los problemas grandes sean m\xe1s f\xe1ciles de entender, resolver y mantener."),o.qZA()()(),o.TgZ(40,"div",25)(41,"h2",26),o._uU(42,"\u2753 Preguntas frecuentes y sus respuestas"),o.qZA(),o.TgZ(43,"div",27)(44,"div",28)(45,"span",29),o._uU(46,"\u{1f914} \xbfLa abstracci\xf3n significa ignorar cosas?"),o.qZA(),o._UZ(47,"br"),o.TgZ(48,"span",18),o._uU(49,"S\xed, pero solo las cosas que no son necesarias para el problema que est\xe1s resolviendo. No se trata de ser descuidado, sino de ser eficiente."),o._UZ(50,"br"),o._uU(51," Si est\xe1s programando un bot\xf3n para encender una luz, no necesitas saber el color del bot\xf3n, sino si fue presionado o no."),o._UZ(52,"br")(53,"br"),o._uU(54," Abstraer es priorizar lo esencial y dejar de lado lo que no aporta a la soluci\xf3n. As\xed tomas decisiones m\xe1s claras y efectivas, tanto en programaci\xf3n como en la vida diaria."),o.qZA()(),o.TgZ(55,"div",30)(56,"span",29),o._uU(57,"\u{1f914} \xbfSimplificar es lo mismo que hacer algo m\xe1s f\xe1cil?"),o.qZA(),o._UZ(58,"br"),o.TgZ(59,"span",18),o._uU(60,"Casi. Simplificar no significa que el problema en s\xed sea f\xe1cil, sino que lo haces m\xe1s claro y estructurado, para poder resolverlo paso a paso."),o._UZ(61,"br"),o._uU(62," Por ejemplo, construir una casa es complejo, pero si lo divides en planos, cimientos, paredes y techos, puedes trabajar por fases. Eso es simplificaci\xf3n."),o._UZ(63,"br")(64,"br"),o._uU(65," Simplificar es dividir lo complejo en partes manejables, para avanzar sin sentirse abrumado y evitar errores innecesarios."),o.qZA()(),o.TgZ(66,"div",28)(67,"span",29),o._uU(68,"\u{1f914} \xbfPuedo aplicar estos conceptos en mi vida diaria?"),o.qZA(),o._UZ(69,"br"),o.TgZ(70,"span",18),o._uU(71,"\xa1Absolutamente!"),o._UZ(72,"br"),o._uU(73," Cada vez que haces una lista de mercado, organizas tu rutina o das una explicaci\xf3n breve y clara a alguien, est\xe1s abstraendo y simplificando."),o._UZ(74,"br"),o._uU(75," Al contar una historia a un ni\xf1o, no mencionas todos los detalles ni usas t\xe9rminos complejos. Usas solo lo necesario para que entienda y se mantenga interesado."),o._UZ(76,"br")(77,"br"),o._uU(78," Estos conceptos te ayudan a organizar mejor tus tareas y comunicarte de forma m\xe1s clara en cualquier situaci\xf3n cotidiana."),o.qZA()(),o.TgZ(79,"div",30)(80,"span",29),o._uU(81,"\u{1f914} \xbfQu\xe9 pasa si abstraigo o simplifico demasiado?"),o.qZA(),o._UZ(82,"br"),o.TgZ(83,"span",18),o._uU(84,"Si abstraes o simplificas en exceso, puedes perder informaci\xf3n importante que podr\xeda ser clave para resolver el problema correctamente. El reto est\xe1 en encontrar el equilibrio: eliminar lo innecesario, pero conservar lo esencial. En programaci\xf3n, abstraer demasiado puede hacer que el c\xf3digo sea dif\xedcil de entender o mantener; simplificar demasiado puede hacer que se pierdan funcionalidades importantes. Por eso, siempre revisa que lo que eliminas no sea fundamental para tu objetivo."),o.qZA()(),o.TgZ(85,"div",28)(86,"span",29),o._uU(87,"\u{1f914} \xbfC\xf3mo s\xe9 si estoy abstraiendo o simplificando correctamente?"),o.qZA(),o._UZ(88,"br"),o.TgZ(89,"span",18),o._uU(90,"La mejor se\xf1al es que puedes explicar el problema o la soluci\xf3n de forma clara y breve, y que cualquier persona pueda entender los pasos principales sin perderse en detalles. Si al aplicar tu abstracci\xf3n o simplificaci\xf3n, el resultado sigue siendo \xfatil, funcional y f\xe1cil de seguir, vas por buen camino. Si notas que surgen dudas, confusiones o que falta informaci\xf3n esencial, es momento de revisar y ajustar tu enfoque. Recuerda: la claridad y la utilidad son tus mejores indicadores."),o.qZA()()()(),o.TgZ(91,"h2",31),o._uU(92,"\u{1f9f0} Comparaciones Cotidianas"),o.qZA(),o.TgZ(93,"div",32)(94,"table",33)(95,"thead")(96,"tr",34)(97,"th",35),o._uU(98,"Situaci\xf3n Real"),o.qZA(),o.TgZ(99,"th",36),o._uU(100,"Abstracci\xf3n"),o.qZA(),o.TgZ(101,"th",37),o._uU(102,"Simplificaci\xf3n"),o.qZA()()(),o.TgZ(103,"tbody")(104,"tr",38)(105,"td",39),o._uU(106,"Preparar una maleta"),o.qZA(),o.TgZ(107,"td",39),o._uU(108,"Llevar solo lo necesario (ropa, documentos)"),o.qZA(),o.TgZ(109,"td",39),o._uU(110,"Doblar y acomodar para que todo quepa"),o.qZA()(),o.TgZ(111,"tr",40)(112,"td",39),o._uU(113,"Contar c\xf3mo llegar a un lugar"),o.qZA(),o.TgZ(114,"td",39),o._uU(115,"Dar solo los pasos relevantes"),o.qZA(),o.TgZ(116,"td",39),o._uU(117,"Ordenar las instrucciones en la mejor secuencia"),o.qZA()(),o.TgZ(118,"tr",41)(119,"td",39),o._uU(120,"Ense\xf1ar a usar una app"),o.qZA(),o.TgZ(121,"td",39),o._uU(122,"Explicar solo las funciones b\xe1sicas al inicio"),o.qZA(),o.TgZ(123,"td",39),o._uU(124,"Mostrar una pantalla con pocas opciones para no abrumar"),o.qZA()(),o.TgZ(125,"tr",42)(126,"td",39),o._uU(127,"Cocinar una receta"),o.qZA(),o.TgZ(128,"td",39),o._uU(129,"Usar solo ingredientes clave"),o.qZA(),o.TgZ(130,"td",39),o._uU(131,"Organizar los pasos para no mezclar todo sin orden"),o.qZA()(),o.TgZ(132,"tr",43)(133,"td",44),o._uU(134,"Resolver un problema en grupo"),o.qZA(),o.TgZ(135,"td",44),o._uU(136,"Identificar el problema central"),o.qZA(),o.TgZ(137,"td",44),o._uU(138,"Asignar tareas espec\xedficas a cada miembro"),o.qZA()()()()(),o.TgZ(139,"div",45)(140,"h2",46),o._uU(141,"\u2728 Frases clave para recordar"),o.qZA(),o.TgZ(142,"ul",47)(143,"li"),o._uU(144,'"No todo lo que ves es importante. Lo importante es lo que te acerca a la soluci\xf3n."'),o.qZA(),o.TgZ(145,"li"),o._uU(146,'"Si puedes explicarlo con menos pasos, lo est\xe1s entendiendo mejor."'),o.qZA(),o.TgZ(147,"li"),o._uU(148,'"La abstracci\xf3n te da claridad. La simplificaci\xf3n te da control."'),o.qZA()()()())}function zs(g,x){if(1&g){const l=o.EpF();o.TgZ(0,"section",12)(1,"h1",48),o._uU(2,"ejemplos"),o.qZA(),o.TgZ(3,"app-puzzle",49,50),o.NdJ("previousExample",function(){o.CHM(l);const d=o.oxw();return o.KtG(d.previousExample())})("nextExample",function(){o.CHM(l);const d=o.oxw();return o.KtG(d.nextExample())})("validatePuzzle",function(){o.CHM(l);const d=o.oxw();return o.KtG(d.validatePuzzle())}),o.qZA()()}if(2&g){const l=o.oxw();o.xp6(3),o.Q6J("n",3)("description","Resuelve el rompecabezas colocando los bloques en la matriz.")("blocks",l.currentBlocks)("currentExample",l.currentExample)("currentExampleIndex",l.currentExampleIndex)("examples",l.examples)("validationResult",l.validationResult)}}function js(g,x){if(1&g){const l=o.EpF();o.TgZ(0,"section",12)(1,"h1",48),o._uU(2,"Ejercicios Blockly"),o.qZA(),o.TgZ(3,"app-puzzle",49,50),o.NdJ("previousExample",function(){o.CHM(l);const d=o.oxw();return o.KtG(d.previousPuzzle())})("nextExample",function(){o.CHM(l);const d=o.oxw();return o.KtG(d.nextPuzzle())})("validatePuzzle",function(){o.CHM(l);const d=o.oxw();return o.KtG(d.validatePuzzle())}),o.qZA()()}if(2&g){const l=o.oxw();o.xp6(3),o.Q6J("n",16===(null==l.currentBlockly||null==l.currentBlockly.answer?null:l.currentBlockly.answer.length)?4:3)("description",null==l.currentBlockly?null:l.currentBlockly.description)("blocks",l.blocklyBlocks)("currentExample",l.currentBlockly)("currentExampleIndex",l.currentBlocklyIndex)("examples",l.blocklyExercises)("validationResult",l.validationResult)}}const Co=function(g){return{"button-with-point":g}};let Xs=(()=>{class g{get canGoPreviousPuzzle(){return this.currentBlocklyIndex>0}get canGoNextPuzzle(){return this.currentBlocklyIndex<this.blocklyExercises.length-1}previousPuzzle(){this.currentBlocklyIndex>0&&(this.currentBlocklyIndex--,this.currentBlockly=this.blocklyExercises[this.currentBlocklyIndex],this.resetPuzzle(),this.validationResult="")}nextPuzzle(){this.currentBlocklyIndex<this.blocklyExercises.length-1&&(this.currentBlocklyIndex++,this.currentBlockly=this.blocklyExercises[this.currentBlocklyIndex],this.resetPuzzle(),this.validationResult="")}get puzzleBlocks(){return this.currentBlockly?.blocks||[]}get puzzleAnswer(){return this.currentBlockly?.answer||[]}validatePuzzle(){if(!this.puzzleComponent)return;const l=this.puzzleComponent.dropMatrix.flat().filter(v=>null!==v).map(v=>v.text),p=this.puzzleAnswer.map(v=>v.text),d=l.length===p.length&&l.every((v,O)=>v===p[O]);this.validationResult=d?"\xa1Correcto!":"Incorrecto, revisa el orden y los bloques."}constructor(l){this.http=l,this.blocklyExercises=[],this.currentBlocklyIndex=0,this.currentBlockly=null,this.selectedSection=1,this.examples=[],this.currentExampleIndex=0,this.currentExample=null,this.validationResult=""}ngOnInit(){this.loadExamples(),this.loadBlocklyExercises()}loadBlocklyExercises(){this.http.get("assets/jsons-base/blockly-exercises.json").subscribe({next:l=>{this.blocklyExercises=l.abstraccion.exercises||[],this.currentBlockly=this.blocklyExercises[0]||null,this.currentBlocklyIndex=0,console.log("Blockly Abstracci\xf3n loaded:",this.blocklyExercises.length)},error:l=>{console.error("Error cargando ejercicios blockly:",l)}})}previousBlockly(){this.currentBlocklyIndex>0&&(this.currentBlocklyIndex--,this.currentBlockly=this.blocklyExercises[this.currentBlocklyIndex],this.resetPuzzle(),this.validationResult="")}nextBlockly(){this.currentBlocklyIndex<this.blocklyExercises.length-1&&(this.currentBlocklyIndex++,this.currentBlockly=this.blocklyExercises[this.currentBlocklyIndex],this.resetPuzzle(),this.validationResult="")}get canGoPreviousBlockly(){return this.currentBlocklyIndex>0}get canGoNextBlockly(){return this.currentBlocklyIndex<this.blocklyExercises.length-1}get blocklyBlocks(){return this.currentBlockly?.blocks||[]}get blocklyAnswer(){return this.currentBlockly?.answer||[]}loadExamples(){this.http.get("assets/jsons-base/modulos.json").subscribe({next:l=>{this.examples=l.abstraccion.examples,this.currentExample=this.examples[0],console.log("Abstracci\xf3n examples loaded:",this.examples.length)},error:l=>{console.error("Error cargando ejemplos de abstracci\xf3n:",l)}})}previousExample(){this.currentExampleIndex>0&&(this.currentExampleIndex--,this.currentExample=this.examples[this.currentExampleIndex],this.resetPuzzle(),this.validationResult="")}nextExample(){this.currentExampleIndex<this.examples.length-1&&(this.currentExampleIndex++,this.currentExample=this.examples[this.currentExampleIndex],this.resetPuzzle(),this.validationResult="")}get canGoPreviousExample(){return this.currentExampleIndex>0}get canGoNextExample(){return this.currentExampleIndex<this.examples.length-1}get currentBlocks(){if(!this.currentExample?.blocks)return[];const l=[...this.currentExample.blocks];for(let p=l.length-1;p>0;p--){const d=Math.floor(Math.random()*(p+1));[l[p],l[d]]=[l[d],l[p]]}return l}get currentAnswer(){return this.currentExample?.answer||[]}resetPuzzle(){setTimeout(()=>{this.puzzleComponent&&this.puzzleComponent.ngOnInit()},0)}static{this.\u0275fac=function(p){return new(p||g)(o.Y36(vt.eN))}}static{this.\u0275cmp=o.Xpm({type:g,selectors:[["app-abstraccion"]],viewQuery:function(p,d){if(1&p&&o.Gf(ni,5),2&p){let v;o.iGM(v=o.CRH())&&(d.puzzleComponent=v.first)}},decls:23,vars:24,consts:[[1,"text-center","mb-6","mt-6"],[1,"text-3xl","font-bold","text-gray-800","mb-2","drop-shadow-md"],[1,"flex","items-center","justify-center","mb-1"],[1,"h-0.5","bg-gradient-to-r","from-transparent","via-red-500","to-transparent","w-96","shadow-sm"],[1,"flex","items-center","justify-center"],[1,"h-px","bg-gradient-to-r","from-transparent","via-gray-300","to-transparent","w-64","opacity-60"],[1,"flex","flex-col","items-center","mb-6"],[1,"sticky","top-0","z-20","w-auto","flex","justify-center","bg-transparent","backdrop-blur-md","py-2","rounded-xl"],[1,"flex","gap-72"],[1,"relative","px-4","py-2","rounded-lg","font-semibold","text-gray-700","hover:text-red-500","transition",3,"ngClass","click"],[1,"flex","flex-col","gap-6","items-center","w-full","px-2","md:px-0"],["class","bg-gray-500/20 backdrop-blur-md p-8 rounded-lg border border-gray-400/30 shadow-lg w-full max-w-7xl mt-2 mb-8",4,"ngIf"],[1,"bg-gray-500/20","backdrop-blur-md","p-8","rounded-lg","border","border-gray-400/30","shadow-lg","w-full","max-w-7xl","mt-2","mb-8"],[1,"flex","flex-col","gap-6","mb-8","justify-start","items-start"],[1,"text-xl","font-bold","text-red-500","mb-2","flex","items-center","gap-2"],[1,"text-gray-800","ml-8"],[1,"bg-gradient-to-br","from-red-100","via-red-50","to-white","border-l-4","border-red-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"text-lg","font-semibold","text-gray-700","mt-4","mb-2","flex","items-center","gap-2"],[1,"text-gray-700"],[1,"bg-gradient-to-br","from-blue-100","via-blue-50","to-white","border-l-4","border-blue-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"text-xl","font-bold","text-blue-500","mb-2","flex","items-center","gap-2"],[1,"text-gray-800"],[1,"bg-gradient-to-br","from-green-100","via-green-50","to-white","border-l-4","border-green-400","shadow-lg","rounded-xl","p-6","w-full"],[1,"text-xl","font-bold","text-green-600","mb-2","flex","items-center","gap-2"],[1,"list-disc","ml-6","text-gray-800","mb-2"],[1,"bg-gradient-to-br","from-purple-100","via-purple-50","to-white","border-l-4","border-purple-400","shadow-lg","rounded-xl","p-6","w-full","mt-2","mb-2"],[1,"text-2xl","font-bold","text-purple-600","mb-2","flex","items-center","gap-2"],[1,"space-y-2"],[1,"bg-white","rounded-lg","p-3","max-w-2xl","w-[95%]","text-justify","ml-0","mt-8"],[1,"font-semibold"],[1,"bg-white","rounded-lg","p-3","max-w-2xl","w-[95%]","text-justify","ml-auto","mt-8"],[1,"text-2xl","font-bold","text-pink-600","mb-4","mt-4","flex","items-center","gap-2"],[1,"overflow-x-auto","mb-4"],[1,"min-w-full","text-sm","text-left","border-separate","border-spacing-0","rounded-xl","shadow-lg","bg-white"],[1,"bg-gradient-to-r","from-blue-500","via-cyan-400","to-green-300"],[1,"py-3","px-6","font-bold","text-white","rounded-tl-xl","text-center"],[1,"py-3","px-6","font-bold","text-white","text-center"],[1,"py-3","px-6","font-bold","text-white","rounded-tr-xl","text-center"],[1,"hover:bg-red-50","transition"],[1,"py-3","px-6","border-b","border-gray-200"],[1,"hover:bg-blue-50","transition"],[1,"hover:bg-pink-50","transition"],[1,"hover:bg-green-50","transition"],[1,"hover:bg-yellow-50","transition"],[1,"py-3","px-6"],[1,"bg-gradient-to-br","from-yellow-100","via-yellow-50","to-white","border-l-4","border-yellow-400","shadow-lg","rounded-xl","mt-6","p-6","w-full"],[1,"text-xl","font-bold","text-yellow-600","mb-2","flex","items-center","gap-2"],[1,"list-disc","ml-6","text-gray-800"],[1,"mt-6"],[3,"n","description","blocks","currentExample","currentExampleIndex","examples","validationResult","previousExample","nextExample","validatePuzzle"],["puzzleRef",""]],template:function(p,d){1&p&&(o.TgZ(0,"div",0)(1,"h1",1),o._uU(2,"\u{1f3af} Abstracci\xf3n y Simplificaci\xf3n"),o.qZA(),o.TgZ(3,"div",2),o._UZ(4,"div",3),o.qZA(),o.TgZ(5,"div",4),o._UZ(6,"div",5),o.qZA()(),o.TgZ(7,"div",6)(8,"nav",7)(9,"ul",8)(10,"li")(11,"button",9),o.NdJ("click",function(){return d.selectedSection=1}),o._uU(12," Teor\xeda "),o.qZA()(),o.TgZ(13,"li")(14,"button",9),o.NdJ("click",function(){return d.selectedSection=2}),o._uU(15," Ejemplos "),o.qZA()(),o.TgZ(16,"li")(17,"button",9),o.NdJ("click",function(){return d.selectedSection=3}),o._uU(18," Ejercicios "),o.qZA()()()()(),o.TgZ(19,"div",10),o.YNc(20,qs,149,0,"section",11),o.YNc(21,zs,5,7,"section",11),o.YNc(22,js,5,7,"section",11),o.qZA()),2&p&&(o.xp6(11),o.ekj("border-b-4",1===d.selectedSection)("border-red-500",1===d.selectedSection),o.Q6J("ngClass",o.VKq(18,Co,1===d.selectedSection)),o.xp6(3),o.ekj("border-b-4",2===d.selectedSection)("border-red-500",2===d.selectedSection),o.Q6J("ngClass",o.VKq(20,Co,2===d.selectedSection)),o.xp6(3),o.ekj("border-b-4",3===d.selectedSection)("border-red-500",3===d.selectedSection),o.Q6J("ngClass",o.VKq(22,Co,3===d.selectedSection)),o.xp6(3),o.Q6J("ngIf",1===d.selectedSection),o.xp6(1),o.Q6J("ngIf",2===d.selectedSection),o.xp6(1),o.Q6J("ngIf",3===d.selectedSection))},dependencies:[Z.mk,Z.O5,yo],styles:['.button-with-point[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:-8px;left:50%;transform:translate(-50%);width:0;height:0;border-left:8px solid transparent;border-right:8px solid transparent;border-top:8px solid #ef4444}']})}}return g})();function Ys(g,x){if(1&g&&(o.TgZ(0,"div",7)(1,"h3",31),o._uU(2),o.qZA(),o.TgZ(3,"div",32),o._UZ(4,"div",33),o.qZA()()),2&g){const l=o.oxw();o.xp6(2),o.Oqu(l.title)}}function Ks(g,x){1&g&&o._UZ(0,"div",47)}function ke(g,x){1&g&&(o.TgZ(0,"div",48)(1,"span",49),o._uU(2," \u25b6 "),o.qZA()())}function B(g,x){1&g&&(o.TgZ(0,"div",11),o.O4$(),o.TgZ(1,"svg",50),o._UZ(2,"line",51),o.qZA(),o.kcU(),o.TgZ(3,"div",52)(4,"span",53),o._uU(5,"..."),o.qZA()()())}function Js(g,x){1&g&&(o.TgZ(0,"div",54),o.O4$(),o.TgZ(1,"svg",55),o._UZ(2,"path",56),o.TgZ(3,"defs")(4,"marker",57),o._UZ(5,"polygon",58),o.qZA()()(),o.kcU(),o.TgZ(6,"span",59),o._uU(7,"Bucle"),o.qZA()())}function ri(g,x){if(1&g&&(o.ynx(0),o.TgZ(1,"div",38),o.YNc(2,Ks,1,0,"div",39),o.TgZ(3,"div",40)(4,"div")(5,"div",41)(6,"span",42),o._uU(7),o.qZA(),o.TgZ(8,"span",43),o._uU(9),o.qZA()()(),o.YNc(10,ke,3,0,"div",44),o.qZA(),o.YNc(11,B,6,0,"div",45),o.YNc(12,Js,8,0,"div",46),o.qZA(),o.BQk()),2&g){const l=o.oxw(),p=l.index,d=l.$implicit,v=o.oxw(2);o.xp6(2),o.Q6J("ngIf",p>0),o.xp6(2),o.Tol(v.getStepClass(d.type)),o.xp6(3),o.Oqu(v.getStepIcon(d.type)),o.xp6(2),o.Oqu(d.text),o.xp6(1),o.Q6J("ngIf",d.id===v.currentStepId),o.xp6(1),o.Q6J("ngIf",p===v.visibleSteps.length-1&&v.nextStepAvailable()),o.xp6(1),o.Q6J("ngIf",d.loopBack&&p===v.visibleSteps.length-1)}}function qi(g,x){if(1&g){const l=o.EpF();o.O4$(),o.kcU(),o.TgZ(0,"button",70),o.NdJ("click",function(){o.CHM(l);const d=o.oxw(4);return o.KtG(d.chooseBranch("no"))}),o._uU(1,"No"),o.qZA()}}function li(g,x){1&g&&(o.TgZ(0,"div",48)(1,"span",49),o._uU(2," \u25b6 "),o.qZA()())}function ci(g,x){if(1&g){const l=o.EpF();o.O4$(),o.kcU(),o.TgZ(0,"button",71),o.NdJ("click",function(){o.CHM(l);const d=o.oxw(4);return o.KtG(d.chooseBranch("yes"))}),o._uU(1,"S\xed"),o.qZA()}}function se(g,x){if(1&g&&(o.ynx(0),o.TgZ(1,"div",60)(2,"div",38),o.O4$(),o.TgZ(3,"svg",61),o._UZ(4,"line",62),o.qZA(),o.YNc(5,qi,2,0,"button",63),o.qZA(),o.kcU(),o.TgZ(6,"div",40)(7,"div",64)(8,"div",65)(9,"div",66),o._uU(10),o.qZA(),o.TgZ(11,"div",67),o._uU(12),o.qZA()()(),o.YNc(13,li,3,0,"div",44),o.qZA(),o.TgZ(14,"div",38),o.O4$(),o.TgZ(15,"svg",61),o._UZ(16,"line",68),o.qZA(),o.YNc(17,ci,2,0,"button",69),o.qZA()(),o.BQk()),2&g){const l=o.oxw(),p=l.index,d=l.$implicit,v=o.oxw(2);o.xp6(5),o.Q6J("ngIf",p===v.visibleSteps.length-1&&v.currentStepId===d.id),o.xp6(5),o.Oqu(v.getStepIcon(d.type)),o.xp6(2),o.Oqu(d.text),o.xp6(1),o.Q6J("ngIf",d.id===v.currentStepId),o.xp6(4),o.Q6J("ngIf",p===v.visibleSteps.length-1&&v.currentStepId===d.id)}}function Ve(g,x){if(1&g&&(o.TgZ(0,"div",36),o.YNc(1,ri,13,8,"ng-container",37),o.YNc(2,se,18,5,"ng-container",37),o.qZA()),2&g){const l=x.$implicit,p=o.oxw(2);o.xp6(1),o.Q6J("ngIf",!p.isDecision(l.type)),o.xp6(1),o.Q6J("ngIf",p.isDecision(l.type))}}function Io(g,x){if(1&g&&(o.TgZ(0,"div",34),o.YNc(1,Ve,3,2,"div",35),o.qZA()),2&g){const l=o.oxw();o.xp6(1),o.Q6J("ngForOf",l.visibleSteps)}}function zi(g,x){1&g&&(o.TgZ(0,"div",72)(1,"div",73),o._uU(2,"\u{1f680}"),o.qZA(),o.TgZ(3,"p",74),o._uU(4,"\xa1Comencemos el diagrama de flujo!"),o.qZA(),o.TgZ(5,"p",75),o._uU(6,'Presiona "Siguiente" para ver el primer paso'),o.qZA()())}function P(g,x){1&g&&(o.TgZ(0,"div",76)(1,"div",77)(2,"div",78),o._uU(3,"\u{1f389}"),o.qZA(),o.TgZ(4,"p",79),o._uU(5,"\xa1Diagrama de flujo completado!"),o.qZA(),o.TgZ(6,"p",80),o._uU(7,"Has visualizado todos los pasos del proceso"),o.qZA()()())}let Lt=(()=>{class g{constructor(){this.steps=[],this.title="",this.currentStepId=null,this.visibleSteps=[],this.history=[]}ngOnInit(){this.resetSteps()}ngOnChanges(l){l.steps&&this.steps&&this.resetSteps()}getStepById(l){return this.steps.find(p=>p.id===l)}resetSteps(){this.steps.length>0?(this.currentStepId=this.steps[0].id,this.history=[this.currentStepId],this.updateVisibleSteps()):(this.currentStepId=null,this.history=[],this.visibleSteps=[])}updateVisibleSteps(){this.visibleSteps=this.history.map(l=>this.getStepById(l)).filter(Boolean)}previousStep(){this.history.length>1&&(this.history.pop(),this.currentStepId=this.history[this.history.length-1],this.updateVisibleSteps())}nextStep(){if(!this.steps||0===this.steps.length||null===this.currentStepId)return;const l=this.getStepById(this.currentStepId);if(!l||"decision"===l.type)return;let p=null;if("number"==typeof l.next?p=l.next:"number"==typeof l.loopBack&&(p=l.loopBack),!p){const d=this.steps.findIndex(v=>v.id===this.currentStepId);d<this.steps.length-1&&(p=this.steps[d+1].id)}p&&(this.currentStepId=p,this.history.push(p),this.updateVisibleSteps())}chooseBranch(l){const p=this.getStepById(this.currentStepId);if(!p||"decision"!==p.type)return;const d=p.branches&&"number"==typeof p.branches[l]?p.branches[l]:null;d&&(this.currentStepId=d,this.history.push(d),this.updateVisibleSteps())}nextStepAvailable(){if(null===this.currentStepId)return!1;const l=this.getStepById(this.currentStepId);return!(!l||"decision"===l.type||"end"===l.type)&&("number"==typeof l.next||"number"==typeof l.loopBack||this.steps.findIndex(d=>d.id===this.currentStepId)<this.steps.length-1)}get canGoPrevious(){return this.history.length>1}get canReset(){return this.history.length>1}get progressText(){const l=this.getStepById(this.currentStepId);return l&&"end"===l.type?"Diagrama completado":`Paso ${this.visibleSteps.length} de ${this.steps.length}`}get progressPercentage(){if(0===this.steps.length)return 0;const l=this.getStepById(this.currentStepId);if(l&&"end"===l.type)return 100;const p=Math.round(this.visibleSteps.length/this.steps.length*100);return p>99?99:p}getStepClass(l){const p="inline-block p-3 rounded-lg shadow-md border-2 mb-3 mx-auto min-w-[150px] text-center transition-all duration-300 hover:shadow-lg";switch(l){case"start":case"end":return`${p} bg-green-100 border-green-400 text-green-800`;case"process":return`${p} bg-blue-100 border-blue-400 text-blue-800`;case"decision":return`${p} bg-yellow-100 border-yellow-400 text-yellow-800 transform rotate-45`;default:return`${p} bg-gray-100 border-gray-400 text-gray-800`}}getStepIcon(l){switch(l){case"start":return"\u{1f7e2}";case"process":return"\u{1f4e6}";case"decision":return"\u{1f914}";case"end":return"\u2705";default:return"\u{1f4dd}"}}isDecision(l){return"decision"===l}static{this.\u0275fac=function(p){return new(p||g)}}static{this.\u0275cmp=o.Xpm({type:g,selectors:[["app-flowchart"]],inputs:{steps:"steps",title:"title"},features:[o.TTD],decls:48,vars:29,consts:[[1,"flowchart-container","w-full","h-full","flex","flex-col"],[1,"flex-1","overflow-y-auto"],["class","text-center mb-4",4,"ngIf"],["class","flex flex-col items-center space-y-2 pb-6",4,"ngIf"],["class","text-center text-gray-500 py-8",4,"ngIf"],["class","text-center py-4",4,"ngIf"],[1,"mt-6","p-4","bg-gray-50","rounded-lg","border"],[1,"text-center","mb-4"],[1,"text-sm","font-bold","text-gray-700","mb-2"],[1,"flex","items-center","justify-center"],[1,"h-0.5","bg-gradient-to-r","from-transparent","via-blue-400","to-transparent","w-32"],[1,"flex","flex-col","items-center"],[1,"grid","grid-cols-2","gap-x-24","gap-y-3","text-xs","max-w-2xl"],[1,"flex","items-center","space-x-2"],[1,"w-4","h-4","bg-green-100","border","border-green-400","rounded"],[1,"w-4","h-4","bg-blue-100","border","border-blue-400","rounded"],[1,"w-4","h-4","bg-yellow-100","border","border-yellow-400","rounded","transform","rotate-45"],[1,"bg-white/90","backdrop-blur-sm","p-3","rounded-lg","border","border-gray-300","shadow-sm","mt-1","flex-shrink-0"],[1,"mb-3"],[1,"flex","justify-between","items-center","mb-1"],[1,"text-xs","font-medium","text-gray-700"],[1,"text-xs","font-medium","text-green-600"],[1,"w-full","bg-gray-200","rounded-full","h-1.5"],[1,"bg-gradient-to-r","from-blue-500","to-green-500","h-1.5","rounded-full","transition-all","duration-500","ease-in-out"],[1,"flex","justify-center","items-center","space-x-2"],[1,"w-8","h-8","text-white","rounded-full","shadow-md","hover:shadow-lg","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border","disabled:bg-gray-400","disabled:border-gray-300","disabled:hover:bg-gray-400",3,"disabled","click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[1,"px-3","py-1.5","text-xs","font-medium","text-white","bg-gray-500","rounded-md","shadow-md","hover:shadow-lg","transition-all","duration-300","ease-in-out","disabled:bg-gray-300","disabled:cursor-not-allowed",3,"disabled","click"],[1,"w-8","h-8","bg-blue-600","hover:bg-blue-700","text-white","rounded-full","shadow-md","hover:shadow-lg","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border","border-blue-800","disabled:bg-gray-400","disabled:border-gray-300","disabled:hover:bg-gray-400",3,"disabled","click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],[1,"text-lg","font-bold","text-gray-800"],[1,"flex","items-center","justify-center","mt-2"],[1,"h-0.5","bg-gradient-to-r","from-transparent","via-blue-400","to-transparent","w-64"],[1,"flex","flex-col","items-center","space-y-2","pb-6"],["class","step-animation w-full flex justify-center items-center relative",4,"ngFor","ngForOf"],[1,"step-animation","w-full","flex","justify-center","items-center","relative"],[4,"ngIf"],[1,"flex","flex-col","items-center","w-1/2"],["class","w-0.5 h-6 bg-gray-300 mb-2 mx-auto",4,"ngIf"],[1,"step-container","relative"],[1,"flex","items-center","justify-center","space-x-2"],[1,"text-lg"],[1,"font-medium"],["class","absolute -top-2 -right-2 z-10",4,"ngIf"],["class","flex flex-col items-center",4,"ngIf"],["class","flex flex-col items-center mt-2",4,"ngIf"],[1,"w-0.5","h-6","bg-gray-300","mb-2","mx-auto"],[1,"absolute","-top-2","-right-2","z-10"],[1,"inline-flex","items-center","justify-center","w-6","h-6","bg-green-500","text-white","text-xs","font-bold","rounded-full","animate-pulse"],["width","32","height","32",1,"mx-auto"],["x1","16","y1","0","x2","16","y2","32","stroke","#60a5fa","stroke-width","2","stroke-dasharray","4"],[1,"w-6","h-6","border-2","border-dashed","border-blue-400","rounded-full","flex","items-center","justify-center"],[1,"text-blue-400","text-xs","animate-pulse"],[1,"flex","flex-col","items-center","mt-2"],["width","60","height","40","viewBox","0 0 60 40",1,"mx-auto"],["d","M30 0 Q60 20 30 40 Q0 20 30 0","stroke","#3b82f6","stroke-width","2","fill","none","marker-end","url(#arrowhead)"],["id","arrowhead","markerWidth","6","markerHeight","6","refX","5","refY","3","orient","auto"],["points","0 0, 6 3, 0 6","fill","#3b82f6"],[1,"text-xs","text-blue-600","font-bold"],[1,"flex","flex-row","items-center","w-full","justify-center"],["width","60","height","32",1,"mb-2"],["x1","60","y1","16","x2","0","y2","16","stroke","#f87171","stroke-width","2"],["class","px-4 py-2 bg-red-500 text-white rounded shadow hover:bg-red-600 font-bold",3,"click",4,"ngIf"],[1,"w-32","h-32","bg-yellow-100","border-2","border-yellow-400","transform","rotate-45","flex","items-center","justify-center","mx-auto"],[1,"transform","-rotate-45","text-center"],[1,"text-lg","mb-1"],[1,"text-xs","font-medium","text-yellow-800","leading-tight"],["x1","0","y1","16","x2","60","y2","16","stroke","#34d399","stroke-width","2"],["class","px-4 py-2 bg-green-500 text-white rounded shadow hover:bg-green-600 font-bold",3,"click",4,"ngIf"],[1,"px-4","py-2","bg-red-500","text-white","rounded","shadow","hover:bg-red-600","font-bold",3,"click"],[1,"px-4","py-2","bg-green-500","text-white","rounded","shadow","hover:bg-green-600","font-bold",3,"click"],[1,"text-center","text-gray-500","py-8"],[1,"text-6xl","mb-4"],[1,"text-lg","font-medium"],[1,"text-sm"],[1,"text-center","py-4"],[1,"bg-green-50","border","border-green-200","rounded-lg","p-4"],[1,"text-4xl","mb-2"],[1,"text-green-800","font-medium"],[1,"text-green-600","text-sm"]],template:function(p,d){1&p&&(o.TgZ(0,"div",0)(1,"div",1),o.YNc(2,Ys,5,1,"div",2),o.YNc(3,Io,2,1,"div",3),o.YNc(4,zi,7,0,"div",4),o.YNc(5,P,8,0,"div",5),o.TgZ(6,"div",6)(7,"div",7)(8,"h4",8),o._uU(9,"Leyenda"),o.qZA(),o.TgZ(10,"div",9),o._UZ(11,"div",10),o.qZA()(),o.TgZ(12,"div",11)(13,"div",12)(14,"div",13),o._UZ(15,"div",14),o.TgZ(16,"span"),o._uU(17,"\u{1f7e2} Inicio/Fin"),o.qZA()(),o.TgZ(18,"div",13),o._UZ(19,"div",15),o.TgZ(20,"span"),o._uU(21,"\u{1f4e6} Proceso"),o.qZA()(),o.TgZ(22,"div",13),o._UZ(23,"div",16),o.TgZ(24,"span"),o._uU(25,"\u{1f914} Decisi\xf3n"),o.qZA()(),o.TgZ(26,"div",13),o._UZ(27,"div",14),o.TgZ(28,"span"),o._uU(29,"\u2705 Final"),o.qZA()()()()()(),o.TgZ(30,"div",17)(31,"div",18)(32,"div",19)(33,"span",20),o._uU(34),o.qZA(),o.TgZ(35,"span",21),o._uU(36),o.qZA()(),o.TgZ(37,"div",22),o._UZ(38,"div",23),o.qZA()(),o.TgZ(39,"div",24)(40,"button",25),o.NdJ("click",function(){return d.previousStep()}),o.O4$(),o.TgZ(41,"svg",26),o._UZ(42,"path",27),o.qZA()(),o.kcU(),o.TgZ(43,"button",28),o.NdJ("click",function(){return d.resetSteps()}),o._uU(44," \u{1f504} Reiniciar "),o.qZA(),o.TgZ(45,"button",29),o.NdJ("click",function(){return d.nextStep()}),o.O4$(),o.TgZ(46,"svg",26),o._UZ(47,"path",30),o.qZA()()()()()),2&p&&(o.xp6(2),o.Q6J("ngIf",d.title),o.xp6(1),o.Q6J("ngIf",d.visibleSteps.length>0),o.xp6(1),o.Q6J("ngIf",0===d.visibleSteps.length&&d.steps.length>0),o.xp6(1),o.Q6J("ngIf",!d.nextStepAvailable()&&d.visibleSteps.length>0),o.xp6(29),o.Oqu(d.progressText),o.xp6(2),o.hij("",d.progressPercentage,"%"),o.xp6(2),o.Udp("width",d.progressPercentage,"%"),o.xp6(2),o.Udp("background-color",d.canGoPrevious?"#f3ae22":"")("border-color",d.canGoPrevious?"#d18c00":""),o.ekj("opacity-50",!d.canGoPrevious)("cursor-not-allowed",!d.canGoPrevious),o.Q6J("disabled",!d.canGoPrevious),o.xp6(3),o.ekj("opacity-50",!d.canReset)("cursor-not-allowed",!d.canReset)("hover:bg-gray-600",d.canReset),o.Q6J("disabled",!d.canReset),o.xp6(2),o.ekj("opacity-50",!d.nextStepAvailable())("cursor-not-allowed",!d.nextStepAvailable()),o.Q6J("disabled",!d.nextStepAvailable()))},dependencies:[Z.sg,Z.O5],styles:[".flowchart-container[_ngcontent-%COMP%]{font-family:Inter,sans-serif;display:flex;flex-direction:column;height:100%;max-height:100%}.flex-1[_ngcontent-%COMP%]{flex:1;min-height:0}.flex-shrink-0[_ngcontent-%COMP%]{flex-shrink:0}.overflow-y-auto[_ngcontent-%COMP%]{scroll-behavior:smooth}.step-container[_ngcontent-%COMP%]{position:relative;z-index:1}.step-container[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{transition:all .3s cubic-bezier(.4,0,.2,1);box-shadow:0 2px 8px #00000012}.step-container[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:hover{transform:scale(1.07);z-index:10;box-shadow:0 6px 24px #0000001f}.decision-diamond[_ngcontent-%COMP%], .w-32.h-32[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fef3c7,#fde68a);box-shadow:0 4px 12px -1px #00000014;border-radius:12px}.flow-connector[_ngcontent-%COMP%], .bg-gray-300[_ngcontent-%COMP%], .bg-gray-400[_ngcontent-%COMP%]{background:linear-gradient(to bottom,#dbeafe,#60a5fa)}@keyframes _ngcontent-%COMP%_stepAppear{0%{opacity:0;transform:translateY(-20px) scale(.8)}50%{opacity:.7;transform:translateY(-5px) scale(1.1)}to{opacity:1;transform:translateY(0) scale(1)}}.step-animation[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_stepAppear .5s cubic-bezier(.4,0,.2,1)}@keyframes _ngcontent-%COMP%_drawLine{0%{stroke-dasharray:0,100;opacity:0}to{stroke-dasharray:100,0;opacity:1}}.animate-draw-line[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_drawLine .4s ease-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:scale(.5)}to{opacity:1;transform:scale(1)}}.animate-fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-out}@keyframes _ngcontent-%COMP%_gentlePulse{0%,to{transform:scale(1);opacity:1}50%{transform:scale(1.1);opacity:.8}}.animate-pulse[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_gentlePulse 2s ease-in-out infinite}.step-nav-button[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 25px #00000026}.progress-bar[_ngcontent-%COMP%]{background:linear-gradient(90deg,#3b82f6,#10b981);background-size:200% 100%;animation:_ngcontent-%COMP%_gradientShift 3s ease infinite}@keyframes _ngcontent-%COMP%_gradientShift{0%{background-position:0% 50%}50%{background-position:100% 50%}to{background-position:0% 50%}}@media (max-width: 768px){.step-container[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{min-width:120px;padding:.5rem;font-size:.875rem}.decision-diamond[_ngcontent-%COMP%]{width:100px!important;height:100px!important}.step-nav-button[_ngcontent-%COMP%]{width:2.5rem;height:2.5rem}}.legend-item[_ngcontent-%COMP%]{transition:background-color .2s ease}.legend-item[_ngcontent-%COMP%]:hover{background-color:#3b82f61a}.flowchart-shadow[_ngcontent-%COMP%]{filter:drop-shadow(0 4px 6px rgba(0,0,0,.1))}.completion-celebration[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_celebrate .8s ease-out}@keyframes _ngcontent-%COMP%_celebrate{0%{transform:scale(1)}25%{transform:scale(1.1) rotate(5deg)}50%{transform:scale(1.2) rotate(-5deg)}75%{transform:scale(1.1) rotate(2deg)}to{transform:scale(1) rotate(0)}}.status-message[_ngcontent-%COMP%]{transition:all .5s ease-in-out}.control-panel[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);background:rgba(255,255,255,.9);border:1px solid rgba(0,0,0,.1)}.continuation-indicator[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_bounce 2s ease-in-out infinite}@keyframes _ngcontent-%COMP%_bounce{0%,20%,50%,80%,to{transform:translateY(0)}40%{transform:translateY(-5px)}60%{transform:translateY(-3px)}}"]})}}return g})();var I=le(3329);const{Variables:dn,dialog:is,inject:Vc}=I;let Sr=(()=>{class g{constructor(){this.workspace=null}initializeWorkspace(l){const p={toolbox:this.getVariablesToolbox(),collapse:!0,comments:!0,disable:!0,maxBlocks:1/0,trashcan:!0,horizontalLayout:!1,toolboxPosition:"start",css:!0,media:"https://unpkg.com/blockly/media/",rtl:!1,scrollbars:!0,sounds:!0,oneBasedIndex:!0,grid:{spacing:20,length:3,colour:"#ccc",snap:!0},zoom:{controls:!0,wheel:!0,startScale:1,maxScale:3,minScale:.3,scaleSpeed:1.2}};return this.workspace=Vc(l,p),this.workspace&&(this.workspace.getVariableMap().createVariable("item"),console.log('Variable por defecto "item" creada')),this.workspace}getVariablesToolbox(){let l="";return l+='\n        <block type="variables_set">\n          <field name="VAR">item</field>\n        </block>\n        <block type="variables_get">\n          <field name="VAR">item</field>\n        </block>',this.workspace&&this.workspace.getAllVariables().forEach(d=>{const v=d.getName();"item"!==v&&(l+=`\n          <block type="variables_set">\n            <field name="VAR">${v}</field>\n          </block>\n          <block type="variables_get">\n            <field name="VAR">${v}</field>\n          </block>`)}),`\n    <xml xmlns="https://developers.google.com/blockly/xml" id="toolbox" style="display: none">\n      <category name="Variables" colour="#a55b5b">\n        ${l}\n        <button text="Crear variable..." callbackKey="CREATE_VARIABLE"></button>\n      </category>\n      <category name="L\xf3gica" colour="#5b80a5">\n        <block type="logic_boolean">\n          <field name="BOOL">TRUE</field>\n        </block>\n        <block type="logic_boolean">\n          <field name="BOOL">FALSE</field>\n        </block>\n        <block type="logic_compare">\n          <field name="OP">EQ</field>\n        </block>\n        <block type="logic_compare">\n          <field name="OP">NEQ</field>\n        </block>\n        <block type="logic_compare">\n          <field name="OP">GT</field>\n        </block>\n        <block type="logic_compare">\n          <field name="OP">GTE</field>\n        </block>\n        <block type="logic_compare">\n          <field name="OP">LT</field>\n        </block>\n        <block type="logic_compare">\n          <field name="OP">LTE</field>\n        </block>\n        <block type="logic_operation">\n          <field name="OP">AND</field>\n        </block>\n        <block type="logic_operation">\n          <field name="OP">OR</field>\n        </block>\n        <block type="logic_negate"></block>\n      </category>\n      <category name="Control" colour="#e1a91a">\n        <block type="controls_if"></block>\n        <block type="controls_if">\n          <mutation else="1"></mutation>\n        </block>\n        <block type="controls_if">\n          <mutation elseif="1" else="1"></mutation>\n        </block>\n      </category>\n      <category name="Bucles" colour="#5ba58c">\n        <block type="controls_repeat_ext">\n          <value name="TIMES">\n            <shadow type="math_number">\n              <field name="NUM">10</field>\n            </shadow>\n          </value>\n        </block>\n        <block type="controls_whileUntil">\n          <field name="MODE">WHILE</field>\n        </block>\n        <block type="controls_whileUntil">\n          <field name="MODE">UNTIL</field>\n        </block>\n        <block type="controls_for">\n          <field name="VAR">i</field>\n          <value name="FROM">\n            <shadow type="math_number">\n              <field name="NUM">1</field>\n            </shadow>\n          </value>\n          <value name="TO">\n            <shadow type="math_number">\n              <field name="NUM">10</field>\n            </shadow>\n          </value>\n          <value name="BY">\n            <shadow type="math_number">\n              <field name="NUM">1</field>\n            </shadow>\n          </value>\n        </block>\n        <block type="controls_forEach">\n          <field name="VAR">j</field>\n        </block>\n        <block type="controls_flow_statements">\n          <field name="FLOW">BREAK</field>\n        </block>\n        <block type="controls_flow_statements">\n          <field name="FLOW">CONTINUE</field>\n        </block>\n      </category>\n      <category name="Matem\xe1ticas" colour="#5b5ba5">\n        <block type="math_number">\n          <field name="NUM">0</field>\n        </block>\n        <block type="math_arithmetic">\n          <field name="OP">ADD</field>\n        </block>\n        <block type="math_arithmetic">\n          <field name="OP">MINUS</field>\n        </block>\n        <block type="math_arithmetic">\n          <field name="OP">MULTIPLY</field>\n        </block>\n        <block type="math_arithmetic">\n          <field name="OP">DIVIDE</field>\n        </block>\n        <block type="math_single">\n          <field name="OP">ROOT</field>\n        </block>\n        <block type="math_single">\n          <field name="OP">ABS</field>\n        </block>\n        <block type="math_single">\n          <field name="OP">NEG</field>\n        </block>\n        <block type="math_single">\n          <field name="OP">LN</field>\n        </block>\n        <block type="math_single">\n          <field name="OP">LOG10</field>\n        </block>\n        <block type="math_single">\n          <field name="OP">EXP</field>\n        </block>\n        <block type="math_single">\n          <field name="OP">POW10</field>\n        </block>\n        <block type="math_trig">\n          <field name="OP">SIN</field>\n        </block>\n        <block type="math_trig">\n          <field name="OP">COS</field>\n        </block>\n        <block type="math_trig">\n          <field name="OP">TAN</field>\n        </block>\n        <block type="math_constant">\n          <field name="CONSTANT">PI</field>\n        </block>\n        <block type="math_constant">\n          <field name="CONSTANT">E</field>\n        </block>\n        <block type="math_constant">\n          <field name="CONSTANT">GOLDEN_RATIO</field>\n        </block>\n        <block type="math_number_property">\n          <mutation divisor_input="false"></mutation>\n          <field name="PROPERTY">EVEN</field>\n        </block>\n        <block type="math_round">\n          <field name="OP">ROUND</field>\n        </block>\n        <block type="math_on_list">\n          <mutation op="SUM"></mutation>\n          <field name="OP">SUM</field>\n        </block>\n        <block type="math_modulo"></block>\n        <block type="math_constrain">\n          <value name="LOW">\n            <shadow type="math_number">\n              <field name="NUM">1</field>\n            </shadow>\n          </value>\n          <value name="HIGH">\n            <shadow type="math_number">\n              <field name="NUM">100</field>\n            </shadow>\n          </value>\n        </block>\n        <block type="math_random_int">\n          <value name="FROM">\n            <shadow type="math_number">\n              <field name="NUM">1</field>\n            </shadow>\n          </value>\n          <value name="TO">\n            <shadow type="math_number">\n              <field name="NUM">100</field>\n            </shadow>\n          </value>\n        </block>\n        <block type="math_random_float"></block>\n      </category>\n      <category name="Texto" colour="#5ba55b">\n        <block type="text">\n          <field name="TEXT"></field>\n        </block>\n        <block type="text_join">\n          <mutation items="2"></mutation>\n        </block>\n        <block type="text_append">\n          <field name="VAR">item</field>\n        </block>\n        <block type="text_length"></block>\n        <block type="text_isEmpty"></block>\n        <block type="text_indexOf">\n          <field name="END">FIRST</field>\n          <value name="VALUE">\n            <block type="variables_get">\n              <field name="VAR">texto</field>\n            </block>\n          </value>\n        </block>\n        <block type="text_charAt">\n          <mutation at="true"></mutation>\n          <field name="WHERE">FROM_START</field>\n          <value name="VALUE">\n            <block type="variables_get">\n              <field name="VAR">texto</field>\n            </block>\n          </value>\n        </block>\n        <block type="text_getSubstring">\n          <mutation at1="true" at2="true"></mutation>\n          <field name="WHERE1">FROM_START</field>\n          <field name="WHERE2">FROM_START</field>\n          <value name="STRING">\n            <block type="variables_get">\n              <field name="VAR">texto</field>\n            </block>\n          </value>\n        </block>\n        <block type="text_changeCase">\n          <field name="CASE">UPPERCASE</field>\n        </block>\n        <block type="text_trim">\n          <field name="MODE">BOTH</field>\n        </block>\n        <block type="text_print">\n          <value name="TEXT">\n            <shadow type="text">\n              <field name="TEXT">abc</field>\n            </shadow>\n          </value>\n        </block>\n        <block type="text_prompt_ext">\n          <mutation type="TEXT"></mutation>\n          <field name="TYPE">TEXT</field>\n          <value name="TEXT">\n            <shadow type="text">\n              <field name="TEXT">abc</field>\n            </shadow>\n          </value>\n        </block>\n      </category>\n      <category name="Salida" colour="#745ba5">\n        <block type="text_print">\n          <value name="TEXT">\n            <shadow type="text">\n              <field name="TEXT">abc</field>\n            </shadow>\n          </value>\n        </block>\n      </category>\n      <category name="Listas" colour="#745ba5">\n        <block type="lists_create_with">\n          <mutation items="0"></mutation>\n        </block>\n        <block type="lists_create_with">\n          <mutation items="3"></mutation>\n        </block>\n        <block type="lists_repeat">\n          <value name="NUM">\n            <shadow type="math_number">\n              <field name="NUM">5</field>\n            </shadow>\n          </value>\n        </block>\n        <block type="lists_length"></block>\n        <block type="lists_isEmpty"></block>\n        <block type="lists_indexOf">\n          <field name="END">FIRST</field>\n          <value name="VALUE">\n            <block type="variables_get">\n              <field name="VAR">lista</field>\n            </block>\n          </value>\n        </block>\n        <block type="lists_getIndex">\n          <mutation statement="false" at="true"></mutation>\n          <field name="MODE">GET</field>\n          <field name="WHERE">FROM_START</field>\n          <value name="VALUE">\n            <block type="variables_get">\n              <field name="VAR">lista</field>\n            </block>\n          </value>\n        </block>\n        <block type="lists_setIndex">\n          <mutation at="true"></mutation>\n          <field name="MODE">SET</field>\n          <field name="WHERE">FROM_START</field>\n          <value name="LIST">\n            <block type="variables_get">\n              <field name="VAR">lista</field>\n            </block>\n          </value>\n        </block>\n        <block type="lists_getSublist">\n          <mutation at1="true" at2="true"></mutation>\n          <field name="WHERE1">FROM_START</field>\n          <field name="WHERE2">FROM_START</field>\n          <value name="LIST">\n            <block type="variables_get">\n              <field name="VAR">lista</field>\n            </block>\n          </value>\n        </block>\n        <block type="lists_split">\n          <mutation mode="SPLIT"></mutation>\n          <field name="MODE">SPLIT</field>\n          <value name="DELIM">\n            <shadow type="text">\n              <field name="TEXT">,</field>\n            </shadow>\n          </value>\n        </block>\n        <block type="lists_sort">\n          <field name="TYPE">NUMERIC</field>\n          <field name="DIRECTION">1</field>\n        </block>\n      </category>\n      <category name="Funciones" colour="#9a5ba5" custom="PROCEDURE">\n      </category>\n    </xml>\n    `}generateCode(){if(!this.workspace)return"";const l=this.workspace.getTopBlocks(!0);let p="";return console.log("Bloques encontrados:",l.length),l.forEach((d,v)=>{console.log("Procesando cadena de bloques iniciando con:",d.type);let O=d,q="";for(;O;){console.log("Bloque en cadena:",O.type);const ce=this.blockToCode(O);ce&&(q&&(q+="\n"),q+=ce),O=O.getNextBlock()}q&&(p&&(p+="\n"),p+=q)}),console.log("C\xf3digo generado completo:",p),p}blockToCode(l){switch(console.log("Procesando bloque:",l.type),l.type){case"variables_set":const p=l.getFieldValue("VAR"),d=this.workspace.getVariableById(p),v=d?d.getName():p,O=l.getInputTargetBlock("VALUE"),q=O?this.getBlockValue(O):"";return console.log("Variables_set - ID:",p,"Nombre real:",v,"Valor:",q),`var ${v} = ${q};`;case"procedures_defreturn":const ce=l.getFieldValue("NAME"),_i=(l.getVars?l.getVars():[]).join(", ");let je="";const Gt=l.getInputTargetBlock("STACK");if(Gt){let H=Gt;for(;H;){const V=this.blockToCode(H);V&&(je+=(je?"\n  ":"  ")+V),H=H.getNextBlock()}}const No=l.getInputTargetBlock("RETURN");let Lo="";return No&&(Lo=this.getBlockValue(No),je+=(je?"\n  ":"  ")+`return ${Lo};`),`function ${ce}(${_i}) {\n${je}\n}`;case"procedures_defnoreturn":const us=l.getFieldValue("NAME"),ds=(l.getVars?l.getVars():[]).join(", ");let co="";const bi=l.getInputTargetBlock("STACK");if(bi){let H=bi;for(;H;){const V=this.blockToCode(H);V&&(co+=(co?"\n  ":"  ")+V),H=H.getNextBlock()}}return`function ${us}(${ds}) {\n${co}\n}`;case"procedures_callreturn":const fi=l.getFieldValue("NAME"),It=[];if(l.inputList)for(let H=0;H<l.inputList.length;H++){const V=l.inputList[H];if(V.name&&V.connection){const Oe=V.connection.targetBlock();Oe&&It.push(this.getBlockValue(Oe))}}return`${fi}(${It.join(", ")})`;case"procedures_callnoreturn":const hs=l.getFieldValue("NAME"),Ti=[];if(l.inputList)for(let H=0;H<l.inputList.length;H++){const V=l.inputList[H];if(V.name&&V.connection){const Oe=V.connection.targetBlock();Oe&&Ti.push(this.getBlockValue(Oe))}}return`${hs}(${Ti.join(", ")});`;case"math_number":const Gr=l.getFieldValue("NUM");return console.log("Math_number:",Gr),Gr;case"text":const Zr=l.getFieldValue("TEXT");return console.log("Text:",Zr),`"${Zr}"`;case"logic_boolean":const Ei=l.getFieldValue("BOOL").toLowerCase();return console.log("Logic_boolean:",Ei),Ei;case"math_arithmetic":const Wr=l.getFieldValue("OP"),Tn=l.getInputTargetBlock("A"),vi=l.getInputTargetBlock("B"),yi=Tn?this.getBlockValue(Tn):"0",qr=vi?this.getBlockValue(vi):"0";let kt="+";switch(Wr){case"ADD":kt="+";break;case"MINUS":kt="-";break;case"MULTIPLY":kt="*";break;case"DIVIDE":kt="/"}return console.log("Math_arithmetic - A:",yi,"Op:",kt,"B:",qr),`${yi} ${kt} ${qr}`;case"variables_get":const En=l.getFieldValue("VAR");return console.log("Variables_get:",En),En;case"text_join":const Do=[];for(let H=0;H<l.inputList.length;H++){const V=l.inputList[H];if(1===V.type){const Oe=V.connection?.targetBlock();Oe&&Do.push(this.getBlockValue(Oe))}}return console.log("Text_join - inputs:",Do),Do.join(" + ");case"text_print":const zr=l.getInputTargetBlock("TEXT"),jr=zr?this.getBlockValue(zr):'""';return console.log("Text_print - value:",jr),`print(${jr});`;case"logic_compare":const ao=l.getFieldValue("OP"),vn=l.getInputTargetBlock("A"),ht=l.getInputTargetBlock("B"),Xr=vn?this.getBlockValue(vn):"",Yr=ht?this.getBlockValue(ht):"";let St="==";switch(ao){case"EQ":St="==";break;case"NEQ":St="!=";break;case"LT":St="<";break;case"LTE":St="<=";break;case"GT":St=">";break;case"GTE":St=">="}return console.log("Logic_compare - A:",Xr,"Op:",St,"B:",Yr),`${Xr} ${St} ${Yr}`;case"logic_operation":const pa=l.getFieldValue("OP"),uo=l.getInputTargetBlock("A"),yn=l.getInputTargetBlock("B"),Kr=uo?this.getBlockValue(uo):"",Jr=yn?this.getBlockValue(yn):"";let ps="&&";switch(pa){case"AND":ps="&&";break;case"OR":ps="||"}return console.log("Logic_operation - A:",Kr,"Op:",ps,"B:",Jr),`${Kr} ${ps} ${Jr}`;case"logic_negate":const Qr=l.getInputTargetBlock("BOOL"),el=Qr?this.getBlockValue(Qr):"";return console.log("Logic_negate - value:",el),`!(${el})`;case"controls_if":let Ci="",tl=l.getInputTargetBlock("IF0");const ol=tl?this.getBlockValue(tl):"";let gs=l.getInputTargetBlock("DO0"),Cn="";if(gs){let H=gs;for(;H;){const V=this.blockToCode(H);V&&(Cn+=(Cn?"\n  ":"  ")+V),H=H.getNextBlock()}}Ci=`if (${ol}) {\n${Cn}\n}`;const il=l.getInputTargetBlock("ELSE");if(il){let H="",V=il;for(;V;){const Oe=this.blockToCode(V);Oe&&(H+=(H?"\n  ":"  ")+Oe),V=V.getNextBlock()}Ci+=` else {\n${H}\n}`}return console.log("Controls_if - condition:",ol,"code:",Ci),Ci;case"controls_repeat_ext":const In=l.getInputTargetBlock("TIMES"),pt=In?this.getBlockValue(In):"10";let sl=l.getInputTargetBlock("DO"),kn="";if(sl){let H=sl;for(;H;){const V=this.blockToCode(H);V&&(kn+=(kn?"\n  ":"  ")+V),H=H.getNextBlock()}}const Bo=`for (let i = 0; i < ${pt}; i++) {\n${kn}\n}`;return console.log("Controls_repeat_ext - times:",pt,"code:",Bo),Bo;case"controls_whileUntil":const nl=l.getFieldValue("MODE"),Sn=l.getInputTargetBlock("BOOL"),$s=Sn?this.getBlockValue(Sn):"false";let rl=l.getInputTargetBlock("DO"),wn="";if(rl){let H=rl;for(;H;){const V=this.blockToCode(H);V&&(wn+=(wn?"\n  ":"  ")+V),H=H.getNextBlock()}}const ll="WHILE"===nl?$s:`!(${$s})`,cl=`while (${ll}) {\n${wn}\n}`;return console.log("Controls_whileUntil - mode:",nl,"condition:",ll),cl;case"controls_for":const Po=l.getFieldValue("VAR"),xn=l.getInputTargetBlock("FROM"),ms=l.getInputTargetBlock("TO"),al=l.getInputTargetBlock("BY"),ul=xn?this.getBlockValue(xn):"1",dl=ms?this.getBlockValue(ms):"10",hl=al?this.getBlockValue(al):"1";let D=l.getInputTargetBlock("DO"),Pe="";if(D){let H=D;for(;H;){const V=this.blockToCode(H);V&&(Pe+=(Pe?"\n  ":"  ")+V),H=H.getNextBlock()}}const Se=`for (let ${Po} = ${ul}; ${Po} <= ${dl}; ${Po} += ${hl}) {\n${Pe}\n}`;return console.log("Controls_for - var:",Po,"from:",ul,"to:",dl,"by:",hl),Se;case"math_single":const ae=l.getFieldValue("OP"),gt=l.getInputTargetBlock("NUM"),lt=gt?this.getBlockValue(gt):"0";let M="";switch(ae){case"ROOT":M=`Math.sqrt(${lt})`;break;case"ABS":M=`Math.abs(${lt})`;break;case"NEG":M=`-(${lt})`;break;case"LN":M=`Math.log(${lt})`;break;case"LOG10":M=`Math.log10(${lt})`;break;case"EXP":M=`Math.exp(${lt})`;break;case"POW10":M=`Math.pow(10, ${lt})`}return console.log("Math_single - op:",ae,"result:",M),M;case"math_trig":const he=l.getFieldValue("OP"),pl=l.getInputTargetBlock("NUM"),Fo=pl?this.getBlockValue(pl):"0";let Zt="";switch(he){case"SIN":Zt=`Math.sin(${Fo})`;break;case"COS":Zt=`Math.cos(${Fo})`;break;case"TAN":Zt=`Math.tan(${Fo})`;break;case"ASIN":Zt=`Math.asin(${Fo})`;break;case"ACOS":Zt=`Math.acos(${Fo})`;break;case"ATAN":Zt=`Math.atan(${Fo})`}return console.log("Math_trig - op:",he,"result:",Zt),Zt;case"math_constant":const _s=l.getFieldValue("CONSTANT");let wt="";switch(_s){case"PI":wt="Math.PI";break;case"E":wt="Math.E";break;case"GOLDEN_RATIO":wt="1.618033988749895";break;case"SQRT2":wt="Math.SQRT2";break;case"SQRT1_2":wt="Math.SQRT1_2";break;case"INFINITY":wt="Infinity"}return console.log("Math_constant - constant:",_s,"result:",wt),wt;case"math_random_int":const bs=l.getInputTargetBlock("FROM"),An=l.getInputTargetBlock("TO"),fs=bs?this.getBlockValue(bs):"1",Rn=An?this.getBlockValue(An):"100",gl=`Math.floor(Math.random() * (${Rn} - ${fs} + 1)) + ${fs}`;return console.log("Math_random_int - from:",fs,"to:",Rn),gl;case"math_random_float":return console.log("Math_random_float"),"Math.random()";case"lists_create_with":const ho=[];for(let H=0;H<l.inputList.length;H++){const V=l.inputList[H];if(1===V.type){const Oe=V.connection?.targetBlock();Oe&&ho.push(this.getBlockValue(Oe))}}const $l=`[${ho.join(", ")}]`;return console.log("Lists_create_with - items:",ho),$l;case"lists_length":const ml=l.getInputTargetBlock("VALUE"),_l=ml?this.getBlockValue(ml):"[]",Uo=`${_l}.length`;return console.log("Lists_length - list:",_l),Uo;case"text_length":const On=l.getInputTargetBlock("VALUE"),bl=On?this.getBlockValue(On):'""',Mn=`${bl}.length`;return console.log("Text_length - text:",bl),Mn;case"text_isEmpty":const Xe=l.getInputTargetBlock("VALUE"),Nn=Xe?this.getBlockValue(Xe):'""',Ho=`${Nn}.length === 0`;return console.log("Text_isEmpty - text:",Nn),Ho;default:return console.log("Bloque no reconocido:",l.type),""}}getBlockValue(l){switch(console.log("getBlockValue called for block type:",l.type),l.type){case"math_number":const p=l.getFieldValue("NUM");return console.log("Math_number value:",p),p;case"text":const d=l.getFieldValue("TEXT");return console.log("Text value:",d),`"${d}"`;case"logic_boolean":const v=l.getFieldValue("BOOL").toLowerCase();return console.log("Logic_boolean value:",v),v;case"variables_get":const O=l.getFieldValue("VAR"),q=this.workspace.getVariableById(O),ce=q?q.getName():O;return console.log("Variables_get - ID:",O,"Nombre real:",ce),ce;case"math_arithmetic":const Ct=this.blockToCode(l);return console.log("Math_arithmetic value:",Ct),Ct;case"logic_compare":const _i=this.blockToCode(l);return console.log("Logic_compare value:",_i),_i;case"logic_operation":const je=this.blockToCode(l);return console.log("Logic_operation value:",je),je;case"logic_negate":const Gt=this.blockToCode(l);return console.log("Logic_negate value:",Gt),Gt;case"text_join":const No=this.blockToCode(l);return console.log("Text_join value:",No),No;case"math_single":const Lo=this.blockToCode(l);return console.log("Math_single value:",Lo),Lo;case"math_trig":const us=this.blockToCode(l);return console.log("Math_trig value:",us),us;case"math_constant":const fn=this.blockToCode(l);return console.log("Math_constant value:",fn),fn;case"math_random_int":const ds=this.blockToCode(l);return console.log("Math_random_int value:",ds),ds;case"math_random_float":const co=this.blockToCode(l);return console.log("Math_random_float value:",co),co;case"lists_create_with":const bi=this.blockToCode(l);return console.log("Lists_create_with value:",bi),bi;case"lists_length":const fi=this.blockToCode(l);return console.log("Lists_length value:",fi),fi;case"text_length":const It=this.blockToCode(l);return console.log("Text_length value:",It),It;case"text_isEmpty":const hs=this.blockToCode(l);return console.log("Text_isEmpty value:",hs),hs;default:const Ti=this.blockToCode(l);return console.log("Default case - block type:",l.type,"value:",Ti),Ti}}clearWorkspace(){this.workspace&&this.workspace.clear()}getWorkspace(){return this.workspace}dispose(){this.workspace&&(this.workspace.dispose(),this.workspace=null)}validateCode(l,p){console.log("=== VALIDACI\xd3N DE C\xd3DIGO ==="),console.log("C\xf3digo generado original:",JSON.stringify(l)),console.log("C\xf3digo esperado original:",JSON.stringify(p));const d=this.normalizeForComparison(l),v=this.normalizeForComparison(p);console.log("C\xf3digo generado normalizado:",JSON.stringify(d)),console.log("C\xf3digo esperado normalizado:",JSON.stringify(v));const O=d===v;console.log("Comparaci\xf3n normalizada:",O);const q=this.flexibleCodeComparison(l,p);console.log("Comparaci\xf3n flexible:",q);const ce=O||q;return console.log("Resultado final de validaci\xf3n:",ce),console.log("=== FIN VALIDACI\xd3N ==="),ce}normalizeForComparison(l){return l.replace(/\bvar\b/g,"let").replace(/\s+/g," ").replace(/;\s*}/g," }").replace(/;\s*$/gm,"").replace(/'/g,'"').replace(/\s*([+\-*/%=<>!&|])\s*/g," $1 ").replace(/\s*([{}();,])\s*/g,"$1").trim().toLowerCase()}flexibleCodeComparison(l,p){const d=l.split("\n").map(O=>O.trim()).filter(O=>O.length>0),v=p.split("\n").map(O=>O.trim()).filter(O=>O.length>0);if(d.length!==v.length)return console.log(`Diferente n\xfamero de l\xedneas: generado ${d.length}, esperado ${v.length}`),!1;for(let O=0;O<d.length;O++){const q=this.normalizeCodeLine(d[O]),ce=this.normalizeCodeLine(v[O]);if(q!==ce)return console.log(`L\xednea ${O+1} no coincide:`),console.log("  Generada:",d[O]),console.log("  Esperada:",v[O]),console.log("  Gen normalizada:",q),console.log("  Esp normalizada:",ce),!1}return!0}normalizeCodeLine(l){return l.replace(/\bvar\b/g,"let").replace(/\s+/g," ").replace(/;$/,"").replace(/'/g,'"').replace(/\s*([=!<>]+)\s*/g," $1 ").replace(/\s*([+\-*/%])\s*/g," $1 ").trim().toLowerCase()}setupCallbacks(l){this.workspace&&this.workspace.registerButtonCallback("CREATE_VARIABLE",()=>{console.log("Bot\xf3n crear variable presionado"),l?l.showCreateVariableDialog(p=>{this.createVariable(p)}):dn.createVariableButtonHandler(this.workspace)})}createVariable(l){if(!this.workspace||!l.trim())return null;try{const p=this.workspace.getVariableMap().createVariable(l.trim());return console.log("Variable creada con nueva API:",l),setTimeout(()=>{this.refreshToolbox()},100),p}catch(p){return console.error("Error creando variable:",p),null}}refreshToolbox(){if(this.workspace)try{console.log("Refrescando toolbox con variables actuales...");const l=this.getVariablesToolbox();console.log("Nuevo toolbox XML generado"),this.workspace.updateToolbox(l),console.log("Toolbox actualizado exitosamente");const p=this.workspace.getToolbox();p&&(p.refreshSelection(),console.log("Selecci\xf3n del toolbox refrescada"))}catch(l){console.warn("Error refrescando toolbox:",l),this.fallbackRefresh()}}fallbackRefresh(){try{if(console.log("Intentando fallback refresh..."),this.workspace){const l=this.workspace.getToolbox();l&&l.refreshTheme&&l.refreshTheme(),this.workspace.render()}}catch(l){console.warn("Error en fallback refresh:",l)}}setupCustomDialogs(l){try{if(is&&is.setPrompt)is.setPrompt((p,d,v)=>{p.toLowerCase().includes("variable")||p.toLowerCase().includes("nombre")?l.showCreateVariableDialog(v):v(prompt(p,d))}),is.setConfirm((p,d)=>{if(p.toLowerCase().includes("delete")||p.toLowerCase().includes("eliminar")){const v=this.extractVariableNameFromMessage(p);l.showDeleteVariableDialog(v,()=>d(!0)),l.onCancelDeleteVariable=()=>d(!1)}else{const v=confirm(p);d(v)}});else{const p=window.prompt,d=window.confirm;window.blocklyPrompt=p,window.blocklyConfirm=d,window.prompt=(v,O)=>v&&(v.toLowerCase().includes("variable")||v.toLowerCase().includes("nombre"))?(l.showCreateVariableDialog(q=>{}),null):p(v,O),window.confirm=v=>{if(v&&(v.toLowerCase().includes("delete")||v.toLowerCase().includes("eliminar"))){const O=this.extractVariableNameFromMessage(v);return l.showDeleteVariableDialog(O,()=>{}),!1}return d(v)}}}catch(p){console.warn("No se pudieron configurar los di\xe1logos personalizados:",p)}}extractVariableNameFromMessage(l){const p=l.match(/"([^"]+)"/);return p?p[1]:"variable"}static{this.\u0275fac=function(p){return new(p||g)}}static{this.\u0275prov=o.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"})}}return g})();var pn=le(95);const rs=["blocklyDiv"];function wr(g,x){1&g&&(o.O4$(),o._UZ(0,"path",37))}function gn(g,x){1&g&&(o.O4$(),o._UZ(0,"path",38))}function $n(g,x){1&g&&(o.O4$(),o._UZ(0,"path",39))}function yt(g,x){1&g&&(o.O4$(),o.TgZ(0,"svg",32),o._UZ(1,"path",40),o.qZA())}function xr(g,x){1&g&&(o.O4$(),o.TgZ(0,"svg",41),o._UZ(1,"circle",42)(2,"path",43),o.qZA())}function Ar(g,x){if(1&g){const l=o.EpF();o.TgZ(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"div",6)(5,"div",7)(6,"div",8),o.O4$(),o.TgZ(7,"svg",9),o.YNc(8,wr,1,0,"path",10),o.YNc(9,gn,1,0,"path",11),o.YNc(10,$n,1,0,"path",12),o.qZA()(),o.kcU(),o.TgZ(11,"div",13),o._uU(12),o.qZA()(),o.TgZ(13,"h2",14),o._uU(14),o.qZA()(),o.TgZ(15,"p",15),o._uU(16),o.qZA(),o.TgZ(17,"div",16)(18,"h3",17),o._uU(19,"\u{1f4cb} Instrucciones:"),o.qZA(),o.TgZ(20,"p",18),o._uU(21),o.qZA()(),o._UZ(22,"div",19),o.TgZ(23,"div",20)(24,"button",21),o.NdJ("click",function(){o.CHM(l);const d=o.oxw();return o.KtG(d.onPreviousExercise())}),o.O4$(),o.TgZ(25,"svg",9),o._UZ(26,"path",22),o.qZA()(),o.kcU(),o.TgZ(27,"span",23),o._uU(28),o.qZA(),o.TgZ(29,"button",24),o.NdJ("click",function(){o.CHM(l);const d=o.oxw();return o.KtG(d.onNextExercise())}),o.O4$(),o.TgZ(30,"svg",9),o._UZ(31,"path",25),o.qZA()()()()(),o.kcU(),o.TgZ(32,"div",26)(33,"div",27),o._UZ(34,"div",28,29),o.qZA(),o.TgZ(36,"div",30)(37,"div",7)(38,"button",31),o.NdJ("click",function(){o.CHM(l);const d=o.oxw();return o.KtG(d.resetWorkspace())}),o.O4$(),o.TgZ(39,"svg",32),o._UZ(40,"path",33),o.qZA()(),o.kcU(),o.TgZ(41,"div",13),o._uU(42," Reiniciar "),o.qZA()(),o.TgZ(43,"div",7)(44,"button",34),o.NdJ("click",function(){o.CHM(l);const d=o.oxw();return o.KtG(d.validateSolution())}),o.YNc(45,yt,2,0,"svg",35),o.YNc(46,xr,3,0,"svg",36),o.qZA(),o.TgZ(47,"div",13),o._uU(48," Validar "),o.qZA()()()()()()}if(2&g){const l=o.oxw();o.xp6(6),o.Udp("background-color",l.getDifficultyColor(l.currentExercise.difficulty))("border-color",l.getDifficultyBorderColor(l.currentExercise.difficulty)),o.xp6(2),o.Q6J("ngIf","easy"===l.currentExercise.difficulty),o.xp6(1),o.Q6J("ngIf","medium"===l.currentExercise.difficulty),o.xp6(1),o.Q6J("ngIf","hard"===l.currentExercise.difficulty),o.xp6(2),o.hij(" ",l.getDifficultyText(l.currentExercise.difficulty)," "),o.xp6(2),o.Oqu(l.currentExercise.title),o.xp6(2),o.Oqu(l.currentExercise.description),o.xp6(5),o.Oqu(l.currentExercise.instructions),o.xp6(3),o.Udp("background-color",l.canGoPrevious?"#f3ae22":"")("border-color",l.canGoPrevious?"#d18c00":""),o.ekj("opacity-50",!l.canGoPrevious)("cursor-not-allowed",!l.canGoPrevious),o.Q6J("disabled",!l.canGoPrevious),o.xp6(4),o.AsE(" ",l.currentExerciseIndex+1," de ",l.exercises.length," "),o.xp6(1),o.ekj("opacity-50",!l.canGoNext)("cursor-not-allowed",!l.canGoNext),o.Q6J("disabled",!l.canGoNext),o.xp6(15),o.Q6J("disabled",l.isValidating),o.xp6(1),o.Q6J("ngIf",!l.isValidating),o.xp6(1),o.Q6J("ngIf",l.isValidating)}}function ls(g,x){if(1&g&&(o.TgZ(0,"div",44)(1,"div",45)(2,"div",46),o.O4$(),o.TgZ(3,"svg",47),o._UZ(4,"path",40),o.qZA(),o.kcU(),o.TgZ(5,"div")(6,"p",48),o._uU(7,"\xa1Perfecto!"),o.qZA(),o.TgZ(8,"p",49),o._uU(9),o.qZA()()()()()),2&g){const l=o.oxw();o.xp6(9),o.Oqu(l.currentMessage)}}function Rr(g,x){if(1&g&&(o.TgZ(0,"div",44)(1,"div",50)(2,"div",46),o.O4$(),o.TgZ(3,"svg",47),o._UZ(4,"path",51),o.qZA(),o.kcU(),o.TgZ(5,"div")(6,"p",48),o._uU(7,"Int\xe9ntalo de nuevo"),o.qZA(),o.TgZ(8,"p",49),o._uU(9),o.qZA()()()()()),2&g){const l=o.oxw();o.xp6(9),o.Oqu(l.currentMessage)}}function Or(g,x){if(1&g){const l=o.EpF();o.TgZ(0,"div",44)(1,"div",52)(2,"div",53)(3,"h3",54),o._uU(4,"Crear Nueva Variable"),o.qZA(),o.TgZ(5,"p",55),o._uU(6,"Ingresa el nombre para tu nueva variable"),o.qZA()(),o.TgZ(7,"div",53)(8,"label",56),o._uU(9,"Nombre de la variable"),o.qZA(),o.TgZ(10,"input",57,58),o.NdJ("ngModelChange",function(d){o.CHM(l);const v=o.oxw();return o.KtG(v.newVariableName=d)})("keyup.enter",function(){o.CHM(l);const d=o.oxw();return o.KtG(d.confirmCreateVariable())})("keyup.escape",function(){o.CHM(l);const d=o.oxw();return o.KtG(d.cancelCreateVariable())}),o.qZA()(),o.TgZ(12,"div",59)(13,"button",60),o.NdJ("click",function(){o.CHM(l);const d=o.oxw();return o.KtG(d.cancelCreateVariable())}),o._uU(14," Cancelar "),o.qZA(),o.TgZ(15,"button",61),o.NdJ("click",function(){o.CHM(l);const d=o.oxw();return o.KtG(d.confirmCreateVariable())}),o._uU(16," Crear Variable "),o.qZA()()()()}if(2&g){const l=o.oxw();o.xp6(10),o.Q6J("ngModel",l.newVariableName),o.xp6(5),o.Q6J("disabled",!(null!=l.newVariableName&&l.newVariableName.trim()))}}function Qc(g,x){if(1&g){const l=o.EpF();o.TgZ(0,"div",44)(1,"div",52)(2,"div",53)(3,"h3",54),o._uU(4,"Renombrar Variable"),o.qZA(),o.TgZ(5,"p",55),o._uU(6),o.qZA()(),o.TgZ(7,"div",53)(8,"label",56),o._uU(9,"Nuevo nombre de la variable"),o.qZA(),o.TgZ(10,"input",62,63),o.NdJ("ngModelChange",function(d){o.CHM(l);const v=o.oxw();return o.KtG(v.newVariableName=d)})("keyup.enter",function(){o.CHM(l);const d=o.oxw();return o.KtG(d.confirmRenameVariable())})("keyup.escape",function(){o.CHM(l);const d=o.oxw();return o.KtG(d.cancelRenameVariable())}),o.qZA()(),o.TgZ(12,"div",59)(13,"button",60),o.NdJ("click",function(){o.CHM(l);const d=o.oxw();return o.KtG(d.cancelRenameVariable())}),o._uU(14," Cancelar "),o.qZA(),o.TgZ(15,"button",61),o.NdJ("click",function(){o.CHM(l);const d=o.oxw();return o.KtG(d.confirmRenameVariable())}),o._uU(16," Renombrar "),o.qZA()()()()}if(2&g){const l=o.oxw();o.xp6(6),o.hij('Cambia el nombre de la variable "',l.currentVariableName,'"'),o.xp6(4),o.Q6J("ngModel",l.newVariableName),o.xp6(5),o.Q6J("disabled",!(null!=l.newVariableName&&l.newVariableName.trim()))}}function mn(g,x){if(1&g){const l=o.EpF();o.TgZ(0,"div",44)(1,"div",52)(2,"div",53)(3,"h3",54),o._uU(4,"Eliminar Variable"),o.qZA(),o.TgZ(5,"p",55),o._uU(6),o.qZA(),o.TgZ(7,"p",64),o._uU(8,"Esta acci\xf3n no se puede deshacer"),o.qZA()(),o.TgZ(9,"div",59)(10,"button",60),o.NdJ("click",function(){o.CHM(l);const d=o.oxw();return o.KtG(d.cancelDeleteVariable())}),o._uU(11," Cancelar "),o.qZA(),o.TgZ(12,"button",65),o.NdJ("click",function(){o.CHM(l);const d=o.oxw();return o.KtG(d.confirmDeleteVariable())}),o._uU(13," Eliminar "),o.qZA()()()()}if(2&g){const l=o.oxw();o.xp6(6),o.hij('\xbfEst\xe1s seguro de que quieres eliminar la variable "',l.currentVariableName,'"?')}}let gi=(()=>{class g{constructor(l){this.blocklyService=l,this.exercises=[],this.currentExerciseIndex=0,this.exerciseCompleted=new o.vpe,this.nextExercise=new o.vpe,this.previousExercise=new o.vpe,this.workspace=null,this.showSuccess=!1,this.showError=!1,this.currentMessage="",this.isValidating=!1,this.showCreateVariableModal=!1,this.showRenameVariableModal=!1,this.showDeleteVariableModal=!1,this.newVariableName="",this.currentVariableName="",this.currentVariableCallback=null,this.onCancelDeleteVariable=null}ngOnInit(){}ngAfterViewInit(){setTimeout(()=>{this.initializeBlockly()},100)}ngOnDestroy(){this.blocklyService.dispose()}get currentExercise(){return this.exercises[this.currentExerciseIndex]||null}get canGoPrevious(){return this.currentExerciseIndex>0}get canGoNext(){return this.currentExerciseIndex<this.exercises.length-1}initializeBlockly(){this.blocklyDiv&&this.blocklyDiv.nativeElement&&(this.workspace=this.blocklyService.initializeWorkspace(this.blocklyDiv.nativeElement),this.blocklyService.setupCallbacks(this),this.blocklyService.setupCustomDialogs(this),console.log("Blockly workspace initialized with custom dialogs"),setTimeout(()=>{this.hideBlocklyScrollbars()},100),this.workspace&&this.workspace.addChangeListener(()=>{setTimeout(()=>{this.hideBlocklyScrollbars()},50)}))}hideBlocklyScrollbars(){const l=this.blocklyDiv?.nativeElement;l&&(l.querySelectorAll(".blocklyScrollbarHandle, .blocklyScrollbarBackground, .blocklyScrollbarVertical, .blocklyScrollbarHorizontal").forEach(v=>{v.style.display="none",v.style.visibility="hidden"}),l.querySelectorAll("*").forEach(v=>{v.style.overflow="hidden"}))}validateSolution(){this.currentExercise&&(this.isValidating=!0,this.showSuccess=!1,this.showError=!1,setTimeout(()=>{const l=this.blocklyService.generateCode();console.log("C\xf3digo generado por el usuario:",l),console.log("C\xf3digo esperado:",this.currentExercise.expectedCode);const p=this.blocklyService.validateCode(l,this.currentExercise.expectedCode);console.log("\xbfEs correcto?",p),p?(this.showSuccessMessage(),this.exerciseCompleted.emit({exerciseId:this.currentExercise.id,success:!0})):(this.showErrorMessage(),this.exerciseCompleted.emit({exerciseId:this.currentExercise.id,success:!1})),this.isValidating=!1},1e3))}generateCodeFromBlocks(){return this.blocklyService.generateCode()}compareCode(l,p){return this.blocklyService.validateCode(l,p)}showSuccessMessage(){this.showSuccess=!0,this.currentMessage="\xa1Excelente! Has completado el ejercicio correctamente. \u{1f389}",setTimeout(()=>{this.showSuccess=!1},3e3)}showErrorMessage(){this.showError=!0,this.currentMessage="La soluci\xf3n no es correcta. Revisa las instrucciones e int\xe9ntalo de nuevo. \u{1f4aa}",setTimeout(()=>{this.showError=!1},3e3)}onPreviousExercise(){this.canGoPrevious&&(this.resetWorkspace(),this.previousExercise.emit())}onNextExercise(){this.canGoNext&&(this.resetWorkspace(),this.nextExercise.emit())}resetWorkspace(){this.blocklyService.clearWorkspace(),this.showSuccess=!1,this.showError=!1,this.isValidating=!1,this.showCreateVariableModal=!1,this.showRenameVariableModal=!1,this.showDeleteVariableModal=!1,this.newVariableName="",this.currentVariableName="",this.currentVariableCallback=null,this.onCancelDeleteVariable=null,setTimeout(()=>{this.hideBlocklyScrollbars()},100)}getDifficultyColor(l){switch(l){case"easy":return"#10B981";case"medium":return"#F59E0B";case"hard":return"#EF4444";default:return"#6B7280"}}getDifficultyBorderColor(l){switch(l){case"easy":return"#047857";case"medium":return"#D97706";case"hard":return"#DC2626";default:return"#4B5563"}}getDifficultyText(l){switch(l){case"easy":return"F\xe1cil";case"medium":return"Intermedio";case"hard":return"Dif\xedcil";default:return"Normal"}}showCreateVariableDialog(l){this.currentVariableCallback=l,this.newVariableName="",this.showCreateVariableModal=!0,setTimeout(()=>{document.getElementById("variableNameInput")?.focus()},100)}confirmCreateVariable(){const l=this.newVariableName.trim();console.log("Intentando crear variable:",l),l&&this.currentVariableCallback?(console.log("Ejecutando callback para crear variable"),this.currentVariableCallback(l),setTimeout(()=>{console.log("Variables en workspace despu\xe9s de crear:",this.getWorkspaceVariables())},500),this.cancelCreateVariable()):console.log("No se puede crear variable - nombre vac\xedo o callback nulo")}getWorkspaceVariables(){return this.workspace?this.workspace.getAllVariables().map(l=>l.getName()):[]}cancelCreateVariable(){this.showCreateVariableModal=!1,this.newVariableName="",this.currentVariableCallback=null}showRenameVariableDialog(l,p){this.currentVariableName=l,this.currentVariableCallback=p,this.newVariableName=l,this.showRenameVariableModal=!0,setTimeout(()=>{const d=document.getElementById("renameVariableInput");d?.focus(),d?.select()},100)}confirmRenameVariable(){const l=this.newVariableName.trim();l&&this.currentVariableCallback&&(this.currentVariableCallback(l),this.cancelRenameVariable())}cancelRenameVariable(){this.showRenameVariableModal=!1,this.newVariableName="",this.currentVariableName="",this.currentVariableCallback=null}showDeleteVariableDialog(l,p){this.currentVariableName=l,this.currentVariableCallback=p,this.showDeleteVariableModal=!0}confirmDeleteVariable(){this.currentVariableCallback&&(this.currentVariableCallback(),this.cancelDeleteVariable())}cancelDeleteVariable(){this.showDeleteVariableModal=!1,this.currentVariableName="",this.currentVariableCallback=null,this.onCancelDeleteVariable&&(this.onCancelDeleteVariable(),this.onCancelDeleteVariable=null)}static{this.\u0275fac=function(p){return new(p||g)(o.Y36(Sr))}}static{this.\u0275cmp=o.Xpm({type:g,selectors:[["app-blockly-exercise"]],viewQuery:function(p,d){if(1&p&&o.Gf(rs,5),2&p){let v;o.iGM(v=o.CRH())&&(d.blocklyDiv=v.first)}},inputs:{exercises:"exercises",currentExerciseIndex:"currentExerciseIndex"},outputs:{exerciseCompleted:"exerciseCompleted",nextExercise:"nextExercise",previousExercise:"previousExercise"},decls:6,vars:6,consts:[["class","w-full",4,"ngIf"],["class","fixed inset-0 z-[9999] flex items-center justify-center bg-black bg-opacity-50",4,"ngIf"],[1,"w-full"],[1,"grid","grid-cols-12","gap-6","min-h-[600px]"],[1,"col-span-4","flex","items-center","justify-center","relative"],[1,"px-4","py-3","w-full","max-w-sm"],[1,"flex","items-center","space-x-3","mb-1"],[1,"relative","group"],[1,"w-8","h-8","text-white","rounded-full","shadow-lg","flex","items-center","justify-center","border-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 10V3L4 14h7v7l9-11h-7z",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17.657 18.657A8 8 0 016.343 7.343S7 9 9 10c0-2 .5-5 2.986-7C14 5 16.09 5.777 17.656 7.343A7.975 7.975 0 0120 13a7.975 7.975 0 01-2.343 5.657z",4,"ngIf"],[1,"absolute","left-1/2","transform","-translate-x-1/2","-top-8","bg-gray-800","text-white","text-xs","rounded","py-1","px-2","opacity-0","group-hover:opacity-100","transition-opacity","duration-200","whitespace-nowrap","z-10"],[1,"text-xl","font-bold","text-gray-800"],[1,"text-gray-600","text-sm","mb-2"],[1,"bg-blue-50","border-l-4","border-blue-400","p-2","rounded-r-lg","mb-4"],[1,"font-semibold","text-blue-800","mb-1","text-sm"],[1,"text-blue-700","text-sm"],[1,"border-t","border-gray-200","w-full"],[1,"flex","justify-between","items-center","pt-4"],[1,"w-10","h-10","text-white","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border-2","disabled:bg-gray-400","disabled:border-gray-300","disabled:hover:bg-gray-400",3,"disabled","click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[1,"text-sm","text-green-600","font-bold"],[1,"w-10","h-10","bg-blue-600","hover:bg-blue-700","text-white","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border-2","border-blue-800","disabled:bg-gray-400","disabled:border-gray-300","disabled:hover:bg-gray-400",3,"disabled","click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],[1,"col-span-8","relative"],[1,"overflow-hidden","blockly-container",2,"height","600px","overflow","hidden !important"],["id","blocklyDiv",1,"w-full","h-full","blockly-workspace",2,"margin","0","padding","0","display","block","overflow","hidden !important","scrollbar-width","none","-ms-overflow-style","none"],["blocklyDiv",""],[1,"absolute","bottom-4","left-1/2","transform","-translate-x-1/2","flex","space-x-4","z-10"],[1,"w-12","h-12","text-white","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border-2",2,"background-color","#f3ae22","border-color","#d18c00",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],[1,"w-12","h-12","bg-blue-600","hover:bg-blue-700","disabled:bg-blue-400","text-white","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border-2","border-blue-800",3,"disabled","click"],["class","w-5 h-5","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],["class","w-5 h-5 animate-spin","fill","none","viewBox","0 0 24 24",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 10V3L4 14h7v7l9-11h-7z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17.657 18.657A8 8 0 016.343 7.343S7 9 9 10c0-2 .5-5 2.986-7C14 5 16.09 5.777 17.656 7.343A7.975 7.975 0 0120 13a7.975 7.975 0 01-2.343 5.657z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],["fill","none","viewBox","0 0 24 24",1,"w-5","h-5","animate-spin"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 0 1 8-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 0 1 4 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],[1,"fixed","inset-0","z-[9999]","flex","items-center","justify-center","bg-black","bg-opacity-50"],[1,"bg-green-500","text-white","px-8","py-6","rounded-xl","shadow-2xl","transform","transition-all","duration-500","ease-in-out","max-w-md","mx-4"],[1,"flex","items-center","space-x-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","flex-shrink-0"],[1,"font-bold","text-lg"],[1,"text-sm","opacity-90"],[1,"bg-red-500","text-white","px-8","py-6","rounded-xl","shadow-2xl","transform","transition-all","duration-500","ease-in-out","max-w-md","mx-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"bg-white","px-8","py-6","rounded-xl","shadow-2xl","transform","transition-all","duration-300","ease-in-out","max-w-md","mx-4","w-full"],[1,"mb-6"],[1,"text-xl","font-bold","text-gray-800","mb-2"],[1,"text-gray-600","text-sm"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","variableNameInput","type","text","placeholder","Ej: edad, nombre, contador...",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500","outline-none","transition-colors",3,"ngModel","ngModelChange","keyup.enter","keyup.escape"],["variableNameInput",""],[1,"flex","justify-end","space-x-3"],[1,"px-4","py-2","text-gray-600","hover:text-gray-800","hover:bg-gray-100","rounded-lg","transition-colors",3,"click"],[1,"px-6","py-2","bg-blue-600","hover:bg-blue-700","disabled:bg-gray-300","disabled:cursor-not-allowed","text-white","font-medium","rounded-lg","transition-colors",3,"disabled","click"],["id","renameVariableInput","type","text","placeholder","Nuevo nombre...",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500","outline-none","transition-colors",3,"ngModel","ngModelChange","keyup.enter","keyup.escape"],["renameVariableInput",""],[1,"text-red-600","text-xs","mt-2"],[1,"px-6","py-2","bg-red-600","hover:bg-red-700","text-white","font-medium","rounded-lg","transition-colors",3,"click"]],template:function(p,d){1&p&&(o.YNc(0,Ar,49,30,"div",0),o.YNc(1,ls,10,1,"div",1),o.YNc(2,Rr,10,1,"div",1),o.YNc(3,Or,17,2,"div",1),o.YNc(4,Qc,17,3,"div",1),o.YNc(5,mn,14,1,"div",1)),2&p&&(o.Q6J("ngIf",d.currentExercise),o.xp6(1),o.Q6J("ngIf",d.showSuccess),o.xp6(1),o.Q6J("ngIf",d.showError),o.xp6(1),o.Q6J("ngIf",d.showCreateVariableModal),o.xp6(1),o.Q6J("ngIf",d.showRenameVariableModal),o.xp6(1),o.Q6J("ngIf",d.showDeleteVariableModal))},dependencies:[Z.O5,pn.Fj,pn.JJ,pn.On],styles:['.blockly-exercise-container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto}.exercise-header[_ngcontent-%COMP%]{border-bottom:1px solid #e5e7eb;padding-bottom:1rem}.blockly-workspace-container[_ngcontent-%COMP%]{position:relative}#blocklyDiv[_ngcontent-%COMP%]{position:relative;background-color:#f9fafb;border-radius:0;width:100%;height:500px}.blockly-workspace-container[_ngcontent-%COMP%]   .blocklySvg[_ngcontent-%COMP%]{border-radius:.5rem}.blockly-workspace-container[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{border-radius:.5rem}@keyframes _ngcontent-%COMP%_slideInRight{0%{transform:translate(100%);opacity:0}to{transform:translate(0);opacity:1}}@keyframes _ngcontent-%COMP%_slideOutRight{0%{transform:translate(0);opacity:1}to{transform:translate(100%);opacity:0}}.difficulty-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.05em}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:not(:disabled):hover{transform:translateY(-1px);box-shadow:0 4px 12px #00000026}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{cursor:not-allowed;opacity:.6}@media (max-width: 768px){.blockly-exercise-container[_ngcontent-%COMP%]{margin:0 1rem;padding:1rem}.action-buttons[_ngcontent-%COMP%]{flex-direction:column;gap:1rem}.action-buttons[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center}.exercise-header[_ngcontent-%COMP%]   .flex[_ngcontent-%COMP%]{flex-direction:column;gap:.5rem}}.blockly-workspace-container[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:-2px;background:linear-gradient(45deg,#3b82f6,#8b5cf6,#06b6d4);border-radius:.5rem;z-index:-1;opacity:0;transition:opacity .3s ease}.blockly-workspace-container[_ngcontent-%COMP%]:hover:before{opacity:.1}.instruction-box[_ngcontent-%COMP%]{position:relative;overflow:hidden}.instruction-box[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;right:0;height:2px;background:linear-gradient(90deg,#3b82f6,transparent)}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.animate-spin[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}.blockly-workspace-container[_ngcontent-%COMP%]   div[_ngcontent-%COMP%], .blockly-workspace-container[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%], .blockly-workspace-container[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{overflow:hidden!important;scrollbar-width:none!important;-ms-overflow-style:none!important}.blockly-workspace-container[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]::-webkit-scrollbar, .blockly-workspace-container[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]::-webkit-scrollbar, .blockly-workspace-container[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]::-webkit-scrollbar{display:none!important;width:0!important;height:0!important;background:transparent!important}div[class*=blockly][_ngcontent-%COMP%]{overflow:hidden!important}g[class*=blockly][_ngcontent-%COMP%]{overflow:hidden!important}.blocklyScrollbarHandle[_ngcontent-%COMP%], .blocklyScrollbarBackground[_ngcontent-%COMP%], .blocklyScrollbarVertical[_ngcontent-%COMP%], .blocklyScrollbarHorizontal[_ngcontent-%COMP%]{display:none!important;visibility:hidden!important}']})}}return g})();function ea(g,x){if(1&g){const l=o.EpF();o.TgZ(0,"div",51)(1,"div",52)(2,"div",53)(3,"span",54),o._uU(4),o.qZA(),o.TgZ(5,"h3",55),o._uU(6),o.qZA()(),o.TgZ(7,"p",56),o._uU(8),o.qZA()(),o.TgZ(9,"div",57)(10,"div",58)(11,"p",59),o._uU(12),o.qZA()(),o.TgZ(13,"button",60),o.NdJ("click",function(){const v=o.CHM(l).$implicit,O=o.oxw();return o.KtG(O.openFlowchartModal(v))}),o._uU(14," \u{1f680} Ver Diagrama de Flujo "),o.qZA()()()}if(2&g){const l=x.$implicit;o.xp6(4),o.Oqu(l.icon),o.xp6(2),o.Oqu(l.title),o.xp6(2),o.Oqu(l.description),o.xp6(4),o.Oqu(l.question)}}let ta=(()=>{class g{constructor(l){this.http=l,this.ejemplos=[],this.ejercicios=[],this.currentBlocklyExerciseIndex=0,this.showModal=!1,this.modalTitle="",this.modalComponentType=null,this.modalComponentInputs={}}ngOnInit(){this.cargarEjemplos(),this.cargarEjercicios()}cargarEjemplos(){this.http.get("assets/jsons-base/modulos.json").subscribe({next:l=>{this.ejemplos=l.funciones?.examples||[]},error:l=>{this.ejemplos=[]}})}cargarEjercicios(){this.http.get("assets/jsons-base/blockly-exercises.json").subscribe({next:l=>{this.ejercicios=l.funciones?.exercises||[]},error:l=>{this.ejercicios=[]}})}openFlowchartModal(l){this.modalTitle=`\u{1f9e9} Diagrama de Flujo - ${l.title}`,this.modalComponentType=Lt,this.modalComponentInputs={steps:l.steps||[],title:l.title},this.showModal=!0}closeModal(){this.showModal=!1,this.modalComponentType=null,this.modalComponentInputs={}}onBlocklyExerciseCompleted(l){console.log("Ejercicio completado:",l)}nextBlocklyExercise(){this.currentBlocklyExerciseIndex<this.ejercicios.length-1&&this.currentBlocklyExerciseIndex++}previousBlocklyExercise(){this.currentBlocklyExerciseIndex>0&&this.currentBlocklyExerciseIndex--}static{this.\u0275fac=function(p){return new(p||g)(o.Y36(vt.eN))}}static{this.\u0275cmp=o.Xpm({type:g,selectors:[["app-modularidad"]],decls:225,vars:10,consts:[[1,"text-center","mb-6","mt-6"],[1,"text-3xl","font-bold","text-gray-800","mb-2","drop-shadow-md"],[1,"flex","items-center","justify-center","mb-1"],[1,"h-0.5","bg-gradient-to-r","from-transparent","via-cyan-500","to-transparent","w-96","shadow-sm"],[1,"flex","items-center","justify-center"],[1,"h-px","bg-gradient-to-r","from-transparent","via-gray-300","to-transparent","w-64","opacity-60"],[1,"min-h-screen"],[1,"flex","flex-col","gap-6","p-4","mx-8"],[1,"bg-gray-500/20","backdrop-blur-md","p-6","rounded-lg","border","border-gray-400/30","shadow-lg"],[1,"text-xl","font-bold","mb-3","text-gray-800"],[1,"space-y-6"],[1,"w-full"],[1,"text-gray-700","leading-relaxed","text-justify","text-base",2,"text-align","justify"],[1,"bg-cyan-50","p-3","rounded","border-l-4","border-cyan-400"],[1,"text-cyan-800","text-sm","font-medium","mb-2"],[1,"text-gray-700","text-sm"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4","mb-6"],[1,"p-4","bg-blue-50","rounded-lg","border-l-4","border-blue-400"],[1,"text-lg","font-semibold","text-blue-600","mb-2"],[1,"bg-white","p-3","rounded","border","text-sm"],[1,"list-disc","pl-6","mb-2"],[1,"p-4","bg-teal-50","rounded-lg","border-l-4","border-teal-400"],[1,"text-lg","font-semibold","text-teal-600","mb-2"],[1,"p-4","bg-orange-50","rounded-lg","border-l-4","border-orange-400"],[1,"text-lg","font-semibold","text-orange-600","mb-2"],[1,"p-4","bg-yellow-50","rounded-lg","border-l-4","border-yellow-400"],[1,"text-lg","font-semibold","text-yellow-600","mb-2"],[1,"text-gray-700","mb-2"],[1,"bg-white","p-3","rounded","border","text-sm","space-y-2"],[1,"text-gray-700"],[1,"p-4","bg-indigo-50","rounded-lg","border-l-4","border-indigo-400"],[1,"text-lg","font-semibold","text-indigo-600","mb-2"],[1,"p-4","bg-purple-50","rounded-lg","border-l-4","border-purple-400"],[1,"text-lg","font-semibold","text-purple-600","mb-2"],[1,"text-purple-600","font-semibold"],[1,"p-4","bg-cyan-50","rounded-lg","border-l-4","border-cyan-400"],[1,"text-lg","font-semibold","text-cyan-600","mb-2"],[1,"bg-white","p-3","rounded","border","text-xs","font-mono"],[1,"list-disc","pl-6","mt-2","text-sm"],[1,"p-4","bg-green-50","rounded-lg","border-l-4","border-green-400"],[1,"text-lg","font-semibold","text-green-600","mb-2"],[1,"bg-cyan-100","p-2","rounded","mt-2","text-xs","font-mono"],[1,"text-xl","font-bold","mb-4","text-gray-800"],[1,"text-gray-700","mb-6","text-justify"],[1,"overflow-x-auto"],[1,"flex","gap-6","pb-4",2,"min-width","max-content"],["class","flex-shrink-0 bg-white/80 backdrop-blur-sm rounded-lg p-6 border border-gray-200 shadow-md hover:shadow-lg transition-shadow duration-200 flex flex-col justify-between","style","width: 350px; height: 350px;",4,"ngFor","ngForOf"],[1,"mt-8","p-4","bg-cyan-50","border","border-cyan-200","rounded-lg"],[1,"text-cyan-800","text-sm"],[3,"exercises","exercisecompleted","nextexercise","previousexercise"],[3,"isVisible","title","componentType","componentInputs","onClose"],[1,"flex-shrink-0","bg-white/80","backdrop-blur-sm","rounded-lg","p-6","border","border-gray-200","shadow-md","hover:shadow-lg","transition-shadow","duration-200","flex","flex-col","justify-between",2,"width","350px","height","350px"],[1,"flex-1","flex","flex-col"],[1,"flex","items-center","mb-4"],[1,"text-3xl","mr-3"],[1,"text-lg","font-semibold","text-gray-800","line-clamp-2","leading-tight"],[1,"text-gray-600","text-sm","mb-4","leading-relaxed","line-clamp-4","flex-1"],[1,"mt-auto"],[1,"bg-cyan-50","p-3","rounded-lg","border-l-4","border-cyan-400","mb-4"],[1,"text-cyan-800","text-xs","font-medium","line-clamp-3"],[1,"w-full","bg-cyan-500","hover:bg-cyan-600","text-white","py-3","px-4","rounded","transition-colors","duration-200","text-sm","font-medium","shadow-md","hover:shadow-lg",3,"click"]],template:function(p,d){1&p&&(o.TgZ(0,"div",0)(1,"h1",1),o._uU(2,"\u{1f9e9} M\xf3dulo de Funciones"),o.qZA(),o.TgZ(3,"div",2),o._UZ(4,"div",3),o.qZA(),o.TgZ(5,"div",4),o._UZ(6,"div",5),o.qZA()(),o.TgZ(7,"div",6)(8,"div",7)(9,"div",8)(10,"h2",9),o._uU(11,"\u{1f9e9} \xbfQu\xe9 son las funciones?"),o.qZA(),o.TgZ(12,"div",10)(13,"div",11)(14,"p",12)(15,"strong"),o._uU(16,"Una funci\xf3n"),o.qZA(),o._uU(17," es como una peque\xf1a m\xe1quina que hace una tarea espec\xedfica dentro del programa.\nLe damos un nombre y dentro de ella escribimos los pasos que queremos que siga. En vez de escribir los mismos pasos una y otra vez, ponemos esos pasos dentro de la funci\xf3n y luego, cuando necesitamos que se hagan, simplemente llamamos a la funci\xf3n usando su nombre. Es como cuando grabas un mensaje de voz: lo haces una vez y puedes reproducirlo cada vez que quieras, sin tener que decirlo otra vez. "),o.qZA()(),o.TgZ(18,"div",13)(19,"p",14)(20,"strong"),o._uU(21,"Ejemplo cotidiano:"),o.qZA()(),o.TgZ(22,"p",15),o._uU(23,"Pedir comida por una app: t\xfa env\xedas el pedido (par\xe1metro), la app procesa la orden (instrucciones) y recibes la comida (resultado)."),o.qZA()(),o.TgZ(24,"div",16)(25,"div",17)(26,"h3",18),o._uU(27,"\u2699\ufe0f \xbfC\xf3mo funciona una funci\xf3n?"),o.qZA(),o.TgZ(28,"div",19)(29,"ul",20)(30,"li"),o._uU(31,"Recibe datos de entrada llamados "),o.TgZ(32,"strong"),o._uU(33,"par\xe1metros"),o.qZA(),o._uU(34,"."),o.qZA(),o.TgZ(35,"li"),o._uU(36,"Ejecuta una serie de instrucciones paso a paso."),o.qZA(),o.TgZ(37,"li"),o._uU(38,"Devuelve un resultado final llamado "),o.TgZ(39,"strong"),o._uU(40,"valor de retorno"),o.qZA(),o._uU(41,"."),o.qZA()()()(),o.TgZ(42,"div",21)(43,"h3",22),o._uU(44,"\u{1f5bc}\ufe0f Analog\xeda visual"),o.qZA(),o.TgZ(45,"div",19)(46,"p"),o._uU(47,"Imagina que una funci\xf3n es como una m\xe1quina en una f\xe1brica: le das materia prima (datos), la m\xe1quina sigue un proceso (instrucciones) y te entrega un producto terminado (resultado)."),o.qZA(),o.TgZ(48,"p"),o._uU(49,"Tambi\xe9n puedes pensar en una receta de cocina: ingredientes \u2192 proceso \u2192 platillo."),o.qZA()()(),o.TgZ(50,"div",23)(51,"h3",24),o._uU(52,"\u{1f48e} Importancia de las funciones"),o.qZA(),o.TgZ(53,"div",19)(54,"ul",20)(55,"li"),o._uU(56,"Permiten dividir el c\xf3digo en partes peque\xf1as y manejables."),o.qZA(),o.TgZ(57,"li"),o._uU(58,"Facilitan la reutilizaci\xf3n: puedes usar la misma funci\xf3n en diferentes lugares."),o.qZA(),o.TgZ(59,"li"),o._uU(60,"Ayudan a evitar errores y duplicaci\xf3n de c\xf3digo."),o.qZA(),o.TgZ(61,"li"),o._uU(62,"Mejoran la legibilidad y el mantenimiento de los programas."),o.qZA(),o.TgZ(63,"li"),o._uU(64,"Son la base de la programaci\xf3n modular y estructurada."),o.qZA()()()(),o.TgZ(65,"div",25)(66,"h3",26),o._uU(67,"\u{1f305} Ejemplos en la vida cotidiana"),o.qZA(),o.TgZ(68,"div",19)(69,"p",27)(70,"strong"),o._uU(71,"\u{1f4de} Llamar por tel\xe9fono:"),o.qZA(),o._uU(72," funci\xf3n que recibe el n\xfamero y conecta la llamada."),o.qZA(),o.TgZ(73,"p",27)(74,"strong"),o._uU(75,"\u{1f697} Usar GPS:"),o.qZA(),o._uU(76," funci\xf3n que recibe destino y muestra la ruta. "),o.qZA(),o.TgZ(77,"p",27)(78,"strong"),o._uU(79,"\u{1f9fa} Lavar ropa:"),o.qZA(),o._uU(80," funci\xf3n que recibe ropa sucia y devuelve ropa limpia."),o.qZA(),o.TgZ(81,"p",27)(82,"strong"),o._uU(83,"\u{1f373} Cocinar:"),o.qZA(),o._uU(84," funci\xf3n que recibe ingredientes y devuelve un platillo."),o.qZA()()(),o.TgZ(85,"div",21)(86,"h3",22),o._uU(87,"\u{1f9e0} Curiosidades y met\xe1foras"),o.qZA(),o.TgZ(88,"div",28)(89,"p",29),o._uU(90,"\u2022 Las funciones pueden llamarse a s\xed mismas (recursividad), como una mu\xf1eca rusa. "),o.qZA(),o.TgZ(91,"p",29),o._uU(92,"\u2022 En matem\xe1ticas, una funci\xf3n transforma una entrada en una salida: f(x) = x + 1. "),o.qZA(),o.TgZ(93,"p",29),o._uU(94,"\u2022 En la vida real, una receta de cocina es una funci\xf3n: ingredientes \u2192 platillo. "),o.qZA(),o.TgZ(95,"p",29),o._uU(96,"\u2022 Los videojuegos usan funciones para calcular puntajes, movimientos y efectos."),o.qZA()()(),o.TgZ(97,"div",30)(98,"h3",31),o._uU(99,"\u{1f9ea} Errores y curiosidades"),o.qZA(),o.TgZ(100,"div",28)(101,"p",29),o._uU(102,"\u2022 Olvidar el "),o.TgZ(103,"code"),o._uU(104,"return"),o.qZA(),o._uU(105," puede hacer que la funci\xf3n no devuelva nada."),o.qZA(),o.TgZ(106,"p",29),o._uU(107,"\u2022 Puedes tener funciones dentro de funciones (anidadas)."),o.qZA(),o.TgZ(108,"p",29),o._uU(109,"\u2022 Las funciones pueden recibir cero, uno o muchos par\xe1metros."),o.qZA(),o.TgZ(110,"p",29),o._uU(111,"\u2022 En algunos lenguajes, las funciones pueden devolver m\xe1s de un valor (tuplas, objetos)."),o.qZA()()(),o.TgZ(112,"div",32)(113,"h3",33),o._uU(114,"\u{1f6e0}\ufe0f Elementos clave de una funci\xf3n"),o.qZA(),o.TgZ(115,"div",28)(116,"div")(117,"span",34),o._uU(118,"\u2022 Nombre:"),o.qZA(),o._uU(119," Identificador \xfanico y descriptivo."),o.qZA(),o.TgZ(120,"div")(121,"span",34),o._uU(122,"\u2022 Par\xe1metros:"),o.qZA(),o._uU(123," Datos que recibe para trabajar."),o.qZA(),o.TgZ(124,"div")(125,"span",34),o._uU(126,"\u2022 Instrucciones:"),o.qZA(),o._uU(127," Pasos que ejecuta para cumplir su tarea."),o.qZA(),o.TgZ(128,"div")(129,"span",34),o._uU(130,"\u2022 Valor de retorno:"),o.qZA(),o._uU(131," Resultado que entrega al finalizar."),o.qZA()()(),o.TgZ(132,"div",17)(133,"h3",18),o._uU(134,"\u{1f30e} Comparaci\xf3n con la vida real"),o.qZA(),o.TgZ(135,"div",19)(136,"p",29),o._uU(137,"\u2022 Receta de cocina: funci\xf3n que recibe ingredientes y devuelve un platillo."),o.qZA(),o.TgZ(138,"p",29),o._uU(139,"\u2022 Llamar a un electricista: funci\xf3n que recibe problema y devuelve soluci\xf3n."),o.qZA(),o.TgZ(140,"p",29),o._uU(141,"\u2022 Pedir comida por app: funci\xf3n que recibe pedido y devuelve comida."),o.qZA(),o.TgZ(142,"p",29),o._uU(143,"\u2022 Usar una calculadora: funci\xf3n que recibe n\xfameros y devuelve el resultado."),o.qZA(),o.TgZ(144,"p",29),o._uU(145,"\u2022 Buscar informaci\xf3n en internet: funci\xf3n que recibe una pregunta y devuelve una respuesta."),o.qZA()()(),o.TgZ(146,"div",35)(147,"h3",36),o._uU(148,"\u{1f4cb} Sintaxis general"),o.qZA(),o.TgZ(149,"div",37)(150,"code"),o._uU(151),o._UZ(152,"br"),o._uU(153,"\xa0\xa0// instrucciones"),o._UZ(154,"br"),o._uU(155,"\xa0\xa0return valor;"),o._UZ(156,"br"),o._uU(157),o.qZA()(),o.TgZ(158,"ul",38)(159,"li")(160,"strong"),o._uU(161,"Funciones sin par\xe1metros:"),o.qZA(),o._uU(162," No reciben datos, solo ejecutan instrucciones."),o.qZA(),o.TgZ(163,"li")(164,"strong"),o._uU(165,"Funciones con par\xe1metros:"),o.qZA(),o._uU(166," Reciben uno o m\xe1s datos para trabajar."),o.qZA(),o.TgZ(167,"li")(168,"strong"),o._uU(169,"Funciones que retornan valor:"),o.qZA(),o._uU(170," Devuelven un resultado."),o.qZA(),o.TgZ(171,"li")(172,"strong"),o._uU(173,"Funciones que no retornan valor:"),o.qZA(),o._uU(174," Solo ejecutan acciones."),o.qZA()()(),o.TgZ(175,"div",39)(176,"h3",40),o._uU(177,"\u2705 Buenas pr\xe1cticas y errores comunes"),o.qZA(),o.TgZ(178,"div",19)(179,"ul",20)(180,"li"),o._uU(181,"Usa nombres descriptivos para tus funciones."),o.qZA(),o.TgZ(182,"li"),o._uU(183,"No hagas funciones demasiado largas o con muchas responsabilidades."),o.qZA(),o.TgZ(184,"li"),o._uU(185,"Documenta lo que hace cada funci\xf3n."),o.qZA(),o.TgZ(186,"li"),o._uU(187,"Olvidar el "),o.TgZ(188,"code"),o._uU(189,"return"),o.qZA(),o._uU(190," cuando se espera un resultado."),o.qZA(),o.TgZ(191,"li"),o._uU(192,"Confundir los par\xe1metros con las variables internas."),o.qZA(),o.TgZ(193,"li"),o._uU(194,"Usar nombres poco claros."),o.qZA()(),o.TgZ(195,"div",41)(196,"code"),o._uU(197),o._UZ(198,"br"),o._uU(199,'\xa0\xa0return "Hola, " + nombre + "!";'),o._UZ(200,"br"),o._uU(201),o._UZ(202,"br")(203,"br"),o._uU(204,'let mensaje = saludar("Ana"); // mensaje = "Hola, Ana!"'),o.qZA()()()()()()(),o.TgZ(205,"div",8)(206,"h2",42),o._uU(207,"\u{1f9ea} Ejemplos Din\xe1micos"),o.qZA(),o.TgZ(208,"p",43),o._uU(209," A continuaci\xf3n encontrar\xe1s ejemplos interactivos que demuestran c\xf3mo funcionan las funciones en situaciones cotidianas. Cada ejemplo incluye un diagrama de flujo que puedes visualizar paso a paso. "),o.qZA(),o.TgZ(210,"div",44)(211,"div",45),o.YNc(212,ea,15,4,"div",46),o.qZA()(),o.TgZ(213,"div",47)(214,"p",48)(215,"strong"),o._uU(216,"\u{1f4a1} Consejo:"),o.qZA(),o._uU(217," Las funciones te ayudan a organizar y reutilizar tu c\xf3digo. Observa c\xf3mo cada ejemplo usa diferentes tipos de entrada y salida. "),o.qZA()()(),o.TgZ(218,"div",8)(219,"h2",42),o._uU(220,"\u{1f3af} Ejercicios Pr\xe1cticos"),o.qZA(),o.TgZ(221,"p",43),o._uU(222," Ahora es tu turno de practicar. Estos ejercicios te ayudar\xe1n a dominar las funciones usando programaci\xf3n visual con Blockly. Cada ejercicio te ense\xf1ar\xe1 un concepto espec\xedfico. "),o.qZA(),o.TgZ(223,"app-blockly-exercise",49),o.NdJ("exercisecompleted",function(O){return d.onBlocklyExerciseCompleted(O)})("nextexercise",function(){return d.nextBlocklyExercise()})("previousexercise",function(){return d.previousBlocklyExercise()}),o.qZA()()()(),o.TgZ(224,"app-modal",50),o.NdJ("onClose",function(){return d.closeModal()}),o.qZA()),2&p&&(o.xp6(151),o.hij("function nombreFuncion(par\xe1metros) ","{",""),o.xp6(6),o.Oqu("}"),o.xp6(40),o.hij("function saludar(nombre) ","{",""),o.xp6(4),o.Oqu("}"),o.xp6(11),o.Q6J("ngForOf",d.ejemplos),o.xp6(11),o.Q6J("exercises",d.ejercicios),o.xp6(1),o.Q6J("isVisible",d.showModal)("title",d.modalTitle)("componentType",d.modalComponentType)("componentInputs",d.modalComponentInputs))},dependencies:[Z.sg,gi,so]})}}return g})();function oa(g,x){if(1&g){const l=o.EpF();o.TgZ(0,"div",52)(1,"div",53)(2,"div",54)(3,"span",55),o._uU(4),o.qZA(),o.TgZ(5,"h3",56),o._uU(6),o.qZA()(),o.TgZ(7,"p",57),o._uU(8),o.qZA()(),o.TgZ(9,"div",58)(10,"div",59)(11,"p",60),o._uU(12),o.qZA()(),o.TgZ(13,"button",61),o.NdJ("click",function(){const v=o.CHM(l).$implicit,O=o.oxw();return o.KtG(O.openFlowchartModal(v))}),o._uU(14," \u{1f680} Ver Diagrama de Flujo "),o.qZA()()()}if(2&g){const l=x.$implicit,p=o.oxw();o.xp6(4),o.Oqu(p.getIconForExample(l.title)),o.xp6(2),o.Oqu(p.getCleanTitle(l.title)),o.xp6(2),o.Oqu(l.description),o.xp6(4),o.Oqu(l.question)}}let ia=(()=>{class g{constructor(l){this.http=l,this.examples=[],this.blocklyExercises=[],this.currentBlocklyExerciseIndex=0,this.selectedSection="teoria",this.showModal=!1,this.modalTitle="",this.modalComponentType=null,this.modalComponentInputs={}}ngOnInit(){this.loadExamples(),this.loadBlocklyExercises()}loadExamples(){this.http.get("assets/jsons-base/modulos.json").subscribe({next:l=>{this.examples=l.bucles?.examples||[]},error:l=>{console.error("Error al cargar ejemplos de bucles:",l),this.examples=[]}})}loadBlocklyExercises(){this.http.get("assets/jsons-base/blockly-exercises.json").subscribe({next:l=>{this.blocklyExercises=l.bucles?.exercises||[]},error:l=>{console.error("Error al cargar ejercicios de Blockly:",l),this.blocklyExercises=[]}})}getIconForExample(l){const p=l.toLowerCase(),d={"ejercicio|flexiones|rutina":"\u{1f3c3}\u200d\u2642\ufe0f","lavado|platos|lavar":"\u{1f37d}\ufe0f","contador|numeros|pares":"\u{1f522}","estudiante|calificacion|profesor":"\u{1f4da}","ahorro|dinero|ahorrar":"\ufffd","juego|adivinanza|adivinar":"\u{1f3b2}"};for(const[v,O]of Object.entries(d))if(v.split("|").some(q=>p.includes(q)))return O;return"\u{1f504}"}getCleanTitle(l){return l.replace(/^(Ejemplo|Ejercicio):\s*/i,"")}openFlowchartModal(l){this.modalTitle=`\u{1f504} Diagrama de Flujo - ${this.getCleanTitle(l.title)}`,this.modalComponentType=Lt,this.modalComponentInputs={steps:l.steps||[],title:l.title},this.showModal=!0}closeModal(){this.showModal=!1,this.modalComponentType=null,this.modalComponentInputs={}}onBlocklyExerciseCompleted(l){console.log("Ejercicio completado:",l)}nextBlocklyExercise(){this.currentBlocklyExerciseIndex<this.blocklyExercises.length-1&&this.currentBlocklyExerciseIndex++}previousBlocklyExercise(){this.currentBlocklyExerciseIndex>0&&this.currentBlocklyExerciseIndex--}static{this.\u0275fac=function(p){return new(p||g)(o.Y36(vt.eN))}}static{this.\u0275cmp=o.Xpm({type:g,selectors:[["app-bucles"]],decls:181,vars:7,consts:[[1,"text-center","mb-6","mt-6"],[1,"text-3xl","font-bold","text-gray-800","mb-2","drop-shadow-md"],[1,"flex","items-center","justify-center","mb-1"],[1,"h-0.5","bg-gradient-to-r","from-transparent","via-red-500","to-transparent","w-96","shadow-sm"],[1,"flex","items-center","justify-center"],[1,"h-px","bg-gradient-to-r","from-transparent","via-gray-300","to-transparent","w-64","opacity-60"],[1,"min-h-screen"],[1,"flex","flex-col","gap-6","p-4","mx-8"],[1,"bg-gray-500/20","backdrop-blur-md","p-6","rounded-lg","border","border-gray-400/30","shadow-lg"],[1,"mb-6"],[1,"text-xl","font-bold","mb-3","text-gray-800"],[1,"text-gray-700","leading-relaxed","mb-4","text-justify"],[1,"bg-red-50","p-3","rounded","border-l-4","border-red-400","mb-4"],[1,"text-red-800","text-sm","font-medium","mb-2"],[1,"text-gray-700","text-sm"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"p-4","bg-purple-50","rounded-lg","border-l-4","border-purple-400"],[1,"text-lg","font-semibold","text-purple-600","mb-2"],[1,"bg-white","p-3","rounded","border","text-sm","space-y-2"],[1,"text-purple-600","font-semibold"],[1,"p-4","bg-blue-50","rounded-lg","border-l-4","border-blue-400"],[1,"text-lg","font-semibold","text-blue-600","mb-2"],[1,"text-gray-700","text-justify","mb-3"],[1,"text-md","font-semibold","text-blue-600","mb-2"],[1,"bg-white","p-3","rounded","border","text-sm"],[1,"text-gray-700"],[1,"p-4","bg-green-50","rounded-lg","border-l-4","border-green-400"],[1,"text-lg","font-semibold","text-green-600","mb-2"],[1,"bg-white","p-3","rounded","border","text-sm","space-y-1"],[1,"text-green-600","font-medium"],[1,"p-4","bg-orange-50","rounded-lg","border-l-4","border-orange-400"],[1,"text-lg","font-semibold","text-orange-600","mb-2"],[1,"p-4","bg-teal-50","rounded-lg","border-l-4","border-teal-400"],[1,"text-lg","font-semibold","text-teal-600","mb-2"],[1,"text-teal-600","font-semibold"],[1,"p-4","bg-red-50","rounded-lg","border-l-4","border-red-400"],[1,"text-lg","font-semibold","text-red-600","mb-2"],[1,"p-4","bg-yellow-50","rounded-lg","border-l-4","border-yellow-400"],[1,"text-lg","font-semibold","text-yellow-600","mb-2"],[1,"text-gray-700","mb-2"],[1,"p-4","bg-indigo-50","rounded-lg","border-l-4","border-indigo-400"],[1,"text-lg","font-semibold","text-indigo-600","mb-2"],[1,"text-xl","font-bold","mb-4","text-gray-800"],[1,"text-gray-700","mb-6","text-justify"],[1,"overflow-x-auto"],[1,"flex","gap-6","pb-4",2,"min-width","max-content"],["class","flex-shrink-0 bg-white/80 backdrop-blur-sm rounded-lg p-6 border border-gray-200 shadow-md hover:shadow-lg transition-shadow duration-200 flex flex-col justify-between","style","width: 350px; height: 350px;",4,"ngFor","ngForOf"],[1,"mt-8","p-4","bg-red-50","border","border-red-200","rounded-lg"],[1,"text-red-800","text-sm"],[1,"bg-gray-500/20","backdrop-blur-md","p-6","rounded-lg","border","border-gray-400/35","shadow-lg"],[3,"exercises","currentExerciseIndex","exerciseCompleted","nextExercise","previousExercise"],[3,"isVisible","title","componentType","componentInputs","onClose"],[1,"flex-shrink-0","bg-white/80","backdrop-blur-sm","rounded-lg","p-6","border","border-gray-200","shadow-md","hover:shadow-lg","transition-shadow","duration-200","flex","flex-col","justify-between",2,"width","350px","height","350px"],[1,"flex-1","flex","flex-col"],[1,"flex","items-center","mb-4"],[1,"text-3xl","mr-3"],[1,"text-lg","font-semibold","text-gray-800","line-clamp-2","leading-tight"],[1,"text-gray-600","text-sm","mb-4","leading-relaxed","line-clamp-4","flex-1"],[1,"mt-auto"],[1,"bg-red-50","p-3","rounded-lg","border-l-4","border-red-400","mb-4"],[1,"text-red-800","text-xs","font-medium","line-clamp-3"],[1,"w-full","bg-red-500","hover:bg-red-600","text-white","py-3","px-4","rounded","transition-colors","duration-200","text-sm","font-medium","shadow-md","hover:shadow-lg",3,"click"]],template:function(p,d){1&p&&(o.TgZ(0,"div",0)(1,"h1",1),o._uU(2,"\u{1f504} Estructuras de Control: Bucles"),o.qZA(),o.TgZ(3,"div",2),o._UZ(4,"div",3),o.qZA(),o.TgZ(5,"div",4),o._UZ(6,"div",5),o.qZA()(),o.TgZ(7,"div",6)(8,"div",7)(9,"div",8)(10,"div",9)(11,"h2",10),o._uU(12,"\u{1f501} \xbfQu\xe9 son los bucles o ciclos?"),o.qZA(),o.TgZ(13,"p",11),o._uU(14," Los bucles son estructuras de control que permiten repetir un conjunto de instrucciones m\xfaltiples veces de forma autom\xe1tica, evitando tener que escribir el mismo c\xf3digo una y otra vez. "),o.qZA(),o.TgZ(15,"p",11),o._uU(16," Es como tener un asistente que hace la misma tarea tantas veces como le indiques, o hasta que se cumpla cierta condici\xf3n. "),o.qZA(),o.TgZ(17,"div",12)(18,"p",13)(19,"strong"),o._uU(20,"Ejemplo:"),o.qZA()(),o.TgZ(21,"p",14),o._uU(22,'En lugar de escribir "Imprimir Hola" 100 veces...'),o.qZA(),o.TgZ(23,"p",14),o._uU(24,'Usas un bucle: "Repetir 100 veces: Imprimir Hola"'),o.qZA()()(),o.TgZ(25,"div",9)(26,"div",15)(27,"div",16)(28,"h3",17),o._uU(29,"\u{1f3af} Tipos principales de bucles"),o.qZA(),o.TgZ(30,"div",18)(31,"div")(32,"span",19),o._uU(33,"\u2022 For (Para):"),o.qZA(),o._uU(34,' Se usa cuando sabes exactamente cu\xe1ntas veces quieres repetir algo. Ejemplo: "Haz ejercicio 20 veces".'),o.qZA(),o.TgZ(35,"div")(36,"span",19),o._uU(37,"\u2022 While (Mientras):"),o.qZA(),o._uU(38,' Se repite mientras una condici\xf3n sea verdadera. Ejemplo: "Estudia mientras no entiendas el tema".'),o.qZA(),o.TgZ(39,"div")(40,"span",19),o._uU(41,"\u2022 Do-While (Hacer-Mientras):"),o.qZA(),o._uU(42," Hace algo al menos una vez, luego verifica si debe continuar."),o.qZA()()(),o.TgZ(43,"div",20)(44,"h3",21),o._uU(45,'\u{1f300} \xbfPor qu\xe9 se llaman "bucles"?'),o.qZA(),o.TgZ(46,"p",22),o._uU(47,' Se llaman bucles porque el c\xf3digo "da vueltas" o "se enrolla" como un bucle, volviendo al inicio para repetir las mismas instrucciones una y otra vez. '),o.qZA(),o.TgZ(48,"h4",23),o._uU(49,"\u{1f504} Visualizaci\xf3n"),o.qZA(),o.TgZ(50,"div",24)(51,"p",25),o._uU(52,"Piensa en una pista circular donde un corredor da vueltas:"),o.qZA(),o.TgZ(53,"p",25),o._uU(54,"Vuelta 1 \u2192 Vuelta 2 \u2192 Vuelta 3... hasta completar todas."),o.qZA()()(),o.TgZ(55,"div",26)(56,"h3",27),o._uU(57,"\u{1f3e0} Met\xe1fora: Tareas dom\xe9sticas"),o.qZA(),o.TgZ(58,"p",22),o._uU(59,' Imagina que tu mam\xe1 te dice: "Lava todos los platos sucios" '),o.qZA(),o.TgZ(60,"div",28)(61,"p",25)(62,"strong"),o._uU(63,"Paso 1:"),o.qZA(),o._uU(64," Tomar un plato"),o.qZA(),o.TgZ(65,"p",25)(66,"strong"),o._uU(67,"Paso 2:"),o.qZA(),o._uU(68," Lavarlo con jab\xf3n"),o.qZA(),o.TgZ(69,"p",25)(70,"strong"),o._uU(71,"Paso 3:"),o.qZA(),o._uU(72," Enjuagarlo"),o.qZA(),o.TgZ(73,"p",25)(74,"strong"),o._uU(75,"Paso 4:"),o.qZA(),o._uU(76," \xbfQuedan m\xe1s platos? Si s\xed \u2192 volver al Paso 1"),o.qZA(),o.TgZ(77,"p",29),o._uU(78,"\xa1Eso es exactamente un bucle while!"),o.qZA()()(),o.TgZ(79,"div",30)(80,"h3",31),o._uU(81,"\u26a1 \xbfCu\xe1ndo usar bucles?"),o.qZA(),o.TgZ(82,"p",22),o._uU(83," Los bucles son perfectos cuando necesitas: "),o.qZA(),o.TgZ(84,"div",24),o._uU(85," \u2022 Procesar listas de elementos (estudiantes, productos, etc.)"),o._UZ(86,"br"),o._uU(87," \u2022 Repetir c\xe1lculos matem\xe1ticos"),o._UZ(88,"br"),o._uU(89," \u2022 Validar datos hasta que sean correctos"),o._UZ(90,"br"),o._uU(91," \u2022 Crear patrones o secuencias"),o._UZ(92,"br"),o._uU(93," \u2022 Automatizar tareas repetitivas "),o.qZA()(),o.TgZ(94,"div",32)(95,"h3",33),o._uU(96,"\u{1f527} Elementos de un bucle"),o.qZA(),o.TgZ(97,"div",18)(98,"div")(99,"span",34),o._uU(100,"\u2022 Inicializaci\xf3n:"),o.qZA(),o._uU(101," Preparar variables (contador = 0)"),o.qZA(),o.TgZ(102,"div")(103,"span",34),o._uU(104,"\u2022 Condici\xf3n:"),o.qZA(),o._uU(105," \xbfCu\xe1ndo parar? (contador < 10)"),o.qZA(),o.TgZ(106,"div")(107,"span",34),o._uU(108,"\u2022 Cuerpo:"),o.qZA(),o._uU(109," Qu\xe9 hacer en cada repetici\xf3n"),o.qZA(),o.TgZ(110,"div")(111,"span",34),o._uU(112,"\u2022 Actualizaci\xf3n:"),o.qZA(),o._uU(113," Cambiar variables (contador + 1)"),o.qZA()()(),o.TgZ(114,"div",35)(115,"h3",36),o._uU(116,"\u{1f48e} Importancia de los bucles"),o.qZA(),o.TgZ(117,"p",22),o._uU(118," Los bucles son fundamentales porque: "),o.qZA(),o.TgZ(119,"div",24),o._uU(120," \u2022 Ahorran tiempo y l\xedneas de c\xf3digo"),o._UZ(121,"br"),o._uU(122," \u2022 Reducen errores de escritura repetitiva"),o._UZ(123,"br"),o._uU(124," \u2022 Permiten procesar grandes cantidades de datos"),o._UZ(125,"br"),o._uU(126," \u2022 Hacen el c\xf3digo m\xe1s legible y mantenible"),o._UZ(127,"br"),o._uU(128," \u2022 Son la base de la automatizaci\xf3n "),o.qZA()(),o.TgZ(129,"div",37)(130,"h3",38),o._uU(131,"\u{1f305} Ejemplos en la vida cotidiana"),o.qZA(),o.TgZ(132,"div",24)(133,"p",39)(134,"strong"),o._uU(135,"\u{1f3c3}\u200d\u2642\ufe0f Ejercicio:"),o.qZA(),o._uU(136,' "Haz 20 flexiones"'),o.qZA(),o.TgZ(137,"p",39)(138,"strong"),o._uU(139,"\u{1f4da} Estudiar:"),o.qZA(),o._uU(140,' "Repasa hasta entender el tema"'),o.qZA(),o.TgZ(141,"p",39)(142,"strong"),o._uU(143,"\u{1f373} Cocinar:"),o.qZA(),o._uU(144,' "Revuelve la sopa cada 5 minutos hasta que est\xe9 lista"'),o.qZA(),o.TgZ(145,"p",25)(146,"strong"),o._uU(147,"\u{1f3b5} M\xfasica:"),o.qZA(),o._uU(148,' "Reproduce esta canci\xf3n en modo repetir"'),o.qZA()()(),o.TgZ(149,"div",40)(150,"h3",41),o._uU(151,"\u{1f9ea} Curiosidades sobre bucles"),o.qZA(),o.TgZ(152,"div",18)(153,"p",25),o._uU(154,'\u2022 Un bucle infinito puede "colgar" un programa si no tiene condici\xf3n de parada'),o.qZA(),o.TgZ(155,"p",25),o._uU(156,"\u2022 Los bucles anidados (un bucle dentro de otro) pueden crear patrones complejos"),o.qZA(),o.TgZ(157,"p",25),o._uU(158,'\u2022 En algunos lenguajes, puedes "romper" un bucle con la palabra "break"'),o.qZA(),o.TgZ(159,"p",25),o._uU(160,"\u2022 Los videojuegos usan un bucle principal que se ejecuta 60 veces por segundo"),o.qZA()()()()()(),o.TgZ(161,"div",8)(162,"h2",42),o._uU(163,"\u{1f9ea} Ejemplos Din\xe1micos"),o.qZA(),o.TgZ(164,"p",43),o._uU(165," A continuaci\xf3n encontrar\xe1s ejemplos interactivos que demuestran c\xf3mo funcionan los bucles en situaciones cotidianas. Cada ejemplo incluye un diagrama de flujo que puedes visualizar paso a paso. "),o.qZA(),o.TgZ(166,"div",44)(167,"div",45),o.YNc(168,oa,15,4,"div",46),o.qZA()(),o.TgZ(169,"div",47)(170,"p",48)(171,"strong"),o._uU(172,"\u{1f4a1} Consejo:"),o.qZA(),o._uU(173," Los bucles son herramientas poderosas que automatizan tareas repetitivas. Observa c\xf3mo cada ejemplo usa diferentes tipos de repetici\xf3n seg\xfan la situaci\xf3n. "),o.qZA()()(),o.TgZ(174,"div",49)(175,"h2",42),o._uU(176,"\u{1f3af} Ejercicios Pr\xe1cticos"),o.qZA(),o.TgZ(177,"p",43),o._uU(178," Ahora es tu turno de practicar. Estos ejercicios te ayudar\xe1n a dominar los bucles usando programaci\xf3n visual con Blockly. Cada ejercicio te ense\xf1ar\xe1 un concepto espec\xedfico. "),o.qZA(),o.TgZ(179,"app-blockly-exercise",50),o.NdJ("exerciseCompleted",function(O){return d.onBlocklyExerciseCompleted(O)})("nextExercise",function(){return d.nextBlocklyExercise()})("previousExercise",function(){return d.previousBlocklyExercise()}),o.qZA()()()(),o.TgZ(180,"app-modal",51),o.NdJ("onClose",function(){return d.closeModal()}),o.qZA()),2&p&&(o.xp6(168),o.Q6J("ngForOf",d.examples),o.xp6(11),o.Q6J("exercises",d.blocklyExercises)("currentExerciseIndex",d.currentBlocklyExerciseIndex),o.xp6(1),o.Q6J("isVisible",d.showModal)("title",d.modalTitle)("componentType",d.modalComponentType)("componentInputs",d.modalComponentInputs))},dependencies:[Z.sg,gi,so]})}}return g})();function sa(g,x){if(1&g){const l=o.EpF();o.TgZ(0,"div",51)(1,"div",52)(2,"h3",53)(3,"span",54),o._uU(4),o.qZA(),o._uU(5),o.qZA(),o.TgZ(6,"p",55),o._uU(7),o.qZA()(),o.TgZ(8,"div",56)(9,"p",57),o._uU(10),o.qZA()(),o.TgZ(11,"button",58),o.NdJ("click",function(){const v=o.CHM(l).$implicit,O=o.oxw();return o.KtG(O.openFlowchartModal(v))}),o._uU(12," \u{1f680} Ver Diagrama de Flujo "),o.qZA()()}if(2&g){const l=x.$implicit,p=o.oxw();o.xp6(4),o.Oqu(p.getIconForExample(l.title)),o.xp6(1),o.hij(" ",p.getCleanTitle(l.title)," "),o.xp6(2),o.hij(" ",l.description," "),o.xp6(3),o.Oqu(l.question)}}let $i=(()=>{class g{constructor(l){this.http=l,this.examples=[],this.showModal=!1,this.modalTitle="",this.modalComponentType=null,this.modalComponentInputs={},this.blocklyExercises=[],this.currentBlocklyExerciseIndex=0,this.completedExercises=new Set}ngOnInit(){this.loadExamples(),this.loadBlocklyExercises()}loadExamples(){this.http.get("assets/jsons-base/modulos.json").subscribe({next:l=>{this.examples=l.condicionales.examples||[]},error:l=>{console.error("Error loading examples:",l)}})}loadBlocklyExercises(){this.http.get("assets/jsons-base/blockly-exercises.json").subscribe({next:l=>{l.condicionales&&l.condicionales.exercises&&(this.blocklyExercises=l.condicionales.exercises,console.log("Blockly exercises loaded:",this.blocklyExercises.length))},error:l=>{console.error("Error cargando ejercicios de Blockly:",l)}})}getIconForExample(l){return l.includes("parque")||l.includes("Carlos")?"\u{1f333}":l.includes("tienda")||l.includes("Ana")?"\u{1f457}":l.includes("bicicleta")||l.includes("Luis")?"\u{1f6b4}\u200d\u2642\ufe0f":l.includes("t\xe9")||l.includes("Sof\xeda")?"\u{1f375}":l.includes("reuni\xf3n")||l.includes("Pedro")?"\u{1f4bc}":l.includes("comida")||l.includes("Mariana")?"\u{1f35e}":l.includes("videojuego")||l.includes("Javier")?"\u{1f3ae}":"\u{1f504}"}getCleanTitle(l){return l.replace(/^Ejemplo \d+:\s*/,"")}get currentBlocklyExercise(){return this.blocklyExercises[this.currentBlocklyExerciseIndex]||null}onBlocklyExerciseCompleted(l){l.success&&(this.completedExercises.add(l.exerciseId),console.log("Ejercicio completado:",l.exerciseId))}nextBlocklyExercise(){this.currentBlocklyExerciseIndex<this.blocklyExercises.length-1&&this.currentBlocklyExerciseIndex++}previousBlocklyExercise(){this.currentBlocklyExerciseIndex>0&&this.currentBlocklyExerciseIndex--}openFlowchartModal(l){this.modalTitle=`\u{1f504} Diagrama de Flujo - ${this.getCleanTitle(l.title)}`,this.modalComponentType=Lt,this.modalComponentInputs={steps:l.steps||[],title:l.title},this.showModal=!0}closeModal(){this.showModal=!1,this.modalTitle="",this.modalComponentType=null,this.modalComponentInputs={}}static{this.\u0275fac=function(p){return new(p||g)(o.Y36(vt.eN))}}static{this.\u0275cmp=o.Xpm({type:g,selectors:[["app-condicionales"]],decls:137,vars:7,consts:[[1,"text-center","mb-6","mt-6"],[1,"text-3xl","font-bold","text-gray-800","mb-2","drop-shadow-md"],[1,"flex","items-center","justify-center","mb-1"],[1,"h-0.5","bg-gradient-to-r","from-transparent","via-blue-500","to-transparent","w-96","shadow-sm"],[1,"flex","items-center","justify-center"],[1,"h-px","bg-gradient-to-r","from-transparent","via-gray-300","to-transparent","w-64","opacity-60"],[1,"min-h-screen"],[1,"flex","flex-col","gap-6","p-4","mx-8"],[1,"bg-gray-500/20","backdrop-blur-md","p-6","rounded-lg","border","border-gray-400/30","shadow-lg"],[1,"mb-6"],[1,"text-xl","font-bold","mb-3","text-gray-800"],[1,"text-gray-700","leading-relaxed","mb-4","text-justify"],[1,"bg-blue-50","p-3","rounded","border-l-4","border-blue-400","mb-4"],[1,"text-blue-800","text-sm","font-medium","mb-2"],[1,"text-gray-700","text-sm"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"p-4","bg-teal-50","rounded-lg","border-l-4","border-teal-400"],[1,"text-lg","font-semibold","text-teal-600","mb-2"],[1,"bg-white","p-3","rounded","border","text-sm","space-y-2"],[1,"text-teal-600","font-semibold"],[1,"p-4","bg-blue-50","rounded-lg","border-l-4","border-blue-400"],[1,"text-lg","font-semibold","text-blue-600","mb-2"],[1,"text-gray-700","text-justify","mb-3"],[1,"text-md","font-semibold","text-blue-600","mb-2"],[1,"bg-white","p-3","rounded","border","text-sm"],[1,"text-gray-700","mb-2"],[1,"text-gray-700"],[1,"p-4","bg-purple-50","rounded-lg","border-l-4","border-purple-400"],[1,"text-lg","font-semibold","text-purple-600","mb-2"],[1,"bg-white","p-3","rounded","border","text-sm","space-y-1"],[1,"text-gray-700","mt-2"],[1,"p-4","bg-orange-50","rounded-lg","border-l-4","border-orange-400"],[1,"text-lg","font-semibold","text-orange-600","mb-2"],[1,"p-4","bg-red-50","rounded-lg","border-l-4","border-red-400"],[1,"text-lg","font-semibold","text-red-600","mb-2"],[1,"p-4","bg-indigo-50","rounded-lg","border-l-4","border-indigo-400"],[1,"text-lg","font-semibold","text-indigo-600","mb-2"],[1,"bg-white","p-3","rounded","border","font-mono","text-sm"],[1,"text-blue-600"],[1,"text-red-600"],[1,"text-purple-600"],[1,"text-green-600"],[1,"text-xl","font-bold","mb-4","text-gray-800"],[1,"text-gray-700","mb-6","text-justify"],[1,"overflow-x-auto"],[1,"flex","gap-6","pb-4",2,"min-width","max-content"],["class","bg-white/60 backdrop-blur-sm p-6 rounded-lg shadow-md border border-gray-300/50 flex flex-col flex-shrink-0","style","width: 300px; height: 300px;",4,"ngFor","ngForOf"],[1,"mt-8","p-4","bg-blue-50","border","border-blue-200","rounded-lg"],[1,"text-blue-800","text-sm"],[3,"exercises","currentExerciseIndex","exerciseCompleted","nextExercise","previousExercise"],[3,"isVisible","title","componentType","componentInputs","onClose"],[1,"bg-white/60","backdrop-blur-sm","p-6","rounded-lg","shadow-md","border","border-gray-300/50","flex","flex-col","flex-shrink-0",2,"width","300px","height","300px"],[1,"flex-grow","overflow-hidden"],[1,"font-bold","text-lg","text-gray-800","mb-3","line-clamp-2","flex","items-center"],[1,"text-2xl","mr-2"],[1,"text-sm","text-gray-600","text-justify","mb-4","line-clamp-3"],[1,"mb-4","p-2","bg-blue-50","rounded","border-l-4","border-blue-400"],[1,"text-blue-800","text-xs","font-medium","line-clamp-2"],[1,"w-full","bg-blue-500","hover:bg-blue-600","text-white","py-2","px-4","rounded","transition-colors","duration-200","text-sm","font-medium",3,"click"]],template:function(p,d){1&p&&(o.TgZ(0,"div",0)(1,"h1",1),o._uU(2,"\u{1f500} Estructuras Condicionales"),o.qZA(),o.TgZ(3,"div",2),o._UZ(4,"div",3),o.qZA(),o.TgZ(5,"div",4),o._UZ(6,"div",5),o.qZA()(),o.TgZ(7,"div",6)(8,"div",7)(9,"div",8)(10,"div",9)(11,"h2",10),o._uU(12,"\u{1f9e0} \xbfQu\xe9 es una estructura condicional?"),o.qZA(),o.TgZ(13,"p",11),o._uU(14," En programaci\xf3n, una estructura condicional es una instrucci\xf3n que permite que el programa tome decisiones dependiendo de si una condici\xf3n es verdadera o falsa. "),o.qZA(),o.TgZ(15,"p",11),o._uU(16," Es como si el programa se encontrara con una pregunta y, seg\xfan la respuesta, siguiera un camino u otro. "),o.qZA(),o.TgZ(17,"div",12)(18,"p",13)(19,"strong"),o._uU(20,"Ejemplo:"),o.qZA()(),o.TgZ(21,"p",14),o._uU(22,"Si tienes hambre \u2192 comes."),o.qZA(),o.TgZ(23,"p",14),o._uU(24,"Si no tienes hambre \u2192 no comes."),o.qZA()()(),o.TgZ(25,"div",9)(26,"div",15)(27,"div",16)(28,"h3",17),o._uU(29,"\u{1f527} Elementos fundamentales de una estructura condicional"),o.qZA(),o.TgZ(30,"div",18)(31,"div")(32,"span",19),o._uU(33,"\u2022 Condici\xf3n:"),o.qZA(),o._uU(34," Es una comparaci\xf3n o evaluaci\xf3n que puede dar como resultado verdadero o falso. Ejemplo: edad >= 18 (\xbfEs la edad mayor o igual a 18?)"),o.qZA(),o.TgZ(35,"div")(36,"span",19),o._uU(37,"\u2022 Bloque verdadero:"),o.qZA(),o._uU(38," Son las instrucciones que se ejecutan si la condici\xf3n se cumple (es verdadera)."),o.qZA(),o.TgZ(39,"div")(40,"span",19),o._uU(41,"\u2022 Bloque falso:"),o.qZA(),o._uU(42," Son las instrucciones que se ejecutan si la condici\xf3n no se cumple (es falsa)."),o.qZA(),o.TgZ(43,"div")(44,"span",19),o._uU(45,"\u2022 Camino alternativo:"),o.qZA(),o._uU(46," Algunas estructuras condicionales permiten evaluar m\xe1s de una condici\xf3n con else if o condicionales anidados."),o.qZA()()(),o.TgZ(47,"div",20)(48,"h3",21),o._uU(49,'\u{1f393} \xbfPor qu\xe9 se llaman "condicionales"?'),o.qZA(),o.TgZ(50,"p",22),o._uU(51," Porque la ejecuci\xf3n del c\xf3digo depende de una condici\xf3n que se debe cumplir. Si la condici\xf3n es verdadera, el programa hace una cosa. Si es falsa, hace otra o no hace nada. "),o.qZA(),o.TgZ(52,"h4",23),o._uU(53,"\u{1f4cd} Ejemplo en la vida real"),o.qZA(),o.TgZ(54,"div",24)(55,"p",25),o._uU(56,"Si en el sem\xe1foro hay luz verde \u2192 avanzas."),o.qZA(),o.TgZ(57,"p",26),o._uU(58,"Si no hay luz verde (amarilla o roja) \u2192 te detienes o esperas."),o.qZA()()(),o.TgZ(59,"div",27)(60,"h3",28),o._uU(61,"\u{1f4e6} Met\xe1fora: Camino con bifurcaciones"),o.qZA(),o.TgZ(62,"p",22),o._uU(63," Imagina que vas caminando y llegas a una bifurcaci\xf3n con dos letreros: "),o.qZA(),o.TgZ(64,"div",29)(65,"p",26),o._uU(66,'Uno dice "Si est\xe1 soleado \u2192 sigue por aqu\xed hacia el parque".'),o.qZA(),o.TgZ(67,"p",26),o._uU(68,'Otro dice "Si est\xe1 lloviendo \u2192 sigue por aqu\xed hacia el caf\xe9".'),o.qZA(),o.TgZ(69,"p",30),o._uU(70,"En ese punto, observas el clima (condici\xf3n) y tomas el camino seg\xfan el resultado. El programa hace exactamente lo mismo: eval\xfaa la condici\xf3n y ejecuta la ruta de instrucciones correspondiente."),o.qZA()()(),o.TgZ(71,"div",31)(72,"h3",32),o._uU(73,"\u{1f5a5} \xbfD\xf3nde se usan los condicionales?"),o.qZA(),o.TgZ(74,"p",22),o._uU(75," Los condicionales est\xe1n en casi todo tipo de programa: "),o.qZA(),o.TgZ(76,"div",24),o._uU(77," \u2022 Para verificar permisos de acceso."),o._UZ(78,"br"),o._uU(79," \u2022 Para decidir si un usuario ve cierta informaci\xf3n."),o._UZ(80,"br"),o._uU(81," \u2022 Para ejecutar una acci\xf3n solo si hay datos disponibles."),o._UZ(82,"br"),o._uU(83," \u2022 Para determinar qu\xe9 mensaje mostrar dependiendo de una respuesta."),o._UZ(84,"br"),o._uU(85," \u2022 Para controlar el flujo de un videojuego (ganar, perder, seguir). "),o.qZA()(),o.TgZ(86,"div",33)(87,"h3",34),o._uU(88,"\u{1f9e0} Importancia de las estructuras condicionales"),o.qZA(),o.TgZ(89,"p",22),o._uU(90," Las estructuras condicionales son esenciales porque: "),o.qZA(),o.TgZ(91,"div",24),o._uU(92," \u2022 Permiten adaptar el comportamiento del programa a diferentes situaciones."),o._UZ(93,"br"),o._uU(94," \u2022 Son la base para tomar decisiones complejas."),o._UZ(95,"br"),o._uU(96," \u2022 Combinadas con variables, bucles y funciones, hacen que el programa sea flexible e interactivo. "),o.qZA()(),o.TgZ(97,"div",35)(98,"h3",36),o._uU(99,"\u{1f9ea} Curiosidades"),o.qZA(),o.TgZ(100,"p",22),o._uU(101," Algunos lenguajes permiten condicionales en una sola l\xednea, como en Python: "),o.qZA(),o.TgZ(102,"div",37)(103,"span",38),o._uU(104,"mensaje"),o.qZA(),o._uU(105," = "),o.TgZ(106,"span",39),o._uU(107,'"Mayor de edad"'),o.qZA(),o.TgZ(108,"span",40),o._uU(109,"if"),o.qZA(),o._uU(110," edad >= "),o.TgZ(111,"span",41),o._uU(112,"18"),o.qZA(),o.TgZ(113,"span",40),o._uU(114,"else"),o.qZA(),o.TgZ(115,"span",39),o._uU(116,'"Menor de edad"'),o.qZA()()()()()(),o.TgZ(117,"div",8)(118,"h2",42),o._uU(119,"\u{1f9ea} Ejemplos Din\xe1micos"),o.qZA(),o.TgZ(120,"p",43),o._uU(121," A continuaci\xf3n encontrar\xe1s ejemplos interactivos que demuestran c\xf3mo funcionan las estructuras condicionales en situaciones cotidianas. Cada ejemplo incluye un diagrama de flujo que puedes visualizar paso a paso. "),o.qZA(),o.TgZ(122,"div",44)(123,"div",45),o.YNc(124,sa,13,4,"div",46),o.qZA()(),o.TgZ(125,"div",47)(126,"p",48)(127,"strong"),o._uU(128,"\u{1f4a1} Consejo:"),o.qZA(),o._uU(129," Las estructuras condicionales son la base para crear programas que tomen decisiones inteligentes. Observa c\xf3mo cada ejemplo eval\xfaa una condici\xf3n y toma diferentes caminos seg\xfan el resultado. "),o.qZA()()(),o.TgZ(130,"div",8)(131,"h2",42),o._uU(132,"\u{1f3af} Ejercicios Pr\xe1cticos"),o.qZA(),o.TgZ(133,"p",43),o._uU(134," Ahora es tu turno de practicar. Estos ejercicios te ayudar\xe1n a dominar las estructuras condicionales usando programaci\xf3n visual con Blockly. Cada ejercicio te ense\xf1ar\xe1 un concepto espec\xedfico. "),o.qZA(),o.TgZ(135,"app-blockly-exercise",49),o.NdJ("exerciseCompleted",function(O){return d.onBlocklyExerciseCompleted(O)})("nextExercise",function(){return d.nextBlocklyExercise()})("previousExercise",function(){return d.previousBlocklyExercise()}),o.qZA()()()(),o.TgZ(136,"app-modal",50),o.NdJ("onClose",function(){return d.closeModal()}),o.qZA()),2&p&&(o.xp6(124),o.Q6J("ngForOf",d.examples),o.xp6(11),o.Q6J("exercises",d.blocklyExercises)("currentExerciseIndex",d.currentBlocklyExerciseIndex),o.xp6(1),o.Q6J("isVisible",d.showModal)("title",d.modalTitle)("componentType",d.modalComponentType)("componentInputs",d.modalComponentInputs))},dependencies:[Z.sg,gi,so],styles:[".line-clamp-2[_ngcontent-%COMP%]{display:-webkit-box;-webkit-line-clamp:2;line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}.line-clamp-3[_ngcontent-%COMP%]{display:-webkit-box;-webkit-line-clamp:3;line-clamp:3;-webkit-box-orient:vertical;overflow:hidden}.bg-white\\/60[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 16px #00000026;transition:all .2s ease-in-out}"]})}}return g})();const Mr=["flowchartRef"];function Nr(g,x){1&g&&(o.TgZ(0,"h2",62),o._uU(1,"\u{1f4a1} Ejemplos Din\xe1micos"),o.qZA())}function cs(g,x){1&g&&(o.TgZ(0,"h2",62),o._uU(1,"\u{1f3af} Ejercicios de Pr\xe1ctica"),o.qZA())}function Lr(g,x){if(1&g){const l=o.EpF();o.TgZ(0,"div",18)(1,"h4",72),o._uU(2),o.qZA(),o.TgZ(3,"p",73),o._uU(4),o.qZA(),o.TgZ(5,"div",74)(6,"p",75),o._uU(7),o.qZA()(),o.TgZ(8,"div",76)(9,"button",77),o.NdJ("click",function(){o.CHM(l);const d=o.oxw(2);return o.KtG(d.previousExample())}),o.O4$(),o.TgZ(10,"svg",78),o._UZ(11,"path",79),o.qZA()(),o.kcU(),o.TgZ(12,"span",80),o._uU(13),o.qZA(),o.TgZ(14,"button",81),o.NdJ("click",function(){o.CHM(l);const d=o.oxw(2);return o.KtG(d.nextExample())}),o.O4$(),o.TgZ(15,"svg",78),o._UZ(16,"path",82),o.qZA()()()()}if(2&g){const l=o.oxw(2);o.xp6(2),o.Oqu(l.currentExample.title),o.xp6(2),o.Oqu(l.currentExample.description),o.xp6(3),o.Oqu(l.currentExample.question),o.xp6(2),o.Udp("background-color",l.canGoPreviousExample?"#f3ae22":"")("border-color",l.canGoPreviousExample?"#d18c00":""),o.ekj("opacity-50",!l.canGoPreviousExample)("cursor-not-allowed",!l.canGoPreviousExample),o.Q6J("disabled",!l.canGoPreviousExample),o.xp6(4),o.AsE(" ",l.currentExampleIndex+1," de ",l.examples.length," "),o.xp6(1),o.ekj("opacity-50",!l.canGoNextExample)("cursor-not-allowed",!l.canGoNextExample),o.Q6J("disabled",!l.canGoNextExample)}}function na(g,x){1&g&&(o.TgZ(0,"div",83)(1,"p"),o._uU(2,"Cargando ejemplos..."),o.qZA()())}function ra(g,x){if(1&g&&(o.TgZ(0,"div",84),o._UZ(1,"app-flowchart",85,86),o.qZA()),2&g){const l=o.oxw(2);o.xp6(1),o.Q6J("steps",l.currentExampleSteps)("title",l.currentExample.title)}}function Dr(g,x){1&g&&(o.TgZ(0,"div",87)(1,"p",88),o._uU(2,"Selecciona un ejemplo para ver su diagrama de flujo"),o.qZA()())}function Br(g,x){1&g&&(o.TgZ(0,"div",87)(1,"p",88),o._uU(2,"No hay pasos disponibles para este ejemplo"),o.qZA()())}function Vt(g,x){if(1&g&&(o.TgZ(0,"div",63)(1,"div",64)(2,"div",65),o.YNc(3,Lr,17,19,"div",66),o.YNc(4,na,3,0,"div",67),o.qZA(),o.TgZ(5,"div",68)(6,"h3",69),o._uU(7,"\u{1f504} Paso a Paso"),o.qZA(),o.YNc(8,ra,3,2,"div",70),o.YNc(9,Dr,3,0,"div",71),o.YNc(10,Br,3,0,"div",71),o.qZA()()()),2&g){const l=o.oxw();o.xp6(3),o.Q6J("ngIf",l.currentExample),o.xp6(1),o.Q6J("ngIf",!l.currentExample),o.xp6(4),o.Q6J("ngIf",l.currentExample&&l.currentExampleSteps.length>0),o.xp6(1),o.Q6J("ngIf",!l.currentExample),o.xp6(1),o.Q6J("ngIf",l.currentExample&&0===l.currentExampleSteps.length)}}function Pr(g,x){if(1&g){const l=o.EpF();o.TgZ(0,"div",63)(1,"app-blockly-exercise",89),o.NdJ("exerciseCompleted",function(d){o.CHM(l);const v=o.oxw();return o.KtG(v.onExerciseCompleted(d))})("nextExercise",function(){o.CHM(l);const d=o.oxw();return o.KtG(d.onNextBlocklyExercise())})("previousExercise",function(){o.CHM(l);const d=o.oxw();return o.KtG(d.onPreviousBlocklyExercise())}),o.qZA()()}if(2&g){const l=o.oxw();o.xp6(1),o.Q6J("exercises",l.blocklyExercises)("currentExerciseIndex",l.currentBlocklyExerciseIndex)}}function Fr(g,x){1&g&&(o.TgZ(0,"div",90)(1,"div",91),o._uU(2,"\u{1f3af}"),o.qZA(),o.TgZ(3,"h2",92),o._uU(4,"Selecciona una opci\xf3n"),o.qZA(),o.TgZ(5,"p",93),o._uU(6,"Elige entre ejemplos o ejercicios para comenzar"),o.qZA()())}let la=(()=>{class g{constructor(l){this.http=l,this.activeSection=null,this.examples=[],this.currentExampleIndex=0,this.currentExample=null,this.blocklyExercises=[],this.currentBlocklyExerciseIndex=0,this.completedExercises=new Set}ngOnInit(){this.loadExamples(),this.loadBlocklyExercises()}loadExamples(){this.http.get("assets/jsons-base/modulos.json").subscribe({next:l=>{this.examples=l.variables.examples,this.currentExample=this.examples[0],console.log("Variables examples loaded:",this.examples.length)},error:l=>{console.error("Error cargando ejemplos de variables:",l)}})}loadBlocklyExercises(){this.http.get("assets/jsons-base/blockly-exercises.json").subscribe({next:l=>{l.variables&&l.variables.exercises&&(this.blocklyExercises=l.variables.exercises,console.log("Blockly exercises loaded:",this.blocklyExercises.length))},error:l=>{console.error("Error cargando ejercicios de Blockly:",l)}})}showExamples(){this.activeSection="examples"}showPractice(){this.activeSection="practice"}previousExample(){this.currentExampleIndex>0&&(this.currentExampleIndex--,this.currentExample=this.examples[this.currentExampleIndex],this.resetFlowchart())}nextExample(){this.currentExampleIndex<this.examples.length-1&&(this.currentExampleIndex++,this.currentExample=this.examples[this.currentExampleIndex],this.resetFlowchart())}resetFlowchart(){setTimeout(()=>{this.flowchartComponent&&this.flowchartComponent.resetSteps()},0)}get canGoPreviousExample(){return this.currentExampleIndex>0}get canGoNextExample(){return this.currentExampleIndex<this.examples.length-1}get currentExampleSteps(){return this.currentExample?.steps||[]}onExerciseCompleted(l){l.success&&(this.completedExercises.add(l.exerciseId),console.log("Ejercicio completado:",l.exerciseId))}onNextBlocklyExercise(){this.currentBlocklyExerciseIndex++}onPreviousBlocklyExercise(){this.currentBlocklyExerciseIndex>0&&this.currentBlocklyExerciseIndex--}static{this.\u0275fac=function(p){return new(p||g)(o.Y36(vt.eN))}}static{this.\u0275cmp=o.Xpm({type:g,selectors:[["app-concepto-variables"]],viewQuery:function(p,d){if(1&p&&o.Gf(Mr,5),2&p){let v;o.iGM(v=o.CRH())&&(d.flowchartComponent=v.first)}},decls:190,vars:29,consts:[[1,"text-center","mb-8","mt-6"],[1,"text-3xl","font-bold","text-gray-800","mb-2","drop-shadow-md"],[1,"flex","items-center","justify-center","mb-1"],[1,"h-0.5","bg-gradient-to-r","from-transparent","via-blue-500","to-transparent","w-96","shadow-sm"],[1,"flex","items-center","justify-center"],[1,"h-px","bg-gradient-to-r","from-transparent","via-gray-300","to-transparent","w-64","opacity-60"],[1,"min-h-screen"],[1,"flex","flex-col","gap-6","p-4","mx-8"],[1,"bg-gray-500/20","backdrop-blur-md","p-6","rounded-lg","border","border-gray-400/30","shadow-lg"],[1,"mb-6"],[1,"text-xl","font-bold","mb-3","text-gray-800"],[1,"text-gray-700","leading-relaxed","mb-4","text-justify"],[1,"p-4","bg-teal-50","rounded-lg","border-l-4","border-teal-400"],[1,"text-lg","font-semibold","text-teal-600","mb-2"],[1,"text-gray-700","text-justify","mb-3"],[1,"bg-white","p-3","rounded","border","text-sm","space-y-2"],[1,"text-teal-600","font-semibold"],[1,"text-xl","font-bold","mb-5","text-gray-800"],[1,"space-y-4"],[1,"p-4","bg-blue-50","rounded-lg","border-l-4","border-blue-400"],[1,"text-lg","font-semibold","text-blue-600","mb-2"],[1,"bg-white","p-3","rounded","border","font-mono","text-sm"],[1,"text-blue-600"],[1,"text-green-600"],[1,"text-gray-500"],[1,"p-4","bg-green-50","rounded-lg","border-l-4","border-green-400"],[1,"text-lg","font-semibold","text-green-600","mb-2"],[1,"bg-white","p-3","rounded","border","text-sm"],[1,"p-4","bg-yellow-50","rounded-lg","border-l-4","border-yellow-400"],[1,"text-lg","font-semibold","text-yellow-600","mb-2"],[1,"bg-white","p-3","rounded","border","overflow-x-auto"],[1,"w-full","text-sm"],[1,"bg-gray-50"],[1,"px-3","py-2","text-left","font-semibold","text-gray-700","border-b"],[1,"border-b"],[1,"px-3","py-2","font-mono","text-blue-600"],[1,"px-3","py-2","text-gray-700"],[1,"px-3","py-2","font-mono","text-red-600"],[1,"px-3","py-2","font-mono","text-green-600"],[1,"px-3","py-2","font-mono","text-orange-600"],[1,"px-3","py-2","font-mono","text-indigo-600"],[1,"p-4","bg-purple-50","rounded-lg","border-l-4","border-purple-400"],[1,"text-lg","font-semibold","text-purple-600","mb-2"],[1,"p-4","bg-red-50","rounded-lg","border-l-4","border-red-400"],[1,"text-lg","font-semibold","text-red-600","mb-2"],[1,"p-4","bg-indigo-50","rounded-lg","border-l-4","border-indigo-400"],[1,"text-lg","font-semibold","text-indigo-600","mb-2"],[1,"text-purple-600"],[1,"text-red-600"],["class","text-xl font-bold text-gray-800",4,"ngIf"],[1,"flex","min-h-[600px]","items-center"],[1,"flex","flex-col","items-center","justify-center","space-y-4","mr-6"],[1,"relative","group"],[1,"w-14","h-14","text-white","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border-2",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"],[1,"absolute","left-16","top-1/2","transform","-translate-y-1/2","bg-gray-800","text-white","text-xs","rounded","py-1","px-2","opacity-0","group-hover:opacity-100","transition-opacity","duration-200","whitespace-nowrap","z-10"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"],[1,"flex-1","flex","items-center","justify-center"],["class","w-full",4,"ngIf"],["class","text-center w-full",4,"ngIf"],[1,"pb-8"],[1,"text-xl","font-bold","text-gray-800"],[1,"w-full"],[1,"grid","grid-cols-2","gap-4","w-full","items-center"],[1,"min-h-[400px]","flex","flex-col","justify-center"],["class","space-y-4",4,"ngIf"],["class","text-center text-gray-500",4,"ngIf"],[1,"min-h-[400px]"],[1,"text-lg","font-semibold","text-gray-800","mb-4"],["class","min-h-[350px]",4,"ngIf"],["class","text-center text-gray-500 mt-8",4,"ngIf"],[1,"text-base","font-semibold","text-blue-600"],[1,"text-gray-700","text-justify","leading-relaxed","text-sm"],[1,"bg-blue-50","p-3","rounded-lg","border-l-4","border-blue-400"],[1,"text-blue-800","font-medium","text-sm"],[1,"flex","justify-between","items-center","pt-4","border-t","border-gray-200"],[1,"w-10","h-10","text-white","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border-2","disabled:bg-gray-400","disabled:border-gray-300","disabled:hover:bg-gray-400",3,"disabled","click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[1,"text-sm","text-green-600","font-bold"],[1,"w-10","h-10","bg-blue-600","hover:bg-blue-700","text-white","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border-2","border-blue-800","disabled:bg-gray-400","disabled:border-gray-300","disabled:hover:bg-gray-400",3,"disabled","click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],[1,"text-center","text-gray-500"],[1,"min-h-[350px]"],[3,"steps","title"],["flowchartRef",""],[1,"text-center","text-gray-500","mt-8"],[1,"text-sm"],[3,"exercises","currentExerciseIndex","exerciseCompleted","nextExercise","previousExercise"],[1,"text-center","w-full"],[1,"text-6xl","mb-4"],[1,"text-xl","font-bold","mb-2","text-gray-800"],[1,"text-gray-600"]],template:function(p,d){1&p&&(o.TgZ(0,"div",0)(1,"h1",1),o._uU(2,"\u{1f4e6} Concepto de Variables"),o.qZA(),o.TgZ(3,"div",2),o._UZ(4,"div",3),o.qZA(),o.TgZ(5,"div",4),o._UZ(6,"div",5),o.qZA()(),o.TgZ(7,"div",6)(8,"div",7)(9,"div",8)(10,"div",9)(11,"h2",10),o._uU(12,"\u{1f9e0} \xbfQu\xe9 es una variable?"),o.qZA(),o.TgZ(13,"p",11),o._uU(14," En programaci\xf3n, una variable es un espacio de memoria reservado para guardar datos que pueden cambiar durante la ejecuci\xf3n de un programa. Estos datos pueden ser n\xfameros, textos, im\xe1genes, sonidos, valores booleanos (verdadero/falso), entre otros. "),o.qZA(),o.TgZ(15,"div",12)(16,"h3",13),o._uU(17,"\u{1f527} Elementos fundamentales de una variable"),o.qZA(),o.TgZ(18,"p",14),o._uU(19," Una variable tiene tres elementos fundamentales: "),o.qZA(),o.TgZ(20,"div",15)(21,"div")(22,"span",16),o._uU(23,"\u2022 Nombre:"),o.qZA(),o._uU(24," Es el identificador \xfanico de la variable. Como una etiqueta que permite acceder a su contenido."),o.qZA(),o.TgZ(25,"div")(26,"span",16),o._uU(27,"\u2022 Tipo de dato:"),o.qZA(),o._uU(28," Define el tipo de informaci\xf3n que la variable puede almacenar. Ejemplos: entero, texto, decimal, imagen."),o.qZA(),o.TgZ(29,"div")(30,"span",16),o._uU(31,"\u2022 Valor:"),o.qZA(),o._uU(32," Es el contenido actual que guarda la variable."),o.qZA()()()(),o.TgZ(33,"div",9)(34,"h2",17),o._uU(35,'\u{1f393} \xbfPor qu\xe9 se llaman "variables"?'),o.qZA(),o.TgZ(36,"div",18)(37,"div",19)(38,"h3",20),o._uU(39,"\u{1f504} Porque su valor puede cambiar"),o.qZA(),o.TgZ(40,"p",14),o._uU(41," Por ejemplo, si declaras una variable llamada edad, podr\xedas modificar su valor as\xed: "),o.qZA(),o.TgZ(42,"div",21)(43,"span",22),o._uU(44,"edad"),o.qZA(),o._uU(45," = "),o.TgZ(46,"span",23),o._uU(47,"15"),o.qZA(),o._UZ(48,"br"),o.TgZ(49,"span",24),o._uU(50,"# M\xe1s tarde en el programa..."),o.qZA(),o._UZ(51,"br"),o.TgZ(52,"span",22),o._uU(53,"edad"),o.qZA(),o._uU(54," = "),o.TgZ(55,"span",23),o._uU(56,"16"),o.qZA()()(),o.TgZ(57,"div",25)(58,"h3",26),o._uU(59,"\u{1f4e6} Met\xe1fora: Caja con etiqueta"),o.qZA(),o.TgZ(60,"p",14),o._uU(61,' Imagina que tienes una caja con una etiqueta que dice "Nombre". Dentro puedes guardar un papel que diga "Camila". '),o.qZA(),o.TgZ(62,"div",27)(63,"span",23),o._uU(64,"La caja"),o.qZA(),o._uU(65," = la variable"),o._UZ(66,"br"),o.TgZ(67,"span",23),o._uU(68,"La etiqueta"),o.qZA(),o._uU(69," = el nombre"),o._UZ(70,"br"),o.TgZ(71,"span",23),o._uU(72,"El papel dentro"),o.qZA(),o._uU(73," = el valor "),o.qZA()(),o.TgZ(74,"div",28)(75,"h3",29),o._uU(76,"\u{1f9fe} Ejemplo con distintos tipos de variables"),o.qZA(),o.TgZ(77,"div",30)(78,"table",31)(79,"thead",32)(80,"tr")(81,"th",33),o._uU(82,"Variable"),o.qZA(),o.TgZ(83,"th",33),o._uU(84,"Tipo"),o.qZA(),o.TgZ(85,"th",33),o._uU(86,"Valor"),o.qZA()()(),o.TgZ(87,"tbody")(88,"tr",34)(89,"td",35),o._uU(90,"nombre"),o.qZA(),o.TgZ(91,"td",36),o._uU(92,"Texto"),o.qZA(),o.TgZ(93,"td",37),o._uU(94,'"Luc\xeda"'),o.qZA()(),o.TgZ(95,"tr",34)(96,"td",35),o._uU(97,"edad"),o.qZA(),o.TgZ(98,"td",36),o._uU(99,"N\xfamero"),o.qZA(),o.TgZ(100,"td",38),o._uU(101,"21"),o.qZA()(),o.TgZ(102,"tr",34)(103,"td",35),o._uU(104,"altura"),o.qZA(),o.TgZ(105,"td",36),o._uU(106,"Decimal"),o.qZA(),o.TgZ(107,"td",39),o._uU(108,"1.65"),o.qZA()(),o.TgZ(109,"tr")(110,"td",35),o._uU(111,"esEstudiante"),o.qZA(),o.TgZ(112,"td",36),o._uU(113,"Booleano"),o.qZA(),o.TgZ(114,"td",40),o._uU(115,"true"),o.qZA()()()()()(),o.TgZ(116,"div",41)(117,"h3",42),o._uU(118,"\u{1f5a5} \xbfD\xf3nde se usan las variables?"),o.qZA(),o.TgZ(119,"p",14),o._uU(120," Las variables se usan en casi todo dentro de un programa: "),o.qZA(),o.TgZ(121,"div",27),o._uU(122," \u2022 Para mostrar informaci\xf3n al usuario"),o._UZ(123,"br"),o._uU(124," \u2022 Para hacer c\xe1lculos"),o._UZ(125,"br"),o._uU(126," \u2022 Para guardar respuestas del usuario"),o._UZ(127,"br"),o._uU(128," \u2022 Para controlar decisiones"),o._UZ(129,"br"),o._uU(130," \u2022 Para contar cosas (ej: puntuaci\xf3n) "),o.qZA()(),o.TgZ(131,"div",43)(132,"h3",44),o._uU(133,"\u{1f9e0} Importancia de las variables"),o.qZA(),o.TgZ(134,"p",14),o._uU(135," Son fundamentales en cualquier lenguaje. Son la base para trabajar con: "),o.qZA(),o.TgZ(136,"div",27),o._uU(137," \u2022 Condiciones (if)"),o._UZ(138,"br"),o._uU(139," \u2022 Repeticiones (for, while)"),o._UZ(140,"br"),o._uU(141," \u2022 Funciones"),o._UZ(142,"br"),o._uU(143," \u2022 Entrada y salida de datos "),o.qZA()(),o.TgZ(144,"div",45)(145,"h3",46),o._uU(146,"\u{1f9ea} Curiosidades"),o.qZA(),o.TgZ(147,"p",14),o._uU(148," En Python no necesitas indicar el tipo (din\xe1mico). En Java/C++ s\xed (est\xe1tico): "),o.qZA(),o.TgZ(149,"div",21)(150,"span",47),o._uU(151,"int "),o.qZA(),o.TgZ(152,"span",22),o._uU(153,"edad"),o.qZA(),o._uU(154," = "),o.TgZ(155,"span",23),o._uU(156,"20"),o.qZA(),o._uU(157,";"),o._UZ(158,"br"),o.TgZ(159,"span",47),o._uU(160,"String "),o.qZA(),o.TgZ(161,"span",22),o._uU(162,"nombre"),o.qZA(),o._uU(163," = "),o.TgZ(164,"span",48),o._uU(165,'"Ana"'),o.qZA(),o._uU(166,"; "),o.qZA()()()()(),o.TgZ(167,"div",8)(168,"div",9),o.YNc(169,Nr,2,0,"h2",49),o.YNc(170,cs,2,0,"h2",49),o.qZA(),o.TgZ(171,"div",50)(172,"div",51)(173,"div",52)(174,"button",53),o.NdJ("click",function(){return d.showExamples()}),o.O4$(),o.TgZ(175,"svg",54),o._UZ(176,"path",55),o.qZA()(),o.kcU(),o.TgZ(177,"div",56),o._uU(178," Ejemplos "),o.qZA()(),o.TgZ(179,"div",52)(180,"button",53),o.NdJ("click",function(){return d.showPractice()}),o.O4$(),o.TgZ(181,"svg",54),o._UZ(182,"path",57),o.qZA()(),o.kcU(),o.TgZ(183,"div",56),o._uU(184," Ejercicios "),o.qZA()()(),o.TgZ(185,"div",58),o.YNc(186,Vt,11,5,"div",59),o.YNc(187,Pr,2,2,"div",59),o.YNc(188,Fr,7,0,"div",60),o.qZA()()()(),o._UZ(189,"div",61),o.qZA()),2&p&&(o.xp6(169),o.Q6J("ngIf","examples"===d.activeSection),o.xp6(1),o.Q6J("ngIf","practice"===d.activeSection),o.xp6(4),o.ekj("bg-green-600","examples"===d.activeSection)("bg-blue-600","examples"!==d.activeSection)("hover:bg-green-700","examples"===d.activeSection)("hover:bg-blue-700","examples"!==d.activeSection)("border-green-800","examples"===d.activeSection)("border-blue-800","examples"!==d.activeSection),o.xp6(6),o.Udp("background-color","practice"!==d.activeSection?"#f3ae22":"")("border-color","practice"!==d.activeSection?"#d18c00":""),o.ekj("bg-green-600","practice"===d.activeSection)("hover:bg-green-700","practice"===d.activeSection)("hover:bg-yellow-600","practice"!==d.activeSection)("border-green-800","practice"===d.activeSection),o.xp6(6),o.Q6J("ngIf","examples"===d.activeSection),o.xp6(1),o.Q6J("ngIf","practice"===d.activeSection),o.xp6(1),o.Q6J("ngIf",!d.activeSection))},dependencies:[Z.O5,Lt,gi]})}}return g})();const ca=["flowchartRef"];function aa(g,x){if(1&g&&(o.TgZ(0,"div",24)(1,"h3",25),o._uU(2),o.qZA(),o.TgZ(3,"p",26),o._uU(4),o.qZA()()),2&g){const l=x.$implicit;o.Udp("border-left-color",l.color),o.xp6(2),o.Oqu(l.title),o.xp6(2),o.Oqu(l.description)}}function ua(g,x){if(1&g){const l=o.EpF();o.TgZ(0,"div",27)(1,"h3",28),o._uU(2),o.qZA(),o.TgZ(3,"p",29),o._uU(4),o.qZA(),o.TgZ(5,"div",30)(6,"p",31),o._uU(7),o.qZA()(),o.TgZ(8,"div",32)(9,"button",33),o.NdJ("click",function(){o.CHM(l);const d=o.oxw();return o.KtG(d.previousExample())}),o.O4$(),o.TgZ(10,"svg",34),o._UZ(11,"path",35),o.qZA()(),o.kcU(),o.TgZ(12,"span",36),o._uU(13),o.qZA(),o.TgZ(14,"button",37),o.NdJ("click",function(){o.CHM(l);const d=o.oxw();return o.KtG(d.nextExample())}),o.O4$(),o.TgZ(15,"svg",34),o._UZ(16,"path",38),o.qZA()()()()}if(2&g){const l=o.oxw();o.xp6(2),o.Oqu(l.currentExample.title),o.xp6(2),o.Oqu(l.currentExample.description),o.xp6(3),o.Oqu(l.currentExample.question),o.xp6(2),o.Udp("background-color",l.canGoPreviousExample?"#f3ae22":"")("border-color",l.canGoPreviousExample?"#d18c00":""),o.ekj("opacity-50",!l.canGoPreviousExample)("cursor-not-allowed",!l.canGoPreviousExample),o.Q6J("disabled",!l.canGoPreviousExample),o.xp6(4),o.AsE(" ",l.currentExampleIndex+1," de ",l.examples.length," "),o.xp6(1),o.ekj("opacity-50",!l.canGoNextExample)("cursor-not-allowed",!l.canGoNextExample),o.Q6J("disabled",!l.canGoNextExample)}}function Ur(g,x){1&g&&(o.TgZ(0,"div",39)(1,"p"),o._uU(2,"Cargando ejemplos..."),o.qZA()())}function da(g,x){if(1&g&&(o.TgZ(0,"div",40),o._UZ(1,"app-flowchart",41,42),o.qZA()),2&g){const l=o.oxw();o.xp6(1),o.Q6J("steps",l.currentExampleSteps)("title",l.currentExample.title)}}function Hr(g,x){1&g&&(o.TgZ(0,"div",43)(1,"p"),o._uU(2,"Selecciona un ejemplo de la secci\xf3n anterior para ver su diagrama de flujo"),o.qZA()())}function ha(g,x){1&g&&(o.TgZ(0,"div",43)(1,"p"),o._uU(2,"No hay pasos disponibles para este ejemplo"),o.qZA()())}const as=[{path:"",children:[{path:"inicio",component:Ae},{path:"introduccion",component:(()=>{class g{constructor(l){this.http=l,this.moduleCards=[],this.allModules=[],this.currentModuleIndex=0,this.examples=[],this.currentExampleIndex=0,this.currentExample=null}ngOnInit(){this.loadModules(),this.loadExamples()}loadModules(){this.http.get("assets/jsons-base/start-page.json").subscribe({next:l=>{this.allModules=l.cards,this.moduleCards=l.cards.filter((p,d)=>0!==d),this.currentModuleIndex=0,console.log("Modules loaded:",this.allModules.length,"Current index:",this.currentModuleIndex)},error:l=>{console.error("Error cargando m\xf3dulos:",l)}})}loadExamples(){this.http.get("assets/jsons-base/modulos.json").subscribe({next:l=>{this.examples=l.introduccion.examples,this.currentExample=this.examples[0],console.log("Examples loaded:",this.examples.length)},error:l=>{console.error("Error cargando ejemplos:",l)}})}previousExample(){this.currentExampleIndex>0&&(this.currentExampleIndex--,this.currentExample=this.examples[this.currentExampleIndex],this.resetFlowchart())}nextExample(){this.currentExampleIndex<this.examples.length-1&&(this.currentExampleIndex++,this.currentExample=this.examples[this.currentExampleIndex],this.resetFlowchart())}resetFlowchart(){setTimeout(()=>{this.flowchartComponent&&this.flowchartComponent.resetSteps()},0)}get canGoPreviousExample(){return this.currentExampleIndex>0}get canGoNextExample(){return this.currentExampleIndex<this.examples.length-1}get currentExampleSteps(){return this.currentExample?.steps||[]}get flowchartTitle(){return this.currentExample?`Diagrama de Flujo: ${this.currentExample.title}`:""}static{this.\u0275fac=function(p){return new(p||g)(o.Y36(vt.eN))}}static{this.\u0275cmp=o.Xpm({type:g,selectors:[["app-introduccion"]],viewQuery:function(p,d){if(1&p&&o.Gf(ca,5),2&p){let v;o.iGM(v=o.CRH())&&(d.flowchartComponent=v.first)}},decls:45,vars:6,consts:[[1,"text-center","mb-6","mt-6"],[1,"text-3xl","font-bold","text-gray-800","mb-2","drop-shadow-md"],[1,"flex","items-center","justify-center","mb-1"],[1,"h-0.5","bg-gradient-to-r","from-transparent","via-blue-500","to-transparent","w-96","shadow-sm"],[1,"flex","items-center","justify-center"],[1,"h-px","bg-gradient-to-r","from-transparent","via-gray-300","to-transparent","w-64","opacity-60"],[1,"min-h-screen"],[1,"flex","flex-col","gap-6","p-4","mx-8"],[1,"bg-gray-500/20","backdrop-blur-md","p-6","rounded-lg","border","border-gray-400/30","shadow-lg"],[1,"mb-6"],[1,"text-xl","font-bold","mb-3","text-gray-800"],[1,"text-gray-700","leading-relaxed","mb-4","text-justify"],[1,"list-disc","list-inside","text-gray-700","space-y-2","text-justify"],[1,"text-xl","font-bold","mb-4","text-gray-800"],[1,"space-y-3"],["class","p-3 bg-white/70 rounded-md border-l-4 shadow-lg",3,"border-left-color",4,"ngFor","ngForOf"],[1,"grid","grid-cols-2","gap-6"],[1,"bg-gray-500/20","backdrop-blur-md","p-6","rounded-lg","border","border-gray-400/30","shadow-lg","flex","flex-col"],[1,"text-xl","font-bold","mb-5"],["class","flex-1 flex flex-col justify-center space-y-4",4,"ngIf"],["class","flex-1 flex items-center justify-center text-gray-500",4,"ngIf"],["class","min-h-[400px]",4,"ngIf"],["class","text-center text-gray-500 mt-8",4,"ngIf"],[1,"pb-8"],[1,"p-3","bg-white/70","rounded-md","border-l-4","shadow-lg"],[1,"font-bold","text-gray-800"],[1,"text-sm","text-gray-600","text-justify"],[1,"flex-1","flex","flex-col","justify-center","space-y-4"],[1,"text-lg","font-semibold","text-blue-600"],[1,"text-gray-700","text-justify","leading-relaxed"],[1,"bg-blue-50","p-4","rounded-lg","border-l-4","border-blue-400"],[1,"text-blue-800","font-medium"],[1,"flex","justify-between","items-center","mt-6","pt-4","border-t","border-gray-200"],[1,"w-12","h-12","text-white","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border-2","disabled:bg-gray-400","disabled:border-gray-300","disabled:hover:bg-gray-400",3,"disabled","click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[1,"text-sm","text-green-600","font-bold"],[1,"w-12","h-12","bg-blue-600","hover:bg-blue-700","text-white","rounded-full","shadow-lg","hover:shadow-xl","transition-all","duration-300","ease-in-out","flex","items-center","justify-center","border-2","border-blue-800","disabled:bg-gray-400","disabled:border-gray-300","disabled:hover:bg-gray-400",3,"disabled","click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],[1,"flex-1","flex","items-center","justify-center","text-gray-500"],[1,"min-h-[400px]"],[3,"steps","title"],["flowchartRef",""],[1,"text-center","text-gray-500","mt-8"]],template:function(p,d){1&p&&(o.TgZ(0,"div",0)(1,"h1",1),o._uU(2,"\u{1f4d8} Introducci\xf3n a la L\xf3gica de Programaci\xf3n"),o.qZA(),o.TgZ(3,"div",2),o._UZ(4,"div",3),o.qZA(),o.TgZ(5,"div",4),o._UZ(6,"div",5),o.qZA()(),o.TgZ(7,"div",6)(8,"div",7)(9,"div",8)(10,"div",9)(11,"h2",10),o._uU(12,"\u{1f9e0} \xbfQu\xe9 es la L\xf3gica de Programaci\xf3n?"),o.qZA(),o.TgZ(13,"p",11),o._uU(14," La l\xf3gica de programaci\xf3n es el conjunto de principios, reglas y procesos mentales que se utilizan para resolver problemas mediante instrucciones precisas y ordenadas que una computadora puede entender. Es el fundamento sobre el cual se construyen los programas inform\xe1ticos. "),o.qZA()(),o.TgZ(15,"div",9)(16,"h2",10),o._uU(17,"\u{1f9e9} \xbfPor qu\xe9 es importante aprender l\xf3gica de programaci\xf3n?"),o.qZA(),o.TgZ(18,"ul",12)(19,"li"),o._uU(20,"Permite pensar de forma estructurada y ordenada."),o.qZA(),o.TgZ(21,"li"),o._uU(22,"Facilita el an\xe1lisis y resoluci\xf3n de problemas."),o.qZA(),o.TgZ(23,"li"),o._uU(24,"Es esencial para aprender cualquier lenguaje de programaci\xf3n."),o.qZA(),o.TgZ(25,"li"),o._uU(26,"Desarrolla el pensamiento algor\xedtmico: pensar paso a paso como una m\xe1quina."),o.qZA()()(),o.TgZ(27,"div")(28,"h2",13),o._uU(29,"\u{1f504} Conceptos Fundamentales y M\xf3dulos del Aplicativo"),o.qZA(),o.TgZ(30,"div",14),o.YNc(31,aa,5,4,"div",15),o.qZA()()(),o.TgZ(32,"div",16)(33,"div",17)(34,"h2",18),o._uU(35,"\u{1f373} Ejemplos Pr\xe1cticos de Pensamiento Algor\xedtmico"),o.qZA(),o.YNc(36,ua,17,19,"div",19),o.YNc(37,Ur,3,0,"div",20),o.qZA(),o.TgZ(38,"div",8)(39,"h2",13),o._uU(40,"\u{1f504} Diagrama de Flujo"),o.qZA(),o.YNc(41,da,3,2,"div",21),o.YNc(42,Hr,3,0,"div",22),o.YNc(43,ha,3,0,"div",22),o.qZA()()(),o._UZ(44,"div",23),o.qZA()),2&p&&(o.xp6(31),o.Q6J("ngForOf",d.moduleCards),o.xp6(5),o.Q6J("ngIf",d.currentExample),o.xp6(1),o.Q6J("ngIf",!d.currentExample),o.xp6(4),o.Q6J("ngIf",d.currentExample&&d.currentExampleSteps.length>0),o.xp6(1),o.Q6J("ngIf",!d.currentExample),o.xp6(1),o.Q6J("ngIf",d.currentExample&&0===d.currentExampleSteps.length))},dependencies:[Z.sg,Z.O5,Lt]})}}return g})()},{path:"concepto-variables",component:la},{path:"condicionales",component:$i},{path:"bucles",component:ia},{path:"modularidad",component:ta},{path:"abstraccion",component:Xs},{path:"pensamiento-logico",component:Mt},{path:"toma-de-decisiones",component:vo},{path:"solucion-creativa",component:qe},{path:"**",redirectTo:"inicio"}]}];let _n=(()=>{class g{static{this.\u0275fac=function(p){return new(p||g)}}static{this.\u0275mod=o.oAB({type:g})}static{this.\u0275inj=o.cJS({imports:[Be.Bz.forChild(as),Z.ez,Be.Bz]})}}return g})();var bn=le(2773),Mo=le(6208);let Vr=(()=>{class g{static{this.\u0275fac=function(p){return new(p||g)}}static{this.\u0275mod=o.oAB({type:g})}static{this.\u0275inj=o.cJS({imports:[Z.ez,_n,bn.W,Mo.m]})}}return g})()},7519:function(Qo,oo){var le,Be;void 0!==(Be="function"==typeof(le=function(){var U,u,et,ei,ti,tt,Tt,io,xe,so,it,Ae,Ie,no,oi,L,qe,K,Eo,ot,Et,vo,ze,Te,ro,lo,Mt,vt,Nt,Zi,Us,Hs,Vs,ii,Wi,si,Gs,Zs,Ws,yo,ni,qs,zs,js,Co,Xs,Ys,Ks,ke,B,Js,ri,qi,li,ci,se,Ve,Io,zi,P,Lt,I,A,ji,X,Xi,J,c,h,_,T,w,pe,Dt,ir,ai,Qs,Bt,ko,Yi,_c,bc,st,en,Ki,Xu,So,tn,sr,wo,on,Yu,nr,Ku,sn,nt,Pt,fc,nn,Ju,Tc,Ft,xo,Ec,vc,yc,Cc,rn,rr,Ic,kc,Sc,Ji,Qu,Qi,ed,lr,td,ln,cr,od,ar,id,ur,wc,xc,dr,hr,pr,cn,sd,ui,an,gr,nd,rd,ld,Ut,Ee,es,Ac,Ht,Ao,cd,Rc,$r,Oc,ad,Mc,un,ud,mr,dd,_r,hd,pd,gd,di,Nc,br,Re,fr,Lc,dn,Tr,$d,Dc,Bc,md,Er,hi,vr,_d,Pc,Fc,bd,fd,pi,Td,hn,ts,os,rt,Ed,vd,is,yd,Cd,Id,kd,Uc,Ro,ss,Hc,Sd,Vc,wd,xd,Ad,Rd,Od,Md,Nd,Gc,Ld,Oo,yr,Dd,ns,Cr,Zc,Wc,Ir,kr,qc,Bd,zc,jc,Xc,Yc,Kc,Jc,Sr,pn,rs,wr,gn,$n,yt,xr,Ar,ls,Rr,Or,Qc,mn,gi,ea,ta,oa,ia,sa,$i,Mr,Nr,cs,Lr,na,ra,Dr,Br,Vt,Pr,Fr,la,ca,aa,ua,Ur,da,Hr,ha,mi,as,_n,bn,Mo,Vr,g,x,l,p,d,v,O,q,ce,Ct,_i,je,Gt,No,Lo,us,fn,ds,co,bi,fi,It,hs,Ti,Gr,Zr,Ei,Wr,Tn,vi,yi,qr,kt,En,Do,zr,jr,ao,vn,ht,Xr,Yr,St,pa,uo,yn,Kr,Jr,ps,Qr,el,Ci,tl,ol,gs,Cn,il,In,pt,sl,kn,Bo,nl,Sn,$s,rl,wn,ll,cl,Po,xn,ms,al,ul,dl,hl,D,Pe,Se,ae,gt,lt,M,he,pl,Fo,Zt,_s,wt,bs,An,fs,Rn,gl,ho,$l,ml,_l,Uo,On,bl,Mn,Xe,Nn,Ho,H,V,Oe,Pd,Dg,Vo,fl,Tl,Fd,Bg,Ud,Pg,ga,Hd,Vd,Gd,Fg,Zd,Ug,El,Wd,qd,vl,Hg,zd,yl,Cl,Il,$a,jd,Vg,Xd,Gg,ma,_a,Zg,ba,Wg,Yd,qg,Ii,Kd,Ln,Jd,Qd,fa,eh,th,oh,ih,sh,nh,rh,lh,ch,zg,jg,ah,Xg,Yg,Kg,Jg,Qg,uh,dh,hh,ph,gh,$h,mh,Ta,kl,_h,e$,bh,fh,Th,Eh,vh,yh,Ch,Ih,kh,Sh,t$,o$,i$,wh,xh,Ah,Rh,s$,y,o={};U=function(e,t,i,s){if(!(e instanceof k)&&"string"!=typeof e||""===`${e}`.trim())throw Error('Invalid type "'+e+'". The type must be a non-empty string or a Blockly.registry.Type.');if(e=`${e}`.toLowerCase(),"string"!=typeof t||""===t.trim())throw Error('Invalid name "'+t+'". The name must be a non-empty string.');const n=t.toLowerCase();if(!i)throw Error("Can not register a null value");let r=ki[e],a=Ea[e];if(r||(r=ki[e]=Object.create(null),a=Ea[e]=Object.create(null)),u(e,i),!s&&r[n]&&r[n]!==i)throw Error('Name "'+n+'" with type "'+e+'" already registered.');r[n]=i,a[n]=t},u=function(e,t){if(e===String(k.FIELD)&&"function"!=typeof t.fromJson)throw Error('Type "'+e+'" must have a fromJson function')},et=function(e,t){e=`${e}`.toLowerCase(),t=t.toLowerCase();const i=ki[e];i&&i[t]?(delete ki[e][t],delete Ea[e][t]):console.warn("Unable to unregister ["+t+"]["+e+"] from the registry.")},ei=function(e,t,i){e=`${e}`.toLowerCase(),t=t.toLowerCase();const s=ki[e];if(!s||!s[t]){if(t="Unable to find ["+t+"]["+e+"] in the registry.",i)throw Error(t+" You must require or register a "+e+" plugin.");return console.warn(t),null}return s[t]},ti=function(e,t){return e=`${e}`.toLowerCase(),t=t.toLowerCase(),!!(e=ki[e])&&!!e[t]},tt=function(e,t,i){return ei(e,t,i)},Tt=function(e,t,i){return ei(e,t,i)},io=function(e,t,i){e=`${e}`.toLowerCase();var s=ki[e];if(!s){if(s=`Unable to find [${e}] in the registry.`,i)throw Error(`${s} You must require or register a ${e} plugin.`);return console.warn(s),null}if(!t)return s;e=Ea[e],i=Object.create(null);for(const n of Object.keys(s))i[e[n]]=s[n];return i},xe=function(e,t,i){return"function"==typeof(t=t.plugins[String(e)]||ct)?t:tt(e,t,i)},so=function(e,t){it(),ya=setTimeout(function(){t&&t.handleRightClick(e)},E_)},it=function(){ya&&(clearTimeout(ya),ya=0)},Ae=function(){va=null},Ie=function(e){return!e.type.startsWith("pointer")||e instanceof PointerEvent&&oi(e)},no=function(e){return`${e.pointerId}`},oi=function(e){const t=no(e);return va?va===t:"pointerdown"===e.type&&(va=t,!0)},L=function(e,t,i,s,n){function r($){(n||Ie($))&&(i?s.call(i,$):s($))}const a=[];if(t in Ts)for(let $=0;$<Ts[t].length;$++){const C=Ts[t][$];e.addEventListener(C,r,!1),a.push([e,C,r])}else e.addEventListener(t,r,!1),a.push([e,t,r]);return a},qe=function(e,t,i,s){function n(a){i?s.call(i,a):s(a)}const r=[];if(t in Ts)for(let a=0;a<Ts[t].length;a++){const $=Ts[t][a];e.addEventListener($,n,!1),r.push([e,$,n])}else e.addEventListener(t,n,!1),r.push([e,t,n]);return r},K=function(e){const t=e[e.length-1][2];for(;e.length;){const[i,s,n]=e.pop();i.removeEventListener(s,n,!1)}return t},Eo=function(e){if(e.target instanceof HTMLElement){if(e.target.isContentEditable||"true"===e.target.getAttribute("data-is-text-input"))return!0;if(e.target instanceof HTMLInputElement)return"text"===(e=e.target).type||"number"===e.type||"email"===e.type||"password"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type;if(e.target instanceof HTMLTextAreaElement)return!0}return!1},ot=function(e){return!(!e.ctrlKey||!Lh)||2===e.button},Et=function(e,t,i){const s=t.createSVGPoint();return s.x=e.clientX,s.y=e.clientY,i||(i=t.getScreenCTM().inverse()),s.matrixTransform(i)},vo=function(e){switch(e.deltaMode){default:return{x:e.deltaX,y:e.deltaY};case 1:return{x:e.deltaX*_$,y:e.deltaY*_$};case 2:return{x:e.deltaX*b$,y:e.deltaY*b$}}},ze=function(){return"blockly-"+(I_++).toString(36)},Te=function(){return Bh.genUid()},ro=function(e){return e.type===b.BLOCK_CREATE},lo=function(e){return e.type===b.BLOCK_DELETE},Mt=function(e){return e.type===b.BLOCK_CHANGE},vt=function(e){return e.type===b.BLOCK_FIELD_INTERMEDIATE_CHANGE},Nt=function(e){return e.type===b.BLOCK_MOVE},Zi=function(e){return e.type===b.VAR_CREATE},Us=function(e){return e.type===b.VAR_DELETE},Hs=function(e){return e.type===b.VAR_RENAME},Vs=function(e){return e.type===b.BLOCK_DRAG},ii=function(e){return e.type===b.SELECTED},Wi=function(e){return e.type===b.CLICK},si=function(e){return e.type===b.BUBBLE_OPEN},Gs=function(e){return e.type===b.TRASHCAN_OPEN},Zs=function(e){return e.type===b.TOOLBOX_ITEM_SELECT},Ws=function(e){return e.type===b.THEME_CHANGE},yo=function(e){return e.type===b.VIEWPORT_CHANGE},ni=function(e){return e.type===b.COMMENT_CREATE},qs=function(e){return e.type===b.COMMENT_DELETE},zs=function(e){return e.type===b.COMMENT_CHANGE},js=function(e){return e.type===b.COMMENT_MOVE},Co=function(e){return e.type===b.COMMENT_RESIZE},Xs=function(e){return e.type===b.COMMENT_DRAG},Ys=function(e){return e.type===b.COMMENT_COLLAPSE},Ks=function(e){return e.type===b.FINISHED_LOADING},o.setRecordUndo$$module$build$src$core$events$utils=function(e){Sl=e},ke=function(){return Sl},B=function(e){Hh.fireInternal(e)},Js=function(e){if(se()){if(!Wo.length)try{requestAnimationFrame(()=>{setTimeout(ri,0)})}catch{setTimeout(ri,0)}qi(e)}},ri=function(){const e=li(Wo);Wo.length=0;for(const t of e){if(!t.workspaceId)continue;let i;null==(i=ko(t.workspaceId))||i.fireChangeListener(t)}},qi=function(e){if(Mt(e)&&"mutation"===e.element){let t;for(t=Wo.length;t>0;t--){const i=Wo[t-1];if(i.group!==e.group||i.workspaceId!==e.workspaceId||!Nt(i)||i.newParentId!==e.blockId)break}Wo.splice(t,0,e)}else Wo.push(e)},li=function(e){const t=[];for(const i of e)if(e=t[t.length-1],!i.isNull())if(e&&e.workspaceId===i.workspaceId&&e.group===i.group)if(Nt(i)&&Nt(e)&&i.blockId===e.blockId){if(e.newParentId=i.newParentId,e.newInputName=i.newInputName,e.newCoordinate=i.newCoordinate,e.reason||i.reason){let s,n;e.reason=Array.from(new Set((null!=(s=e.reason)?s:[]).concat(null!=(n=i.reason)?n:[])))}}else Mt(i)&&Mt(e)&&i.blockId===e.blockId&&i.element===e.element&&i.name===e.name?e.newValue=i.newValue:yo(i)&&yo(e)?(e.viewTop=i.viewTop,e.viewLeft=i.viewLeft,e.scale=i.scale,e.oldScale=i.oldScale):Wi(i)&&si(e)||t.push(i);else t.push(i);return t.filter(i=>!i.isNull())},ci=function(){for(let t,e=0;t=Wo[e];e++)t.recordUndo=!1},o.disable$$module$build$src$core$events$utils=function(){Fh++},o.enable$$module$build$src$core$events$utils=function(){Fh--},se=function(){return 0===Fh},o.getGroup$$module$build$src$core$events$utils=function(){return T$},o.setGroup$$module$build$src$core$events$utils=function(e){Hh.setGroupInternal(e)},Ve=function(e){T$="boolean"==typeof e?e?Te():"":e},Io=function(e){const t=[];e=e.getDescendants(!1);for(let s,i=0;s=e[i];i++)t[i]=s.id;return t},zi=function(e,t){const i=P(e.type);if(!i)throw Error("Unknown event type.");return i.fromJson(e,t)},P=function(e){const t=tt(k.EVENT,e);if(!t)throw Error(`Event type ${e} not found in registry.`);return t},Lt=function(e){if((Nt(e)||ro(e))&&e.workspaceId){var t=ko(e.workspaceId);if(!e.blockId)throw Error("Encountered a blockEvent without a proper blockId");if(e=t.getBlockById(e.blockId)){const i=Sl;try{Sl=!1;const s=e.getParent();if(s&&!s.hasDisabledReason(Uh)){const n=e.getDescendants(!1);for(let a,r=0;a=n[r];r++)a.setDisabledReason(!1,Uh)}else if((e.outputConnection||e.previousConnection)&&!t.isDragging())do{e.setDisabledReason(!0,Uh),e=e.getNextBlock()}while(e)}finally{Sl=i}}}},I=function(e,t,i){e=document.createElementNS(wl,`${e}`);for(const s in t)e.setAttribute(s,`${t[s]}`);return i&&i.appendChild(e),e},A=function(e,t){return!(t=t.split(" ")).every(i=>e.classList.contains(i))&&(e.classList.add(...t),!0)},ji=function(e,t){e.classList.remove(...t.split(" "))},X=function(e,t){return!(t=t.split(" ")).every(i=>!e.classList.contains(i))&&(e.classList.remove(...t),!0)},Xi=function(e,t){return e.classList.contains(t)},J=function(e){return e&&e.parentNode?e.parentNode.removeChild(e):null},c=function(e,t){const i=t.nextSibling;if(!(t=t.parentNode))throw Error("Reference node has no parent.");i?t.insertBefore(e,i):t.appendChild(e)},h=function(e,t){e.style.transform=t,e.style["-webkit-transform"]=t},_=function(){Vh++,Wt||(Wt=Object.create(null))},T=function(){--Vh||(Wt=null)},w=function(e){const t=e.textContent+"\n"+e.className.baseVal;var i;return Wt&&(i=Wt[t])||(i=window.getComputedStyle(e),i=Dt(e,i.fontSize,i.fontWeight,i.fontFamily),Wt&&(Wt[t]=i)),i},pe=function(e,t,i,s){return Dt(e,t+"pt",i,s)},Dt=function(e,t,i,s){const n=e.textContent;var r;return e=n+"\n"+e.className.baseVal,Wt&&(r=Wt[e])||(xl||((r=document.createElement("canvas")).className="blocklyComputeCanvas",document.body.appendChild(r),xl=r.getContext("2d")),n&&xl?(xl.font=i+" "+t+" "+s,r=xl.measureText(n).width):r=0,Wt&&(Wt[e]=r)),r},ir=function(e,t,i,s){const n=document.createElement("span");n.style.font=i+" "+t+" "+s,n.textContent=e,(e=document.createElement("div")).style.width="1px",e.style.height="0",(t=document.createElement("div")).style.display="flex",t.style.position="fixed",t.style.top="0",t.style.left="0",t.appendChild(n),t.appendChild(e),document.body.appendChild(t),i={height:0,baseline:0};try{t.style.alignItems="baseline",i.baseline=e.offsetTop-n.offsetTop,t.style.alignItems="flex-end",i.height=e.offsetTop-n.offsetTop}finally{document.body.removeChild(t)}return i},o.getFocusManager$$module$build$src$core$focus_manager=function(){return Ue.getFocusManager()},ai=function(e){return e&&"function"==typeof e.getFocusableElement&&"function"==typeof e.getFocusableTree&&"function"==typeof e.onNodeFocus&&"function"==typeof e.onNodeBlur&&"function"==typeof e.canBeFocused},Qs=function(e){return ai(e)&&"string"==typeof e.id&&"object"==typeof e.workspace&&"function"==typeof e.select&&"function"==typeof e.unselect},Bt=function(e,t){for(const i in t)e[i]=null!==t[i]&&Array.isArray(t[i])?Bt(e[i]||[],t[i]):null!==t[i]&&"object"==typeof t[i]?Bt(e[i]||Object.create(null),t[i]):t[i];return e},ko=function(e){return Al[e]||null},Yi=function(){const e=[];for(const t in Al)e.push(Al[t]);return e},_c=function(e){Al[e.id]=e},bc=function(e){delete Al[e.id]},st=function(){return y$},en=function(e){y$=e},Ki=function(){const e=o.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode();return e&&Qs(e)?e:null},Xu=function(e){o.getFocusManager$$module$build$src$core$focus_manager().focusNode(e)},So=function(e){const t=Ki();let i,s,n,r;const a=new(P(b.SELECTED))(null!=(i=t?.id)?i:null,null!=(s=e?.id)?s:null,null!=(r=null!=(n=e?.workspace.id)?n:t?.workspace.id)?r:"");B(a)},tn=function(){return C$},sr=function(e){C$=e},wo=function(e){for(;e.options.parentWorkspace;)e=e.options.parentWorkspace;const t=e.getParentSvg(),i=e.getCachedParentSvgSize();var s=t.parentElement;if(s instanceof HTMLElement){var n=s.offsetWidth;s=s.offsetHeight,i.width!==n&&(t.setAttribute("width",n+"px"),e.setCachedParentSvgSize(n,null)),i.height!==s&&(t.setAttribute("height",s+"px"),e.setCachedParentSvgSize(null,s)),e.resize()}},on=function(e,t){const i=Object.create(null),s=e.getDescendants(!0);t&&(e=e.getNextBlock())&&(e=s.indexOf(e),s.splice(e,s.length-e));for(let r,n=0;r=s[n];n++)i[r.type]?i[r.type]++:i[r.type]=1;return i},Yu=function(e){return function(){this.jsonInit(e)}},nr=function(e){I$.defineBlocksWithJsonArrayInternal(e)},Ku=function(e){o.defineBlocks$$module$build$src$core$common(o.createBlockDefinitionsFromJsonArray$$module$build$src$core$common(e))},o.createBlockDefinitionsFromJsonArray$$module$build$src$core$common=function(e){const t={};for(let i=0;i<e.length;i++){const s=e[i];if(!s){console.warn(`Block definition #${i} in JSON array is ${s}. Skipping`);continue}const n=s.type;n?t[n]={init:Yu(s)}:console.warn(`Block definition #${i} in JSON array is missing a type attribute. Skipping.`)}return t},o.defineBlocks$$module$build$src$core$common=function(e){for(const t of Object.keys(e)){const i=e[t];t in ue&&console.warn(`Block definition "${t}" overwrites previous definition.`),ue[t]=i}},sn=function(e){let t=st();const i=o.getFocusManager$$module$build$src$core$focus_manager().getFocusedTree();for(const s of Yi())if(i===s){t=s;break}!Eo(e)&&t&&(!t.rendered||t.isFlyout||t.isVisible())&&ne.registry.onKeyDown(t,e)},nt=function(e,t){return-1!==(t=e.indexOf(t))&&(e.splice(t,1),!0)},Pt=function(e){if(Gh)throw Error("CSS already injected");Zh+="\n"+e},fc=function(e,t){Gh||(Gh=!0,e&&(e=t.replace(/[\\/]$/,""),t=Zh.replace(/<<<PATH>>>/g,e),Zh="",(e=document.createElement("style")).id="blockly-common-style",t=document.createTextNode(t),e.appendChild(t),document.head.insertBefore(e,document.head.firstChild)))},nn=function(e){return x$.getSizeInternal(e)},Ju=function(e){if("none"!==Ft(e,"display"))return Tc(e);const t=e.style,i=t.display,s=t.visibility,n=t.position;t.visibility="hidden",t.position="absolute",t.display="inline";const r=e.offsetWidth;return e=e.offsetHeight,t.display=i,t.position=n,t.visibility=s,new j(r,e)},Tc=function(e){return new j(e.offsetWidth,e.offsetHeight)},Ft=function(e,t){return(e=window.getComputedStyle(e))[t]||e.getPropertyValue(t)},xo=function(e){const t=new S(0,0);e=e.getBoundingClientRect();var i=document.documentElement;return i=new S(window.pageXOffset||i.scrollLeft,window.pageYOffset||i.scrollTop),t.x=e.left+i.x,t.y=e.top+i.y,t},Ec=function(){const e=document.body,t=document.documentElement;return new S(e.scrollLeft||t.scrollLeft,e.scrollTop||t.scrollTop)},vc=function(e){const t=parseFloat(Ft(e,"borderLeftWidth")),i=parseFloat(Ft(e,"borderRightWidth")),s=parseFloat(Ft(e,"borderTopWidth"));return e=parseFloat(Ft(e,"borderBottomWidth")),new z(s,e,t,i)},yc=function(e,t,i){e=Cc(e,t,i),t.scrollLeft=e.x,t.scrollTop=e.y},Cc=function(e,t,i){var s=xo(e),n=xo(t),r=vc(t);const a=s.x-n.x-r.left;return s=s.y-n.y-r.top,n=Tc(e),e=t.clientWidth-n.width,n=t.clientHeight-n.height,r=t.scrollLeft,t=t.scrollTop,i?(r+=a-e/2,t+=s-n/2):(r+=Math.min(a,Math.max(a-e,0)),t+=Math.min(s,Math.max(s-n,0))),new S(r,t)},rn=function(e){const t=new S(0,0);var i=e.x&&e.getAttribute("x");const s=e.y&&e.getAttribute("y");return i&&(t.x=parseInt(i)),s&&(t.y=parseInt(s)),(i=(i=e.getAttribute("transform"))&&i.match(A$))&&(t.x+=Number(i[1]),i[3]&&(t.y+=Number(i[3]))),(e=e.getAttribute("style"))&&e.includes("translate")&&(e=e.match(R$))&&(t.x+=Number(e[1]),e[3]&&(t.y+=Number(e[3]))),t},rr=function(e){let t=0,i=0;for(;e;){const s=rn(e);if(t+=s.x,i+=s.y,(" "+(e.getAttribute("class")||"")+" ").includes(" injectionDiv "))break;e=e.parentNode}return new S(t,i)},Ic=function(){const e=Ec();return new z(e.y,document.documentElement.clientHeight+e.y,e.x,document.documentElement.clientWidth+e.x)},kc=function(){const e=document.documentElement,t=window;return new S(t.pageXOffset||e.scrollLeft,t.pageYOffset||e.scrollTop)},Sc=function(e,t){var i=t.x;t=t.y;const s=e.getInjectionDiv().getBoundingClientRect();return i=new S(i-s.left,t-s.top),t=e.getOriginOffsetInPixels(),S.difference(i,t).scale(1/e.scale)},Ji=function(e,t){var i=t.scale(e.scale);t=i.x,i=i.y;const s=e.getInjectionDiv().getBoundingClientRect();return e=e.getOriginOffsetInPixels(),new S(t+s.left+e.x,i+s.top+e.y)},Qu=function(e){({document:Aa=Aa,DOMParser:Ol=Ol,XMLSerializer:Ml=Ml}=e),xa=new Ol,qh=new Ml},o.createElement$$module$build$src$core$utils$xml=function(e){return Aa.createElementNS(O$,e)},o.createTextNode$$module$build$src$core$utils$xml=function(e){return Aa.createTextNode(e)},o.textToDom$$module$build$src$core$utils$xml=function(e){let t=xa.parseFromString(e,"text/xml");if(t&&t.documentElement&&!t.getElementsByTagName("parsererror").length)return t.documentElement;if((t=xa.parseFromString(e,"text/html"))&&t.body.firstChild&&"xml"===t.body.firstChild.nodeName.toLowerCase())return t.body.firstChild;throw Error(`DOMParser was unable to parse: ${e}`)},Qi=function(e){return ed(qh.serializeToString(e))},ed=function(e){return e.replace(U_,t=>`&#${t.charCodeAt(0)};`)},lr=function(e){return e?((e instanceof Element||"string"==typeof e)&&(e=xc(e),e=id(e)),td(e),e):null},td=function(e){const t=e.kind;if(e=e.contents,t&&t!==M$&&t!==zh)throw Error("Invalid toolbox kind "+t+". Please supply either "+M$+" or "+zh);if(!e)throw Error("Toolbox must have a contents attribute.")},ln=function(e){return e?e.contents?e.contents:Array.isArray(e)&&e.length>0&&!e[0].nodeType?e:ur(e):[]},cr=function(e){return N$.hasCategoriesInternal(e)},od=function(e){if(!e)return!1;const t=e.kind;return t?t===zh:!!e.contents.filter(i=>"CATEGORY"===i.kind.toUpperCase()).length},ar=function(e){return!(!e||!e.contents||!e.contents.filter(function(t){return"CATEGORY"===t.kind.toUpperCase()}).length)},id=function(e){const t={contents:ur(e)};return e instanceof Node&&wc(e,t),t},ur=function(e){const t=[];let i=e.childNodes;i||(i=e);for(let n,s=0;n=i[s];s++){if(!n.tagName)continue;e={};const r=n.tagName.toUpperCase();e.kind=r,"BLOCK"===r?e.blockxml=n:n.childNodes&&n.childNodes.length>0&&(e.contents=ur(n)),wc(n,e),t.push(e)}return t},wc=function(e,t){for(let i=0;i<e.attributes.length;i++){const s=e.attributes[i];s.nodeName.includes("css-")?(t.cssconfig=t.cssconfig||{},t.cssconfig[s.nodeName.replace("css-","")]=s.value):t[s.nodeName]=s.value}},xc=function(e){let t=null;if(e)if("string"==typeof e){if(t=o.textToDom$$module$build$src$core$utils$xml(e),"xml"!==t.nodeName.toLowerCase())throw TypeError("Toolbox should be an <xml> document.")}else e instanceof Element&&(t=e);return t},dr=function(e,t,i,s,n,r){const a=r.scrollbar&&r.scrollbar.canScrollVertically();return e.horizontal===Nl.LEFT?(i=n.absoluteMetrics.left+i,a&&r.RTL&&(i+=_e.scrollbarThickness)):(i=n.absoluteMetrics.left+n.viewMetrics.width-t.width-i,a&&!r.RTL&&(i-=_e.scrollbarThickness)),e.vertical===xi.TOP?e=n.absoluteMetrics.top+s:(e=n.absoluteMetrics.top+n.viewMetrics.height-t.height-s,r.scrollbar&&r.scrollbar.canScrollHorizontally()&&(e-=_e.scrollbarThickness)),new z(e,e+t.height,i,i+t.width)},hr=function(e,t){return{horizontal:t.toolboxMetrics.position===G.LEFT||e.horizontalLayout&&!e.RTL?Nl.RIGHT:Nl.LEFT,vertical:t.toolboxMetrics.position===G.BOTTOM?xi.TOP:xi.BOTTOM}},pr=function(e,t,i,s){const n=e.left,r=e.right-e.left,a=e.bottom-e.top;for(let $=0;$<s.length;$++){const C=s[$];e.intersects(C)&&(e=new z(e=i===Cs.UP?C.top-a-t:C.bottom+t,e+a,n,n+r),$=-1)}return e},cn=function(e,t){U(k.SERIALIZER,e,t)},sd=function(e){et(k.SERIALIZER,e)},ui=function(e,{addCoordinates:t=!1,saveIds:i=!0}={}){const s=e.workspace,n=Object.create(null);return n.height=e.getSize().height,n.width=e.getSize().width,i&&(n.id=e.id),t&&(t=e.getRelativeToSurfaceXY(),n.x=s.RTL?s.getWidth()-t.x:t.x,n.y=t.y),e.getText()&&(n.text=e.getText()),e.isCollapsed()&&(n.collapsed=!0),e.isOwnEditable()||(n.editable=!1),e.isOwnMovable()||(n.movable=!1),e.isOwnDeletable()||(n.deletable=!1),n},an=function(e,t,{recordUndo:i=!1}={}){const s=ke();if(o.setRecordUndo$$module$build$src$core$events$utils(i),i=t.newComment(e.id),void 0!==e.text&&i.setText(e.text),void 0!==e.x||void 0!==e.y){const r=i.getRelativeToSurfaceXY();let a,$=null!=(a=e.x)?a:r.x;var n;$=t.RTL?t.getWidth()-$:$,t=null!=(n=e.y)?n:r.y,i.moveTo(new S($,t))}if(void 0!==e.width||e.height){let r,a;n=i.getSize(),i.setSize(new j(null!=(r=e.width)?r:n.width,null!=(a=e.height)?a:n.height))}return void 0!==e.collapsed&&i.setCollapsed(e.collapsed),void 0!==e.editable&&i.setEditable(e.editable),void 0!==e.movable&&i.setMovable(e.movable),void 0!==e.deletable&&i.setDeletable(e.deletable),o.setRecordUndo$$module$build$src$core$events$utils(s),i},gr=function(e,t){U(k.PASTER,e,t)},nd=function(e){et(k.PASTER,e)},rd=function(e){const t=e.workspace,i=e.getRelativeToSurfaceXY(),s=new S(0,0),n=t.getTopComments(!1).filter(r=>r.id!==e.id).map(r=>r.getRelativeToSurfaceXY());for(;ld(S.sum(i,s),n);)s.translate(t.RTL?-30:30,30);e.moveTo(S.sum(i,s))},ld=function(e,t){return t.some(i=>Math.abs(i.x-e.x)<=1&&Math.abs(i.y-e.y)<=1)},Ut=function(e,t){e.setAttribute(q_,t)},Ee=function(e,t,i){Array.isArray(i)&&(i=i.join(" ")),e.setAttribute(W_+t,`${i}`)},es=function(e){return e&&"function"==typeof e.saveState&&"function"==typeof e.loadState},Ac=function(e){return Rc(e),cd()?($r(),Promise.resolve()):(Pn||(Pn=new Promise(t=>{tp=t,U$=window.requestAnimationFrame(()=>{$r(),t()})})),Pn)},Ht=function(){return Pn||Promise.resolve()},Ao=function(e){e||window.cancelAnimationFrame(U$),$r(e),!e&&tp&&tp()},cd=function(){return p$},Rc=function(e){Qh.add(e),ep.set(e,o.getGroup$$module$build$src$core$events$utils());const t=e.getParent();t?Rc(t):Ma.add(e)},$r=function(e){const t=e?new Set([e]):new Set([...Ma].map(r=>r.workspace)),i=[...Ma].filter(ad).filter(r=>t.has(r.workspace));for(var s of i)Mc(s);for(const r of t)r.resizeContents();for(var n of i)s=n.getRelativeToSurfaceXY(),n.updateComponentLocations(s);for(const r of i)n=o.getGroup$$module$build$src$core$events$utils(),(s=ep.get(r))&&o.setGroup$$module$build$src$core$events$utils(s),r.bumpNeighbours(),o.setGroup$$module$build$src$core$events$utils(n);for(const r of i)Oc(r);e||(Pn=null)},Oc=function(e){Ma.delete(e),Qh.delete(e),ep.delete(e);for(const t of e.getChildren(!1))Oc(t)},ad=function(e){return!e.isDisposed()&&!e.getParent()},Mc=function(e){if(Qh.has(e)&&e.initialized){for(const t of e.getChildren(!1))Mc(t);e.renderEfficiently()}},un=function(e,t){W$(e,t)},ud=function(e=Z$){W$=e},mr=function(e,t){z$(e,t)},dd=function(e=q$){z$=e},_r=function(e,t,i){X$(e,t,i)},hd=function(e=j$){X$=e},pd=function(e,t){K$(e,t)},gd=function(e=Y$){K$=e},di=function(e){return e&&"function"==typeof e.getProcedureDef},Nc=function(e){return e&&"function"==typeof e.getProcedureCall&&"function"==typeof e.renameProcedure},br=function(e){return void 0!==e.getVariableModel},Re=function(e,t,i,s){e=e+" was deprecated in "+t+" and will be deleted in "+i+".",s&&(e+="\nUse "+s+" instead."),Q$.has(e)||(Q$.add(e),console.warn(e))},o.allUsedVarModels$$module$build$src$core$variables=function(e){e=e.getAllBlocks(!1);const t=new Set;for(let i=0;i<e.length;i++){const s=e[i].getVarModels();if(s)for(let n=0;n<s.length;n++){const r=s[n];r.getId()&&t.add(r)}}return Array.from(t.values())},o.allDeveloperVariables$$module$build$src$core$variables=function(e){e=e.getAllBlocks(!1);const t=new Set;for(let n,s=0;n=e[s];s++){var i=n.getDeveloperVariables;if(i){i=i();for(let r=0;r<i.length;r++)t.add(i[r])}}return Array.from(t.values())},fr=function(e){return Lc(e,!1)},Lc=function(e,t=!0){return ue.variables_set||ue.variables_get||console.warn("There are no variable blocks, but there is a variable category."),t?(Re("The XML return value of Blockly.Variables.flyoutCategory()","v12","v13","the same method, but handle a return type of FlyoutItemInfo[] (JSON) instead."),$d(e)):(e.registerButtonCallback("CREATE_VARIABLE",function(i){hi(i.getTargetWorkspace())}),[{kind:"button",text:"%{BKY_NEW_VARIABLE}",callbackkey:"CREATE_VARIABLE"},...Tr(e,e.getVariableMap().getVariablesOfType(""),!0)])},dn=function(e){return{VAR:{name:e.getName(),type:e.getType()}}},Tr=function(e,t,i,s="variables_get",n="variables_set"){i&&(i=ue.math_change),e=[];const r=t.slice(-1)[0];return r&&(ue[n]&&e.push({kind:"block",type:n,gap:i?8:24,fields:dn(r)}),i&&e.push({kind:"block",type:"math_change",gap:ue[s]?20:8,fields:dn(r),inputs:{DELTA:{shadow:{type:"math_number",fields:{NUM:1}}}}})),ue[s]&&e.push(...t.sort(ts).map(a=>({kind:"block",type:s,gap:8,fields:dn(a)}))),e},$d=function(e){let t=[];const i=document.createElement("button");return i.setAttribute("text","%{BKY_NEW_VARIABLE}"),i.setAttribute("callbackKey","CREATE_VARIABLE"),e.registerButtonCallback("CREATE_VARIABLE",function(s){hi(s.getTargetWorkspace())}),t.push(i),e=Dc(e),t.concat(e)},Dc=function(e){const t=[];if((e=e.getVariableMap().getVariablesOfType("")).length>0){var i=e[e.length-1];if(ue.variables_set){var s=o.createElement$$module$build$src$core$utils$xml("block");s.setAttribute("type","variables_set"),s.setAttribute("gap",ue.math_change?"8":"24"),s.appendChild(pi(i)),t.push(s)}if(ue.math_change&&((s=o.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","math_change"),s.setAttribute("gap",ue.variables_get?"20":"8"),s.appendChild(pi(i)),i=o.textToDom$$module$build$src$core$utils$xml('<value name="DELTA"><shadow type="math_number"><field name="NUM">1</field></shadow></value>'),s.appendChild(i),t.push(s)),ue.variables_get){e.sort(ts);for(let r,n=0;r=e[n];n++)(i=o.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","variables_get"),i.setAttribute("gap","8"),i.appendChild(pi(r)),t.push(i)}}return t},Bc=function(e){return tm.generateUniqueNameInternal(e)},md=function(e){return Er(ip.charAt(0),e.getVariableMap().getAllVariables().map(t=>t.getName()))},Er=function(e,t){if(!t.length)return e;const i=ip;let s="",n=i.indexOf(e);for(;;){let r=!1;for(let a=0;a<t.length;a++)if(t[a].toLowerCase()===e){r=!0;break}if(!r)break;n++,n===i.length&&(n=0,s=`${Number(s)+1}`),e=i.charAt(n)+s}return e},hi=function(e,t,i){const n=i||"";!function s(r){vr(o.Msg$$module$build$src$core$msg.NEW_VARIABLE_TITLE,r,function(a){if(a){var $=Pc(a,e);if($){if($.getType()===n)var C=o.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS.replace("%1",$.getName());else C=(C=o.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE).replace("%1",$.getName()).replace("%2",$.getType());un(C,function(){s(a)})}else e.getVariableMap().createVariable(a,n),t&&t(a)}else t&&t(null)})}("")},o.renameVariable$$module$build$src$core$variables=function(e,t,i){!function s(n){const r=o.Msg$$module$build$src$core$msg.RENAME_VARIABLE_TITLE.replace("%1",t.getName());vr(r,n,function(a){if(a){var $=_d(a,t.getType(),e),C=Fc(t.getName(),a,e);if($||C){var F="";$?F=o.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE.replace("%1",$.getName()).replace("%2",$.getType()):C&&(F=o.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_A_PARAMETER.replace("%1",a).replace("%2",C)),un(F,function(){s(a)})}else e.getVariableMap().renameVariable(t,a),i&&i(a)}else i&&i(null)})}("")},vr=function(e,t,i){_r(e,t,function(s){s&&((s=s.replace(/[\s\xa0]+/g," ").trim())===o.Msg$$module$build$src$core$msg.RENAME_VARIABLE||s===o.Msg$$module$build$src$core$msg.NEW_VARIABLE)&&(s=null),i(s)})},_d=function(e,t,i){i=i.getVariableMap().getAllVariables(),e=e.toLowerCase();for(let n,s=0;n=i[s];s++)if(n.getName().toLowerCase()===e&&n.getType()!==t)return n;return null},Pc=function(e,t){t=t.getVariableMap().getAllVariables(),e=e.toLowerCase();for(let s,i=0;s=t[i];i++)if(s.getName().toLowerCase()===e)return s;return null},Fc=function(e,t,i){return i.getProcedureMap().getProcedures().length?bd(e,t,i):fd(e,t,i)},bd=function(e,t,i){e=e.toLowerCase(),t=t.toLowerCase(),i=i.getProcedureMap().getProcedures();for(const n of i){var s=n.getParameters().filter(br).map(r=>r.getVariableModel().getName());if(s&&(i=s.some(r=>r.toLowerCase()===e),s=s.some(r=>r.toLowerCase()===t),i&&s))return n.getName()}return null},fd=function(e,t,i){e=e.toLowerCase(),t=t.toLowerCase(),i=i.getAllBlocks(!1);for(const n of i){if(!di(n))continue;var s=(i=n.getProcedureDef())[1];const r=s.some(a=>a.toLowerCase()===e);if(s=s.some(a=>a.toLowerCase()===t),r&&s)return i[0]}return null},pi=function(e){const t=o.createElement$$module$build$src$core$utils$xml("field");return t.setAttribute("name","VAR"),t.setAttribute("id",e.getId()),t.setAttribute("variabletype",e.getType()),e=o.createTextNode$$module$build$src$core$utils$xml(e.getName()),t.appendChild(e),t},o.getOrCreateVariablePackage$$module$build$src$core$variables=function(e,t,i,s){let n=o.getVariable$$module$build$src$core$variables(e,t,i,s);return n||(n=Td(e,t,i,s)),n},o.getVariable$$module$build$src$core$variables=function(e,t,i,s){const n=e.getPotentialVariableMap();let r=null;if(t&&(r=e.getVariableById(t),!r&&n&&(r=n.getVariableById(t)),r))return r;if(i){if(void 0===s)throw Error("Tried to look up a variable by name without a type");r=e.getVariable(i,s),!r&&n&&(r=n.getVariable(i,s))}return r},Td=function(e,t,i,s){const n=e.getVariableMap(),r=e.getPotentialVariableMap();return i||(i=Bc(e.isFlyout?e.targetWorkspace:e)),r?r.createVariable(i,s,t??void 0):n.createVariable(i,s,t)},hn=function(e,t){e=e.getAllVariables();const i=[];if(t.length!==e.length)for(let s=0;s<e.length;s++){const n=e[s];t.includes(n)||i.push(n)}return i},ts=function(e,t){return e.getName().localeCompare(t.getName(),void 0,{sensitivity:"base"})},os=function(e,t){const i=[];e=e.getAllBlocks(!1);for(let s=0;s<e.length;s++){const n=e[s].getVarModels();if(n)for(let r=0;r<n.length;r++)n[r].getId()===t&&i.push(e[s])}return i},o.deleteVariable$$module$build$src$core$variables=function(e,t,i){var s=t.getName();const n=os(e,t.getId());for(let r=n.length-1;r>=0;r--){const a=n[r];if("procedures_defnoreturn"===a.type||"procedures_defreturn"===a.type)return i=String(a.getFieldValue("NAME")),s=o.Msg$$module$build$src$core$msg.CANNOT_DELETE_VARIABLE_PROCEDURE.replace("%1",s).replace("%2",i),void un(s);a===i&&n.splice(r,1)}i&&n.length||n.length>1?(s=o.Msg$$module$build$src$core$msg.DELETE_VARIABLE_CONFIRMATION.replace("%1",String(n.length+(i&&!i.workspace.isFlyout?1:0))).replace("%2",s),mr(s,r=>{r&&t&&e.getVariableMap().deleteVariable(t)})):e.getVariableMap().deleteVariable(t)},rt=function(e,{addCoordinates:t=!1,addInputBlocks:i=!0,addNextBlocks:s=!0,doFullSerialization:n=!0,saveIds:r=!0}={}){if(e.isInsertionMarker())return null;const a={type:e.type,id:r?e.id:void 0};return t&&vd(e,a),Ed(e,a),is(e,a,n),yd(e,a,n),Cd(e,a,n),i&&Id(e,a,n,r),s&&kd(e,a,n,r),a},Ed=function(e,t){e.isCollapsed()&&(t.collapsed=!0),e.isEnabled()||(t.disabledReasons=Array.from(e.getDisabledReasons())),e.isOwnDeletable()||(t.deletable=!1),e.isOwnMovable()||(t.movable=!1),e.isOwnEditable()||(t.editable=!1),void 0!==e.inputsInline&&e.inputsInline!==e.inputsInlineDefault&&(t.inline=e.inputsInline),e.data&&(t.data=e.data)},vd=function(e,t){const i=e.workspace;e=e.getRelativeToSurfaceXY(),t.x=Math.round(i.RTL?i.getWidth()-e.x:e.x),t.y=Math.round(e.y)},is=function(e,t,i){e.saveExtraState?null!==(e=e.saveExtraState(i))&&(t.extraState=e):e.mutationToDom&&null!==(e=e.mutationToDom())&&(t.extraState=ht(e).replace(' xmlns="https://developers.google.com/blockly/xml"',""))},yd=function(e,t,i){const s=Object.create(null);for(const n of e.getIcons())es(n)&&(e=n.saveState(i))&&(s[n.getType().toString()]=e);Object.keys(s).length&&(t.icons=s)},Cd=function(e,t,i){const s=Object.create(null);for(const n of e.getFields())n.isSerializable()&&(s[n.name]=n.saveState(i));Object.keys(s).length&&(t.fields=s)},Id=function(e,t,i,s){const n=Object.create(null);for(let r=0;r<e.inputList.length;r++){const a=e.inputList[r];if(!a.connection)continue;const $=Uc(a.connection,i,s);$&&(n[a.name]=$)}Object.keys(n).length&&(t.inputs=n)},kd=function(e,t,i,s){e.nextConnection&&(e=Uc(e.nextConnection,i,s))&&(t.next=e)},Uc=function(e,t,i){const s=e.getShadowState(!0);if(e=e.targetBlock(),!s&&!e)return null;const n=Object.create(null);return s&&(n.shadow=s),e&&!e.isShadow()&&(n.block=rt(e,{doFullSerialization:t,saveIds:i})),n},Ro=function(e,t,{recordUndo:i=!1}={}){return e=ss(e,t,{recordUndo:i}),t.rendered&&Ao(),e},ss=function(e,t,{parentConnection:i,isShadow:s=!1,recordUndo:n=!1}={}){const r=ke();o.setRecordUndo$$module$build$src$core$events$utils(n),(n=o.getGroup$$module$build$src$core$events$utils())||o.setGroup$$module$build$src$core$events$utils(!0),o.disable$$module$build$src$core$events$utils();const a=t.getAllVariables();let $;try{$=Hc(e,t,{parentConnection:i,isShadow:s})}finally{o.enable$$module$build$src$core$events$utils()}if(Sd(t,a),se()&&B(new(P(b.BLOCK_CREATE))($)),o.setGroup$$module$build$src$core$events$utils(n),o.setRecordUndo$$module$build$src$core$events$utils(r),t.rendered){const C=$;setTimeout(()=>{C.disposed||C.setConnectionTracking(!0)},1)}return $},Hc=function(e,t,{parentConnection:i,isShadow:s=!1}={}){if(!e.type)throw new om(e);const n=t.newBlock(e.type,e.id);return n.setShadow(s),Vc(n,e),wd(n,e),xd(n,e),Ad(i,n,e),Rd(n,e),Od(n,e),Md(n,e),Nd(n,e),Ld(n,t.rendered),n},Sd=function(e,t){if(se())for(e=hn(e,t),t=0;t<e.length;t++){const i=e[t];B(new(P(b.VAR_CREATE))(i))}},Vc=function(e,t){let i=void 0===t.x?0:t.x;t=void 0===t.y?0:t.y;const s=e.workspace;i=s.RTL?s.getWidth()-i:i,e.moveBy(i,t)},wd=function(e,t){if(t.collapsed&&e.setCollapsed(!0),!1===t.deletable&&e.setDeletable(!1),!1===t.movable&&e.setMovable(!1),!1===t.editable&&e.setEditable(!1),!1===t.enabled&&e.setDisabledReason(!0,xt),Array.isArray(t.disabledReasons))for(const i of t.disabledReasons)e.setDisabledReason(!0,i);void 0!==t.inline&&e.setInputsInline(t.inline),void 0!==t.data&&(e.data=t.data)},xd=function(e,t){t.extraState&&(e.loadExtraState?e.loadExtraState(t.extraState):e.domToMutation&&e.domToMutation(o.textToDom$$module$build$src$core$utils$xml(t.extraState)))},Ad=function(e,t,i){if(e){if(e.getSourceBlock().isShadow()&&!t.isShadow())throw new sm(i);if(e.type===o.inputTypes$$module$build$src$core$inputs$input_types.VALUE){var s=t.outputConnection;if(!s)throw new Ul("output",t,i)}else if(!(s=t.previousConnection))throw new Ul("previous",t,i);if(!e.connect(s)){const n=t.workspace.connectionChecker;throw new im(n.getErrorMessage(n.canConnectWithReason(s,e,!1),s,e),e.type===o.inputTypes$$module$build$src$core$inputs$input_types.VALUE?"output connection":"previous connection",t,i)}}},Rd=function(e,t){if(t.icons){var i=Object.keys(t.icons);for(const n of i){i=t.icons[n];var s=e.getIcon(n);if(!s){if(!(s=tt(k.ICON,n,!1)))throw new nm(n,e,t);s=new s(e),e.addIcon(s)}es(s)&&s.loadState(i)}}},Od=function(e,t){if(t.fields){var i=Object.keys(t.fields);for(let s=0;s<i.length;s++){const n=i[s],r=t.fields[n],a=e.getField(n);a?a.loadState(r):console.warn(`Ignoring non-existant field ${n} in block ${e.type}`)}}},Md=function(e,t){if(t.inputs){var i=Object.keys(t.inputs);for(let s=0;s<i.length;s++){const n=i[s],r=e.getInput(n);if(!r||!r.connection)throw new Ul(n,e,t);Gc(r.connection,t.inputs[n])}}},Nd=function(e,t){if(t.next){if(!e.nextConnection)throw new Ul("next",e,t);Gc(e.nextConnection,t.next)}},Gc=function(e,t){t.shadow&&e.setShadowState(t.shadow),t.block&&Hc(t.block,e.getSourceBlock().workspace,{parentConnection:e})},Ld=function(e,t){if(t){e.setConnectionTracking(!1),e.initSvg(),e.queueRender();for(const i of e.getIcons())i.onLocationChange(e.getRelativeToSurfaceXY())}else e.initModel()},Oo=function(e){return"function"==typeof e.bubbleIsVisible&&"function"==typeof e.setBubbleVisible&&"function"==typeof e.getBubble},yr=function(e){return e*Math.PI/180},Dd=function(e){return 180*e/Math.PI},ns=function(e,t,i){if(i<e){const s=i;i=e,e=s}return Math.max(e,Math.min(t,i))},Cr=function(){document.querySelector(".blocklyDropDownDiv")||((be=document.createElement("div")).className="blocklyDropDownDiv",be.tabIndex=-1,(tn()||document.body).appendChild(be),(Gl=document.createElement("div")).className="blocklyDropDownContent",be.appendChild(Gl),Fa=L(Gl,"keydown",null,sn),(ws=document.createElement("div")).className="blocklyDropDownArrow",be.appendChild(ws),be.style.opacity="0",be.style.transition="transform "+Ba+"s, opacity "+Ba+"s")},Zc=function(e){lp=e},Wc=function(){return Mi},Ir=function(){return Gl},kr=function(){Fa&&(K(Fa),Fa=null),be.remove(),Cr()},qc=function(e,t){be.style.backgroundColor=e,be.style.borderColor=t},Bd=function(e,t,i,s,n=!0){return Yc(jc(t),e,n,i,s)},zc=function(e,t,i,s=!0){return um=!0,Yc(Xc(e),e,s,t,i)},jc=function(e){var t=e.getSvgRoot();const i=e.workspace.scale,s=e.height*i;return e=e.width*i,t=xo(t),new z(t.y,t.y+s,t.x,t.x+e)},Xc=function(e){return e=e.getScaledBBox(),new z(e.top,e.bottom,e.left,e.right)},Yc=function(e,t,i,s,n){const r=e.left+(e.right-e.left)/2,a=e.bottom;e=e.top,n&&(e+=n);let $=(n=t.getSourceBlock()).workspace;for(;$.options.parentWorkspace;)$=$.options.parentWorkspace;return Zc($.getParentSvg().parentNode),Kc(t,n.RTL,r,a,r,e,i,s)},Kc=function(e,t,i,s,n,r,a,$){return Mi=e,Ss=$||null,be.style.direction=t?"rtl":"ltr",e=st(),cm=e.getRenderer().getClassName(),am=e.getTheme().getClassName(),A(be,cm),A(be,am),i=xr(i,s,n,r),a&&(Pa=o.getFocusManager$$module$build$src$core$focus_manager().takeEphemeralFocus(be)),i},Jc=function(e,t,i,s){return{initialX:(e=rs(e,i.left,i.right,s.width)).divX,initialY:t,finalX:e.divX,finalY:t+np,arrowX:e.arrowX,arrowY:-(Vl/2+sp),arrowAtTop:!0,arrowVisible:!0}},Sr=function(e,t,i,s){return{initialX:(e=rs(e,i.left,i.right,s.width)).divX,initialY:t-s.height,finalX:e.divX,finalY:t-s.height-np,arrowX:e.arrowX,arrowY:s.height-2*sp-Vl/2,arrowAtTop:!1,arrowVisible:!0}},pn=function(e,t,i){return{initialX:(e=rs(e,t.left,t.right,i.width)).divX,initialY:0,finalX:e.divX,finalY:0,arrowAtTop:null,arrowX:null,arrowY:null,arrowVisible:!1}},rs=function(e,t,i,s){return t=ns(t,e-s/2,i-s),{arrowX:e=ns(i=lm,e=e-Vl/2-t,s-i-Vl),divX:t}},wr=function(){return!!Mi},gn=function(e,t){return Mi===e&&(t?yt():$n(),!0)},$n=function(){be.style.transform="translate(0, 0)",be.style.opacity="0",rp=setTimeout(function(){yt()},1e3*Ba),Ss&&(Ss(),Ss=null)},yt=function(){wr()&&(rp&&clearTimeout(rp),Ss&&(Ss(),Ss=null),kr(),Mi=null,st().markFocused(),Pa&&(Pa(),Pa=null))},xr=function(e,t,i,s){(e=Ua.getPositionMetrics(e,t,i,s)).arrowVisible?(t=e.arrowX,i=e.arrowY,s=e.arrowAtTop?45:225,ws.style.display="",ws.style.transform=`translate(${t}px, ${i}px) rotate(${s}deg)`,ws.setAttribute("class","blocklyDropDownArrow")):ws.style.display="none",t=Math.floor(e.initialX),i=Math.floor(e.initialY),s=Math.floor(e.finalX);const n=Math.floor(e.finalY);return be.style.left=t+"px",be.style.top=i+"px",be.style.display="block",be.style.opacity="1",be.style.transform="translate("+(s-t)+"px,"+(n-i)+"px)",!!e.arrowAtTop},Ar=function(){if(Mi){var e=Mi.getSourceBlock();const t=(e=um?Xc(Mi):jc(e)).left+(e.right-e.left)/2;xr(t,e.bottom,t,e.top)}else $n()},ls=function(e){return e.length?e.reduce(function(t,i){return t.length<i.length?t:i}).length:0},Rr=function(e,t){if(!e.length)return 0;if(1===e.length)return e[0].length;let s,i=0;for(t=t||ls(e),s=0;s<t;s++){for(var n=e[0][s],r=1;r<e.length;r++)if(n!==e[r][s])return i;" "===n&&(i=s+1)}for(n=1;n<e.length;n++)if((r=e[n][s])&&" "!==r)return i;return t},Or=function(e,t){if(!e.length)return 0;if(1===e.length)return e[0].length;let s,i=0;for(t=t||ls(e),s=0;s<t;s++){for(var n=e[0].substr(-s-1,1),r=1;r<e.length;r++)if(n!==e[r].substr(-s-1,1))return i;" "===n&&(i=s+1)}for(n=1;n<e.length;n++)if((r=e[n].charAt(e[n].length-s-1))&&" "!==r)return i;return t},o.wrap$$module$build$src$core$utils$string=function(e,t){e=e.split("\n");for(let i=0;i<e.length;i++)e[i]=Qc(e[i],t);return e.join("\n")},Qc=function(e,t){if(e.length<=t)return e;const i=e.trim().split(/\s+/);for(var s=0;s<i.length;s++)i[s].length>t&&(t=i[s].length);var n=-1/0;let r,a=1;do{s=n,r=e,e=[],n=i.length/a;let $=1;for(let C=0;C<i.length-1;C++)$<(C+1.5)/n?($++,e[C]=!0):e[C]=!1;e=gi(i,e,t),n=mn(i,e,t),e=ea(i,e),a++}while(n>s);return r},mn=function(e,t,i){const s=[0],n=[];for(var r=0;r<e.length;r++)s[s.length-1]+=e[r].length,!0===t[r]?(s.push(0),n.push(e[r].charAt(e[r].length-1))):!1===t[r]&&s[s.length-1]++;for(e=Math.max(...s),t=0,r=0;r<s.length;r++)t-=2*Math.pow(Math.abs(i-s[r]),1.5),t-=Math.pow(e-s[r],1.5),".?!".includes(n[r])?t+=i/3:",;)]}".includes(n[r])&&(t+=i/4);return s.length>1&&s[s.length-1]<=s[s.length-2]&&(t+=.5),t},gi=function(e,t,i){let n,s=mn(e,t,i);for(let r=0;r<t.length-1;r++){if(t[r]===t[r+1])continue;const a=[].concat(t);a[r]=!a[r],a[r+1]=!a[r+1];const $=mn(e,a,i);$>s&&(s=$,n=a)}return n?gi(e,n,i):t},ea=function(e,t){const i=[];for(let s=0;s<e.length;s++)i.push(e[s]),void 0!==t[s]&&i.push(t[s]?"\n":" ");return i.join("")},o.isNumber$$module$build$src$core$utils$string=function(e){return/^\s*-?\d+(\.\d+)?\s*$/.test(e)},ta=function(e){Ha=e},oa=function(){return Ha},ia=function(){return Zl},sa=function(){return we},$i=function(e){if(e=Mr(e)){for(e=e.tooltip;"function"==typeof e;)e=e();if("string"!=typeof e)throw Error("Tooltip function must return a string.");return e}return""},Mr=function(e){for(;e&&e.tooltip;){if("string"==typeof e.tooltip||"function"==typeof e.tooltip)return e;e=e.tooltip}return null},Nr=function(){document.querySelector(".blocklyTooltipDiv")||((we=document.createElement("div")).className="blocklyTooltipDiv",(tn()||document.body).appendChild(we))},cs=function(e){e.mouseOverWrapper_=qe(e,"pointerover",null,na),e.mouseOutWrapper_=qe(e,"pointerout",null,ra),e.addEventListener("pointermove",Dr,!1)},Lr=function(e){e&&(K(e.mouseOverWrapper_),K(e.mouseOutWrapper_),e.removeEventListener("pointermove",Dr))},na=function(e){Hn||(e=Mr(e.currentTarget),At!==e&&(Vt(),Wl=null,At=e),clearTimeout(hm))},ra=function(e){Hn||(hm=setTimeout(function(){Wl=At=null,Vt()},1),clearTimeout(xs),xs=0)},Dr=function(e){if(At&&At.tooltip&&!Hn)if(Zl){const t=cp-e.pageX;e=ap-e.pageY,Math.sqrt(t*t+e*e)>pm&&Vt()}else Wl!==At&&(clearTimeout(xs),cp=e.pageX,ap=e.pageY,xs=setTimeout(ua,gm))},Br=function(){Wl=At=null,Vt()},Vt=function(){Zl&&(Zl=!1,we&&(we.style.display="none")),xs&&(clearTimeout(xs),xs=0)},Pr=function(){Vt(),Hn=!0},Fr=function(){Hn=!1},la=function(){we&&At&&("function"==typeof Ha?Ha(we,At):ca())},ca=function(){var e=$i(At);e=(e=o.wrap$$module$build$src$core$utils$string(e,dm)).split("\n");for(let t=0;t<e.length;t++){const i=document.createElement("div");i.appendChild(document.createTextNode(e[t])),we.appendChild(i)}},aa=function(e){const t=document.documentElement.clientWidth,i=document.documentElement.clientHeight;let s=cp;s=e?s-(up+we.offsetWidth):s+up;let n=ap+dp;return n+we.offsetHeight>i+window.scrollY&&(n-=we.offsetHeight+2*dp),e?s=Math.max(Va-window.scrollX,s):s+we.offsetWidth>t+window.scrollX-2*Va&&(s=t-we.offsetWidth-2*Va),{x:s,y:n}},ua=function(){if(!Hn&&(Wl=At,we)){we.textContent="",la();var e=At.RTL;we.style.direction=e?"rtl":"ltr",we.style.display="block",Zl=!0;var{x:t,y:i}=aa(e);we.style.left=t+"px",we.style.top=i+"px"}},Ur=function(){return hp},da=function(e){hp=e},Hr=function(){return pp},ha=function(e){pp=e},mi=function(e){e=`${e}`.toLowerCase().trim();var t=$m[e];if(t||(t="0x"===e.substring(0,2)?"#"+e.substring(2):e,/^#[0-9a-f]{6}$/.test(t="#"===t[0]?t:"#"+t)))return t;if(/^#[0-9a-f]{3}$/.test(t))return["#",t[1],t[1],t[2],t[2],t[3],t[3]].join("");var i=e.match(/^(?:rgb)?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/);return i&&(e=Number(i[1]),t=Number(i[2]),i=Number(i[3]),e>=0&&e<256&&t>=0&&t<256&&i>=0&&i<256)?as(e,t,i):null},as=function(e,t,i){return t=e<<16|t<<8|i,e<16?"#"+(16777216|t).toString(16).substr(1):"#"+t.toString(16)},_n=function(e){return(e=mi(e))?[(e=parseInt(e.substr(1),16))>>16,e>>8&255,255&e]:[0,0,0]},bn=function(e,t,i){let s=0,n=0,r=0;if(0===t)r=n=s=i;else{const a=Math.floor(e/60),$=e/60-a;e=i*(1-t);const C=i*(1-t*$);switch(t=i*(1-t*(1-$)),a){case 1:s=C,n=i,r=e;break;case 2:s=e,n=i,r=t;break;case 3:s=e,n=C,r=i;break;case 4:s=t,n=e,r=i;break;case 5:s=i,n=e,r=C;break;case 6:case 0:s=i,n=t,r=e}}return as(Math.floor(s),Math.floor(n),Math.floor(r))},Mo=function(e,t,i){return(e=mi(e))&&(t=mi(t))?(e=_n(e),t=_n(t),as(Math.round(t[0]+i*(e[0]-t[0])),Math.round(t[1]+i*(e[1]-t[1])),Math.round(t[2]+i*(e[2]-t[2])))):null},Vr=function(e){return bn(e,hp,255*pp)},g=function(e,t,i){const s=[];var n=e.split("");n.push("");var r=0;e=[];let a=null;for(let F=0;F<n.length;F++){var $=n[F];if(0===r)if("%"===$)(r=e.join(""))&&s.push(r),e.length=0,r=1;else if(i&&"\n"===$){const me=e.join("");me&&s.push(me),e.length=0,s.push($)}else e.push($);else if(1===r)"%"===$?(e.push($),r=0):t&&"0"<=$&&$<="9"?(r=2,a=$,($=e.join(""))&&s.push($),e.length=0):"{"===$?r=3:(e.push("%",$),r=0);else if(2===r)if("0"<=$&&$<="9")a+=$;else{var C=void 0;s.push(parseInt(null!=(C=a)?C:"",10)),F--,r=0}else 3===r&&(""===$?(e.splice(0,0,"%{"),F--,r=0):"}"!==$?e.push($):(r=e.join(""),/[A-Z]\w*/i.test(r)&&($=($=r.toUpperCase()).startsWith("BKY_")?$.substring(4):null)&&$ in o.Msg$$module$build$src$core$msg?"string"==typeof(r=o.Msg$$module$build$src$core$msg[$])?Array.prototype.push.apply(s,g(r,t,i)):s.push(t?`${r}`:r):s.push("%{"+r+"}"),r=e.length=0))}for((t=e.join(""))&&s.push(t),C=[],e.length=0,n=0;n<s.length;n++)"string"!=typeof s[n]||i&&"\n"===s[n]?((t=e.join(""))&&C.push(t),e.length=0,C.push(s[n])):e.push(s[n]);return(t=e.join(""))&&C.push(t),e.length=0,C},x=function(e){return g(e,!0,!0)},l=function(e){return"string"!=typeof e?e:(e=g(e,!1,!1)).length?String(e[0]):""},p=function(e){let t=!0;const i=o.Msg$$module$build$src$core$msg,s=e.match(/%{BKY_[A-Z]\w*}/gi);if(s)for(let n=0;n<s.length;n++)void 0===i[s[n].toUpperCase().slice(6,-1)]&&(console.warn("No message string for "+s[n]+" in "+e),t=!1);return t},d=function(e){const t="string"==typeof e?l(e):e;var i=Number(t);if(!isNaN(i)&&0<=i&&i<=360)return{hue:i,hex:bn(i,Ur(),255*Hr())};if(i=mi(t))return{hue:null,hex:i};throw i='Invalid colour: "'+t+'"',e!==t&&(i+=' (from "'+e+'")'),Error(i)},v=function(){return bt},O=function(e){if(bt=e,null===e){let t;null==(t=document.querySelector("."+gp))||t.remove()}},q=function(){const e=tn()||document.body,t=document.querySelector("div."+gp);t?bt=t:((bt=document.createElement("div")).className=gp,bt.tabIndex=-1),L(bt,"keydown",null,sn),e.appendChild(bt)},ce=function(e,t,i,s,n=!0){if(Ct(),Vn=e,Ga=i,i=bt){if(i.style.direction=t?"rtl":"ltr",i.style.display="block",!s&&e instanceof Q){let $;s=null==($=e.getSourceBlock())?void 0:$.workspace}var r,a;_m=null!=(r=s)?r:null,e=null!=(a=s)?a:st(),Gn=e.getRenderer().getClassName(),Zn=e.getTheme().getClassName(),Gn&&A(i,Gn),Zn&&A(i,Zn),n&&(Za=o.getFocusManager$$module$build$src$core$focus_manager().takeEphemeralFocus(i))}},Ct=function(){if(_i()){Vn=null;var e=bt;e&&(e.style.display="none",e.style.left="",e.style.top="",Ga&&(Ga(),Ga=null),e.textContent="",Gn&&(X(e,Gn),Gn=""),Zn&&(X(e,Zn),Zn=""),st().markFocused(),Za&&(Za(),Za=null))}},_i=function(){return!!Vn},je=function(e){Vn===e&&Ct()},Gt=function(e){let t=null===_m,i=e;for(;!t&&i;){if(i===e){t=!0;break}i=e.options.parentWorkspace}t&&Ct()},No=function(e,t,i){bt.style.left=e+"px",bt.style.top=t+"px",bt.style.height=i+"px"},Lo=function(e,t,i,s){const n=fn(e,t,i);e=us(e,t,i,s),n<0?No(e,0,i.height+n):No(e,n,i.height)},us=function(e,t,i,s){return s?Math.min(Math.max(t.right-i.width,e.left),e.right-i.width):Math.max(Math.min(t.left,e.right-i.width),e.left)},fn=function(e,t,i){return t.bottom+i.height>=e.bottom?t.top-i.height:t.bottom},ds=function(e){return!(null==e||!e.repositionForWindowResize)},co=function(){ds(Vn)&&Vn.repositionForWindowResize()||Ct()},bi=function(){return Wa},fi=function(e){Wa=e},It=function(e,t,i,s,n){if(ce(bm,i,Wr,s),t.length){n||(e instanceof PointerEvent?n=new S(e.clientX,e.clientY):(console.warn("Context menu opened with keyboard but no location given"),n=new S(0,0)));var r=hs(t,i,e,n);qa=r,Ti(r,i,n),setTimeout(function(){r.focus()},1),Wa=null}else Ei()},hs=function(e,t,i,s){const n=new Oa;n.setRole(mt.MENU);for(let r=0;r<e.length;r++){const a=e[r];if(a.separator){n.addChild(new Jh);continue}const $=new Bl(a.text);$.setRightToLeft(t),$.setRole(mt.MENUITEM),n.addChild($),$.setEnabled(a.enabled),a.enabled&&$.onAction(function(C,F){Ei(),requestAnimationFrame(()=>{setTimeout(()=>{a.callback(a.scope,i,F,s)},0)})},{})}return n},Ti=function(e,t,i){const s=Ic();i=new z(i.y+s.top,i.y+s.top,i.x+s.left,i.x+s.left),Gr(e);const n=e.getSize();t&&(i.left+=n.width,i.right+=n.width,s.left+=n.width,s.right+=n.width),Lo(s,i,n,t),e.focus()},Gr=function(e){var t=v();if(!t)throw Error("Attempting to create a context menu when widget div is null");t=e.render(t),A(t,"blocklyContextMenu"),L(t,"contextmenu",null,Zr),e.focus()},Zr=function(e){e.preventDefault(),e.stopPropagation()},Ei=function(){je(bm),Wa=null},Wr=function(){qa&&(qa.dispose(),qa=null)},o.callbackFactory$$module$build$src$core$contextmenu=function(e,t){return()=>{let i;o.disable$$module$build$src$core$events$utils();try{i=t instanceof Element?uo(t,e.workspace):ss(t,e.workspace);const s=e.getRelativeToSurfaceXY();s.x=e.RTL?s.x-o.config$$module$build$src$core$config.snapRadius:s.x+o.config$$module$build$src$core$config.snapRadius,s.y+=2*o.config$$module$build$src$core$config.snapRadius,i.moveBy(s.x,s.y)}finally{o.enable$$module$build$src$core$events$utils()}return se()&&!i.isShadow()&&B(new(P(b.BLOCK_CREATE))(i)),o.getFocusManager$$module$build$src$core$focus_manager().focusNode(i),i}},Tn=function(e,t){return(t=Et(t,e.getParentSvg(),e.getInverseScreenCTM())).x/=e.scale,t.y/=e.scale,t},vi=function(e,t,i){t=Tn(e,t),Tm.set(e,S.difference(i,t))},yi=function(e,t){if(t=Tn(e,t),!(e=Tm.get(e)))throw Error("Drag not initialized");return S.sum(e,t)},qr=function(e,t=!1){const i=o.createElement$$module$build$src$core$utils$xml("xml");var s=En(o.allUsedVarModels$$module$build$src$core$variables(e));s.hasChildNodes()&&i.appendChild(s);for(const n of e.getTopComments())i.appendChild(kt(n,t));for(e=e.getTopBlocks(!0),s=0;s<e.length;s++)i.appendChild(Do(e[s],t));return i},kt=function(e,t=!1){const i=o.createElement$$module$build$src$core$utils$xml("comment");t||i.setAttribute("id",e.id),t=e.workspace;const s=e.getRelativeToSurfaceXY();return s.x=t.RTL?t.getWidth()-s.x:s.x,i.setAttribute("x",`${s.x}`),i.setAttribute("y",`${s.y}`),i.setAttribute("w",`${e.getSize().width}`),i.setAttribute("h",`${e.getSize().height}`),e.getText()&&(i.textContent=e.getText()),e.isCollapsed()&&i.setAttribute("collapsed","true"),e.isOwnEditable()||i.setAttribute("editable","false"),e.isOwnMovable()||i.setAttribute("movable","false"),e.isOwnDeletable()||i.setAttribute("deletable","false"),i},En=function(e){const t=o.createElement$$module$build$src$core$utils$xml("variables");for(let i=0;i<e.length;i++){const s=e[i],n=o.createElement$$module$build$src$core$utils$xml("variable");n.appendChild(o.createTextNode$$module$build$src$core$utils$xml(s.getName())),s.getType()&&n.setAttribute("type",s.getType()),n.id=s.getId(),t.appendChild(n)}return t},Do=function(e,t){if(e.isInsertionMarker()&&!(e=e.getChildren(!1)[0]))return new DocumentFragment;let i=0;if(e.workspace.RTL&&(i=e.workspace.getWidth()),t=ao(e,t),In(t)){const s=e.getRelativeToSurfaceXY();t.setAttribute("x",String(Math.round(e.workspace.RTL?i-s.x:s.x))),t.setAttribute("y",String(Math.round(s.y)))}return t},zr=function(e){if(e.isSerializable()){const t=o.createElement$$module$build$src$core$utils$xml("field");return t.setAttribute("name",e.name||""),e.toXml(t)}return null},jr=function(e,t){for(const i of e.getFields())(e=zr(i))&&t.appendChild(e)},ao=function(e,t){if(e.isInsertionMarker())return(t=e.getChildren(!1)[0])?ao(t):new DocumentFragment;const i=o.createElement$$module$build$src$core$utils$xml(e.isShadow()?"shadow":"block");if(i.setAttribute("type",e.type),t||(i.id=e.id),e.mutationToDom){var s=e.mutationToDom();s&&(s.hasChildNodes()||s.hasAttributes())&&i.appendChild(s)}if(jr(e,i),s=e.getCommentText()){var n=e.getIcon(Ce.COMMENT),r=n.getBubbleSize(),a=n.bubbleIsVisible();n=n.getBubbleLocation();var $=o.createElement$$module$build$src$core$utils$xml("comment");$.appendChild(o.createTextNode$$module$build$src$core$utils$xml(s)),$.setAttribute("pinned",`${a}`),$.setAttribute("h",`${r.height}`),$.setAttribute("w",`${r.width}`),n&&($.setAttribute("x",`${e.workspace.RTL?e.workspace.getWidth()-(n.x+r.width):n.x}`),$.setAttribute("y",`${n.y}`)),i.appendChild($)}for(e.data&&((s=o.createElement$$module$build$src$core$utils$xml("data")).appendChild(o.createTextNode$$module$build$src$core$utils$xml(e.data)),i.appendChild(s)),s=0;s<e.inputList.length;s++){var C=void 0;a=!0,(r=e.inputList[s]).type!==o.inputTypes$$module$build$src$core$inputs$input_types.DUMMY&&r.type!==o.inputTypes$$module$build$src$core$inputs$input_types.END_ROW&&(n=r.connection.targetBlock(),r.type===o.inputTypes$$module$build$src$core$inputs$input_types.VALUE?C=o.createElement$$module$build$src$core$utils$xml("value"):r.type===o.inputTypes$$module$build$src$core$inputs$input_types.STATEMENT&&(C=o.createElement$$module$build$src$core$utils$xml("statement")),!($=r.connection.getShadowDom())||n&&n.isShadow()||C.appendChild(vn($,t)),n&&(n=ao(n,t)).nodeType===qo.ELEMENT_NODE&&(C.appendChild(n),a=!1),C.setAttribute("name",r.name),a||i.appendChild(C))}let F;return void 0!==e.inputsInline&&e.inputsInline!==e.inputsInlineDefault&&i.setAttribute("inline",String(e.inputsInline)),e.isCollapsed()&&i.setAttribute("collapsed","true"),e.isEnabled()||i.setAttribute("disabled-reasons",Array.from(e.getDisabledReasons()).map(encodeURIComponent).join(",")),e.isOwnDeletable()||i.setAttribute("deletable","false"),e.isOwnMovable()||i.setAttribute("movable","false"),e.isOwnEditable()||i.setAttribute("editable","false"),(C=e.getNextBlock())&&(s=ao(C,t)).nodeType===qo.ELEMENT_NODE&&(F=o.createElement$$module$build$src$core$utils$xml("next"),F.appendChild(s),i.appendChild(F)),!(e=e.nextConnection&&e.nextConnection.getShadowDom())||C&&C.isShadow()||F.appendChild(vn(e,t)),i},vn=function(e,t){let s,i=e=e.cloneNode(!0);for(;i;)if(t&&"shadow"===i.nodeName&&i.removeAttribute("id"),i.firstChild)i=i.firstChild;else{for(;i&&!i.nextSibling;){let n;s=i,i=i.parentNode,s.nodeType===qo.TEXT_NODE&&""===s.data.trim()&&(null==(n=i)?void 0:n.firstChild)!==s&&J(s)}i&&(s=i,i=i.nextSibling,s.nodeType===qo.TEXT_NODE&&""===s.data.trim()&&J(s))}return e},ht=function(e){return Qi(e).replace(/<(\w+)([^<]*)\/>/g,"<$1$2></$1>")},Xr=function(e){e=ht(e).split("<");let t="";for(let i=1;i<e.length;i++){const s=e[i];"/"===s[0]&&(t=t.substring(2)),e[i]=t+"<"+s,"/"!==s[0]&&"/>"!==s.slice(-2)&&(t+="  ")}return(e=(e=e.join("\n")).replace(/(<(\w+)\b[^>]*>[^\n]*)\n *<\/\2>/g,"$1</$2>")).replace(/^\n/,"")},Yr=function(e,t){return t.setResizesEnabled(!1),t.clear(),e=o.domToWorkspace$$module$build$src$core$xml(e,t),t.setResizesEnabled(!0),e},o.domToWorkspace$$module$build$src$core$xml=function(e,t){let i=0;t.RTL&&(i=t.getWidth());const s=[];_();const n=o.getGroup$$module$build$src$core$events$utils();n||o.setGroup$$module$build$src$core$events$utils(!0),t.setResizesEnabled&&t.setResizesEnabled(!1);let r=!0;try{for(let $,a=0;$=e.childNodes[a];a++){const C=$.nodeName.toLowerCase(),F=$;if("block"===C||"shadow"===C&&!ke()){const me=uo(F,t);let re;s.push(me.id);const We=parseInt(null!=(re=F.getAttribute("x"))?re:"10",10);let Jo;const To=parseInt(null!=(Jo=F.getAttribute("y"))?Jo:"10",10);isNaN(We)||isNaN(To)||me.moveBy(t.RTL?i-We:We,To,["create"]),r=!1}else{if("shadow"===C)throw TypeError("Shadow block cannot be a top-level block.");if("comment"===C)St(F,t);else if("variables"===C){if(!r)throw Error("'variables' tag must exist once before block and shadow tag elements in the workspace XML, but it was found in another location.");yn(F,t),r=!1}}}}finally{o.setGroup$$module$build$src$core$events$utils(n),t.setResizesEnabled&&t.setResizesEnabled(!0),t.rendered&&Ao(),T()}return B(new(P(b.FINISHED_LOADING))(t)),s},St=function(e,t){var i;const s=null!=(i=e.getAttribute("id"))?i:void 0;var n,r;let a;var $;let C;return(i=t.rendered?new jt(t,s):new jl(t,s)).setText(null!=(n=e.textContent)?n:""),n=parseInt(null!=(r=e.getAttribute("x"))?r:"",10),r=parseInt(null!=(a=e.getAttribute("y"))?a:"",10),isNaN(n)||isNaN(r)||(n=t.RTL?t.getWidth()-n:n,i.moveTo(new S(n,r))),t=parseInt(null!=($=e.getAttribute("w"))?$:"",10),$=parseInt(null!=(C=e.getAttribute("h"))?C:"",10),isNaN(t)||isNaN($)||i.setSize(new j(t,$)),"true"===e.getAttribute("collapsed")&&i.setCollapsed(!0),"false"===e.getAttribute("editable")&&i.setEditable(!1),"false"===e.getAttribute("movable")&&i.setMovable(!1),"false"===e.getAttribute("deletable")&&i.setDeletable(!1),i},pa=function(e,t){if(!t.getBlocksBoundingBox)return o.domToWorkspace$$module$build$src$core$xml(e,t);var i=t.getBlocksBoundingBox();if(e=o.domToWorkspace$$module$build$src$core$xml(e,t),i&&i.top!==i.bottom){var s=i.bottom;i=t.RTL?i.right:i.left;var n=1/0;let r=-1/0,a=1/0;for(let $=0;$<e.length;$++){const C=t.getBlockById(e[$]).getRelativeToSurfaceXY();C.y<a&&(a=C.y),C.x<n&&(n=C.x),C.x>r&&(r=C.x)}for(s=s-a+10,i=t.RTL?i-r:i-n,n=0;n<e.length;n++)t.getBlockById(e[n]).moveBy(i,s,["create"])}return e},o.domToBlock$$module$build$src$core$xml=function(e,t){return e=uo(e,t),t.rendered&&Ao(),e},uo=function(e,t){o.disable$$module$build$src$core$events$utils();var i=t.getAllVariables();let s;try{if(s=gs(e,t),t.rendered){const n=s,r=s.getDescendants(!1);n.setConnectionTracking(!1);for(let a=r.length-1;a>=0;a--)r[a].initSvg();for(let a=r.length-1;a>=0;a--)r[a].queueRender();setTimeout(function(){n.disposed||n.setConnectionTracking(!0)},1),t.resizeContents()}else{const n=s.getDescendants(!1);for(let r=n.length-1;r>=0;r--)n[r].initModel()}}finally{o.enable$$module$build$src$core$events$utils()}if(se()){for(e=hn(t,i),t=0;t<e.length;t++)i=e[t],B(new(P(b.VAR_CREATE))(i));B(new(P(b.BLOCK_CREATE))(s))}return s},yn=function(e,t){for(let s=0;s<e.children.length;s++){var i=e.children[s];const n=i.getAttribute("type"),r=i.getAttribute("id");if(!(i=i.textContent))break;let a;t.getVariableMap().createVariable(i,null!=(a=n)?a:void 0,r)}},Kr=function(e){const t={mutation:[],comment:[],data:[],field:[],input:[],next:[]};for(let i=0;i<e.children.length;i++){const s=e.children[i];if(s.nodeType!==qo.TEXT_NODE)switch(s.nodeName.toLowerCase()){case"mutation":t.mutation.push(s);break;case"comment":t.comment.push(s);break;case"data":t.data.push(s);break;case"title":case"field":t.field.push(s);break;case"value":case"statement":t.input.push(s);break;case"next":t.next.push(s);break;default:console.warn("Ignoring unknown tag: "+s.nodeName)}}return t},Jr=function(e,t){let i=!1;for(let s=0;s<e.length;s++)t.domToMutation&&(t.domToMutation(e[s]),t.initSvg&&(i=!0));return i},ps=function(e,t){for(let i=0;i<e.length;i++){const s=e[i],n=s.textContent,r="true"===s.getAttribute("pinned");let a;const $=parseInt(null!=(a=s.getAttribute("w"))?a:"50",10);let C;const F=parseInt(null!=(C=s.getAttribute("h"))?C:"50",10);let me,We,re=parseInt(null!=(me=s.getAttribute("x"))?me:"",10);const Jo=parseInt(null!=(We=s.getAttribute("y"))?We:"",10);t.setCommentText(n);const To=t.getIcon(Ce.COMMENT);isNaN($)||isNaN(F)||To.setBubbleSize(new j($,F)),To.setBubbleVisible(r),setTimeout(()=>{isNaN(re)||isNaN(Jo)||(re=t.workspace.RTL?t.workspace.getWidth()-(re+$):re,To.setBubbleLocation(new S(re,Jo))),To.setBubbleVisible(r)},1)}},Qr=function(e,t){for(let i=0;i<e.length;i++)t.data=e[i].textContent},el=function(e,t){for(let i=0;i<e.length;i++){const s=e[i],n=s.getAttribute("name");n?Cn(t,n,s):console.warn(`Ignoring unnamed field in block ${t.type}`)}},Ci=function(e){let t=null,i=null;for(let s=0;s<e.childNodes.length;s++){const n=e.childNodes[s];In(n)&&("block"===n.nodeName.toLowerCase()?t=n:"shadow"===n.nodeName.toLowerCase()&&(i=n))}return{childBlockElement:t,childShadowElement:i}},tl=function(e,t,i,s){for(let r=0;r<e.length;r++){var n=e[r];const a=n.getAttribute("name"),$=a?i.getInput(a):null;if(!$){console.warn("Ignoring non-existent input "+a+" in block "+s);break}if((n=Ci(n)).childBlockElement){if(!$.connection)throw TypeError("Input connection does not exist.");gs(n.childBlockElement,t,$.connection,!1)}if(n.childShadowElement){let C;null==(C=$.connection)||C.setShadowDom(n.childShadowElement)}}},ol=function(e,t,i){for(let s=0;s<e.length;s++){const n=Ci(e[s]);if(n.childBlockElement){if(!i.nextConnection)throw TypeError("Next statement does not exist.");if(i.nextConnection.isConnected())throw TypeError("Next statement is already connected.");gs(n.childBlockElement,t,i.nextConnection,!0)}n.childShadowElement&&i.nextConnection&&i.nextConnection.setShadowDom(n.childShadowElement)}},gs=function(e,t,i,s){var n;const r=e.getAttribute("type");if(!r)throw TypeError("Block type unspecified: "+e.outerHTML);var a=null!=(n=e.getAttribute("id"))?n:void 0;n=t.newBlock(r,a),a=Kr(e);const $=Jr(a.mutation,n);if(ps(a.comment,n),Qr(a.data,n),i)if(s){if(!n.previousConnection)throw TypeError("Next block does not have previous statement.");i.connect(n.previousConnection)}else if(n.outputConnection)i.connect(n.outputConnection);else{if(!n.previousConnection)throw TypeError("Child block does not have output or previous statement.");i.connect(n.previousConnection)}if(el(a.field,n),tl(a.input,t,n,r),ol(a.next,t,n),$&&n.initSvg(),(t=e.getAttribute("inline"))&&n.setInputsInline("true"===t),(t=e.getAttribute("disabled"))&&n.setDisabledReason("true"===t||"disabled"===t,xt),null!==(t=e.getAttribute("disabled-reasons")))for(var C of t.split(","))n.setDisabledReason(!0,decodeURIComponent(C));if((C=e.getAttribute("deletable"))&&n.setDeletable("true"===C),(C=e.getAttribute("movable"))&&n.setMovable("true"===C),(C=e.getAttribute("editable"))&&n.setEditable("true"===C),(C=e.getAttribute("collapsed"))&&n.setCollapsed("true"===C),"shadow"===e.nodeName.toLowerCase()){for(e=n.getChildren(!1),C=0;C<e.length;C++)if(!e[C].isShadow())throw TypeError("Shadow block not allowed non-shadow child.");n.setShadow(!0)}return n},Cn=function(e,t,i){const s=e.getField(t);s?s.fromXml(i):console.warn("Ignoring non-existent field "+t+" in block "+e.type)},il=function(e){for(let t=0;t<e.childNodes.length;t++){const i=e.childNodes[t];if("next"===i.nodeName.toLowerCase()){e.removeChild(i);break}}},In=function(e){return e.nodeType===qo.ELEMENT_NODE},pt=function(e,t){U(k.FIELD,e,t)},sl=function(e){et(k.FIELD,e)},o.fromJson$$module$build$src$core$field_registry=function(e){return vm.fromJsonInternal(e)},kn=function(e){const t=Tt(k.FIELD,e.type);return t?t.fromJson(e):(console.warn("Blockly could not create a field of type "+e.type+". The field is probably not being registered. This could be because the file is not loaded, the field does not register itself (Issue #1584), or the registration is not being reached."),null)},Bo=function(e){return e&&"object"==typeof e&&"src"in e&&"string"==typeof e.src&&"alt"in e&&"string"==typeof e.alt&&"width"in e&&"number"==typeof e.width&&"height"in e&&"number"==typeof e.height},o.register$$module$build$src$core$extensions=function(e,t){if("string"!=typeof e||""===e.trim())throw Error('Error: Invalid extension name "'+e+'"');if(zn[e])throw Error('Error: Extension "'+e+'" is already registered.');if("function"!=typeof t)throw Error('Error: Extension "'+e+'" must be a function');zn[e]=t},o.registerMixin$$module$build$src$core$extensions=function(e,t){if(!t||"object"!=typeof t)throw Error('Error: Mixin "'+e+'" must be a object');o.register$$module$build$src$core$extensions(e,function(){this.mixin(t)})},o.registerMutator$$module$build$src$core$extensions=function(e,t,i,s){const n='Error when registering mutator "'+e+'": ';xn(n,t);const r=cl(t,n);if(i&&"function"!=typeof i)throw Error(n+'Extension "'+e+'" is not a function');o.register$$module$build$src$core$extensions(e,function(){r&&this.setMutator(new o.MutatorIcon$$module$build$src$core$icons$mutator_icon(s||[],this)),this.mixin(t),i&&i.apply(this)})},nl=function(e){Sn(e)?delete zn[e]:console.warn('No extension mapping for name "'+e+'" found to unregister')},Sn=function(e){return!!zn[e]},$s=function(e,t,i){const s=zn[e];if("function"!=typeof s)throw Error('Error: Extension "'+e+'" not found.');let n;if(i?rl(e,t):n=ms(t),s.apply(t),i)xn('Error after applying mutator "'+e+'": ',t);else if(!al(n,t))throw Error('Error when applying extension "'+e+'": mutation properties changed when applying a non-mutator extension.')},rl=function(e,t){if(ms(t).length)throw Error('Error: tried to apply mutation "'+e+'" to a block that already has mutator functions.  Block id: '+t.id)},wn=function(e,t){return Po(e.mutationToDom,e.domToMutation,t+" mutationToDom/domToMutation")},ll=function(e,t){return Po(e.saveExtraState,e.loadExtraState,t+" saveExtraState/loadExtraState")},cl=function(e,t){return Po(e.compose,e.decompose,t+" compose/decompose")},Po=function(e,t,i){if(e&&t){if("function"!=typeof e||"function"!=typeof t)throw Error(i+" must be a function");return!0}if(!e&&!t)return!1;throw Error(i+"Must have both or neither functions")},xn=function(e,t){const i=wn(t,e),s=ll(t,e);if(!i&&!s)throw Error(e+"Mutations must contain either XML hooks, or JSON hooks, or both");cl(t,e)},ms=function(e){const t=[];return void 0!==e.domToMutation&&t.push(e.domToMutation),void 0!==e.mutationToDom&&t.push(e.mutationToDom),void 0!==e.saveExtraState&&t.push(e.saveExtraState),void 0!==e.loadExtraState&&t.push(e.loadExtraState),void 0!==e.compose&&t.push(e.compose),void 0!==e.decompose&&t.push(e.decompose),t},al=function(e,t){if((t=ms(t)).length!==e.length)return!1;for(let i=0;i<t.length;i++)if(e[i]!==t[i])return!1;return!0},ul=function(e){if("object"!=typeof document)throw Error("runAfterPageLoad() requires browser document.");if("complete"===document.readyState)e();else{const t=setInterval(function(){"complete"===document.readyState&&(clearInterval(t),e())},10)}},o.buildTooltipForDropdown$$module$build$src$core$extensions=function(e,t){const i=[];return function(){i.includes(this.type)||(dl(this,e,t),i.push(this.type)),this.setTooltip(function(){const s=String(this.getFieldValue(e));return l(t[s])}.bind(this))}},dl=function(e,t,i){var s=e.getField(t);if(s instanceof He&&!s.isOptionListDynamic()){s=s.getOptions();for(const n of s)n!==He.SEPARATOR&&([,s]=n,void 0===i[s]&&console.warn(`No tooltip mapping for value ${s} of field ${t} of block type ${e.type}.`))}},o.buildTooltipWithFieldText$$module$build$src$core$extensions=function(e,t){return function(){this.setTooltip(function(){const i=this.getField(t);return l(e).replace("%1",i?i.getText():"")}.bind(this))}},hl=function(){const e=this.tooltip;this.setTooltip(function(){const t=this.getParent();return t&&t.getInputsInline()&&t.tooltip||e}.bind(this))},D=function(e,t){return" "+e+","+t+" "},Pe=function(e,t){return" "+e+t.join("")},Se=function(e,t){return" M "+e+","+t+" "},ae=function(e,t){return" m "+e+","+t+" "},gt=function(e,t){return" l "+e+","+t+" "},lt=function(e){return" l"+e.join("")},M=function(e,t){return" "+e+" "+t+" "},he=function(e,t,i,s){return e+" "+i+" "+i+" "+t+s},pl=function(e,t){if(!e||!t)throw Error("Cannot connect null connections.");e.targetConnection=t,t.targetConnection=e},Fo=function(e,t){let i=null;t=t.outputConnection;const s=t?.getConnectionChecker();for(let r,n=0;r=e.inputList[n];n++){const a=r.connection;let $;if(a&&null!=($=s)&&$.canConnect(t,a,!1)){if(i)return null;i=a}}return i},Zt=function(e,t){let i;for(;i=Fo(e,t);)if(!(e=i.targetBlock())||e.isShadow())return i;return null},_s=function(e){return ai(e)&&"function"==typeof e.getType&&"function"==typeof e.initView&&"function"==typeof e.dispose&&"function"==typeof e.getWeight&&"function"==typeof e.getSize&&"function"==typeof e.applyColour&&"function"==typeof e.hideForInsertionMarker&&"function"==typeof e.updateEditable&&"function"==typeof e.updateCollapsed&&"function"==typeof e.isShownWhenCollapsed&&"function"==typeof e.setOffsetInBlock&&"function"==typeof e.onLocationChange&&"function"==typeof e.onClick},wt=function(e){return _s(e)&&Oo(e)&&es(e)&&"function"==typeof e.setText&&"function"==typeof e.getText&&"function"==typeof e.setBubbleSize&&"function"==typeof e.getBubbleSize&&"function"==typeof e.setBubbleLocation&&"function"==typeof e.getBubbleLocation&&e.getType()===Ce.COMMENT},bs=function(e){if(!(e.getDescendants(!1).length>100)){var t=e.workspace,i=e.getSvgRoot();t.getAudioManager().play("delete");var r,s=e.getRelativeToSurfaceXY(),n=i.cloneNode(!0);n.setAttribute("transform","translate("+s.x+","+s.y+")"),null==(r=t.getLayerManager())||r.appendToAnimationLayer({getSvgRoot:()=>n}),An(n,{x:s.x,y:s.y,width:e.width,height:e.height},t.RTL,new Date)}},An=function(e,t,i,s){const n=((new Date).getTime()-s.getTime())/150;n>1?J(e):(e.setAttribute("transform","translate("+(t.x+(i?-1:1)*t.width/2*n)+","+(t.y+t.height/2*n)+") scale("+(1-n)+")"),setTimeout(An,10,e,t,i,s))},fs=function(e){var t=e.workspace;const i=t.scale;if(t.getAudioManager().play("click"),!(i<1)){var s=t.getSvgXY(e.getSvgRoot());e.outputConnection?(s.x+=(e.RTL?3:-3)*i,s.y+=13*i):e.previousConnection&&(s.x+=(e.RTL?-23:23)*i,s.y+=3*i);var n=I(f.CIRCLE,{cx:s.x,cy:s.y,r:0,fill:"none",stroke:"#888","stroke-width":10},t.getParentSvg());e=I(f.ANIMATE,{id:"animationCircle",begin:"indefinite",attributeName:"r",dur:"150ms",from:0,to:25*i},n),t=I(f.ANIMATE,{id:"animationOpacity",begin:"indefinite",attributeName:"opacity",dur:"150ms",from:1,to:0},n),e.beginElement(),t.beginElement(),setTimeout(()=>{J(n)},150)}},Rn=function(e){if(ho(),e.workspace.getAudioManager().play("disconnect"),!(e.workspace.scale<1)){var t=e.getHeightWidth().height;t=Math.atan(10/t)/Math.PI*180,e.RTL||(t*=-1),Jl=e,gl(e,t,new Date,0)}},gl=function(e,t,i,s){const n=[.66,1,.66,0,-.66,-1,-.66,0];let r="";i.getTime()+200>(new Date).getTime()&&(r=`skewX(${Math.round(n[s%n.length]*t)})`,nu=setTimeout(gl,15,e,t,i,s+1)),e.getSvgRoot().setAttribute("transform",`${e.getTranslation()} ${r}`)},ho=function(){Jl&&(nu&&(clearTimeout(nu),nu=null),Jl.getSvgRoot().setAttribute("transform",Jl.getTranslation()),Jl=null)},$l=function(e,t){const i=e.workspace,s=o.config$$module$build$src$core$config.snapRadius,n=S.difference(t,e.getRelativeToSurfaceXY()),r=new S(0,0),a=i.getAllBlocks(!1).filter($=>$.id!=e.id).map($=>$.getRelativeToSurfaceXY());for(;ml(S.sum(t,r),a)||_l(e,S.sum(n,r),s);)r.translate(i.RTL?-s:s,2*s);e.moveTo(S.sum(t,r))},ml=function(e,t){return t.some(i=>Math.abs(i.x-e.x)<=1&&Math.abs(i.y-e.y)<=1)},_l=function(e,t,i){return e.getConnections_(!1).some(s=>!!s.closest(i,t).connection)},Uo=function(e,t,i){const s=i.getBoundingRectangle(),n=s.right-s.left,r=ns(t.top,s.top,t.top+t.height-(s.bottom-s.top))-s.top;let a=t.left;return t=t.left+t.width-n,e.RTL?a=Math.min(t,a):t=Math.max(a,t),!(!(e=ns(a,s.left,t)-s.left)&&!r||(i.moveBy(e,r,["inbounds"]),0))},On=function(e){return t=>{var s,i=e.getMetricsManager();if(i.hasFixedEdges()&&!e.isDragging())if(Dh.includes(null!=(s=t.type)?s:"")){s=i.getScrollMetrics(!0);const n=bl(e,t);n&&(i=o.getGroup$$module$build$src$core$events$utils()||!1,o.setGroup$$module$build$src$core$events$utils(t.group),Uo(e,s,n)&&!t.group&&console.warn("Moved object in bounds but there was no event group. This may break undo."),o.setGroup$$module$build$src$core$events$utils(i))}else yo(t)&&t.scale&&t.oldScale&&t.scale>t.oldScale&&Mn(e)}},bl=function(e,t){let i=null;switch(t.type){case b.BLOCK_CREATE:case b.BLOCK_MOVE:(i=e.getBlockById(t.blockId))&&(i=i.getRootBlock());break;case b.COMMENT_CREATE:case b.COMMENT_MOVE:case b.COMMENT_RESIZE:i=e.getCommentById(t.commentId)}return i},Mn=function(e){var t=e.getMetricsManager();if(t.hasFixedEdges()&&!e.isDragging()){t=t.getScrollMetrics(!0);var i=e.getTopBoundedElements();for(let n,s=0;n=i[s];s++)Uo(e,t,n)}},Xe=function(e){return e&&"function"==typeof e.isDeletable&&"function"==typeof e.dispose&&"function"==typeof e.setDeleteStyle},Nn=function(e,t){const i=e.getIcons();for(const s of e.inputList){if(!s.isVisible())continue;let n;if(i.push(...s.fieldRow),null!=(n=s.connection)&&n.targetBlock())if(e=s.connection.targetBlock(),s.connection.type!==N.NEXT_STATEMENT||t)i.push(e);else{let r;(e=null==(r=e.lastConnectionInStack(!1))?void 0:r.getSourceBlock())&&i.push(e)}else{let r;(null==(r=s.connection)?void 0:r.type)===N.INPUT_VALUE&&i.push(s.connection)}}return i},Ho=function(e,t){const i=e.workspace.getTopBoundedElements(!0).filter(n=>ai(n));let s=null;if((e=i.indexOf(e instanceof ie?e.getRootBlock():e)+t)>=0&&e<i.length?s=i[e]:e<0?s=i[i.length-1]:e>=i.length&&(s=i[0]),t<0&&s instanceof ie){let n,r;return null!=(r=null==(n=s.lastConnectionInStack(!1))?void 0:n.getSourceBlock())?r:s}return s},H=function(e,t){var i;let s;const n=e instanceof ie?null!=(s=null==(i=e.outputConnection)?void 0:i.targetBlock())?s:e.getSurroundParent():e.getSourceBlock();return n instanceof ie&&-1!==(e=(i=Nn(n,t>0)).indexOf(e))&&(t=e+t)>=0&&t<i.length?i[t]:null},V=function(e){return e&&"function"==typeof e.getRelativeToSurfaceXY&&"function"==typeof e.isMovable&&"function"==typeof e.startDrag&&"function"==typeof e.drag&&"function"==typeof e.endDrag&&"function"==typeof e.revertDrag},Oe=function(e){return e&&"function"==typeof e.autoHide},Pd=function(e,t){U(k.ICON,e.toString(),t)},Dg=function(e){et(k.ICON,e)},Vo=function(e){return"function"==typeof e.getProcedureModel&&"function"==typeof e.doProcedureUpdate&&"function"==typeof e.isProcedureDef},fl=function(e){return e&&"function"==typeof e.startPublishing&&"function"==typeof e.stopPublishing},Tl=function(e){const t=e.getProcedureMap().getProcedures().filter(s=>!s.getReturnTypes()).map(s=>[s.getName(),s.getParameters().map(n=>n.getName()),!1]);e.getBlocksByType("procedures_defnoreturn",!1).forEach(s=>{!Vo(s)&&di(s)&&t.push(s.getProcedureDef())});const i=e.getProcedureMap().getProcedures().filter(s=>!!s.getReturnTypes()).map(s=>[s.getName(),s.getParameters().map(n=>n.getName()),!0]);return e.getBlocksByType("procedures_defreturn",!1).forEach(s=>{!Vo(s)&&di(s)&&i.push(s.getProcedureDef())}),t.sort(Fd),i.sort(Fd),[t,i]},Fd=function(e,t){return e[0].localeCompare(t[0],void 0,{sensitivity:"base"})},o.findLegalName$$module$build$src$core$procedures=function(e,t){if(t.isInFlyout)return e;for(e=e||o.Msg$$module$build$src$core$msg.UNNAMED_KEY||"unnamed";!Bg(e,t.workspace,t);){const i=e.match(/^(.*?)(\d+)$/);e=i?i[1]+(parseInt(i[2])+1):e+"2"}return e},Bg=function(e,t,i){return!Ud(e,t,i)},Ud=function(e,t,i){for(const s of t.getAllBlocks(!1))if(s!==i&&di(s)&&o.Names$$module$build$src$core$names.equals(s.getProcedureDef()[0],e))return!0;i=i&&Vo(i)?i?.getProcedureModel():void 0;for(const s of t.getProcedureMap().getProcedures())if(s!==i&&o.Names$$module$build$src$core$names.equals(s.getName(),e))return!0;return!1},o.rename$$module$build$src$core$procedures=function(e){var t=this.getSourceBlock();if(!t)throw new fe;e=e.trim();const i=o.findLegalName$$module$build$src$core$procedures(e,t);Vo(t)&&!t.isInsertionMarker()&&t.getProcedureModel().setName(i);const s=this.getValue();if(s!==e&&s!==i)for(e=t.workspace.getAllBlocks(!1),t=0;t<e.length;t++){const n=e[t];n.renameProcedure&&n.renameProcedure(s,i)}return i},Pg=function(e){function t(r,a){for(let C=0;C<r.length;C++){var $=r[C][0];const F=r[C][1],me=o.createElement$$module$build$src$core$utils$xml("block");me.setAttribute("type",a),me.setAttribute("gap","16");const re=o.createElement$$module$build$src$core$utils$xml("mutation");for(re.setAttribute("name",$),me.appendChild(re),$=0;$<F.length;$++){const We=o.createElement$$module$build$src$core$utils$xml("arg");We.setAttribute("name",F[$]),re.appendChild(We)}i.push(me)}}const i=[];if(ue.procedures_defnoreturn){var s=o.createElement$$module$build$src$core$utils$xml("block");s.setAttribute("type","procedures_defnoreturn"),s.setAttribute("gap","16");var n=o.createElement$$module$build$src$core$utils$xml("field");n.setAttribute("name","NAME"),n.appendChild(o.createTextNode$$module$build$src$core$utils$xml(o.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_PROCEDURE)),s.appendChild(n),i.push(s)}return ue.procedures_defreturn&&((s=o.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","procedures_defreturn"),s.setAttribute("gap","16"),(n=o.createElement$$module$build$src$core$utils$xml("field")).setAttribute("name","NAME"),n.appendChild(o.createTextNode$$module$build$src$core$utils$xml(o.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_PROCEDURE)),s.appendChild(n),i.push(s)),ue.procedures_ifreturn&&((s=o.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","procedures_ifreturn"),s.setAttribute("gap","16"),i.push(s)),i.length&&i[i.length-1].setAttribute("gap","24"),t((e=Tl(e))[0],"procedures_callnoreturn"),t(e[1],"procedures_callreturn"),i},ga=function(e){return Hd(e,!1)},Hd=function(e,t=!0){function i(n,r){for(const[a,$]of n)s.push({kind:"block",type:r,gap:16,extraState:{name:a,params:$}})}if(t)return Re("The XML return value of Blockly.Procedures.flyoutCategory()","v12","v13","the same method, but handle a return type of FlyoutItemInfo[] (JSON) instead."),Pg(e);const s=[];return ue.procedures_defnoreturn&&s.push({kind:"block",type:"procedures_defnoreturn",gap:16,fields:{NAME:o.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_PROCEDURE}}),ue.procedures_defreturn&&s.push({kind:"block",type:"procedures_defreturn",gap:16,fields:{NAME:o.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_PROCEDURE}}),ue.procedures_ifreturn&&s.push({kind:"block",type:"procedures_ifreturn",gap:16}),s.length&&(s[s.length-1].gap=24),i((e=Tl(e))[0],"procedures_callnoreturn"),i(e[1],"procedures_callreturn"),s},Vd=function(e){var t=[],i=e.getBlocksByType("procedures_mutatorarg",!1);for(let a,r=0;a=i[r];r++)t.push(a.getFieldValue("NAME"));i=o.createElement$$module$build$src$core$utils$xml("xml");const s=o.createElement$$module$build$src$core$utils$xml("block");s.setAttribute("type","procedures_mutatorarg");const n=o.createElement$$module$build$src$core$utils$xml("field");n.setAttribute("name","NAME"),t=Er(o.DEFAULT_ARG$$module$build$src$core$procedures,t),t=o.createTextNode$$module$build$src$core$utils$xml(t),n.appendChild(t),s.appendChild(n),i.appendChild(s),e.updateToolbox(i)},Gd=function(e){if(si(e)&&"mutator"===e.bubbleType&&e.isOpen&&e.blockId){var t=(e=ko(e.workspaceId).getBlockById(e.blockId)).type;("procedures_defnoreturn"===t||"procedures_defreturn"===t)&&(e=e.getIcon(o.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE).getWorkspace(),Vd(e),e.addChangeListener(Fg))}},Fg=function(e){(ro(e)||lo(e)||Mt(e)||vt(e))&&(e=ko(e.workspaceId),Vd(e))},Zd=function(e,t){return t.getAllBlocks(!1).filter(i=>Ug(i,e)||Nc(i)&&o.Names$$module$build$src$core$names.equals(i.getProcedureCall(),e))},Ug=function(e,t){return Vo(e)&&!e.isProcedureDef()&&e.getProcedureModel()&&o.Names$$module$build$src$core$names.equals(e.getProcedureModel().getName(),t)},o.mutateCallers$$module$build$src$core$procedures=function(e){const t=ke();var i=e.getProcedureDef()[0];const s=e.mutationToDom(!0);e=Zd(i,e.workspace);for(let a,r=0;a=e[r];r++){i=(i=a.mutationToDom())&&Qi(i),a.domToMutation&&a.domToMutation(s);var n=a.mutationToDom();i!==(n=n&&Qi(n))&&(o.setRecordUndo$$module$build$src$core$events$utils(!1),B(new(P(b.BLOCK_CHANGE))(a,"mutation",null,i,n)),o.setRecordUndo$$module$build$src$core$events$utils(t))}},o.getDefinition$$module$build$src$core$procedures=function(e,t){for(const i of t.getAllBlocks(!1))if(Vo(i)&&i.isProcedureDef()&&o.Names$$module$build$src$core$names.equals(i.getProcedureModel().getName(),e)||di(i)&&o.Names$$module$build$src$core$names.equals(i.getProcedureDef()[0],e))return i;return null},El=function(e){return e.isDynamic},Wd=function(e){return void 0!==e.pathDown&&void 0!==e.pathUp},qd=function(e){return void 0!==e.pathLeft&&void 0!==e.pathRight},vl=function(e,t){U(k.RENDERER,e,t)},Hg=function(e){et(k.RENDERER,e)},zd=function(e,t,i){return(e=new(tt(k.RENDERER,e))(e)).init(t,i),e},yl=function(e){hi(e.getTargetWorkspace(),void 0,"String")},Cl=function(e){hi(e.getTargetWorkspace(),void 0,"Number")},Il=function(e){hi(e.getTargetWorkspace(),void 0,"Colour")},$a=function(e){return jd(e,!1)},jd=function(e,t=!0){return ue.variables_set_dynamic||ue.variables_get_dynamic||console.warn("There are no dynamic variable blocks, but there is a dynamic variable category."),t?(Re("The XML return value of Blockly.VariablesDynamic.flyoutCategory()","v12","v13","the same method, but handle a return type of FlyoutItemInfo[] (JSON) instead."),Vg(e)):(e.registerButtonCallback("CREATE_VARIABLE_STRING",yl),e.registerButtonCallback("CREATE_VARIABLE_NUMBER",Cl),e.registerButtonCallback("CREATE_VARIABLE_COLOUR",Il),[{kind:"button",text:o.Msg$$module$build$src$core$msg.NEW_STRING_VARIABLE,callbackkey:"CREATE_VARIABLE_STRING"},{kind:"button",text:o.Msg$$module$build$src$core$msg.NEW_NUMBER_VARIABLE,callbackkey:"CREATE_VARIABLE_NUMBER"},{kind:"button",text:o.Msg$$module$build$src$core$msg.NEW_COLOUR_VARIABLE,callbackkey:"CREATE_VARIABLE_COLOUR"},...Tr(e,e.getVariableMap().getAllVariables(),!1,"variables_get_dynamic","variables_set_dynamic")])},Vg=function(e){let t=[],i=document.createElement("button");return i.setAttribute("text",o.Msg$$module$build$src$core$msg.NEW_STRING_VARIABLE),i.setAttribute("callbackKey","CREATE_VARIABLE_STRING"),t.push(i),i=document.createElement("button"),i.setAttribute("text",o.Msg$$module$build$src$core$msg.NEW_NUMBER_VARIABLE),i.setAttribute("callbackKey","CREATE_VARIABLE_NUMBER"),t.push(i),i=document.createElement("button"),i.setAttribute("text",o.Msg$$module$build$src$core$msg.NEW_COLOUR_VARIABLE),i.setAttribute("callbackKey","CREATE_VARIABLE_COLOUR"),t.push(i),e.registerButtonCallback("CREATE_VARIABLE_STRING",yl),e.registerButtonCallback("CREATE_VARIABLE_NUMBER",Cl),e.registerButtonCallback("CREATE_VARIABLE_COLOUR",Il),e=Xd(e),t.concat(e)},Xd=function(e){const t=[];if((e=e.getVariableMap().getAllVariables()).length>0){if(ue.variables_set_dynamic){var i=e[e.length-1];const s=o.createElement$$module$build$src$core$utils$xml("block");s.setAttribute("type","variables_set_dynamic"),s.setAttribute("gap","24"),s.appendChild(pi(i)),t.push(s)}if(ue.variables_get_dynamic){e.sort(ts);for(let n,s=0;n=e[s];s++)(i=o.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","variables_get_dynamic"),i.setAttribute("gap","8"),i.appendChild(pi(n)),t.push(i)}}return t},Gg=function(e){e.resizeContents()},ma=function(e,t){const i=e.toCopyData();return hc=i,pc=Qs(e)&&e.workspace instanceof Ze?e.workspace:null,xu=t,i},_a=function(){return hc},Zg=function(e){hc=e},ba=function(){return pc},Wg=function(e){pc=e},Yd=function(){return xu},qg=function(e){xu=e},Ii=function(e,t,i){return e&&t?Kd(e,t,i):hc&&pc?Kd(hc,pc,xu):null},Kd=function(e,t,i){let s,n,r;return t=t.isMutator?t:null!=(s=t.options.parentWorkspace)?s:t,null!=(r=null==(n=Tt(k.PASTER,e.paster,!1))?void 0:n.paste(e,t,i))?r:null},Ln=function(e){return e&&"function"==typeof e.toCopyData},Jd=function(){ne.registry.register({name:Ko.ESCAPE,preconditionFn:e=>!e.isReadOnly(),callback:e=>(e.hideChaff(),!0),keyCodes:[oe.ESC]})},Qd=function(){ne.registry.register({name:Ko.DELETE,preconditionFn:(e,t)=>(t=t.focusedNode,!e.isReadOnly()&&null!=t&&Xe(t)&&t.isDeletable()&&!e.isDragging()&&!o.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()),callback:(e,t,i,s)=>(t.preventDefault(),(e=s.focusedNode)instanceof ie?e.checkAndDelete():Xe(e)&&e.isDeletable()&&(o.setGroup$$module$build$src$core$events$utils(!0),e.dispose(),o.setGroup$$module$build$src$core$events$utils(!1)),!0),keyCodes:[oe.DELETE,oe.BACKSPACE]})},fa=function(e){return!!(Ln(e)&&Xe(e)&&V(e))&&(e.isCopyable?e.isCopyable():e instanceof ie||e instanceof jt?e.isOwnDeletable()&&e.isOwnMovable():e.isDeletable()&&e.isMovable())},eh=function(e){return fa(e)&&Xe(e)&&e.isDeletable()},th=function(){const e=ne.registry.createSerializedKey(oe.C,[oe.CTRL]),t=ne.registry.createSerializedKey(oe.C,[oe.META]);ne.registry.register({name:Ko.COPY,preconditionFn:(i,s)=>(i=i.isFlyout?i.targetWorkspace:i,!!(s=s.focusedNode)&&!!i&&!i.isDragging()&&!o.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()&&fa(s)),callback:(i,s,n,r)=>(s.preventDefault(),!!((s=r.focusedNode)&&Ln(s)&&fa(s)&&(i=i.isFlyout?i.targetWorkspace:i,i))&&(s.workspace.isFlyout||i.hideChaff(),i=V(s)&&s.workspace==i?s.getRelativeToSurfaceXY():void 0,!!ma(s,i))),keyCodes:[e,t]})},oh=function(){const e=ne.registry.createSerializedKey(oe.X,[oe.CTRL]),t=ne.registry.createSerializedKey(oe.X,[oe.META]);ne.registry.register({name:Ko.CUT,preconditionFn:(i,s)=>!!(s=s.focusedNode)&&!i.isReadOnly()&&!i.isDragging()&&!o.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()&&eh(s),callback:(i,s,n,r)=>!!((i=r.focusedNode)&&eh(i)&&Ln(i))&&(s=V(i)?i.getRelativeToSurfaceXY():void 0,s=ma(i,s),i instanceof ie?i.checkAndDelete():Xe(i)&&i.dispose(),!!s),keyCodes:[e,t]})},ih=function(){const e=ne.registry.createSerializedKey(oe.V,[oe.CTRL]),t=ne.registry.createSerializedKey(oe.V,[oe.META]);ne.registry.register({name:Ko.PASTE,preconditionFn(){var i=ba();return!(!i||!i.rendered||(i=i.isFlyout?i.targetWorkspace:i,!_a()||!i||i.isReadOnly()||i.isDragging()||o.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()))},callback(i,s){if(!(i=_a()))return!1;var n=ba();if(!n||!(n=n.isFlyout?n.targetWorkspace:n)||n.isReadOnly())return!1;if(s instanceof PointerEvent)return s=Sc(n,new S(s.clientX,s.clientY)),!!Ii(i,n,s);if(!(s=Yd()))return!!Ii(i,n);const{left:r,top:a,width:$,height:C}=n.getMetricsManager().getViewMetrics(!0);return new z(a,a+C,r,r+$).contains(s.x,s.y)?!!Ii(i,n):(s=new S(r+$/2,a+C/2),!!Ii(i,n,s))},keyCodes:[e,t]})},sh=function(){const e=ne.registry.createSerializedKey(oe.Z,[oe.CTRL]),t=ne.registry.createSerializedKey(oe.Z,[oe.META]);ne.registry.register({name:Ko.UNDO,preconditionFn:i=>!i.isReadOnly()&&!i.isDragging()&&!o.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken(),callback:(i,s)=>(i.hideChaff(),i.undo(!1),s.preventDefault(),!0),keyCodes:[e,t]})},nh=function(){const e=ne.registry.createSerializedKey(oe.Z,[oe.CTRL,oe.SHIFT]),t=ne.registry.createSerializedKey(oe.Z,[oe.META,oe.SHIFT]),i=ne.registry.createSerializedKey(oe.Y,[oe.CTRL]);ne.registry.register({name:Ko.REDO,preconditionFn:s=>!s.isDragging()&&!s.isReadOnly()&&!o.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken(),callback:(s,n)=>(s.hideChaff(),s.undo(!0),n.preventDefault(),!0),keyCodes:[e,t,i]})},rh=function(){Jd(),Qd(),th(),oh(),ih(),sh(),nh()},lh=function(e){const t=e.saveState();return e.getParameters().length&&(t.parameters=e.getParameters().map(i=>i.saveState())),t},ch=function(e,t,i,s){if(e=e.loadState(i,s),!i.parameters)return e;for(const[n,r]of i.parameters.entries())e.insertParameter(t.loadState(r,s),n);return e},zg=function(e){const t=Object.create(null),i=io(k.SERIALIZER,!0);for(const s in i){let n;const r=null==(n=i[s])?void 0:n.save(e);r&&(t[s]=r)}return t},jg=function(e,t,{recordUndo:i=!1}={}){var s=io(k.SERIALIZER,!0);if(s){s=Object.entries(s).sort((r,a)=>a[1].priority-r[1].priority);var n=ke();o.setRecordUndo$$module$build$src$core$events$utils(i),(i=o.getGroup$$module$build$src$core$events$utils())||o.setGroup$$module$build$src$core$events$utils(!0),_(),t instanceof Ze&&t.setResizesEnabled(!1);for(const[,r]of s.reverse()){let a;null==(a=r)||a.clear(t)}for(const[r,a]of s.reverse())if(e[r]){let $;null==($=a)||$.load(e[r],t)}t instanceof Ze&&t.setResizesEnabled(!0),T(),B(new(P(b.FINISHED_LOADING))(t)),o.setGroup$$module$build$src$core$events$utils(i),o.setRecordUndo$$module$build$src$core$events$utils(n)}},ah=function(e,t){let i=null;var s;if(i="string"==typeof e?document.getElementById(e)||document.querySelector(e):e,!document.contains(i)&&document!==(null==(s=i)?void 0:s.ownerDocument))throw Error("Error: container is not in current document");e=new Xt(t||{}),s=document.createElement("div"),A(s,"injectionDiv"),null!=t&&t.rtl&&A(s,"blocklyRTL"),i.appendChild(s),t=Xg(s,e);const n=Yg(s,t,e);return Kg(n),en(n),wo(n),s.addEventListener("focusin",function(){en(n)}),L(s,"keydown",null,sn),n},Xg=function(e,t){e.setAttribute("dir","LTR"),fc(t.hasCss,t.pathToMedia);const i=I(f.SVG,{xmlns:wl,"xmlns:html":po,"xmlns:xlink":$t,version:"1.1",class:"blocklySvg"},e),s=I(f.DEFS,{},i),n=String(Math.random()).substring(2);return t.gridPattern=uu.createDom(n,t.gridOptions,s,e),i},Yg=function(e,t,i){i.parentWorkspace=null;const s=(i=new Ze(i)).options;i.scale=s.zoomOptions.startScale,t.appendChild(i.createDom("blocklyMainBackground",e));var n=i.getRenderer().getClassName();return n&&A(e,n),(n=i.getTheme().getClassName())&&A(e,n),!s.hasCategories&&s.languageTree&&(e=i.addFlyout(f.SVG),c(e,t)),s.hasTrashcan&&i.addTrashcan(),s.zoomOptions&&s.zoomOptions.controls&&i.addZoomControls(),i.getThemeManager().subscribe(t,"workspaceBackgroundColour","background-color"),i.translate(0,0),i.addChangeListener(On(i)),wo(i),q(),Cr(),Nr(),i},Kg=function(e){const t=e.options;var i=e.getParentSvg();if(L(i.parentNode,"contextmenu",null,function(s){Eo(s)||s.preventDefault()}),i=L(window,"resize",null,function(){Vt(),e.hideComponents(!0),Ar(),co(),wo(e),Mn(e)}),e.setResizeHandlerWrapper(i),Jg(),t.languageTree){i=e.getToolbox();const s=e.getFlyout(!0);i?i.init():s&&(s.init(e),s.show(t.languageTree),"function"==typeof s.scrollToStart&&s.scrollToStart())}t.hasTrashcan&&e.trashcan.init(),t.zoomOptions&&t.zoomOptions.controls&&e.zoomControls_.init(),t.moveOptions&&t.moveOptions.scrollbars?(e.scrollbar=new au(e,!0===t.moveOptions.scrollbars||!!t.moveOptions.scrollbars.horizontal,!0===t.moveOptions.scrollbars||!!t.moveOptions.scrollbars.vertical,"blocklyMainWorkspaceScrollbar"),e.scrollbar.resize()):e.setMetrics({x:.5,y:.5}),t.hasSounds&&Qg(t.pathToMedia,e)},Jg=function(){Vm||(L(document,"scroll",null,function(){const e=Yi();for(let i,t=0;i=e[t];t++)i instanceof Ze&&i.updateInverseScreenCTM()}),qe(document,"touchend",null,it),qe(document,"touchcancel",null,it)),Vm=!0},Qg=function(e,t){function i(){for(;n.length;){const r=n.pop();r&&K(r)}s.preload()}const s=t.getAudioManager();s.load([e+"click.mp3",e+"click.wav",e+"click.ogg"],"click"),s.load([e+"disconnect.wav",e+"disconnect.mp3",e+"disconnect.ogg"],"disconnect"),s.load([e+"delete.mp3",e+"delete.ogg",e+"delete.wav"],"delete");const n=[];n.push(L(document,"pointermove",null,i,!0)),n.push(L(document,"touchstart",null,i,!0))},uh=function(){W.registry.register({displayText:()=>o.Msg$$module$build$src$core$msg.UNDO,preconditionFn:e=>e.workspace.getUndoStack().length>0?"enabled":"disabled",callback(e){e.workspace.undo(!1)},scopeType:W.ScopeType.WORKSPACE,id:"undoWorkspace",weight:1})},dh=function(){W.registry.register({displayText:()=>o.Msg$$module$build$src$core$msg.REDO,preconditionFn:e=>e.workspace.getRedoStack().length>0?"enabled":"disabled",callback(e){e.workspace.undo(!0)},scopeType:W.ScopeType.WORKSPACE,id:"redoWorkspace",weight:2})},hh=function(){W.registry.register({displayText:()=>o.Msg$$module$build$src$core$msg.CLEAN_UP,preconditionFn:e=>e.workspace.isMovable()?e.workspace.getTopBlocks(!1).length>1?"enabled":"disabled":"hidden",callback(e){e.workspace.cleanUp()},scopeType:W.ScopeType.WORKSPACE,id:"cleanWorkspace",weight:3})},ph=function(e,t){function i(r){n--,r.setCollapsed(e),0===n&&o.setGroup$$module$build$src$core$events$utils(!1)}let s=0,n=0;o.setGroup$$module$build$src$core$events$utils(!0);for(let r=0;r<t.length;r++){let a=t[r];for(;a;)n++,setTimeout(i.bind(null,a),s),a=a.getNextBlock(),s+=10}},gh=function(){W.registry.register({displayText:()=>o.Msg$$module$build$src$core$msg.COLLAPSE_ALL,preconditionFn(e){if(e.workspace.options.collapse){e=e.workspace.getTopBlocks(!1);for(let t=0;t<e.length;t++){let i=e[t];for(;i;){if(!i.isCollapsed())return"enabled";i=i.getNextBlock()}}return"disabled"}return"hidden"},callback(e){ph(!0,e.workspace.getTopBlocks(!0))},scopeType:W.ScopeType.WORKSPACE,id:"collapseWorkspace",weight:4})},$h=function(){W.registry.register({displayText:()=>o.Msg$$module$build$src$core$msg.EXPAND_ALL,preconditionFn(e){if(e.workspace.options.collapse){e=e.workspace.getTopBlocks(!1);for(let t=0;t<e.length;t++){let i=e[t];for(;i;){if(i.isCollapsed())return"enabled";i=i.getNextBlock()}}return"disabled"}return"hidden"},callback(e){ph(!1,e.workspace.getTopBlocks(!0))},scopeType:W.ScopeType.WORKSPACE,id:"expandWorkspace",weight:5})},mh=function(e,t){if(e.isDeletable())Array.prototype.push.apply(t,e.getDescendants(!1));else{e=e.getChildren(!1);for(let i=0;i<e.length;i++)mh(e[i],t)}},Ta=function(e){const t=[];e=e.getTopBlocks(!0);for(let i=0;i<e.length;i++)mh(e[i],t);return t},kl=function(e,t){t?o.setGroup$$module$build$src$core$events$utils(t):(o.setGroup$$module$build$src$core$events$utils(!0),t=o.getGroup$$module$build$src$core$events$utils());const i=e.shift();i&&(i.isDeadOrDying()?kl(e,t):(i.dispose(!1,!0),setTimeout(kl,10,e,t))),o.setGroup$$module$build$src$core$events$utils(!1)},_h=function(){W.registry.register({displayText:e=>e.workspace?1===(e=Ta(e.workspace).length)?o.Msg$$module$build$src$core$msg.DELETE_BLOCK:o.Msg$$module$build$src$core$msg.DELETE_X_BLOCKS.replace("%1",`${e}`):"",preconditionFn:e=>e.workspace&&Ta(e.workspace).length>0?"enabled":"disabled",callback(e){if(e.workspace){e.workspace.cancelCurrentGesture();var t=Ta(e.workspace);t.length<2?kl(t):mr(o.Msg$$module$build$src$core$msg.DELETE_ALL_BLOCKS.replace("%1",String(t.length)),function(i){i&&kl(t)})}},scopeType:W.ScopeType.WORKSPACE,id:"workspaceDelete",weight:6})},e$=function(){uh(),dh(),hh(),gh(),$h(),_h()},bh=function(){W.registry.register({displayText:()=>o.Msg$$module$build$src$core$msg.DUPLICATE_BLOCK,preconditionFn:e=>!(e=e.block).isInFlyout&&e.isDeletable()&&e.isMovable()?e.isDuplicatable()?"enabled":"disabled":"hidden",callback(e){if(e.block){var t=e.block.toCopyData();t&&Ii(t,e.block.workspace)}},scopeType:W.ScopeType.BLOCK,id:"blockDuplicate",weight:1})},fh=function(){W.registry.register({displayText:e=>e.block.hasIcon(mo.TYPE)?o.Msg$$module$build$src$core$msg.REMOVE_COMMENT:o.Msg$$module$build$src$core$msg.ADD_COMMENT,preconditionFn:e=>!(e=e.block).isInFlyout&&e.workspace.options.comments&&!e.isCollapsed()&&e.isEditable()?"enabled":"hidden",callback(e){(e=e.block).hasIcon(mo.TYPE)?e.setCommentText(null):e.setCommentText("")},scopeType:W.ScopeType.BLOCK,id:"blockComment",weight:2})},Th=function(){W.registry.register({displayText:e=>e.block.getInputsInline()?o.Msg$$module$build$src$core$msg.EXTERNAL_INPUTS:o.Msg$$module$build$src$core$msg.INLINE_INPUTS,preconditionFn(e){if(!(e=e.block).isInFlyout&&e.isMovable()&&!e.isCollapsed())for(let t=1;t<e.inputList.length;t++)if(!(e.inputList[t-1]instanceof gc||e.inputList[t]instanceof gc))return"enabled";return"hidden"},callback(e){e.block.setInputsInline(!e.block.getInputsInline())},scopeType:W.ScopeType.BLOCK,id:"blockInline",weight:3})},Eh=function(){W.registry.register({displayText:e=>e.block.isCollapsed()?o.Msg$$module$build$src$core$msg.EXPAND_BLOCK:o.Msg$$module$build$src$core$msg.COLLAPSE_BLOCK,preconditionFn:e=>!(e=e.block).isInFlyout&&e.isMovable()&&e.workspace.options.collapse?"enabled":"hidden",callback(e){e.block.setCollapsed(!e.block.isCollapsed())},scopeType:W.ScopeType.BLOCK,id:"blockCollapseExpand",weight:4})},vh=function(){W.registry.register({displayText:e=>e.block.hasDisabledReason(xt)?o.Msg$$module$build$src$core$msg.ENABLE_BLOCK:o.Msg$$module$build$src$core$msg.DISABLE_BLOCK,preconditionFn(e){if(!(e=e.block).isInFlyout&&e.workspace.options.disable&&e.isEditable()){var t=e.getDisabledReasons();return t=t.size>(t.has(xt)?1:0),e.getInheritedDisabled()||t?"disabled":"enabled"}return"hidden"},callback(e){e=e.block;const t=o.getGroup$$module$build$src$core$events$utils();t||o.setGroup$$module$build$src$core$events$utils(!0),e.setDisabledReason(!e.hasDisabledReason(xt),xt),o.setGroup$$module$build$src$core$events$utils(t)},scopeType:W.ScopeType.BLOCK,id:"blockDisable",weight:5})},yh=function(){W.registry.register({displayText(e){var t=e.block;return e=t.getDescendants(!1).length,(t=t.getNextBlock())&&(e-=t.getDescendants(!1).length),1===e?o.Msg$$module$build$src$core$msg.DELETE_BLOCK:o.Msg$$module$build$src$core$msg.DELETE_X_BLOCKS.replace("%1",`${e}`)},preconditionFn:e=>!e.block.isInFlyout&&e.block.isDeletable()?"enabled":"hidden",callback(e){e.block&&e.block.checkAndDelete()},scopeType:W.ScopeType.BLOCK,id:"blockDelete",weight:6})},Ch=function(){W.registry.register({displayText:()=>o.Msg$$module$build$src$core$msg.HELP,preconditionFn:e=>("function"==typeof(e=e.block).helpUrl?e.helpUrl():e.helpUrl)?"enabled":"hidden",callback(e){e.block.showHelp()},scopeType:W.ScopeType.BLOCK,id:"blockHelp",weight:7})},Ih=function(){W.registry.register({displayText:()=>o.Msg$$module$build$src$core$msg.REMOVE_COMMENT,preconditionFn(e){let t;return null!=(t=e.comment)&&t.isDeletable()?"enabled":"hidden"},callback(e){let t;o.setGroup$$module$build$src$core$events$utils(!0),null==(t=e.comment)||t.dispose(),o.setGroup$$module$build$src$core$events$utils(!1)},scopeType:W.ScopeType.COMMENT,id:"commentDelete",weight:6})},kh=function(){W.registry.register({displayText:()=>o.Msg$$module$build$src$core$msg.DUPLICATE_COMMENT,preconditionFn(e){let t;return null!=(t=e.comment)&&t.isMovable()?"enabled":"hidden"},callback(e){if(e.comment){var t=e.comment.toCopyData();t&&Ii(t,e.comment.workspace)}},scopeType:W.ScopeType.COMMENT,id:"commentDuplicate",weight:1})},Sh=function(){W.registry.register({displayText:()=>o.Msg$$module$build$src$core$msg.ADD_COMMENT,preconditionFn:e=>{let t;return null!=(t=e.workspace)&&t.isMutator?"hidden":"enabled"},callback:(e,t,i,s)=>{(e=e.workspace)&&(o.setGroup$$module$build$src$core$events$utils(!0),(t=new jt(e)).setPlaceholderText(o.Msg$$module$build$src$core$msg.WORKSPACE_COMMENT_DEFAULT_TEXT),t.moveTo(t$(new S(s.x,s.y),e)),o.getFocusManager$$module$build$src$core$focus_manager().focusNode(t),o.setGroup$$module$build$src$core$events$utils(!1))},scopeType:W.ScopeType.WORKSPACE,id:"commentCreate",weight:8})},t$=function(e,t){var i=t.getInjectionDiv().getBoundingClientRect();return e=new S(e.x-i.left,e.y-i.top),i=t.getOriginOffsetInPixels(),(e=S.difference(e,i)).scale(1/t.scale),e},o$=function(){bh(),fh(),Th(),Eh(),vh(),yh(),Ch()},i$=function(){kh(),Ih(),Sh()},wh=function(){e$(),o$()},xh=function(e){return e&&"function"==typeof e.paste},Ah=function(e){return e&&"function"==typeof e.getSvgRoot},Rh=function(e){return e.isSelectable()},s$=function(e){st().hideChaff(e)},(y=y||{}).scope={},y.ASSUME_ES5=!1,y.ASSUME_ES6=!1,y.ASSUME_ES2020=!1,y.ASSUME_NO_NATIVE_MAP=!1,y.ASSUME_NO_NATIVE_SET=!1,y.ISOLATE_POLYFILLS=!1,y.FORCE_POLYFILL_PROMISE=!1,y.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1,y.INSTRUMENT_ASYNC_CONTEXT=!0,y.objectCreate=y.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(e){var t=function(){};return t.prototype=e,new t},y.defineProperty=y.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,i){return e==Array.prototype||e==Object.prototype||(e[t]=i.value),e},y.getGlobal=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var t=0;t<e.length;++t){var i=e[t];if(i&&i.Math==Math)return i}throw Error("Cannot find global object")},y.global=y.ASSUME_ES2020?globalThis:y.getGlobal(this),y.IS_SYMBOL_NATIVE="function"==typeof Symbol&&"symbol"==typeof Symbol("x"),y.TRUST_ES6_POLYFILLS=!y.ISOLATE_POLYFILLS||y.IS_SYMBOL_NATIVE,y.polyfills={},y.propertyToPolyfillSymbol={},y.POLYFILL_PREFIX="$jscp$",y.polyfill=function(e,t,i,s){t&&(y.ISOLATE_POLYFILLS?y.polyfillIsolated(e,t,i,s):y.polyfillUnisolated(e,t,i,s))},y.polyfillUnisolated=function(e,t,i,s){for(i=y.global,e=e.split("."),s=0;s<e.length-1;s++){var n=e[s];if(!(n in i))return;i=i[n]}(t=t(s=i[e=e[e.length-1]]))!=s&&null!=t&&y.defineProperty(i,e,{configurable:!0,writable:!0,value:t})},y.polyfillIsolated=function(e,t,i,s){var n=e.split(".");s=n[0],s=!(e=1===n.length)&&s in y.polyfills?y.polyfills:y.global;for(var r=0;r<n.length-1;r++){var a=n[r];if(!(a in s))return;s=s[a]}n=n[n.length-1],null!=(t=t(i=y.IS_SYMBOL_NATIVE&&"es6"===i?s[n]:null))&&(e?y.defineProperty(y.polyfills,n,{configurable:!0,writable:!0,value:t}):t!==i&&(void 0===y.propertyToPolyfillSymbol[n]&&(i=1e9*Math.random()>>>0,y.propertyToPolyfillSymbol[n]=y.IS_SYMBOL_NATIVE?y.global.Symbol(n):y.POLYFILL_PREFIX+i+"$"+n),y.defineProperty(s,y.propertyToPolyfillSymbol[n],{configurable:!0,writable:!0,value:t})))},y.getConstructImplementation=function(){if(y.TRUST_ES6_POLYFILLS&&typeof Reflect<"u"&&Reflect.construct){if(function e(){function i(){}return new i,Reflect.construct(i,[],function(){}),new i instanceof i}())return Reflect.construct;var t=Reflect.construct;return function(i,s,n){return i=t(i,s),n&&Reflect.setPrototypeOf(i,n.prototype),i}}return function(i,s,n){return void 0===n&&(n=i),n=y.objectCreate(n.prototype||Object.prototype),Function.prototype.apply.call(i,n,s)||n}},y.construct=y.getConstructImplementation(),y.underscoreProtoCanBeSet=function(){var t={};try{return t.__proto__={a:!0},t.a}catch{}return!1},y.setPrototypeOf=y.ASSUME_ES6||y.TRUST_ES6_POLYFILLS&&"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:y.underscoreProtoCanBeSet()?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null,y.inherits=function(e,t){if(e.prototype=y.objectCreate(t.prototype),e.prototype.constructor=e,y.ASSUME_ES6||y.setPrototypeOf){var i=y.setPrototypeOf;i(e,t)}else for(i in t)if("prototype"!=i)if(Object.defineProperties){var s=Object.getOwnPropertyDescriptor(t,i);s&&Object.defineProperty(e,i,s)}else e[i]=t[i];e.superClass_=t.prototype},y.arrayIteratorImpl=function(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}},y.arrayIterator=function(e){return{next:y.arrayIteratorImpl(e)}},y.makeIterator=function(e){var t=typeof Symbol<"u"&&Symbol.iterator&&e[Symbol.iterator];if(t)return t.call(e);if("number"==typeof e.length)return y.arrayIterator(e);throw Error(String(e)+" is not an iterable or ArrayLike")},y.arrayFromIterator=function(e){for(var t,i=[];!(t=e.next()).done;)i.push(t.value);return i},y.arrayFromIterable=function(e){return e instanceof Array?e:y.arrayFromIterator(y.makeIterator(e))},y.generator={},y.generator.ensureIteratorResultIsObject_=function(e){if(!(e instanceof Object))throw new TypeError("Iterator result "+e+" is not an object")},y.generator.Context=function(){this.isRunning_=!1,this.yieldAllIterator_=null,this.yieldResult=void 0,this.nextAddress=1,this.finallyAddress_=this.catchAddress_=0,this.finallyContexts_=this.abruptCompletion_=null},y.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0},y.generator.Context.prototype.stop_=function(){this.isRunning_=!1},y.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_},y.generator.Context.prototype.next_=function(e){this.yieldResult=e},y.generator.Context.prototype.throw_=function(e){this.abruptCompletion_={exception:e,isException:!0},this.jumpToErrorHandler_()},y.generator.Context.prototype.return=function(e){this.abruptCompletion_={return:e},this.nextAddress=this.finallyAddress_},y.generator.Context.prototype.jumpThroughFinallyBlocks=function(e){this.abruptCompletion_={jumpTo:e},this.nextAddress=this.finallyAddress_},y.generator.Context.prototype.yield=function(e,t){return this.nextAddress=t,{value:e}},y.generator.Context.prototype.yieldAll=function(e,t){var i=(e=y.makeIterator(e)).next();if(y.generator.ensureIteratorResultIsObject_(i),!i.done)return this.yieldAllIterator_=e,this.yield(i.value,t);this.yieldResult=i.value,this.nextAddress=t},y.generator.Context.prototype.jumpTo=function(e){this.nextAddress=e},y.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0},y.generator.Context.prototype.setCatchFinallyBlocks=function(e,t){this.catchAddress_=e,null!=t&&(this.finallyAddress_=t)},y.generator.Context.prototype.setFinallyBlock=function(e){this.catchAddress_=0,this.finallyAddress_=e||0},y.generator.Context.prototype.leaveTryBlock=function(e,t){this.nextAddress=e,this.catchAddress_=t||0},y.generator.Context.prototype.enterCatchBlock=function(e){return this.catchAddress_=e||0,e=this.abruptCompletion_.exception,this.abruptCompletion_=null,e},y.generator.Context.prototype.enterFinallyBlock=function(e,t,i){i?this.finallyContexts_[i]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_],this.catchAddress_=e||0,this.finallyAddress_=t||0},y.generator.Context.prototype.leaveFinallyBlock=function(e,t){if(t=this.finallyContexts_.splice(t||0)[0],t=this.abruptCompletion_=this.abruptCompletion_||t){if(t.isException)return this.jumpToErrorHandler_();null!=t.jumpTo&&this.finallyAddress_<t.jumpTo?(this.nextAddress=t.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=e},y.generator.Context.prototype.forIn=function(e){return new y.generator.Context.PropertyIterator(e)},y.generator.Context.PropertyIterator=function(e){for(var t in this.object_=e,this.properties_=[],e)this.properties_.push(t);this.properties_.reverse()},y.generator.Context.PropertyIterator.prototype.getNext=function(){for(;this.properties_.length>0;){var e=this.properties_.pop();if(e in this.object_)return e}return null},y.generator.Engine_=function(e){this.context_=new y.generator.Context,this.program_=e},y.generator.Engine_.prototype.next_=function(e){return this.context_.start_(),this.context_.yieldAllIterator_?this.yieldAllStep_(this.context_.yieldAllIterator_.next,e,this.context_.next_):(this.context_.next_(e),this.nextStep_())},y.generator.Engine_.prototype.return_=function(e){this.context_.start_();var t=this.context_.yieldAllIterator_;return t?this.yieldAllStep_("return"in t?t.return:function(i){return{value:i,done:!0}},e,this.context_.return):(this.context_.return(e),this.nextStep_())},y.generator.Engine_.prototype.throw_=function(e){return this.context_.start_(),this.context_.yieldAllIterator_?this.yieldAllStep_(this.context_.yieldAllIterator_.throw,e,this.context_.next_):(this.context_.throw_(e),this.nextStep_())},y.generator.Engine_.prototype.yieldAllStep_=function(e,t,i){try{var s=e.call(this.context_.yieldAllIterator_,t);if(y.generator.ensureIteratorResultIsObject_(s),!s.done)return this.context_.stop_(),s;var n=s.value}catch(r){return this.context_.yieldAllIterator_=null,this.context_.throw_(r),this.nextStep_()}return this.context_.yieldAllIterator_=null,i.call(this.context_,n),this.nextStep_()},y.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var e=this.program_(this.context_);if(e)return this.context_.stop_(),{value:e.value,done:!1}}catch(t){this.context_.yieldResult=void 0,this.context_.throw_(t)}if(this.context_.stop_(),this.context_.abruptCompletion_){if(e=this.context_.abruptCompletion_,this.context_.abruptCompletion_=null,e.isException)throw e.exception;return{value:e.return,done:!0}}return{value:void 0,done:!0}},y.generator.Generator_=function(e){this.next=function(t){return e.next_(t)},this.throw=function(t){return e.throw_(t)},this.return=function(t){return e.return_(t)},this[Symbol.iterator]=function(){return this}},y.generator.createGenerator=function(e,t){return t=new y.generator.Generator_(new y.generator.Engine_(t)),y.setPrototypeOf&&e.prototype&&y.setPrototypeOf(t,e.prototype),t},y.asyncExecutePromiseGenerator=function(e){function t(s){return e.next(s)}function i(s){return e.throw(s)}return new Promise(function(s,n){!function r(a){a.done?s(a.value):Promise.resolve(a.value).then(t,i).then(r,n)}(e.next())})},y.asyncExecutePromiseGeneratorFunction=function(e){return y.asyncExecutePromiseGenerator(e())},y.asyncExecutePromiseGeneratorProgram=function(e){return y.asyncExecutePromiseGenerator(new y.generator.Generator_(new y.generator.Engine_(e)))},y.polyfill("globalThis",function(e){return e||y.global},"es_2020","es3"),y.polyfill("Array.prototype.includes",function(e){return e||function(t,i){var s=this;s instanceof String&&(s=String(s));var n=s.length;for((i=i||0)<0&&(i=Math.max(i+n,0));i<n;i++){var r=s[i];if(r===t||Object.is(r,t))return!0}return!1}},"es7","es3"),y.checkEs6ConformanceViaProxy=function(){try{var e={},t=Object.create(new y.global.Proxy(e,{get:function(i,s,n){return i==e&&"q"==s&&n==t}}));return!0===t.q}catch{return!1}},y.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1,y.ES6_CONFORMANCE=y.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&y.checkEs6ConformanceViaProxy(),y.initSymbol=function(){},y.iteratorPrototype=function(e){return(e={next:e})[Symbol.iterator]=function(){return this},e},y.owns=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},y.MapEntry=function(){},y.polyfill("Set.prototype.difference",function(e){return e||function(t){y.checkIsSetInstance(this),y.checkIsSetLike(t);var i=y.getSmallerAndLargerSets(this,t);t=new Set(this);var s=i.smallerSetIterator;i=i.largerSet;for(var n=s.next();!n.done;)i.has(n.value)&&t.delete(n.value),n=s.next();return t}},"es_next","es6"),y.checkIsSetLike=function(e){if("object"!=typeof e||null===e||"number"!=typeof e.size||e.size<0||"function"!=typeof e.keys||"function"!=typeof e.has)throw new TypeError("Argument must be set-like")},y.checkIsValidIterator=function(e){if("object"!=typeof e||null===e||"function"!=typeof e.next)throw new TypeError("Invalid iterator.");return e},y.getSmallerAndLargerSets=function(e,t){return e.size<=t.size?{smallerSetIterator:e.keys(),largerSet:t}:{smallerSetIterator:y.checkIsValidIterator(t.keys()),largerSet:e}},y.checkIsSetInstance=function(e){if(!(e instanceof Set))throw new TypeError("Method must be called on an instance of Set.")},y.iteratorFromArray=function(e,t){if(y.ASSUME_ES6)return e[Symbol.iterator]();e instanceof String&&(e+="");var i=0,s=!1,n={next:function(){if(!s&&i<e.length){var r=i++;return{value:t(r,e[r]),done:!1}}return s=!0,{done:!0,value:void 0}}};return n[Symbol.iterator]=function(){return n},n},y.polyfill("Array.prototype.values",function(e){return e||function(){return y.iteratorFromArray(this,function(t,i){return i})}},"es8","es3"),y.polyfill("Array.prototype.flatMap",function(e){return e||function(t,i){var s=[];return Array.prototype.forEach.call(this,function(n,r){n=t.call(i,n,r,this),Array.isArray(n)?s.push.apply(s,n):s.push(n)}),s}},"es9","es5"),y.polyfill("Array.prototype.flat",function(e){return e||function(t){t=void 0===t?1:t;var i=[];return Array.prototype.forEach.call(this,function(s){Array.isArray(s)&&t>0?(s=Array.prototype.flat.call(s,t-1),i.push.apply(i,s)):i.push(s)}),i}},"es9","es5"),y.polyfill("Object.entries",function(e){return e||function(t){var s,i=[];for(s in t)y.owns(t,s)&&i.push([s,t[s]]);return i}},"es8","es3"),y.polyfill("Object.values",function(e){return e||function(t){var s,i=[];for(s in t)y.owns(t,s)&&i.push(t[s]);return i}},"es8","es3");var ki=Object.create(null),T_={typeMap:ki},Ea=Object.create(null),ct="default",k=class{constructor(e){this.name=e}toString(){return this.name}};k.CONNECTION_CHECKER=new k("connectionChecker"),k.CONNECTION_PREVIEWER=new k("connectionPreviewer"),k.CURSOR=new k("cursor"),k.EVENT=new k("event"),k.FIELD=new k("field"),k.INPUT=new k("input"),k.RENDERER=new k("renderer"),k.TOOLBOX=new k("toolbox"),k.THEME=new k("theme"),k.TOOLBOX_ITEM=new k("toolboxItem"),k.FLYOUTS_VERTICAL_TOOLBOX=new k("flyoutsVerticalToolbox"),k.FLYOUTS_HORIZONTAL_TOOLBOX=new k("flyoutsHorizontalToolbox"),k.FLYOUT_INFLATER=new k("flyoutInflater"),k.METRICS_MANAGER=new k("metricsManager"),k.BLOCK_DRAGGER=new k("blockDragger"),k.SERIALIZER=new k("serializer"),k.ICON=new k("icon"),k.PASTER=new k("paster"),k.VARIABLE_MODEL=new k("variableModel"),k.VARIABLE_MAP=new k("variableMap");var Go={DEFAULT:ct,TEST_ONLY:T_};Go.Type=k,Go.getAllItems=io,Go.getClass=tt,Go.getClassFromOptions=xe,Go.getObject=Tt,Go.hasItem=ti,Go.register=U,Go.unregister=et;var Oh,l$,c$,a$,Ca,Ia,Mh,u$,d$,h$,ue=Object.create(null),E_=750,r$="ontouchstart"in globalThis||!!(globalThis.document&&document.documentElement&&"ontouchstart"in document.documentElement)||!(!globalThis.navigator||!globalThis.navigator.maxTouchPoints&&!globalThis.navigator.msMaxTouchPoints),va=null,Ts={mousedown:["pointerdown"],mouseenter:["pointerenter"],mouseleave:["pointerleave"],mousemove:["pointermove"],mouseout:["pointerout"],mouseover:["pointerover"],mouseup:["pointerup","pointercancel"],touchend:["pointerup"],touchcancel:["pointercancel"]},ya=0,Es={TOUCH_ENABLED:r$,TOUCH_MAP:Ts};Es.checkTouchIdentifier=oi,Es.clearTouchIdentifier=Ae,Es.getTouchIdentifierFromEvent=no,Es.longStart=so,Es.longStop=it,Es.shouldHandleEvent=Ie,function(e){function t(s){return i.includes(s.toUpperCase())}const i=(Oh=e).toUpperCase();l$=t("JavaFX"),c$=t("WebKit"),a$=t("Gecko")&&!c$,Ca=t("Android"),e=globalThis.navigator&&globalThis.navigator.maxTouchPoints,Ia=t("iPad")||t("Macintosh")&&e>0,Mh=t("iPhone")&&!Ia,u$=t("Macintosh"),d$=Ia||Ca&&!t("Mobile")||t("Silk"),h$=!d$&&(Mh||Ca)}(globalThis.navigator&&globalThis.navigator.userAgent||"");var p$=l$,g$=a$,Nh=Ca,ka=Ia,$$=Mh,Lh=u$,m$=h$,y_={ANDROID:Nh,GECKO:g$,IPAD:ka,IPHONE:$$,JavaFx:p$,MAC:Lh,MOBILE:m$,raw:Oh},_$=40,b$=125,Zo={};Zo.bind=qe,Zo.conditionalBind=L,Zo.getScrollDeltaPixels=vo,Zo.isRightButton=ot,Zo.isTargetInput=Eo,Zo.mouseToSvg=Et,Zo.unbind=K;var b=function(e){return e.BLOCK_CREATE="create",e.BLOCK_DELETE="delete",e.BLOCK_CHANGE="change",e.BLOCK_FIELD_INTERMEDIATE_CHANGE="block_field_intermediate_change",e.BLOCK_MOVE="move",e.VAR_CREATE="var_create",e.VAR_DELETE="var_delete",e.VAR_RENAME="var_rename",e.VAR_TYPE_CHANGE="var_type_change",e.UI="ui",e.BLOCK_DRAG="drag",e.SELECTED="selected",e.CLICK="click",e.MARKER_MOVE="marker_move",e.BUBBLE_OPEN="bubble_open",e.TRASHCAN_OPEN="trashcan_open",e.TOOLBOX_ITEM_SELECT="toolbox_item_select",e.THEME_CHANGE="theme_change",e.VIEWPORT_CHANGE="viewport_change",e.COMMENT_CREATE="comment_create",e.COMMENT_DELETE="comment_delete",e.COMMENT_CHANGE="comment_change",e.COMMENT_MOVE="comment_move",e.COMMENT_RESIZE="comment_resize",e.COMMENT_DRAG="comment_drag",e.COMMENT_COLLAPSE="comment_collapse",e.FINISHED_LOADING="finished_loading",e}(b||{}),Dh=[b.BLOCK_CREATE,b.BLOCK_MOVE,b.COMMENT_CREATE,b.COMMENT_MOVE];({BUMP_EVENTS:Dh}).EventType=b;var f$="!#$%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",Bh={genUid:()=>{const t=[];for(let i=0;i<20;i++)t[i]=f$.charAt(88*Math.random());return t.join("")}},I_=0,Ph={TEST_ONLY:Bh};Ph.genUid=Te,Ph.getNextUniqueId=ze;var ge={};ge.isBlockChange=Mt,ge.isBlockCreate=ro,ge.isBlockDelete=lo,ge.isBlockDrag=Vs,ge.isBlockFieldIntermediateChange=vt,ge.isBlockMove=Nt,ge.isBubbleOpen=si,ge.isClick=Wi,ge.isCommentChange=zs,ge.isCommentCollapse=Ys,ge.isCommentCreate=ni,ge.isCommentDelete=qs,ge.isCommentDrag=Xs,ge.isCommentMove=js,ge.isCommentResize=Co,ge.isFinishedLoading=Ks,ge.isSelected=ii,ge.isThemeChange=Ws,ge.isToolboxItemSelect=Zs,ge.isTrashcanOpen=Gs,ge.isVarCreate=Zi,ge.isVarDelete=Us,ge.isVarRename=Hs,ge.isViewportChange=yo;var T$="",Sl=!0,Fh=0,Uh="ORPHANED_BLOCK",Wo=[],Hh={FIRE_QUEUE:Wo,enqueueEvent:qi,fireNow:ri,fireInternal:Js,setGroupInternal:Ve},at={TEST_ONLY:Hh};at.clearPendingUndo=ci,at.disable=o.disable$$module$build$src$core$events$utils,at.disableOrphans=Lt,at.enable=o.enable$$module$build$src$core$events$utils,at.filter=li,at.fire=B,at.fromJson=zi,at.get=P,at.getDescendantIds=Io,at.getGroup=o.getGroup$$module$build$src$core$events$utils,at.getRecordUndo=ke,at.isEnabled=se,at.setGroup=o.setGroup$$module$build$src$core$events$utils,at.setRecordUndo=o.setRecordUndo$$module$build$src$core$events$utils;var qo,e,wl="http://www.w3.org/2000/svg",po="http://www.w3.org/1999/xhtml",$t="http://www.w3.org/1999/xlink";(e=qo||(qo={}))[e.ELEMENT_NODE=1]="ELEMENT_NODE",e[e.TEXT_NODE=3]="TEXT_NODE",e[e.COMMENT_NODE=8]="COMMENT_NODE";var Wt=null,Vh=0,xl=null,Fe={HTML_NS:po};Fe.NodeType=qo,Fe.SVG_NS=wl,Fe.XLINK_NS=$t,Fe.addClass=A,Fe.createSvgElement=I,Fe.getFastTextWidth=pe,Fe.getFastTextWidthWithSizeString=Dt,Fe.getTextWidth=w,Fe.hasClass=Xi,Fe.insertAfter=c,Fe.measureFontMetrics=ir,Fe.removeClass=X,Fe.removeClasses=ji,Fe.removeNode=J,Fe.setCssTransform=h,Fe.startTextWidthCache=_,Fe.stopTextWidthCache=T;var Me=class{static findFocusedNode(e){var t=e.getRootFocusableNode();if(!t.canBeFocused())return null;var i=t.getFocusableElement();return Xi(i,Me.ACTIVE_CLASS_NAME)||Xi(i,Me.PASSIVE_CSS_CLASS_NAME)||((t=i.querySelector(this.ACTIVE_FOCUS_NODE_CSS_SELECTOR))instanceof HTMLElement||t instanceof SVGElement)&&(t=Me.findFocusableNodeFor(t,e))?t:((i=i.querySelector(this.PASSIVE_FOCUS_NODE_CSS_SELECTOR))instanceof HTMLElement||i instanceof SVGElement)&&(e=Me.findFocusableNodeFor(i,e))?e:null}static findFocusableNodeFor(e,t){if(!e.id||"null"===e.id||-1!==t.getNestedTrees().map(n=>Me.findFocusableNodeFor(e,n)).findIndex(n=>!!n))return null;var s,i=t.getRootFocusableNode();return i.canBeFocused()&&e===i.getFocusableElement()||(i=null!=(s=t.lookUpFocusableNode(e.id))?s:null)?i:(s=e.parentElement,!i&&s?Me.findFocusableNodeFor(s,t):null)}};Me.ACTIVE_CLASS_NAME="blocklyActiveFocus",Me.PASSIVE_CSS_CLASS_NAME="blocklyPassiveFocus",Me.ACTIVE_FOCUS_NODE_CSS_SELECTOR=`.${Me.ACTIVE_CLASS_NAME}`,Me.PASSIVE_FOCUS_NODE_CSS_SELECTOR=`.${Me.PASSIVE_CSS_CLASS_NAME}`;var Ue=class{constructor(e){this.previouslyFocusedNode=this.focusedNode=null,this.registeredTrees=[],this.isUpdatingFocusedNode=this.recentlyLostAllFocus=this.lockFocusStateChanges=this.currentlyHoldsEphemeralFocus=!1;const t=i=>{if(!this.isUpdatingFocusedNode){this.recentlyLostAllFocus=!i;var s=null;if(i instanceof HTMLElement||i instanceof SVGElement)for(var n of this.registeredTrees)if(s=Me.findFocusableNodeFor(i,n.tree))break;if(s&&s.canBeFocused()){let r;i=s.getFocusableTree(),n=null==(r=this.focusedNode)?void 0:r.getFocusableTree(),s===i.getRootFocusableNode()&&i!==n?this.focusTree(i):this.focusNode(s)}else this.defocusCurrentFocusedNode()}};e("focusin",i=>{i instanceof FocusEvent&&t(document.activeElement)}),e("focusout",i=>{i instanceof FocusEvent&&t(i.relatedTarget)})}registerTree(e,t=!1){if(this.ensureManagerIsUnlocked(),this.isRegistered(e))throw Error(`Attempted to re-register already registered tree: ${e}.`);this.registeredTrees.push(new class{constructor(e,t){this.tree=e,this.rootShouldBeAutoTabbable=t}}(e,t));const i=e.getRootFocusableNode().getFocusableElement();if(!i.id||"null"===i.id)throw Error(`Attempting to register a tree with a root element that has an invalid ID: ${e}.`);t&&(i.tabIndex=0)}isRegistered(e){return!!this.lookUpRegistration(e)}lookUpRegistration(e){let t;return null!=(t=this.registeredTrees.find(i=>i.tree===e))?t:null}unregisterTree(e){if(this.ensureManagerIsUnlocked(),!this.isRegistered(e))throw Error(`Attempted to unregister not registered tree: ${e}.`);var t=this.registeredTrees.findIndex(n=>n.tree===e);const i=this.registeredTrees[t];this.registeredTrees.splice(t,1),t=Me.findFocusedNode(e);const s=e.getRootFocusableNode();t&&this.removeHighlight(t),this.focusedNode!==t&&this.focusedNode!==s||this.updateFocusedNode(null),this.removeHighlight(s),i.rootShouldBeAutoTabbable&&e.getRootFocusableNode().getFocusableElement().removeAttribute("tabindex")}getFocusedTree(){let e,t;return null!=(t=null==(e=this.focusedNode)?void 0:e.getFocusableTree())?t:null}getFocusedNode(){return this.focusedNode}focusTree(e){if(this.ensureManagerIsUnlocked(),!this.isRegistered(e))throw Error(`Attempted to focus unregistered tree: ${e}.`);const t=Me.findFocusedNode(e),i=e.getRestoredFocusableNode(t);let s;e=e.getRootFocusableNode(),this.focusNode(null!=(s=i??t)?s:e)}focusNode(e){this.ensureManagerIsUnlocked();const t=!this.currentlyHoldsEphemeralFocus;t&&(this.isUpdatingFocusedNode=!0);var i,s=(null==(i=this.focusedNode)?void 0:i.getFocusableElement())!==document.activeElement;if(this.focusedNode!==e||s)if(e.canBeFocused()){if(i=e.getFocusableTree(),!this.isRegistered(i))throw Error(`Attempted to focus unregistered node: ${e}.`);(s=e.getFocusableElement()).id&&"null"!==s.id||console.warn("Trying to focus a node that has an invalid ID.");var n=Me.findFocusableNodeFor(s,i);s=Me.findFocusedNode(i);var a,r=e;n!==e&&(r=i.getRestoredFocusableNode(s),e=i.getRootFocusableNode(),r=null!=(a=r??s)?a:e),e=this.focusedNode,a=e?.getFocusableTree(),e&&this.passivelyFocusNode(e,i),i=i.getRootFocusableNode(),s&&this.removeHighlight(s),i!==r&&this.removeHighlight(i),this.currentlyHoldsEphemeralFocus||this.activelyFocusNode(r,a??null),this.updateFocusedNode(r)}else console.warn("Trying to focus a node that can't be focused.");t&&(this.isUpdatingFocusedNode=!1)}takeEphemeralFocus(e){if(this.ensureManagerIsUnlocked(),this.currentlyHoldsEphemeralFocus)throw Error(`Attempted to take ephemeral focus when it's already held, with new element: ${e}.`);this.currentlyHoldsEphemeralFocus=!0,this.focusedNode&&this.passivelyFocusNode(this.focusedNode,null),e.focus();let t=!1;return()=>{if(t)throw Error(`Attempted to finish ephemeral focus twice for element: ${e}.`);if(t=!0,this.currentlyHoldsEphemeralFocus=!1,this.focusedNode){this.activelyFocusNode(this.focusedNode,null);const i=this.focusedNode;setTimeout(()=>{!this.focusedNode&&this.previouslyFocusedNode===i&&this.recentlyLostAllFocus&&this.focusNode(i)},0)}}}ephemeralFocusTaken(){return this.currentlyHoldsEphemeralFocus}ensureManagerIsUnlocked(){if(this.lockFocusStateChanges)throw Error("FocusManager state changes cannot happen in a tree/node focus/blur callback.")}updateFocusedNode(e){this.previouslyFocusedNode=this.focusedNode,this.focusedNode=e}defocusCurrentFocusedNode(){this.focusedNode&&!this.currentlyHoldsEphemeralFocus&&(this.passivelyFocusNode(this.focusedNode,null),this.updateFocusedNode(null))}activelyFocusNode(e,t){this.lockFocusStateChanges=!0;const i=e.getFocusableTree(),s=e.getFocusableElement();let n;const r=null==(n=this.lookUpRegistration(i))?void 0:n.rootShouldBeAutoTabbable;i!==t&&(i.onTreeFocus(e,t),r&&(i.getRootFocusableNode().getFocusableElement().tabIndex=-1)),e.onNodeFocus(),this.lockFocusStateChanges=!1,r&&e===i.getRootFocusableNode()||s.hasAttribute("tabindex")||(s.tabIndex=-1),this.setNodeToVisualActiveFocus(e),s.focus()}passivelyFocusNode(e,t){this.lockFocusStateChanges=!0;const i=e.getFocusableTree();if(i!==t){let s;i.onTreeBlur(t),null!=(s=this.lookUpRegistration(i))&&s.rootShouldBeAutoTabbable&&(i.getRootFocusableNode().getFocusableElement().tabIndex=0)}e.onNodeBlur(),this.lockFocusStateChanges=!1,i!==t&&this.setNodeToVisualPassiveFocus(e)}setNodeToVisualActiveFocus(e){e=e.getFocusableElement(),A(e,Ue.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME),X(e,Ue.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME)}setNodeToVisualPassiveFocus(e){e=e.getFocusableElement(),X(e,Ue.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME),A(e,Ue.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME)}removeHighlight(e){e=e.getFocusableElement(),X(e,Ue.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME),X(e,Ue.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME)}static getFocusManager(){return Ue.focusManager||(Ue.focusManager=new Ue(document.addEventListener)),Ue.focusManager}};Ue.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME="blocklyActiveFocus",Ue.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME="blocklyPassiveFocus",Ue.focusManager=null;var E$={};E$.FocusManager=Ue,E$.getFocusManager=o.getFocusManager$$module$build$src$core$focus_manager;var v$={};v$.deepMerge=Bt;var ne=class{constructor(){this.shortcuts=new Map,this.keyMap=new Map,this.reset()}reset(){this.shortcuts.clear(),this.keyMap.clear()}register(e,t){if(this.shortcuts.get(e.name)&&!t)throw Error(`Shortcut named "${e.name}" already exists.`);if(this.shortcuts.set(e.name,e),null!=(t=e.keyCodes)&&t.length)for(const i of t)this.addKeyMapping(i,e.name,!!e.allowCollision)}unregister(e){return this.shortcuts.get(e)?(this.removeAllKeyMappings(e),this.shortcuts.delete(e),!0):(console.warn(`Keyboard shortcut named "${e}" not found.`),!1)}addKeyMapping(e,t,i){const s=this.keyMap.get(e=`${e}`);if(s&&!i)throw Error(`Shortcut named "${t}" collides with shortcuts "${s}"`);s&&i?s.unshift(t):this.keyMap.set(e,[t])}removeKeyMapping(e,t,i){const s=this.keyMap.get(e);if(!s)return i||console.warn(`No keyboard shortcut named "${t}" registered with key code "${e}"`),!1;const n=s.indexOf(t);return n>-1?(s.splice(n,1),0===s.length&&this.keyMap.delete(e),!0):(i||console.warn(`No keyboard shortcut named "${t}" registered with key code "${e}"`),!1)}removeAllKeyMappings(e){for(const t of this.keyMap.keys())this.removeKeyMapping(t,e,!0)}setKeyMap(e){this.keyMap.clear();for(const t in e)this.keyMap.set(t,e[t])}getKeyMap(){const e=Object.create(null);for(const[t,i]of this.keyMap)e[t]=i;return e}getRegistry(){const e=Object.create(null);for(const[t,i]of this.shortcuts)e[t]=i;return Bt(Object.create(null),e)}onKeyDown(e,t){var i=this.serializeKeyEvent(t);if(!(i=this.getShortcutNamesByKeyCode(i)))return!1;for(const s of i){let n,r,a,$;if((i=this.shortcuts.get(s))&&(!i.preconditionFn||i.preconditionFn(e,{focusedNode:null!=(n=o.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode())?n:void 0}))&&null!=(a=(r=i).callback)&&a.call(r,e,t,i,{focusedNode:null!=($=o.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode())?$:void 0}))return!0}return!1}getShortcutNamesByKeyCode(e){let t;return(null==(t=this.keyMap.get(e))?void 0:t.slice())||[]}getKeyCodesByShortcutName(e){const t=[];for(const[i,s]of this.keyMap)s.indexOf(e)>-1&&t.push(i);return t}serializeKeyEvent(e){let t="";for(const i in ne.modifierKeys)e.getModifierState(i)&&(""!==t&&(t+="+"),t+=i);return""!==t&&e.keyCode?t+="+"+e.keyCode:e.keyCode&&(t=String(e.keyCode)),t}checkModifiers(e){for(const t of e)if(!(t in ne.modifierKeys))throw Error(t+" is not a valid modifier key.")}createSerializedKey(e,t){let i="";if(t){this.checkModifiers(t);for(const s in ne.modifierKeys)t.includes(ne.modifierKeys[s])&&(""!==i&&(i+="+"),i+=s)}return""!==i&&e?i+="+"+e:e&&(i=`${e}`),i}};ne.registry=new ne,function(e){(e=e.modifierKeys||(e.modifierKeys={}))[e.Shift=16]="Shift",e[e.Control=17]="Control",e[e.Alt=18]="Alt",e[e.Meta=91]="Meta"}(ne||(ne={}));var y$,C$,Al=Object.create(null),Rl=[],I$={defineBlocksWithJsonArrayInternal:Ku},Ne={TEST_ONLY:I$};Ne.createBlockDefinitionsFromJsonArray=o.createBlockDefinitionsFromJsonArray$$module$build$src$core$common,Ne.defineBlocks=o.defineBlocks$$module$build$src$core$common,Ne.defineBlocksWithJsonArray=nr,Ne.draggingConnections=Rl,Ne.fireSelectedEvent=So,Ne.getAllWorkspaces=Yi,Ne.getBlockTypeCounts=on,Ne.getMainWorkspace=st,Ne.getParentContainer=tn,Ne.getSelected=Ki,Ne.getWorkspaceById=ko,Ne.globalShortcutHandler=sn,Ne.registerWorkspace=_c,Ne.setMainWorkspace=en,Ne.setParentContainer=sr,Ne.setSelected=Xu,Ne.svgResize=wo,Ne.unregisterWorkpace=bc;var wa,vs=class{constructor(){this.workspaceId=void 0,this.isUiEvent=!1,this.type="",this.group=o.getGroup$$module$build$src$core$events$utils(),this.recordUndo=ke()}toJson(){return{type:this.type,group:this.group}}static fromJson(e,t,i){return i.isBlank=!1,i.group=e.group||"",i.workspaceId=t.id,i}isNull(){return!1}run(e){}getEventWorkspace_(){let e;if(this.workspaceId&&(e=ko(this.workspaceId)),!e)throw Error("Workspace is null. Event must have been generated from real Blockly events.");return e}},qt=class extends vs{constructor(e){super(),this.recordUndo=!1,this.isUiEvent=!0,this.isBlank=typeof e>"u",this.workspaceId=e||""}},Sa=class extends qt{constructor(e,t,i){null===(t=e?e.workspace.id:t)&&(t=void 0),super(t),this.type=b.CLICK,this.blockId=e?e.id:void 0,this.targetType=i}toJson(){const e=super.toJson();if(!this.targetType)throw Error("The click target type is undefined. Either pass a block to the constructor, or call fromJson");return e.targetType=this.targetType,e.blockId=this.blockId,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new Sa)).targetType=e.targetType,t.blockId=e.blockId,t}};(function(e){e.BLOCK="block",e.WORKSPACE="workspace",e.ZOOM_CONTROLS="zoom_controls"})(wa||(wa={})),U(k.EVENT,b.CLICK,Sa);var k$={};k$.Click=Sa,k$.ClickTarget=wa;var S$={};S$.removeElem=nt;var zo=class{constructor(e){this.name=e}toString(){return this.name}};zo.POSITIONABLE=new zo("positionable"),zo.DRAG_TARGET=new zo("drag_target"),zo.DELETE_AREA=new zo("delete_area"),zo.AUTOHIDEABLE=new zo("autohideable");var de=class{constructor(){this.componentData=new Map,this.capabilityToComponentIds=new Map}addComponent(e,t){const i=e.component.id;var s;if(!t&&this.componentData.has(i))throw Error('Plugin "'+i+'" with capabilities "'+(null==(s=this.componentData.get(i))?void 0:s.capabilities)+'" already added.');for(this.componentData.set(i,e),t=[],s=0;s<e.capabilities.length;s++){const n=String(e.capabilities[s]).toLowerCase();if(t.push(n),this.capabilityToComponentIds.has(n)){let r;null==(r=this.capabilityToComponentIds.get(n))||r.push(i)}else this.capabilityToComponentIds.set(n,[i])}this.componentData.get(i).capabilities=t}removeComponent(e){const t=this.componentData.get(e);if(t){for(let i=0;i<t.capabilities.length;i++){const s=String(t.capabilities[i]).toLowerCase();nt(this.capabilityToComponentIds.get(s),e)}this.componentData.delete(e)}}addCapability(e,t){if(!this.getComponent(e))throw Error('Cannot add capability, "'+t+'". Plugin "'+e+'" has not been added to the ComponentManager');var i,s;this.hasCapability(e,t)?console.warn('Plugin "'+e+'already has capability "'+t+'"'):(t=`${t}`.toLowerCase(),null==(i=this.componentData.get(e))||i.capabilities.push(t),null==(s=this.capabilityToComponentIds.get(t))||s.push(e))}removeCapability(e,t){if(!this.getComponent(e))throw Error('Cannot remove capability, "'+t+'". Plugin "'+e+'" has not been added to the ComponentManager');this.hasCapability(e,t)?(t=`${t}`.toLowerCase(),nt(this.componentData.get(e).capabilities,t),nt(this.capabilityToComponentIds.get(t),e)):console.warn('Plugin "'+e+"doesn't have capability \""+t+'" to remove')}hasCapability(e,t){return t=`${t}`.toLowerCase(),this.componentData.has(e)&&this.componentData.get(e).capabilities.includes(t)}getComponent(e){let t;return null==(t=this.componentData.get(e))?void 0:t.component}getComponents(e,t){if(e=`${e}`.toLowerCase(),!(e=this.capabilityToComponentIds.get(e)))return[];const i=[];if(t){const s=[];e.forEach(n=>{s.push(this.componentData.get(n))}),s.sort(function(n,r){return n.weight-r.weight}),s.forEach(function(n){i.push(n.component)})}else e.forEach(s=>{i.push(this.componentData.get(s).component)});return i}};de.Capability=zo,function(e){(e=e.ComponentWeight||(e.ComponentWeight={}))[e.TOOLBOX_WEIGHT=0]="TOOLBOX_WEIGHT",e[e.FLYOUT_WEIGHT=1]="FLYOUT_WEIGHT",e[e.TRASHCAN_WEIGHT=2]="TRASHCAN_WEIGHT",e[e.ZOOM_CONTROLS_WEIGHT=3]="ZOOM_CONTROLS_WEIGHT"}(de||(de={}));var M_=de.ComponentWeight,w$={};w$.ComponentManager=de,w$.ComponentWeight=M_;var Gh=!1,Zh='\n.blocklySvg {\n  background-color: #fff;\n  outline: none;\n  overflow: hidden;  /* IE overflows by default. */\n  position: absolute;\n  display: block;\n}\n\n.blocklyWidgetDiv {\n  display: none;\n  position: absolute;\n  z-index: 99999;  /* big value for bootstrap3 compatibility */\n}\n\n.injectionDiv {\n  height: 100%;\n  position: relative;\n  overflow: hidden;  /* So blocks in drag surface disappear at edges */\n  touch-action: none;\n  user-select: none;\n  -webkit-user-select: none;\n}\n\n.blocklyBlockCanvas.blocklyCanvasTransitioning,\n.blocklyBubbleCanvas.blocklyCanvasTransitioning {\n  transition: transform .5s;\n}\n\n.blocklyEmboss {\n  filter: var(--blocklyEmbossFilter);\n}\n\n.blocklyTooltipDiv {\n  background-color: #ffffc7;\n  border: 1px solid #ddc;\n  box-shadow: 4px 4px 20px 1px rgba(0,0,0,.15);\n  color: #000;\n  display: none;\n  font: 9pt sans-serif;\n  opacity: .9;\n  padding: 2px;\n  position: absolute;\n  z-index: 100000;  /* big value for bootstrap3 compatibility */\n}\n\n.blocklyDropDownDiv {\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1000;\n  display: none;\n  border: 1px solid;\n  border-color: #dadce0;\n  background-color: #fff;\n  border-radius: 2px;\n  padding: 4px;\n  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownDiv:focus {\n  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownContent {\n  max-height: 300px;  /* @todo: spec for maximum height. */\n}\n\n.blocklyDropDownArrow {\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 16px;\n  height: 16px;\n  z-index: -1;\n  background-color: inherit;\n  border-color: inherit;\n  border-top: 1px solid;\n  border-left: 1px solid;\n  border-top-left-radius: 4px;\n  border-color: inherit;\n}\n\n.blocklyHighlighted>.blocklyPath {\n  filter: var(--blocklyEmbossFilter);\n}\n\n.blocklyHighlightedConnectionPath {\n  fill: none;\n  stroke: #fc3;\n  stroke-width: 4px;\n}\n\n.blocklyPathLight {\n  fill: none;\n  stroke-linecap: round;\n  stroke-width: 1;\n}\n\n.blocklySelected>.blocklyPathLight {\n  display: none;\n}\n\n.blocklyDraggable {\n  cursor: grab;\n  cursor: -webkit-grab;\n}\n\n.blocklyDragging {\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n  /* Drag surface disables events to not block the toolbox, so we have to\n   * reenable them here for the cursor values to work. */\n  pointer-events: auto;\n}\n\n  /* Changes cursor on mouse down. Not effective in Firefox because of\n     https://bugzilla.mozilla.org/show_bug.cgi?id=771241 */\n.blocklyDraggable:active {\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n}\n\n.blocklyDragging.blocklyDraggingDelete {\n  cursor: url("<<<PATH>>>/handdelete.cur"), auto;\n}\n\n.blocklyDragging>.blocklyPath,\n.blocklyDragging>.blocklyPathLight {\n  fill-opacity: .8;\n  stroke-opacity: .8;\n}\n\n.blocklyDragging>.blocklyPathDark {\n  display: none;\n}\n\n.blocklyDisabledPattern>.blocklyPath {\n  fill: var(--blocklyDisabledPattern);\n  fill-opacity: .5;\n  stroke-opacity: .5;\n}\n\n.blocklyDisabled>.blocklyPathLight,\n.blocklyDisabled>.blocklyPathDark {\n  display: none;\n}\n\n.blocklyInsertionMarker>.blocklyPath,\n.blocklyInsertionMarker>.blocklyPathLight,\n.blocklyInsertionMarker>.blocklyPathDark {\n  fill-opacity: .2;\n  stroke: none;\n}\n\n.blocklyNonEditableField>text {\n  pointer-events: none;\n}\n\n.blocklyFlyout {\n  position: absolute;\n  z-index: 20;\n}\n\n.blocklyText text {\n  cursor: default;\n}\n\n/*\n  Don\'t allow users to select text.  It gets annoying when trying to\n  drag a block and selected text moves instead.\n*/\n.blocklySvg text {\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n  cursor: inherit;\n}\n\n.blocklyIconGroup {\n  cursor: default;\n}\n\n.blocklyIconGroup:not(:hover),\n.blocklyIconGroupReadonly {\n  opacity: .6;\n}\n\n.blocklyIconShape {\n  fill: #00f;\n  stroke: #fff;\n  stroke-width: 1px;\n}\n\n.blocklyIconSymbol {\n  fill: #fff;\n}\n\n.blocklyMinimalBody {\n  margin: 0;\n  padding: 0;\n  height: 100%;\n}\n\n.blocklyHtmlInput {\n  border: none;\n  border-radius: 4px;\n  height: 100%;\n  margin: 0;\n  outline: none;\n  padding: 0;\n  width: 100%;\n  text-align: center;\n  display: block;\n  box-sizing: border-box;\n}\n\n/* Remove the increase and decrease arrows on the field number editor */\ninput.blocklyHtmlInput[type=number]::-webkit-inner-spin-button,\ninput.blocklyHtmlInput[type=number]::-webkit-outer-spin-button {\n  -webkit-appearance: none;\n  margin: 0;\n}\n\ninput[type=number] {\n  -moz-appearance: textfield;\n}\n\n.blocklyMainBackground {\n  stroke-width: 1;\n  stroke: #c6c6c6;  /* Equates to #ddd due to border being off-pixel. */\n}\n\n.blocklyMutatorBackground {\n  fill: #fff;\n  stroke: #ddd;\n  stroke-width: 1;\n}\n\n.blocklyFlyoutBackground {\n  fill: #ddd;\n  fill-opacity: .8;\n}\n\n.blocklyMainWorkspaceScrollbar {\n  z-index: 20;\n}\n\n.blocklyFlyoutScrollbar {\n  z-index: 30;\n}\n\n.blocklyScrollbarHorizontal,\n.blocklyScrollbarVertical {\n  position: absolute;\n  outline: none;\n}\n\n.blocklyScrollbarBackground {\n  opacity: 0;\n  pointer-events: none;\n}\n\n.blocklyScrollbarHandle {\n  fill: #ccc;\n}\n\n.blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,\n.blocklyScrollbarHandle:hover {\n  fill: #bbb;\n}\n\n/* Darken flyout scrollbars due to being on a grey background. */\n/* By contrast, workspace scrollbars are on a white background. */\n.blocklyFlyout .blocklyScrollbarHandle {\n  fill: #bbb;\n}\n\n.blocklyFlyout .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,\n.blocklyFlyout .blocklyScrollbarHandle:hover {\n  fill: #aaa;\n}\n\n.blocklyInvalidInput {\n  background: #faa;\n}\n\n.blocklyVerticalMarker {\n  stroke-width: 3px;\n  fill: rgba(255,255,255,.5);\n  pointer-events: none;\n}\n\n.blocklyComputeCanvas {\n  position: absolute;\n  width: 0;\n  height: 0;\n}\n\n.blocklyNoPointerEvents {\n  pointer-events: none;\n}\n\n.blocklyContextMenu {\n  border-radius: 4px;\n  max-height: 100%;\n}\n\n.blocklyDropdownMenu {\n  border-radius: 2px;\n  padding: 0 !important;\n}\n\n.blocklyDropdownMenu .blocklyMenuItem {\n  /* 28px on the left for icon or checkbox. */\n  padding-left: 28px;\n}\n\n/* BiDi override for the resting state. */\n.blocklyDropdownMenu .blocklyMenuItemRtl {\n  /* Flip left/right padding for BiDi. */\n  padding-left: 5px;\n  padding-right: 28px;\n}\n\n.blocklyWidgetDiv .blocklyMenu {\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n  background: #fff;\n  border: 1px solid transparent;\n  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);\n  font: normal 13px Arial, sans-serif;\n  margin: 0;\n  outline: none;\n  padding: 4px 0;\n  position: absolute;\n  overflow-y: auto;\n  overflow-x: hidden;\n  max-height: 100%;\n  z-index: 20000;  /* Arbitrary, but some apps depend on it... */\n}\n\n.blocklyWidgetDiv .blocklyMenu:focus {\n  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownDiv .blocklyMenu {\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n  background: inherit;  /* Compatibility with gapi, reset from goog-menu */\n  border: inherit;  /* Compatibility with gapi, reset from goog-menu */\n  font: normal 13px "Helvetica Neue", Helvetica, sans-serif;\n  outline: none;\n  overflow-y: auto;\n  overflow-x: hidden;\n  max-height: 100%;\n  z-index: 20000;  /* Arbitrary, but some apps depend on it... */\n}\n\n/* State: resting. */\n.blocklyMenuItem {\n  border: none;\n  color: #000;\n  cursor: pointer;\n  list-style: none;\n  margin: 0;\n  /* 7em on the right for shortcut. */\n  min-width: 7em;\n  padding: 6px 15px;\n  white-space: nowrap;\n}\n\n/* State: disabled. */\n.blocklyMenuItemDisabled {\n  color: #ccc;\n  cursor: inherit;\n}\n\n/* State: hover. */\n.blocklyMenuItemHighlight {\n  background-color: rgba(0,0,0,.1);\n}\n\n/* State: selected/checked. */\n.blocklyMenuItemCheckbox {\n  height: 16px;\n  position: absolute;\n  width: 16px;\n}\n\n.blocklyMenuItemSelected .blocklyMenuItemCheckbox {\n  background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px;\n  float: left;\n  margin-left: -24px;\n  position: static;  /* Scroll with the menu. */\n}\n\n.blocklyMenuItemRtl .blocklyMenuItemCheckbox {\n  float: right;\n  margin-right: -24px;\n}\n\n.blocklyMenuSeparator {\n  background-color: #ccc;\n  height: 1px;\n  border: 0;\n  margin-left: 4px;\n  margin-right: 4px;\n}\n\n.blocklyBlockDragSurface, .blocklyAnimationLayer {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  overflow: visible !important;\n  z-index: 80;\n  pointer-events: none;\n}\n\n.blocklyField {\n  cursor: default;\n}\n\n.blocklyInputField {\n  cursor: text;\n}\n\n.blocklyDragging .blocklyField,\n.blocklyDragging .blocklyIconGroup {\n  cursor: grabbing;\n}\n\n.blocklyActiveFocus:is(\n  .blocklyFlyout,\n  .blocklyWorkspace,\n  .blocklyField,\n  .blocklyPath,\n  .blocklyHighlightedConnectionPath,\n  .blocklyComment,\n  .blocklyBubble,\n  .blocklyIconGroup,\n  .blocklyTextarea\n) {\n  outline: none;\n}\n',Wh={};Wh.inject=fc,Wh.register=Pt;var S=class{constructor(e,t){this.x=e,this.y=t}clone(){return new S(this.x,this.y)}scale(e){return this.x*=e,this.y*=e,this}translate(e,t){return this.x+=e,this.y+=t,this}static equals(e,t){return e===t||!(!e||!t)&&e.x===t.x&&e.y===t.y}static distance(e,t){const i=e.x-t.x;return e=e.y-t.y,Math.sqrt(i*i+e*e)}static magnitude(e){return Math.sqrt(e.x*e.x+e.y*e.y)}static difference(e,t){return new S(e.x-t.x,e.y-t.y)}static sum(e,t){return new S(e.x+t.x,e.y+t.y)}},f=class{constructor(e){this.tagName=e}toString(){return this.tagName}};f.ANIMATE=new f("animate"),f.CIRCLE=new f("circle"),f.CLIPPATH=new f("clipPath"),f.DEFS=new f("defs"),f.FECOMPOSITE=new f("feComposite"),f.FECOMPONENTTRANSFER=new f("feComponentTransfer"),f.FEFLOOD=new f("feFlood"),f.FEFUNCA=new f("feFuncA"),f.FEGAUSSIANBLUR=new f("feGaussianBlur"),f.FEPOINTLIGHT=new f("fePointLight"),f.FESPECULARLIGHTING=new f("feSpecularLighting"),f.FILTER=new f("filter"),f.FOREIGNOBJECT=new f("foreignObject"),f.G=new f("g"),f.IMAGE=new f("image"),f.LINE=new f("line"),f.PATH=new f("path"),f.PATTERN=new f("pattern"),f.POLYGON=new f("polygon"),f.RECT=new f("rect"),f.SVG=new f("svg"),f.TEXT=new f("text"),f.TSPAN=new f("tspan");var z=class{constructor(e,t,i,s){this.top=e,this.bottom=t,this.left=i,this.right=s}static from(e){return new z(e.y,e.y+e.height,e.x,e.x+e.width)}clone(){return new z(this.top,this.bottom,this.left,this.right)}getHeight(){return this.bottom-this.top}getWidth(){return this.right-this.left}getOrigin(){return new S(this.left,this.top)}contains(e,t){return e>=this.left&&e<=this.right&&t>=this.top&&t<=this.bottom}intersects(e){return this.left<=e.right&&this.right>=e.left&&this.bottom>=e.top&&this.top<=e.bottom}static equals(e,t){return e===t||!(!e||!t)&&e.top===t.top&&e.bottom===t.bottom&&e.left===t.left&&e.right===t.right}static createFromPoint(e,t,i){const s=e.x;return new z(e=e.y,e+i,s,s+t)}},j=class{constructor(e,t){this.width=e,this.height=t}static equals(e,t){return e===t||!(!e||!t)&&e.width===t.width&&e.height===t.height}static max(e,t){return new j(Math.max(e.width,t.width),Math.max(e.height,t.height))}static min(e,t){return new j(Math.min(e.width,t.width),Math.min(e.height,t.height))}},x$={getSizeInternal:Ju},Si={TEST_ONLY:x$};Si.getBorderBox=vc,Si.getComputedStyle=Ft,Si.getContainerOffsetToScrollInto=Cc,Si.getPageOffset=xo,Si.getSize=nn,Si.getViewportPageOffset=Ec,Si.scrollIntoContainerView=yc;var A$=/translate\(\s*([-+\d.e]+)([ ,]\s*([-+\d.e]+)\s*)?/,R$=/transform:\s*translate(?:3d)?\(\s*([-+\d.e]+)\s*px([ ,]\s*([-+\d.e]+)\s*px)?/,ys={TEST_ONLY:{XY_REGEX:A$,XY_STYLE_REGEX:R$}};ys.getDocumentScroll=kc,ys.getInjectionDivXY=rr,ys.getRelativeXY=rn,ys.getViewportBBox=Ic,ys.screenToWsCoordinates=Sc,ys.wsToScreenCoordinates=Ji;var _e=class{constructor(e,t,i,s,n){this.workspace=e,this.horizontal=t,this.oldHostMetrics=null,this.ratio=1,this.origin=new S(0,0),this.startDragHandle=this.handlePosition=this.handleLength=this.scrollbarLength=this.startDragMouse=0,this.containerVisible=this.isHandleVisible=!0,this.position=new S(0,0),this.onMouseMoveWrapper_=this.onMouseUpWrapper_=null,this.pair=i||!1,this.margin=void 0!==n?n:_e.DEFAULT_SCROLLBAR_MARGIN,e="blocklyScrollbar"+(this.horizontal?"Horizontal":"Vertical"),s&&(e+=" "+s),this.outerSvg=I(f.SVG,{class:e}),s=I(f.G,{},this.outerSvg),this.svgBackground=I(f.RECT,{class:"blocklyScrollbarBackground"},s),e=Math.floor((_e.scrollbarThickness-5)/2),this.svgHandle=I(f.RECT,{class:"blocklyScrollbarHandle",rx:e,ry:e},s),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarColour","fill"),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarOpacity","fill-opacity"),c(this.outerSvg,this.workspace.getParentSvg()),this.setInitialThickness(),t?(this.lengthAttribute_="width",this.positionAttribute_="x"):(this.lengthAttribute_="height",this.positionAttribute_="y"),this.onMouseDownBarWrapper_=L(this.svgBackground,"pointerdown",this,this.onMouseDownBar),this.onMouseDownHandleWrapper_=L(this.svgHandle,"pointerdown",this,this.onMouseDownHandle)}setInitialThickness(){const e=_e.scrollbarThickness;this.horizontal?(this.svgBackground.setAttribute("height",String(e)),this.outerSvg.setAttribute("height",String(e)),this.svgHandle.setAttribute("height",String(e-5)),this.svgHandle.setAttribute("y","2.5")):(this.svgBackground.setAttribute("width",String(e)),this.outerSvg.setAttribute("width",String(e)),this.svgHandle.setAttribute("width",String(e-5)),this.svgHandle.setAttribute("x","2.5"))}dispose(){this.cleanUp(),K(this.onMouseDownBarWrapper_),K(this.onMouseDownHandleWrapper_),J(this.outerSvg),this.workspace.getThemeManager().unsubscribe(this.svgHandle)}constrainHandleLength(e){return e<=0||isNaN(e)?0:Math.min(e,this.scrollbarLength)}setHandleLength(e){this.handleLength=e,this.svgHandle.setAttribute(this.lengthAttribute_,String(this.handleLength))}constrainHandlePosition(e){return e<=0||isNaN(e)?0:Math.min(e,this.scrollbarLength-this.handleLength)}setHandlePosition(e){this.handlePosition=e,this.svgHandle.setAttribute(this.positionAttribute_,String(this.handlePosition))}setScrollbarLength(e){this.scrollbarLength=e,this.outerSvg.setAttribute(this.lengthAttribute_,String(this.scrollbarLength)),this.svgBackground.setAttribute(this.lengthAttribute_,String(this.scrollbarLength))}setPosition(e,t){this.position.x=e,this.position.y=t,h(this.outerSvg,"translate("+(this.position.x+this.origin.x)+"px,"+(this.position.y+this.origin.y)+"px)")}resize(e){!e&&!(e=this.workspace.getMetrics())||this.oldHostMetrics&&_e.metricsAreEquivalent(e,this.oldHostMetrics)||(this.horizontal?this.resizeHorizontal(e):this.resizeVertical(e),this.oldHostMetrics=e,this.updateMetrics())}requiresViewResize(e){return!this.oldHostMetrics||this.oldHostMetrics.viewWidth!==e.viewWidth||this.oldHostMetrics.viewHeight!==e.viewHeight||this.oldHostMetrics.absoluteLeft!==e.absoluteLeft||this.oldHostMetrics.absoluteTop!==e.absoluteTop}resizeHorizontal(e){this.requiresViewResize(e)?this.resizeViewHorizontal(e):this.resizeContentHorizontal(e)}resizeViewHorizontal(e){var t=e.viewWidth-2*this.margin;this.pair&&(t-=_e.scrollbarThickness),this.setScrollbarLength(Math.max(0,t)),t=e.absoluteLeft+this.margin,this.pair&&this.workspace.RTL&&(t+=_e.scrollbarThickness),this.setPosition(t,e.absoluteTop+e.viewHeight-_e.scrollbarThickness-this.margin),this.resizeContentHorizontal(e)}resizeContentHorizontal(e){if(e.viewWidth>=e.scrollWidth)this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(!1);else{this.pair||this.setVisible(!0);var t=this.scrollbarLength*e.viewWidth/e.scrollWidth;t=this.constrainHandleLength(t),this.setHandleLength(t);var i=this.scrollbarLength-this.handleLength;e=this.constrainHandlePosition(e=(e.viewLeft-e.scrollLeft)/(t=e.scrollWidth-e.viewWidth)*i),this.setHandlePosition(e),this.ratio=i/t}}resizeVertical(e){this.requiresViewResize(e)?this.resizeViewVertical(e):this.resizeContentVertical(e)}resizeViewVertical(e){let t=e.viewHeight-2*this.margin;this.pair&&(t-=_e.scrollbarThickness),this.setScrollbarLength(Math.max(0,t)),this.setPosition(this.workspace.RTL?e.absoluteLeft+this.margin:e.absoluteLeft+e.viewWidth-_e.scrollbarThickness-this.margin,e.absoluteTop+this.margin),this.resizeContentVertical(e)}resizeContentVertical(e){if(e.viewHeight>=e.scrollHeight)this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(!1);else{this.pair||this.setVisible(!0);var t=this.scrollbarLength*e.viewHeight/e.scrollHeight;t=this.constrainHandleLength(t),this.setHandleLength(t);var i=this.scrollbarLength-this.handleLength;e=this.constrainHandlePosition(e=(e.viewTop-e.scrollTop)/(t=e.scrollHeight-e.viewHeight)*i),this.setHandlePosition(e),this.ratio=i/t}}isVisible(){return this.isHandleVisible}setContainerVisible(e){const t=e!==this.containerVisible;this.containerVisible=e,t&&this.updateDisplay_()}setVisible(e){if(this.pair)throw Error("Unable to toggle visibility of paired scrollbars.");this.setVisibleInternal(e)}setVisibleInternal(e){const t=e!==this.isVisible();this.isHandleVisible=e,t&&this.updateDisplay_()}updateDisplay_(){this.containerVisible&&this.isVisible()?this.outerSvg.setAttribute("display","block"):this.outerSvg.setAttribute("display","none")}onMouseDownBar(e){if(this.workspace.markFocused(),Ae(),this.cleanUp(),ot(e))e.stopPropagation();else{var t=Et(e,this.workspace.getParentSvg(),this.workspace.getInverseScreenCTM());t=this.horizontal?t.x:t.y;var i=rr(this.svgHandle),s=this.handlePosition,n=.95*this.handleLength;t<=(i=this.horizontal?i.x:i.y)?s-=n:t>=i+this.handleLength&&(s+=n),this.setHandlePosition(this.constrainHandlePosition(s)),this.updateMetrics(),e.stopPropagation(),e.preventDefault()}}onMouseDownHandle(e){this.workspace.markFocused(),this.cleanUp(),ot(e)?e.stopPropagation():(this.startDragHandle=this.handlePosition,this.startDragMouse=this.horizontal?e.clientX:e.clientY,this.onMouseUpWrapper_=L(document,"pointerup",this,this.onMouseUpHandle),this.onMouseMoveWrapper_=L(document,"pointermove",this,this.onMouseMoveHandle),e.stopPropagation(),e.preventDefault())}onMouseMoveHandle(e){this.setHandlePosition(this.constrainHandlePosition(this.startDragHandle+((this.horizontal?e.clientX:e.clientY)-this.startDragMouse))),this.updateMetrics()}onMouseUpHandle(){Ae(),this.cleanUp()}cleanUp(){this.workspace.hideChaff(!0),this.onMouseUpWrapper_&&(K(this.onMouseUpWrapper_),this.onMouseUpWrapper_=null),this.onMouseMoveWrapper_&&(K(this.onMouseMoveWrapper_),this.onMouseMoveWrapper_=null)}getRatio_(){let e=this.handlePosition/(this.scrollbarLength-this.handleLength);return isNaN(e)&&(e=0),e}updateMetrics(){const e=this.getRatio_();this.workspace.setMetrics(this.horizontal?{x:e}:{y:e})}set(e,t){this.setHandlePosition(this.constrainHandlePosition(e*this.ratio)),(t||void 0===t)&&this.updateMetrics()}setOrigin(e,t){this.origin=new S(e,t)}static metricsAreEquivalent(e,t){return e.viewWidth===t.viewWidth&&e.viewHeight===t.viewHeight&&e.viewLeft===t.viewLeft&&e.viewTop===t.viewTop&&e.absoluteTop===t.absoluteTop&&e.absoluteLeft===t.absoluteLeft&&e.scrollWidth===t.scrollWidth&&e.scrollHeight===t.scrollHeight&&e.scrollLeft===t.scrollLeft&&e.scrollTop===t.scrollTop}};_e.scrollbarThickness=r$?25:15,_e.DEFAULT_SCROLLBAR_MARGIN=.5;var xa={parseFromString:function(){throw Error("DOMParser was not found in the global scope and was not properly injected using injectDependencies")}},qh={serializeToString:function(){throw Error("XMLSerializer was not foundin the global scope and was not properly injected using injectDependencies")}},{document:Aa,DOMParser:Ol,XMLSerializer:Ml}=globalThis;Ol&&(xa=new Ol),Ml&&(qh=new Ml);var O$="https://developers.google.com/blockly/xml",U_=/[\x00-\x09\x0B\x0C\x0E-\x1F]/g,Dn={NAME_SPACE:O$};Dn.createElement=o.createElement$$module$build$src$core$utils$xml,Dn.createTextNode=o.createTextNode$$module$build$src$core$utils$xml,Dn.domToText=Qi,Dn.injectDependencies=Qu,Dn.textToDom=o.textToDom$$module$build$src$core$utils$xml;var G,zh="categoryToolbox",M$="flyoutToolbox";!function(e){e[e.TOP=0]="TOP",e[e.BOTTOM=1]="BOTTOM",e[e.LEFT=2]="LEFT",e[e.RIGHT=3]="RIGHT"}(G||(G={}));var N$={hasCategoriesInternal:od},wi={};wi.Position=G,wi.TEST_ONLY=N$,wi.convertFlyoutDefToJsonArray=ln,wi.convertToolboxDefToJson=lr,wi.hasCategories=cr,wi.isCategoryCollapsible=ar,wi.parseToolboxTree=xc;var xi=function(e){return e[e.TOP=0]="TOP",e[e.BOTTOM=1]="BOTTOM",e}(xi||{}),Nl=function(e){return e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT",e}(Nl||{}),Cs=function(e){return e[e.UP=0]="UP",e[e.DOWN=1]="DOWN",e}(Cs||{}),Is={};Is.bumpDirection=Cs,Is.bumpPositionRect=pr,Is.getCornerOppositeToolbox=hr,Is.getStartPositionRect=dr,Is.horizontalPosition=Nl,Is.verticalPosition=xi;var Ye_width=96,Ye_height=124,Ye_url="sprites.png",jh=class{constructor(e){this.workspace=e,this.id="zoomControls",this.boundEvents=[],this.zoomResetGroup=this.zoomOutGroup=this.zoomInGroup=null,this.HEIGHT=this.WIDTH=32,this.SMALL_SPACING=2,this.LARGE_SPACING=11,this.MARGIN_HORIZONTAL=this.MARGIN_VERTICAL=20,this.svgGroup=null,this.top=this.left=0,this.initialized=!1}createDom(){this.svgGroup=I(f.G,{});const e=String(Math.random()).substring(2);return this.createZoomOutSvg(e),this.createZoomInSvg(e),this.workspace.isMovable()&&this.createZoomResetSvg(e),this.svgGroup}init(){this.workspace.getComponentManager().addComponent({component:this,weight:de.ComponentWeight.ZOOM_CONTROLS_WEIGHT,capabilities:[de.Capability.POSITIONABLE]}),this.initialized=!0}dispose(){this.workspace.getComponentManager().removeComponent("zoomControls"),this.svgGroup&&J(this.svgGroup);for(const e of this.boundEvents)K(e);this.boundEvents.length=0}getBoundingRectangle(){let e=this.SMALL_SPACING+2*this.HEIGHT;return this.zoomResetGroup&&(e+=this.LARGE_SPACING+this.HEIGHT),new z(this.top,this.top+e,this.left,this.left+this.WIDTH)}position(e,t){if(this.initialized){var a,i=hr(this.workspace,e),s=this.SMALL_SPACING+2*this.HEIGHT;if(this.zoomResetGroup&&(s+=this.LARGE_SPACING+this.HEIGHT),e=dr(i,new j(this.WIDTH,s),this.MARGIN_HORIZONTAL,this.MARGIN_VERTICAL,e,this.workspace),t=pr(e,this.MARGIN_VERTICAL,(i=i.vertical)===xi.TOP?Cs.DOWN:Cs.UP,t),i===xi.TOP){var r,n=this.SMALL_SPACING+this.HEIGHT;null==(r=this.zoomInGroup)||r.setAttribute("transform","translate(0, "+n+")"),this.zoomResetGroup&&this.zoomResetGroup.setAttribute("transform","translate(0, "+(n+this.LARGE_SPACING+this.HEIGHT)+")")}else{let $;r=this.zoomResetGroup?this.LARGE_SPACING+this.HEIGHT:0,null==($=this.zoomInGroup)||$.setAttribute("transform","translate(0, "+r+")"),r=r+this.SMALL_SPACING+this.HEIGHT,null==(n=this.zoomOutGroup)||n.setAttribute("transform","translate(0, "+r+")")}this.top=t.top,this.left=t.left,null==(a=this.svgGroup)||a.setAttribute("transform","translate("+this.left+","+this.top+")")}}createZoomOutSvg(e){this.zoomOutGroup=I(f.G,{class:"blocklyZoom blocklyZoomOut"},this.svgGroup);const t=I(f.CLIPPATH,{id:"blocklyZoomoutClipPath"+e},this.zoomOutGroup);I(f.RECT,{width:32,height:32},t),I(f.IMAGE,{width:Ye_width,height:Ye_height,x:-64,y:-92,"clip-path":"url(#blocklyZoomoutClipPath"+e+")"},this.zoomOutGroup).setAttributeNS($t,"xlink:href",this.workspace.options.pathToMedia+Ye_url),this.boundEvents.push(L(this.zoomOutGroup,"pointerdown",null,this.zoom.bind(this,-1)))}createZoomInSvg(e){this.zoomInGroup=I(f.G,{class:"blocklyZoom blocklyZoomIn"},this.svgGroup);const t=I(f.CLIPPATH,{id:"blocklyZoominClipPath"+e},this.zoomInGroup);I(f.RECT,{width:32,height:32},t),I(f.IMAGE,{width:Ye_width,height:Ye_height,x:-32,y:-92,"clip-path":"url(#blocklyZoominClipPath"+e+")"},this.zoomInGroup).setAttributeNS($t,"xlink:href",this.workspace.options.pathToMedia+Ye_url),this.boundEvents.push(L(this.zoomInGroup,"pointerdown",null,this.zoom.bind(this,1)))}zoom(e,t){this.workspace.markFocused(),this.workspace.zoomCenter(e),this.fireZoomEvent(),Ae(),t.stopPropagation(),t.preventDefault()}createZoomResetSvg(e){this.zoomResetGroup=I(f.G,{class:"blocklyZoom blocklyZoomReset"},this.svgGroup);const t=I(f.CLIPPATH,{id:"blocklyZoomresetClipPath"+e},this.zoomResetGroup);I(f.RECT,{width:32,height:32},t),I(f.IMAGE,{width:Ye_width,height:Ye_height,y:-92,"clip-path":"url(#blocklyZoomresetClipPath"+e+")"},this.zoomResetGroup).setAttributeNS($t,"xlink:href",this.workspace.options.pathToMedia+Ye_url),this.boundEvents.push(L(this.zoomResetGroup,"pointerdown",null,this.resetZoom.bind(this)))}resetZoom(e){this.workspace.markFocused();const t=Math.log(this.workspace.options.zoomOptions.startScale/this.workspace.scale)/Math.log(this.workspace.options.zoomOptions.scaleSpeed);this.workspace.beginCanvasTransition(),this.workspace.zoomCenter(t),this.workspace.scrollCenter(),setTimeout(this.workspace.endCanvasTransition.bind(this.workspace),500),this.fireZoomEvent(),Ae(),e.stopPropagation(),e.preventDefault()}fireZoomEvent(){const e=new(P(b.CLICK))(null,this.workspace.id,"zoom_controls");B(e)}};Pt("\n.blocklyZoom>image, .blocklyZoom>svg>image {\n  opacity: .4;\n}\n\n.blocklyZoom>image:hover, .blocklyZoom>svg>image:hover {\n  opacity: .6;\n}\n\n.blocklyZoom>image:active, .blocklyZoom>svg>image:active {\n  opacity: .8;\n}\n");var V_={BLOCKS:50,PROCEDURES:75,VARIABLES:100,WORKSPACE_COMMENTS:25},Xh={};Xh.register=cn,Xh.unregister=sd;var F$=class{constructor(){this.priority=25}save(e){const t=[];for(const i of e.getTopComments())(e=ui(i,{addCoordinates:!0,saveIds:!0}))&&t.push(e);return t.length?t:null}load(e,t){for(const i of e)an(i,t,{recordUndo:ke()})}clear(e){for(const t of e.getTopComments())t.dispose()}};cn("workspaceComments",new F$);var Ra={};Ra.WorkspaceCommentSerializer=F$,Ra.append=an,Ra.save=ui;var Yh={};Yh.register=gr,Yh.unregister=nd;var Ll=class{paste(e,t,i){let s;e=e.commentState,i&&(e.x=i.x,e.y=i.y),o.disable$$module$build$src$core$events$utils();try{s=an(e,t),rd(s)}finally{o.enable$$module$build$src$core$events$utils()}return s?(se()&&B(new(P(b.COMMENT_CREATE))(s)),o.getFocusManager$$module$build$src$core$focus_manager().focusNode(s),s):null}};Ll.TYPE="workspace-comment",gr(Ll.TYPE,new Ll),o.config$$module$build$src$core$config={dragRadius:5,flyoutDragRadius:10,snapRadius:28,connectingSnapRadius:28,currentConnectionPreference:8,bumpDelay:250};var mt,W_="aria-",q_="role";!function(e){e.GRID="grid",e.GRIDCELL="gridcell",e.GROUP="group",e.LISTBOX="listbox",e.MENU="menu",e.MENUITEM="menuitem",e.MENUITEMCHECKBOX="menuitemcheckbox",e.OPTION="option",e.PRESENTATION="presentation",e.ROW="row",e.TREE="tree",e.TREEITEM="treeitem",e.SEPARATOR="separator",e.STATUS="status"}(mt||(mt={}));var ye=function(e){return e.ACTIVEDESCENDANT="activedescendant",e.COLCOUNT="colcount",e.DISABLED="disabled",e.EXPANDED="expanded",e.INVALID="invalid",e.LABEL="label",e.LABELLEDBY="labelledby",e.LEVEL="level",e.ORIENTATION="orientation",e.POSINSET="posinset",e.ROWCOUNT="rowcount",e.SELECTED="selected",e.SETSIZE="setsize",e.VALUEMAX="valuemax",e.VALUEMIN="valuemin",e.LIVE="live",e.HIDDEN="hidden",e}(ye||{}),Dl={};Dl.Role=mt,Dl.State=ye,Dl.setRole=Ut,Dl.setState=Ee;var Bl=class{constructor(e,t){this.content=e,this.opt_value=t,this.enabled=!0,this.element=null,this.rightToLeft=!1,this.roleName=null,this.highlight=this.checked=this.checkable=!1,this.actionHandler=null}createDom(){const e=document.createElement("div");e.id=ze(),this.element=e,e.className="blocklyMenuItem "+(this.enabled?"":"blocklyMenuItemDisabled ")+(this.checked?"blocklyMenuItemSelected ":"")+(this.highlight?"blocklyMenuItemHighlight ":"")+(this.rightToLeft?"blocklyMenuItemRtl ":"");const t=document.createElement("div");if(t.className="blocklyMenuItemContent",this.checkable){var i=document.createElement("div");i.className="blocklyMenuItemCheckbox ",t.appendChild(i)}return i=this.content,"string"==typeof this.content&&(i=document.createTextNode(this.content)),t.appendChild(i),e.appendChild(t),this.roleName&&Ut(e,this.roleName),Ee(e,ye.SELECTED,this.checkable&&this.checked||!1),Ee(e,ye.DISABLED,!this.enabled),e}dispose(){this.element=null}getElement(){return this.element}getId(){return this.element.id}getValue(){let e;return null!=(e=this.opt_value)?e:null}setRightToLeft(e){this.rightToLeft=e}setRole(e){this.roleName=e}setCheckable(e){this.checkable=e}setChecked(e){this.checked=e}setHighlighted(e){this.highlight=e;const t=this.getElement();t&&this.isEnabled()&&(e?A(t,"blocklyMenuItemHighlight"):X(t,"blocklyMenuItemHighlight"))}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}performAction(e){this.isEnabled()&&this.actionHandler&&this.actionHandler(this,e)}onAction(e,t){this.actionHandler=e.bind(t)}},Oa=class{constructor(){this.menuItems=[],this.roleName=this.element=this.onKeyDownHandler=this.pointerLeaveHandler=this.pointerEnterHandler=this.clickHandler=this.pointerMoveHandler=this.highlightedItem=this.openingCoords=null}addChild(e){this.menuItems.push(e)}render(e){const t=document.createElement("div");t.className="blocklyMenu",t.tabIndex=0,this.roleName&&Ut(t,this.roleName),this.element=t;for(let s,i=0;s=this.menuItems[i];i++)t.appendChild(s.createDom());return this.pointerMoveHandler=L(t,"pointermove",this,this.handlePointerMove,!0),this.clickHandler=L(t,"pointerup",this,this.handleClick,!0),this.pointerEnterHandler=L(t,"pointerenter",this,this.handlePointerEnter,!0),this.pointerLeaveHandler=L(t,"pointerleave",this,this.handlePointerLeave,!0),this.onKeyDownHandler=L(t,"keydown",this,this.handleKeyEvent),e.appendChild(t),t}getElement(){return this.element}focus(){const e=this.getElement();e&&e.focus({preventScroll:!0})}blur(){const e=this.getElement();e&&e.blur()}setRole(e){this.roleName=e}dispose(){this.pointerMoveHandler&&(K(this.pointerMoveHandler),this.pointerMoveHandler=null),this.clickHandler&&(K(this.clickHandler),this.clickHandler=null),this.pointerEnterHandler&&(K(this.pointerEnterHandler),this.pointerEnterHandler=null),this.pointerLeaveHandler&&(K(this.pointerLeaveHandler),this.pointerLeaveHandler=null),this.onKeyDownHandler&&(K(this.onKeyDownHandler),this.onKeyDownHandler=null);for(let t,e=0;t=this.menuItems[e];e++)t.dispose();this.element=null}getMenuItem(e){const t=this.getElement();for(;e&&e!==t;){if(e.classList.contains("blocklyMenuItem")){const i=this.getMenuItems();for(let n,s=0;n=i[s];s++)if(n.getElement()===e)return n}e=e.parentElement}return null}setHighlighted(e){var t=this.highlightedItem;if(t&&(t.setHighlighted(!1),this.highlightedItem=null),e){e.setHighlighted(!0),this.highlightedItem=e,t=this.getElement();const i=e.getElement();t&&i&&(yc(i,t),Ee(t,ye.ACTIVEDESCENDANT,e.getId()))}}highlightNext(){const e=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(e,1)}highlightPrevious(){const e=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(e<0?this.menuItems.length:e,-1)}highlightFirst(){this.highlightHelper(-1,1)}highlightLast(){this.highlightHelper(this.menuItems.length,-1)}highlightHelper(e,t){let i;e+=t;const s=this.getMenuItems();for(;i=s[e];){if(i.isEnabled()){this.setHighlighted(i);break}e+=t}}handlePointerMove(e){0!==Math.max(Math.abs(e.movementX),Math.abs(e.movementY))&&(e=this.getMenuItem(e.target))&&(e.isEnabled()?this.highlightedItem!==e&&this.setHighlighted(e):this.setHighlighted(null))}handleClick(e){var t=this.openingCoords;if(this.openingCoords=null,t&&"number"==typeof e.clientX){const i=new S(e.clientX,e.clientY);if(S.distance(t,i)<1)return}(t=this.getMenuItem(e.target))&&t.performAction(e)}handlePointerEnter(e){this.focus()}handlePointerLeave(e){this.getElement()&&this.setHighlighted(null)}handleKeyEvent(e){if(this.menuItems.length&&!(e.shiftKey||e.ctrlKey||e.metaKey||e.altKey)){var t=this.highlightedItem;switch(e.key){case"Enter":case" ":t&&t.performAction(e);break;case"ArrowUp":this.highlightPrevious();break;case"ArrowDown":this.highlightNext();break;case"PageUp":case"Home":this.highlightFirst();break;case"PageDown":case"End":this.highlightLast();break;default:return}e.preventDefault(),e.stopPropagation()}}getSize(){const e=this.getElement(),t=nn(e);return t.height=e.scrollHeight,t}getMenuItems(){return this.menuItems.filter(e=>e instanceof Bl)}},Jh=class{constructor(){this.element=null}createDom(){return this.element=document.createElement("hr"),this.element.className="blocklyMenuSeparator",Ut(this.element,mt.SEPARATOR),this.element}dispose(){let e;null==(e=this.element)||e.remove(),this.element=null}},Bn="_TEMP_COLLAPSED_INPUT",Pl="_TEMP_COLLAPSED_FIELD",xt="MANUALLY_DISABLED",Y_={COLLAPSED_FIELD_NAME:Pl,COLLAPSED_INPUT_NAME:Bn,MANUALLY_DISABLED:xt};!function(e){e[e.VALUE=1]="VALUE",e[e.STATEMENT=3]="STATEMENT",e[e.DUMMY=5]="DUMMY",e[e.CUSTOM=6]="CUSTOM",e[e.END_ROW=7]="END_ROW"}(o.inputTypes$$module$build$src$core$inputs$input_types||(o.inputTypes$$module$build$src$core$inputs$input_types={}));var op,H$,Ma=new Set,Qh=new WeakSet,ep=new WeakMap,Pn=null,tp=null,U$=0,Na={};Na.finishQueuedRenders=Ht,Na.queueRender=Ac,Na.triggerQueuedRenders=Ao,o.Msg$$module$build$src$core$msg=Object.create(null),op=function(e){Object.keys(e).forEach(function(t){o.Msg$$module$build$src$core$msg[t]=e[t]})},H$={Msg:o.Msg$$module$build$src$core$msg,setLocale:op};var Fl="blocklyToast",V$="blocklyToastMessage",G$="blocklyToastCloseButton",Ai=class{static show(e,t){if(t.oncePerSession&&t.id){if(this.shownIds.has(t.id))return;this.shownIds.add(t.id)}this.hide(e);const i=this.createDom(e,t);requestAnimationFrame(()=>{i.style.bottom="2rem"})}static createDom(e,t){const{message:i,duration:s=5,assertiveness:n=Ai.Assertiveness.POLITE}=t,r=document.createElement("div");e.getInjectionDiv().appendChild(r),r.dataset.toastId=t.id,r.className=Fl,Ut(r,mt.STATUS),Ee(r,ye.LIVE,n),(t=r.appendChild(document.createElement("div"))).className=V$,t.innerText=i,(t=r.appendChild(document.createElement("button"))).className=G$,Ee(t,ye.LABEL,o.Msg$$module$build$src$core$msg.CLOSE);var a=I(f.SVG,{width:24,height:24,viewBox:"0 0 24 24",fill:"none"},t);let $;return Ee(a,ye.HIDDEN,!0),I(f.RECT,{x:19.7782,y:2.80762,width:2,height:24,transform:"rotate(45, 19.7782, 2.80762)",fill:"black"},a),I(f.RECT,{x:2.80762,y:4.22183,width:2,height:24,transform:"rotate(-45, 2.80762, 4.22183)",fill:"black"},a),t.addEventListener("click",()=>{r.remove(),e.markFocused()}),t=()=>{$=setTimeout(()=>r.remove(),1e3*s)},r.addEventListener("focusin",a=()=>clearTimeout($)),r.addEventListener("focusout",t),r.addEventListener("mouseenter",a),r.addEventListener("mousemove",a),r.addEventListener("mouseleave",t),t(),r}static hide(e,t){(e=e.getInjectionDiv().querySelector(`.${Fl}`))instanceof HTMLElement&&(!t||t===e.dataset.toastId)&&e.remove()}};Ai.shownIds=new Set,function(e){(e=e.Assertiveness||(e.Assertiveness={})).ASSERTIVE="assertive",e.POLITE="polite"}(Ai||(Ai={})),Pt(`\n.${Fl} {\n  font-size: 1.2rem;\n  position: absolute;\n  bottom: -10rem;\n  right: 2rem;\n  padding: 1rem;\n  color: black;\n  background-color: white;\n  border: 2px solid black;\n  border-radius: 0.4rem;\n  z-index: 999;\n  display: flex;\n  align-items: center;\n  gap: 0.8rem;\n  line-height: 1.5;\n  transition: bottom 0.3s ease-out;\n}\n\n.${Fl} .${V$} {\n  maxWidth: 18rem;\n}\n\n.${Fl} .${G$} {\n  margin: 0;\n  padding: 0.2rem;\n  background-color: transparent;\n  color: black;\n  border: none;\n  cursor: pointer;\n}\n`);var Z$=function(e,t){window.alert(e),t&&t()},W$=Z$,q$=function(e,t){t(window.confirm(e))},z$=q$,j$=function(e,t,i){i(window.prompt(e,t))},X$=j$,Y$=Ai.show.bind(Ai),K$=Y$,jo={};jo.alert=un,jo.confirm=mr,jo.prompt=_r,jo.setAlert=ud,jo.setConfirm=dd,jo.setPrompt=hd,jo.setToast=gd,jo.toast=pd;var J$={};J$.isLegacyProcedureCallBlock=Nc,J$.isLegacyProcedureDefBlock=di;var Q$=new Set,em={};em.warn=Re;var La="VARIABLE",ip="ijkmnopqrstuvwxyzabcdefgh",tm={generateUniqueNameInternal:md},ve={CATEGORY_NAME:La,TEST_ONLY:tm,VAR_LETTER_OPTIONS:ip};ve.allDeveloperVariables=o.allDeveloperVariables$$module$build$src$core$variables,ve.allUsedVarModels=o.allUsedVarModels$$module$build$src$core$variables,ve.compareByName=ts,ve.createVariableButtonHandler=hi,ve.deleteVariable=o.deleteVariable$$module$build$src$core$variables,ve.flyoutCategory=Lc,ve.flyoutCategoryBlocks=Dc,ve.generateUniqueName=Bc,ve.generateUniqueNameFromOptions=Er,ve.generateVariableFieldDom=pi,ve.getAddedVariables=hn,ve.getOrCreateVariablePackage=o.getOrCreateVariablePackage$$module$build$src$core$variables,ve.getVariable=o.getVariable$$module$build$src$core$variables,ve.getVariableUsesById=os,ve.internalFlyoutCategory=fr,ve.jsonFlyoutCategoryBlocks=Tr,ve.nameUsedWithAnyType=Pc,ve.nameUsedWithConflictingParam=Fc,ve.promptName=vr,ve.renameVariable=o.renameVariable$$module$build$src$core$variables;var Fn=class extends Error{},om=class extends Fn{constructor(e){super("Expected to find a 'type' property, defining the block type"),this.state=e}},Ul=class extends Fn{constructor(e,t,i){super(`The block ${t.toDevString()} is missing a(n) ${e}\nconnection`),this.block=t,this.state=i}},im=class extends Fn{constructor(e,t,i,s){super(`The block ${i.toDevString()} could not connect its\n${t} to its parent, because: ${e}`),this.childBlock=i,this.childState=s}},sm=class extends Fn{constructor(e){super("Encountered a real block which is defined as a child of a shadow\nblock. It is an invariant of Blockly that shadow blocks only have shadow\nchildren"),this.state=e}},nm=class extends Fn{constructor(e,t,i){super(`Cannot add an icon of type '${e}' to the block ${t.toDevString()}, because there is no icon registered with type '${e}'. Make sure that all of your icons have been registered.`),this.block=t,this.state=i}},ks={};ks.BadConnectionCheck=im,ks.DeserializationError=Fn,ks.MissingBlockType=om,ks.MissingConnection=Ul,ks.RealChildOfShadow=sm,ks.UnregisteredIcon=nm;var rm=class{constructor(){this.priority=50}save(e){const t=[];for(const i of e.getTopBlocks(!1))(e=rt(i,{addCoordinates:!0,doFullSerialization:!1}))&&t.push(e);return t.length?{languageVersion:0,blocks:t}:null}load(e,t){e=e.blocks;for(const i of e)Ro(i,t,{recordUndo:ke()})}clear(e){for(const t of e.getTopBlocks(!1))t.dispose(!1)}};cn("blocks",new rm);var Hl={};Hl.BlockSerializer=rm,Hl.append=Ro,Hl.appendInternal=ss,Hl.save=rt;var Ce=class{constructor(e){this.name=e}toString(){return this.name}equals(e){return this.name===e.toString()}};Ce.MUTATOR=new Ce("mutator"),Ce.WARNING=new Ce("warning"),Ce.COMMENT=new Ce("comment");var Ri=class extends vs{constructor(e){super(),this.isBlank=!e,e&&(this.blockId=e.id,this.workspaceId=e.workspace.id)}toJson(){const e=super.toJson();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");return e.blockId=this.blockId,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new Ri)).blockId=e.blockId,t}},Oi=class extends Ri{constructor(e,t,i,s,n){super(e),this.type=b.BLOCK_CHANGE,e&&(this.element=t,this.name=i||void 0,this.oldValue=s,this.newValue=n)}toJson(){const e=super.toJson();if(!this.element)throw Error("The changed element is undefined. Either pass an element to the constructor, or call fromJson");return e.element=this.element,e.name=this.name,e.oldValue=this.oldValue,e.newValue=this.newValue,this.disabledReason&&(e.disabledReason=this.disabledReason),e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new Oi)).element=e.element,t.name=e.name,t.oldValue=e.oldValue,t.newValue=e.newValue,void 0!==e.disabledReason&&(t.disabledReason=e.disabledReason),t}setDisabledReason(e){if("disabled"!==this.element)throw Error('Cannot set the disabled reason for a BlockChange event if the element is not "disabled".');this.disabledReason=e}isNull(){return this.oldValue===this.newValue}run(e){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");if(!(t=t.getBlockById(this.blockId)))throw Error("The associated block is undefined. Either pass a block to the constructor, or call fromJson");const i=t.getIcon(Ce.MUTATOR);switch(i&&Oo(i)&&i.bubbleIsVisible()&&i.setBubbleVisible(!1),e=e?this.newValue:this.oldValue,this.element){case"field":(t=t.getField(this.name))?t.setValue(e):console.warn("Can't set non-existent field: "+this.name);break;case"comment":t.setCommentText(e||null);break;case"collapsed":t.setCollapsed(!!e);break;case"disabled":var s;t.setDisabledReason(!!e,null!=(s=this.disabledReason)?s:xt);break;case"inline":t.setInputsInline(!!e);break;case"mutation":s=Oi.getExtraBlockState_(t),t.loadExtraState?t.loadExtraState(JSON.parse(e||"{}")):t.domToMutation&&t.domToMutation(o.textToDom$$module$build$src$core$utils$xml(e||"<mutation/>")),B(new Oi(t,"mutation",null,s,e));break;default:console.warn("Unknown change type: "+this.element)}}static getExtraBlockState_(e){return e.saveExtraState?(e=e.saveExtraState(!0))?JSON.stringify(e):"":e.mutationToDom&&(e=e.mutationToDom())?ht(e):""}};U(k.EVENT,b.BLOCK_CHANGE,Oi);var Da={};Da.clamp=ns,Da.toDegrees=Dd,Da.toRadians=yr;var be,Gl,ws,Vl=16,sp=1,lm=12,np=16,Ba=.25,rp=null,Ss=null,cm="",am="",lp=null,Mi=null,um=null,Pa=null,Fa=null,Ua={getBoundsInfo:function(){const e=xo(lp),t=nn(lp);return{left:e.x,right:e.x+t.width,top:e.y,bottom:e.y+t.height,width:t.width,height:t.height}},getPositionMetrics:function(e,t,i,s){const n=Ua.getBoundsInfo(),r=nn(be);return t+r.height<n.bottom?Jc(e,t,n,r):s-r.height>n.top?Sr(i,s,n,r):t+r.height<document.documentElement.clientHeight?Jc(e,t,n,r):s-r.height>document.documentElement.clientTop?Sr(i,s,n,r):pn(e,n,r)}},Ge={ANIMATION_TIME:Ba,ARROW_HORIZONTAL_PADDING:lm,ARROW_SIZE:Vl,BORDER_SIZE:sp,PADDING_Y:np,TEST_ONLY:Ua};Ge.clearContent=kr,Ge.createDom=Cr,Ge.getContentDiv=Ir,Ge.getOwner=Wc,Ge.getPositionX=rs,Ge.hide=$n,Ge.hideIfOwner=gn,Ge.hideWithoutAnimation=yt,Ge.isVisible=wr,Ge.repositionForWindowResize=Ar,Ge.setBoundsElement=Zc,Ge.setColour=qc,Ge.show=Kc,Ge.showPositionedByBlock=Bd,Ge.showPositionedByField=zc;var Un={};Un.commonWordPrefix=Rr,Un.commonWordSuffix=Or,Un.isNumber=o.isNumber$$module$build$src$core$utils$string,Un.shortestStringLength=ls,Un.wrap=o.wrap$$module$build$src$core$utils$string;var Ha=void 0,Zl=!1,Hn=!1,dm=50,hm=0,xs=0,cp=0,ap=0,At=null,Wl=null,up=0,dp=10,pm=10,gm=750,Va=5,we=null,_t={HOVER_MS:gm,LIMIT:dm,MARGINS:Va,OFFSET_X:up,OFFSET_Y:dp,RADIUS_OK:pm};_t.bindMouseEvents=cs,_t.block=Pr,_t.createDom=Nr,_t.dispose=Br,_t.getCustomTooltip=oa,_t.getDiv=sa,_t.getTooltipOfObject=$i,_t.hide=Vt,_t.isVisible=ia,_t.setCustomTooltip=ta,_t.unbindMouseEvents=Lr,_t.unblock=Fr;var hp=.45,pp=.65,$m={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00"},Rt={};Rt.blend=Mo,Rt.getHsvSaturation=Ur,Rt.getHsvValue=Hr,Rt.hexToRgb=_n,Rt.hsvToHex=bn,Rt.hueToHex=Vr,Rt.names=$m,Rt.parse=mi,Rt.rgbToHex=as,Rt.setHsvSaturation=da,Rt.setHsvValue=ha;var ql={};ql.checkMessageReferences=p,ql.parseBlockColour=d,ql.replaceMessageReferences=l,ql.tokenizeInterpolation=x;var Q=class{get size_(){return this.size}set size_(e){this.size=e}constructor(e,t,i){this.DEFAULT_VALUE=null,this.name=void 0,this.tooltip=this.validator_=null,this.size=new j(0,0),this.constants_=this.mouseDownWrapper=this.textContent_=this.textElement_=this.borderRect_=this.fieldGroup_=null,this.disposed=!1,this.maxDisplayLength=50,this.sourceBlock_=null,this.enabled_=this.visible_=this.isDirty_=!0,this.suffixField=this.prefixField=this.clickTarget_=null,this.EDITABLE=!0,this.SERIALIZABLE=!1,this.id_=null,this.value_="DEFAULT_VALUE"in new.target.prototype?new.target.prototype.DEFAULT_VALUE:this.DEFAULT_VALUE,this.size_=new j(0,0),e!==Q.SKIP_SETUP&&(i&&this.configure_(i),this.setValue(e),t&&this.setValidator(t))}configure_(e){e.tooltip&&this.setTooltip(l(e.tooltip))}setSourceBlock(e){if(this.sourceBlock_)throw Error("Field already bound to a block");if(this.sourceBlock_=e,e.id.includes("_field"))throw Error(`Field ID indicator is contained in block ID. This may cause problems with focus: ${e.id}.`);this.id_=`${e.id}_field_${ze()}`}getConstants(){return!this.constants_&&this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&this.sourceBlock_.workspace.rendered&&(this.constants_=this.sourceBlock_.workspace.getRenderer().getConstants()),this.constants_}getSourceBlock(){return this.sourceBlock_}init(){if(!this.fieldGroup_){var e=this.id_;if(!e)throw Error("Expected ID to be defined prior to init.");this.fieldGroup_=I(f.G,{id:e}),this.isVisible()||(this.fieldGroup_.style.display="none"),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.initView(),this.updateEditable(),this.setTooltip(this.tooltip),this.bindEvents_(),this.initModel(),this.applyColour()}}initView(){this.createBorderRect_(),this.createTextElement_(),this.fieldGroup_&&A(this.fieldGroup_,"blocklyField")}initModel(){}isFullBlockField(){return!this.borderRect_}createBorderRect_(){this.borderRect_=I(f.RECT,{rx:this.getConstants().FIELD_BORDER_RECT_RADIUS,ry:this.getConstants().FIELD_BORDER_RECT_RADIUS,x:0,y:0,height:this.size_.height,width:this.size_.width,class:"blocklyFieldRect"},this.fieldGroup_)}createTextElement_(){this.textElement_=I(f.TEXT,{class:"blocklyText blocklyFieldText"},this.fieldGroup_),this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.textElement_.setAttribute("dominant-baseline","central"),this.textContent_=document.createTextNode(""),this.textElement_.appendChild(this.textContent_)}bindEvents_(){const e=this.getClickTarget_();if(!e)throw Error("A click target has not been set.");cs(e),this.mouseDownWrapper=L(e,"pointerdown",this,this.onMouseDown_)}fromXml(e){this.setValue(e.textContent)}toXml(e){return e.textContent=this.getValue(),e}saveState(e){return null!==(e=this.saveLegacyState(Q))?e:this.getValue()}loadState(e){this.loadLegacyState(Q,e)||this.setValue(e)}saveLegacyState(e){return e.prototype.saveState===this.saveState&&e.prototype.toXml!==this.toXml?((e=o.createElement$$module$build$src$core$utils$xml("field")).setAttribute("name",this.name||""),Qi(this.toXml(e)).replace(' xmlns="https://developers.google.com/blockly/xml"',"")):null}loadLegacyState(e,t){return e.prototype.loadState===this.loadState&&e.prototype.fromXml!==this.fromXml&&(this.fromXml(o.textToDom$$module$build$src$core$utils$xml(t)),!0)}dispose(){let e;gn(this),je(this),null!=(e=this.getSourceBlock())&&e.isDeadOrDying()||J(this.fieldGroup_),this.disposed=!0}updateEditable(){const e=this.fieldGroup_,t=this.getSourceBlock();this.EDITABLE&&e&&t&&(this.enabled_&&t.isEditable()?(A(e,"blocklyEditableField"),X(e,"blocklyNonEditableField")):(A(e,"blocklyNonEditableField"),X(e,"blocklyEditableField")))}setEnabled(e){this.enabled_=e,this.updateEditable()}isEnabled(){return this.enabled_}isClickable(){return this.enabled_&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()&&this.showEditor_!==Q.prototype.showEditor_}isClickableInFlyout(e){return!e}isCurrentlyEditable(){return this.enabled_&&this.EDITABLE&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()}isSerializable(){let e=!1;return this.name&&(this.SERIALIZABLE?e=!0:this.EDITABLE&&(console.warn("Detected an editable field that was not serializable. Please define SERIALIZABLE property as true on all editable custom fields. Proceeding with serialization."),e=!0)),e}isVisible(){return this.visible_}setVisible(e){if(this.visible_!==e){this.visible_=e;var t=this.fieldGroup_;t&&(t.style.display=e?"block":"none")}}setValidator(e){this.validator_=e}getValidator(){return this.validator_}getSvgRoot(){return this.fieldGroup_}getBorderRect(){if(!this.borderRect_)throw Error(`The border rectangle is ${this.borderRect_}.`);return this.borderRect_}getTextElement(){if(!this.textElement_)throw Error(`The text element is ${this.textElement_}.`);return this.textElement_}getTextContent(){if(!this.textContent_)throw Error(`The text content is ${this.textContent_}.`);return this.textContent_}applyColour(){}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_()}showEditor(e){this.isClickable()&&this.showEditor_(e)}showEditor_(e){}repositionForWindowResize(){return!1}updateSize_(e){const t=this.getConstants();let i=2*(e=void 0!==e?e:this.isFullBlockField()?0:this.getConstants().FIELD_BORDER_RECT_X_PADDING),s=t.FIELD_TEXT_HEIGHT,n=0;this.textElement_&&(n=w(this.textElement_),i+=n),this.isFullBlockField()||(s=Math.max(s,t.FIELD_BORDER_RECT_HEIGHT)),this.size_.height=s,this.size_.width=i,this.positionTextElement_(e,n),this.positionBorderRect_()}positionTextElement_(e,t){if(this.textElement_){var n,i=this.getConstants(),s=this.size_.height/2;this.textElement_.setAttribute("x",String(null!=(n=this.getSourceBlock())&&n.RTL?this.size_.width-t-e:e)),this.textElement_.setAttribute("y",String(i.FIELD_TEXT_BASELINE_CENTER?s:s-i.FIELD_TEXT_HEIGHT/2+i.FIELD_TEXT_BASELINE))}}positionBorderRect_(){this.borderRect_&&(this.borderRect_.setAttribute("width",String(this.size_.width)),this.borderRect_.setAttribute("height",String(this.size_.height)),this.borderRect_.setAttribute("rx",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)),this.borderRect_.setAttribute("ry",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)))}getSize(){return this.isVisible()?(this.isDirty_&&(this.render_(),this.isDirty_=!1),this.size_):new j(0,0)}getScaledBBox(){let e;var t=this.getSourceBlock();if(!t)throw new fe;if(this.isFullBlockField()){var i=this.sourceBlock_.getHeightWidth();const s=t.workspace.scale;e=this.getAbsoluteXY_(),t=(i.width+1)*s,i=(i.height+1)*s,g$?(e.x+=1.5*s,e.y+=1.5*s):(e.x-=.5*s,e.y-=.5*s)}else i=this.borderRect_.getBoundingClientRect(),e=xo(this.borderRect_),t=i.width,i=i.height;return new z(e.y,e.y+i,e.x,e.x+t)}onLocationChange(e){}getDisplayText_(){let e=this.getText();return e.length>this.maxDisplayLength&&(e=e.substring(0,this.maxDisplayLength-2)+"\u2026"),e=e.replace(/\s/g,Q.NBSP),this.sourceBlock_&&this.sourceBlock_.RTL&&(e+="\u200f"),e}getText(){const e=this.getText_();return String(null!==e?e:this.getValue())}getText_(){return null}markDirty(){this.isDirty_=!0,this.constants_=null}forceRerender(){this.isDirty_=!0,this.sourceBlock_&&this.sourceBlock_.rendered&&this.sourceBlock_.queueRender()}setValue(e,t=!0){if(null!==e){var i=o.getGroup$$module$build$src$core$events$utils();i||o.setGroup$$module$build$src$core$events$utils(!0);try{const C=this.doClassValidation_(e),F=this.processValidation(e,C,t);if(!(F instanceof Error)){var s,n=null==(s=this.getValidator())?void 0:s.call(this,F),r=this.processValidation(F,n,t);if(!(r instanceof Error)){var a=this.sourceBlock_;if(!a||!a.disposed){var $=this.getValue();$===r?this.doValueUpdate_(r):(this.doValueUpdate_(r),t&&a&&se()&&B(new(P(b.BLOCK_CHANGE))(a,"field",this.name||null,$,r)),this.isDirty_&&this.forceRerender())}}}}finally{o.setGroup$$module$build$src$core$events$utils(i)}}}processValidation(e,t,i){return null===t?(this.doValueInvalid_(e,i),this.isDirty_&&this.forceRerender(),Error()):void 0===t?e:t}getValue(){return this.value_}doClassValidation_(e){return e??null}doValueUpdate_(e){this.value_=e,this.isDirty_=!0}doValueInvalid_(e,t){}onMouseDown_(e){this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&(e=this.sourceBlock_.workspace.getGesture(e))&&e.setStartField(this)}setTooltip(e){e||""===e||(e=this.sourceBlock_);const t=this.getClickTarget_();t?t.tooltip=e:this.tooltip=e}getTooltip(){const e=this.getClickTarget_();return $i(e||{tooltip:this.tooltip})}getClickTarget_(){return this.clickTarget_||this.getSvgRoot()}getAbsoluteXY_(){return xo(this.getClickTarget_())}referencesVariables(){return!1}refreshVariableName(){}getParentInput(){let e=null;const t=this.getSourceBlock();if(!t)throw new fe;const i=t.inputList;for(let s=0;s<t.inputList.length;s++){const n=i[s],r=n.fieldRow;for(let a=0;a<r.length;a++)if(r[a]===this){e=n;break}}return e}getFlipRtl(){return!1}onShortcut(e){return!1}getFocusableElement(){if(!this.fieldGroup_)throw Error("This field currently has no representative DOM element.");return this.fieldGroup_}getFocusableTree(){const e=this.getSourceBlock();if(!e)throw new fe;return e.workspace}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}static fromJson(e){throw Error("Attempted to instantiate a field from the registry that hasn't defined a 'fromJson' method.")}};Q.NBSP="\xa0",Q.SKIP_SETUP=Symbol("SKIP_SETUP");var fe=class extends Error{constructor(){super("The field has not yet been attached to its input. Call appendField to attach it.")}},mm={};mm.Field=Q,mm.UnattachedFieldError=fe;var bt,Vn=null,_m=null,Ga=null,gp="blocklyWidgetDiv",Gn="",Zn="",Za=null,zt={};zt.createDom=q,zt.getDiv=v,zt.hide=Ct,zt.hideIfOwner=je,zt.hideIfOwnerIsInWorkspace=Gt,zt.isVisible=_i,zt.positionWithAnchor=Lo,zt.repositionForWindowResize=co,zt.show=ce,zt.testOnly_setDiv=O;var Wa=null,bm={},qa=null,As={};As.callbackFactory=o.callbackFactory$$module$build$src$core$contextmenu,As.dispose=Wr,As.getCurrentBlock=bi,As.hide=Ei,As.setCurrentBlock=fi,As.show=It;var W=class{constructor(){this.registeredItems=new Map,this.reset()}reset(){this.registeredItems.clear()}register(e){if(this.registeredItems.has(e.id))throw Error('Menu item with ID "'+e.id+'" is already registered.');this.registeredItems.set(e.id,e)}unregister(e){if(!this.registeredItems.has(e))throw Error('Menu item with ID "'+e+'" not found.');this.registeredItems.delete(e)}getItem(e){let t;return null!=(t=this.registeredItems.get(e))?t:null}getContextMenuOptions(e,t){const i=[];for(const s of this.registeredItems.values()){if(s.scopeType&&(s.scopeType===za.BLOCK&&!e.block||s.scopeType===za.COMMENT&&!e.comment||s.scopeType===za.WORKSPACE&&!e.workspace))continue;let n;if(n={scope:e,weight:s.weight},s.separator)n=Object.assign({},n,{separator:!0});else{const r=s.preconditionFn(e,t);if("hidden"===r)continue;const a="function"==typeof s.displayText?s.displayText(e):s.displayText;n=Object.assign({},n,{text:a,callback:s.callback,enabled:"enabled"===r})}i.push(n)}return i.sort(function(s,n){return s.weight-n.weight}),i}};!function(e){var t=e.ScopeType||(e.ScopeType={});t.BLOCK="block",t.WORKSPACE="workspace",t.COMMENT="comment",e.registry=new e}(W||(W={}));var za=W.ScopeType,fm={};fm.ContextMenuRegistry=W,fm.ScopeType=za;var nb={BLOCK:50,BUBBLE:100},$p=class{constructor(e){this.comment=e,this.startLoc=null,this.workspace=e.workspace}isMovable(){return this.comment.isOwnMovable()&&!this.comment.isDeadOrDying()&&!this.workspace.isReadOnly()}startDrag(){let e;this.fireDragStartEvent(),this.startLoc=this.comment.getRelativeToSurfaceXY(),this.workspace.setResizesEnabled(!1),null==(e=this.workspace.getLayerManager())||e.moveToDragLayer(this.comment),this.comment.setDragging(!0)}drag(e){this.comment.moveDuringDrag(e)}endDrag(){let e;this.fireDragEndEvent(),this.fireMoveEvent(),null==(e=this.workspace.getLayerManager())||e.moveOffDragLayer(this.comment,50),this.comment.setDragging(!1),this.comment.snapToGrid(),this.workspace.setResizesEnabled(!0)}fireDragStartEvent(){const e=new(P(b.COMMENT_DRAG))(this.comment,!0);B(e)}fireDragEndEvent(){const e=new(P(b.COMMENT_DRAG))(this.comment,!1);B(e)}fireMoveEvent(){if(!this.comment.isDeadOrDying()){var e=new(P(b.COMMENT_MOVE))(this.comment);e.setReason(["drag"]),e.oldCoordinate_=this.startLoc,e.recordNew(),B(e)}}revertDrag(){this.startLoc&&this.comment.moveDuringDrag(this.startLoc)}},Tm=new WeakMap,Em={};Em.move=yi,Em.start=vi;var zl=class{constructor(e,t,i){this.id=e,this.workspace=t,this.container=i}isVisible(){return this.icon.checkVisibility()}getParentComment(){const e=this.workspace.getCommentById(this.id);if(!e)throw Error(`Comment bar button ${this.id} has no corresponding comment`);return e}getSize(e=!1){var t=this.icon.getBBox();return t=z.from(t),e&&(e=this.getMargin(),t.left-=e,t.top-=e,t.bottom+=e,t.right+=e),t}getMargin(){return(this.container.getBBox().height-this.icon.getBBox().height)/2}getFocusableElement(){return this.icon}getFocusableTree(){return this.workspace}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return this.isVisible()}},mp="_collapse_bar_button",_p=class extends zl{constructor(e,t,i){super(e,t,i),this.id=e,this.workspace=t,this.container=i,this.icon=I(f.IMAGE,{class:"blocklyFoldoutIcon",href:`${this.workspace.options.pathToMedia}foldout-icon.svg`,id:`${this.id}${mp}`},this.container),this.bindId=L(this.icon,"pointerdown",this,this.performAction.bind(this))}dispose(){K(this.bindId)}reposition(){const e=this.getMargin();this.icon.setAttribute("y",`${e}`),this.icon.setAttribute("x",`${e}`)}performAction(e){Ae();const t=this.getParentComment();t.view.bringToFront(),e&&e instanceof PointerEvent&&ot(e)||(t.setCollapsed(!t.isCollapsed()),this.workspace.hideChaff()),e.stopPropagation()}};({COMMENT_COLLAPSE_BAR_BUTTON_FOCUS_IDENTIFIER:mp}).CollapseCommentBarButton=_p;var Xa="_comment_textarea_",bp=class{constructor(e,t,i){this.workspace=e,this.onFinishEditing=i,this.textChangeListeners=[],this.text="",this.foreignObject=I(f.FOREIGNOBJECT,{class:"blocklyCommentForeignObject"}),(e=document.createElementNS(po,"body")).setAttribute("xmlns",po),e.className="blocklyMinimalBody",this.textArea=document.createElementNS(po,"textarea"),this.textArea.setAttribute("tabindex","-1"),A(this.textArea,"blocklyCommentText"),A(this.textArea,"blocklyTextarea"),A(this.textArea,"blocklyText"),e.appendChild(this.textArea),this.foreignObject.appendChild(e),t&&(this.id=t+Xa,this.textArea.setAttribute("id",this.id)),L(this.textArea,"change",this,this.onTextChange),L(this.textArea,"pointerdown",this,s=>{s.stopPropagation(),o.getFocusManager$$module$build$src$core$focus_manager().focusNode(this),Ae()}),L(this.textArea,"keydown",this,this.handleKeyDown)}getDom(){return this.foreignObject}getText(){return this.text}setText(e){this.textArea.value=e,this.onTextChange()}onTextChange(){const e=this.text;this.text=this.textArea.value;for(let t=this.textChangeListeners.length-1;t>=0;t--)this.textChangeListeners[t](e,this.text)}handleKeyDown(e){("Escape"===e.key||"Enter"===e.key&&(e.ctrlKey||e.metaKey))&&(this.onFinishEditing&&this.onFinishEditing(),e.stopPropagation())}addTextChangeListener(e){this.textChangeListeners.push(e)}removeTextChangeListener(e){this.textChangeListeners.splice(this.textChangeListeners.indexOf(e),1)}setPlaceholderText(e){this.textArea.placeholder=e}setEditable(e){e?this.textArea.removeAttribute("readonly"):this.textArea.setAttribute("readonly","true")}updateSize(e,t){this.foreignObject.setAttribute("height",""+(e.height-t.height)),this.foreignObject.setAttribute("width",`${e.width}`),this.foreignObject.setAttribute("y",`${t.height}`),this.workspace.RTL&&this.foreignObject.setAttribute("x",""+-e.width)}getFocusableElement(){return this.textArea}getFocusableTree(){return this.workspace}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!!this.id}};({COMMENT_EDITOR_FOCUS_IDENTIFIER:Xa}).CommentEditor=bp;var fp="_delete_bar_button",Tp=class extends zl{constructor(e,t,i){super(e,t,i),this.id=e,this.workspace=t,this.container=i,this.icon=I(f.IMAGE,{class:"blocklyDeleteIcon",href:`${this.workspace.options.pathToMedia}delete-icon.svg`,id:`${this.id}${fp}`},i),this.bindId=L(this.icon,"pointerdown",this,this.performAction.bind(this))}dispose(){K(this.bindId)}reposition(){const e=this.getMargin();this.icon.setAttribute("x","0");const t=this.container.getBBox();this.icon.setAttribute("y",`${e}`),this.icon.setAttribute("x",""+(t.width-this.getSize(!0).getWidth()))}performAction(e){Ae(),e&&e instanceof PointerEvent&&ot(e)?e.stopPropagation():(this.getParentComment().dispose(),e?.stopPropagation(),o.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.workspace))}};({COMMENT_DELETE_BAR_BUTTON_FOCUS_IDENTIFIER:fp}).DeleteCommentBarButton=Tp;var Wn=class{constructor(e,t){let i;this.workspace=e,this.commentId=t,this.collapsed=!1,this.editable=!0,this.location=new S(0,0),this.sizeChangeListeners=[],this.disposeListeners=[],this.collapseChangeListeners=[],this.resizePointerMoveListener=this.resizePointerUpListener=null,this.disposed=this.disposing=!1,this.svgRoot=I(f.G,{class:"blocklyComment blocklyEditable blocklyDraggable"}),this.highlightRect=this.createHighlightRect(this.svgRoot),({topBarGroup:this.topBarGroup,topBarBackground:this.topBarBackground,deleteButton:this.deleteButton,foldoutButton:this.foldoutButton,textPreview:this.textPreview,textPreviewNode:this.textPreviewNode}=this.createTopBar(this.svgRoot)),this.commentEditor=this.createTextArea(),this.resizeHandle=this.createResizeHandle(this.svgRoot,e),null==(i=e.getLayerManager())||i.append(this,50),this.size=Wn.defaultCommentSize,this.setSizeWithoutFiringEvents(this.size),this.moveTo(new S(0,0))}createHighlightRect(e){return I(f.RECT,{class:"blocklyCommentHighlight"},e)}createTopBar(e){e=I(f.G,{class:"blocklyCommentTopbar"},e);const t=I(f.RECT,{class:"blocklyCommentTopbarBackground"},e),i=new Tp(this.commentId,this.workspace,e),s=new _p(this.commentId,this.workspace,e),n=I(f.TEXT,{class:"blocklyCommentPreview blocklyCommentText blocklyText"},e),r=document.createTextNode("");return n.appendChild(r),{topBarGroup:e,topBarBackground:t,deleteButton:i,foldoutButton:s,textPreview:n,textPreviewNode:r}}createTextArea(){const e=new bp(this.workspace,this.commentId,()=>this.svgRoot.focus());return this.svgRoot.appendChild(e.getDom()),e.addTextChangeListener((t,i)=>{this.updateTextPreview(i),this.setSize(this.size)}),e}getEditorFocusableNode(){return this.commentEditor}createResizeHandle(e,t){return e=I(f.IMAGE,{class:"blocklyResizeHandle",href:`${t.options.pathToMedia}resize-handle.svg`},e),L(e,"pointerdown",this,this.onResizePointerDown),e}getSvgRoot(){return this.svgRoot}getSize(){return this.collapsed?this.topBarBackground.getBBox():this.size}setSizeWithoutFiringEvents(e){const t=this.topBarBackground.getBBox(),i=this.textPreview.getBBox(),s=this.resizeHandle.getBBox();this.size=e=j.max(e,this.calcMinSize(t)),this.svgRoot.setAttribute("height",`${e.height}`),this.svgRoot.setAttribute("width",`${e.width}`),this.updateHighlightRect(e),this.updateTopBarSize(e),this.commentEditor.updateSize(e,t),this.deleteButton.reposition(),this.foldoutButton.reposition(),this.updateTextPreviewSize(e,t,i),this.updateResizeHandlePosition(e,s)}setSize(e){const t=this.preResizeSize||this.size;this.setSizeWithoutFiringEvents(e),this.onSizeChange(t,this.size)}calcMinSize(e){var t;this.updateTextPreview(null!=(t=this.commentEditor.getText())?t:"");let i=t=w(this.textPreview);return this.foldoutButton.isVisible()?i+=this.foldoutButton.getSize(!0).getWidth():t&&(i+=4),this.deleteButton.isVisible()?i+=this.deleteButton.getSize(!0).getWidth():t&&(i+=4),new j(i,e.height+20)}updateHighlightRect(e){this.highlightRect.setAttribute("height",`${e.height}`),this.highlightRect.setAttribute("width",`${e.width}`),this.workspace.RTL&&this.highlightRect.setAttribute("x",""+-e.width)}updateTopBarSize(e){this.topBarBackground.setAttribute("width",`${e.width}`)}updateTextPreviewSize(e,t,i){t=(t.height-i.height)/2;const s=this.foldoutButton.getSize(!0),n=this.deleteButton.getSize(!0);e=e.width-s.getWidth()-n.getWidth(),this.textPreview.setAttribute("x",`${s.getWidth()}`),this.textPreview.setAttribute("y",`${t+i.height/2}`),this.textPreview.setAttribute("width",`${e}`)}updateResizeHandlePosition(e,t){this.resizeHandle.setAttribute("y",""+(e.height-t.height)),this.resizeHandle.setAttribute("x",""+(e.width-t.width))}onSizeChange(e,t){for(let i=this.sizeChangeListeners.length-1;i>=0;i--)this.sizeChangeListeners[i](e,t)}addSizeChangeListener(e){this.sizeChangeListeners.push(e)}removeSizeChangeListener(e){this.sizeChangeListeners.splice(this.sizeChangeListeners.indexOf(e),1)}onResizePointerDown(e){this.isEditable()&&(this.bringToFront(),ot(e)||(this.preResizeSize=this.getSize(),vi(this.workspace,e,new S(this.workspace.RTL?-this.getSize().width:this.getSize().width,this.getSize().height)),this.resizePointerUpListener=L(document,"pointerup",this,this.onResizePointerUp),this.resizePointerMoveListener=L(document,"pointermove",this,this.onResizePointerMove),this.workspace.hideChaff()),e.stopPropagation())}onResizePointerUp(e){Ae(),this.resizePointerUpListener&&(K(this.resizePointerUpListener),this.resizePointerUpListener=null),this.resizePointerMoveListener&&(K(this.resizePointerMoveListener),this.resizePointerMoveListener=null),this.setSize(this.size),this.preResizeSize=void 0}onResizePointerMove(e){e=yi(this.workspace,e),this.setSizeWithoutFiringEvents(new j(this.workspace.RTL?-e.x:e.x,e.y))}isCollapsed(){return this.collapsed}setCollapsed(e){(this.collapsed=e)?A(this.svgRoot,"blocklyCollapsed"):X(this.svgRoot,"blocklyCollapsed"),this.setSizeWithoutFiringEvents(this.size),this.onCollapse()}onCollapse(){for(let e=this.collapseChangeListeners.length-1;e>=0;e--)this.collapseChangeListeners[e](this.collapsed)}addOnCollapseListener(e){this.collapseChangeListeners.push(e)}removeOnCollapseListener(e){this.collapseChangeListeners.splice(this.collapseChangeListeners.indexOf(e),1)}isEditable(){return this.editable}setEditable(e){(this.editable=e)?(A(this.svgRoot,"blocklyEditable"),X(this.svgRoot,"blocklyReadonly")):(X(this.svgRoot,"blocklyEditable"),A(this.svgRoot,"blocklyReadonly")),this.commentEditor.setEditable(e)}getRelativeToSurfaceXY(){return this.location}moveTo(e){this.location=e,this.svgRoot.setAttribute("transform",`translate(${e.x}, ${e.y})`)}getText(){return this.commentEditor.getText()}setText(e){this.commentEditor.setText(e)}setPlaceholderText(e){this.commentEditor.setPlaceholderText(e)}addTextChangeListener(e){this.commentEditor.addTextChangeListener(e)}removeTextChangeListener(e){this.commentEditor.removeTextChangeListener(e)}updateTextPreview(e){this.textPreviewNode.textContent=this.truncateText(e)}truncateText(e){return e.length>=12?`${e.substring(0,9)}...`:e}bringToFront(){const e=this.svgRoot.parentNode,t=e.childNodes;t[t.length-1]!==this.svgRoot&&e.appendChild(this.svgRoot)}onDeleteDown(e){Ae(),ot(e)||this.dispose(),e.stopPropagation()}dispose(){this.disposing=!0,this.foldoutButton.dispose(),this.deleteButton.dispose(),J(this.svgRoot);for(let e=this.disposeListeners.length-1;e>=0;e--)this.disposeListeners[e]();this.disposed=!0}isDisposed(){return this.disposed}isDeadOrDying(){return this.disposing||this.disposed}addDisposeListener(e){this.disposeListeners.push(e)}removeDisposeListener(e){this.disposeListeners.splice(this.disposeListeners.indexOf(e),1)}getCommentBarButtons(){return[this.foldoutButton,this.deleteButton]}};Wn.defaultCommentSize=new j(120,100),Pt("\n.injectionDiv {\n  --commentFillColour: #FFFCC7;\n  --commentBorderColour: #F2E49B;\n}\n\n.blocklyComment .blocklyTextarea {\n  background-color: var(--commentFillColour);\n  border: 1px solid var(--commentBorderColour);\n  box-sizing: border-box;\n  display: block;\n  outline: 0;\n  padding: 5px;\n  resize: none;\n  width: 100%;\n  height: 100%;\n}\n\n.blocklyReadonly.blocklyComment .blocklyTextarea {\n  cursor: inherit;\n}\n\n.blocklyDeleteIcon {\n  width: 20px;\n  height: 20px;\n  display: none;\n  cursor: pointer;\n}\n\n.blocklyFoldoutIcon {\n  width: 20px;\n  height: 20px;\n  transform-origin: 12px 12px;\n  cursor: pointer;\n}\n.blocklyResizeHandle {\n  width: 12px;\n  height: 12px;\n  cursor: se-resize;\n}\n.blocklyReadonly.blocklyComment .blocklyResizeHandle {\n  cursor: inherit;\n}\n\n.blocklyCommentTopbarBackground {\n  fill: var(--commentBorderColour);\n  height: 24px;\n}\n\n.blocklyComment .blocklyCommentPreview.blocklyText {\n  fill: #000;\n  dominant-baseline: middle;\n  visibility: hidden;\n}\n\n.blocklyCollapsed.blocklyComment .blocklyCommentPreview {\n  visibility: visible;\n}\n\n.blocklyCollapsed.blocklyComment .blocklyCommentForeignObject,\n.blocklyCollapsed.blocklyComment .blocklyResizeHandle {\n  display: none;\n}\n\n.blocklyCollapsed.blocklyComment .blocklyFoldoutIcon {\n  transform: rotate(-90deg);\n}\n\n.blocklyRTL .blocklyCommentTopbar {\n  transform: scale(-1, 1);\n}\n\n.blocklyRTL .blocklyCommentForeignObject {\n  direction: rtl;\n}\n\n.blocklyRTL .blocklyCommentPreview {\n  /* Revert the scale and control RTL using direction instead. */\n  transform: scale(-1, 1);\n  direction: rtl;\n}\n\n.blocklyRTL .blocklyResizeHandle {\n  transform: scale(-1, 1);\n  cursor: sw-resize;\n}\n\n.blocklyCommentHighlight {\n  fill: none;\n}\n\n.blocklyCommentText.blocklyActiveFocus {\n  border-color: #fc3;\n  border-width: 2px;\n}\n\n.blocklySelected .blocklyCommentHighlight {\n  stroke: #fc3;\n  stroke-width: 3px;\n}\n\n.blocklyCollapsed.blocklySelected .blocklyCommentHighlight {\n  stroke: none;\n}\n\n.blocklyCollapsed.blocklySelected .blocklyCommentTopbarBackground {\n  stroke: #fc3;\n  stroke-width: 3px;\n}\n");var jl=class{constructor(e,t){this.workspace=e,this.text="",this.collapsed=!1,this.deletable=this.movable=this.editable=!0,this.location=new S(0,0),this.disposing=this.disposed=!1,this.id=t&&!e.getCommentById(t)?t:Te(),this.size=Wn.defaultCommentSize,e.addTopComment(this),this.fireCreateEvent()}fireCreateEvent(){se()&&B(new(P(b.COMMENT_CREATE))(this))}fireDeleteEvent(){se()&&B(new(P(b.COMMENT_DELETE))(this))}fireChangeEvent(e,t){se()&&B(new(P(b.COMMENT_CHANGE))(this,e,t))}fireCollapseEvent(e){se()&&B(new(P(b.COMMENT_COLLAPSE))(this,e))}setText(e){const t=this.text;this.text=e,this.fireChangeEvent(t,e)}getText(){return this.text}setSize(e){const t=new(P(b.COMMENT_RESIZE))(this);this.size=e,t.recordCurrentSizeAsNewSize(),B(t)}getSize(){return this.size}setCollapsed(e){this.collapsed=e,this.fireCollapseEvent(e)}isCollapsed(){return this.collapsed}setEditable(e){this.editable=e}isEditable(){return this.isOwnEditable()&&!this.workspace.isReadOnly()}isOwnEditable(){return this.editable}setMovable(e){this.movable=e}isMovable(){return this.isOwnMovable()&&!this.workspace.isReadOnly()&&!this.workspace.isFlyout}isOwnMovable(){return this.movable}setDeletable(e){this.deletable=e}isDeletable(){return this.isOwnDeletable()&&!this.isDeadOrDying()&&!this.workspace.isReadOnly()&&!this.workspace.isFlyout}isOwnDeletable(){return this.deletable}moveTo(e,t){const i=new(P(b.COMMENT_MOVE))(this);t&&i.setReason(t),this.location=e,i.recordNew(),B(i)}getRelativeToSurfaceXY(){return this.location}dispose(){this.disposing=!0,this.fireDeleteEvent(),this.workspace.removeTopComment(this),this.disposed=!0}isDisposed(){return this.disposed}isDeadOrDying(){return this.disposing||this.disposed}},jt=class extends jl{constructor(e,t){super(e,t),this.dragStrategy=new $p(this),this.workspace=e,this.view=new Wn(e,this.id),this.view.setSize(this.getSize()),this.view.setEditable(this.isEditable()),this.view.getSvgRoot().setAttribute("data-id",this.id),this.view.getSvgRoot().setAttribute("id",this.id),this.addModelUpdateBindings(),L(this.view.getSvgRoot(),"pointerdown",this,this.startGesture),L(this.view.getSvgRoot(),"wheel",this,i=>{i.stopPropagation()})}addModelUpdateBindings(){this.view.addTextChangeListener((e,t)=>{super.setText(t)}),this.view.addSizeChangeListener((e,t)=>{super.setSize(t)}),this.view.addOnCollapseListener(()=>{super.setCollapsed(this.view.isCollapsed())}),this.view.addDisposeListener(()=>{this.isDeadOrDying()||this.dispose()})}setText(e){this.view.setText(e)}setPlaceholderText(e){this.view.setPlaceholderText(e)}setSize(e){this.view.setSize(e)}setCollapsed(e){this.view.setCollapsed(e)}setEditable(e){super.setEditable(e),this.view.setEditable(this.isEditable())}getSvgRoot(){return this.view.getSvgRoot()}getSize(){return super.getSize()}getBoundingRectangle(){const e=this.getRelativeToSurfaceXY();var t,i;const s=null!=(i=null==(t=this.view)?void 0:t.getSize())?i:this.getSize();return this.workspace.RTL?(t=e.x-s.width,i=e.x):(t=e.x,i=e.x+s.width),new z(e.y,e.y+s.height,t,i)}moveBy(e,t,i){const s=this.getRelativeToSurfaceXY();e=new S(s.x+e,s.y+t),this.moveTo(e,i)}moveTo(e,t){super.moveTo(e,t),this.view.moveTo(e)}moveDuringDrag(e){this.location=e,this.view.moveTo(e)}setDragging(e){e?A(this.getSvgRoot(),"blocklyDragging"):X(this.getSvgRoot(),"blocklyDragging")}dispose(){this.disposing=!0;const e=o.getFocusManager$$module$build$src$core$focus_manager();e.getFocusedNode()===this&&setTimeout(()=>e.focusTree(this.workspace),0),this.view.isDeadOrDying()||this.view.dispose(),super.dispose()}startGesture(e){const t=this.workspace.getGesture(e);t&&(t.handleCommentStart(e,this),o.getFocusManager$$module$build$src$core$focus_manager().focusNode(this))}setDeleteStyle(e){e?A(this.getSvgRoot(),"blocklyDraggingDelete"):X(this.getSvgRoot(),"blocklyDraggingDelete")}isCopyable(){return this.isOwnMovable()&&this.isOwnDeletable()}isMovable(){return this.dragStrategy.isMovable()}startDrag(){this.dragStrategy.startDrag()}drag(e){this.dragStrategy.drag(e)}endDrag(){this.dragStrategy.endDrag()}revertDrag(){this.dragStrategy.revertDrag()}select(){A(this.getSvgRoot(),"blocklySelected"),So(this)}unselect(){X(this.getSvgRoot(),"blocklySelected"),So(null)}toCopyData(){return{paster:Ll.TYPE,commentState:ui(this,{addCoordinates:!0})}}showContextMenu(e){const t=W.registry.getContextMenuOptions({comment:this,focusedNode:this},e);let i;i=e instanceof PointerEvent?new S(e.clientX,e.clientY):Ji(this.workspace,this.getRelativeToSurfaceXY()).translate(10,10),It(e,t,this.workspace.RTL,this.workspace,i)}snapToGrid(){if(!this.isDeadOrDying()){var e=this.workspace.getGrid();if(null!=e&&e.shouldSnap()){var t=this.getRelativeToSurfaceXY();(e=e.alignXY(t))!==t&&this.moveTo(e,["snap"])}}}getEditorFocusableNode(){return this.view.getEditorFocusableNode()}getFocusableElement(){return this.getSvgRoot()}getFocusableTree(){return this.workspace}onNodeFocus(){let e;this.select(),null==(e=this.workspace.getLayerManager())||e.append(this,50)}onNodeBlur(){this.unselect()}canBeFocused(){return!0}},Ke={};Ke.appendDomToWorkspace=pa,Ke.blockToDom=ao,Ke.blockToDomWithXY=Do,Ke.clearWorkspaceAndLoadFromXml=Yr,Ke.deleteNext=il,Ke.domToBlock=o.domToBlock$$module$build$src$core$xml,Ke.domToBlockInternal=uo,Ke.domToPrettyText=Xr,Ke.domToText=ht,Ke.domToVariables=yn,Ke.domToWorkspace=o.domToWorkspace$$module$build$src$core$xml,Ke.loadWorkspaceComment=St,Ke.saveWorkspaceComment=kt,Ke.variablesToDom=En,Ke.workspaceToDom=qr;var Ya=class extends Ri{constructor(e){super(e),this.type=b.BLOCK_CREATE,e&&(e.isShadow()&&(this.recordUndo=!1),this.xml=Do(e),this.ids=Io(e),this.json=rt(e,{addCoordinates:!0}))}toJson(){const e=super.toJson();if(!this.xml)throw Error("The block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.xml=ht(this.xml),e.ids=this.ids,e.json=this.json,this.recordUndo||(e.recordUndo=this.recordUndo),e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new Ya)).xml=o.textToDom$$module$build$src$core$utils$xml(e.xml),t.ids=e.ids,t.json=e.json,void 0!==e.recordUndo&&(t.recordUndo=e.recordUndo),t}run(e){const t=this.getEventWorkspace_();if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!gb(t,this.ids))if(e)Ro(this.json,t);else for(e=0;e<this.ids.length;e++){const i=this.ids[e],s=t.getBlockById(i);s?s.dispose(!1):i===this.blockId&&console.warn("Can't uncreate non-existent block: "+i)}}},gb=function(e,t){return t.map(i=>e.getBlockById(i)).filter(i=>i&&i.isShadow()).length===t.length};U(k.EVENT,b.BLOCK_CREATE,Ya);var Ka=class extends qt{constructor(e,t){super(t),this.type=b.THEME_CHANGE,this.themeName=e}toJson(){const e=super.toJson();if(!this.themeName)throw Error("The theme name is undefined. Either pass a theme name to the constructor, or call fromJson");return e.themeName=this.themeName,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new Ka)).themeName=e.themeName,t}};U(k.EVENT,b.THEME_CHANGE,Ka);var Ja=class extends qt{constructor(e,t,i,s,n){super(s),this.type=b.VIEWPORT_CHANGE,this.viewTop=e,this.viewLeft=t,this.scale=i,this.oldScale=n}toJson(){const e=super.toJson();if(void 0===this.viewTop)throw Error("The view top is undefined. Either pass a value to the constructor, or call fromJson");if(void 0===this.viewLeft)throw Error("The view left is undefined. Either pass a value to the constructor, or call fromJson");if(void 0===this.scale)throw Error("The scale is undefined. Either pass a value to the constructor, or call fromJson");if(void 0===this.oldScale)throw Error("The old scale is undefined. Either pass a value to the constructor, or call fromJson");return e.viewTop=this.viewTop,e.viewLeft=this.viewLeft,e.scale=this.scale,e.oldScale=this.oldScale,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new Ja)).viewTop=e.viewTop,t.viewLeft=e.viewLeft,t.scale=e.scale,t.oldScale=e.oldScale,t}};U(k.EVENT,b.VIEWPORT_CHANGE,Ja);var N=function(e){return e[e.INPUT_VALUE=1]="INPUT_VALUE",e[e.OUTPUT_VALUE=2]="OUTPUT_VALUE",e[e.NEXT_STATEMENT=3]="NEXT_STATEMENT",e[e.PREVIOUS_STATEMENT=4]="PREVIOUS_STATEMENT",e}(N||{}),Rs=class{constructor(e){this.connectionChecker=e,this.connections=[]}addConnection(e,t){t=this.calculateIndexForYPos(t),this.connections.splice(t,0,e)}findIndexOfConnection(e,t){if(!this.connections.length)return-1;const i=this.calculateIndexForYPos(t);if(i>=this.connections.length)return-1;t=e.y;let s=i;for(;s>=0&&this.connections[s].y===t;){if(this.connections[s]===e)return s;s--}for(s=i;s<this.connections.length&&this.connections[s].y===t;){if(this.connections[s]===e)return s;s++}return-1}calculateIndexForYPos(e){if(!this.connections.length)return 0;let t=0,i=this.connections.length;for(;t<i;){const s=Math.floor((t+i)/2);if(this.connections[s].y<e)t=s+1;else{if(!(this.connections[s].y>e)){t=s;break}i=s}}return t}removeConnection(e,t){if(-1===(e=this.findIndexOfConnection(e,t)))throw Error("Unable to find connection in connectionDB.");this.connections.splice(e,1)}getNeighbours(e,t){function i(F){const me=n-s[F].x,re=r-s[F].y;return Math.sqrt(me*me+re*re)<=t&&C.push(s[F]),re<t}const s=this.connections,n=e.x,r=e.y;e=0;let a=s.length-2,$=a;for(;e<$;)s[$].y<r?e=$:a=$,$=Math.floor((e+a)/2);const C=[];if(a=e=$,s.length){for(;e>=0&&i(e);)e--;do{a++}while(a<s.length&&i(a))}return C}isInYRange(e,t,i){return Math.abs(this.connections[e].y-t)<=i}searchForClosest(e,t,i){if(!this.connections.length)return{connection:null,radius:t};const s=e.y,n=e.x;e.x=n+i.x,e.y=s+i.y;var r=this.calculateIndexForYPos(e.y);i=null;let $,a=t,C=r-1;for(;C>=0&&this.isInYRange(C,e.y,t);)$=this.connections[C],this.connectionChecker.canConnect(e,$,!0,a)&&(i=$,a=$.distanceFrom(e)),C--;for(;r<this.connections.length&&this.isInYRange(r,e.y,t);)$=this.connections[r],this.connectionChecker.canConnect(e,$,!0,a)&&(i=$,a=$.distanceFrom(e)),r++;return e.x=n,e.y=s,{connection:i,radius:a}}static init(e){const t=[];return t[N.INPUT_VALUE]=new Rs(e),t[N.OUTPUT_VALUE]=new Rs(e),t[N.NEXT_STATEMENT]=new Rs(e),t[N.PREVIOUS_STATEMENT]=new Rs(e),t}},Qa=class extends qt{constructor(e,t,i){super(i),this.type=b.SELECTED,this.oldElementId=e??void 0,this.newElementId=t??void 0}toJson(){const e=super.toJson();return e.oldElementId=this.oldElementId,e.newElementId=this.newElementId,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new Qa)).oldElementId=e.oldElementId,t.newElementId=e.newElementId,t}};U(k.EVENT,b.SELECTED,Qa);var eu=class extends Ri{constructor(e){if(super(e),this.type=b.BLOCK_DELETE,e){if(e.getParent())throw Error("Connected blocks cannot be deleted.");e.isShadow()&&(this.recordUndo=!1),this.oldXml=Do(e),this.ids=Io(e),this.wasShadow=e.isShadow(),this.oldJson=rt(e,{addCoordinates:!0})}}toJson(){const e=super.toJson();if(!this.oldXml)throw Error("The old block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(void 0===this.wasShadow)throw Error("Whether the block was a shadow is undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.oldXml=ht(this.oldXml),e.ids=this.ids,e.wasShadow=this.wasShadow,e.oldJson=this.oldJson,this.recordUndo||(e.recordUndo=this.recordUndo),e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new eu)).oldXml=o.textToDom$$module$build$src$core$utils$xml(e.oldXml),t.ids=e.ids,t.wasShadow=e.wasShadow||"shadow"===t.oldXml.tagName.toLowerCase(),t.oldJson=e.oldJson,void 0!==e.recordUndo&&(t.recordUndo=e.recordUndo),t}run(e){const t=this.getEventWorkspace_();if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(e)for(e=0;e<this.ids.length;e++){const i=this.ids[e],s=t.getBlockById(i);s?s.dispose(!1):i===this.blockId&&console.warn("Can't delete non-existent block: "+i)}else Ro(this.oldJson,t)}};U(k.EVENT,b.BLOCK_DELETE,eu);var vm={fromJsonInternal:kn},tu={TEST_ONLY:vm};tu.fromJson=o.fromJson$$module$build$src$core$field_registry,tu.register=pt,tu.unregister=sl;var He=class extends Q{constructor(e,t,i){super(Q.SKIP_SETUP),this.svgArrow=this.arrow=this.imageElement=this.menu_=this.selectedMenuItem=null,this.SERIALIZABLE=!0,this.clickTarget_=this.suffixField=this.prefixField=this.generatedOptions=null,e!==Q.SKIP_SETUP&&(this.setOptions(e),i&&this.configure_(i),t&&this.setValidator(t))}fromXml(e){this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(e.textContent)}loadState(e){this.loadLegacyState(He,e)||(this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(e))}initView(){this.shouldAddBorderRect_()?this.createBorderRect_():this.clickTarget_=this.sourceBlock_.getSvgRoot(),this.createTextElement_(),this.imageElement=I(f.IMAGE,{},this.fieldGroup_),this.getConstants().FIELD_DROPDOWN_SVG_ARROW?this.createSVGArrow_():this.createTextArrow_(),this.borderRect_&&A(this.borderRect_,"blocklyDropdownRect"),this.fieldGroup_&&(A(this.fieldGroup_,"blocklyField"),A(this.fieldGroup_,"blocklyDropdownField"))}shouldAddBorderRect_(){let e;return!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW&&!(null!=(e=this.getSourceBlock())&&e.isShadow())}createTextArrow_(){let e,t;this.arrow=I(f.TSPAN,{},this.textElement_),this.arrow.appendChild(document.createTextNode(null!=(e=this.getSourceBlock())&&e.RTL?He.ARROW_CHAR+" ":" "+He.ARROW_CHAR)),this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.arrow.setAttribute("dominant-baseline","central"),null!=(t=this.getSourceBlock())&&t.RTL?this.getTextElement().insertBefore(this.arrow,this.textContent_):this.getTextElement().appendChild(this.arrow)}createSVGArrow_(){this.svgArrow=I(f.IMAGE,{height:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px",width:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px"},this.fieldGroup_),this.svgArrow.setAttributeNS($t,"xlink:href",this.getConstants().FIELD_DROPDOWN_SVG_ARROW_DATAURI)}showEditor_(e){var t=this.getSourceBlock();if(!t)throw new fe;this.dropdownCreate(),this.menu_&&(this.menu_.openingCoords=e&&"number"==typeof e.clientX?new S(e.clientX,e.clientY):null,kr(),e=this.menu_.render(Ir()),A(e,"blocklyDropdownMenu"),this.getConstants().FIELD_DROPDOWN_COLOURED_DIV&&(t=t.getColour(),e=this.sourceBlock_.getColourTertiary(),qc(t,e)),zc(this,this.dropdownDispose_.bind(this)),Ir().style.height=`${this.menu_.getSize().height}px`,this.menu_.focus(),this.selectedMenuItem&&this.menu_.setHighlighted(this.selectedMenuItem),this.applyColour())}dropdownCreate(){const e=this.getSourceBlock();if(!e)throw new fe;const t=new Oa;t.setRole(mt.LISTBOX),this.menu_=t;const i=this.getOptions(!1);this.selectedMenuItem=null;for(let n=0;n<i.length;n++){var s=i[n];if(s===He.SEPARATOR){t.addChild(new Jh);continue}const[r,a]=s;Bo(r)?((s=new Image(r.width,r.height)).src=r.src,s.alt=r.alt):s=r,(s=new Bl(s,a)).setRole(mt.OPTION),s.setRightToLeft(e.RTL),s.setCheckable(!0),t.addChild(s),s.setChecked(a===this.value_),a===this.value_&&(this.selectedMenuItem=s),s.onAction(this.handleMenuActionEvent,this)}}dropdownDispose_(){this.menu_&&this.menu_.dispose(),this.selectedMenuItem=this.menu_=null,this.applyColour()}handleMenuActionEvent(e){gn(this,!0),this.onItemSelected_(this.menu_,e)}onItemSelected_(e,t){this.setValue(t.getValue())}isOptionListDynamic(){return"function"==typeof this.menuGenerator_}getOptions(e){if(!this.menuGenerator_)throw TypeError("A menu generator was never defined.");return Array.isArray(this.menuGenerator_)?this.menuGenerator_:(e&&this.generatedOptions||(this.generatedOptions=this.menuGenerator_(),this.validateOptions(this.generatedOptions)),this.generatedOptions)}setOptions(e){Array.isArray(e)?(this.validateOptions(e),e=this.trimOptions(e),this.menuGenerator_=e.options,this.prefixField=e.prefix||null,this.suffixField=e.suffix||null):this.menuGenerator_=e,this.selectedOption=this.getOptions(!1)[0],this.setValue(this.selectedOption[1])}doClassValidation_(e){return this.getOptions(!0).some(t=>t[1]===e)?e:(this.sourceBlock_&&console.warn("Cannot set the dropdown's value to an unavailable option. Block type: "+this.sourceBlock_.type+", Field name: "+this.name+", Value: "+e),null)}doValueUpdate_(e){super.doValueUpdate_(e),e=this.getOptions(!0);for(let i,t=0;i=e[t];t++)i[1]===this.value_&&(this.selectedOption=i)}applyColour(){const e=this.sourceBlock_;this.borderRect_&&(this.borderRect_.setAttribute("stroke",e.getColourTertiary()),this.borderRect_.setAttribute("fill",this.menu_?e.getColourTertiary():"transparent")),e&&this.arrow&&(this.arrow.style.fill=e.isShadow()?e.getColourSecondary():e.getColour())}render_(){this.getTextContent().nodeValue="",this.imageElement.style.display="none";const e=this.selectedOption&&this.selectedOption[0];Bo(e)?this.renderSelectedImage(e):this.renderSelectedText(),this.positionBorderRect_()}renderSelectedImage(e){const t=this.getSourceBlock();if(!t)throw new fe;this.imageElement.style.display="",this.imageElement.setAttributeNS($t,"xlink:href",e.src),this.imageElement.setAttribute("height",String(e.height)),this.imageElement.setAttribute("width",String(e.width));const i=Number(e.height);e=Number(e.width);var s=!!this.borderRect_;const n=Math.max(s?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,i+He.IMAGE_Y_PADDING);let r;s=s?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,r=this.svgArrow?this.positionSVGArrow(e+s,n/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2):w(this.arrow),this.size_.width=e+r+2*s,this.size_.height=n;let a=0;t.RTL?this.imageElement.setAttribute("x",`${s+r}`):(a=e+r,this.getTextElement().setAttribute("text-anchor","end"),this.imageElement.setAttribute("x",`${s}`)),this.imageElement.setAttribute("y",String(n/2-i/2)),this.positionTextElement_(a+s,e+r)}renderSelectedText(){this.getTextContent().nodeValue=this.getDisplayText_();var e=this.getTextElement();A(e,"blocklyDropdownText"),e.setAttribute("text-anchor","start");var t=!!this.borderRect_;e=Math.max(t?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,this.getConstants().FIELD_TEXT_HEIGHT);const i=w(this.getTextElement());t=t?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;let s=0;this.svgArrow&&(s=this.positionSVGArrow(i+t,e/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2)),this.size_.width=i+s+2*t,this.size_.height=e,this.positionTextElement_(t,i)}positionSVGArrow(e,t){if(!this.svgArrow)return 0;const i=this.getSourceBlock();if(!i)throw new fe;const s=this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,n=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_PADDING,r=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE;return this.svgArrow.setAttribute("transform","translate("+(i.RTL?s:e+n)+","+t+")"),r+n}getText_(){if(!this.selectedOption)return null;const e=this.selectedOption[0];if(Bo(e))return e.alt;if(typeof HTMLElement<"u"&&e instanceof HTMLElement){let t,i;return null!=(i=null!=(t=e.title)?t:e.ariaLabel)?i:e.innerText}return"string"==typeof e?e:(console.warn("Can't get text for existing dropdown option. If you're using HTMLElement dropdown options in node, ensure you're using jsdom-global or similar."),null)}static fromJson(e){if(!e.options)throw Error("options are required for the dropdown field. The options property must be assigned an array of [humanReadableValue, languageNeutralValue] tuples.");return new this(e.options,void 0,e)}trimOptions(e){let t=!1;const i=e.map(a=>{if(a===He.SEPARATOR)return a;const[$,C]=a;return"string"==typeof $?[l($),C]:(t=!0,[Bo($)?Object.assign({},$,{alt:l($.alt)}):Object.assign({},$),C])});if(t||e.length<2)return{options:i};var s=i.map(([a])=>a),n=ls(s);e=Rr(s,n);const r=Or(s,n);return!e&&!r||n<=e+r?{options:i}:(n=e?s[0].substring(0,e-1):void 0,s=r?s[0].substr(1-r):void 0,{options:this.applyTrim(i,e,r),prefix:n,suffix:s})}applyTrim(e,t,i){return e.map(([s,n])=>[s.substring(t,s.length-i),n])}validateOptions(e){if(!Array.isArray(e))throw TypeError("FieldDropdown options must be an array.");if(!e.length)throw TypeError("FieldDropdown options must not be an empty array.");let t=!1;for(let i=0;i<e.length;i++){const s=e[i];Array.isArray(s)||s===He.SEPARATOR?"string"!=typeof s[1]?(t=!0,console.error(`Invalid option[${i}]: Each FieldDropdown option id must be a string. \n          Found ${s[1]} in: ${s}`)):!s[0]||"string"==typeof s[0]||Bo(s[0])||typeof HTMLElement<"u"&&s[0]instanceof HTMLElement||(t=!0,console.error(`Invalid option[${i}]: Each FieldDropdown option must have a string \n          label, image description, or HTML element. Found ${s[0]} in: ${s}`)):(t=!0,console.error(`Invalid option[${i}]: Each FieldDropdown option must be an array or\n          the string literal 'separator'. Found: ${s}`))}if(t)throw TypeError("Found invalid FieldDropdown options.")}};He.SEPARATOR="separator",He.ARROW_CHAR="\u25be",He.IMAGE_Y_OFFSET=5,He.IMAGE_Y_PADDING=2*He.IMAGE_Y_OFFSET,pt("field_dropdown",He);var ft,Li=class{constructor(e,t,i,s){this.name=e,this.startHats=!1,this.blockStyles=t||Object.create(null),this.categoryStyles=i||Object.create(null),this.componentStyles=s||Object.create(null),this.fontStyle=Object.create(null),U(k.THEME,e,this,!0)}getClassName(){return this.name+"-theme"}setBlockStyle(e,t){this.blockStyles[e]=t}setCategoryStyle(e,t){this.categoryStyles[e]=t}getComponentStyle(e){if(!(e=this.componentStyles[e]))return null;if("string"==typeof e){const t=this.getComponentStyle(e);if(t)return t}return`${e}`}setComponentStyle(e,t){this.componentStyles[e]=t}setFontStyle(e){this.fontStyle=e}setStartHats(e){this.startHats=e}static defineTheme(e,t){e=e.toLowerCase();const i=new Li(e);let s=t.base;if(s){if("string"==typeof s){let n;s=null!=(n=Tt(k.THEME,s))?n:void 0}s instanceof Li&&(Bt(i,s),i.name=e)}return Bt(i.blockStyles,t.blockStyles),Bt(i.categoryStyles,t.categoryStyles),Bt(i.componentStyles,t.componentStyles),Bt(i.fontStyle,t.fontStyle),null!==t.startHats&&(i.startHats=t.startHats),i}},Xl=new Li("classic",{colour_blocks:{colourPrimary:"20"},list_blocks:{colourPrimary:"260"},logic_blocks:{colourPrimary:"210"},loop_blocks:{colourPrimary:"120"},math_blocks:{colourPrimary:"230"},procedure_blocks:{colourPrimary:"290"},text_blocks:{colourPrimary:"160"},variable_blocks:{colourPrimary:"330"},variable_dynamic_blocks:{colourPrimary:"310"},hat_blocks:{colourPrimary:"330",hat:"cap"}},{colour_category:{colour:"20"},list_category:{colour:"260"},logic_category:{colour:"210"},loop_category:{colour:"120"},math_category:{colour:"230"},procedure_category:{colour:"290"},text_category:{colour:"160"},variable_category:{colour:"330"},variable_dynamic_category:{colour:"310"}}),Xt=class{constructor(e){this.gridPattern=null,this.getMetrics=this.setMetrics=void 0;let t=null,i=!1;var s=!1,n=!1,r=!1,a=!1,$=!1;const C=!!e.readOnly;var F;C||(t=lr(null!=(F=e.toolbox)?F:null),i=cr(t),s=void 0===(s=e.trashcan)?i:s,n=void 0===(n=e.collapse)?i:n,r=void 0===(r=e.comments)?i:r,a=void 0===(a=e.disable)?i:a,$=void 0===($=e.sounds)||$),F=e.maxTrashcanContents,s?void 0===F&&(F=32):F=0;const me=!!e.rtl;let re=e.horizontalLayout;void 0===re&&(re=!1);var We="end"!==e.toolboxPosition;We=re?We?G.TOP:G.BOTTOM:We===me?G.RIGHT:G.LEFT;let Jo=e.css;void 0===Jo&&(Jo=!0);let To="https://blockly-demo.appspot.com/static/media/";e.media&&(To=e.media.endsWith("/")?e.media:e.media+"/");const m_=e.oneBasedIndex,qE=e.renderer||"geras",zE=e.plugins||{};let __,b_,f_,Lg=e.modalInputs;void 0===Lg&&(Lg=!0),this.RTL=me,this.oneBasedIndex=void 0===m_||m_,this.collapse=n,this.comments=r,this.disable=a,this.readOnly=C,this.maxBlocks=e.maxBlocks||1/0,this.maxInstances=null!=(__=e.maxInstances)?__:null,this.modalInputs=Lg,this.pathToMedia=To,this.hasCategories=i,this.moveOptions=Xt.parseMoveOptions(e,i),this.hasScrollbars=!!this.moveOptions.scrollbars,this.hasTrashcan=s,this.maxTrashcanContents=F,this.hasSounds=$,this.hasCss=Jo,this.horizontalLayout=re,this.languageTree=t,this.gridOptions=Xt.parseGridOptions(e),this.zoomOptions=Xt.parseZoomOptions(e),this.toolboxPosition=We,this.theme=Xt.parseThemeOptions(e),this.renderer=qE,this.rendererOverrides=null!=(b_=e.rendererOverrides)?b_:null,this.parentWorkspace=null!=(f_=e.parentWorkspace)?f_:null,this.plugins=zE}static parseMoveOptions(e,t){const i=e.move||{},s={};return void 0===i.scrollbars&&void 0===e.scrollbars?s.scrollbars=t:"object"==typeof i.scrollbars?(s.scrollbars={horizontal:!!i.scrollbars.horizontal,vertical:!!i.scrollbars.vertical},s.scrollbars.horizontal&&s.scrollbars.vertical?s.scrollbars=!0:s.scrollbars.horizontal||s.scrollbars.vertical||(s.scrollbars=!1)):s.scrollbars=!!i.scrollbars||!!e.scrollbars,s.wheel=s.scrollbars&&void 0!==i.wheel?!!i.wheel:"object"==typeof s.scrollbars,s.drag=!(!s.scrollbars||void 0!==i.drag&&!i.drag),s}static parseZoomOptions(e){const t={};return t.controls=void 0!==(e=e.zoom||{}).controls&&!!e.controls,t.wheel=void 0!==e.wheel&&!!e.wheel,t.startScale=void 0===e.startScale?1:Number(e.startScale),t.maxScale=void 0===e.maxScale?3:Number(e.maxScale),t.minScale=void 0===e.minScale?.3:Number(e.minScale),t.scaleSpeed=void 0===e.scaleSpeed?1.2:Number(e.scaleSpeed),t.pinch=void 0===e.pinch?t.wheel||t.controls:!!e.pinch,t}static parseGridOptions(e){e=e.grid||{};const t={};return t.spacing=Number(e.spacing)||0,t.colour=e.colour||"#888",t.length=void 0===e.length?1:Number(e.length),t.snap=t.spacing>0&&!!e.snap,t}static parseThemeOptions(e){return"string"==typeof(e=e.theme||Xl)?Tt(k.THEME,e):e instanceof Li?e:Li.defineTheme(e.name||"builtin"+ze(),e)}},Ep=class{constructor(e,t){this.bubble=e,this.workspace=t,this.startLoc=null}isMovable(){return!0}startDrag(){let e;this.startLoc=this.bubble.getRelativeToSurfaceXY(),this.workspace.setResizesEnabled(!1),null==(e=this.workspace.getLayerManager())||e.moveToDragLayer(this.bubble),this.bubble.setDragging&&this.bubble.setDragging(!0)}drag(e){this.bubble.moveDuringDrag(e)}endDrag(){let e;this.workspace.setResizesEnabled(!0),null==(e=this.workspace.getLayerManager())||e.moveOffDragLayer(this.bubble,100),this.bubble.setDragging(!1)}revertDrag(){this.startLoc&&this.bubble.moveDuringDrag(this.startLoc)}},ee=class{constructor(e,t,i,s){this.workspace=e,this.anchor=t,this.ownerRect=i,this.size=new j(0,0),this.colour="#ffffff",this.disposed=!1,this.relativeLeft=this.relativeTop=0,this.dragStrategy=new Ep(this,this.workspace),this.id=ze(),this.svgRoot=I(f.G,{class:"blocklyBubble"},e.getBubbleCanvas()),e=I(f.G,{class:"blocklyEmboss"},this.svgRoot),this.tail=I(f.PATH,{class:"blocklyBubbleTail"},e),this.background=I(f.RECT,{class:"blocklyDraggable",x:0,y:0,rx:ft.BORDER_WIDTH,ry:ft.BORDER_WIDTH},e),this.contentContainer=I(f.G,{},this.svgRoot),this.focusableElement=s??this.svgRoot,this.focusableElement.setAttribute("id",this.id),L(this.background,"pointerdown",this,this.onMouseDown)}dispose(){J(this.svgRoot),this.disposed=!0}setAnchorLocation(e,t=!1){this.anchor=e,t?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor(),this.renderTail()}setPositionRelativeToAnchor(e,t){this.relativeLeft=e,this.relativeTop=t,this.positionRelativeToAnchor(),this.renderTail()}getSize(){return this.size}setSize(e,t=!1){e.width=Math.max(e.width,ft.MIN_SIZE),e.height=Math.max(e.height,ft.MIN_SIZE),this.size=e,this.background.setAttribute("width",`${e.width}`),this.background.setAttribute("height",`${e.height}`),t?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor(),this.renderTail()}getColour(){return this.colour}setColour(e){this.colour=e,this.tail.setAttribute("fill",e),this.background.setAttribute("fill",e)}onMouseDown(e){let t;null==(t=this.workspace.getGesture(e))||t.handleBubbleStart(e,this),o.getFocusManager$$module$build$src$core$focus_manager().focusNode(this)}positionRelativeToAnchor(){let e=this.anchor.x;e=this.workspace.RTL?e-(this.relativeLeft+this.size.width):e+this.relativeLeft,this.moveTo(e,this.relativeTop+this.anchor.y)}moveTo(e,t){this.svgRoot.setAttribute("transform",`translate(${e}, ${t})`)}positionByRect(e=new z(0,0,0,0)){var t=this.workspace.getMetricsManager().getViewMetrics(!0),i=this.getOptimalRelativeLeft(t),s=this.getOptimalRelativeTop(t);const n={x:i,y:-this.size.height-this.workspace.getRenderer().getConstants().MIN_BLOCK_HEIGHT},r={x:-this.size.width-30,y:s};s={x:e.getWidth(),y:s};var a={x:i,y:e.getHeight()};i=e.getWidth()<e.getHeight()?s:a,e=e.getWidth()<e.getHeight()?a:s,s=this.getOverlap(n,t),a=this.getOverlap(r,t);const $=this.getOverlap(i,t);t=this.getOverlap(e,t),s===(t=Math.max(s,a,$,t))?(this.relativeLeft=n.x,this.relativeTop=n.y):a===t?(this.relativeLeft=r.x,this.relativeTop=r.y):$===t?(this.relativeLeft=i.x,this.relativeTop=i.y):(this.relativeLeft=e.x,this.relativeTop=e.y),this.positionRelativeToAnchor()}getOverlap(e,t){var i=this.workspace.RTL?this.anchor.x-e.x-this.size.width:e.x+this.anchor.x;return e=e.y+this.anchor.y,Math.max(0,Math.min(1,(Math.min(i+this.size.width,t.left+t.width)-Math.max(i,t.left))*(Math.min(e+this.size.height,t.top+t.height)-Math.max(e,t.top))/(this.size.width*this.size.height)))}getOptimalRelativeLeft(e){let t=-this.size.width/4;if(this.size.width>e.width)return t;if(e=this.getWorkspaceViewRect(e),this.workspace.RTL){var i=this.anchor.x-t;i-this.size.width<e.left?t=-(e.left-this.anchor.x+this.size.width):i>e.right&&(t=-(e.right-this.anchor.x))}else(i=t+this.anchor.x)<e.left?t=e.left-this.anchor.x:i+this.size.width>e.right&&(t=e.right-this.anchor.x-this.size.width);return t}getOptimalRelativeTop(e){let t=-this.size.height/4;if(this.size.height>e.height)return t;const i=this.anchor.y+t,s=i+this.size.height;return i<(e=this.getWorkspaceViewRect(e)).top?t=e.top-this.anchor.y:s>e.bottom&&(t=e.bottom-this.anchor.y-this.size.height),t}getWorkspaceViewRect(e){const t=e.top;let i=e.top+e.height,s=e.left;return e=e.left+e.width,i-=this.getScrollbarThickness(),this.workspace.RTL?s-=this.getScrollbarThickness():e-=this.getScrollbarThickness(),new z(t,i,s,e)}getScrollbarThickness(){return _e.scrollbarThickness/this.workspace.scale}renderTail(){const e=[];var t=this.size.width/2,i=this.size.height/2,s=-this.relativeLeft,n=-this.relativeTop;if(t===s&&i===n)e.push("M "+t+","+i);else{n-=i,s-=t,this.workspace.RTL&&(s*=-1);var r=Math.sqrt(n*n+s*s),a=Math.acos(s/r);n<0&&(a=2*Math.PI-a);var $=a+Math.PI/2;$>2*Math.PI&&($-=2*Math.PI);var C=Math.sin($);const me=Math.cos($);let re=(this.size.width+this.size.height)/ft.TAIL_THICKNESS;re=Math.min(re,this.size.width,this.size.height)/4,s=t+($=1-ft.ANCHOR_RADIUS/r)*s,n=i+$*n,$=t+re*me;const We=i+re*C;t-=re*me,i-=re*C,(C=a+(C=yr(this.workspace.RTL?-ft.TAIL_ANGLE:ft.TAIL_ANGLE)))>2*Math.PI&&(C-=2*Math.PI),a=Math.sin(C)*r/ft.TAIL_BEND,r=Math.cos(C)*r/ft.TAIL_BEND,e.push("M"+$+","+We),e.push("C"+($+r)+","+(We+a)+" "+s+","+n+" "+s+","+n),e.push("C"+s+","+n+" "+(t+r)+","+(i+a)+" "+t+","+i)}let F;e.push("z"),null==(F=this.tail)||F.setAttribute("d",e.join(" "))}bringToFront(){let e;const t=null==(e=this.svgRoot)?void 0:e.parentNode;return!(!this.svgRoot||t?.lastChild===this.svgRoot||(t?.appendChild(this.svgRoot),0))}getRelativeToSurfaceXY(){return new S(this.workspace.RTL?-this.relativeLeft+this.anchor.x-this.size.width:this.anchor.x+this.relativeLeft,this.anchor.y+this.relativeTop)}getSvgRoot(){return this.svgRoot}moveDuringDrag(e){this.moveTo(e.x,e.y),this.relativeLeft=this.workspace.RTL?this.anchor.x-e.x-this.size.width:e.x-this.anchor.x,this.relativeTop=e.y-this.anchor.y,this.renderTail()}setDragging(e){}setDeleteStyle(e){}isDeletable(){return!1}showContextMenu(e){}isMovable(){return!0}startDrag(){this.dragStrategy.startDrag()}drag(e){this.dragStrategy.drag(e)}endDrag(){this.dragStrategy.endDrag()}revertDrag(){this.dragStrategy.revertDrag()}select(){So(this)}unselect(){So(null)}getFocusableElement(){return this.focusableElement}getFocusableTree(){return this.workspace}onNodeFocus(){this.select(),this.bringToFront()}onNodeBlur(){this.unselect()}canBeFocused(){return!0}};ft=ee,ee.BORDER_WIDTH=6,ee.DOUBLE_BORDER=2*ft.BORDER_WIDTH,ee.MIN_SIZE=ft.DOUBLE_BORDER,ee.TAIL_THICKNESS=1,ee.TAIL_ANGLE=20,ee.TAIL_BEND=4,ee.ANCHOR_RADIUS=8;var go=class extends ee{constructor(e,t,i,s){let n,r;super(t,i,s),this.workspace=t,this.anchor=i,this.ownerRect=s,this.autoLayout=!0,t=new Xt(e),this.validateWorkspaceOptions(t),this.svgDialog=I(f.SVG,{x:ee.BORDER_WIDTH,y:ee.BORDER_WIDTH},this.contentContainer),e.parentWorkspace=this.workspace,this.miniWorkspace=this.newWorkspaceSvg(new Xt(e)),this.miniWorkspace.internalIsMutator=!0,e=this.miniWorkspace.createDom("blocklyMutatorBackground"),this.svgDialog.appendChild(e),t.languageTree&&(e.insertBefore(this.miniWorkspace.addFlyout(f.G),this.miniWorkspace.getCanvas()),e=this.miniWorkspace.getFlyout(),e?.init(this.miniWorkspace),e?.show(t.languageTree)),A(this.svgRoot,"blocklyMiniWorkspaceBubble"),this.miniWorkspace.addChangeListener(this.onWorkspaceChange.bind(this)),null==(n=this.miniWorkspace.getFlyout())||null==(r=n.getWorkspace())||r.addChangeListener(this.onWorkspaceChange.bind(this)),this.updateBubbleSize()}dispose(){this.miniWorkspace.dispose(),super.dispose()}getWorkspace(){return this.miniWorkspace}addWorkspaceChangeListener(e){this.miniWorkspace.addChangeListener(e)}validateWorkspaceOptions(e){if(e.hasCategories)throw Error("The miniworkspace bubble does not support toolboxes with categories");if(e.hasTrashcan)throw Error("The miniworkspace bubble does not support trashcans");if(e.zoomOptions.controls||e.zoomOptions.wheel||e.zoomOptions.pinch)throw Error("The miniworkspace bubble does not support zooming");if(e.moveOptions.scrollbars||e.moveOptions.wheel||e.moveOptions.drag)throw Error("The miniworkspace bubble does not scrolling/moving the workspace");if(e.horizontalLayout)throw Error("The miniworkspace bubble does not support horizontal layouts")}onWorkspaceChange(){this.bumpBlocksIntoBounds(),this.updateBubbleSize()}bumpBlocksIntoBounds(){if(!this.miniWorkspace.isDragging()||this.miniWorkspace.keyboardMoveInProgress)for(const e of this.miniWorkspace.getTopBlocks(!1)){const t=e.getRelativeToSurfaceXY();if(t.y<20&&e.moveBy(0,20-t.y),e.RTL){let i=-20;const s=this.miniWorkspace.getFlyout();s&&(i-=s.getWidth()),t.x>i&&e.moveBy(i-t.x,0)}else t.x<20&&e.moveBy(20-t.x,0)}}updateBubbleSize(){if(!this.miniWorkspace.isDragging()||this.miniWorkspace.keyboardMoveInProgress){this.autoLayout&&(this.autoLayout=!this.miniWorkspace.keyboardMoveInProgress);var e=this.getSize(),t=this.calculateWorkspaceSize();Math.abs(e.width-t.width)<go.MINIMUM_VIEW_CHANGE&&Math.abs(e.height-t.height)<go.MINIMUM_VIEW_CHANGE||(this.svgDialog.setAttribute("width",`${t.width}px`),this.svgDialog.setAttribute("height",`${t.height}px`),this.miniWorkspace.setCachedParentSvgSize(t.width,t.height),this.miniWorkspace.RTL&&this.miniWorkspace.getCanvas().setAttribute("transform",`translate(${t.width}, 0)`),this.setSize(new j(t.width+ee.DOUBLE_BORDER,t.height+ee.DOUBLE_BORDER),this.autoLayout),this.miniWorkspace.resize(),this.miniWorkspace.recordDragTargets())}}calculateWorkspaceSize(){var e=this.miniWorkspace.getCanvas().getBBox();let t=e.width+go.MARGIN;e=e.height+go.MARGIN;const i=this.miniWorkspace.getFlyout();if(i){const s=i.getWorkspace().getMetricsManager().getScrollMetrics();e=Math.max(e,s.height+20),t+=i.getWidth()}return new j(t,e)}updateBlockStyles(){for(var e of this.miniWorkspace.getAllBlocks(!1))e.setStyle(e.getStyleName());let t;if(e=null==(t=this.miniWorkspace.getFlyout())?void 0:t.getWorkspace())for(const i of e.getAllBlocks(!1))i.setStyle(i.getStyleName())}moveDuringDrag(e){super.moveDuringDrag(e),this.autoLayout=!1}moveTo(e,t){super.moveTo(e,t),this.miniWorkspace.recordDragTargets()}newWorkspaceSvg(e){throw Error("The implementation of newWorkspaceSvg should be monkey-patched in by blockly.ts")}};go.MINIMUM_VIEW_CHANGE=10,go.MARGIN=3*ee.DOUBLE_BORDER;var qn=class{constructor(e){this.sourceBlock=e,this.offsetInBlock=new S(0,0),this.workspaceLocation=new S(0,0),this.svgRoot=null,this.tooltip=e,this.id=ze()}getType(){throw Error("Icons must implement getType")}initView(e){if(!this.svgRoot){var t=this.sourceBlock;this.svgRoot=I(f.G,{class:"blocklyIconGroup",id:this.id}),t.getSvgRoot().appendChild(this.svgRoot),this.updateSvgRootOffset(),L(this.svgRoot,"pointerdown",this,e),this.svgRoot.tooltip=this,cs(this.svgRoot)}}dispose(){Lr(this.svgRoot),J(this.svgRoot)}getWeight(){return-1}getSize(){return new j(0,0)}setTooltip(e){this.tooltip=e??this.sourceBlock}getTooltip(){return this.tooltip}applyColour(){}updateEditable(){}updateCollapsed(){this.svgRoot&&(this.svgRoot.style.display=this.sourceBlock.isCollapsed()?"none":"block",Oo(this)&&this.setBubbleVisible(!1))}hideForInsertionMarker(){this.svgRoot&&(this.svgRoot.style.display="none")}isShownWhenCollapsed(){return!1}setOffsetInBlock(e){this.offsetInBlock=e,this.updateSvgRootOffset()}updateSvgRootOffset(){let e;null==(e=this.svgRoot)||e.setAttribute("transform",`translate(${this.offsetInBlock.x}, ${this.offsetInBlock.y})`)}onLocationChange(e){this.workspaceLocation=S.sum(e,this.offsetInBlock)}onClick(){}isClickableInFlyout(e){return!0}getFocusableElement(){const e=this.svgRoot;if(!e)throw Error("Attempting to focus uninitialized icon.");return e}getFocusableTree(){return this.sourceBlock.workspace}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}getSourceBlock(){return this.sourceBlock}};o.MutatorIcon$$module$build$src$core$icons$mutator_icon=class extends qn{constructor(e,t){super(t),this.flyoutBlockTypes=e,this.sourceBlock=t,this.saveConnectionsListener=this.updateWorkspacePid=this.rootBlock=this.miniWorkspaceBubble=null}getType(){return o.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE}initView(e){this.svgRoot||(super.initView(e),I(f.RECT,{class:"blocklyIconShape",rx:"4",ry:"4",height:"16",width:"16"},this.svgRoot),I(f.PATH,{class:"blocklyIconSymbol",d:"m4.203,7.296 0,1.368 -0.92,0.677 -0.11,0.41 0.9,1.559 0.41,0.11 1.043,-0.457 1.187,0.683 0.127,1.134 0.3,0.3 1.8,0 0.3,-0.299 0.127,-1.138 1.185,-0.682 1.046,0.458 0.409,-0.11 0.9,-1.559 -0.11,-0.41 -0.92,-0.677 0,-1.366 0.92,-0.677 0.11,-0.41 -0.9,-1.559 -0.409,-0.109 -1.046,0.458 -1.185,-0.682 -0.127,-1.138 -0.3,-0.299 -1.8,0 -0.3,0.3 -0.126,1.135 -1.187,0.682 -1.043,-0.457 -0.41,0.11 -0.899,1.559 0.108,0.409z"},this.svgRoot),I(f.CIRCLE,{class:"blocklyIconShape",r:"2.7",cx:"8",cy:"8"},this.svgRoot),A(this.svgRoot,"blocklyMutatorIcon"))}dispose(){let e;super.dispose(),null==(e=this.miniWorkspaceBubble)||e.dispose()}getWeight(){return o.MutatorIcon$$module$build$src$core$icons$mutator_icon.WEIGHT}getSize(){return new j(17,17)}applyColour(){let e,t;super.applyColour(),null==(e=this.miniWorkspaceBubble)||e.setColour(this.sourceBlock.getColour()),null==(t=this.miniWorkspaceBubble)||t.updateBlockStyles()}updateCollapsed(){super.updateCollapsed(),this.sourceBlock.isCollapsed()&&this.setBubbleVisible(!1)}onLocationChange(e){let t;super.onLocationChange(e),null==(t=this.miniWorkspaceBubble)||t.setAnchorLocation(this.getAnchorLocation())}onClick(){super.onClick(),this.sourceBlock.isEditable()&&this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}bubbleIsVisible(){return!!this.miniWorkspaceBubble}setBubbleVisible(e){const t=this;return(0,y.asyncExecutePromiseGeneratorFunction)(function*(){if(t.bubbleIsVisible()!==e){if(yield Ht(),e){let i;t.miniWorkspaceBubble=new go(t.getMiniWorkspaceConfig(),t.sourceBlock.workspace,t.getAnchorLocation(),t.getBubbleOwnerRect()),t.applyColour(),t.createRootBlock(),t.addSaveConnectionsListener(),null==(i=t.miniWorkspaceBubble)||i.addWorkspaceChangeListener(t.createMiniWorkspaceChangeListener())}else{let i;null==(i=t.miniWorkspaceBubble)||i.dispose(),t.miniWorkspaceBubble=null,t.saveConnectionsListener&&t.sourceBlock.workspace.removeChangeListener(t.saveConnectionsListener),t.saveConnectionsListener=null}B(new(P(b.BUBBLE_OPEN))(t.sourceBlock,e,"mutator"))}})}getBubble(){return this.miniWorkspaceBubble}getMiniWorkspaceConfig(){let e;const t={disable:!1,media:this.sourceBlock.workspace.options.pathToMedia,rtl:this.sourceBlock.RTL,renderer:this.sourceBlock.workspace.options.renderer,rendererOverrides:null!=(e=this.sourceBlock.workspace.options.rendererOverrides)?e:void 0};return this.flyoutBlockTypes.length&&(t.toolbox={kind:"flyoutToolbox",contents:this.flyoutBlockTypes.map(i=>({kind:"block",type:i}))}),t}getAnchorLocation(){return S.sum(this.workspaceLocation,new S(8.5,8.5))}getBubbleOwnerRect(){const e=this.sourceBlock.getSvgRoot().getBBox();return new z(e.y,e.y+e.height,e.x,e.x+e.width)}createRootBlock(){if(!this.sourceBlock.decompose)throw Error("Blocks with mutator icons must include a decompose method");for(var e of(this.rootBlock=this.sourceBlock.decompose(this.miniWorkspaceBubble.getWorkspace()),this.rootBlock.getDescendants(!1)))e.queueRender();let t,i,s,n;this.rootBlock.setMovable(!1),this.rootBlock.setDeletable(!1),e=null!=(n=null==(t=this.miniWorkspaceBubble)||null==(i=t.getWorkspace())||null==(s=i.getFlyout())?void 0:s.getWidth())?n:0,this.rootBlock.moveBy(this.rootBlock.RTL?-(e+16):16,16)}addSaveConnectionsListener(){this.sourceBlock.saveConnections&&this.rootBlock&&(this.saveConnectionsListener=()=>{this.sourceBlock.saveConnections&&this.rootBlock&&this.sourceBlock.saveConnections(this.rootBlock)},this.saveConnectionsListener(),this.sourceBlock.workspace.addChangeListener(this.saveConnectionsListener))}createMiniWorkspaceChangeListener(){return e=>{o.MutatorIcon$$module$build$src$core$icons$mutator_icon.isIgnorableMutatorEvent(e)||this.updateWorkspacePid||(this.updateWorkspacePid=setTimeout(()=>{this.updateWorkspacePid=null,this.recomposeSourceBlock()},0))}}static isIgnorableMutatorEvent(e){return e.isUiEvent||ro(e)||Mt(e)&&"disabled"===e.element}recomposeSourceBlock(){if(this.rootBlock){if(!this.sourceBlock.compose)throw Error("Blocks with mutator icons must include a compose method");var e=o.getGroup$$module$build$src$core$events$utils();e||o.setGroup$$module$build$src$core$events$utils(!0);var t=Oi.getExtraBlockState_(this.sourceBlock);this.sourceBlock.compose(this.rootBlock);var i=Oi.getExtraBlockState_(this.sourceBlock);t!==i&&B(new(P(b.BLOCK_CHANGE))(this.sourceBlock,"mutation",null,t,i)),o.setGroup$$module$build$src$core$events$utils(e)}}getWorkspace(){let e;return null==(e=this.miniWorkspaceBubble)?void 0:e.getWorkspace()}},o.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE=Ce.MUTATOR,o.MutatorIcon$$module$build$src$core$icons$mutator_icon.WEIGHT=1;var zn=Object.create(null),Ob={allExtensions:zn};o.register$$module$build$src$core$extensions("parent_tooltip_when_inline",hl);var Yt={TEST_ONLY:Ob};Yt.apply=$s,Yt.buildTooltipForDropdown=o.buildTooltipForDropdown$$module$build$src$core$extensions,Yt.buildTooltipWithFieldText=o.buildTooltipWithFieldText$$module$build$src$core$extensions,Yt.isRegistered=Sn,Yt.register=o.register$$module$build$src$core$extensions,Yt.registerMixin=o.registerMixin$$module$build$src$core$extensions,Yt.registerMutator=o.registerMutator$$module$build$src$core$extensions,Yt.runAfterPageLoad=ul,Yt.unregister=nl;var oe=function(e){return e[e.WIN_KEY_FF_LINUX=0]="WIN_KEY_FF_LINUX",e[e.MAC_ENTER=3]="MAC_ENTER",e[e.BACKSPACE=8]="BACKSPACE",e[e.TAB=9]="TAB",e[e.NUM_CENTER=12]="NUM_CENTER",e[e.ENTER=13]="ENTER",e[e.SHIFT=16]="SHIFT",e[e.CTRL=17]="CTRL",e[e.ALT=18]="ALT",e[e.PAUSE=19]="PAUSE",e[e.CAPS_LOCK=20]="CAPS_LOCK",e[e.ESC=27]="ESC",e[e.SPACE=32]="SPACE",e[e.PAGE_UP=33]="PAGE_UP",e[e.PAGE_DOWN=34]="PAGE_DOWN",e[e.END=35]="END",e[e.HOME=36]="HOME",e[e.LEFT=37]="LEFT",e[e.UP=38]="UP",e[e.RIGHT=39]="RIGHT",e[e.DOWN=40]="DOWN",e[e.PLUS_SIGN=43]="PLUS_SIGN",e[e.PRINT_SCREEN=44]="PRINT_SCREEN",e[e.INSERT=45]="INSERT",e[e.DELETE=46]="DELETE",e[e.ZERO=48]="ZERO",e[e.ONE=49]="ONE",e[e.TWO=50]="TWO",e[e.THREE=51]="THREE",e[e.FOUR=52]="FOUR",e[e.FIVE=53]="FIVE",e[e.SIX=54]="SIX",e[e.SEVEN=55]="SEVEN",e[e.EIGHT=56]="EIGHT",e[e.NINE=57]="NINE",e[e.FF_SEMICOLON=59]="FF_SEMICOLON",e[e.FF_EQUALS=61]="FF_EQUALS",e[e.FF_DASH=173]="FF_DASH",e[e.FF_HASH=163]="FF_HASH",e[e.QUESTION_MARK=63]="QUESTION_MARK",e[e.AT_SIGN=64]="AT_SIGN",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.META=91]="META",e[e.WIN_KEY_RIGHT=92]="WIN_KEY_RIGHT",e[e.CONTEXT_MENU=93]="CONTEXT_MENU",e[e.NUM_ZERO=96]="NUM_ZERO",e[e.NUM_ONE=97]="NUM_ONE",e[e.NUM_TWO=98]="NUM_TWO",e[e.NUM_THREE=99]="NUM_THREE",e[e.NUM_FOUR=100]="NUM_FOUR",e[e.NUM_FIVE=101]="NUM_FIVE",e[e.NUM_SIX=102]="NUM_SIX",e[e.NUM_SEVEN=103]="NUM_SEVEN",e[e.NUM_EIGHT=104]="NUM_EIGHT",e[e.NUM_NINE=105]="NUM_NINE",e[e.NUM_MULTIPLY=106]="NUM_MULTIPLY",e[e.NUM_PLUS=107]="NUM_PLUS",e[e.NUM_MINUS=109]="NUM_MINUS",e[e.NUM_PERIOD=110]="NUM_PERIOD",e[e.NUM_DIVISION=111]="NUM_DIVISION",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.NUMLOCK=144]="NUMLOCK",e[e.SCROLL_LOCK=145]="SCROLL_LOCK",e[e.FIRST_MEDIA_KEY=166]="FIRST_MEDIA_KEY",e[e.LAST_MEDIA_KEY=183]="LAST_MEDIA_KEY",e[e.SEMICOLON=186]="SEMICOLON",e[e.DASH=189]="DASH",e[e.EQUALS=187]="EQUALS",e[e.COMMA=188]="COMMA",e[e.PERIOD=190]="PERIOD",e[e.SLASH=191]="SLASH",e[e.APOSTROPHE=192]="APOSTROPHE",e[e.TILDE=192]="TILDE",e[e.SINGLE_QUOTE=222]="SINGLE_QUOTE",e[e.OPEN_SQUARE_BRACKET=219]="OPEN_SQUARE_BRACKET",e[e.BACKSLASH=220]="BACKSLASH",e[e.CLOSE_SQUARE_BRACKET=221]="CLOSE_SQUARE_BRACKET",e[e.WIN_KEY=224]="WIN_KEY",e[e.MAC_FF_META=224]="MAC_FF_META",e[e.MAC_WK_CMD_LEFT=91]="MAC_WK_CMD_LEFT",e[e.MAC_WK_CMD_RIGHT=93]="MAC_WK_CMD_RIGHT",e[e.WIN_IME=229]="WIN_IME",e[e.VK_NONAME=252]="VK_NONAME",e[e.PHANTOM=255]="PHANTOM",e}(oe||{}),Xo={};Xo.arc=he,Xo.curve=Pe,Xo.line=lt,Xo.lineOnAxis=M,Xo.lineTo=gt,Xo.moveBy=ae,Xo.moveTo=Se,Xo.point=D;var $e={};$e.Coordinate=S,$e.KeyCodes=oe,$e.Rect=z,$e.Size=j,$e.Svg=f,$e.aria=Dl,$e.array=S$,$e.browserEvents=Zo,$e.colour=Rt,$e.deprecation=em,$e.dom=Fe,$e.extensions=Yt,$e.idGenerator=Ph,$e.math=Da,$e.object=v$,$e.parsing=ql,$e.string=Un,$e.style=Si,$e.svgMath=ys,$e.svgPaths=Xo,$e.toolbox=wi,$e.userAgent=y_,$e.xml=Dn;var Y=class{constructor(e,t){if(this.type=t,this.targetConnection=null,this.disposed=!1,this.shadowDom=this.check=null,this.y=this.x=0,this.shadowState=null,this.sourceBlock_=e,e.id.includes("_connection"))throw Error(`Connection ID indicator is contained in block ID. This will cause problems with focus: ${e.id}.`);this.id=`${e.id}_connection_${ze()}`}connect_(e){const t=N.INPUT_VALUE,i=this.getSourceBlock();var s=e.getSourceBlock();let n,r;if(e.isConnected()&&e.disconnectInternal(!1),this.isConnected()){const a=this.stashShadowState(),$=this.targetBlock();$.isShadow()?$.dispose(!1):(this.disconnectInternal(),n=$),this.applyShadowState(a)}se()&&(r=new(P(b.BLOCK_MOVE))(s),r.setReason(["connect"])),pl(this,e),s.setParent(i),r&&(r.recordNew(),B(r)),n&&(e=this.type===t?n.outputConnection:n.previousConnection)&&((s=Y.getConnectionForOrphanedConnection(s,e))?e.connect(s):e.onFailedConnect(this))}dispose(){if(this.isConnected()){this.isSuperior()&&this.setShadowStateInternal();const e=this.targetBlock();e&&!e.isDeadOrDying()&&e.unplug()}this.disposed=!0}getSourceBlock(){return this.sourceBlock_}isSuperior(){return this.type===N.INPUT_VALUE||this.type===N.NEXT_STATEMENT}isConnected(){return!!this.targetConnection}getConnectionChecker(){return this.sourceBlock_.workspace.connectionChecker}onFailedConnect(e){}connect(e){if(this.targetConnection===e)return!0;if(this.getConnectionChecker().canConnect(this,e,!1)){const t=o.getGroup$$module$build$src$core$events$utils();t||o.setGroup$$module$build$src$core$events$utils(!0),this.isSuperior()?this.connect_(e):e.connect_(this),o.setGroup$$module$build$src$core$events$utils(t)}return this.isConnected()}disconnect(){this.disconnectInternal()}disconnectInternal(e=!0){const{parentConnection:t,childConnection:i}=this.getParentAndChildConnections();if(!t||!i)throw Error("Source connection not connected.");const s=o.getGroup$$module$build$src$core$events$utils();let n;s||o.setGroup$$module$build$src$core$events$utils(!0),se()&&(n=new(P(b.BLOCK_MOVE))(i.getSourceBlock()),n.setReason(["disconnect"]));const r=this.targetConnection;r&&(r.targetConnection=null),this.targetConnection=null,e&&i.getSourceBlock().setParent(null),n&&(n.recordNew(),B(n)),i.getSourceBlock().isShadow()||t.respawnShadow_(),o.setGroup$$module$build$src$core$events$utils(s)}getParentAndChildConnections(){return this.targetConnection?this.isSuperior()?{parentConnection:this,childConnection:this.targetConnection}:{parentConnection:this.targetConnection,childConnection:this}:{}}respawnShadow_(){this.createShadowBlock(!0)}reconnect(e,t){return!(this.getSourceBlock().isDeadOrDying()||(t=null==(i=e.getInput(t))?void 0:i.connection,(i=this.targetBlock())&&i!==e||!t||t.targetConnection===this||(t.isConnected()&&t.disconnect(),t.connect(this),0)));var i}targetBlock(){if(this.isConnected()){let e,t;return null!=(t=null==(e=this.targetConnection)?void 0:e.getSourceBlock())?t:null}return null}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()}setCheck(e){return e?(Array.isArray(e)||(e=[e]),this.check=e,this.onCheckChanged_()):this.check=null,this}getCheck(){return this.check}setShadowDom(e){this.setShadowStateInternal({shadowDom:e})}getShadowDom(e){return e&&this.targetBlock().isShadow()?ao(this.targetBlock()):this.shadowDom}setShadowState(e){this.setShadowStateInternal({shadowState:e})}getShadowState(e){return e&&this.targetBlock()&&this.targetBlock().isShadow()?rt(this.targetBlock()):this.shadowState}neighbours(e){return[]}getParentInput(){let e=null;const t=this.sourceBlock_.inputList;for(let i=0;i<t.length;i++)if(t[i].connection===this){e=t[i];break}return e}toString(){const e=this.sourceBlock_;if(!e)return"Orphan Connection";if(e.outputConnection===this)var t="Output Connection of ";else if(e.previousConnection===this)t="Previous Connection of ";else if(e.nextConnection===this)t="Next Connection of ";else{t=null;for(let s,i=0;s=e.inputList[i];i++)if(s.connection===this){t=s;break}if(!t)return console.warn("Connection not actually connected to sourceBlock_"),"Orphan Connection";t='Input "'+t.name+'" connection on '}return t+e.toDevString()}stashShadowState(){const e=this.getShadowDom(!0),t=this.getShadowState(!0);return this.shadowState=this.shadowDom=null,{shadowDom:e,shadowState:t}}applyShadowState({shadowDom:e,shadowState:t}){this.shadowDom=e,this.shadowState=t}setShadowStateInternal({shadowDom:e=null,shadowState:t=null}={}){this.shadowDom=e,this.shadowState=t,this.getSourceBlock().isDeadOrDying()||((e=this.targetBlock())?e.isShadow()?(e.dispose(!1),this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow(this.targetBlock())):(e=this.createShadowBlock(!1),this.serializeShadow(e),e&&e.dispose(!1)):(this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow(this.targetBlock())))}createShadowBlock(e){var t=this.getSourceBlock();const i=this.getShadowState(),s=this.getShadowDom();if(t.isDeadOrDying()||!i&&!s)return null;if(i)return ss(i,t.workspace,{parentConnection:e?this:void 0,isShadow:!0,recordUndo:!1});if(s){if(t=uo(s,t.workspace),e)if(this.type===N.INPUT_VALUE){if(!t.outputConnection)throw Error("Shadow block is missing an output connection");if(!this.connect(t.outputConnection))throw Error("Could not connect shadow block to connection")}else{if(this.type!==N.NEXT_STATEMENT)throw Error("Cannot connect a shadow block to a previous/output connection");if(!t.previousConnection)throw Error("Shadow block is missing previous connection");if(!this.connect(t.previousConnection))throw Error("Could not connect shadow block to connection")}return t}return null}serializeShadow(e){e&&(this.shadowDom=ao(e),this.shadowState=rt(e))}static getConnectionForOrphanedConnection(e,t){if(t.type===N.OUTPUT_VALUE)return Zt(e,t.getSourceBlock());e=e.lastConnectionInStack(!0);const i=t.getConnectionChecker();return e&&i.canConnect(t,e,!1)?e:null}};Y.CAN_CONNECT=0,Y.REASON_SELF_CONNECTION=1,Y.REASON_WRONG_TYPE=2,Y.REASON_TARGET_NULL=3,Y.REASON_CHECKS_FAILED=4,Y.REASON_DIFFERENT_WORKSPACES=5,Y.REASON_SHADOW_PARENT=6,Y.REASON_DRAG_CHECKS_FAILED=7,Y.REASON_PREVIOUS_AND_OUTPUT=8;var ym=class extends Error{constructor(e){super(`Tried to append an icon of type ${e.getType()} when an icon of that type already exists on the block. Use getIcon to access the existing icon.`),this.icon=e}},Cm={};Cm.DuplicateIconType=ym,function(e){e[e.LEFT=-1]="LEFT",e[e.CENTRE=0]="CENTRE",e[e.RIGHT=1]="RIGHT"}(o.Align$$module$build$src$core$inputs$align||(o.Align$$module$build$src$core$inputs$align={}));var Di=class extends Q{constructor(e,t,i){super(Q.SKIP_SETUP),this.class=null,this.EDITABLE=!1,this.maxDisplayLength=1/0,e!==Q.SKIP_SETUP&&(i?this.configure_(i):this.class=t||null,this.setValue(e))}configure_(e){super.configure_(e),e.class&&(this.class=e.class)}initView(){this.createTextElement_(),this.class&&A(this.getTextElement(),this.class),this.fieldGroup_&&A(this.fieldGroup_,"blocklyLabelField")}doClassValidation_(e){return null==e?null:`${e}`}setClass(e){this.textElement_&&(this.class&&X(this.textElement_,this.class),e&&A(this.textElement_,e)),this.class=e}static fromJson(e){return new this(l(e.text),void 0,e)}};pt("field_label",Di),Di.prototype.DEFAULT_VALUE="";var Yo=[];Yo[N.INPUT_VALUE]=N.OUTPUT_VALUE,Yo[N.OUTPUT_VALUE]=N.INPUT_VALUE,Yo[N.NEXT_STATEMENT]=N.PREVIOUS_STATEMENT,Yo[N.PREVIOUS_STATEMENT]=N.NEXT_STATEMENT;var Yl="RENAME_VARIABLE_ID",Kl="DELETE_VARIABLE_ID",Le=class extends Y{constructor(e,t){super(e,t),this.highlighted=!1,this.targetConnection=null,this.db=e.workspace.connectionDBList[t],this.dbOpposite=e.workspace.connectionDBList[Yo[t]],this.offsetInBlock=new S(0,0),this.trackedState=Le.TrackedState.WILL_TRACK}dispose(){let e,t;super.dispose(),this.trackedState===Le.TrackedState.TRACKED&&this.db.removeConnection(this,this.y),null==(t=(e=this.sourceBlock_.pathObject).removeConnectionHighlight)||t.call(e,this)}getSourceBlock(){return super.getSourceBlock()}targetBlock(){return super.targetBlock()}distanceFrom(e){const t=this.x-e.x;return e=this.y-e.y,Math.sqrt(t*t+e*e)}bumpAwayFrom(e,t=!1){if(!this.sourceBlock_.workspace.isDragging()){var i=o.config$$module$build$src$core$config.snapRadius+Math.floor(10*Math.random()),s=o.config$$module$build$src$core$config.snapRadius+Math.floor(10*Math.random()),n=e.sourceBlock_.getRootBlock(),r=this.sourceBlock_.getRootBlock();if(!n.isInFlyout&&!r.isInFlyout){var a=!0;if(r.isMovable())n.isMovable()&&t&&(s=-s);else{if(!n.isMovable())return;a=!1,i=-i,s=-s}(n=a?r:n).RTL&&(i=-i),n.moveBy((t=a?e:this).x+i-(e=a?this:e).x,t.y+s-e.y,["bump"])}}}moveTo(e,t){let i=!1;return this.trackedState===Le.TrackedState.WILL_TRACK?(this.db.addConnection(this,t),this.trackedState=Le.TrackedState.TRACKED,i=!0):this.trackedState===Le.TrackedState.TRACKED&&(this.db.removeConnection(this,this.y),this.db.addConnection(this,t),i=!0),this.x=e,this.y=t,i}moveBy(e,t){return this.moveTo(this.x+e,this.y+t)}moveToOffset(e){return this.moveTo(e.x+this.offsetInBlock.x,e.y+this.offsetInBlock.y)}setOffsetInBlock(e,t){this.offsetInBlock.x=e,this.offsetInBlock.y=t}getOffsetInBlock(){return this.offsetInBlock}tightenEfficiently(){var e=this.targetConnection;const t=this.targetBlock();e&&t&&(e=S.difference(this.offsetInBlock,e.offsetInBlock),t.translate(e.x,e.y))}closest(e,t){return this.dbOpposite.searchForClosest(this,e,t)}highlight(){this.highlighted=!0;const e=this.findHighlightSvg();e&&(e.style.display="")}unhighlight(){this.highlighted=!1;const e=this.findHighlightSvg();e&&(e.style.display="none")}isHighlighted(){return this.highlighted}setTracking(e){e&&this.trackedState===Le.TrackedState.TRACKED||!e&&this.trackedState===Le.TrackedState.UNTRACKED||this.sourceBlock_.isInFlyout||(e?(this.db.addConnection(this,this.y),this.trackedState=Le.TrackedState.TRACKED):(this.trackedState===Le.TrackedState.TRACKED&&this.db.removeConnection(this,this.y),this.trackedState=Le.TrackedState.UNTRACKED))}stopTrackingAll(){if(this.setTracking(!1),this.targetConnection){const e=this.targetBlock().getDescendants(!1);for(let t=0;t<e.length;t++){const i=e[t],s=i.getConnections_(!0);for(let n=0;n<s.length;n++)s[n].setTracking(!1);for(const n of i.getIcons())Oo(n)&&n.setBubbleVisible(!1)}}}startTrackingAll(){this.setTracking(!0);let e=[];if(this.type!==N.INPUT_VALUE&&this.type!==N.NEXT_STATEMENT)return e;const t=this.targetBlock();if(t){let i;t.isCollapsed()?(i=[],t.outputConnection&&i.push(t.outputConnection),t.nextConnection&&i.push(t.nextConnection),t.previousConnection&&i.push(t.previousConnection)):i=t.getConnections_(!0);for(let s=0;s<i.length;s++)e.push(...i[s].startTrackingAll());e.length||(e=[t])}return e}onFailedConnect(e){const t=this.getSourceBlock();if(ke()){const i=o.getGroup$$module$build$src$core$events$utils();setTimeout(function(){t.isDisposed()||t.getParent()||(o.setGroup$$module$build$src$core$events$utils(i),this.bumpAwayFrom(e),o.setGroup$$module$build$src$core$events$utils(!1))}.bind(this),o.config$$module$build$src$core$config.bumpDelay)}}disconnectInternal(e=!0){const{parentConnection:t,childConnection:i}=this.getParentAndChildConnections();if(t&&i){var s=o.getGroup$$module$build$src$core$events$utils();s||o.setGroup$$module$build$src$core$events$utils(!0);var n=t.getSourceBlock(),r=i.getSourceBlock();super.disconnectInternal(e),n.queueRender(),r.updateDisabled(),r.queueRender(),r.getSvgRoot().style.display="block",o.setGroup$$module$build$src$core$events$utils(s)}}respawnShadow_(){super.respawnShadow_();const e=this.targetBlock();e&&(e.initSvg(),e.queueRender())}neighbours(e){return this.dbOpposite.getNeighbours(this,e)}connect_(e){super.connect_(e);var t=this.getSourceBlock();e=e.getSourceBlock(),t.updateDisabled(),e.updateDisabled(),e.queueRender(),(t=t.getInputWithBlock(e))&&(t=t.isVisible(),e.getSvgRoot().style.display=t?"block":"none")}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()}setCheck(e){return super.setCheck(e),this.sourceBlock_.queueRender(),this}showContextMenu(e){const t=W.registry.getContextMenuOptions({focusedNode:this},e);if(t.length){var i=this.getSourceBlock(),s=i.workspace;if(e instanceof PointerEvent)var n=new S(e.clientX,e.clientY);else n=new S(this.x,this.y),n=Ji(s,n).translate(i.RTL?-5:5,5);It(e,t,i.RTL,s,n)}}getFocusableElement(){const e=this.findHighlightSvg();if(e)return e;throw Error("No highlight SVG found corresponding to this connection.")}getFocusableTree(){return this.getSourceBlock().workspace}onNodeFocus(){this.highlight()}onNodeBlur(){this.unhighlight()}canBeFocused(){return!0}findHighlightSvg(){return document.getElementById(this.id)}};!function(e){(e=e.TrackedState||(e.TrackedState={}))[e.WILL_TRACK=-1]="WILL_TRACK",e[e.UNTRACKED=0]="UNTRACKED",e[e.TRACKED=1]="TRACKED"}(Le||(Le={}));var Bb=Le.TrackedState,km={};km.RenderedConnection=Le,km.TrackedState=Bb;var Os=class{constructor(e,t){this.name=e,this.sourceBlock=t,this.fieldRow=[],this.align=o.Align$$module$build$src$core$inputs$align.LEFT,this.visible=!0,this.type=o.inputTypes$$module$build$src$core$inputs$input_types.CUSTOM,this.connection=null}getSourceBlock(){return this.sourceBlock}appendField(e,t){return this.insertFieldAt(this.fieldRow.length,e,t),this}insertFieldAt(e,t,i){if(e<0||e>this.fieldRow.length)throw Error("index "+e+" out of bounds.");return(t||""===t&&i)&&("string"==typeof t&&(t=o.fromJson$$module$build$src$core$field_registry({type:"field_label",text:t})),t.setSourceBlock(this.sourceBlock),this.sourceBlock.initialized&&this.initField(t),t.name=i,t.setVisible(this.isVisible()),t.prefixField&&(e=this.insertFieldAt(e,t.prefixField)),this.fieldRow.splice(e,0,t),e++,t.suffixField&&(e=this.insertFieldAt(e,t.suffixField)),this.sourceBlock.rendered&&this.sourceBlock.queueRender()),e}removeField(e,t){for(let s,i=0;s=this.fieldRow[i];i++)if(s.name===e)return s.dispose(),this.fieldRow.splice(i,1),this.sourceBlock.rendered&&this.sourceBlock.queueRender(),!0;if(t)return!1;throw Error('Field "'+e+'" not found.')}isVisible(){return this.visible}setVisible(e){let t=[];if(this.visible===e)return t;this.visible=e;for(let s,i=0;s=this.fieldRow[i];i++)s.setVisible(e);if(this.connection&&this.connection instanceof Le){e?t=this.connection.startTrackingAll():this.connection.stopTrackingAll();const i=this.connection.targetBlock();i&&(i.getSvgRoot().style.display=e?"block":"none")}return t}markDirty(){for(let t,e=0;t=this.fieldRow[e];e++)t.markDirty()}setCheck(e){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setCheck(e),this}setAlign(e){return this.align=e,this.sourceBlock.rendered&&this.sourceBlock.queueRender(),this}setShadowDom(e){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setShadowDom(e),this}getShadowDom(){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.getShadowDom()}init(){for(const e of this.fieldRow)e.init()}initModel(){for(const e of this.fieldRow)e.initModel()}initField(e){this.sourceBlock.rendered?e.init():e.initModel()}dispose(){for(let t,e=0;t=this.fieldRow[e];e++)t.dispose();this.connection&&this.connection.dispose()}makeConnection(e){return this.sourceBlock.makeConnection_(e)}},Kt=class extends Os{constructor(e,t){super(e,t),this.name=e,this.type=o.inputTypes$$module$build$src$core$inputs$input_types.DUMMY}},$o=class extends Os{constructor(e,t){super(e,t),this.name=e,this.type=o.inputTypes$$module$build$src$core$inputs$input_types.END_ROW}},ut=class extends Os{constructor(e,t){if(!e)throw Error("Statement inputs must have a non-empty name");super(e,t),this.name=e,this.type=o.inputTypes$$module$build$src$core$inputs$input_types.STATEMENT,this.connection=this.makeConnection(N.NEXT_STATEMENT)}};o.ValueInput$$module$build$src$core$inputs$value_input=class extends Os{constructor(e,t){if(!e)throw Error("Value inputs must have a non-empty name");super(e,t),this.name=e,this.type=o.inputTypes$$module$build$src$core$inputs$input_types.VALUE,this.connection=this.makeConnection(N.INPUT_VALUE)}};var Ms=class{constructor(e,t,i){if(this.data=null,this.disposed=!1,this.hue=null,this.colour_="#000000",this.styleName_="",this.suppressPrefixSuffix=!1,this.previousConnection=this.nextConnection=this.outputConnection=null,this.inputList=[],this.icons=[],this.disabledReasons=new Set,this.tooltip="",this.contextMenu=!0,this.parentBlock_=null,this.childBlocks_=[],this.editable=this.movable=this.deletable=!0,this.collapsed_=this.shadow=!1,this.outputShape_=null,this.rendered=this.isInsertionMarker_=this.initialized=this.disposing=!1,this.onchangeWrapper=this.helpUrl=null,this.statementInputCount=0,this.workspace=e,this.id=i&&!e.getBlockById(i)?i:Te(),e.setBlockById(this.id,this),this.xy=new S(0,0),this.isInFlyout=e.isFlyout,this.isInMutator=e.isMutator,this.RTL=e.RTL,t){if(this.type=t,!(i=ue[t])||"object"!=typeof i)throw TypeError("Invalid block definition for type: "+t);Object.assign(this,i)}e.addTopBlock(this),e.addTypedBlock(this),new.target===Ms&&this.doInit_()}doInit_(){const e=o.getGroup$$module$build$src$core$events$utils();e||o.setGroup$$module$build$src$core$events$utils(!0);const t=ke();try{"function"==typeof this.init&&(o.setRecordUndo$$module$build$src$core$events$utils(!1),this.init(),o.setRecordUndo$$module$build$src$core$events$utils(t)),se()&&B(new(P(b.BLOCK_CREATE))(this))}finally{o.setGroup$$module$build$src$core$events$utils(e),o.setRecordUndo$$module$build$src$core$events$utils(t)}this.inputsInlineDefault=this.inputsInline,"function"==typeof this.onchange&&this.setOnChange(this.onchange)}dispose(e=!1){this.disposing=!0,this.onchangeWrapper&&this.workspace.removeChangeListener(this.onchangeWrapper),this.unplug(e),se()&&B(new(P(b.BLOCK_DELETE))(this)),this.workspace.removeTopBlock(this),this.disposeInternal()}disposeInternal(){this.disposing=!0,this.onchangeWrapper&&this.workspace.removeChangeListener(this.onchangeWrapper),this.workspace.removeTypedBlock(this),this.workspace.removeBlockById(this.id),"function"==typeof this.destroy&&this.destroy(),this.childBlocks_.forEach(e=>e.disposeInternal()),this.inputList.forEach(e=>e.dispose()),this.inputList.length=0,this.getConnections_(!0).forEach(e=>e.dispose()),this.disposed=!0}isDeadOrDying(){return this.disposing||this.disposed}initModel(){if(!this.initialized){for(const e of this.inputList)e.initModel();this.initialized=!0}}unplug(e){this.outputConnection&&this.unplugFromRow(e),this.previousConnection&&this.unplugFromStack(e)}unplugFromRow(e){let i,t=null;null!=(i=this.outputConnection)&&i.isConnected()&&(t=this.outputConnection.targetConnection,this.outputConnection.disconnect()),t&&e&&(e=this.getOnlyValueConnection())&&e.isConnected()&&!e.targetBlock().isShadow()&&(e=e.targetConnection,e?.disconnect(),this.workspace.connectionChecker.canConnect(e,t,!1)?t.connect(e):e?.onFailedConnect(t))}getOnlyValueConnection(){let e=null;for(let t=0;t<this.inputList.length;t++){const i=this.inputList[t].connection;if(i&&i.type===N.INPUT_VALUE&&i.targetConnection){if(e)return null;e=i}}return e}unplugFromStack(e){let t=null;var i;if(null!=(i=this.previousConnection)&&i.isConnected()&&(t=this.previousConnection.targetConnection,this.previousConnection.disconnect()),i=this.getNextBlock(),e&&i&&!i.isShadow()){let s,n;e=null!=(n=null==(s=this.nextConnection)?void 0:s.targetConnection)?n:null,e?.disconnect(),t&&this.workspace.connectionChecker.canConnect(t,e,!1)&&t.connect(e)}}getConnections_(e){e=[],this.outputConnection&&e.push(this.outputConnection),this.previousConnection&&e.push(this.previousConnection),this.nextConnection&&e.push(this.nextConnection);for(let i,t=0;i=this.inputList[t];t++)i.connection&&e.push(i.connection);return e}lastConnectionInStack(e){let t=this.nextConnection;for(;t;){const i=t.targetBlock();if(!i||e&&i.isShadow())return t;t=i.nextConnection}return null}bumpNeighbours(){}getParent(){return this.parentBlock_}getInputWithBlock(e){for(let i,t=0;i=this.inputList[t];t++)if(i.connection&&i.connection.targetBlock()===e)return i;return null}getSurroundParent(){let t,e=this;do{if(t=e,e=e.getParent(),!e)return null}while(e.getNextBlock()===t);return e}getNextBlock(){return this.nextConnection&&this.nextConnection.targetBlock()}getPreviousBlock(){return this.previousConnection&&this.previousConnection.targetBlock()}getRootBlock(){let e,t=this;do{e=t,t=e.parentBlock_}while(t);return e}getTopStackBlock(){let t,e=this;do{t=e.getPreviousBlock()}while(t&&t.getNextBlock()===e&&(e=t));return e}getChildren(e){if(!e)return this.childBlocks_;e=[];for(let s,i=0;s=this.inputList[i];i++)if(s.connection){var t=s.connection.targetBlock();t&&e.push(t)}return(t=this.getNextBlock())&&e.push(t),e}setParent(e){if(e!==this.parentBlock_){var t=this.previousConnection&&this.previousConnection.targetBlock()||this.outputConnection&&this.outputConnection.targetBlock(),i=!!t;if(i&&e&&t!==e)throw Error("Block connected to superior one that is not new parent.");if(!i&&e)throw Error("Block not connected to new parent.");if(i&&!e)throw Error("Cannot set parent to null while block is still connected to superior block.");this.parentBlock_?nt(this.parentBlock_.childBlocks_,this):this.workspace.removeTopBlock(this),(this.parentBlock_=e)?e.childBlocks_.push(this):this.workspace.addTopBlock(this)}}getDescendants(e){const t=[this],i=this.getChildren(e);for(let s,n=0;s=i[n];n++)t.push(...s.getDescendants(e));return t}isDeletable(){return this.deletable&&!this.isInFlyout&&!this.shadow&&!this.isDeadOrDying()&&!this.workspace.isReadOnly()}isOwnDeletable(){return this.deletable}setDeletable(e){this.deletable=e}isMovable(){return this.movable&&!this.isInFlyout&&!this.shadow&&!this.isDeadOrDying()&&!this.workspace.isReadOnly()}isOwnMovable(){return this.movable}setMovable(e){this.movable=e}isDuplicatable(){return!this.workspace.hasBlockLimits()||this.workspace.isCapacityAvailable(on(this,!0))}isShadow(){return this.shadow}setShadow(e){this.shadow=e}isInsertionMarker(){return this.isInsertionMarker_}setInsertionMarker(e){this.isInsertionMarker_=e}isEditable(){return this.editable&&!this.isDeadOrDying()&&!this.workspace.isReadOnly()}isOwnEditable(){return this.editable}setEditable(e){this.editable=e;for(const t of this.getFields())t.updateEditable()}isDisposed(){return this.disposed}isSimpleReporter(){if(!this.outputConnection)return!1;for(const e of this.inputList)if(e.connection||e.fieldRow.length>1)return!1;return!0}getMatchingConnection(e,t){const i=this.getConnections_(!0);if(e=e.getConnections_(!0),i.length!==e.length)throw Error("Connection lists did not match in length.");for(let s=0;s<e.length;s++)if(e[s]===t)return i[s];return null}setHelpUrl(e){this.helpUrl=e}setTooltip(e){this.tooltip=e}getTooltip(){return $i(this)}getColour(){return this.colour_}getStyleName(){return this.styleName_}getHue(){return this.hue}setColour(e){e=d(e),this.hue=e.hue,this.colour_=e.hex}setStyle(e){this.styleName_=e}setOnChange(e){if(e&&"function"!=typeof e)throw Error("onchange must be a function.");this.onchangeWrapper&&this.workspace.removeChangeListener(this.onchangeWrapper),this.onchange=e,this.onchangeWrapper=e.bind(this),this.workspace.addChangeListener(this.onchangeWrapper)}getField(e){if("string"!=typeof e)throw TypeError("Block.prototype.getField expects a string with the field name but received "+(void 0===e?"nothing":e+" of type "+typeof e)+" instead");for(const t of this.getFields())if(t.name===e)return t;return null}*getFields(){for(const e of this.inputList)for(const t of e.fieldRow)yield t}getVars(){const e=[];for(const t of this.getFields())t.referencesVariables()&&e.push(t.getValue());return e}getVarModels(){const e=[];for(const t of this.getFields())if(t.referencesVariables()){const i=this.workspace.getVariableById(t.getValue());i&&e.push(i)}return e}updateVarName(e){for(const t of this.getFields())t.referencesVariables()&&e.getId()===t.getValue()&&t.refreshVariableName()}renameVarById(e,t){for(const i of this.getFields())i.referencesVariables()&&e===i.getValue()&&i.setValue(t)}getFieldValue(e){return(e=this.getField(e))?e.getValue():null}setFieldValue(e,t){const i=this.getField(t);if(!i)throw Error('Field "'+t+'" not found.');i.setValue(e)}setPreviousStatement(e,t){if(e)void 0===t&&(t=null),this.previousConnection||(this.previousConnection=this.makeConnection_(N.PREVIOUS_STATEMENT)),this.previousConnection.setCheck(t);else if(this.previousConnection){if(this.previousConnection.isConnected())throw Error("Must disconnect previous statement before removing connection.");this.previousConnection.dispose(),this.previousConnection=null}}setNextStatement(e,t){if(e)void 0===t&&(t=null),this.nextConnection||(this.nextConnection=this.makeConnection_(N.NEXT_STATEMENT)),this.nextConnection.setCheck(t);else if(this.nextConnection){if(this.nextConnection.isConnected())throw Error("Must disconnect next statement before removing connection.");this.nextConnection.dispose(),this.nextConnection=null}}setOutput(e,t){if(e)void 0===t&&(t=null),this.outputConnection||(this.outputConnection=this.makeConnection_(N.OUTPUT_VALUE)),this.outputConnection.setCheck(t);else if(this.outputConnection){if(this.outputConnection.isConnected())throw Error("Must disconnect output value before removing connection.");this.outputConnection.dispose(),this.outputConnection=null}}setInputsInline(e){this.inputsInline!==e&&(B(new(P(b.BLOCK_CHANGE))(this,"inline",null,this.inputsInline,e)),this.inputsInline=e)}getInputsInline(){if(void 0!==this.inputsInline)return this.inputsInline;for(var e=1;e<this.inputList.length;e++)if(this.inputList[e-1]instanceof Kt&&this.inputList[e]instanceof Kt)return!1;for(e=1;e<this.inputList.length;e++)if(this.inputList[e-1]instanceof o.ValueInput$$module$build$src$core$inputs$value_input&&this.inputList[e]instanceof Kt)return!0;for(e=0;e<this.inputList.length;e++)if(this.inputList[e]instanceof $o)return!0;return!1}setOutputShape(e){this.outputShape_=e}getOutputShape(){return this.outputShape_}isEnabled(){return 0===this.disabledReasons.size}setDisabledReason(e,t){e||this.workspace.options.disable||!this.hasDisabledReason(xt)||t==xt||this.setDisabledReason(!1,xt),this.disabledReasons.has(t)!==e&&(e?this.disabledReasons.add(t):this.disabledReasons.delete(t),(e=new(P(b.BLOCK_CHANGE))(this,"disabled",null,!e,e)).setDisabledReason(t),B(e))}getInheritedDisabled(){let e=this.getSurroundParent();for(;e;){if(!e.isEnabled())return!0;e=e.getSurroundParent()}return!1}hasDisabledReason(e){return this.disabledReasons.has(e)}getDisabledReasons(){return this.disabledReasons}isCollapsed(){return this.collapsed_}setCollapsed(e){this.collapsed_!==e&&(B(new(P(b.BLOCK_CHANGE))(this,"collapsed",null,this.collapsed_,e)),this.collapsed_=e)}toString(e,t){t=this.toTokens(t);for(let s=2;s<t.length;s++)"("===t[s-2]&&")"===t[s]&&(t[s-2]=t[s-1],t.splice(s-1,2));let i="";return t=(t=t.reduce((s,n)=>(s=s+("("===i||")"===n?"":" ")+n,i=n[n.length-1],s),"")).trim()||"???",e&&t.length>e&&(t=t.substring(0,e-3)+"..."),t}toTokens(e="?"){const t=[];for(const s of this.inputList)if(s.name!=Bn){for(const n of s.fieldRow)t.push(n.getText());if(s.connection){const n=s.connection.targetBlock();if(n){var i=s.connection;let r=i.getCheck();!r&&i.targetConnection&&(r=i.targetConnection.getCheck()),(i=!!r&&(r.includes("Boolean")||r.includes("Number")))&&t.push("("),t.push(...n.toTokens(e)),i&&t.push(")")}else t.push(e)}}return t}appendValueInput(e){return this.appendInput(new o.ValueInput$$module$build$src$core$inputs$value_input(e,this))}appendStatementInput(e){return this.statementInputCount++,this.appendInput(new ut(e,this))}appendDummyInput(e=""){return this.appendInput(new Kt(e,this))}appendEndRowInput(e=""){return this.appendInput(new $o(e,this))}appendInput(e){return this.inputList.push(e),e}appendInputFromRegistry(e,t){return(e=tt(k.INPUT,e,!1))?this.appendInput(new e(t,this)):null}jsonInit(e){var t=e.type?'Block "'+e.type+'": ':"";if(e.output&&e.previousStatement)throw Error(t+"Must not have both an output and a previousStatement.");for(var i=0;e["args"+i];){if(void 0===e["message"+i])throw Error(t+`args${i} must have a corresponding message (message${i}).`);i++}if(e.style&&e.style.hat&&(this.hat=e.style.hat,e.style=null),e.style&&e.colour)throw Error(t+"Must not have both a colour and a style.");for(e.style?this.jsonInitStyle(e,t):this.jsonInitColour(e,t),i=0;void 0!==e["message"+i];)this.interpolate(e["message"+i],e["args"+i]||[],e["implicitAlign"+i]||e["lastDummyAlign"+i],t),i++;if(void 0!==e.inputsInline&&(o.disable$$module$build$src$core$events$utils(),this.setInputsInline(e.inputsInline),o.enable$$module$build$src$core$events$utils()),void 0!==e.output&&this.setOutput(!0,e.output),void 0!==e.outputShape&&this.setOutputShape(e.outputShape),void 0!==e.previousStatement&&this.setPreviousStatement(!0,e.previousStatement),void 0!==e.nextStatement&&this.setNextStatement(!0,e.nextStatement),void 0!==e.tooltip&&(i=l(e.tooltip),this.setTooltip(i)),void 0!==e.enableContextMenu&&(this.contextMenu=!!e.enableContextMenu),void 0!==e.suppressPrefixSuffix&&(this.suppressPrefixSuffix=!!e.suppressPrefixSuffix),void 0!==e.helpUrl&&(i=l(e.helpUrl),this.setHelpUrl(i)),"string"==typeof e.extensions&&(console.warn(t+"JSON attribute 'extensions' should be an array of strings. Found raw string in JSON for '"+e.type+"' block."),e.extensions=[e.extensions]),void 0!==e.mutator&&$s(e.mutator,this,!0),e=e.extensions,Array.isArray(e))for(t=0;t<e.length;t++)$s(e[t],this,!1)}jsonInitColour(e,t){if("colour"in e)if(void 0===e.colour)console.warn(t+"Undefined colour value.");else{e=e.colour;try{this.setColour(e)}catch{console.warn(t+"Illegal colour value: ",e)}}}jsonInitStyle(e,t){e=e.style;try{this.setStyle(e)}catch{console.warn(t+"Style does not exist: ",e)}}mixin(e,t){if(void 0!==t&&"boolean"!=typeof t)throw Error("opt_disableCheck must be a boolean if provided");if(!t){t=[];for(const i in e)void 0!==this[i]&&t.push(i);if(t.length)throw Error("Mixin will overwrite block members: "+JSON.stringify(t))}Object.assign(this,e)}interpolate(e,t,i,s){e=x(e),this.validateTokens(e,t.length),t=this.interpolateArguments(e,t,i),i=[];for(let r,n=0;r=t[n];n++)if(this.isInputKeyword(r.type)){if(e=this.inputFromJson(r,s)){for(let $,a=0;$=i[a];a++)e.appendField($[0],$[1]);i.length=0}}else(e=this.fieldFromJson(r))&&i.push([e,r.name])}validateTokens(e,t){const i=[];let s=0;for(let n=0;n<e.length;n++){const r=e[n];if("number"==typeof r){if(r<1||r>t)throw Error('Block "'+this.type+'": Message index %'+r+" out of range.");if(i[r])throw Error('Block "'+this.type+'": Message index %'+r+" duplicated.");i[r]=!0,s++}}if(s!==t)throw Error('Block "'+this.type+'": Message does not reference all '+t+" arg(s).")}interpolateArguments(e,t,i){const s=[];for(let r=0;r<e.length;r++){var n=e[r];if("number"==typeof n&&(n=t[n-1]),"string"==typeof n)if("\n"===n)n={type:"input_end_row"},i&&(n.align=i);else if(!(n=this.stringToFieldJson(n)))continue;s.push(n)}return(e=s.length)&&!this.isInputKeyword(s[e-1].type)&&(e={type:"input_dummy"},i&&(e.align=i),s.push(e)),s}fieldFromJson(e){const t=o.fromJson$$module$build$src$core$field_registry(e);return!t&&e.alt?"string"==typeof e.alt?(e=this.stringToFieldJson(e.alt))?this.fieldFromJson(e):null:this.fieldFromJson(e.alt):t}inputFromJson(e,t){var i={LEFT:o.Align$$module$build$src$core$inputs$align.LEFT,RIGHT:o.Align$$module$build$src$core$inputs$align.RIGHT,CENTRE:o.Align$$module$build$src$core$inputs$align.CENTRE,CENTER:o.Align$$module$build$src$core$inputs$align.CENTRE};let s;switch(e.type){case"input_value":s=this.appendValueInput(e.name);break;case"input_statement":s=this.appendStatementInput(e.name);break;case"input_dummy":s=this.appendDummyInput(e.name);break;case"input_end_row":s=this.appendEndRowInput(e.name);break;default:s=this.appendInputFromRegistry(e.type,e.name)}return s?(e.check&&s.setCheck(e.check),e.align&&(void 0===(i=i[e.align.toUpperCase()])?console.warn(t+"Illegal align value: ",e.align):s.setAlign(i)),s):null}isInputKeyword(e){return"input_value"===e||"input_statement"===e||"input_dummy"===e||"input_end_row"===e||ti(k.INPUT,e)}stringToFieldJson(e){return(e=e.trim())?{type:"field_label",text:e}:null}moveInputBefore(e,t){if(e!==t){var i=-1,s=t?-1:this.inputList.length;for(let r,n=0;r=this.inputList[n];n++)if(r.name===e){if(i=n,-1!==s)break}else if(t&&r.name===t&&(s=n,-1!==i))break;if(-1===i)throw Error('Named input "'+e+'" not found.');if(-1===s)throw Error('Reference input "'+t+'" not found.');this.moveNumberedInputBefore(i,s)}}moveNumberedInputBefore(e,t){if(e===t)throw Error("Can't move input to itself.");if(e>=this.inputList.length)throw RangeError("Input index "+e+" out of bounds.");if(t>this.inputList.length)throw RangeError("Reference input "+t+" out of bounds.");const i=this.inputList[e];this.inputList.splice(e,1),e<t&&t--,this.inputList.splice(t,0,i)}removeInput(e,t){for(let s,i=0;s=this.inputList[i];i++)if(s.name===e)return s instanceof ut&&this.statementInputCount--,s.dispose(),this.inputList.splice(i,1),!0;if(t)return!1;throw Error("Input not found: "+e)}getInput(e){for(let i,t=0;i=this.inputList[t];t++)if(i.name===e)return i;return null}getInputTargetBlock(e){return(e=this.getInput(e))&&e.connection&&e.connection.targetBlock()}getCommentText(){let e,t;return null!=(t=null==(e=this.getIcon(Ce.COMMENT))?void 0:e.getText())?t:null}setCommentText(e){var t;let i;const s=null!=(i=null==(t=this.getIcon(Ce.COMMENT))?void 0:t.getText())?i:null;if(s!==e){if(null!==e){if(!(t=this.getIcon(Ce.COMMENT))){if(!(t=tt(k.ICON,Ce.COMMENT.toString(),!1)))throw Error("No comment icon class is registered, so a comment cannot be set");if(t=new t(this),!wt(t))throw Error("The class registered as a comment icon does not conform to the ICommentIcon interface");t=this.addIcon(t)}o.disable$$module$build$src$core$events$utils(),t.setText(e),o.enable$$module$build$src$core$events$utils()}else this.removeIcon(Ce.COMMENT);B(new(P(b.BLOCK_CHANGE))(this,"comment",null,s,e))}}setWarningText(e,t){}setMutator(e){}addIcon(e){if(this.hasIcon(e.getType()))throw new ym(e);return this.icons.push(e),this.icons.sort((t,i)=>t.getWeight()-i.getWeight()),e}removeIcon(e){if(!this.hasIcon(e))return!1;let t;return null==(t=this.getIcon(e))||t.dispose(),this.icons=this.icons.filter(i=>!i.getType().equals(e)),!0}hasIcon(e){return this.icons.some(t=>t.getType().equals(e))}getIcon(e){return this.icons.find(e instanceof Ce?t=>t.getType().equals(e):t=>t.getType().toString()===e)}getIcons(){return[...this.icons]}getRelativeToSurfaceXY(){return this.xy}moveBy(e,t,i){if(this.parentBlock_)throw Error("Block has parent");const s=new(P(b.BLOCK_MOVE))(this);i&&s.setReason(i),this.xy.translate(e,t),s.recordNew(),B(s)}makeConnection_(e){return new Y(this,e)}allInputsFilled(e){if(void 0===e&&(e=!0),!e&&this.isShadow())return!1;for(let s,i=0;s=this.inputList[i];i++)if(s.connection){var t=s.connection.targetBlock();if(!t||!t.allInputsFilled(e))return!1}return!(t=this.getNextBlock())||t.allInputsFilled(e)}toDevString(){let e=this.type?'"'+this.type+'" block':"Block";return this.id&&(e+=' (id="'+this.id+'")'),e}};Ms.COLLAPSED_INPUT_NAME=Bn,Ms.COLLAPSED_FIELD_NAME=Pl;var nu=null,Jl=null,Ql={};Ql.connectionUiEffect=fs,Ql.disconnectUiEffect=Rn,Ql.disconnectUiStop=ho,Ql.disposeUiEffect=bs;var jn=class{paste(e,t,i){if(!t.isCapacityAvailable(e.typeCounts))return null;let s;i&&(e.blockState.x=i.x,e.blockState.y=i.y),i=i||new S(e.blockState.x||0,e.blockState.y||0),o.disable$$module$build$src$core$events$utils();try{s=Ro(e.blockState,t),$l(s,i)}finally{o.enable$$module$build$src$core$events$utils()}if(!s)return s;se()&&!s.isShadow()&&B(new(P(b.BLOCK_CREATE))(s));const n=s;return Ht().then(()=>o.getFocusManager$$module$build$src$core$focus_manager().focusNode(n)),s}};jn.TYPE="block",gr(jn.TYPE,new jn);var wm={};wm.BlockPaster=jn,wm.moveBlockToNotConflict=$l;var ru={};ru.bumpIntoBounds=Uo,ru.bumpIntoBoundsHandler=On,ru.bumpTopObjectsIntoBounds=Mn;var vp=class{constructor(e){this.block=e,this.connectionPreviewer=this.connectionCandidate=this.startLoc=this.startChildConn=this.startParentConn=null,this.dragging=!1,this.dragOffset=new S(0,0),this.originalEventGroup="",this.workspace=e.workspace}isMovable(){if(this.block.isShadow()){let e,t;return null!=(t=null==(e=this.block.getParent())?void 0:e.isMovable())&&t}return this.block.isOwnMovable()&&!this.block.isDeadOrDying()&&!this.workspace.isReadOnly()&&!this.block.isInFlyout}startDrag(e){var t;this.block.isShadow()?this.startDraggingShadow(e):(this.dragging=!0,this.fireDragStartEvent(),this.startLoc=this.block.getRelativeToSurfaceXY(),this.connectionCandidate=null,this.connectionPreviewer=new(xe(k.CONNECTION_PREVIEWER,this.workspace.options))(this.block),_(),this.workspace.setResizesEnabled(!1),ho(),e=this.shouldHealStack(e),this.shouldDisconnect(e)&&this.disconnectBlock(e),this.block.setDragging(!0),null==(t=this.workspace.getLayerManager())||t.moveToDragLayer(this.block))}shouldHealStack(e){return!!e&&(e.altKey||e.ctrlKey||e.metaKey)}startDraggingShadow(e){const t=this.block.getParent();if(!t)throw Error("Tried to drag a shadow block with no parent. Shadow blocks should always have parents.");this.dragOffset=S.difference(t.getRelativeToSurfaceXY(),this.block.getRelativeToSurfaceXY()),t.startDrag(e)}shouldDisconnect(e){return!!(this.block.getParent()||e&&this.block.nextConnection&&this.block.nextConnection.targetBlock())}disconnectBlock(e){let t,i,s;if(this.startParentConn=null!=(s=null==(t=this.block.outputConnection)?void 0:t.targetConnection)?s:null==(i=this.block.previousConnection)?void 0:i.targetConnection,e){let n;this.startChildConn=null==(n=this.block.nextConnection)?void 0:n.targetConnection}this.block.unplug(e),Rn(this.block)}fireDragStartEvent(){const e=new(P(b.BLOCK_DRAG))(this.block,!0,this.block.getDescendants(!1));B(e)}fireDragEndEvent(){const e=new(P(b.BLOCK_DRAG))(this.block,!1,this.block.getDescendants(!1));B(e)}fireMoveEvent(){if(!this.block.isDeadOrDying()){var e=new(P(b.BLOCK_MOVE))(this.block);e.setReason(["drag"]),e.oldCoordinate=this.startLoc,e.recordNew(),B(e)}}drag(e){if(this.block.isShadow()){let t;null==(t=this.block.getParent())||t.drag(S.sum(e,this.dragOffset))}else this.block.moveDuringDrag(e),this.updateConnectionPreview(this.block,S.difference(e,this.startLoc))}updateConnectionPreview(e,t){var i=this.connectionCandidate;const s=this.getConnectionCandidate(e,t);if(s){this.connectionCandidate=t=i&&this.currCandidateIsBetter(i,t,s)?i:s;var a,{local:n,neighbour:r}=t;if(t=n.type===N.OUTPUT_VALUE||n.type===N.PREVIOUS_STATEMENT,i=r.isConnected()&&!(null!=(a=r.targetBlock())&&a.isInsertionMarker()),t&&i&&!this.orphanCanConnectAtEnd(e,r.targetBlock(),n.type)){let C;null==(C=this.connectionPreviewer)||C.previewReplacement(n,r,r.targetBlock())}else{var $;null==($=this.connectionPreviewer)||$.previewConnection(n,r)}}else{let C;null==(C=this.connectionPreviewer)||C.hidePreview(),this.connectionCandidate=null}}orphanCanConnectAtEnd(e,t,i){return!!Y.getConnectionForOrphanedConnection(e,i===N.OUTPUT_VALUE?t.outputConnection:t.previousConnection)}currCandidateIsBetter(e,t,i){const{local:s,neighbour:n}=e;e=new S(s.x,s.y);const r=new S(n.x,n.y);return t=S.distance(S.sum(e,t),r),i.distance>t-o.config$$module$build$src$core$config.currentConnectionPreference}getConnectionCandidate(e,t){e=this.getLocalConnections(e);let i=this.getSearchRadius(),s=null;for(const n of e){const{connection:r,radius:a}=n.closest(i,t);r&&(s={local:n,neighbour:r,distance:a},i=a)}return s}getSearchRadius(){return this.connectionCandidate?o.config$$module$build$src$core$config.connectingSnapRadius:o.config$$module$build$src$core$config.snapRadius}getLocalConnections(e){const t=e.getConnections_(!1),i=e.lastConnectionInStack(!0);return i&&i!==e.nextConnection&&t.push(i),t}endDrag(e){if(this.block.isShadow()){let i;null==(i=this.block.getParent())||i.endDrag(e)}else{var t;if(this.originalEventGroup=o.getGroup$$module$build$src$core$events$utils(),this.fireDragEndEvent(),this.fireMoveEvent(),T(),ho(),null==(t=this.connectionPreviewer)||t.hidePreview(),!this.block.isDeadOrDying()&&this.dragging){let i;null==(i=this.workspace.getLayerManager())||i.moveOffDragLayer(this.block,50),this.block.setDragging(!1)}this.connectionCandidate?(this.applyConnections(this.connectionCandidate),this.disposeStep()):this.block.queueRender().then(()=>this.disposeStep())}}disposeStep(){const e=o.getGroup$$module$build$src$core$events$utils();let t;o.setGroup$$module$build$src$core$events$utils(this.originalEventGroup),this.block.snapToGrid(),null==(t=this.connectionPreviewer)||t.dispose(),this.workspace.setResizesEnabled(!0),o.setGroup$$module$build$src$core$events$utils(e)}applyConnections(e){const{local:t,neighbour:i}=e;t.connect(i);const s=t.isSuperior()?i:t,n=this.block.getRootBlock();Ht().then(()=>{fs(s.getSourceBlock()),setTimeout(()=>{n.bringToFront()},0)})}revertDrag(){if(this.block.isShadow()){let i;null==(i=this.block.getParent())||i.revertDrag()}else{var e,t;if(null==(e=this.connectionPreviewer)||e.hidePreview(),this.connectionCandidate=null,null==(t=this.startChildConn)||t.connect(this.block.nextConnection),this.startParentConn)switch(this.startParentConn.type){case N.INPUT_VALUE:this.startParentConn.connect(this.block.outputConnection);break;case N.NEXT_STATEMENT:this.startParentConn.connect(this.block.previousConnection)}else{let i;this.block.moveTo(this.startLoc,["drag"]),null==(i=this.workspace.getLayerManager())||i.moveOffDragLayer(this.block,50),Uo(this.workspace,this.workspace.getMetricsManager().getScrollMetrics(!0),this.block)}this.startParentConn=this.startChildConn=null,this.block.setDragging(!1),this.dragging=!1}}},yp=class extends ee{constructor(e,t,i,s){super(t,i,s),this.text=e,this.workspace=t,this.anchor=i,this.ownerRect=s,this.paragraph=this.stringToSvg(e,this.contentContainer),this.updateBubbleSize(),A(this.svgRoot,"blocklyTextBubble")}getText(){return this.text}setText(e){this.text=e,J(this.paragraph),this.paragraph=this.stringToSvg(e,this.contentContainer),this.updateBubbleSize()}stringToSvg(e,t){return t=this.createParagraph(t),e=this.createTextFragments(t,e),this.workspace.RTL&&this.rightAlignTextFragments(t.getBBox().width,e),t}createParagraph(e){return I(f.G,{class:"blocklyText blocklyBubbleText blocklyNoPointerEvents",transform:`translate(0,${ee.BORDER_WIDTH})`,style:"direction: "+(this.workspace.RTL?"rtl":"ltr")},e)}createTextFragments(e,t){let i=1;return t.split("\n").map(s=>{const n=I(f.TEXT,{y:`${i}em`,x:ee.BORDER_WIDTH},e);return s=document.createTextNode(s),n.appendChild(s),i+=1,n})}rightAlignTextFragments(e,t){for(const i of t)i.setAttribute("text-anchor","start"),i.setAttribute("x",`${e+ee.BORDER_WIDTH}`)}updateBubbleSize(){const e=this.paragraph.getBBox();this.setSize(new j(e.width+2*ee.BORDER_WIDTH,e.height+2*ee.BORDER_WIDTH),!0)}},Jt=class extends qn{constructor(e){super(e),this.sourceBlock=e,this.textMap=new Map,this.textBubble=null}getType(){return Jt.TYPE}initView(e){this.svgRoot||(super.initView(e),I(f.PATH,{class:"blocklyIconShape",d:"M2,15Q-1,15 0.5,12L6.5,1.7Q8,-1 9.5,1.7L15.5,12Q17,15 14,15z"},this.svgRoot),I(f.PATH,{class:"blocklyIconSymbol",d:"m7,4.8v3.16l0.27,2.27h1.46l0.27,-2.27v-3.16z"},this.svgRoot),I(f.RECT,{class:"blocklyIconSymbol",x:"7",y:"11",height:"2",width:"2"},this.svgRoot),A(this.svgRoot,"blocklyWarningIcon"))}dispose(){let e;super.dispose(),null==(e=this.textBubble)||e.dispose()}getWeight(){return Jt.WEIGHT}getSize(){return new j(17,17)}applyColour(){let e;super.applyColour(),null==(e=this.textBubble)||e.setColour(this.sourceBlock.getColour())}updateCollapsed(){}isShownWhenCollapsed(){return!0}onLocationChange(e){let t;super.onLocationChange(e),null==(t=this.textBubble)||t.setAnchorLocation(this.getAnchorLocation())}addMessage(e,t){if(this.textMap.get(t)===e)return this;let i;return e?this.textMap.set(t,e):this.textMap.delete(t),null==(i=this.textBubble)||i.setText(this.getText()),this}getText(){return[...this.textMap.values()].join("\n")}onClick(){super.onClick(),this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}bubbleIsVisible(){return!!this.textBubble}setBubbleVisible(e){const t=this;return(0,y.asyncExecutePromiseGeneratorFunction)(function*(){if(t.bubbleIsVisible()!==e){if(yield Ht(),e)t.textBubble=new yp(t.getText(),t.sourceBlock.workspace,t.getAnchorLocation(),t.getBubbleOwnerRect()),t.applyColour();else{let i;null==(i=t.textBubble)||i.dispose(),t.textBubble=null}B(new(P(b.BUBBLE_OPEN))(t.sourceBlock,e,"warning"))}})}getBubble(){return this.textBubble}getAnchorLocation(){return S.sum(this.workspaceLocation,new S(8.5,8.5))}getBubbleOwnerRect(){const e=this.sourceBlock.getSvgRoot().getBBox();return new z(e.y,e.y+e.height,e.x,e.x+e.width)}};Jt.TYPE=Ce.WARNING,Jt.WEIGHT=2;var ie=class extends Ms{constructor(e,t,i){if(super(e,t,i),this.childlessWidth=this.width=this.height=0,this.warningTextDb=new Map,this.mutator=null,this.rendered=!0,this.visuallyDisabled=!1,this.translation="",this.dragging=!1,this.relativeCoords=new S(0,0),this.dragStrategy=new vp(this),!e.rendered)throw TypeError("Cannot create a rendered block in a headless workspace");this.workspace=e,this.svgGroup=I(f.G,{}),t&&A(this.svgGroup,t),this.style=e.getRenderer().getConstants().getBlockStyle(null),this.pathObject=e.getRenderer().makePathObject(this.svgGroup,this.style),(e=this.pathObject.svgPath).tooltip=this,cs(e),this.svgGroup.setAttribute("data-id",this.id),e.id=ze(),this.doInit_()}initSvg(){if(!this.initialized){for(var e of this.inputList)e.init();for(const t of this.getIcons())t.initView(this.createIconPointerDownListener(t)),t.updateEditable();this.applyColour(),this.pathObject.updateMovable(this.isMovable()||this.isInFlyout),(e=this.getSvgRoot())&&L(e,"pointerdown",this,this.onMouseDown),e.parentNode||this.workspace.getCanvas().appendChild(e),this.initialized=!0}}getColourSecondary(){return this.style.colourSecondary}getColourTertiary(){return this.style.colourTertiary}select(){this.addSelect(),So(this)}unselect(){this.removeSelect(),So(null)}setParent(e){var t=this.parentBlock_;if(e!==t){_(),super.setParent(e),T();var i=this.getSvgRoot();if(!this.workspace.isClearing&&i){var r,s=this.getRelativeToSurfaceXY(),n=o.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode(),a=this.getSvgRoot().contains(null!=(r=n?.getFocusableElement())?r:null);e?(e.getSvgRoot().appendChild(i),a&&n&&o.getFocusManager$$module$build$src$core$focus_manager().focusNode(n)):t&&(e=this.workspace.getCanvas().querySelector(".blocklyDragging"),t=e?.parentElement,t===(r=this.workspace.getCanvas())?r.insertBefore(i,e):(r.appendChild(i),a&&n&&o.getFocusManager$$module$build$src$core$focus_manager().focusNode(n)),this.translate(s.x,s.y)),this.applyColour()}}}getRelativeToSurfaceXY(){const e=this.workspace.getLayerManager();if(!e)throw Error("Cannot calculate position because the workspace has not been appended");let t=0,i=0,s=this.getSvgRoot();if(s)do{const n=rn(s);t+=n.x,i+=n.y,s=s.parentNode}while(s&&!e.hasLayer(s));return new S(t,i)}moveBy(e,t,i){if(this.parentBlock_)throw Error("Block has parent");const s=se();let n=null;s&&(n=new(P(b.BLOCK_MOVE))(this),i&&n.setReason(i)),e=new S(e,t),t=this.getRelativeToSurfaceXY(),e=S.sum(t,e),this.translate(e.x,e.y),this.updateComponentLocations(e),s&&n&&(n.recordNew(),B(n)),this.workspace.resizeContents()}translate(e,t){this.translation=`translate(${e}, ${t})`,this.relativeCoords=new S(e,t),this.getSvgRoot().setAttribute("transform",this.getTranslation())}getTranslation(){return this.translation}moveTo(e,t){const i=this.getRelativeToSurfaceXY();this.moveBy(e.x-i.x,e.y-i.y,t)}moveDuringDrag(e){this.translate(e.x,e.y),this.getSvgRoot().setAttribute("transform",this.getTranslation()),this.updateComponentLocations(e)}snapToGrid(){if(!this.isDeadOrDying()&&!this.getParent()&&!this.isInFlyout){var e=this.workspace.getGrid();if(null!=e&&e.shouldSnap()){var t=this.getRelativeToSurfaceXY();(e=e.alignXY(t))!==t&&this.moveTo(e,["snap"])}}}getBoundingRectangle(){return this.getBoundingRectangleWithDimensions(this.getHeightWidth())}getBoundingRectangleWithoutChildren(){return this.getBoundingRectangleWithDimensions({height:this.height,width:this.childlessWidth})}getBoundingRectangleWithDimensions(e){const t=this.getRelativeToSurfaceXY();let i,s;return this.RTL?(i=t.x-e.width,s=t.x):(i=t.x,s=t.x+e.width),new z(t.y,t.y+e.height,i,s)}markDirty(){this.pathObject.constants=this.workspace.getRenderer().getConstants();for(let t,e=0;t=this.inputList[e];e++)t.markDirty()}setCollapsed(e){this.collapsed_!==e&&(super.setCollapsed(e),this.updateCollapsed())}childHasWarning(){const e=this.getChildren(!1);for(const t of e)if(t.getIcon(Jt.TYPE)||t.childHasWarning())return!0;return!1}updateCollapsed(){var e=this.isCollapsed();const t=Bn,i=Pl;for(let r,n=0;r=this.inputList[n];n++)r.name!==t&&r.setVisible(!e);for(var s of this.getIcons())s.updateCollapsed();e?(A(this.svgGroup,"blocklyCollapsed"),this.childHasWarning()&&this.setWarningText(o.Msg$$module$build$src$core$msg.COLLAPSED_WARNINGS_WARNING,ie.COLLAPSED_WARNING_ID),e=this.toString(30),(s=this.getField(i))?s.setValue(e):(this.getInput(t)||this.appendDummyInput(t)).appendField(new Di(e),i)):(this.updateDisabled(),this.removeInput(t),X(this.svgGroup,"blocklyCollapsed"),this.setWarningText(null,ie.COLLAPSED_WARNING_ID))}onMouseDown(e){if(!this.workspace.isReadOnly()){var t=this.workspace.getGesture(e);t&&t.handleBlockStart(e,this)}}showHelp(){const e="function"==typeof this.helpUrl?this.helpUrl():this.helpUrl;e&&window.open(e)}generateContextMenu(e){return this.workspace.isReadOnly()||!this.contextMenu?null:(e=W.registry.getContextMenuOptions({block:this,focusedNode:this},e),this.customContextMenu&&this.customContextMenu(e),e)}calculateContextMenuLocation(e){if(e instanceof PointerEvent)return new S(e.clientX,e.clientY);let t,i;e=Ji(this.workspace,this.getRelativeToSurfaceXY());const s=null==(t=this.inputList.filter(n=>n.isVisible()).flatMap(n=>n.fieldRow).find(n=>n.isVisible()))||null==(i=t.getSvgRoot())?void 0:i.getBoundingClientRect();return new S(this.RTL?e.x-5:e.x+5,(s&&s.height?s.y+s.height:e.y+this.height)+5)}showContextMenu(e){const t=this.generateContextMenu(e),i=this.calculateContextMenuLocation(e);t&&t.length&&(It(e,t,this.RTL,this.workspace,i),fi(this))}updateComponentLocations(e){this.dragging||this.updateConnectionLocations(e),this.updateIconLocations(e),this.updateFieldLocations(e);for(const t of this.getChildren(!1))t.updateComponentLocations(S.sum(e,t.relativeCoords))}updateConnectionLocations(e){for(const t of this.getConnections_(!1))t.moveToOffset(e)}updateIconLocations(e){for(const t of this.getIcons())t.onLocationChange(e)}updateFieldLocations(e){for(const t of this.inputList)for(const i of t.fieldRow)i.onLocationChange(e)}addClass(e){A(this.svgGroup,e)}removeClass(e){X(this.svgGroup,e)}setDragging(e){(this.dragging=e)?(this.translation="",Rl.push(...this.getConnections_(!0)),this.addClass("blocklyDragging")):(Rl.length=0,this.removeClass("blocklyDragging"));for(let t=0;t<this.childBlocks_.length;t++)this.childBlocks_[t].setDragging(e)}setMovable(e){super.setMovable(e),this.pathObject.updateMovable(e)}setEditable(e){super.setEditable(e),e?X(this.svgGroup,"blocklyNotEditable"):A(this.svgGroup,"blocklyNotEditable"),e=this.getIcons();for(let t=0;t<e.length;t++)e[t].updateEditable()}setShadow(e){super.setShadow(e),this.applyColour()}setInsertionMarker(e){this.isInsertionMarker_!==e&&(this.isInsertionMarker_=e)&&(this.setColour(this.workspace.getRenderer().getConstants().INSERTION_MARKER_COLOUR),this.pathObject.updateInsertionMarker(!0))}getSvgRoot(){return this.svgGroup}dispose(e,t){this.disposing=!0,Br(),Ei();const i=o.getFocusManager$$module$build$src$core$focus_manager();var s,n;if(this.getSvgRoot().contains(null!=(n=null==(s=i.getFocusedNode())?void 0:s.getFocusableElement())?n:null)){if(!(s=this.getParent())){let r;if(n=null!=(r=this.outputConnection)?r:this.previousConnection){let a;s=null==(a=n.closest(0,new S(0,0)).connection)?void 0:a.getSourceBlock()}}s?i.focusNode(s):setTimeout(()=>i.focusTree(this.workspace),0)}t&&(this.unplug(e),bs(this)),super.dispose(!!e),J(this.svgGroup)}disposeInternal(){this.disposing=!0,super.disposeInternal(),o.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode()===this&&this.workspace.cancelCurrentGesture(),[...this.warningTextDb.values()].forEach(e=>clearTimeout(e)),this.warningTextDb.clear(),this.getIcons().forEach(e=>e.dispose())}checkAndDelete(){this.workspace.isFlyout||(o.setGroup$$module$build$src$core$events$utils(!0),this.workspace.hideChaff(),this.dispose(!this.outputConnection,!0),o.setGroup$$module$build$src$core$events$utils(!1))}toCopyData(){return this.isInsertionMarker_?null:{paster:jn.TYPE,blockState:rt(this,{addCoordinates:!0,addNextBlocks:!1}),typeCounts:on(this,!0)}}applyColour(){var e,t;for(null==(t=(e=this.pathObject).applyColour)||t.call(e,this),e=this.getIcons(),t=0;t<e.length;t++)e[t].applyColour();for(const i of this.getFields())i.applyColour()}updateDisabled(){const e=!this.isEnabled()||this.getInheritedDisabled();if(this.visuallyDisabled===e){let t;null==(t=this.getNextBlock())||t.updateDisabled()}else{this.applyColour(),this.visuallyDisabled=e;for(const t of this.getChildren(!1))t.updateDisabled()}}setWarningText(e,t=""){if(t)this.warningTextDb.has(t)&&(clearTimeout(this.warningTextDb.get(t)),this.warningTextDb.delete(t));else{for(var i of this.warningTextDb.values())clearTimeout(i);this.warningTextDb.clear()}if(this.workspace.isDragging())this.warningTextDb.set(t,setTimeout(()=>{this.isDeadOrDying()||(this.warningTextDb.delete(t),this.setWarningText(e,t))},100));else if(this.isInFlyout&&(e=null),i=this.getIcon(Jt.TYPE),e){let s=this.getSurroundParent(),n=null;for(;s;)s.isCollapsed()&&(n=s),s=s.getSurroundParent();n&&n.setWarningText(o.Msg$$module$build$src$core$msg.COLLAPSED_WARNINGS_WARNING,ie.COLLAPSED_WARNING_ID),i?i.addMessage(e,t):this.addIcon(new Jt(this).addMessage(e,t))}else i&&(t?(i.addMessage("",t),i.getText()||this.removeIcon(Jt.TYPE)):this.removeIcon(Jt.TYPE))}setMutator(e){this.removeIcon(o.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE),e&&this.addIcon(e)}addIcon(e){return super.addIcon(e),e instanceof o.MutatorIcon$$module$build$src$core$icons$mutator_icon&&(this.mutator=e),e.initView(this.createIconPointerDownListener(e)),e.applyColour(),e.updateEditable(),this.queueRender(),e}createIconPointerDownListener(e){return t=>{this.isDeadOrDying()||(t=this.workspace.getGesture(t))&&t.setStartIcon(e)}}removeIcon(e){const t=super.removeIcon(e);return e.equals(o.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE)&&(this.mutator=null),this.queueRender(),t}setDisabledReason(e,t){const i=this.isEnabled();super.setDisabledReason(e,t),this.isEnabled()===i||this.getInheritedDisabled()||this.updateDisabled()}setDeletable(e){super.setDeletable(e),e?X(this.svgGroup,"blocklyNotDeletable"):A(this.svgGroup,"blocklyNotDeletable")}setHighlighted(e){this.pathObject.updateHighlighted(e)}addSelect(){this.pathObject.updateSelected(!0)}removeSelect(){this.pathObject.updateSelected(!1)}setDeleteStyle(e){this.pathObject.updateDraggingDelete(e)}getColour(){return this.style.colourPrimary}setColour(e){let t,i;super.setColour(e),e=this.workspace.getRenderer().getConstants().getBlockStyleForColour(this.colour_),null==(i=(t=this.pathObject).setStyle)||i.call(t,e.style),this.style=e.style,this.styleName_=e.name,this.applyColour()}setStyle(e){const t=this.workspace.getRenderer().getConstants().getBlockStyle(e);if(this.styleName_&&X(this.svgGroup,this.styleName_),!t)throw Error("Invalid style name: "+e);{let i,s;this.hat=t.hat,null==(s=(i=this.pathObject).setStyle)||s.call(i,t),this.colour_=t.colourPrimary,this.style=t,this.applyColour(),A(this.svgGroup,e),this.styleName_=e}}getStyle(){return this.style}bringToFront(e=!1){const t=o.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode();let i=this;if(!i.isDeadOrDying()){do{const s=i.getSvgRoot(),n=s.parentNode,r=n.childNodes;if(r[r.length-1]!==s&&n.appendChild(s),e)break;i=i.getParent()}while(i);t&&o.getFocusManager$$module$build$src$core$focus_manager().focusNode(t)}}setPreviousStatement(e,t){super.setPreviousStatement(e,t),this.queueRender()}setNextStatement(e,t){super.setNextStatement(e,t),this.queueRender()}setOutput(e,t){super.setOutput(e,t),this.queueRender()}setInputsInline(e){super.setInputsInline(e),this.queueRender()}removeInput(e,t){return e=super.removeInput(e,t),this.queueRender(),e}moveNumberedInputBefore(e,t){super.moveNumberedInputBefore(e,t),this.queueRender()}appendInput(e){return super.appendInput(e),this.queueRender(),e}setConnectionTracking(e){if(this.previousConnection&&this.previousConnection.setTracking(e),this.outputConnection&&this.outputConnection.setTracking(e),this.nextConnection){this.nextConnection.setTracking(e);var t=this.nextConnection.targetBlock();t&&t.setConnectionTracking(e)}if(!this.collapsed_)for(t=0;t<this.inputList.length;t++){var i=this.inputList[t].connection;i&&(i.setTracking(e),(i=i.targetBlock())&&i.setConnectionTracking(e))}}getConnections_(e){const t=[];if(this.outputConnection&&t.push(this.outputConnection),this.previousConnection&&t.push(this.previousConnection),this.nextConnection&&t.push(this.nextConnection),e||!this.collapsed_)for(let s,i=0;s=this.inputList[i];i++)s.connection&&t.push(s.connection);return t}lastConnectionInStack(e){return super.lastConnectionInStack(e)}getMatchingConnection(e,t){return super.getMatchingConnection(e,t)}makeConnection_(e){return new Le(this,e)}getNextBlock(){return super.getNextBlock()}getPreviousBlock(){return super.getPreviousBlock()}bumpNeighbours(){const e=this.getRootBlock();if(!(this.isDeadOrDying()||this.workspace.isDragging()||e.isInFlyout))for(const t of this.getConnections_(!1)){if(t.isSuperior()){let i;null==(i=t.targetBlock())||i.bumpNeighbours()}for(const i of t.neighbours(o.config$$module$build$src$core$config.snapRadius))i.getSourceBlock().getRootBlock()!==e&&(t.isConnected()&&i.isConnected()||(t.isSuperior()?i.bumpAwayFrom(t,!1):t.bumpAwayFrom(i,!0)))}}scheduleSnapAndBump(){this.snapToGrid(),this.bumpNeighbours()}positionNearConnection(e,t,i){if(e.type===N.NEXT_STATEMENT||e.type===N.INPUT_VALUE){let s=t.x;t=t.y,s+=i.x-e.getOffsetInBlock().x,t+=i.y-e.getOffsetInBlock().y,this.moveBy(s,t)}}getChildren(e){return super.getChildren(e)}queueRender(){return Ac(this)}render(){this.queueRender(),Ao()}renderEfficiently(){_(),this.isCollapsed()&&this.updateCollapsed(),this.isEnabled()||this.updateDisabled(),this.workspace.getRenderer().render(this),this.tightenChildrenEfficiently(),T()}tightenChildrenEfficiently(){for(const e of this.inputList){const t=e.connection;t&&t.tightenEfficiently()}this.nextConnection&&this.nextConnection.tightenEfficiently()}getHeightWidth(){let e=this.height,t=this.width;var i=this.getNextBlock();if(i){i=i.getHeightWidth();const s=this.workspace.getRenderer().getConstants().NOTCH_HEIGHT;e+=i.height-s,t=Math.max(t,i.width)}return{height:e,width:t}}fadeForReplacement(e){this.pathObject.updateReplacementFade(e)}highlightShapeForInput(e,t){this.pathObject.updateShapeForInputHighlight(e,t)}getDragStrategy(){return this.dragStrategy}setDragStrategy(e){this.dragStrategy=e}isCopyable(){return this.isOwnDeletable()&&this.isOwnMovable()}isMovable(){return this.dragStrategy.isMovable()}startDrag(e){this.dragStrategy.startDrag(e)}drag(e,t){this.dragStrategy.drag(e,t)}endDrag(e){this.dragStrategy.endDrag(e)}revertDrag(){this.dragStrategy.revertDrag()}toFlyoutInfo(){const e=Object.assign({},{kind:"BLOCK"},rt(this)),t=new Set(["id","height","width","pinned","enabled"]),i=function(s){for(const n in s)t.has(n)?delete s[n]:"object"==typeof s[n]&&i(s[n])};return i(e),[e]}jsonInit(e){super.jsonInit(e),e.classes&&this.addClass(Array.isArray(e.classes)?e.classes.join(" "):e.classes)}getFocusableElement(){return this.pathObject.svgPath}getFocusableTree(){return this.workspace}onNodeFocus(){this.select()}onNodeBlur(){this.unselect()}canBeFocused(){return!0}};ie.INLINE=-1,ie.COLLAPSED_WARNING_ID="TEMP_COLLAPSED_WARNING_";var Ip=class{constructor(){}onDragEnter(e){}onDragOver(e){}onDragExit(e){}onDrop(e){}getClientRect(){return null}shouldPreventMove(e){return!1}},ec=class extends Ip{constructor(){super(),this.wouldDelete_=!1}wouldDelete(e){return e instanceof ie?(e=!e.getParent()&&e.isDeletable(),this.updateWouldDelete_(e)):this.updateWouldDelete_(Xe(e)&&e.isDeletable()),this.wouldDelete_}updateWouldDelete_(e){this.wouldDelete_=e}},Ns=class{constructor(e,t){this.element=e,this.type=t}getElement(){return this.element}getType(){return this.type}},lu=class{constructor(e){this.workspace_=e}getDimensionsPx_(e){let t=0,i=0;return e&&(t=e.getWidth(),i=e.getHeight()),new j(t,i)}getFlyoutMetrics(e){return{width:(e=this.getDimensionsPx_(this.workspace_.getFlyout(e))).width,height:e.height,position:this.workspace_.toolboxPosition}}getToolboxMetrics(){const e=this.getDimensionsPx_(this.workspace_.getToolbox());return{width:e.width,height:e.height,position:this.workspace_.toolboxPosition}}getSvgMetrics(){return this.workspace_.getCachedParentSvgSize()}getAbsoluteMetrics(){let e=0,t=0;const i=this.getToolboxMetrics(),s=this.getFlyoutMetrics(),n=!!this.workspace_.getToolbox();var r;const a=!(null!=(r=this.workspace_.getFlyout())&&r.autoClose);return(r=n?i.position:s.position)===G.LEFT&&(n&&(e+=i.width),a&&(e+=s.width)),r===G.TOP&&(n&&(t+=i.height),a&&(t+=s.height)),{top:t,left:e}}getViewMetrics(e){e=e?this.workspace_.scale:1;const t=this.getSvgMetrics(),i=this.getToolboxMetrics(),s=this.getFlyoutMetrics(),n=!!this.workspace_.getToolbox();var r;const a=!(null!=(r=this.workspace_.getFlyout())&&r.autoClose),$=(r=n?i.position:s.position)===G.LEFT||r===G.RIGHT;return(r===G.TOP||r===G.BOTTOM)&&(n&&(t.height-=i.height),a&&(t.height-=s.height)),$&&(n&&(t.width-=i.width),a&&(t.width-=s.width)),{height:t.height/e,width:t.width/e,top:-this.workspace_.scrollY/e,left:-this.workspace_.scrollX/e}}getContentMetrics(e){e=e?1:this.workspace_.scale;const t=this.workspace_.getBlocksBoundingBox();return{height:(t.bottom-t.top)*e,width:(t.right-t.left)*e,top:t.top*e,left:t.left*e}}hasFixedEdges(){return!this.workspace_.isMovableHorizontally()||!this.workspace_.isMovableVertically()}getComputedFixedEdges_(e){if(!this.hasFixedEdges())return{};const t=this.workspace_.isMovableHorizontally(),i=this.workspace_.isMovableVertically();e=e||this.getViewMetrics(!1);const s={};return i||(s.top=e.top,s.bottom=e.top+e.height),t||(s.left=e.left,s.right=e.left+e.width),s}getPaddedContent_(e,t){const i=t.top+t.height,s=t.left+t.width,n=e.width,r=n/2,a=(e=e.height)/2;return{top:Math.min(t.top-a,i-e),bottom:Math.max(i+a,t.top+e),left:Math.min(t.left-r,s-n),right:Math.max(s+r,t.left+n)}}getScrollMetrics(e,t,i){e=e?this.workspace_.scale:1,t=t||this.getViewMetrics(!1);var s=i||this.getContentMetrics();i=this.getComputedFixedEdges_(t),t=this.getPaddedContent_(t,s);const n=void 0!==i.left?i.left:t.left;return{top:(s=void 0!==i.top?i.top:t.top)/e,left:n/e,width:((void 0!==i.right?i.right:t.right)-n)/e,height:((void 0!==i.bottom?i.bottom:t.bottom)-s)/e}}getUiMetrics(){return{viewMetrics:this.getViewMetrics(),absoluteMetrics:this.getAbsoluteMetrics(),toolboxMetrics:this.getToolboxMetrics()}}getMetrics(){const e=this.getToolboxMetrics(),t=this.getFlyoutMetrics(!0),i=this.getSvgMetrics(),s=this.getAbsoluteMetrics(),n=this.getViewMetrics(),r=this.getContentMetrics(),a=this.getScrollMetrics(!1,n,r);return{contentHeight:r.height,contentWidth:r.width,contentTop:r.top,contentLeft:r.left,scrollHeight:a.height,scrollWidth:a.width,scrollTop:a.top,scrollLeft:a.left,viewHeight:n.height,viewWidth:n.width,viewTop:n.top,viewLeft:n.left,absoluteTop:s.top,absoluteLeft:s.left,svgHeight:i.height,svgWidth:i.width,toolboxWidth:e.width,toolboxHeight:e.height,toolboxPosition:e.position,flyoutWidth:t.width,flyoutHeight:t.height}}};U(k.METRICS_MANAGER,ct,lu);var kp=class extends lu{constructor(e,t){super(e),this.flyout_=t}getBoundingBox(){let e;try{e=this.workspace_.getCanvas().getBBox()}catch{e={height:0,y:0,width:0,x:0}}return e}getContentMetrics(e){const t=this.getBoundingBox();return{height:t.height*(e=e?1:this.workspace_.scale),width:t.width*e,top:t.y*e,left:t.x*e}}getScrollMetrics(e,t,i){return{height:((t=i||this.getContentMetrics()).height+2*(i=this.flyout_.MARGIN*this.workspace_.scale))/(e=e?this.workspace_.scale:1),width:(t.width+t.left+i)/e,top:0,left:0}}},Je=class{constructor(e,t,i,s){let n;this.workspace=e,this.targetWorkspace=t,this.isFlyoutLabel=s,this.height=this.width=0,this.cursorSvg=this.svgText=null,this.text=i.text,this.position=new S(0,0),this.callbackKey=i.callbackKey||i.callbackkey,this.cssClass=i["web-class"]||null,this.info=i,e=this.isFlyoutLabel?"blocklyFlyoutLabel":"blocklyFlyoutButton",this.cssClass&&(e+=" "+this.cssClass),this.id=ze(),this.svgGroup=I(f.G,{id:this.id,class:e},this.workspace.getCanvas()),this.isFlyoutLabel||(n=I(f.RECT,{class:"blocklyFlyoutButtonShadow",rx:Je.BORDER_RADIUS,ry:Je.BORDER_RADIUS,x:1,y:1},this.svgGroup)),e=I(f.RECT,{class:this.isFlyoutLabel?"blocklyFlyoutLabelBackground":"blocklyFlyoutButtonBackground",rx:Je.BORDER_RADIUS,ry:Je.BORDER_RADIUS},this.svgGroup),t=I(f.TEXT,{class:this.isFlyoutLabel?"blocklyFlyoutLabelText":"blocklyText",x:0,y:0,"text-anchor":"middle"},this.svgGroup),i=l(this.text),this.workspace.RTL&&(i+="\u200f"),t.textContent=i,this.isFlyoutLabel&&(this.svgText=t,this.workspace.getThemeManager().subscribe(this.svgText,"flyoutForegroundColour","fill")),s=Ft(t,"fontSize");const r=Ft(t,"fontWeight"),a=Ft(t,"fontFamily");if(this.width=Dt(t,s,r,a),i=ir(i,s,r,a),this.height=this.height||i.height,!this.isFlyoutLabel){let $,C;this.width+=2*Je.TEXT_MARGIN_X,this.height+=2*Je.TEXT_MARGIN_Y,null==($=n)||$.setAttribute("width",String(this.width)),null==(C=n)||C.setAttribute("height",String(this.height))}e.setAttribute("width",String(this.width)),e.setAttribute("height",String(this.height)),t.setAttribute("x",String(this.width/2)),t.setAttribute("y",String(this.height/2-i.height/2+i.baseline)),this.updateTransform(),this.onMouseDownWrapper=L(this.svgGroup,"pointerdown",this,this.onMouseDown),this.onMouseUpWrapper=L(this.svgGroup,"pointerup",this,this.onMouseUp)}createDom(){return this.svgGroup}show(){this.updateTransform(),this.svgGroup.setAttribute("display","block")}updateTransform(){this.svgGroup.setAttribute("transform","translate("+this.position.x+","+this.position.y+")")}moveTo(e,t){this.position.x=e,this.position.y=t,this.updateTransform()}moveBy(e,t,i){this.moveTo(this.position.x+e,this.position.y+t)}isLabel(){return this.isFlyoutLabel}getPosition(){return this.position}getBoundingRectangle(){return new z(this.position.y,this.position.y+this.height,this.position.x,this.position.x+this.width)}getButtonText(){return this.text}getTargetWorkspace(){return this.targetWorkspace}getWorkspace(){return this.workspace}dispose(){K(this.onMouseDownWrapper),K(this.onMouseUpWrapper),this.svgGroup&&J(this.svgGroup),this.svgText&&this.workspace.getThemeManager().unsubscribe(this.svgText)}setCursorSvg(e){e?this.svgGroup&&(this.svgGroup.appendChild(e),this.cursorSvg=e):this.cursorSvg=null}onMouseUp(e){(e=this.targetWorkspace.getGesture(e))&&e.cancel(),this.isFlyoutLabel&&this.callbackKey?console.warn("Labels should not have callbacks. Label text: "+this.text):this.isFlyoutLabel||this.callbackKey&&this.targetWorkspace.getButtonCallback(this.callbackKey)?this.isFlyoutLabel||(e=this.targetWorkspace.getButtonCallback(this.callbackKey))&&e(this):console.warn("Buttons should have callbacks. Button text: "+this.text)}onMouseDown(e){const t=this.targetWorkspace.getGesture(e),i=this.targetWorkspace.getFlyout();t&&i&&t.handleFlyoutStart(e,i)}getSvgRoot(){return this.svgGroup}getFocusableElement(){return this.svgGroup}getFocusableTree(){return this.workspace}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}};Je.TEXT_MARGIN_X=5,Je.TEXT_MARGIN_Y=2,Je.BORDER_RADIUS=4,Pt("\n.blocklyFlyoutButton {\n  fill: #888;\n  cursor: default;\n}\n\n.blocklyFlyoutButtonShadow {\n  fill: #666;\n}\n\n.blocklyFlyoutButton:hover {\n  fill: #aaa;\n}\n\n.blocklyFlyoutLabel {\n  cursor: default;\n}\n\n.blocklyFlyoutLabelBackground {\n  opacity: 0;\n}\n");var Sp=class{getFirstChild(e){return null}getParent(e){return e.getWorkspace()}getNextSibling(e){return null}getPreviousSibling(e){return null}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof Je}},wp=class{constructor(e,t){this.policy=e,this.flyout=t}getFirstChild(e){return null}getParent(e){return this.policy.getParent(e)}getNextSibling(e){const t=this.flyout.getContents();if(!t)return null;let i=t.findIndex(s=>s.getElement()===e);return-1===i?null:(i++,i>=t.length&&(i=0),t[i].getElement())}getPreviousSibling(e){const t=this.flyout.getContents();if(!t)return null;let i=t.findIndex(s=>s.getElement()===e);return-1===i?null:(i--,i<0&&(i=t.length-1),t[i].getElement())}isNavigable(e){return this.policy.isNavigable(e)}isApplicable(e){return this.policy.isApplicable(e)}},tc=class{constructor(e,t){this.gap=e,this.axis=t,this.y=this.x=0}getBoundingRectangle(){switch(this.axis){case"x":return new z(this.y,this.y,this.x,this.x+this.gap);case"y":return new z(this.y,this.y+this.gap,this.x,this.x)}}moveBy(e,t,i){this.x+=e,this.y+=t}isNavigable(){return!1}getFocusableElement(){throw Error("Cannot be focused")}getFocusableTree(){throw Error("Cannot be focused")}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!1}},xp=class{getFirstChild(e){return null}getParent(e){return null}getNextSibling(e){return null}getPreviousSibling(e){return null}isNavigable(e){return!1}isApplicable(e){return e instanceof tc}},Ap=class{getFirstChild(e){return Nn(e,!0)[0]}getParent(e){var t;if(null!=(t=e.previousConnection)&&t.targetBlock()){if(t=e.getSurroundParent())return t}else{let i;if(null!=(i=e.outputConnection)&&i.targetBlock())return e.outputConnection.targetBlock()}return e.workspace}getNextSibling(e){let t,i;if(null!=(t=e.nextConnection)&&t.targetBlock()){let s;return null==(s=e.nextConnection)?void 0:s.targetBlock()}return null!=(i=e.outputConnection)&&i.targetBlock()?H(e,1):e.getSurroundParent()?H(e.getTopStackBlock(),1):this.getParent(e)instanceof Ze?Ho(e,1):null}getPreviousSibling(e){let t,i;if(null!=(t=e.previousConnection)&&t.targetBlock()){let s;return null==(s=e.previousConnection)?void 0:s.targetBlock()}return null!=(i=e.outputConnection)&&i.targetBlock()?H(e,-1):this.getParent(e)instanceof Ze?Ho(e,-1):null}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof ie}},Rp={};Rp.BlockNavigationPolicy=Ap,Rp.navigateBlock=H,Rp.navigateStacks=Ho;var xm=class{getFirstChild(e){return null}getParent(e){return e.getParentComment()}getNextSibling(e){const t=e.getParentComment().view.getCommentBarButtons();return(e=t.indexOf(e))>=0&&e+1<t.length?t[e+1]:null}getPreviousSibling(e){const t=e.getParentComment().view.getCommentBarButtons();return(e=t.indexOf(e))>0?t[e-1]:null}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof zl}},Op=class{getFirstChild(e){return e.getParentInput()?e.targetConnection:null}getParent(e){return e.getSourceBlock()}getNextSibling(e){if(e.getParentInput())return H(e,1);if(e.type===N.NEXT_STATEMENT){const i=e.targetConnection;var t=e.getSourceBlock();if(!i&&t.getRootBlock().lastConnectionInStack(!1)===e){let s;return e=t.workspace.getTopBlocks(!0),(t=e.indexOf(t.getRootBlock())+1)>=e.length&&(t=0),null!=(s=this.getParentConnection(t=e[t]))?s:t}return i}return e.getSourceBlock()}getPreviousSibling(e){if(e.getParentInput())return H(e,-1);if(e.type===N.PREVIOUS_STATEMENT||e.type===N.OUTPUT_VALUE){const i=e.targetConnection&&!e.targetConnection.getParentInput()?e.targetConnection:null;var t=e.getSourceBlock();if(!i&&this.getParentConnection(t.getRootBlock())===e){let s;return e=t.workspace.getTopBlocks(!0),(t=e.indexOf(t.getRootBlock())-1)<0&&(t=e.length-1),null!=(s=(t=e[t]).lastConnectionInStack(!1))?s:t}return i}return e.type===N.NEXT_STATEMENT?e.getSourceBlock():null}getParentConnection(e){let t;return!e.outputConnection||null!=(t=e.previousConnection)&&t.isConnected()?e.previousConnection:e.outputConnection}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof Le}},Mp=class{getFirstChild(e){return null}getParent(e){return e.getSourceBlock()}getNextSibling(e){return H(e,1)}getPreviousSibling(e){return H(e,-1)}isNavigable(e){let t;return e.canBeFocused()&&e.isVisible()&&(e.isClickable()||e.isCurrentlyEditable())&&!(null!=(t=e.getSourceBlock())&&t.isSimpleReporter()&&e.isFullBlockField())&&e.getParentInput().isVisible()}isApplicable(e){return e instanceof Q}},Am=class{getFirstChild(e){if(e instanceof o.MutatorIcon$$module$build$src$core$icons$mutator_icon&&e.bubbleIsVisible()&&o.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode()===e){let t,i;return null!=(i=null==(t=e.getBubble())?void 0:t.getWorkspace())?i:null}return null}getParent(e){return e.getSourceBlock()}getNextSibling(e){return H(e,1)}getPreviousSibling(e){return H(e,-1)}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof qn}},Rm=class{getFirstChild(e){return e.view.getCommentBarButtons()[0]}getParent(e){return e.workspace}getNextSibling(e){return Ho(e,1)}getPreviousSibling(e){return Ho(e,-1)}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof jt}},Np=class{getFirstChild(e){return(e=e.getTopBlocks(!0)).length?e[0]:null}getParent(e){return null}getNextSibling(e){return null}getPreviousSibling(e){return null}isNavigable(e){return e.canBeFocused()&&!e.isMutator}isApplicable(e){return e instanceof Ze}},cu=class{constructor(){this.rules=[new Ap,new Mp,new Op,new Np,new Am,new Rm,new xm]}addNavigationPolicy(e){this.rules.push(e)}get(e){return this.rules.find(t=>t.isApplicable(e))}getFirstChild(e){let t;const i=null==(t=this.get(e))?void 0:t.getFirstChild(e);if(!i)return null;let s;return null!=(s=this.get(i))&&s.isNavigable(i)?i:this.getFirstChild(i)||this.getNextSibling(i)}getParent(e){let t;const i=null==(t=this.get(e))?void 0:t.getParent(e);if(!i)return null;let s;return null!=(s=this.get(i))&&s.isNavigable(i)?i:this.getParent(i)}getNextSibling(e){let t;const i=null==(t=this.get(e))?void 0:t.getNextSibling(e);if(!i)return null;let s;return null!=(s=this.get(i))&&s.isNavigable(i)?i:this.getNextSibling(i)}getPreviousSibling(e){let t;const i=null==(t=this.get(e))?void 0:t.getPreviousSibling(e);if(!i)return null;let s;return null!=(s=this.get(i))&&s.isNavigable(i)?i:this.getPreviousSibling(i)}},Lp=class extends cu{constructor(e){super(),this.rules.push(new Sp,new xp),this.rules=this.rules.map(t=>new wp(t,e))}},au=class{constructor(e,t,i,s,n){this.workspace=e,this.oldHostMetrics=this.corner_=this.vScroll=this.hScroll=null,i=void 0===i||i;const r=(t=void 0===t||t)&&i;t&&(this.hScroll=new _e(e,!0,r,s,n)),i&&(this.vScroll=new _e(e,!1,r,s,n)),r&&(this.corner_=I(f.RECT,{height:_e.scrollbarThickness,width:_e.scrollbarThickness,class:"blocklyScrollbarBackground"}),c(this.corner_,e.getBubbleCanvas()))}dispose(){J(this.corner_),this.oldHostMetrics=this.corner_=null,this.hScroll&&(this.hScroll.dispose(),this.hScroll=null),this.vScroll&&(this.vScroll.dispose(),this.vScroll=null)}resize(){const e=this.workspace.getMetrics();if(e){var t=!1,i=!1;if(this.oldHostMetrics&&this.oldHostMetrics.viewWidth===e.viewWidth&&this.oldHostMetrics.viewHeight===e.viewHeight&&this.oldHostMetrics.absoluteTop===e.absoluteTop&&this.oldHostMetrics.absoluteLeft===e.absoluteLeft?(this.oldHostMetrics&&this.oldHostMetrics.scrollWidth===e.scrollWidth&&this.oldHostMetrics.viewLeft===e.viewLeft&&this.oldHostMetrics.scrollLeft===e.scrollLeft||(t=!0),this.oldHostMetrics&&this.oldHostMetrics.scrollHeight===e.scrollHeight&&this.oldHostMetrics.viewTop===e.viewTop&&this.oldHostMetrics.scrollTop===e.scrollTop||(i=!0)):i=t=!0,t||i){try{o.disable$$module$build$src$core$events$utils(),this.hScroll&&t&&this.hScroll.resize(e),this.vScroll&&i&&this.vScroll.resize(e)}finally{o.enable$$module$build$src$core$events$utils()}this.workspace.maybeFireViewportChangeEvent()}if(this.hScroll&&this.vScroll){if(!this.oldHostMetrics||this.oldHostMetrics.viewWidth!==e.viewWidth||this.oldHostMetrics.absoluteLeft!==e.absoluteLeft){let s;null==(s=this.corner_)||s.setAttribute("x",String(this.vScroll.position.x))}if(!this.oldHostMetrics||this.oldHostMetrics.viewHeight!==e.viewHeight||this.oldHostMetrics.absoluteTop!==e.absoluteTop){let s;null==(s=this.corner_)||s.setAttribute("y",String(this.hScroll.position.y))}}this.oldHostMetrics=e}}canScrollHorizontally(){return!!this.hScroll}canScrollVertically(){return!!this.vScroll}setOrigin(e,t){this.hScroll&&this.hScroll.setOrigin(e,t),this.vScroll&&this.vScroll.setOrigin(e,t)}set(e,t,i){this.hScroll&&this.hScroll.set(e,!1),this.vScroll&&this.vScroll.set(t,!1),(i||void 0===i)&&(e={},this.hScroll&&(e.x=this.hScroll.getRatio_()),this.vScroll&&(e.y=this.vScroll.getRatio_()),this.workspace.setMetrics(e))}setX(e){this.hScroll&&this.hScroll.set(e,!0)}setY(e){this.vScroll&&this.vScroll.set(e,!0)}setContainerVisible(e){this.hScroll&&this.hScroll.setContainerVisible(e),this.vScroll&&this.vScroll.setContainerVisible(e)}isVisible(){let e=!1;return this.hScroll&&(e=this.hScroll.isVisible()),this.vScroll&&(e=e||this.vScroll.isVisible()),e}setVisible(e){this.hScroll&&this.hScroll.setVisibleInternal(e),this.vScroll&&this.vScroll.setVisibleInternal(e)}resizeContent(e){this.hScroll&&this.hScroll.resizeContentHorizontal(e),this.vScroll&&this.vScroll.resizeContentVertical(e)}resizeView(e){this.hScroll&&this.hScroll.resizeViewHorizontal(e),this.vScroll&&this.vScroll.resizeViewVertical(e)}},Ls="sep",Dp=class{load(e,t){return e=new tc(0,t.horizontalLayout?"x":"y"),new Ns(e,Ls)}gapForItem(e,t){let i;return null!=(i=parseInt(String(e.gap)))?i:t}disposeItem(e){}getType(){return Ls}};U(k.FLYOUT_INFLATER,Ls,Dp),{SEPARATOR_TYPE:Ls}.SeparatorFlyoutInflater=Dp;var oc=class extends ec{constructor(e){super(),this.horizontalLayout=!1,this.boundEvents=[],this.reflowWrapper=null,this.contents=[],this.autoClose=!0,this.visible=!1,this.containerVisible=!0,this.CORNER_RADIUS=8,this.SCROLLBAR_MARGIN=2.5,this.height_=this.width_=0,this.dragAngleRange_=70,this.svgGroup_=this.svgBackground_=null,this.inflaters=new Map,e.setMetrics=this.setMetrics_.bind(this),this.workspace_=new Ze(e),this.workspace_.setMetricsManager(new kp(this.workspace_,this)),this.workspace_.internalIsFlyout=!0,this.workspace_.setVisible(this.visible),this.workspace_.setNavigator(new Lp(this)),this.id=Te(),this.RTL=!!e.RTL,this.toolboxPosition_=e.toolboxPosition,this.tabWidth_=this.workspace_.getRenderer().getConstants().TAB_WIDTH,this.MARGIN=this.CORNER_RADIUS,this.GAP_X=3*this.MARGIN,this.GAP_Y=3*this.MARGIN}createDom(e){return this.svgGroup_=I(e,{class:"blocklyFlyout"}),this.svgGroup_.style.display="none",this.svgBackground_=I(f.PATH,{class:"blocklyFlyoutBackground"},this.svgGroup_),this.svgGroup_.appendChild(this.workspace_.createDom()),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutBackgroundColour","fill"),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutOpacity","fill-opacity"),this.svgGroup_}init(e){this.targetWorkspace=e,this.workspace_.targetWorkspace=e,this.workspace_.scrollbar=new au(this.workspace_,this.horizontalLayout,!this.horizontalLayout,"blocklyFlyoutScrollbar",this.SCROLLBAR_MARGIN),this.hide(),this.boundEvents.push(L(this.svgGroup_,"wheel",this,this.wheel_)),this.boundEvents.push(L(this.svgBackground_,"pointerdown",this,this.onMouseDown)),this.workspace_.getGesture=this.targetWorkspace.getGesture.bind(this.targetWorkspace),this.workspace_.setVariableMap(this.targetWorkspace.getVariableMap()),this.workspace_.createPotentialVariableMap(),e.getComponentManager().addComponent({component:this,weight:de.ComponentWeight.FLYOUT_WEIGHT,capabilities:[de.Capability.AUTOHIDEABLE,de.Capability.DELETE_AREA,de.Capability.DRAG_TARGET]})}dispose(){this.hide(),this.targetWorkspace.getComponentManager().removeComponent(this.id);for(const e of this.boundEvents)K(e);this.boundEvents.length=0,this.workspace_&&(this.workspace_.getThemeManager().unsubscribe(this.svgBackground_),this.workspace_.dispose()),this.svgGroup_&&J(this.svgGroup_)}getWidth(){return this.width_}getHeight(){return this.height_}getFlyoutScale(){return this.targetWorkspace.scale}getWorkspace(){return this.workspace_}setAutoClose(e){this.autoClose=e,this.targetWorkspace.recordDragTargets(),this.targetWorkspace.resizeContents()}autoHide(e){!e&&this.targetWorkspace.getFlyout(!0)===this&&this.autoClose&&this.hide()}getTargetWorkspace(){return this.targetWorkspace}isVisible(){return this.visible}setVisible(e){const t=e!==this.isVisible();this.visible=e,t&&(this.autoClose||this.targetWorkspace.recordDragTargets(),this.updateDisplay())}setContainerVisible(e){const t=e!==this.containerVisible;this.containerVisible=e,t&&this.updateDisplay()}getContents(){return this.contents}setContents(e){this.contents=e}updateDisplay(){let e,t;e=!!this.containerVisible&&this.isVisible(),this.svgGroup_&&(this.svgGroup_.style.display=e?"block":"none"),null==(t=this.workspace_.scrollbar)||t.setContainerVisible(e)}positionAt_(e,t,i,s){let n,r;null==(n=this.svgGroup_)||n.setAttribute("width",`${e}`),null==(r=this.svgGroup_)||r.setAttribute("height",`${t}`),this.workspace_.setCachedParentSvgSize(e,t),this.svgGroup_&&h(this.svgGroup_,"translate("+i+"px,"+s+"px)"),(e=this.workspace_.scrollbar)&&(e.setOrigin(i,s),e.resize(),e.hScroll&&e.hScroll.setPosition(e.hScroll.position.x,e.hScroll.position.y),e.vScroll&&e.vScroll.setPosition(e.vScroll.position.x,e.vScroll.position.y))}hide(){this.isVisible()&&(this.setVisible(!1),this.reflowWrapper&&(this.workspace_.removeChangeListener(this.reflowWrapper),this.reflowWrapper=null))}show(e){this.workspace_.setResizesEnabled(!1),this.hide(),this.clearOldBlocks(),"string"==typeof e&&(e=this.getDynamicCategoryContents(e)),this.setVisible(!0),e=ln(e),e=this.createFlyoutInfo(e),Ao(this.workspace_),this.setContents(e),this.layout_(e),this.horizontalLayout?this.height_=0:this.width_=0,this.reflow(),this.workspace_.setResizesEnabled(!0),this.reflowWrapper=t=>{t.type!==b.BLOCK_CHANGE&&t.type!==b.BLOCK_FIELD_INTERMEDIATE_CHANGE||this.reflow()},this.workspace_.addChangeListener(this.reflowWrapper)}createFlyoutInfo(e){const t=[],i=this.horizontalLayout?this.GAP_X:this.GAP_Y;for(const s of e)"custom"in s&&(e=this.getDynamicCategoryContents(s.custom),e=ln(e),t.push(...this.createFlyoutInfo(e))),e=s.kind.toLowerCase(),(e=this.getInflaterForType(e))&&(t.push(e.load(s,this)),(e=e.gapForItem(s,i))&&t.push(new Ns(new tc(e,this.horizontalLayout?"x":"y"),Ls)));return this.normalizeSeparators(t)}normalizeSeparators(e){for(let t=e.length-1;t>0;t--){const i=e[t].getType().toLowerCase(),s=e[t-1].getType().toLowerCase();i===Ls&&s===Ls&&e.splice(t-1,1)}return e}getDynamicCategoryContents(e){if("function"!=typeof(e=this.workspace_.targetWorkspace.getToolboxCategoryCallback(e)))throw TypeError("Couldn't find a callback function when opening a toolbox category.");return e(this.workspace_.targetWorkspace)}clearOldBlocks(){let e;this.getContents().forEach(t=>{let i;null==(i=this.getInflaterForType(t.getType()))||i.disposeItem(t)}),null==(e=this.workspace_.getPotentialVariableMap())||e.clear()}onMouseDown(e){const t=this.targetWorkspace.getGesture(e);t&&t.handleFlyoutStart(e,this)}isBlockCreatable(e){return e.isEnabled()&&!this.getTargetWorkspace().isReadOnly()}createBlock(e){let t=null;o.disable$$module$build$src$core$events$utils();var i=this.targetWorkspace.getAllVariables();this.targetWorkspace.setResizesEnabled(!1);try{t=this.placeNewBlock(e)}finally{o.enable$$module$build$src$core$events$utils()}if(this.targetWorkspace.hideChaff(),e=hn(this.targetWorkspace,i),se()){for(o.setGroup$$module$build$src$core$events$utils(!0),i=0;i<e.length;i++){const s=e[i];B(new(P(b.VAR_CREATE))(s))}B(new(P(b.BLOCK_CREATE))(t))}return this.autoClose&&this.hide(),t}reflow(){this.reflowWrapper&&this.workspace_.removeChangeListener(this.reflowWrapper),this.reflowInternal_(),this.reflowWrapper&&this.workspace_.addChangeListener(this.reflowWrapper)}isScrollable(){return!!this.workspace_.scrollbar&&this.workspace_.scrollbar.isVisible()}placeNewBlock(e){var t=this.targetWorkspace;if(!e.getSvgRoot())throw Error("oldBlock is not rendered");const i=this.serializeBlock(e);return t.setResizesEnabled(!1),t=Ro(i,t),this.positionNewBlock(e,t),t}serializeBlock(e){return rt(e)}positionNewBlock(e,t){const i=this.targetWorkspace;var s=i.getOriginOffsetInPixels(),n=this.workspace_.getOriginOffsetInPixels();(e=e.getRelativeToSurfaceXY()).scale(this.workspace_.scale),n=S.sum(n,e),(s=S.difference(n,s)).scale(1/i.scale),t.moveTo(new S(s.x,s.y))}getInflaterForType(e){var t;return this.inflaters.has(e)?null!=(t=this.inflaters.get(e))?t:null:(t=tt(k.FLYOUT_INFLATER,e))?(t=new t,this.inflaters.set(e,t),t):null}getFocusableElement(){throw Error("Flyouts are not directly focusable.")}getFocusableTree(){throw Error("Flyouts are not directly focusable.")}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!1}getRootFocusableNode(){throw Error("Flyouts are not directly focusable.")}getRestoredFocusableNode(e){throw Error("Flyouts are not directly focusable.")}getNestedTrees(){throw Error("Flyouts are not directly focusable.")}lookUpFocusableNode(e){throw Error("Flyouts are not directly focusable.")}onTreeFocus(e,t){}onTreeBlur(e){throw Error("Flyouts are not directly focusable.")}},Bp=class{constructor(){this.isActive=!1,this.activeClassName="blocklyKeyboardNavigation"}setIsActive(e=!0){this.isActive=e,this.updateActiveVisualization()}getIsActive(){return this.isActive}updateActiveVisualization(){this.isActive?document.body.classList.add(this.activeClassName):document.body.classList.remove(this.activeClassName)}},ic=new Bp,Om={};Om.KeyboardNavigationController=Bp,Om.keyboardNavigationController=ic;var Pp=class{constructor(e){this.workspace=e,this.horizontalScrollEnabled=this.workspace.isMovableHorizontally(),this.verticalScrollEnabled=this.workspace.isMovableVertically(),this.startScrollXY_=new S(e.scrollX,e.scrollY)}dispose(){this.workspace=null}startDrag(){}endDrag(e){this.drag(e)}drag(e){if(e=S.sum(this.startScrollXY_,e),this.horizontalScrollEnabled&&this.verticalScrollEnabled)this.workspace.scroll(e.x,e.y);else if(this.horizontalScrollEnabled)this.workspace.scroll(e.x,this.workspace.scrollY);else{if(!this.verticalScrollEnabled)throw new TypeError("Invalid state.");this.workspace.scroll(this.workspace.scrollX,e.y)}}},sc=class{constructor(e,t){this.creatorWorkspace=t,this.mouseDownXY=new S(0,0),this.startWorkspace_=this.targetBlock=this.startComment=this.startBlock=this.startIcon=this.startField=this.startBubble=null,this.hasExceededDragRadius=!1,this.boundEvents=[],this.workspaceDragger=this.dragger=null,this.dragging=!1,this.flyout=null,this.multiTouch=this.isEnding_=this.gestureHasStarted=this.calledUpdateIsDragging=!1,this.cachedPoints=new Map,this.startDistance=this.previousScale=0,this.currentDropdownOwner=this.isPinchZoomEnabled=null,this.mostRecentEvent=e,this.currentDragDeltaXY=new S(0,0)}dispose(){Ae(),Fr(),this.creatorWorkspace.clearGesture();for(const e of this.boundEvents)K(e);this.boundEvents.length=0,this.workspaceDragger&&this.workspaceDragger.dispose()}updateFromEvent(e){const t=new S(e.clientX,e.clientY);this.updateDragDelta(t)&&(this.updateIsDragging(e),it()),this.mostRecentEvent=e}updateDragDelta(e){return this.currentDragDeltaXY=S.difference(e,this.mouseDownXY),!this.hasExceededDragRadius&&(this.hasExceededDragRadius=S.magnitude(this.currentDragDeltaXY)>(this.flyout?o.config$$module$build$src$core$config.flyoutDragRadius:o.config$$module$build$src$core$config.dragRadius))}updateIsDraggingFromFlyout(){let e;if(!this.targetBlock||null==(e=this.flyout)||!e.isBlockCreatable(this.targetBlock))return!1;if(!this.flyout.targetWorkspace)throw Error("Cannot update dragging from the flyout because the ' +\n          'flyout's target workspace is undefined");return!(this.flyout.isScrollable()&&!this.flyout.isDragTowardWorkspace(this.currentDragDeltaXY)||(this.startWorkspace_=this.flyout.targetWorkspace,this.startWorkspace_.updateScreenCalculationsIfScrolled(),o.getGroup$$module$build$src$core$events$utils()||o.setGroup$$module$build$src$core$events$utils(!0),this.startBlock=null,this.targetBlock=this.flyout.createBlock(this.targetBlock),o.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.targetBlock),0))}updateIsDraggingWorkspace(){if(!this.startWorkspace_)throw Error("Cannot update dragging the workspace because the start workspace is undefined");(this.flyout?this.flyout.isScrollable():this.startWorkspace_&&this.startWorkspace_.isDraggable())&&(this.dragging=!0,this.workspaceDragger=new Pp(this.startWorkspace_),this.workspaceDragger.startDrag())}updateIsDragging(e){if(!this.startWorkspace_)throw Error("Cannot update dragging because the start workspace is undefined");if(this.calledUpdateIsDragging)throw Error("updateIsDragging_ should only be called once per gesture.");this.calledUpdateIsDragging=!0,this.flyout&&this.updateIsDraggingFromFlyout();const t=Ki();t&&V(t)&&t.isMovable()?(this.dragging=!0,this.dragger=this.createDragger(t,this.startWorkspace_),this.dragger.onDragStart(e),this.dragger.onDrag(e,this.currentDragDeltaXY)):this.updateIsDraggingWorkspace()}createDragger(e,t){return new(xe(k.BLOCK_DRAGGER,this.creatorWorkspace.options,!0))(e,t)}doStart(e){if(!this.startWorkspace_)throw Error("Cannot start the touch gesture becauase the start workspace is undefined");this.isPinchZoomEnabled=this.startWorkspace_.options.zoomOptions&&this.startWorkspace_.options.zoomOptions.pinch,Eo(e)?this.cancel():(this.gestureHasStarted=!0,ho(),this.startWorkspace_.updateScreenCalculationsIfScrolled(),this.startWorkspace_.isMutator&&this.startWorkspace_.resize(),this.currentDropdownOwner=Wc(),this.startWorkspace_.hideChaff(!!this.flyout),this.startWorkspace_.markFocused(),this.mostRecentEvent=e,Pr(),ot(e)?this.handleRightClick(e):("pointerdown"===e.type.toLowerCase()&&"mouse"!==e.pointerType&&so(e,this),this.mouseDownXY=new S(e.clientX,e.clientY),this.bindMouseEvents(e),this.isEnding_||this.handleTouchStart(e)))}bindMouseEvents(e){this.boundEvents.push(L(document,"pointerdown",null,this.handleStart.bind(this),!0)),this.boundEvents.push(L(document,"pointermove",null,this.handleMove.bind(this),!0)),this.boundEvents.push(L(document,"pointerup",null,this.handleUp.bind(this),!0)),e.preventDefault(),e.stopPropagation()}handleStart(e){this.isDragging()||(this.handleTouchStart(e),this.isMultiTouch()&&it())}handleMove(e){this.isDragging()&&Ie(e)||!this.isMultiTouch()?(this.updateFromEvent(e),this.workspaceDragger?this.workspaceDragger.drag(this.currentDragDeltaXY):this.dragger&&this.dragger.onDrag(this.mostRecentEvent,this.currentDragDeltaXY),e.preventDefault(),e.stopPropagation()):this.isMultiTouch()&&(this.handleTouchMove(e),it())}handleUp(e){if(this.isDragging()||this.handleTouchEnd(e),!this.isMultiTouch()||this.isDragging()){if(!Ie(e))return;if(this.updateFromEvent(e),it(),this.isEnding_)return void console.log("Trying to end a gesture recursively.");this.isEnding_=!0,this.dragger?(ic.setIsActive(!1),this.dragger.onDragEnd(e,this.currentDragDeltaXY)):this.workspaceDragger?(ic.setIsActive(!1),this.workspaceDragger.endDrag(this.currentDragDeltaXY)):this.isBubbleClick()||this.isCommentClick()||(this.isFieldClick()?this.doFieldClick():this.isIconClick()?this.doIconClick():this.isBlockClick()?this.doBlockClick():this.isWorkspaceClick()&&this.doWorkspaceClick(e))}e.preventDefault(),e.stopPropagation(),this.dispose()}handleTouchStart(e){var t=no(e);this.cachedPoints.set(t,this.getTouchPoint(e));var i=Array.from(this.cachedPoints.keys());2===i.length&&(t=this.cachedPoints.get(i[0]),i=this.cachedPoints.get(i[1]),this.startDistance=S.distance(t,i),this.multiTouch=!0,e.preventDefault())}handleTouchMove(e){const t=no(e);this.cachedPoints.set(t,this.getTouchPoint(e)),this.isPinchZoomEnabled&&2===this.cachedPoints.size?this.handlePinch(e):(this.updateFromEvent(e),this.workspaceDragger?this.workspaceDragger.drag(this.currentDragDeltaXY):this.dragger&&this.dragger.onDrag(this.mostRecentEvent,this.currentDragDeltaXY),e.preventDefault(),e.stopPropagation())}handlePinch(e){var t=Array.from(this.cachedPoints.keys()),i=this.cachedPoints.get(t[0]);if(t=this.cachedPoints.get(t[1]),i=S.distance(i,t)/this.startDistance,this.previousScale>0&&this.previousScale<1/0){if(t=(t=i-this.previousScale)>0?5*t:6*t,!this.startWorkspace_)throw Error("Cannot handle a pinch because the start workspace is undefined");const s=this.startWorkspace_,n=Et(e,s.getParentSvg(),s.getInverseScreenCTM());s.zoom(n.x,n.y,t)}this.previousScale=i,e.preventDefault()}handleTouchEnd(e){e=no(e),this.cachedPoints.has(e)&&this.cachedPoints.delete(e),this.cachedPoints.size<2&&(this.cachedPoints.clear(),this.previousScale=0)}getTouchPoint(e){return this.startWorkspace_?new S(e.pageX,e.pageY):null}isMultiTouch(){return this.multiTouch}cancel(){this.isEnding_||(it(),this.dragger?this.dragger.onDragEnd(this.mostRecentEvent,this.currentDragDeltaXY):this.workspaceDragger&&this.workspaceDragger.endDrag(this.currentDragDeltaXY),this.dispose())}handleRightClick(e){this.targetBlock?(this.bringBlockToFront(),this.targetBlock.workspace.hideChaff(!!this.flyout),this.targetBlock.showContextMenu(e)):this.startBubble?this.startBubble.showContextMenu(e):this.startComment?(this.startComment.workspace.hideChaff(),this.startComment.showContextMenu(e)):this.startWorkspace_&&!this.flyout&&(this.startWorkspace_.hideChaff(),o.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.startWorkspace_),this.startWorkspace_.showContextMenu(e)),e.preventDefault(),e.stopPropagation(),ic.setIsActive(!1),this.dispose()}handleWsStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleWsStart, but the gesture had already been started.");this.setStartWorkspace(t),this.mostRecentEvent=e,this.startBlock||this.startBubble||this.startComment?this.startBlock&&o.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.startBlock):o.getFocusManager$$module$build$src$core$focus_manager().focusNode(t),this.doStart(e)}fireWorkspaceClick(e){B(new(P(b.CLICK))(null,e.id,"workspace"))}handleFlyoutStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleFlyoutStart, but the gesture had already been started.");this.setStartFlyout(t),this.handleWsStart(e,t.getWorkspace())}handleBlockStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleBlockStart, but the gesture had already been started.");this.setStartBlock(t),this.mostRecentEvent=e}handleBubbleStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleBubbleStart, but the gesture had already been started.");this.setStartBubble(t),this.mostRecentEvent=e}handleCommentStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleCommentStart, but the gesture had already been started.");this.setStartComment(t),this.mostRecentEvent=e}doFieldClick(){if(!this.startField)throw Error("Cannot do a field click because the start field is undefined");this.bringBlockToFront(),this.currentDropdownOwner!==this.startField&&this.startField.showEditor(this.mostRecentEvent)}doIconClick(){if(!this.startIcon)throw Error("Cannot do an icon click because the start icon is undefined");this.bringBlockToFront(),this.startIcon.onClick()}doBlockClick(){if(this.flyout&&this.flyout.autoClose){if(!this.targetBlock)throw Error("Cannot do a block click because the target block is undefined");if(this.flyout.isBlockCreatable(this.targetBlock)){o.getGroup$$module$build$src$core$events$utils()||o.setGroup$$module$build$src$core$events$utils(!0);var e=this.flyout.createBlock(this.targetBlock);e.snapToGrid(),e.bumpNeighbours(),o.getFocusManager$$module$build$src$core$focus_manager().focusNode(e)}}else{if(!this.startWorkspace_)throw Error("Cannot do a block click because the start workspace is undefined");e=new(P(b.CLICK))(this.startBlock,this.startWorkspace_.id,"block"),B(e)}this.bringBlockToFront(),o.setGroup$$module$build$src$core$events$utils(!1)}doWorkspaceClick(e){this.fireWorkspaceClick(this.startWorkspace_||this.creatorWorkspace)}bringBlockToFront(){this.targetBlock&&!this.flyout&&(o.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.targetBlock),this.targetBlock.bringToFront())}setStartField(e){if(this.gestureHasStarted)throw Error("Tried to call gesture.setStartField, but the gesture had already been started.");this.startField||(this.startField=e)}setStartIcon(e){if(this.gestureHasStarted)throw Error("Tried to call gesture.setStartIcon, but the gesture had already been started.");this.startIcon||(this.startIcon=e)}setStartBubble(e){this.startBubble||(this.startBubble=e)}setStartComment(e){this.startComment||(this.startComment=e)}setStartBlock(e){this.startBlock||this.startBubble||(this.startBlock=e,e.isInFlyout&&e!==e.getRootBlock()?this.setTargetBlock(e.getRootBlock()):this.setTargetBlock(e))}setTargetBlock(e){e.isShadow()?this.setTargetBlock(e.getParent()):(this.targetBlock=e,o.getFocusManager$$module$build$src$core$focus_manager().focusNode(e))}setStartWorkspace(e){this.startWorkspace_||(this.startWorkspace_=e)}setStartFlyout(e){this.flyout||(this.flyout=e)}isBubbleClick(){return!!this.startBubble&&!this.hasExceededDragRadius}isCommentClick(){return!!this.startComment&&!this.hasExceededDragRadius}isBlockClick(){return!(!this.startBlock||this.hasExceededDragRadius||this.isFieldClick()||this.isIconClick())}isFieldClick(){return!!this.startField&&this.startField.isClickable()&&!this.hasExceededDragRadius&&(!this.flyout||this.startField.isClickableInFlyout(this.flyout.autoClose))}isIconClick(){if(!this.startIcon)return!1;const e=!this.flyout||!this.startIcon.isClickableInFlyout||this.startIcon.isClickableInFlyout(this.flyout.autoClose);return!this.hasExceededDragRadius&&e}isWorkspaceClick(){return!(this.startBlock||this.startBubble||this.startField||this.hasExceededDragRadius)}getCurrentDragger(){let e,t;return null!=(t=null!=(e=this.workspaceDragger)?e:this.dragger)?t:null}isDragging(){return this.dragging}hasStarted(){return this.gestureHasStarted}static inProgress(){const e=Yi();for(let i,t=0;i=e[t];t++)if(i.currentGesture_)return!0;return!1}},uu=class{constructor(e,t){let i,s,n;this.pattern=e,this.scale=1,this.spacing=null!=(i=t.spacing)?i:0,this.length=null!=(s=t.length)?s:1,this.line2=(this.line1=e.firstChild)&&this.line1.nextSibling,this.snapToGrid=null!=(n=t.snap)&&n}setSpacing(e){this.spacing=e,this.update(this.scale)}getSpacing(){return this.spacing}setLength(e){this.length=e,this.update(this.scale)}getLength(){return this.length}setSnapToGrid(e){this.snapToGrid=e}shouldSnap(){return this.snapToGrid}getPatternId(){return this.pattern.id}update(e){this.scale=e;var t=this.spacing*e;this.pattern.setAttribute("width",`${t}`),this.pattern.setAttribute("height",`${t}`);let i=(t=Math.floor(this.spacing/2)+.5)-this.length/2,s=t+this.length/2;i*=e,s*=e,this.setLineAttributes(this.line1,e,i,s,t*=e,t),this.setLineAttributes(this.line2,e,t,t,i,s)}setLineAttributes(e,t,i,s,n,r){e&&(e.setAttribute("stroke-width",`${t}`),e.setAttribute("x1",`${i}`),e.setAttribute("y1",`${n}`),e.setAttribute("x2",`${s}`),e.setAttribute("y2",`${r}`))}moveTo(e,t){this.pattern.setAttribute("x",`${e}`),this.pattern.setAttribute("y",`${t}`)}alignXY(e){var t=this.getSpacing();const i=t/2,s=Math.round(Math.round((e.x-i)/t)*t+i);return t=Math.round(Math.round((e.y-i)/t)*t+i),s===e.x&&t===e.y?e:new S(s,t)}static createDom(e,t,i,s){let n,r;if(e=I(f.PATTERN,{id:"blocklyGridPattern"+e,patternUnits:"userSpaceOnUse"},i),(null!=(n=t.length)?n:1)>0&&(null!=(r=t.spacing)?r:0)>0){let a;I(f.LINE,{stroke:t.colour},e),null!=(a=t.length)&&a&&I(f.LINE,{stroke:t.colour},e)}else I(f.LINE,{},e);return s&&s.style.setProperty("--blocklyGridPattern",`url(#${e.id})`),e}},Fp=class{constructor(){this.curNode=this.colour=null,this.type="marker"}getCurNode(){return this.curNode}setCurNode(e){this.curNode=e}dispose(){this.curNode=null}getSourceBlockFromNode(e){return e instanceof ie?e:e instanceof Q||e instanceof Le?e.getSourceBlock():null}getSourceBlock(){return this.getSourceBlockFromNode(this.getCurNode())}},du=class extends Fp{constructor(e){super(),this.workspace=e,this.type="cursor",this.potentialNodes=null}next(){var e=this.getCurNode();return e?((e=this.getNextNode(e,t=>{let i;return t instanceof ie&&!(null!=(i=t.outputConnection)&&i.targetBlock())||t instanceof jt},!0))&&this.setCurNode(e),e):null}in(){var e=this.getCurNode();return e?((e=this.getNextNode(e,()=>!0,!0))&&this.setCurNode(e),e):null}prev(){var e=this.getCurNode();return e?((e=this.getPreviousNode(e,t=>{let i;return t instanceof ie&&!(null!=(i=t.outputConnection)&&i.targetBlock())||t instanceof jt},!0))&&this.setCurNode(e),e):null}out(){var e=this.getCurNode();return e?((e=this.getPreviousNode(e,()=>!0,!0))&&this.setCurNode(e),e):null}atEndOfLine(){var e=this.getCurNode();return!!e&&this.getNextNode(e,()=>!0,!0)===this.getNextNode(e,i=>{let s;return i instanceof ie&&!(null!=(s=i.outputConnection)&&s.targetBlock())},!0)}getNextNodeImpl(e,t,i=new Set){if(!e||i.has(e))return null;let s=this.workspace.getNavigator().getFirstChild(e)||this.workspace.getNavigator().getNextSibling(e);for(var n=e;n&&!s&&(n=this.workspace.getNavigator().getParent(n));)s=this.workspace.getNavigator().getNextSibling(n);return t(s)?s:s?(i.add(e),this.getNextNodeImpl(s,t,i)):null}getNextNode(e,t,i){return!e||!i&&this.getLastNode()===e?null:this.getNextNodeImpl(e,t)}getPreviousNodeImpl(e,t,i=new Set){if(!e||i.has(e))return null;const s=this.getRightMostChild(this.workspace.getNavigator().getPreviousSibling(e),e)||this.workspace.getNavigator().getParent(e);return t(s)?s:s?(i.add(e),this.getPreviousNodeImpl(s,t,i)):null}getPreviousNode(e,t,i){return!e||!i&&this.getFirstNode()===e?null:this.getPreviousNodeImpl(e,t)}getRightMostChild(e,t){if(!e)return e;let i=this.workspace.getNavigator().getFirstChild(e);if(!i||i===t)return e;for(e=i;e&&e!==t;e=this.workspace.getNavigator().getNextSibling(i))i=e;return this.getRightMostChild(i,t)}preDelete(e){var i,t=this.getCurNode();let s,n;t=t?[t]:[];const r=null!=(n=null==(i=e.previousConnection)?void 0:i.targetConnection)?n:null==(s=e.outputConnection)?void 0:s.targetConnection;r&&t.push(r),(i=e.getNextBlock())&&t.push(i),(e=e.getParent())&&t.push(e),t.push(this.workspace),this.potentialNodes=t}postDelete(){const e=this.potentialNodes;if(this.potentialNodes=null,!e)throw Error("must call preDelete first");for(const t of e){let i;if(null==(i=this.getSourceBlockFromNode(t))||!i.disposed)return void this.setCurNode(t)}throw Error("no valid nodes in this.potentialNodes")}getCurNode(){return o.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode()}setCurNode(e){o.getFocusManager$$module$build$src$core$focus_manager().focusNode(e),e instanceof ie?e.workspace.scrollBoundsIntoView(e.getBoundingRectangleWithoutChildren()):e instanceof Q?(e=e.getSourceBlock()).workspace.scrollBoundsIntoView(e.getBoundingRectangleWithoutChildren()):e instanceof jt&&e.workspace.scrollBoundsIntoView(e.getBoundingRectangle())}getFirstNode(){return this.workspace.getNavigator().getFirstChild(this.workspace)}getLastNode(){const e=this.getFirstNode();return this.getPreviousNode(e,()=>!0,!0)}};U(k.CURSOR,ct,du);var hu=class{constructor(e){this.workspace=e,this.markers=new Map,this.cursor=new du(this.workspace)}registerMarker(e,t){this.markers.has(e)&&this.unregisterMarker(e),this.markers.set(e,t)}unregisterMarker(e){const t=this.markers.get(e);if(!t)throw Error("Marker with ID "+e+" does not exist. Can only unregister markers that exist.");t.dispose(),this.markers.delete(e)}getCursor(){return this.cursor}getMarker(e){return this.markers.get(e)||null}setCursor(e){this.cursor=e}dispose(){const e=Object.keys(this.markers);for(let i,t=0;i=e[t];t++)this.unregisterMarker(i);this.markers.clear(),this.cursor.dispose()}};hu.LOCAL_MARKER="local_marker_1";var pu=class extends ee{constructor(e,t,i){super(e,t,i,pu.createTextArea()),this.workspace=e,this.anchor=t,this.ownerRect=i,this.resizePointerMoveListener=this.resizePointerUpListener=null,this.textChangeListeners=[],this.sizeChangeListeners=[],this.locationChangeListeners=[],this.text="",this.DEFAULT_SIZE=new j(160+ee.DOUBLE_BORDER,80+ee.DOUBLE_BORDER),this.MIN_SIZE=new j(45+ee.DOUBLE_BORDER,20+ee.DOUBLE_BORDER),this.editable=!0,A(this.svgRoot,"blocklyTextInputBubble"),this.textArea=this.getFocusableElement(),this.inputRoot=this.createEditor(this.contentContainer,this.textArea),this.resizeGroup=this.createResizeHandle(this.svgRoot,e),this.setSize(this.DEFAULT_SIZE,!0)}getText(){return this.text}setText(e){this.text=e,this.textArea.value=e,this.onTextChange()}setEditable(e){(this.editable=e)?this.textArea.removeAttribute("readonly"):this.textArea.setAttribute("readonly","")}isEditable(){return this.editable}addTextChangeListener(e){this.textChangeListeners.push(e)}addSizeChangeListener(e){this.sizeChangeListeners.push(e)}addLocationChangeListener(e){this.locationChangeListeners.push(e)}static createTextArea(){const e=document.createElementNS(po,"textarea");return e.className="blocklyTextarea blocklyText",e}createEditor(e,t){e=I(f.FOREIGNOBJECT,{x:ee.BORDER_WIDTH,y:ee.BORDER_WIDTH},e);const i=document.createElementNS(po,"body");return i.setAttribute("xmlns",po),i.className="blocklyMinimalBody",t.setAttribute("dir",this.workspace.RTL?"RTL":"LTR"),i.appendChild(t),e.appendChild(i),this.bindTextAreaEvents(t),e}bindTextAreaEvents(e){L(e,"wheel",this,t=>{t.stopPropagation()}),L(e,"pointerdown",this,t=>{t.stopPropagation(),Ae()}),L(e,"change",this,this.onTextChange)}createResizeHandle(e,t){return e=I(f.IMAGE,{class:"blocklyResizeHandle",href:`${t.options.pathToMedia}resize-handle.svg`},e),L(e,"pointerdown",this,this.onResizePointerDown),e}setSize(e,t=!1){e.width=Math.max(e.width,this.MIN_SIZE.width),e.height=Math.max(e.height,this.MIN_SIZE.height);const i=e.width-ee.DOUBLE_BORDER,s=e.height-ee.DOUBLE_BORDER;this.inputRoot.setAttribute("width",`${i}`),this.inputRoot.setAttribute("height",`${s}`),this.resizeGroup.setAttribute("y",`${s}`),this.resizeGroup.setAttribute("x",this.workspace.RTL?""+-ee.DOUBLE_BORDER:`${i}`),super.setSize(e,t),this.onSizeChange()}getSize(){return super.getSize()}moveDuringDrag(e){super.moveDuringDrag(e),this.onLocationChange()}setPositionRelativeToAnchor(e,t){super.setPositionRelativeToAnchor(e,t),this.onLocationChange()}positionByRect(e=new z(0,0,0,0)){super.positionByRect(e),this.onLocationChange()}onResizePointerDown(e){this.bringToFront(),ot(e)||(vi(this.workspace,e,new S(this.workspace.RTL?-this.getSize().width:this.getSize().width,this.getSize().height)),this.resizePointerUpListener=L(document,"pointerup",this,this.onResizePointerUp),this.resizePointerMoveListener=L(document,"pointermove",this,this.onResizePointerMove),this.workspace.hideChaff()),e.stopPropagation()}onResizePointerUp(e){Ae(),this.resizePointerUpListener&&(K(this.resizePointerUpListener),this.resizePointerUpListener=null),this.resizePointerMoveListener&&(K(this.resizePointerMoveListener),this.resizePointerMoveListener=null)}onResizePointerMove(e){e=yi(this.workspace,e),this.setSize(new j(this.workspace.RTL?-e.x:e.x,e.y),!1),this.onSizeChange()}onTextChange(){this.text=this.textArea.value;for(const e of this.textChangeListeners)e()}onSizeChange(){for(const e of this.sizeChangeListeners)e()}onLocationChange(){for(const e of this.locationChangeListeners)e()}};Pt("\n.blocklyTextInputBubble .blocklyTextarea {\n  background-color: var(--commentFillColour);\n  border: 0;\n  box-sizing: border-box;\n  display: block;\n  outline: 0;\n  padding: 5px;\n  resize: none;\n  width: 100%;\n  height: 100%;\n}\n");var Up={};Up.register=Pd,Up.unregister=Dg;var mo=class extends qn{constructor(e){super(e),this.sourceBlock=e,this.textInputBubble=null,this.text="",this.bubbleSize=new j(160,80),this.bubbleVisiblity=!1}getType(){return mo.TYPE}initView(e){this.svgRoot||(super.initView(e),I(f.CIRCLE,{class:"blocklyIconShape",r:"8",cx:"8",cy:"8"},this.svgRoot),I(f.PATH,{class:"blocklyIconSymbol",d:"m6.8,10h2c0.003,-0.617 0.271,-0.962 0.633,-1.266 2.875,-2.4050.607,-5.534 -3.765,-3.874v1.7c3.12,-1.657 3.698,0.118 2.336,1.25-1.201,0.998 -1.201,1.528 -1.204,2.19z"},this.svgRoot),I(f.RECT,{class:"blocklyIconSymbol",x:"6.8",y:"10.78",height:"2",width:"2"},this.svgRoot),A(this.svgRoot,"blocklyCommentIcon"))}dispose(){let e;super.dispose(),null==(e=this.textInputBubble)||e.dispose()}getWeight(){return mo.WEIGHT}getSize(){return new j(17,17)}applyColour(){super.applyColour();const e=this.sourceBlock.getColour();let t;null==(t=this.textInputBubble)||t.setColour(e)}updateEditable(){const e=this,t=()=>super.updateEditable;return(0,y.asyncExecutePromiseGeneratorFunction)(function*(){t().call(e),e.bubbleIsVisible()&&(yield e.setBubbleVisible(!1),yield e.setBubbleVisible(!0))})}onLocationChange(e){const t=this.workspaceLocation;let i;super.onLocationChange(e),this.bubbleLocation&&(e=S.difference(this.workspaceLocation,t),this.bubbleLocation=S.sum(this.bubbleLocation,e)),e=this.getAnchorLocation(),null==(i=this.textInputBubble)||i.setAnchorLocation(e)}setText(e){const t=this.text;let i;B(new(P(b.BLOCK_CHANGE))(this.sourceBlock,"comment",null,t,e)),this.text=e,null==(i=this.textInputBubble)||i.setText(this.text)}getText(){return this.text}setBubbleSize(e){let t;this.bubbleSize=e,null==(t=this.textInputBubble)||t.setSize(this.bubbleSize,!0)}getBubbleSize(){return this.bubbleSize}setBubbleLocation(e){let t;this.bubbleLocation=e,null==(t=this.textInputBubble)||t.moveDuringDrag(e)}getBubbleLocation(){return this.bubbleLocation}saveState(){if(this.text){const e={text:this.text,pinned:this.bubbleIsVisible(),height:this.bubbleSize.height,width:this.bubbleSize.width},t=this.getBubbleLocation();return t&&(e.x=this.sourceBlock.workspace.RTL?this.sourceBlock.workspace.getWidth()-(t.x+this.bubbleSize.width):t.x,e.y=t.y),e}return null}loadState(e){let t,i,s,n;this.text=null!=(t=e.text)?t:"",this.bubbleSize=new j(null!=(i=e.width)?i:160,null!=(s=e.height)?s:80),this.bubbleVisiblity=null!=(n=e.pinned)&&n,this.setBubbleVisible(this.bubbleVisiblity);let r=e.x;const a=e.y;Ht().then(()=>{r&&a&&(r=this.sourceBlock.workspace.RTL?this.sourceBlock.workspace.getWidth()-(r+this.bubbleSize.width):r,this.setBubbleLocation(new S(r,a)))})}onClick(){super.onClick(),this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}onTextChange(){if(this.textInputBubble){var e=this.textInputBubble.getText();this.text!==e&&(B(new(P(b.BLOCK_CHANGE))(this.sourceBlock,"comment",null,this.text,e)),this.text=e)}}onSizeChange(){this.textInputBubble&&(this.bubbleSize=this.textInputBubble.getSize())}onBubbleLocationChange(){this.textInputBubble&&(this.bubbleLocation=this.textInputBubble.getRelativeToSurfaceXY())}bubbleIsVisible(){return this.bubbleVisiblity}setBubbleVisible(e){const t=this;return(0,y.asyncExecutePromiseGeneratorFunction)(function*(){t.bubbleVisiblity!==e&&(t.bubbleVisiblity=e,yield Ht(),!t.sourceBlock.rendered||t.sourceBlock.isInFlyout||t.sourceBlock.isInsertionMarker()||(e?(t.sourceBlock.isEditable()?t.showEditableBubble():t.showNonEditableBubble(),t.applyColour()):t.hideBubble(),B(new(P(b.BUBBLE_OPEN))(t.sourceBlock,e,"comment"))))})}getBubble(){return this.textInputBubble}showEditableBubble(){let e,t;this.createBubble(),null==(e=this.textInputBubble)||e.addTextChangeListener(()=>this.onTextChange()),null==(t=this.textInputBubble)||t.addSizeChangeListener(()=>this.onSizeChange())}showNonEditableBubble(){let e;this.createBubble(),null==(e=this.textInputBubble)||e.setEditable(!1)}createBubble(){this.textInputBubble=new pu(this.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect()),this.textInputBubble.setText(this.getText()),this.textInputBubble.setSize(this.bubbleSize,!0),this.bubbleLocation&&this.textInputBubble.moveDuringDrag(this.bubbleLocation),this.textInputBubble.addTextChangeListener(()=>this.onTextChange()),this.textInputBubble.addSizeChangeListener(()=>this.onSizeChange()),this.textInputBubble.addLocationChangeListener(()=>this.onBubbleLocationChange())}hideBubble(){let e;null==(e=this.textInputBubble)||e.dispose(),this.textInputBubble=null}getAnchorLocation(){return S.sum(this.workspaceLocation,new S(8.5,8.5))}getBubbleOwnerRect(){return this.sourceBlock.getBoundingRectangleWithoutChildren()}};mo.TYPE=Ce.COMMENT,mo.WEIGHT=3,Pd(mo.TYPE,mo);var Bi={};Bi.CommentIcon=mo,Bi.Icon=qn,Bi.IconType=Ce,Bi.MutatorIcon=o.MutatorIcon$$module$build$src$core$icons$mutator_icon,Bi.WarningIcon=Jt,Bi.exceptions=Cm,Bi.registry=Up,o.Names$$module$build$src$core$names=class{constructor(e,t){this.db=new Map,this.dbReverse=new Set,this.variableMap=null,this.variablePrefix=t||"",this.reservedWords=new Set(e?e.split(","):[])}reset(){this.db.clear(),this.dbReverse.clear(),this.variableMap=null}setVariableMap(e){this.variableMap=e}getNameForUserVariable(e){return this.variableMap?(e=this.variableMap.getVariableById(e))?e.getName():null:(console.warn("Deprecated call to Names.prototype.getName without defining a variable map. To fix, add the following code in your generator's init() function:\nBlockly.YourGeneratorName.nameDB_.setVariableMap(workspace.getVariableMap());"),null)}populateVariables(e){e=o.allUsedVarModels$$module$build$src$core$variables(e);for(let t=0;t<e.length;t++)this.getName(e[t].getId(),o.NameType$$module$build$src$core$names.VARIABLE)}populateProcedures(e){throw Error("The implementation of populateProcedures should be monkey-patched in by blockly.ts")}getName(e,t){let i=e;t===o.NameType$$module$build$src$core$names.VARIABLE&&(e=this.getNameForUserVariable(e))&&(i=e),e=i.toLowerCase();const s=t===o.NameType$$module$build$src$core$names.VARIABLE||t===o.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix:"";this.db.has(t)||this.db.set(t,new Map);const n=this.db.get(t);return n.has(e)?s+n.get(e):(t=this.getDistinctName(i,t),n.set(e,t.substr(s.length)),t)}getUserNames(e){let t;return(e=null==(t=this.db.get(e))?void 0:t.keys())?Array.from(e):[]}getDistinctName(e,t){e=this.safeName(e);let s,n,r,i=null;for(;this.dbReverse.has(e+(null!=(s=i)?s:""))||this.reservedWords.has(e+(null!=(n=i)?n:""));)i=i?i+1:2;return e+=null!=(r=i)?r:"",this.dbReverse.add(e),(t===o.NameType$$module$build$src$core$names.VARIABLE||t===o.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix:"")+e}safeName(e){return e?(e=encodeURI(e.replace(/ /g,"_")).replace(/[^\w]/g,"_"),"0123456789".includes(e[0])&&(e="my_"+e)):e=o.Msg$$module$build$src$core$msg.UNNAMED_KEY||"unnamed",e}static equals(e,t){return e.toLowerCase()===t.toLowerCase()}},function(e){(e=e.NameType||(e.NameType={})).DEVELOPER_VARIABLE="DEVELOPER_VARIABLE",e.VARIABLE="VARIABLE",e.PROCEDURE="PROCEDURE"}(o.Names$$module$build$src$core$names||(o.Names$$module$build$src$core$names={})),o.NameType$$module$build$src$core$names=o.Names$$module$build$src$core$names.NameType,o.Names$$module$build$src$core$names.DEVELOPER_VARIABLE_TYPE=o.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE,{NameType:o.NameType$$module$build$src$core$names}.Names=o.Names$$module$build$src$core$names;var nc,Qe,Vp=class extends Map{constructor(){super()}set(e,t){return this.get(e)===t||(super.set(e,t),fl(t)&&t.startPublishing()),this}delete(e){const t=this.get(e);return(e=super.delete(e))&&(fl(t)&&t.stopPublishing(),e)}clear(){if(this.size)for(const e of this.keys())this.delete(e)}add(e){return this.set(e.getId(),e)}getProcedures(){return[...this.values()]}};nc="PROCEDURE",o.DEFAULT_ARG$$module$build$src$core$procedures="x",(Qe={CATEGORY_NAME:nc,DEFAULT_ARG:o.DEFAULT_ARG$$module$build$src$core$procedures}).ObservableProcedureMap=Vp,Qe.allProcedures=Tl,Qe.findLegalName=o.findLegalName$$module$build$src$core$procedures,Qe.flyoutCategory=Hd,Qe.getCallers=Zd,Qe.getDefinition=o.getDefinition$$module$build$src$core$procedures,Qe.internalFlyoutCategory=ga,Qe.isNameUsed=Ud,Qe.isProcedureBlock=Vo,Qe.mutateCallers=o.mutateCallers$$module$build$src$core$procedures,Qe.mutatorOpenListener=Gd,Qe.rename=o.rename$$module$build$src$core$procedures;var m=new class{constructor(){this.NONE=0,this.FIELD=1,this.HAT=2,this.ICON=4,this.SPACER=8,this.BETWEEN_ROW_SPACER=16,this.IN_ROW_SPACER=32,this.EXTERNAL_VALUE_INPUT=64,this.INPUT=128,this.INLINE_INPUT=256,this.STATEMENT_INPUT=512,this.CONNECTION=1024,this.PREVIOUS_CONNECTION=2048,this.NEXT_CONNECTION=4096,this.OUTPUT_CONNECTION=8192,this.CORNER=16384,this.LEFT_SQUARE_CORNER=32768,this.LEFT_ROUND_CORNER=65536,this.RIGHT_SQUARE_CORNER=131072,this.RIGHT_ROUND_CORNER=262144,this.JAGGED_EDGE=524288,this.ROW=1048576,this.TOP_ROW=2097152,this.BOTTOM_ROW=4194304,this.INPUT_ROW=8388608,this.LEFT_CORNER=this.LEFT_SQUARE_CORNER|this.LEFT_ROUND_CORNER,this.RIGHT_CORNER=this.RIGHT_SQUARE_CORNER|this.RIGHT_ROUND_CORNER,this.nextTypeValue_=16777216}getType(e){return Object.prototype.hasOwnProperty.call(this,e)||(this[e]=this.nextTypeValue_,this.nextTypeValue_<<=1),this[e]}isField(e){return(e.type&this.FIELD)>=1}isHat(e){return(e.type&this.HAT)>=1}isIcon(e){return(e.type&this.ICON)>=1}isSpacer(e){return(e.type&this.SPACER)>=1}isInRowSpacer(e){return(e.type&this.IN_ROW_SPACER)>=1}isSpacerRow(e){return(e.type&this.BETWEEN_ROW_SPACER)>=1}isInput(e){return(e.type&this.INPUT)>=1}isExternalInput(e){return(e.type&this.EXTERNAL_VALUE_INPUT)>=1}isInlineInput(e){return(e.type&this.INLINE_INPUT)>=1}isStatementInput(e){return(e.type&this.STATEMENT_INPUT)>=1}isPreviousConnection(e){return(e.type&this.PREVIOUS_CONNECTION)>=1}isNextConnection(e){return(e.type&this.NEXT_CONNECTION)>=1}isPreviousOrNextConnection(e){return this.isPreviousConnection(e)||this.isNextConnection(e)}isRoundCorner(e){return(e.type&this.LEFT_ROUND_CORNER)>=1||(e.type&this.RIGHT_ROUND_CORNER)>=1}isLeftRoundedCorner(e){return this.isRoundCorner(e)&&(e.type&this.LEFT_ROUND_CORNER)>=1}isRightRoundedCorner(e){return this.isRoundCorner(e)&&(e.type&this.RIGHT_ROUND_CORNER)>=1}isLeftSquareCorner(e){return(e.type&this.LEFT_SQUARE_CORNER)>=1}isRightSquareCorner(e){return(e.type&this.RIGHT_SQUARE_CORNER)>=1}isCorner(e){return(e.type&this.CORNER)>=1}isJaggedEdge(e){return(e.type&this.JAGGED_EDGE)>=1}isRow(e){return(e.type&this.ROW)>=1}isBetweenRowSpacer(e){return(e.type&this.BETWEEN_ROW_SPACER)>=1}isTopRow(e){return(e.type&this.TOP_ROW)>=1}isBottomRow(e){return(e.type&this.BOTTOM_ROW)>=1}isTopOrBottomRow(e){return this.isTopRow(e)||this.isBottomRow(e)}isInputRow(e){return(e.type&this.INPUT_ROW)>=1}},Qt=class{constructor(e){this.centerline=this.xPos=this.height=this.width=0,this.constants_=e,this.type=m.NONE,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}},Xn=class{constructor(e){this.elements=[],this.xPos=this.yPos=this.widthWithConnectedBlocks=this.minWidth=this.minHeight=this.width=this.height=0,this.hasStatement=this.hasExternalInput=!1,this.statementEdge=0,this.hasJaggedEdge=this.hasDummyInput=this.hasInlineInput=!1,this.align=null,this.constants_=e,this.type=m.ROW,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}getLastInput(){for(let e=this.elements.length-1;e>=0;e--){const t=this.elements[e];if(m.isInput(t))return t}return null}measure(){throw Error("Unexpected attempt to measure a base Row.")}startsWithElemSpacer(){return!0}endsWithElemSpacer(){return!0}getFirstSpacer(){for(let e=0;e<this.elements.length;e++){const t=this.elements[e];if(m.isInRowSpacer(t))return t}return null}getLastSpacer(){for(let e=this.elements.length-1;e>=0;e--){const t=this.elements[e];if(m.isInRowSpacer(t))return t}return null}},gu=class extends Xn{constructor(e){super(e),this.hasNextConnection=!1,this.connection=null,this.baseline=this.descenderHeight=0,this.type|=m.BOTTOM_ROW}hasLeftSquareCorner(e){return!!e.outputConnection||!!e.getNextBlock()}hasRightSquareCorner(e){return!0}measure(){let e=0,t=0,i=0;for(let s=0;s<this.elements.length;s++){const n=this.elements[s];t+=n.width,m.isSpacer(n)||(m.isNextConnection(n)?i=Math.max(i,n.height):e=Math.max(e,n.height))}this.width=Math.max(this.minWidth,t),this.height=Math.max(this.minHeight,e)+i,this.descenderHeight=i,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return!1}endsWithElemSpacer(){return!1}},Pi=class extends Qt{constructor(e,t){super(e),this.connectionModel=t,this.type|=m.CONNECTION,this.shape=this.constants_.shapeFor(t),this.isDynamicShape="isDynamic"in this.shape&&this.shape.isDynamic,this.highlighted=t.isHighlighted()}},rc=class extends Pi{constructor(e,t){super(e,t.connection),this.input=t,this.connectionOffsetY=this.connectionOffsetX=0,this.type|=m.INPUT,this.align=t.align,(this.connectedBlock=t.connection&&t.connection.targetBlock()?t.connection.targetBlock():null)?(e=this.connectedBlock.getHeightWidth(),this.connectedBlockWidth=e.width,this.connectedBlockHeight=e.height):this.connectedBlockHeight=this.connectedBlockWidth=0}},$u=class extends rc{constructor(e,t){super(e,t),this.height=0,this.type|=m.EXTERNAL_VALUE_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight-this.constants_.TAB_OFFSET_FROM_TOP-this.constants_.MEDIUM_PADDING:this.shape.height,this.width=this.shape.width+this.constants_.EXTERNAL_VALUE_INPUT_PADDING,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP,this.connectionHeight=this.shape.height,this.connectionWidth=this.shape.width}},mu=class extends Qt{constructor(e,t,i){super(e),this.field=t,this.parentInput=i,this.isEditable=t.EDITABLE,this.flipRtl=t.getFlipRtl(),this.type|=m.FIELD,e=this.field.getSize(),this.height=e.height,this.width=e.width}},Gp=class extends Qt{constructor(e){super(e),this.type|=m.HAT,this.height=this.constants_.START_HAT.height,this.width=this.constants_.START_HAT.width,this.ascenderHeight=this.height}},Zp=class extends Qt{constructor(e,t){super(e),this.icon=t,this.flipRtl=!1,this.type|=m.ICON,e=t.getSize(),this.height=e.height,this.width=e.width}},dt=class extends Qt{constructor(e,t){super(e),this.type|=m.SPACER|m.IN_ROW_SPACER,this.width=t,this.height=this.constants_.SPACER_DEFAULT_HEIGHT}},_u=class extends rc{constructor(e,t){super(e,t),this.type|=m.INLINE_INPUT,this.connectedBlock?(this.width=this.connectedBlockWidth,this.height=this.connectedBlockHeight):(this.height=this.constants_.EMPTY_INLINE_INPUT_HEIGHT,this.width=this.constants_.EMPTY_INLINE_INPUT_PADDING),this.connectionHeight=this.isDynamicShape?this.shape.height(this.height):this.shape.height,this.connectionWidth=this.isDynamicShape?this.shape.width(this.height):this.shape.width,this.connectedBlock||(this.width+=this.connectionWidth*(this.isDynamicShape?2:1)),this.connectionOffsetY="connectionOffsetY"in this.shape?this.shape.connectionOffsetY(this.connectionHeight):this.constants_.TAB_OFFSET_FROM_TOP,this.connectionOffsetX="connectionOffsetX"in this.shape?this.shape.connectionOffsetX(this.connectionWidth):0}},bu=class extends Xn{constructor(e){super(e),this.connectedBlockWidths=0,this.type|=m.INPUT_ROW}measure(){this.width=this.minWidth,this.height=this.minHeight;let e=0;for(let t=0;t<this.elements.length;t++){const i=this.elements[t];this.width+=i.width,m.isInput(i)&&(m.isStatementInput(i)?e+=i.connectedBlockWidth:m.isExternalInput(i)&&0!==i.connectedBlockWidth&&(e+=i.connectedBlockWidth-i.connectionWidth)),m.isSpacer(i)||(this.height=Math.max(this.height,i.height))}this.connectedBlockWidths=e,this.widthWithConnectedBlocks=this.width+e}endsWithElemSpacer(){return!this.hasExternalInput&&!this.hasStatement}},Wp=class extends Qt{constructor(e){super(e),this.type|=m.JAGGED_EDGE,this.height=this.constants_.JAGGED_TEETH.height,this.width=this.constants_.JAGGED_TEETH.width}},qp=class extends Pi{constructor(e,t){super(e,t),this.type|=m.NEXT_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},zp=class extends Pi{constructor(e,t){super(e,t),this.connectionOffsetX=0,this.type|=m.OUTPUT_CONNECTION,this.height=this.isDynamicShape?0:this.shape.height,this.startX=this.width=this.isDynamicShape?0:this.shape.width,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP}},jp=class extends Pi{constructor(e,t){super(e,t),this.type|=m.PREVIOUS_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},Yn=class extends Qt{constructor(e,t){super(e),this.type=(t&&"left"!==t?m.RIGHT_ROUND_CORNER:m.LEFT_ROUND_CORNER)|m.CORNER,this.width=this.constants_.CORNER_RADIUS,this.height=this.constants_.CORNER_RADIUS/2}},fu=class extends Xn{constructor(e,t,i){super(e),this.height=t,this.width=i,this.precedesStatement=this.followsStatement=!1,this.widthWithConnectedBlocks=0,this.type|=m.SPACER|m.BETWEEN_ROW_SPACER,this.elements=[new dt(this.constants_,i)]}measure(){}},Kn=class extends Qt{constructor(e,t){super(e),this.type=(t&&"left"!==t?m.RIGHT_SQUARE_CORNER:m.LEFT_SQUARE_CORNER)|m.CORNER,this.width=this.height=this.constants_.NO_PADDING}},lc=class extends rc{constructor(e,t){super(e,t),this.type|=m.STATEMENT_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight+this.constants_.STATEMENT_BOTTOM_SPACER:this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT,this.width=this.constants_.STATEMENT_INPUT_NOTCH_OFFSET+this.shape.width}},Tu=class extends Xn{constructor(e){super(e),this.ascenderHeight=this.capline=0,this.hasPreviousConnection=!1,this.connection=null,this.type|=m.TOP_ROW}hasLeftSquareCorner(e){const t=(e.hat?"cap"===e.hat:this.constants_.ADD_START_HATS)&&!e.outputConnection&&!e.previousConnection,i=e.getPreviousBlock();return!!e.outputConnection||t||!!i&&i.getNextBlock()===e}hasRightSquareCorner(e){return!0}measure(){let e=0,t=0,i=0;for(let s=0;s<this.elements.length;s++){const n=this.elements[s];t+=n.width,m.isSpacer(n)||(m.isHat(n)?i=Math.max(i,n.ascenderHeight):e=Math.max(e,n.height))}this.width=Math.max(this.minWidth,t),this.height=Math.max(this.minHeight,e)+i,this.capline=this.ascenderHeight=i,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return!1}endsWithElemSpacer(){return!1}},cc=class{constructor(){this.NO_PADDING=0,this.SMALL_PADDING=3,this.MEDIUM_PADDING=5,this.MEDIUM_LARGE_PADDING=8,this.LARGE_PADDING=10,this.TAB_HEIGHT=15,this.TAB_OFFSET_FROM_TOP=5,this.TAB_VERTICAL_OVERLAP=2.5,this.TAB_WIDTH=8,this.NOTCH_WIDTH=15,this.NOTCH_HEIGHT=4,this.MIN_BLOCK_WIDTH=12,this.EMPTY_BLOCK_SPACER_HEIGHT=16,this.CORNER_RADIUS=8,this.NOTCH_OFFSET_LEFT=15,this.STATEMENT_BOTTOM_SPACER=0,this.STATEMENT_INPUT_PADDING_LEFT=20,this.BETWEEN_STATEMENT_PADDING_Y=4,this.ADD_START_HATS=!1,this.START_HAT_HEIGHT=15,this.START_HAT_WIDTH=100,this.SPACER_DEFAULT_HEIGHT=15,this.MIN_BLOCK_HEIGHT=24,this.EMPTY_INLINE_INPUT_PADDING=14.5,this.EXTERNAL_VALUE_INPUT_PADDING=2,this.JAGGED_TEETH_HEIGHT=12,this.JAGGED_TEETH_WIDTH=6,this.FIELD_TEXT_FONTSIZE=11,this.FIELD_TEXT_FONTWEIGHT="normal",this.FIELD_TEXT_FONTFAMILY="sans-serif",this.FIELD_TEXT_BASELINE=this.FIELD_TEXT_HEIGHT=-1,this.FIELD_BORDER_RECT_RADIUS=4,this.FIELD_BORDER_RECT_HEIGHT=16,this.FIELD_BORDER_RECT_X_PADDING=5,this.FIELD_BORDER_RECT_Y_PADDING=3,this.FIELD_BORDER_RECT_COLOUR="#fff",this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!1,this.FIELD_DROPDOWN_SVG_ARROW_SIZE=12,this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=!1,this.FIELD_COLOUR_DEFAULT_WIDTH=26,this.defs=null,this.embossFilterId="",this.embossFilter=null,this.disabledPatternId="",this.disabledPattern=null,this.debugFilterId="",this.cssNode=this.debugFilter=null,this.CURSOR_COLOUR="#cc0a0a",this.MARKER_COLOUR="#4286f4",this.CURSOR_WS_WIDTH=100,this.WS_CURSOR_HEIGHT=5,this.CURSOR_STACK_PADDING=10,this.CURSOR_BLOCK_PADDING=2,this.CURSOR_STROKE_WIDTH=4,this.FULL_BLOCK_FIELDS=!1,this.INSERTION_MARKER_COLOUR="#000000",this.INSERTION_MARKER_OPACITY=.2,this.SHAPES={PUZZLE:1,NOTCH:2},this.TALL_INPUT_FIELD_OFFSET_Y=this.MEDIUM_PADDING,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=this.DUMMY_INPUT_MIN_HEIGHT=this.TAB_HEIGHT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT,this.TOP_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.EMPTY_INLINE_INPUT_HEIGHT=this.TAB_HEIGHT+11,this.EMPTY_STATEMENT_INPUT_HEIGHT=this.MIN_BLOCK_HEIGHT,this.START_POINT=ae(0,0),this.FIELD_TEXT_BASELINE_CENTER=!0,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_DROPDOWN_SVG_ARROW_DATAURI="data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMi43MSIgaGVpZ2h0PSI4Ljc5IiB2aWV3Qm94PSIwIDAgMTIuNzEgOC43OSI+PHRpdGxlPmRyb3Bkb3duLWFycm93PC90aXRsZT48ZyBvcGFjaXR5PSIwLjEiPjxwYXRoIGQ9Ik0xMi43MSwyLjQ0QTIuNDEsMi40MSwwLDAsMSwxMiw0LjE2TDguMDgsOC4wOGEyLjQ1LDIuNDUsMCwwLDEtMy40NSwwTDAuNzIsNC4xNkEyLjQyLDIuNDIsMCwwLDEsMCwyLjQ0LDIuNDgsMi40OCwwLDAsMSwuNzEuNzFDMSwwLjQ3LDEuNDMsMCw2LjM2LDBTMTEuNzUsMC40NiwxMiwuNzFBMi40NCwyLjQ0LDAsMCwxLDEyLjcxLDIuNDRaIiBmaWxsPSIjMjMxZjIwIi8+PC9nPjxwYXRoIGQ9Ik02LjM2LDcuNzlhMS40MywxLjQzLDAsMCwxLTEtLjQyTDEuNDIsMy40NWExLjQ0LDEuNDQsMCwwLDEsMC0yYzAuNTYtLjU2LDkuMzEtMC41Niw5Ljg3LDBhMS40NCwxLjQ0LDAsMCwxLDAsMkw3LjM3LDcuMzdBMS40MywxLjQzLDAsMCwxLDYuMzYsNy43OVoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=",this.FIELD_COLOUR_DEFAULT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_CHECKBOX_X_OFFSET=this.FIELD_BORDER_RECT_X_PADDING-3,this.randomIdentifier=String(Math.random()).substring(2)}init(){this.JAGGED_TEETH=this.makeJaggedTeeth(),this.NOTCH=this.makeNotch(),this.START_HAT=this.makeStartHat(),this.PUZZLE_TAB=this.makePuzzleTab(),this.INSIDE_CORNERS=this.makeInsideCorners(),this.OUTSIDE_CORNERS=this.makeOutsideCorners()}setTheme(e){this.blockStyles=Object.create(null);const t=e.blockStyles;for(const i in t)this.blockStyles[i]=this.validatedBlockStyle_(t[i]);this.setDynamicProperties_(e)}setDynamicProperties_(e){this.setFontConstants_(e),this.setComponentConstants_(e),this.ADD_START_HATS=void 0!==e.startHats?e.startHats:this.ADD_START_HATS}setFontConstants_(e){e.fontStyle&&e.fontStyle.family&&(this.FIELD_TEXT_FONTFAMILY=e.fontStyle.family),e.fontStyle&&e.fontStyle.weight&&(this.FIELD_TEXT_FONTWEIGHT=e.fontStyle.weight),e.fontStyle&&e.fontStyle.size&&(this.FIELD_TEXT_FONTSIZE=e.fontStyle.size),e=ir("Hg",this.FIELD_TEXT_FONTSIZE+"pt",this.FIELD_TEXT_FONTWEIGHT,this.FIELD_TEXT_FONTFAMILY),this.FIELD_TEXT_HEIGHT=e.height,this.FIELD_TEXT_BASELINE=e.baseline}setComponentConstants_(e){this.CURSOR_COLOUR=e.getComponentStyle("cursorColour")||this.CURSOR_COLOUR,this.MARKER_COLOUR=e.getComponentStyle("markerColour")||this.MARKER_COLOUR,this.INSERTION_MARKER_COLOUR=e.getComponentStyle("insertionMarkerColour")||this.INSERTION_MARKER_COLOUR,this.INSERTION_MARKER_OPACITY=Number(e.getComponentStyle("insertionMarkerOpacity"))||this.INSERTION_MARKER_OPACITY}getBlockStyleForColour(e){const t="auto_"+e;return this.blockStyles[t]||(this.blockStyles[t]=this.createBlockStyle_(e)),{style:this.blockStyles[t],name:t}}getBlockStyle(e){return this.blockStyles[e||""]||(e&&e.startsWith("auto_")?this.getBlockStyleForColour(e.substring(5)).style:this.createBlockStyle_("#000000"))}createBlockStyle_(e){return this.validatedBlockStyle_({colourPrimary:e})}validatedBlockStyle_(e){const t={};return e&&Object.assign(t,e),e=d(t.colourPrimary||"#000"),t.colourPrimary=e.hex,t.colourSecondary=t.colourSecondary?d(t.colourSecondary).hex:this.generateSecondaryColour_(t.colourPrimary),t.colourTertiary=t.colourTertiary?d(t.colourTertiary).hex:this.generateTertiaryColour_(t.colourPrimary),t.hat=t.hat||"",t}generateSecondaryColour_(e){return Mo("#fff",e,.6)||e}generateTertiaryColour_(e){return Mo("#fff",e,.3)||e}dispose(){this.embossFilter&&J(this.embossFilter),this.disabledPattern&&J(this.disabledPattern),this.debugFilter&&J(this.debugFilter),this.cssNode=null}makeJaggedTeeth(){const e=this.JAGGED_TEETH_HEIGHT,t=this.JAGGED_TEETH_WIDTH;return{height:e,width:t,path:lt([D(t,e/4),D(2*-t,e/2),D(t,e/4)])}}makeStartHat(){const e=this.START_HAT_HEIGHT,t=this.START_HAT_WIDTH;return{height:.75*e,width:t,path:Pe("c",[D(30,-e),D(70,-e),D(t,0)])}}makePuzzleTab(){function e(r){const a=-(r=r?-1:1);var $=i/2;const C=$+2.5,F=$+.5,me=D(-t,r*$);return $=D(t,r*$),Pe("c",[D(0,r*C),D(-t,a*F),me])+Pe("s",[D(t,2.5*a),$])}const t=this.TAB_WIDTH,i=this.TAB_HEIGHT,s=e(!0),n=e(!1);return{type:this.SHAPES.PUZZLE,width:t,height:i,pathDown:n,pathUp:s}}makeNotch(){function e(a){return lt([D(a*s,i),D(3*a,0),D(a*s,-i)])}const t=this.NOTCH_WIDTH,i=this.NOTCH_HEIGHT,s=(t-3)/2,n=e(1),r=e(-1);return{type:this.SHAPES.NOTCH,width:t,height:i,pathLeft:n,pathRight:r}}makeInsideCorners(){const e=this.CORNER_RADIUS;return{width:e,height:e,pathTop:he("a","0 0,0",e,D(-e,e)),pathBottom:he("a","0 0,0",e,D(e,e))}}makeOutsideCorners(){const e=this.CORNER_RADIUS,t=ae(0,e)+he("a","0 0,1",e,D(e,-e)),i=he("a","0 0,1",e,D(e,e)),s=he("a","0 0,1",e,D(-e,-e));return{topLeft:t,topRight:i,bottomRight:he("a","0 0,1",e,D(-e,e)),bottomLeft:s,rightHeight:e}}shapeFor(e){switch(e.type){case N.INPUT_VALUE:case N.OUTPUT_VALUE:return this.PUZZLE_TAB;case N.PREVIOUS_STATEMENT:case N.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown connection type")}}createDom(e,t,i,s){this.injectCSS_(t,i),this.defs=I(f.DEFS,{},e),e=I(f.FILTER,{id:"blocklyEmbossFilter"+this.randomIdentifier},this.defs),I(f.FEGAUSSIANBLUR,{in:"SourceAlpha",stdDeviation:1,result:"blur"},e),t=I(f.FESPECULARLIGHTING,{in:"blur",surfaceScale:1,specularConstant:.5,specularExponent:10,"lighting-color":"white",result:"specOut"},e),I(f.FEPOINTLIGHT,{x:-5e3,y:-1e4,z:2e4},t),I(f.FECOMPOSITE,{in:"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"},e),I(f.FECOMPOSITE,{in:"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:0,k2:1,k3:1,k4:0},e),this.embossFilterId=e.id,this.embossFilter=e,e=I(f.PATTERN,{id:"blocklyDisabledPattern"+this.randomIdentifier,patternUnits:"userSpaceOnUse",width:10,height:10},this.defs),I(f.RECT,{width:10,height:10,fill:"#aaa"},e),I(f.PATH,{d:"M 0 0 L 10 10 M 10 0 L 0 10",stroke:"#cc0"},e),this.disabledPatternId=e.id,this.disabledPattern=e,this.createDebugFilter(),s&&(s.style.setProperty("--blocklyEmbossFilter",`url(#${this.embossFilterId})`),s.style.setProperty("--blocklyDisabledPattern",`url(#${this.disabledPatternId})`),s.style.setProperty("--blocklyDebugFilter",`url(#${this.debugFilterId})`))}createDebugFilter(){if(!this.debugFilter){const e=I(f.FILTER,{id:"blocklyDebugFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},this.defs),t=I(f.FECOMPONENTTRANSFER,{result:"outBlur"},e);I(f.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},t),I(f.FEFLOOD,{"flood-color":"#ff0000","flood-opacity":.5,result:"outColor"},e),I(f.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},e),this.debugFilterId=e.id,this.debugFilter=e}}injectCSS_(e,t){t=this.getCSS_(t),e="blockly-renderer-style-"+e,this.cssNode=document.getElementById(e);const i=t.join("\n");this.cssNode?this.cssNode.firstChild.textContent=i:((t=document.createElement("style")).id=e,e=document.createTextNode(i),t.appendChild(e),document.head.insertBefore(t,document.head.firstChild),this.cssNode=t)}getCSS_(e){return[`${e} .blocklyText, `,`${e} .blocklyFlyoutLabelText {`,`font: ${this.FIELD_TEXT_FONTWEIGHT} ${this.FIELD_TEXT_FONTSIZE}pt ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${e} .blocklyText {`,"fill: #fff;","}",`${e} .blocklyNonEditableField>rect,`,`${e} .blocklyEditableField>rect {`,`fill: ${this.FIELD_BORDER_RECT_COLOUR};`,"fill-opacity: .6;","stroke: none;","}",`${e} .blocklyNonEditableField>text,`,`${e} .blocklyEditableField>text {`,"fill: #000;","}",`${e} .blocklyFlyoutLabelText {`,"fill: #000;","}",`${e} .blocklyText.blocklyBubbleText {`,"fill: #000;","}",`${e} .blocklyEditableField:not(.blocklyEditing):hover>rect {`,"stroke: #fff;","stroke-width: 2;","}",`${e} .blocklyHtmlInput {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,`font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,"}",`${e} .blocklySelected>.blocklyPath {`,"stroke: #fc3;","stroke-width: 3px;","}",`${e} .blocklyHighlightedConnectionPath {`,"stroke: #fc3;","}",`${e} .blocklyReplaceable .blocklyPath {`,"fill-opacity: .5;","}",`${e} .blocklyReplaceable .blocklyPathLight,`,`${e} .blocklyReplaceable .blocklyPathDark {`,"display: none;","}",`${e} .blocklyInsertionMarker>.blocklyPath {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"]}},Eu={};Eu.ConstantProvider=cc,Eu.isDynamicShape=El,Eu.isNotch=qd,Eu.isPuzzleTab=Wd;var ac=class{constructor(e,t){this.inlinePath_=this.outlinePath_="",this.block_=e,this.info_=t,this.topLeft_=e.getRelativeToSurfaceXY(),this.constants_=t.getRenderer().getConstants()}draw(){this.drawOutline_(),this.drawInternals_(),this.updateConnectionHighlights(),this.block_.pathObject.setPath(this.outlinePath_+"\n"+this.inlinePath_),this.info_.RTL&&this.block_.pathObject.flipRTL(),this.recordSizeOnBlock_()}recordSizeOnBlock_(){this.block_.height=this.info_.height,this.block_.width=this.info_.widthWithChildren,this.block_.childlessWidth=this.info_.width}drawOutline_(){this.drawTop_();for(let e=1;e<this.info_.rows.length-1;e++){const t=this.info_.rows[e];t.hasJaggedEdge?this.drawJaggedEdge_(t):t.hasStatement?this.drawStatementInput_(t):t.hasExternalInput?this.drawValueInput_(t):this.drawRightSideRow_(t)}this.drawBottom_(),this.drawLeft_()}drawTop_(){const e=this.info_.topRow,t=e.elements;this.positionPreviousConnection_(),this.outlinePath_+=ae(e.xPos,this.info_.startY);for(let s,i=0;s=t[i];i++)m.isLeftRoundedCorner(s)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topLeft:m.isRightRoundedCorner(s)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topRight:m.isPreviousConnection(s)?this.outlinePath_+=s.shape.pathLeft:m.isHat(s)?this.outlinePath_+=this.constants_.START_HAT.path:m.isSpacer(s)&&(this.outlinePath_+=M("h",s.width));this.outlinePath_+=M("v",e.height)}drawJaggedEdge_(e){this.outlinePath_+=this.constants_.JAGGED_TEETH.path+M("v",e.height-this.constants_.JAGGED_TEETH.height)}drawValueInput_(e){const t=e.getLastInput();this.positionExternalValueConnection_(e);const i=El(t.shape)?t.shape.pathDown(t.height):t.shape.pathDown;this.outlinePath_+=M("H",t.xPos+t.width)+i+M("v",e.height-t.connectionHeight)}drawStatementInput_(e){var t=e.getLastInput();if(t){var i=t.xPos+t.notchOffset+t.shape.width;t=t.shape.pathRight+M("h",-(t.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop;var s=e.height-2*this.constants_.INSIDE_CORNERS.height;this.outlinePath_+=M("H",i)+t+M("v",s)+this.constants_.INSIDE_CORNERS.pathBottom+M("H",e.xPos+e.width),this.positionStatementInputConnection_(e)}}drawRightSideRow_(e){this.outlinePath_+=M("V",e.yPos+e.height)}drawBottom_(){const e=this.info_.bottomRow,t=e.elements;this.positionNextConnection_();let i=0,s="";for(let r,n=t.length-1;r=t[n];n--)m.isNextConnection(r)?s+=r.shape.pathRight:m.isLeftSquareCorner(r)?s+=M("H",e.xPos):m.isLeftRoundedCorner(r)?s+=this.constants_.OUTSIDE_CORNERS.bottomLeft:m.isRightRoundedCorner(r)?(s+=this.constants_.OUTSIDE_CORNERS.bottomRight,i=this.constants_.OUTSIDE_CORNERS.rightHeight):m.isSpacer(r)&&(s+=M("h",-1*r.width));this.outlinePath_+=M("V",e.baseline-i),this.outlinePath_+=s}drawLeft_(){var e=this.info_.outputConnection;if(this.positionOutputConnection_(),e){const t=e.connectionOffsetY+e.height;e=El(e.shape)?e.shape.pathUp(e.height):e.shape.pathUp,this.outlinePath_+=M("V",t)+e}this.outlinePath_+="z"}drawInternals_(){for(let t,e=0;t=this.info_.rows[e];e++)for(let s,i=0;s=t.elements[i];i++)m.isInlineInput(s)?this.drawInlineInput_(s):(m.isIcon(s)||m.isField(s))&&this.layoutField_(s)}layoutField_(e){const t=e.centerline-e.height/2;let i=e.xPos;var s="";this.info_.RTL&&(i=-(i+e.width),e.flipRtl&&(i+=e.width,s="scale(-1 1)")),m.isIcon(e)?((s=e.icon).setOffsetInBlock(new S(i,t)),this.info_.isInsertionMarker&&s.hideForInsertionMarker()):((e=e.field.getSvgRoot()).setAttribute("transform","translate("+i+","+t+")"+s),this.info_.isInsertionMarker&&e.setAttribute("display","none"))}drawInlineInput_(e){const t=e.width,i=e.height,s=e.connectionOffsetY,n=e.connectionHeight+s;this.inlinePath_+=Se(e.xPos+e.connectionWidth,e.centerline-i/2)+M("v",s)+e.shape.pathDown+M("v",i-n)+M("h",t-e.connectionWidth)+M("v",-i)+"z",this.positionInlineInputConnection_(e)}positionInlineInputConnection_(e){if(e.connectionModel){let i=e.xPos+e.connectionWidth+e.connectionOffsetX;this.info_.RTL&&(i*=-1),e.connectionModel.setOffsetInBlock(i,e.centerline-e.height/2+e.connectionOffsetY)}}positionStatementInputConnection_(e){const t=e.getLastInput();if(null!=t&&t.connectionModel){let i=e.xPos+e.statementEdge+t.notchOffset;this.info_.RTL&&(i*=-1),t.connectionModel.setOffsetInBlock(i,e.yPos)}}positionExternalValueConnection_(e){const t=e.getLastInput();if(t&&t.connectionModel){let i=e.xPos+e.width;this.info_.RTL&&(i*=-1),t.connectionModel.setOffsetInBlock(i,e.yPos)}}positionPreviousConnection_(){const e=this.info_.topRow;if(e.connection){const t=e.xPos+e.notchOffset;e.connection.connectionModel.setOffsetInBlock(this.info_.RTL?-t:t,0)}}positionNextConnection_(){const e=this.info_.bottomRow;if(e.connection){const t=e.connection,i=t.xPos;t.connectionModel.setOffsetInBlock(this.info_.RTL?-i:i,e.baseline)}}positionOutputConnection_(){if(this.info_.outputConnection){const e=this.info_.startX+this.info_.outputConnection.connectionOffsetX;this.block_.outputConnection.setOffsetInBlock(this.info_.RTL?-e:e,this.info_.outputConnection.connectionOffsetY)}}updateConnectionHighlights(){for(const e of this.info_.rows)for(const t of e.elements){if(!(t instanceof Pi))continue;const i=this.drawConnectionHighlightPath(t);i&&(i.style.display=t.highlighted?"":"none")}}drawConnectionHighlightPath(e){const t=e.connectionModel;e=t.type===N.INPUT_VALUE||t.type===N.OUTPUT_VALUE?this.getExpressionConnectionHighlightPath(e):this.getStatementConnectionHighlightPath(e);const i=t.getSourceBlock();let s,n;return null==(n=(s=i.pathObject).addConnectionHighlight)?void 0:n.call(s,t,e,t.getOffsetInBlock(),i.RTL)}getExpressionConnectionHighlightPath(e){let t="";return El(e.shape)?t=e.shape.pathDown(e.height):Wd(e.shape)&&(t=e.shape.pathDown),ae(0,-(e=this.constants_.TAB_OFFSET_FROM_TOP))+M("v",e)+t+M("v",e)}getStatementConnectionHighlightPath(e){if(!qd(e.shape))throw Error("Statement connections should have notch shapes");const t=this.constants_.NOTCH_OFFSET_LEFT-this.constants_.CORNER_RADIUS;return ae(-t,0)+M("h",t)+e.shape.pathLeft+M("h",t)}},Jn=class{constructor(e,t){this.statementEdge=this.width=this.widthWithChildren=this.height=0,this.rows=[],this.inputRows=[],this.startY=this.startX=0,this.renderer_=e,this.block_=t,this.constants_=this.renderer_.getConstants(),this.outputConnection=t.outputConnection?new zp(this.constants_,t.outputConnection):null,this.isInline=t.getInputsInline()&&!t.isCollapsed(),this.isCollapsed=t.isCollapsed(),this.isInsertionMarker=t.isInsertionMarker(),this.RTL=t.RTL,this.topRow=new Tu(this.constants_),this.bottomRow=new gu(this.constants_)}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}createRows_(){this.populateTopRow_(),this.rows.push(this.topRow);let e=new bu(this.constants_);this.inputRows.push(e);var t=this.block_.getIcons();for(let s,i=0;s=t[i];i++){const n=new Zp(this.constants_,s);this.isCollapsed&&!s.isShownWhenCollapsed()||e.elements.push(n)}t=void 0;for(let s,i=0;s=this.block_.inputList[i];i++)if(s.isVisible()){this.shouldStartNewRow_(s,t)&&(this.rows.push(e),e=new bu(this.constants_),this.inputRows.push(e));for(let r,n=0;r=s.fieldRow[n];n++)e.elements.push(new mu(this.constants_,r,s));this.addInput_(s,e),t=s}this.isCollapsed&&(e.hasJaggedEdge=!0,e.elements.push(new Wp(this.constants_))),(e.elements.length||e.hasDummyInput)&&this.rows.push(e),this.populateBottomRow_(),this.rows.push(this.bottomRow)}populateTopRow_(){var e=!!this.block_.previousConnection;const t=(this.block_.hat?"cap"===this.block_.hat:this.constants_.ADD_START_HATS)&&!this.outputConnection&&!e;let i=this.topRow.hasLeftSquareCorner(this.block_)?Kn:Yn;this.topRow.elements.push(new i(this.constants_)),t?(e=new Gp(this.constants_),this.topRow.elements.push(e)):e&&(this.topRow.hasPreviousConnection=!0,this.topRow.connection=new jp(this.constants_,this.block_.previousConnection),this.topRow.elements.push(this.topRow.connection)),this.topRow.minHeight=this.block_.inputList.length&&this.block_.inputList[0]instanceof ut&&!this.block_.isCollapsed()?this.constants_.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT:this.constants_.TOP_ROW_MIN_HEIGHT,i=this.topRow.hasRightSquareCorner(this.block_)?Kn:Yn,this.topRow.elements.push(new i(this.constants_,"right"))}populateBottomRow_(){this.bottomRow.hasNextConnection=!!this.block_.nextConnection,this.bottomRow.minHeight=this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1]instanceof ut?this.constants_.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT:this.constants_.BOTTOM_ROW_MIN_HEIGHT,this.bottomRow.hasLeftSquareCorner(this.block_)?this.bottomRow.elements.push(new Kn(this.constants_)):this.bottomRow.elements.push(new Yn(this.constants_)),this.bottomRow.hasNextConnection&&(this.bottomRow.connection=new qp(this.constants_,this.block_.nextConnection),this.bottomRow.elements.push(this.bottomRow.connection)),this.bottomRow.hasRightSquareCorner(this.block_)?this.bottomRow.elements.push(new Kn(this.constants_,"right")):this.bottomRow.elements.push(new Yn(this.constants_,"right"))}addInput_(e,t){this.isInline&&e instanceof o.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new _u(this.constants_,e)),t.hasInlineInput=!0):e instanceof ut?(t.elements.push(new lc(this.constants_,e)),t.hasStatement=!0):e instanceof o.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new $u(this.constants_,e)),t.hasExternalInput=!0):(e instanceof Kt||e instanceof $o)&&(t.minHeight=Math.max(t.minHeight,e.getSourceBlock()&&e.getSourceBlock().isShadow()?this.constants_.DUMMY_INPUT_SHADOW_MIN_HEIGHT:this.constants_.DUMMY_INPUT_MIN_HEIGHT),t.hasDummyInput=!0),null===t.align&&(t.align=e.align)}shouldStartNewRow_(e,t){return!!t&&(t instanceof $o||e instanceof ut||t instanceof ut||(e instanceof o.ValueInput$$module$build$src$core$inputs$value_input||e instanceof Kt||t instanceof o.ValueInput$$module$build$src$core$inputs$value_input)&&!this.isInline)}addElemSpacing_(){for(let t,e=0;t=this.rows[e];e++){const i=t.elements;if(t.elements=[],t.startsWithElemSpacer()&&t.elements.push(new dt(this.constants_,this.getInRowSpacing_(null,i[0]))),i.length){for(let s=0;s<i.length-1;s++){t.elements.push(i[s]);const n=this.getInRowSpacing_(i[s],i[s+1]);t.elements.push(new dt(this.constants_,n))}t.elements.push(i[i.length-1]),t.endsWithElemSpacer()&&t.elements.push(new dt(this.constants_,this.getInRowSpacing_(i[i.length-1],null)))}}}getInRowSpacing_(e,t){if(!e&&t&&m.isStatementInput(t))return this.constants_.STATEMENT_INPUT_PADDING_LEFT;if(e&&m.isInput(e)&&!t){if(m.isExternalInput(e))return this.constants_.NO_PADDING;if(m.isInlineInput(e))return this.constants_.LARGE_PADDING;if(m.isStatementInput(e))return this.constants_.NO_PADDING}return e&&m.isLeftSquareCorner(e)&&t&&(m.isPreviousConnection(t)||m.isNextConnection(t))?t.notchOffset:e&&m.isLeftRoundedCorner(e)&&t&&(m.isPreviousConnection(t)||m.isNextConnection(t))?t.notchOffset-this.constants_.CORNER_RADIUS:e&&m.isField(e)&&0===e.width?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING}computeBounds_(){let e=0,t=0,i=0;for(let r,n=0;r=this.rows[n];n++){if(r.measure(),t=Math.max(t,r.width),r.hasStatement){var s=r.getLastInput();let a,$;s=r.width-(null!=($=null==(a=s)?void 0:a.width)?$:0),e=Math.max(e,s)}i=Math.max(i,r.widthWithConnectedBlocks)}this.statementEdge=e,this.width=t;for(let r,n=0;r=this.rows[n];n++)r.hasStatement&&(r.statementEdge=this.statementEdge);this.widthWithChildren=Math.max(t,i),this.outputConnection&&(this.startX=this.outputConnection.width,this.width+=this.outputConnection.width,this.widthWithChildren+=this.outputConnection.width)}alignRowElements_(){for(let i,t=0;i=this.rows[t];t++)if(i.hasStatement)this.alignStatementRow_(i);else{var e=i.width;(e=this.getDesiredRowWidth_(i)-e)>0&&this.addAlignmentPadding_(i,e),m.isTopOrBottomRow(i)&&(i.widthWithConnectedBlocks=i.width)}}getDesiredRowWidth_(e){return this.width-this.startX}addAlignmentPadding_(e,t){const i=e.getFirstSpacer(),s=e.getLastSpacer();if((e.hasExternalInput||e.hasStatement)&&(e.widthWithConnectedBlocks+=t),e.align===o.Align$$module$build$src$core$inputs$align.LEFT&&s)s.width+=t;else if(e.align===o.Align$$module$build$src$core$inputs$align.CENTRE&&i&&s)i.width+=t/2,s.width+=t/2;else if(e.align===o.Align$$module$build$src$core$inputs$align.RIGHT&&i)i.width+=t;else{if(!s)return;s.width+=t}e.width+=t}alignStatementRow_(e){const t=e.getLastInput();if(t){var i=e.width-t.width,s=this.statementEdge;(i=s-i)>0&&this.addAlignmentPadding_(e,i),i=e.width,s=this.getDesiredRowWidth_(e),t.width+=s-i,t.height=Math.max(t.height,e.height),e.width+=s-i,e.widthWithConnectedBlocks=Math.max(e.width,this.statementEdge+e.connectedBlockWidths)}}addRowSpacing_(){const e=this.rows;this.rows=[];for(let t=0;t<e.length;t++)this.rows.push(e[t]),t!==e.length-1&&this.rows.push(this.makeSpacerRow_(e[t],e[t+1]))}makeSpacerRow_(e,t){var i=this.getSpacerRowHeight_(e,t);const s=this.getSpacerRowWidth_(e,t);return i=new fu(this.constants_,i,s),e.hasStatement&&(i.followsStatement=!0),t.hasStatement&&(i.precedesStatement=!0),i}getSpacerRowWidth_(e,t){return this.width-this.startX}getSpacerRowHeight_(e,t){return this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){return m.isSpacer(t)?e.yPos+t.height/2:m.isBottomRow(e)?(e=e.yPos+e.height-e.descenderHeight,m.isNextConnection(t)?e+t.height/2:e-t.height/2):m.isTopRow(e)?m.isHat(t)?e.capline-t.height/2:e.capline+t.height/2:e.yPos+e.height/2}recordElemPositions_(e){let t=e.xPos;for(let s,i=0;s=e.elements[i];i++)m.isSpacer(s)&&(s.height=e.height),s.xPos=t,s.centerline=this.getElemCenterline_(e,s),t+=s.width}finalize_(){let e=0,t=0;for(let s,i=0;s=this.rows[i];i++)s.yPos=t,s.xPos=this.startX,t+=s.height,e=Math.max(e,s.widthWithConnectedBlocks),this.recordElemPositions_(s);if(this.outputConnection&&this.block_.nextConnection){const i=this.block_.nextConnection.targetBlock();i&&(e=Math.max(e,i.getHeightWidth().width))}this.widthWithChildren=e+this.startX,this.height=t,this.startY=this.topRow.capline,this.bottomRow.baseline=t-this.bottomRow.descenderHeight}getMeasureableForConnection(e){let t;if((null==(t=this.outputConnection)?void 0:t.connectionModel)===e)return this.outputConnection;for(const i of this.rows)for(const s of i.elements)if(s instanceof Pi&&s.connectionModel===e)return s;return null}},uc=class{constructor(e,t,i){this.connectionHighlights=new WeakMap,this.highlightOffsets=new WeakMap,this.constants=i,this.style=t,this.svgRoot=e,this.svgPath=I(f.PATH,{class:"blocklyPath"},this.svgRoot),this.setClass_("blocklyBlock",!0)}setPath(e){this.svgPath.setAttribute("d",e)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)")}applyColour(e){this.svgPath.setAttribute("stroke",this.style.colourTertiary),this.svgPath.setAttribute("fill",this.style.colourPrimary),this.updateShadow_(e.isShadow()),this.updateDisabled_(!e.isEnabled()||e.getInheritedDisabled())}setStyle(e){this.style=e}setClass_(e,t){e&&(t?A(this.svgRoot,e):X(this.svgRoot,e))}updateHighlighted(e){this.setClass_("blocklyHighlighted",!!e)}updateShadow_(e){e?(this.setClass_("blocklyShadow",!0),this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary)):this.setClass_("blocklyShadow",!1)}updateDisabled_(e){this.setClass_("blocklyDisabled",e),this.setClass_("blocklyDisabledPattern",e)}updateSelected(e){this.setClass_("blocklySelected",e)}updateDraggingDelete(e){this.setClass_("blocklyDraggingDelete",e)}updateInsertionMarker(e){this.setClass_("blocklyInsertionMarker",e)}updateMovable(e){this.setClass_("blocklyDraggable",e)}updateReplacementFade(e){this.setClass_("blocklyReplaceable",e)}updateShapeForInputHighlight(e,t){}addConnectionHighlight(e,t,i,s){return i=`translate(${i.x}, ${i.y})`+(s?" scale(-1 1)":""),(s=this.connectionHighlights.get(e))?(s.setAttribute("d",t),s.setAttribute("transform",i),s):(t=I(f.PATH,{id:e.id,class:"blocklyHighlightedConnectionPath",style:"display: none;",d:t,transform:i},this.svgRoot),this.connectionHighlights.set(e,t),t)}removeConnectionHighlight(e){const t=this.connectionHighlights.get(e);t&&(J(t),this.connectionHighlights.delete(e))}},dc=class{constructor(e){this.overrides=null,this.name=e}getClassName(){return this.name+"-renderer"}init(e,t){this.constants_=this.makeConstants_(),t&&(this.overrides=t,Object.assign(this.constants_,t)),this.constants_.setTheme(e),this.constants_.init()}createDom(e,t,i){this.constants_.createDom(e,this.name+"-"+t.name,"."+this.getClassName()+"."+t.getClassName(),i)}refreshDom(e,t,i){const s=this.getConstants();s.dispose(),this.constants_=this.makeConstants_(),this.overrides&&Object.assign(this.constants_,this.overrides),this.constants_.randomIdentifier=s.randomIdentifier,this.constants_.setTheme(t),this.constants_.init(),this.createDom(e,t,i)}dispose(){this.constants_&&this.constants_.dispose()}makeConstants_(){return new cc}makeRenderInfo_(e){return new Jn(this,e)}makeDrawer_(e,t){return new ac(e,t)}makePathObject(e,t){return new uc(e,t,this.constants_)}getConstants(){return this.constants_}shouldHighlightConnection(e){return!0}orphanCanConnectAtEnd(e,t,i){return!!Y.getConnectionForOrphanedConnection(e,i===N.OUTPUT_VALUE?t.outputConnection:t.previousConnection)}render(e){const t=this.makeRenderInfo_(e);t.measure(),this.makeDrawer_(e,t).draw()}},te={};te.BottomRow=gu,te.Connection=Pi,te.ConstantProvider=cc,te.Drawer=ac,te.ExternalValueInput=$u,te.Field=mu,te.Hat=Gp,te.Icon=Zp,te.InRowSpacer=dt,te.InlineInput=_u,te.InputConnection=rc,te.InputRow=bu,te.JaggedEdge=Wp,te.Measurable=Qt,te.NextConnection=qp,te.OutputConnection=zp,te.PathObject=uc,te.PreviousConnection=jp,te.RenderInfo=Jn,te.Renderer=dc,te.RoundCorner=Yn,te.Row=Xn,te.SpacerRow=fu,te.SquareCorner=Kn,te.StatementInput=lc,te.TopRow=Tu,te.Types=m,te.init=zd,te.register=vl,te.unregister=Hg;var Xp=class{constructor(e,t){this.workspace=e,this.theme=t,this.subscribedWorkspaces=[],this.componentDB=new Map}getTheme(){return this.theme}setTheme(e){var t=this.theme;this.theme=e,(e=this.workspace.getInjectionDiv())&&(t&&(t=t.getClassName())&&X(e,t),(t=this.theme.getClassName())&&A(e,t));for(let s,i=0;s=this.subscribedWorkspaces[i];i++)s.refreshTheme();for(const[i,s]of this.componentDB)for(const n of s){e=n.element,t=n.propertyName;const r=this.theme&&this.theme.getComponentStyle(i);e.style.setProperty(t,r||"")}for(const i of this.subscribedWorkspaces)i.hideChaff()}subscribeWorkspace(e){this.subscribedWorkspaces.push(e)}unsubscribeWorkspace(e){if(!nt(this.subscribedWorkspaces,e))throw Error("Cannot unsubscribe a workspace that hasn't been subscribed.")}subscribe(e,t,i){this.componentDB.has(t)||this.componentDB.set(t,[]),this.componentDB.get(t).push({element:e,propertyName:i}),t=this.theme&&this.theme.getComponentStyle(t),e.style.setProperty(i,t||"")}unsubscribe(e){if(e)for(const[t,i]of this.componentDB){for(let s=i.length-1;s>=0;s--)i[s].element===e&&i.splice(s,1);i.length||this.componentDB.delete(t)}}dispose(){this.subscribedWorkspaces.length=0,this.componentDB.clear()}},vu="VARIABLE_DYNAMIC",Fi={CATEGORY_NAME:vu};Fi.flyoutCategory=jd,Fi.flyoutCategoryBlocks=Xd,Fi.internalFlyoutCategory=$a,Fi.onCreateVariableButtonClick_Colour=Il,Fi.onCreateVariableButtonClick_Number=Cl,Fi.onCreateVariableButtonClick_String=yl;var Yp=class{canConnect(e,t,i,s){return this.canConnectWithReason(e,t,i,s)===Y.CAN_CONNECT}canConnectWithReason(e,t,i,s){const n=this.doSafetyChecks(e,t);return n!==Y.CAN_CONNECT?n:this.doTypeChecks(e,t)?i&&!this.doDragChecks(e,t,s||0)?Y.REASON_DRAG_CHECKS_FAILED:Y.CAN_CONNECT:Y.REASON_CHECKS_FAILED}getErrorMessage(e,t,i){switch(e){case Y.REASON_SELF_CONNECTION:return"Attempted to connect a block to itself.";case Y.REASON_DIFFERENT_WORKSPACES:return"Blocks not on same workspace.";case Y.REASON_WRONG_TYPE:return"Attempt to connect incompatible types.";case Y.REASON_TARGET_NULL:return"Target connection is null.";case Y.REASON_CHECKS_FAILED:return"Connection checks failed. "+t+" expected "+t.getCheck()+", found "+i.getCheck();case Y.REASON_SHADOW_PARENT:return"Connecting non-shadow to shadow block.";case Y.REASON_DRAG_CHECKS_FAILED:return"Drag checks failed.";case Y.REASON_PREVIOUS_AND_OUTPUT:return"Block would have an output and a previous connection.";default:return"Unknown connection failure: this should never happen!"}}doSafetyChecks(e,t){if(!e||!t)return Y.REASON_TARGET_NULL;let i,s,n;return e.isSuperior()?(i=e.getSourceBlock(),s=t.getSourceBlock(),n=t):(s=e.getSourceBlock(),i=t.getSourceBlock(),n=e,e=t),i===s?Y.REASON_SELF_CONNECTION:n.type!==Yo[e.type]?Y.REASON_WRONG_TYPE:i.workspace!==s.workspace?Y.REASON_DIFFERENT_WORKSPACES:i.isShadow()&&!s.isShadow()?Y.REASON_SHADOW_PARENT:n.type===N.OUTPUT_VALUE&&s.previousConnection&&s.previousConnection.isConnected()||n.type===N.PREVIOUS_STATEMENT&&s.outputConnection&&s.outputConnection.isConnected()?Y.REASON_PREVIOUS_AND_OUTPUT:Y.CAN_CONNECT}doTypeChecks(e,t){if(e=e.getCheck(),t=t.getCheck(),!e||!t)return!0;for(let i=0;i<e.length;i++)if(t.includes(e[i]))return!0;return!1}doDragChecks(e,t,i){if(e.distanceFrom(t)>i||t.getSourceBlock().isInsertionMarker())return!1;switch(t.type){case N.PREVIOUS_STATEMENT:return this.canConnectToPrevious_(e,t);case N.OUTPUT_VALUE:if(t.isConnected()&&!t.targetBlock().isInsertionMarker()||e.isConnected())return!1;break;case N.INPUT_VALUE:if(t.isConnected()&&!t.targetBlock().isMovable()&&!t.targetBlock().isShadow())return!1;break;case N.NEXT_STATEMENT:if(t.isConnected()&&!e.getSourceBlock().nextConnection&&!t.targetBlock().isShadow()&&t.targetBlock().nextConnection||t.targetBlock()&&!t.targetBlock().isMovable()&&!t.targetBlock().isShadow())return!1;break;default:return!1}return!Rl.includes(t)}canConnectToPrevious_(e,t){return!(e.targetConnection||Rl.includes(t)||t.targetConnection&&(!(e=t.targetBlock()).isInsertionMarker()||e.getPreviousBlock()))}};U(k.CONNECTION_CHECKER,ct,Yp);var Ds=class{get isFlyout(){return this.internalIsFlyout}get isMutator(){return this.internalIsMutator}constructor(e){this.isClearing=this.internalIsMutator=this.internalIsFlyout=this.rendered=!1,this.MAX_UNDO=1024,this.connectionDBList=[],this.topBlocks=[],this.topComments=[],this.commentDB=new Map,this.listeners=[],this.undoStack_=[],this.redoStack_=[],this.blockDB=new Map,this.typedBlocksDB=new Map,this.procedureMap=new Vp,this.readOnly=!1,this.potentialVariableMap=null,this.id=Te(),_c(this),this.options=e||new Xt({}),this.RTL=!!this.options.RTL,this.horizontalLayout=!!this.options.horizontalLayout,this.toolboxPosition=this.options.toolboxPosition,this.connectionChecker=new(xe(k.CONNECTION_CHECKER,this.options,!0))(this),this.variableMap=new(this.getVariableMapClass())(this),this.setIsReadOnly(this.options.readOnly)}dispose(){this.listeners.length=0,this.clear(),bc(this)}sortObjects(e,t){const i=s=>({getBoundingRectangle:()=>{const n=s.getRelativeToSurfaceXY();return new z(n.y,n.y,n.x,n.x)},moveBy:()=>{}});return this.sortByOrigin(i(e),i(t))}sortByOrigin(e,t){const i=Math.sin(yr(Ds.SCAN_ANGLE))*(this.RTL?-1:1);return e=e.getBoundingRectangle().getOrigin(),t=t.getBoundingRectangle().getOrigin(),e.y+i*e.x-(t.y+i*t.x)}addTopBlock(e){this.topBlocks.push(e)}removeTopBlock(e){if(!nt(this.topBlocks,e))throw Error("Block not present in workspace's list of top-most blocks.")}getTopBlocks(e=!1){const t=[].concat(this.topBlocks);return e&&t.length>1&&t.sort(this.sortObjects.bind(this)),t}addTypedBlock(e){this.typedBlocksDB.has(e.type)||this.typedBlocksDB.set(e.type,[]),this.typedBlocksDB.get(e.type).push(e)}removeTypedBlock(e){nt(this.typedBlocksDB.get(e.type),e),this.typedBlocksDB.get(e.type).length||this.typedBlocksDB.delete(e.type)}getBlocksByType(e,t=!1){return this.typedBlocksDB.has(e)?(e=this.typedBlocksDB.get(e).slice(0),t&&e&&e.length>1&&e.sort(this.sortObjects.bind(this)),e.filter(i=>!i.isInsertionMarker())):[]}addTopComment(e){this.topComments.push(e),this.commentDB.has(e.id)&&console.warn('Overriding an existing comment on this workspace, with id "'+e.id+'"'),this.commentDB.set(e.id,e)}removeTopComment(e){if(!nt(this.topComments,e))throw Error("Comment not present in workspace's list of top-most comments.");this.commentDB.delete(e.id)}getTopComments(e=!1){const t=[].concat(this.topComments);return e&&t.length>1&&t.sort(this.sortObjects.bind(this)),t}getAllBlocks(e=!1){if(e){var t=this.getTopBlocks(!0);e=[];for(let i=0;i<t.length;i++)e.push(...t[i].getDescendants(!0))}else for(e=this.getTopBlocks(!1),t=0;t<e.length;t++)e.push(...e[t].getChildren(!1));return e.filter(i=>!i.isInsertionMarker())}clear(){this.isClearing=!0;try{const e=o.getGroup$$module$build$src$core$events$utils();for(e||o.setGroup$$module$build$src$core$events$utils(!0);this.topBlocks.length;)this.topBlocks[0].dispose(!1);for(;this.topComments.length;)this.topComments[this.topComments.length-1].dispose();o.setGroup$$module$build$src$core$events$utils(e),this.isFlyout||this.variableMap.clear(),this.potentialVariableMap&&this.potentialVariableMap.clear()}finally{this.isClearing=!1}}renameVariableById(e,t){Re("Blockly.Workspace.renameVariableById","v12","v13","Blockly.Workspace.getVariableMap().renameVariable"),(e=this.variableMap.getVariableById(e))&&this.variableMap.renameVariable(e,t)}createVariable(e,t,i){return Re("Blockly.Workspace.createVariable","v12","v13","Blockly.Workspace.getVariableMap().createVariable"),this.variableMap.createVariable(e,t??void 0,i??void 0)}getVariableUsesById(e){return Re("Blockly.Workspace.getVariableUsesById","v12","v13","Blockly.Workspace.getVariableMap().getVariableUsesById"),os(this,e)}deleteVariableById(e){Re("Blockly.Workspace.deleteVariableById","v12","v13","Blockly.Workspace.getVariableMap().deleteVariable");const t=this.variableMap.getVariableById(e);t?o.deleteVariable$$module$build$src$core$variables(this,t):console.warn(`Can't delete non-existent variable: ${e}`)}getVariable(e,t){return Re("Blockly.Workspace.getVariable","v12","v13","Blockly.Workspace.getVariableMap().getVariable"),this.variableMap.getVariable(e,t)}getVariableById(e){return Re("Blockly.Workspace.getVariableById","v12","v13","Blockly.Workspace.getVariableMap().getVariableById"),this.variableMap.getVariableById(e)}getVariablesOfType(e){return Re("Blockly.Workspace.getVariablesOfType","v12","v13","Blockly.Workspace.getVariableMap().getVariablesOfType"),this.variableMap.getVariablesOfType(e??"")}getAllVariables(){return Re("Blockly.Workspace.getAllVariables","v12","v13","Blockly.Workspace.getVariableMap().getAllVariables"),this.variableMap.getAllVariables()}getAllVariableNames(){return Re("Blockly.Workspace.getAllVariableNames","v12","v13","Blockly.Workspace.getVariableMap().getAllVariables"),this.variableMap.getAllVariables().map(e=>e.getName())}getWidth(){return 0}newBlock(e,t){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}newComment(e){throw Error("The implementation of newComment should be monkey-patched in by blockly.ts")}remainingCapacity(){return isNaN(this.options.maxBlocks)?1/0:this.options.maxBlocks-this.getAllBlocks(!1).length}remainingCapacityOfType(e){return this.options.maxInstances?(void 0!==this.options.maxInstances[e]?this.options.maxInstances[e]:1/0)-this.getBlocksByType(e,!1).length:1/0}isCapacityAvailable(e){if(!this.hasBlockLimits())return!0;let t=0;for(const i in e){if(e[i]>this.remainingCapacityOfType(i))return!1;t+=e[i]}return!(t>this.remainingCapacity())}hasBlockLimits(){return this.options.maxBlocks!==1/0||!!this.options.maxInstances}getUndoStack(){return this.undoStack_}getRedoStack(){return this.redoStack_}undo(e){var t=e?this.redoStack_:this.undoStack_,i=e?this.undoStack_:this.redoStack_;const s=t.pop();if(s){for(var n=[s];t.length&&s.group&&s.group===t[t.length-1].group;){const r=t.pop();r&&n.push(r)}for(t=0;t<n.length;t++)i.push(n[t]);o.setRecordUndo$$module$build$src$core$events$utils(!1);try{for(i=0;i<n.length;i++)n[i].run(e)}finally{o.setRecordUndo$$module$build$src$core$events$utils(!0)}}}clearUndo(){this.undoStack_.length=0,this.redoStack_.length=0,ci()}addChangeListener(e){return this.listeners.push(e),e}removeChangeListener(e){nt(this.listeners,e)}fireChangeListener(e){if(e.recordUndo)for(this.undoStack_.push(e),this.redoStack_.length=0;this.undoStack_.length>this.MAX_UNDO&&this.MAX_UNDO>=0;)this.undoStack_.shift();for(let t=0;t<this.listeners.length;t++)(0,this.listeners[t])(e)}getBlockById(e){return this.blockDB.get(e)||null}setBlockById(e,t){this.blockDB.set(e,t)}removeBlockById(e){this.blockDB.delete(e)}getCommentById(e){let t;return null!=(t=this.commentDB.get(e))?t:null}allInputsFilled(e){const t=this.getTopBlocks(!1);for(let i=0;i<t.length;i++)if(!t[i].allInputsFilled(e))return!1;return!0}getPotentialVariableMap(){return this.potentialVariableMap}createPotentialVariableMap(){this.potentialVariableMap=new(this.getVariableMapClass())(this,!0)}getVariableMap(){return this.variableMap}setVariableMap(e){this.variableMap=e}getProcedureMap(){return this.procedureMap}getRootWorkspace(){let e=null;const t=this.options.parentWorkspace;return this.isFlyout?t&&t.options&&(e=t.options.parentWorkspace):t&&(e=t),e}static getById(e){return ko(e)}static getAll(){return Yi()}getVariableMapClass(){const e=xe(k.VARIABLE_MAP,this.options,!0);if(!e)throw Error("No variable map is registered.");return e}isReadOnly(){return this.readOnly}setIsReadOnly(e){this.readOnly=e,this.options.readOnly=e}};Ds.SCAN_ANGLE=3;var Kp=class{constructor(e){this.parentWorkspace=e,this.sounds=new Map,this.lastSound=null,this.muted=!1}dispose(){this.sounds.clear()}load(e,t){if(e.length){try{var i=new globalThis.Audio}catch{return}for(let n=0;n<e.length;n++){const r=e[n],a=r.match(/\.(\w+)$/);if(a&&i.canPlayType("audio/"+a[1])){var s=new globalThis.Audio(r);break}}s&&this.sounds.set(t,s)}}preload(){for(const e of this.sounds.values()){e.volume=.01;const t=e.play();if(void 0!==t?t.then(e.pause).catch(function(){}):e.pause(),ka||$$)break}}play(e,t){if(!this.muted){var i=this.sounds.get(e);i?(e=new Date,null!==this.lastSound&&e.getTime()-this.lastSound.getTime()<100||(this.lastSound=e,(i=ka||Nh?i:i.cloneNode()).volume=void 0===t?1:t,i.play())):this.parentWorkspace&&this.parentWorkspace.getAudioManager().play(e,t)}}setMuted(e){this.muted=e}getMuted(){return this.muted}},Ze=class extends Ds{constructor(e){let t;super(e),this.resizeHandlerWrapper=null,this.resizesEnabled=this.visible=this.rendered=!0,this.startScrollY=this.startScrollX=this.scrollY=this.scrollX=0,this.oldScale=this.scale=1,this.oldLeft=this.oldTop=0,this.inverseScreenCTM=this.targetWorkspace=this.dummyWheelListener=this.configureContextMenu=this.lastRecordedPageScroll=this.injectionDiv=this.currentGesture_=this.toolbox=this.flyout=this.scrollbar=this.trashcan=null,this.inverseScreenCTMDirty=!0,this.highlightedBlocks=[],this.toolboxCategoryCallbacks=new Map,this.flyoutButtonCallbacks=new Map,this.cachedParentSvg=null,this.keyboardMoveInProgress=this.keyboardAccessibilityMode=!1,this.topBoundedElements=[],this.dragTargetAreas=[],this.zoomControls_=this.layerManager=null,this.navigator=new cu,this.metricsManager=new(xe(k.METRICS_MANAGER,e,!0))(this),this.getMetrics=e.getMetrics||this.metricsManager.getMetrics.bind(this.metricsManager),this.setMetrics=e.setMetrics||Ze.setTopLevelWorkspaceMetrics,this.componentManager=new de,this.connectionDBList=Rs.init(this.connectionChecker),this.audioManager=new Kp(e.parentWorkspace),this.grid=this.options.gridPattern?new uu(this.options.gridPattern,e.gridOptions):null,this.markerManager=new hu(this),ve&&fr&&this.registerToolboxCategoryCallback(La,fr),Fi&&$a&&this.registerToolboxCategoryCallback(vu,$a),Qe&&ga&&(this.registerToolboxCategoryCallback(nc,ga),this.addChangeListener(Gd)),this.addChangeListener(this.variableChangeCallback.bind(this)),this.themeManager_=this.options.parentWorkspace?this.options.parentWorkspace.getThemeManager():new Xp(this,this.options.theme||Xl),this.themeManager_.subscribeWorkspace(this),this.renderer=zd(this.options.renderer||"geras",this.getTheme(),null!=(t=this.options.rendererOverrides)?t:void 0),this.cachedParentSvgSize=new j(0,0)}getMarkerManager(){return this.markerManager}getMetricsManager(){return this.metricsManager}setMetricsManager(e){this.metricsManager=e,this.getMetrics=this.metricsManager.getMetrics.bind(this.metricsManager)}getComponentManager(){return this.componentManager}getMarker(e){return this.markerManager.getMarker(e)}getCursor(){return this.markerManager.getCursor()}getRenderer(){return this.renderer}getThemeManager(){return this.themeManager_}getTheme(){return this.themeManager_.getTheme()}setTheme(e){e||(e=Xl),this.themeManager_.setTheme(e)}refreshTheme(){if(this.svgGroup_){var e=null===this.options.parentWorkspace;this.renderer.refreshDom(this.svgGroup_,this.getTheme(),e?this.getInjectionDiv():void 0)}this.updateBlockStyles(this.getAllBlocks(!1).filter(t=>!!t.getStyleName())),this.refreshToolboxSelection(),this.toolbox&&this.toolbox.refreshTheme(),this.isVisible()&&this.setVisible(!0),e=new(P(b.THEME_CHANGE))(this.getTheme().name,this.id),B(e)}updateBlockStyles(e){for(let i,t=0;i=e[t];t++){const s=i.getStyleName();s&&i.setStyle(s)}}getInverseScreenCTM(){if(this.inverseScreenCTMDirty){const e=this.getParentSvg().getScreenCTM();e&&(this.inverseScreenCTM=e.inverse(),this.inverseScreenCTMDirty=!1)}return this.inverseScreenCTM}updateInverseScreenCTM(){this.inverseScreenCTMDirty=!0}isVisible(){return this.visible}getSvgXY(e){let t=0,i=0,s=1;(this.getCanvas().contains(e)||this.getBubbleCanvas().contains(e))&&(s=this.scale);do{const n=rn(e);(e===this.getCanvas()||e===this.getBubbleCanvas())&&(s=1),t+=n.x*s,i+=n.y*s,e=e.parentNode}while(e&&e!==this.getParentSvg()&&e!==this.getInjectionDiv());return new S(t,i)}getCachedParentSvgSize(){const e=this.cachedParentSvgSize;return new j(e.width,e.height)}getOriginOffsetInPixels(){return rr(this.getCanvas())}getInjectionDiv(){if(!this.injectionDiv){let e=this.svgGroup_;for(;e;){if((" "+(e.getAttribute("class")||"")+" ").includes(" injectionDiv ")){this.injectionDiv=e;break}e=e.parentNode}}return this.injectionDiv}getSvgGroup(){return this.svgGroup_}getBlockCanvas(){return this.getCanvas()}setResizeHandlerWrapper(e){this.resizeHandlerWrapper=e}createDom(e,t){return this.injectionDiv||(this.injectionDiv=t??null),this.svgGroup_=I(f.G,{class:"blocklyWorkspace",id:this.id}),t&&Ee(this.svgGroup_,ye.LABEL,o.Msg$$module$build$src$core$msg.WORKSPACE_ARIA_LABEL),e&&(this.svgBackground_=I(f.RECT,{height:"100%",width:"100%",class:e},this.svgGroup_),"blocklyMainBackground"===e&&this.grid?this.svgBackground_.style.fill="var(--blocklyGridPattern)":this.themeManager_.subscribe(this.svgBackground_,"workspaceBackgroundColour","fill")),this.layerManager=new class{constructor(e){this.workspace=e,this.layers=new Map,(e=e.getInjectionDiv())&&(this.dragLayer=this.createDragLayer(e),this.animationLayer=this.createAnimationLayer(e)),e=this.createLayer(50),A(e,"blocklyBlockCanvas"),e=this.createLayer(100),A(e,"blocklyBubbleCanvas")}createDragLayer(e){const t=I(f.SVG,{class:"blocklyBlockDragSurface",xmlns:wl,"xmlns:html":po,"xmlns:xlink":$t,version:"1.1"});return e.append(t),I(f.G,{},t)}createAnimationLayer(e){const t=I(f.SVG,{class:"blocklyAnimationLayer",xmlns:wl,"xmlns:html":po,"xmlns:xlink":$t,version:"1.1"});return e.append(t),I(f.G,{},t)}appendToAnimationLayer(e){let t;const i=null==(t=this.dragLayer)?void 0:t.getAttribute("transform");if(i){let n;null==(n=this.animationLayer)||n.setAttribute("transform",i)}let s;null==(s=this.animationLayer)||s.appendChild(e.getSvgRoot())}translateLayers(e,t){let i;e=`translate(${e.x}, ${e.y}) scale(${t})`,null==(i=this.dragLayer)||i.setAttribute("transform",e);for(const[,s]of this.layers)s.setAttribute("transform",e)}moveToDragLayer(e){let t;null==(t=this.dragLayer)||t.appendChild(e.getSvgRoot()),e.canBeFocused()&&o.getFocusManager$$module$build$src$core$focus_manager().focusNode(e)}moveOffDragLayer(e,t){this.append(e,t),e.canBeFocused()&&o.getFocusManager$$module$build$src$core$focus_manager().focusNode(e)}append(e,t){let i;if(this.layers.has(t)||this.createLayer(t),e=e.getSvgRoot(),(null==(i=this.layers.get(t))?void 0:i.lastChild)!==e){let s;null==(s=this.layers.get(t))||s.appendChild(e)}}createLayer(e){const t=this.workspace.getSvgGroup(),i=I(f.G,{});let s=!1;const n=[...this.layers].sort((r,a)=>r[0]-a[0]);for(const[r,a]of n)if(e<r){t.insertBefore(i,a),s=!0;break}return s||t.appendChild(i),this.layers.set(e,i),i}hasLayer(e){return e===this.dragLayer||new Set(this.layers.values()).has(e)}getBlockLayer(){return this.layers.get(50)}getBubbleLayer(){return this.layers.get(100)}}(this),this.svgBlockCanvas_=this.layerManager.getBlockLayer(),this.svgBubbleCanvas_=this.layerManager.getBubbleLayer(),this.isFlyout||(L(this.svgGroup_,"pointerdown",this,this.onMouseDown,!1),this.dummyWheelListener=()=>{},document.body.addEventListener("wheel",this.dummyWheelListener),L(this.svgGroup_,"wheel",this,this.onMouseWheel)),this.options.hasCategories&&(this.toolbox=new(xe(k.TOOLBOX,this.options,!0))(this)),this.grid&&this.grid.update(this.scale),this.recordDragTargets(),(e=xe(k.CURSOR,this.options))&&this.markerManager.setCursor(new e(this)),e=null===this.options.parentWorkspace,this.renderer.createDom(this.svgGroup_,this.getTheme(),e?this.getInjectionDiv():void 0),o.getFocusManager$$module$build$src$core$focus_manager().registerTree(this,!!this.injectionDiv||this.isFlyout),this.svgGroup_}dispose(){if(this.rendered=!1,this.currentGesture_&&this.currentGesture_.cancel(),this.svgGroup_&&J(this.svgGroup_),this.toolbox&&(this.toolbox.dispose(),this.toolbox=null),this.flyout&&(this.flyout.dispose(),this.flyout=null),this.trashcan&&(this.trashcan.dispose(),this.trashcan=null),this.scrollbar&&(this.scrollbar.dispose(),this.scrollbar=null),this.zoomControls_&&this.zoomControls_.dispose(),this.audioManager&&this.audioManager.dispose(),this.grid&&(this.grid=null),this.renderer.dispose(),this.markerManager.dispose(),super.dispose(),this.themeManager_&&(this.themeManager_.unsubscribeWorkspace(this),this.themeManager_.unsubscribe(this.svgBackground_),this.options.parentWorkspace||this.themeManager_.dispose()),this.connectionDBList.length=0,this.toolboxCategoryCallbacks.clear(),this.flyoutButtonCallbacks.clear(),!this.options.parentWorkspace){const e=this.getParentSvg();e&&e.parentNode&&J(e.parentNode)}this.resizeHandlerWrapper&&(K(this.resizeHandlerWrapper),this.resizeHandlerWrapper=null),this.dummyWheelListener&&(document.body.removeEventListener("wheel",this.dummyWheelListener),this.dummyWheelListener=null),o.getFocusManager$$module$build$src$core$focus_manager().isRegistered(this)&&o.getFocusManager$$module$build$src$core$focus_manager().unregisterTree(this)}addTrashcan(){this.trashcan=Ze.newTrashcan(this);const e=this.trashcan.createDom();this.svgGroup_.insertBefore(e,this.getCanvas())}static newTrashcan(e){throw Error("The implementation of newTrashcan should be monkey-patched in by blockly.ts")}addZoomControls(){this.zoomControls_=new jh(this);const e=this.zoomControls_.createDom();this.svgGroup_.appendChild(e)}copyOptionsForFlyout(){return new Xt({parentWorkspace:this,rtl:this.RTL,oneBasedIndex:this.options.oneBasedIndex,horizontalLayout:this.horizontalLayout,renderer:this.options.renderer,rendererOverrides:this.options.rendererOverrides,plugins:this.options.plugins,modalInputs:this.options.modalInputs,move:{scrollbars:!0}})}addFlyout(e){const t=this.copyOptionsForFlyout();return t.toolboxPosition=this.options.toolboxPosition,this.flyout=this.horizontalLayout?new(xe(k.FLYOUTS_HORIZONTAL_TOOLBOX,this.options,!0))(t):new(xe(k.FLYOUTS_VERTICAL_TOOLBOX,this.options,!0))(t),this.flyout.autoClose=!1,this.flyout.getWorkspace().setVisible(!0),this.flyout.createDom(e)}getFlyout(e){return this.flyout||e?this.flyout:this.toolbox?this.toolbox.getFlyout():null}getToolbox(){return this.toolbox}updateScreenCalculations(){this.updateInverseScreenCTM(),this.recordDragTargets()}resizeContents(){this.resizesEnabled&&this.rendered&&(this.scrollbar&&this.scrollbar.resize(),this.updateInverseScreenCTM())}resize(){this.toolbox?this.toolbox.position():this.flyout&&this.flyout.position();const e=this.componentManager.getComponents(de.Capability.POSITIONABLE,!0),t=this.getMetricsManager().getUiMetrics(),i=[];for(let n,s=0;n=e[s];s++){n.position(t,i);const r=n.getBoundingRectangle();r&&i.push(r)}this.scrollbar&&this.scrollbar.resize(),this.updateScreenCalculations()}updateScreenCalculationsIfScrolled(){const e=kc();S.equals(this.lastRecordedPageScroll,e)||(this.lastRecordedPageScroll=e,this.updateScreenCalculations())}getLayerManager(){return this.layerManager}getCanvas(){return this.layerManager.getBlockLayer()}setCachedParentSvgSize(e,t){const i=this.getParentSvg();null!=e&&(this.cachedParentSvgSize.width=e,i.setAttribute("data-cached-width",`${e}`)),null!=t&&(this.cachedParentSvgSize.height=t,i.setAttribute("data-cached-height",`${t}`))}getBubbleCanvas(){return this.layerManager.getBubbleLayer()}getParentSvg(){if(!this.cachedParentSvg){let e=this.svgGroup_;for(;e;){if("svg"===e.tagName){this.cachedParentSvg=e;break}e=e.parentNode}}return this.cachedParentSvg}maybeFireViewportChangeEvent(){if(se()){var e=this.scale,t=-this.scrollY,i=-this.scrollX;if(!(e===this.oldScale&&Math.abs(t-this.oldTop)<1&&Math.abs(i-this.oldLeft)<1)){var s=new(P(b.VIEWPORT_CHANGE))(t,i,e,this.id,this.oldScale);this.oldScale=e,this.oldTop=t,this.oldLeft=i,B(s)}}}translate(e,t){let i,s;null==(i=this.layerManager)||i.translateLayers(new S(e,t),this.scale),null==(s=this.grid)||s.moveTo(e,t),this.maybeFireViewportChangeEvent()}getWidth(){const e=this.getMetrics();return e?e.viewWidth/this.scale:0}setVisible(e){this.visible=e,this.svgGroup_&&(this.scrollbar&&this.scrollbar.setContainerVisible(e),this.getFlyout()&&this.getFlyout().setContainerVisible(e),this.getParentSvg().style.display=e?"block":"none",this.toolbox&&this.toolbox.setVisible(e),e||this.hideChaff(!0))}render(){const e=this.getAllBlocks(!1);for(let t=e.length-1;t>=0;t--)e[t].queueRender();this.getTopBlocks().flatMap(t=>t.getDescendants(!1)).filter(t=>t.isInsertionMarker()).forEach(t=>t.queueRender())}highlightBlock(e,t){if(void 0===t){for(let s,i=0;s=this.highlightedBlocks[i];i++)s.setHighlighted(!1);this.highlightedBlocks.length=0}(e=e?this.getBlockById(e):null)&&((t=void 0===t||t)?this.highlightedBlocks.includes(e)||this.highlightedBlocks.push(e):nt(this.highlightedBlocks,e),e.setHighlighted(t))}variableChangeCallback(e){switch(e.type){case b.VAR_CREATE:case b.VAR_DELETE:case b.VAR_RENAME:case b.VAR_TYPE_CHANGE:this.refreshToolboxSelection()}}refreshToolboxSelection(){const e=this.isFlyout?this.targetWorkspace:this;e&&!e.currentGesture_&&e.toolbox&&e.toolbox.getFlyout()&&e.toolbox.refreshSelection()}recordDragTargets(){const e=this.componentManager.getComponents(de.Capability.DRAG_TARGET,!0);this.dragTargetAreas=[];for(let i,t=0;i=e[t];t++){const s=i.getClientRect();s&&this.dragTargetAreas.push({component:i,clientRect:s})}}newBlock(e,t){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}newComment(e){throw Error("The implementation of newComment should be monkey-patched in by blockly.ts")}getDragTarget(e){for(let i,t=0;i=this.dragTargetAreas[t];t++)if(i.clientRect.contains(e.clientX,e.clientY))return i.component;return null}onMouseDown(e){const t=this.getGesture(e);t&&t.handleWsStart(e,this)}startDrag(e,t){vi(this,e,t)}moveDrag(e){return yi(this,e)}setKeyboardMoveInProgress(e){this.keyboardMoveInProgress=e}isDragging(){return this.keyboardMoveInProgress||null!==this.currentGesture_&&this.currentGesture_.isDragging()}isDraggable(){return this.options.moveOptions&&this.options.moveOptions.drag}isMovable(){return this.options.moveOptions&&!!this.options.moveOptions.scrollbars||this.options.moveOptions&&this.options.moveOptions.wheel||this.options.moveOptions&&this.options.moveOptions.drag||this.options.zoomOptions&&this.options.zoomOptions.wheel||this.options.zoomOptions&&this.options.zoomOptions.pinch}isMovableHorizontally(){const e=!!this.scrollbar;return this.isMovable()&&(!e||e&&this.scrollbar.canScrollHorizontally())}isMovableVertically(){const e=!!this.scrollbar;return this.isMovable()&&(!e||e&&this.scrollbar.canScrollVertically())}onMouseWheel(e){if(sc.inProgress())e.preventDefault(),e.stopPropagation();else{var t=this.options.zoomOptions&&this.options.zoomOptions.wheel,i=this.options.moveOptions&&this.options.moveOptions.wheel;if(t||i){var s=vo(e);if(Lh)var n=e.metaKey;t&&(e.ctrlKey||n||!i)?(s=-s.y/50,t=Et(e,this.getParentSvg(),this.getInverseScreenCTM()),this.zoom(t.x,t.y,s)):(t=this.scrollX-s.x,i=this.scrollY-s.y,e.shiftKey&&!s.x&&(t=this.scrollX-s.y,i=this.scrollY),this.scroll(t,i)),e.preventDefault()}}}getBlocksBoundingBox(){const e=this.getTopBoundedElements();if(!e.length)return new z(0,0,0,0);const t=e[0].getBoundingRectangle();for(let s=1;s<e.length;s++){var i=e[s];i.isInsertionMarker&&i.isInsertionMarker()||((i=i.getBoundingRectangle()).top<t.top&&(t.top=i.top),i.bottom>t.bottom&&(t.bottom=i.bottom),i.left<t.left&&(t.left=i.left),i.right>t.right&&(t.right=i.right))}return t}cleanUp(){this.setResizesEnabled(!1),o.setGroup$$module$build$src$core$events$utils(!0);var e=this.getTopBlocks(!0),t=e.filter(r=>r.isMovable());const i=e.filter(r=>!r.isMovable()).map(r=>r.getBoundingRectangle());e=function(r){for(const a of i)if(r.intersects(a))return a;return null};var s=0;const n=this.renderer.getConstants().MIN_BLOCK_HEIGHT;for(const r of t){for(t=r.getBoundingRectangle(),r.moveBy(-t.left,s-t.top,["cleanup"]),r.snapToGrid(),s=e(t=r.getBoundingRectangle());null!=s;)s=s.top+s.getHeight()+n,r.moveBy(0,s-t.top,["cleanup"]),r.snapToGrid(),s=e(t=r.getBoundingRectangle());s=r.getRelativeToSurfaceXY().y+r.getHeightWidth().height+n}o.setGroup$$module$build$src$core$events$utils(!1),this.setResizesEnabled(!0)}showContextMenu(e){if(!this.isReadOnly()&&!this.isFlyout){var t=W.registry.getContextMenuOptions({workspace:this,focusedNode:this},e);this.configureContextMenu&&this.configureContextMenu(t,e);var i=e instanceof PointerEvent?new S(e.clientX,e.clientY):Ji(this,new S(5,5));It(e,t,this.RTL,this,i)}}updateToolbox(e){if(e=lr(e)){if(!this.options.languageTree)throw Error("Existing toolbox is null.  Can't create new toolbox.");if(cr(e)){if(!this.toolbox)throw Error("Existing toolbox has no categories.  Can't change mode.");this.options.languageTree=e,this.toolbox.render(e)}else{if(!this.flyout)throw Error("Existing toolbox has categories.  Can't change mode.");this.options.languageTree=e,this.flyout.show(e)}}else if(this.options.languageTree)throw Error("Can't nullify an existing toolbox.")}markFocused(){this.options.parentWorkspace?this.options.parentWorkspace.markFocused():(en(this),this.getParentSvg().focus({preventScroll:!0}))}zoom(e,t,i){i=Math.pow(this.options.zoomOptions.scaleSpeed,i);const s=this.scale*i;if(this.scale!==s){s>this.options.zoomOptions.maxScale?i=this.options.zoomOptions.maxScale/this.scale:s<this.options.zoomOptions.minScale&&(i=this.options.zoomOptions.minScale/this.scale);var n=this.getCanvas().getCTM(),r=this.getParentSvg().createSVGPoint();r.x=e,r.y=t,r=r.matrixTransform(n.inverse()),n=n.translate((e=r.x)*(1-i),(t=r.y)*(1-i)).scale(i),this.scrollX=n.e,this.scrollY=n.f,this.setScale(s)}}zoomCenter(e){var t=this.getMetrics();let i;this.flyout?(i=t.svgWidth?t.svgWidth/2:0,t=t.svgHeight?t.svgHeight/2:0):(i=t.viewWidth/2+t.absoluteLeft,t=t.viewHeight/2+t.absoluteTop),this.zoom(i,t,e)}zoomToFit(){if(this.isMovable()){var e=this.getMetrics(),t=e.viewWidth;e=e.viewHeight;var i=this.getBlocksBoundingBox(),n=i.right-i.left+40;if(i=i.bottom-i.top+40,n){this.flyout&&(this.horizontalLayout?(e+=this.flyout.getHeight(),i+=this.flyout.getHeight()/this.scale):(t+=this.flyout.getWidth(),n+=this.flyout.getWidth()/this.scale)),t/=n,e/=i,o.disable$$module$build$src$core$events$utils();try{this.setScale(Math.min(t,e)),this.scrollCenter()}finally{o.enable$$module$build$src$core$events$utils()}this.maybeFireViewportChangeEvent()}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}beginCanvasTransition(){A(this.getCanvas(),"blocklyCanvasTransitioning"),A(this.getBubbleCanvas(),"blocklyCanvasTransitioning")}endCanvasTransition(){X(this.getCanvas(),"blocklyCanvasTransitioning"),X(this.getBubbleCanvas(),"blocklyCanvasTransitioning")}scrollCenter(){if(this.isMovable()){var e=this.getMetrics(),t=(e.scrollWidth-e.viewWidth)/2,i=(e.scrollHeight-e.viewHeight)/2;this.scroll(t=-t-e.scrollLeft,i=-i-e.scrollTop)}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}centerOnBlock(e,t){if(this.isMovable()){var i=e?this.getBlockById(e):null;if(i){e=i.getRelativeToSurfaceXY(),i=t?{height:i.height,width:i.width}:i.getHeightWidth();var s=this.scale;t=(e.x+(this.RTL?-1:1)*i.width/2)*s,e=(e.y+i.height/2)*s,i=this.getMetrics(),this.scroll(-(t-i.viewWidth/2),-(e-i.viewHeight/2))}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}setScale(e){this.options.zoomOptions.maxScale&&e>this.options.zoomOptions.maxScale?e=this.options.zoomOptions.maxScale:this.options.zoomOptions.minScale&&e<this.options.zoomOptions.minScale&&(e=this.options.zoomOptions.minScale),this.scale=e,this.hideChaff(!1),(e=this.getFlyout(!1))&&e.isVisible()&&(e.reflow(),this.recordDragTargets()),this.grid&&this.grid.update(this.scale),e=this.getMetrics(),this.scrollX-=e.absoluteLeft,this.scrollY-=e.absoluteTop,e.viewLeft+=e.absoluteLeft,e.viewTop+=e.absoluteTop,this.scroll(this.scrollX,this.scrollY),this.scrollbar&&(this.flyout?this.scrollbar.resizeView(e):this.scrollbar.resizeContent(e))}getScale(){return this.scale}getAbsoluteScale(){const e=i=>{if(i.isFlyout){let s;const n=null==(s=i.targetWorkspace)?void 0:s.getFlyout();if(n instanceof oc)return n.getFlyoutScale()}return i.getScale()},t=(i,s)=>i.options.parentWorkspace&&i.options.parentWorkspace.getSvgGroup().contains(i.getSvgGroup())?t(i.options.parentWorkspace,s*e(i)):s*e(i);return t(this,1)}scroll(e,t){this.hideChaff(!0);const i=this.getMetrics();e=Math.min(e,-i.scrollLeft),t=Math.min(t,-i.scrollTop);const s=i.scrollTop+Math.max(0,i.scrollHeight-i.viewHeight);e=Math.max(e,-(i.scrollLeft+Math.max(0,i.scrollWidth-i.viewWidth))),t=Math.max(t,-s),this.scrollX=e,this.scrollY=t,this.scrollbar&&this.scrollbar.set(-(e+i.scrollLeft),-(t+i.scrollTop),!1),this.translate(e+=i.absoluteLeft,t+=i.absoluteTop)}getBlockById(e){return super.getBlockById(e)}getAllBlocks(e=!1){return super.getAllBlocks(e)}getTopBlocks(e=!1){return super.getTopBlocks(e)}addTopBlock(e){this.addTopBoundedElement(e),super.addTopBlock(e)}removeTopBlock(e){this.removeTopBoundedElement(e),super.removeTopBlock(e)}addTopComment(e){this.addTopBoundedElement(e),super.addTopComment(e)}removeTopComment(e){this.removeTopBoundedElement(e),super.removeTopComment(e)}getTopComments(e=!1){return super.getTopComments(e)}getCommentById(e){return super.getCommentById(e)}getRootWorkspace(){return super.getRootWorkspace()}addTopBoundedElement(e){this.topBoundedElements.push(e)}removeTopBoundedElement(e){nt(this.topBoundedElements,e)}getTopBoundedElements(e=!1){const t=[].concat(this.topBoundedElements);return e&&t.sort(this.sortByOrigin.bind(this)),t}setResizesEnabled(e){const t=!this.resizesEnabled&&e;this.resizesEnabled=e,t&&this.resizeContents()}clear(){this.setResizesEnabled(!1),super.clear(),this.topBoundedElements=[],this.setResizesEnabled(!0)}registerButtonCallback(e,t){if("function"!=typeof t)throw TypeError("Button callbacks must be functions.");this.flyoutButtonCallbacks.set(e,t)}getButtonCallback(e){let t;return null!=(t=this.flyoutButtonCallbacks.get(e))?t:null}removeButtonCallback(e){this.flyoutButtonCallbacks.delete(e)}registerToolboxCategoryCallback(e,t){if("function"!=typeof t)throw TypeError("Toolbox category callbacks must be functions.");this.toolboxCategoryCallbacks.set(e,t)}getToolboxCategoryCallback(e){return this.toolboxCategoryCallbacks.get(e)||null}removeToolboxCategoryCallback(e){this.toolboxCategoryCallbacks.delete(e)}getGesture(e){if(this.keyboardMoveInProgress)return e.preventDefault(),e.stopPropagation(),null;const t="pointerdown"===e.type;let i;return t&&null!=(i=this.currentGesture_)&&i.hasStarted()&&(console.warn("Tried to start the same gesture twice."),this.currentGesture_.cancel()),!this.currentGesture_&&t&&(this.currentGesture_=new sc(e,this)),this.currentGesture_}clearGesture(){this.currentGesture_=null}cancelCurrentGesture(){this.currentGesture_&&this.currentGesture_.cancel()}getAudioManager(){return this.audioManager}getGrid(){return this.grid}hideChaff(e=!1){Vt(),Gt(this),yt(),this.hideComponents(e)}hideComponents(e=!1){this.getComponentManager().getComponents(de.Capability.AUTOHIDEABLE,!0).forEach(t=>t.autoHide(e))}static setTopLevelWorkspaceMetrics(e){const t=this.getMetrics();"number"==typeof e.x&&(this.scrollX=-(t.scrollLeft+(t.scrollWidth-t.viewWidth)*e.x)),"number"==typeof e.y&&(this.scrollY=-(t.scrollTop+(t.scrollHeight-t.viewHeight)*e.y)),this.translate(this.scrollX+t.absoluteLeft,this.scrollY+t.absoluteTop)}addClass(e){this.injectionDiv&&A(this.injectionDiv,e)}removeClass(e){this.injectionDiv&&X(this.injectionDiv,e)}setIsReadOnly(e){super.setIsReadOnly(e),e?this.addClass("blocklyReadOnly"):this.removeClass("blocklyReadOnly")}scrollBoundsIntoView(e,t=10){if(!sc.inProgress()){var i=this.getScale(),s=this.getMetricsManager().getViewMetrics(!0);if(s=new z(s.top,s.top+s.height,s.left,s.left+s.width),!(e.left>=s.left&&e.top>=s.top&&e.right<=s.right&&e.bottom<=s.bottom)){(e=e.clone()).top-=t,e.bottom+=t,e.left-=t,e.right+=t;var n=t=0;e.left<s.left?t=this.RTL?Math.min(s.left-e.left,s.right-e.right):s.left-e.left:e.right>s.right&&(t=this.RTL?s.right-e.right:Math.max(s.right-e.right,s.left-e.left)),e.top<s.top?n=s.top-e.top:e.bottom>s.bottom&&(n=Math.max(s.bottom-e.bottom,s.top-e.top)),this.scroll(this.scrollX+t*i,this.scrollY+n*i)}}}getFocusableElement(){return this.svgGroup_}getFocusableTree(){return this.isMutator&&this.options.parentWorkspace||this}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}getRootFocusableNode(){return this}getRestoredFocusableNode(e){if(e)return null;let t;return null!=(t=this.getTopBlocks(!0)[0])?t:null}getNestedTrees(){const e=this.getAllBlocks().map(i=>i.getIcons()).flat().filter(i=>i instanceof o.MutatorIcon$$module$build$src$core$icons$mutator_icon&&i.bubbleIsVisible()).map(i=>{let s;return null==(s=i.getBubble())?void 0:s.getWorkspace()}).filter(i=>!!i),t=this.getFlyout(!0);return t&&e.push(t.getWorkspace()),e}searchForWorkspaceComment(e){for(const t of this.getTopComments())if(t instanceof jt&&t.canBeFocused()&&t.getFocusableElement().id===e)return t}lookUpFocusableNode(e){var t;const i=null==(t=this.targetWorkspace)?void 0:t.getFlyout();if(this.isFlyout&&i)for(var s of i.getContents())if(t=s.getElement(),ai(t)&&t.canBeFocused()&&t.getFocusableElement().id===e)return t;if(s=e.indexOf("_field_"),t=e.indexOf("_connection_"),-1!==s){var n=e.substring(0,s);if(n=this.getBlockById(n))for(var r of n.getFields())if(r.canBeFocused()&&r.getFocusableElement().id===e)return r;return null}if(-1!==t){if(n=e.substring(0,t),n=this.getBlockById(n))for(const $ of n.getConnections_(!0))if($.id===e)return $;return null}var a;if(-1!==(r=Math.max(e.indexOf(Xa),e.indexOf(mp),e.indexOf(fp)))&&(r=e.substring(0,r),r=this.searchForWorkspaceComment(r)))return e.indexOf(Xa)>-1?r.getEditorFocusableNode():null!=(a=r.view.getCommentBarButtons().find($=>$.getFocusableElement().id.includes(e)))?a:null;if((a=this.getAllBlocks(!1).find($=>$.getFocusableElement().id===e))||(a=this.searchForWorkspaceComment(e)))return a;for(n of a=this.getAllBlocks().map($=>$.getIcons()).flat()){if(n.canBeFocused()&&n.getFocusableElement().id===e)return n;if(Oo(n)&&(a=n.getBubble())&&a.canBeFocused()&&a.getFocusableElement().id===e)return a}return null}onTreeFocus(e,t){}onTreeBlur(e){if(this.isFlyout&&this.targetWorkspace&&!o.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()){var t=this.targetWorkspace.getFlyout(),i=this.targetWorkspace.getToolbox();i&&e===i||(i&&i.clearSelection(),t&&Oe(t)&&t.autoHide(!1))}}getNavigator(){return this.navigator}setNavigator(e){this.navigator=e}},Dm={};Dm.WorkspaceSvg=Ze,Dm.resizeSvgContents=Gg;var Bs=class extends vs{constructor(e){super(),this.isBlank=typeof e>"u",e&&(this.varId=e.getId(),this.workspaceId=e.getWorkspace().id)}toJson(){const e=super.toJson();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");return e.varId=this.varId,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new Bs)).varId=e.varId,t}},yu=class extends Bs{constructor(e){super(e),this.type=b.VAR_CREATE,e&&(this.varType=e.getType(),this.varName=e.getName())}toJson(){const e=super.toJson();if(void 0===this.varType)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");return e.varType=this.varType,e.varName=this.varName,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new yu)).varType=e.varType,t.varName=e.varName,t}run(e){var t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");t=t.getVariableMap(),e?t.createVariable(this.varName,this.varType,this.varId):(e=t.getVariableById(this.varId))&&t.deleteVariable(e)}};U(k.EVENT,b.VAR_CREATE,yu);var Jp=class{constructor(e,t,i,s){this.workspace=e,this.name=t,this.type=i||"",this.id=s||Te()}getId(){return this.id}getName(){return this.name}setName(e){return this.name=e,this}getType(){return this.type}setType(e){return this.type=e,this}getWorkspace(){return this.workspace}save(){const e={name:this.getName(),id:this.getId()},t=this.getType();return t&&(e.type=t),e}static load(e,t){e=new this(t,e.name,e.type,e.id),t.getVariableMap().addVariable(e),B(new(P(b.VAR_CREATE))(e))}};U(k.VARIABLE_MODEL,ct,Jp);var Cu=class extends Bs{constructor(e){super(e),this.type=b.VAR_DELETE,e&&(this.varType=e.getType(),this.varName=e.getName())}toJson(){const e=super.toJson();if(void 0===this.varType)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");return e.varType=this.varType,e.varName=this.varName,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new Cu)).varType=e.varType,t.varName=e.varName,t}run(e){var t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");t=t.getVariableMap(),e?(e=t.getVariableById(this.varId))&&t.deleteVariable(e):t.createVariable(this.varName,this.varType,this.varId)}};U(k.EVENT,b.VAR_DELETE,Cu);var Iu=class extends Bs{constructor(e,t){super(e),this.type=b.VAR_RENAME,e&&(this.oldName=e.getName(),this.newName=typeof t>"u"?"":t)}toJson(){const e=super.toJson();if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");return e.oldName=this.oldName,e.newName=this.newName,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new Iu)).oldName=e.oldName,t.newName=e.newName,t}run(e){var t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");const i=(t=t.getVariableMap()).getVariableById(this.varId);e?i&&t.renameVariable(i,this.newName):i&&t.renameVariable(i,this.oldName)}};U(k.EVENT,b.VAR_RENAME,Iu);var Qp=class{constructor(e,t=!1){this.workspace=e,this.potentialMap=t,this.variableMap=new Map}clear(){for(const e of this.variableMap.values())for(const t of e.values())this.deleteVariable(t);if(0!==this.variableMap.size)throw Error("Non-empty variable map")}renameVariable(e,t){if(e.getName()===t)return e;var i=e.getType();i=this.getVariable(t,i);const s=this.workspace.getAllBlocks(!1);let n="";this.potentialMap||(n=o.getGroup$$module$build$src$core$events$utils())||o.setGroup$$module$build$src$core$events$utils(!0);try{i&&i.getId()!==e.getId()?this.renameVariableWithConflict(e,t,i,s):this.renameVariableAndUses(e,t,s)}finally{this.potentialMap||o.setGroup$$module$build$src$core$events$utils(n)}return e}changeVariableType(e,t){var i;let s;return null==(i=this.variableMap.get(e.getType()))||i.delete(e.getId()),e.setType(t),(i=null!=(s=this.variableMap.get(t))?s:new Map).set(e.getId(),e),this.variableMap.has(t)||this.variableMap.set(t,i),e}renameVariableById(e,t){Re("VariableMap.renameVariableById","v12","v13","VariableMap.renameVariable");const i=this.getVariableById(e);if(!i)throw Error("Tried to rename a variable that didn't exist. ID: "+e);this.renameVariable(i,t)}renameVariableAndUses(e,t,i){for(this.potentialMap||B(new(P(b.VAR_RENAME))(e,t)),e.setName(t),t=0;t<i.length;t++)i[t].updateVarName(e)}renameVariableWithConflict(e,t,i,s){const n=e.getType();for(t!==i.getName()&&this.renameVariableAndUses(i,t,s),t=0;t<s.length;t++)s[t].renameVarById(e.getId(),i.getId());let a;this.potentialMap||B(new(P(b.VAR_DELETE))(e)),null==(a=this.variableMap.get(n))||a.delete(e.getId())}createVariable(e,t,i){var s=this.getVariable(e,t);if(s){if(i&&s.getId()!==i)throw Error('Variable "'+e+'" is already in use and its id is "'+s.getId()+'" which conflicts with the passed in id, "'+i+'".');return s}if(i&&this.getVariableById(i))throw Error('Variable id, "'+i+'", is already in use.');if(s=i||Te(),t=t||"",!(i=Tt(k.VARIABLE_MODEL,ct,!0)))throw Error("No variable model is registered.");let n;return s=new i(this.workspace,e,t,s),(e=null!=(n=this.variableMap.get(t))?n:new Map).set(s.getId(),s),this.variableMap.has(t)||this.variableMap.set(t,e),this.potentialMap||B(new(P(b.VAR_CREATE))(s)),s}addVariable(e){const t=e.getType();let i;this.variableMap.has(t)||this.variableMap.set(t,new Map),null==(i=this.variableMap.get(t))||i.set(e.getId(),e)}deleteVariable(e){const t=os(this.workspace,e.getId());let i="";this.potentialMap||(i=o.getGroup$$module$build$src$core$events$utils())||o.setGroup$$module$build$src$core$events$utils(!0);try{for(let n=0;n<t.length;n++)t[n].dispose(!0);const s=this.variableMap.get(e.getType());s&&s.has(e.getId())&&(s.delete(e.getId()),this.potentialMap||B(new(P(b.VAR_DELETE))(e)),0===s.size&&this.variableMap.delete(e.getType()))}finally{this.potentialMap||o.setGroup$$module$build$src$core$events$utils(i)}}deleteVariableById(e){Re("VariableMap.deleteVariableById","v12","v13","Blockly.Variables.deleteVariable"),(e=this.getVariableById(e))&&o.deleteVariable$$module$build$src$core$variables(this.workspace,e)}getVariable(e,t){if(!(t=this.variableMap.get(t||"")))return null;let i;return null!=(i=[...t.values()].find(s=>o.Names$$module$build$src$core$names.equals(s.getName(),e)))?i:null}getVariableById(e){for(const t of this.variableMap.values())if(t.has(e)){let i;return null!=(i=t.get(e))?i:null}return null}getVariablesOfType(e){return(e=this.variableMap.get(e||""))?[...e.values()]:[]}getTypes(){return[...this.variableMap.keys()]}getAllVariables(){let e=[];for(const t of this.variableMap.values())e=e.concat(...t.values());return e}getAllVariableNames(){Re("VariableMap.getAllVariableNames","v12","v13","Blockly.Variables.getAllVariables");const e=[];for(const t of this.variableMap.values())for(const i of t.values())e.push(i.getName());return e}getVariableUsesById(e){return Re("VariableMap.getVariableUsesById","v12","v13","Blockly.Variables.getVariableUsesById"),os(this.workspace,e)}};U(k.VARIABLE_MAP,ct,Qp);var ku=class extends qt{constructor(e,t){super(t),this.type=b.TRASHCAN_OPEN,this.isOpen=e}toJson(){const e=super.toJson();if(void 0===this.isOpen)throw Error("Whether this is already open or not is undefined. Either pass a value to the constructor, or call fromJson");return e.isOpen=this.isOpen,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new ku)).isOpen=e.isOpen,t}};U(k.EVENT,b.TRASHCAN_OPEN,ku);var eg=class extends ec{constructor(e){super(),this.workspace=e,this.id="trashcan",this.contents=[],this.flyout=null,this.isLidOpen=!1,this.minOpenness=0,this.lidTask=this.svgLid=this.svgGroup=null,this.top=this.left=this.lidOpen=0,this.initialized=!1,this.workspace.options.maxTrashcanContents<=0||(e=this.workspace.copyOptionsForFlyout(),this.workspace.horizontalLayout?(e.toolboxPosition=this.workspace.toolboxPosition===G.TOP?G.BOTTOM:G.TOP,this.flyout=new(xe(k.FLYOUTS_HORIZONTAL_TOOLBOX,this.workspace.options,!0))(e)):(e.toolboxPosition=this.workspace.toolboxPosition===G.RIGHT?G.LEFT:G.RIGHT,this.flyout=new(xe(k.FLYOUTS_VERTICAL_TOOLBOX,this.workspace.options,!0))(e)),this.workspace.addChangeListener(this.onDelete.bind(this)))}createDom(){let e;this.svgGroup=I(f.G,{class:"blocklyTrash"});const t=String(Math.random()).substring(2);e=I(f.CLIPPATH,{id:"blocklyTrashBodyClipPath"+t},this.svgGroup),I(f.RECT,{width:Qn,height:Su,y:er},e);const i=I(f.IMAGE,{width:Ye_width,x:-tg,height:Ye_height,y:-og,"clip-path":"url(#blocklyTrashBodyClipPath"+t+")"},this.svgGroup);return i.setAttributeNS($t,"xlink:href",this.workspace.options.pathToMedia+Ye_url),e=I(f.CLIPPATH,{id:"blocklyTrashLidClipPath"+t},this.svgGroup),I(f.RECT,{width:Qn,height:er},e),this.svgLid=I(f.IMAGE,{width:Ye_width,x:-tg,height:Ye_height,y:-og,"clip-path":"url(#blocklyTrashLidClipPath"+t+")"},this.svgGroup),this.svgLid.setAttributeNS($t,"xlink:href",this.workspace.options.pathToMedia+Ye_url),qe(this.svgGroup,"pointerdown",this,this.blockMouseDownWhenOpenable),qe(this.svgGroup,"pointerup",this,this.click),qe(i,"pointerover",this,this.mouseOver),qe(i,"pointerout",this,this.mouseOut),this.animateLid(),this.svgGroup}init(){if(this.workspace.options.maxTrashcanContents>0){const e=this.flyout.createDom(f.SVG);A(e,"blocklyTrashcanFlyout"),c(e,this.workspace.getParentSvg()),this.flyout.init(this.workspace)}this.workspace.getComponentManager().addComponent({component:this,weight:de.ComponentWeight.TRASHCAN_WEIGHT,capabilities:[de.Capability.AUTOHIDEABLE,de.Capability.DELETE_AREA,de.Capability.DRAG_TARGET,de.Capability.POSITIONABLE]}),this.initialized=!0,this.setLidOpen(!1)}dispose(){this.workspace.getComponentManager().removeComponent("trashcan"),this.svgGroup&&J(this.svgGroup),this.lidTask&&clearTimeout(this.lidTask)}hasContents(){return!!this.contents.length}contentsIsOpen(){return!!this.flyout&&this.flyout.isVisible()}openFlyout(){if(!this.contentsIsOpen()){var e=this.contents.map(function(i){return JSON.parse(i)}),t=this.workspace.getParentSvg().style;t.cursor="wait",setTimeout(()=>{let i,s;null==(i=this.flyout)||i.show(e),t.cursor="",null==(s=this.workspace.scrollbar)||s.setVisible(!1)},10),this.fireUiEvent(!0)}}closeFlyout(){var e,t;this.contentsIsOpen()&&(null==(e=this.flyout)||e.hide(),null==(t=this.workspace.scrollbar)||t.setVisible(!0),this.fireUiEvent(!1),this.workspace.recordDragTargets())}autoHide(e){!e&&this.flyout&&this.closeFlyout()}emptyContents(){this.hasContents()&&(this.contents.length=0,this.setMinOpenness(0),this.closeFlyout())}position(e,t){if(this.initialized){var s,n,i=hr(this.workspace,e);e=dr(i,new j(Qn,Su+er),TT,Bm,e,this.workspace),t=pr(e,Bm,i.vertical===xi.TOP?Cs.DOWN:Cs.UP,t),this.top=t.top,this.left=t.left,null==(s=this.svgGroup)||s.setAttribute("transform","translate("+this.left+","+this.top+")"),null==(n=this.flyout)||n.position()}}getBoundingRectangle(){return new z(this.top,this.top+Su+er,this.left,this.left+Qn)}getClientRect(){if(!this.svgGroup)return null;var e=this.svgGroup.getBoundingClientRect();const t=e.top+og-wu;return new z(t,t+er+Su+2*wu,e=e.left+tg-wu,e+Qn+2*wu)}onDragOver(e){this.setLidOpen(this.wouldDelete_)}onDragExit(e){this.setLidOpen(!1)}onDrop(e){setTimeout(this.setLidOpen.bind(this,!1),100)}setLidOpen(e){this.isLidOpen!==e&&(this.lidTask&&clearTimeout(this.lidTask),this.isLidOpen=e,this.animateLid())}animateLid(){const e=yT;var t=1/(e+1);this.lidOpen+=this.isLidOpen?t:-t,this.lidOpen=Math.min(Math.max(this.lidOpen,this.minOpenness),1),this.setLidAngle(this.lidOpen*Fm),t=Pm+this.lidOpen*(CT-Pm),this.svgGroup&&(this.svgGroup.style.opacity=`${t}`),this.lidOpen>this.minOpenness&&this.lidOpen<1&&(this.lidTask=setTimeout(this.animateLid.bind(this),vT/e))}setLidAngle(e){const t=this.workspace.toolboxPosition===G.RIGHT||this.workspace.horizontalLayout&&this.workspace.RTL;let i;null==(i=this.svgLid)||i.setAttribute("transform","rotate("+(t?-e:e)+","+(t?4:Qn-4)+","+(er-2)+")")}setMinOpenness(e){this.minOpenness=e,this.isLidOpen||this.setLidAngle(e*Fm)}closeLid(){this.setLidOpen(!1)}click(){this.hasContents()&&!this.workspace.isDragging()&&this.openFlyout()}fireUiEvent(e){e=new(P(b.TRASHCAN_OPEN))(e,this.workspace.id),B(e)}blockMouseDownWhenOpenable(e){!this.contentsIsOpen()&&this.hasContents()&&e.stopPropagation()}mouseOver(){this.hasContents()&&this.setLidOpen(!0)}mouseOut(){this.setLidOpen(!1)}onDelete(e){if(!(this.workspace.options.maxTrashcanContents<=0||!lo(e)||e.wasShadow)){if(!e.oldJson)throw Error("Encountered a delete event without proper oldJson");if(e=JSON.stringify(this.cleanBlockJson(e.oldJson)),!this.contents.includes(e)){for(this.contents.unshift(e);this.contents.length>this.workspace.options.maxTrashcanContents;)this.contents.pop();this.setMinOpenness(ET)}}}cleanBlockJson(e){return function t(i){if(i){if(delete i.id,delete i.x,delete i.y,delete i.enabled,delete i.disabledReasons,i.icons&&i.icons.comment){var s=i.icons.comment;delete s.height,delete s.width,delete s.pinned}for(var n in s=i.inputs){var r=s[n];const a=r.block;r=r.shadow,a&&t(a),r&&t(r)}i.next&&(i=(n=i.next).block,n=n.shadow,i&&t(i),n&&t(n))}}(e=JSON.parse(JSON.stringify(e))),Object.assign({},{kind:"BLOCK"},e)}},Qn=47,Su=44,er=16,Bm=20,TT=20,wu=10,tg=0,og=32,ET=.1,vT=80,yT=4,Pm=.4,CT=.8,Fm=45,hc=null,pc=null,xu=void 0,eo={};eo.BlockPaster=jn,eo.copy=ma,eo.getLastCopiedData=_a,eo.getLastCopiedLocation=Yd,eo.getLastCopiedWorkspace=ba,eo.paste=Ii,eo.registry=Yh,eo.setLastCopiedData=Zg,eo.setLastCopiedLocation=qg,eo.setLastCopiedWorkspace=Wg;var Ui={};Ui.CollapseCommentBarButton=_p,Ui.CommentBarButton=zl,Ui.CommentEditor=bp,Ui.CommentView=Wn,Ui.DeleteCommentBarButton=Tp,Ui.RenderedWorkspaceComment=jt,Ui.WorkspaceComment=jl;var Ko=function(e){return e.ESCAPE="escape",e.DELETE="delete",e.COPY="copy",e.CUT="cut",e.PASTE="paste",e.UNDO="undo",e.REDO="redo",e}(Ko||{});rh();var _o={};_o.names=Ko,_o.registerCopy=th,_o.registerCut=oh,_o.registerDefaultShortcuts=rh,_o.registerDelete=Qd,_o.registerEscape=Jd,_o.registerPaste=ih,_o.registerRedo=nh,_o.registerUndo=sh;var Au={ProcedureSerializer:class{constructor(e,t){this.procedureModelClass=e,this.parameterModelClass=t,this.priority=75}save(e){return(e=e.getProcedureMap().getProcedures().map(t=>lh(t))).length?e:null}load(e,t){const i=t.getProcedureMap();for(const s of e)i.add(ch(this.procedureModelClass,this.parameterModelClass,s,t))}clear(e){e.getProcedureMap().clear()}}};Au.loadProcedure=ch,Au.saveProcedure=lh;var Um=class{constructor(){this.priority=100}save(e){return(e=e.getAllVariables().map(t=>t.save())).length?e:null}load(e,t){const i=Tt(k.VARIABLE_MODEL,ct);e.forEach(s=>{i?.load(s,t)})}clear(e){e.getVariableMap().clear()}};cn("variables",new Um);var Hm={};Hm.VariableSerializer=Um;var ig={};ig.load=jg,ig.save=zg;var wT={blocks:Hl,exceptions:ks,priorities:V_,procedures:Au,registry:Xh,variables:Hm,workspaceComments:Ra,workspaces:ig};"Blockly"in globalThis||(globalThis.Blockly={Msg:H$});var sg="label",ng=class{load(e,t){return(e=new Je(t.getWorkspace(),t.targetWorkspace,e,!0)).show(),new Ns(e,sg)}gapForItem(e,t){return t}disposeItem(e){(e=e.getElement())instanceof Je&&e.dispose()}getType(){return sg}};U(k.FLYOUT_INFLATER,sg,ng);var rg=class extends cc{constructor(e){super(),this.GRID_UNIT=4,this.CURSOR_COLOUR="#ffa200",this.CURSOR_RADIUS=5,this.JAGGED_TEETH_WIDTH=this.JAGGED_TEETH_HEIGHT=0,this.START_HAT_HEIGHT=22,this.START_HAT_WIDTH=96,this.SHAPES={HEXAGONAL:1,ROUND:2,SQUARE:3,PUZZLE:4,NOTCH:5},this.SHAPE_IN_SHAPE_PADDING={1:{0:5*this.GRID_UNIT,1:2*this.GRID_UNIT,2:5*this.GRID_UNIT,3:5*this.GRID_UNIT},2:{0:3*this.GRID_UNIT,1:3*this.GRID_UNIT,2:1*this.GRID_UNIT,3:2*this.GRID_UNIT},3:{0:2*this.GRID_UNIT,1:2*this.GRID_UNIT,2:2*this.GRID_UNIT,3:2*this.GRID_UNIT}},this.FULL_BLOCK_FIELDS=!0,this.FIELD_TEXT_FONTWEIGHT="bold",this.FIELD_TEXT_FONTFAMILY='"Helvetica Neue", "Segoe UI", Helvetica, sans-serif',this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!0,this.SELECTED_GLOW_COLOUR="#fff200",this.SELECTED_GLOW_SIZE=.5,this.REPLACEMENT_GLOW_COLOUR="#fff200",this.REPLACEMENT_GLOW_SIZE=2,this.selectedGlowFilterId="",this.selectedGlowFilter=null,this.replacementGlowFilterId="",this.SQUARED=this.ROUNDED=this.HEXAGONAL=this.replacementGlowFilter=null,e&&(this.GRID_UNIT=e),this.SMALL_PADDING=this.GRID_UNIT,this.MEDIUM_PADDING=2*this.GRID_UNIT,this.MEDIUM_LARGE_PADDING=3*this.GRID_UNIT,this.LARGE_PADDING=4*this.GRID_UNIT,this.CORNER_RADIUS=1*this.GRID_UNIT,this.NOTCH_WIDTH=9*this.GRID_UNIT,this.NOTCH_HEIGHT=2*this.GRID_UNIT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT=3*this.GRID_UNIT,this.MIN_BLOCK_WIDTH=2*this.GRID_UNIT,this.MIN_BLOCK_HEIGHT=12*this.GRID_UNIT,this.EMPTY_STATEMENT_INPUT_HEIGHT=6*this.GRID_UNIT,this.TOP_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=6*this.GRID_UNIT,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT,this.STATEMENT_INPUT_SPACER_MIN_WIDTH=40*this.GRID_UNIT,this.STATEMENT_INPUT_PADDING_LEFT=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_PADDING=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_MIN_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=6*this.GRID_UNIT,this.CURSOR_WS_WIDTH=20*this.GRID_UNIT,this.FIELD_TEXT_FONTSIZE=3*this.GRID_UNIT,this.FIELD_BORDER_RECT_RADIUS=this.CORNER_RADIUS,this.FIELD_BORDER_RECT_X_PADDING=2*this.GRID_UNIT,this.FIELD_BORDER_RECT_Y_PADDING=1.625*this.GRID_UNIT,this.FIELD_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_COLOUR_DEFAULT_WIDTH=6*this.GRID_UNIT,this.FIELD_COLOUR_DEFAULT_HEIGHT=8*this.GRID_UNIT,this.FIELD_CHECKBOX_X_OFFSET=1*this.GRID_UNIT,this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH=12*this.GRID_UNIT}setFontConstants_(e){super.setFontConstants_(e),this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT=this.FIELD_TEXT_HEIGHT+2*this.FIELD_BORDER_RECT_Y_PADDING}init(){super.init(),this.HEXAGONAL=this.makeHexagonal(),this.ROUNDED=this.makeRounded(),this.SQUARED=this.makeSquared(),this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT+this.INSIDE_CORNERS.rightWidth}setDynamicProperties_(e){super.setDynamicProperties_(e),this.SELECTED_GLOW_COLOUR=e.getComponentStyle("selectedGlowColour")||this.SELECTED_GLOW_COLOUR;const t=Number(e.getComponentStyle("selectedGlowSize"));this.SELECTED_GLOW_SIZE=t&&!isNaN(t)?t:this.SELECTED_GLOW_SIZE,this.REPLACEMENT_GLOW_COLOUR=e.getComponentStyle("replacementGlowColour")||this.REPLACEMENT_GLOW_COLOUR,this.REPLACEMENT_GLOW_SIZE=(e=Number(e.getComponentStyle("replacementGlowSize")))&&!isNaN(e)?e:this.REPLACEMENT_GLOW_SIZE}dispose(){super.dispose(),this.selectedGlowFilter&&J(this.selectedGlowFilter),this.replacementGlowFilter&&J(this.replacementGlowFilter)}makeStartHat(){const e=this.START_HAT_HEIGHT,t=this.START_HAT_WIDTH;return{height:.75*e,width:t,path:Pe("c",[D(25,-e),D(71,-e),D(t,0)])}}makeHexagonal(){function e(i,s,n){var r=i/2;return gt(-(n=n?-1:1)*(r=r>t?t:r),i=(s?-1:1)*i/2)+gt(n*r,i)}const t=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;return{type:this.SHAPES.HEXAGONAL,isDynamic:!0,width:i=>(i/=2)>t?t:i,height:i=>i,connectionOffsetY:i=>i/2,connectionOffsetX:i=>-i,pathDown:i=>e(i,!1,!1),pathUp:i=>e(i,!0,!1),pathRightDown:i=>e(i,!1,!0),pathRightUp:i=>e(i,!1,!0)}}makeRounded(){function e(s,n,r){const a=s>i?s-i:0,$=r===n?"0":"1";return he("a","0 0,"+$,s=(s>i?i:s)/2,D((r?1:-1)*s,(n?-1:1)*s))+M("v",(n?-1:1)*a)+he("a","0 0,"+$,s,D((r?-1:1)*s,(n?-1:1)*s))}const t=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,i=2*t;return{type:this.SHAPES.ROUND,isDynamic:!0,width:s=>(s/=2)>t?t:s,height:s=>s,connectionOffsetY:s=>s/2,connectionOffsetX:s=>-s,pathDown:s=>e(s,!1,!1),pathUp:s=>e(s,!0,!1),pathRightDown:s=>e(s,!1,!0),pathRightUp:s=>e(s,!1,!0)}}makeSquared(){function e(i,s,n){i-=2*t;const r=n===s?"0":"1";return he("a","0 0,"+r,t,D((n?1:-1)*t,(s?-1:1)*t))+M("v",(s?-1:1)*i)+he("a","0 0,"+r,t,D((n?-1:1)*t,(s?-1:1)*t))}const t=this.CORNER_RADIUS;return{type:this.SHAPES.SQUARE,isDynamic:!0,width:i=>t,height:i=>i,connectionOffsetY:i=>i/2,connectionOffsetX:i=>-i,pathDown:i=>e(i,!1,!1),pathUp:i=>e(i,!0,!1),pathRightDown:i=>e(i,!1,!0),pathRightUp:i=>e(i,!1,!0)}}shapeFor(e){let t=e.getCheck();switch(!t&&e.targetConnection&&(t=e.targetConnection.getCheck()),e.type){case N.INPUT_VALUE:case N.OUTPUT_VALUE:if(null!==(e=e.getSourceBlock().getOutputShape()))switch(e){case this.SHAPES.HEXAGONAL:return this.HEXAGONAL;case this.SHAPES.ROUND:return this.ROUNDED;case this.SHAPES.SQUARE:return this.SQUARED}return t&&t.includes("Boolean")?this.HEXAGONAL:(t&&t.includes("Number")||t&&t.includes("String"),this.ROUNDED);case N.PREVIOUS_STATEMENT:case N.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown type")}}makeNotch(){function e(F){return Pe("c",[D(F*n/2,0),D(F*n*3/4,a/2),D(F*n,a)])+lt([D(F*n,r)])+Pe("c",[D(F*n/4,a/2),D(F*n/2,a),D(F*n,a)])+M("h",F*s)+Pe("c",[D(F*n/2,0),D(F*n*3/4,-a/2),D(F*n,-a)])+lt([D(F*n,-r)])+Pe("c",[D(F*n/4,-a/2),D(F*n/2,-a),D(F*n,-a)])}const t=this.NOTCH_WIDTH,i=this.NOTCH_HEIGHT,s=t/3,n=s/3,r=i/2,a=r/2,$=e(1),C=e(-1);return{type:this.SHAPES.NOTCH,width:t,height:i,pathLeft:$,pathRight:C}}makeInsideCorners(){const e=this.CORNER_RADIUS,t=he("a","0 0,0",e,D(-e,e)),i=he("a","0 0,1",e,D(-e,e));return{width:e,height:e,pathTop:t,pathBottom:he("a","0 0,0",e,D(e,e)),rightWidth:e,rightHeight:e,pathTopRight:i,pathBottomRight:he("a","0 0,1",e,D(e,e))}}generateSecondaryColour_(e){return Mo("#000",e,.15)||e}generateTertiaryColour_(e){return Mo("#000",e,.25)||e}createDom(e,t,i,s){super.createDom(e,t,i,s),e=I(f.DEFS,{},e),t=I(f.FILTER,{id:"blocklySelectedGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e),I(f.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.SELECTED_GLOW_SIZE},t),i=I(f.FECOMPONENTTRANSFER,{result:"outBlur"},t),I(f.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},i),I(f.FEFLOOD,{"flood-color":this.SELECTED_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},t),I(f.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},t),this.selectedGlowFilterId=t.id,this.selectedGlowFilter=t,e=I(f.FILTER,{id:"blocklyReplacementGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e),I(f.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.REPLACEMENT_GLOW_SIZE},e),t=I(f.FECOMPONENTTRANSFER,{result:"outBlur"},e),I(f.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},t),I(f.FEFLOOD,{"flood-color":this.REPLACEMENT_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},e),I(f.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},e),I(f.FECOMPOSITE,{in:"SourceGraphic",in2:"outGlow",operator:"over"},e),this.replacementGlowFilterId=e.id,this.replacementGlowFilter=e,s&&(s.style.setProperty("--blocklySelectedGlowFilter",`url(#${this.selectedGlowFilterId})`),s.style.setProperty("--blocklyReplacementGlowFilter",`url(#${this.replacementGlowFilterId})`))}getCSS_(e){return[`${e} .blocklyText,`,`${e} .blocklyFlyoutLabelText {`,`font: ${this.FIELD_TEXT_FONTWEIGHT} ${this.FIELD_TEXT_FONTSIZE}pt ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${e} .blocklyTextInputBubble textarea {`,"font-weight: normal;","}",`${e} .blocklyText {`,"fill: #fff;","}",`${e} .blocklyNonEditableField>rect:not(.blocklyDropdownRect),`,`${e} .blocklyEditableField>rect:not(.blocklyDropdownRect) {`,`fill: ${this.FIELD_BORDER_RECT_COLOUR};`,"}",`${e} .blocklyNonEditableField>text,`,`${e} .blocklyEditableField>text,`,`${e} .blocklyNonEditableField>g>text,`,`${e} .blocklyEditableField>g>text {`,"fill: #575E75;","}",`${e} .blocklyFlyoutLabelText {`,"fill: #575E75;","}",`${e} .blocklyText.blocklyBubbleText {`,"fill: #575E75;","}",`${e} .blocklyDraggable:not(.blocklyDisabled)`," .blocklyEditableField:not(.blocklyEditing):hover>rect,",`${e} .blocklyDraggable:not(.blocklyDisabled)`," .blocklyEditableField:not(.blocklyEditing):hover>.blocklyPath {","stroke: #fff;","stroke-width: 2;","}",`${e} .blocklyHtmlInput {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,`font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,"color: #575E75;","}",`${e} .blocklyDropdownText {`,"fill: #fff !important;","}",`${e}.blocklyWidgetDiv .blocklyMenuItem,`,`${e}.blocklyDropDownDiv .blocklyMenuItem {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${e}.blocklyDropDownDiv .blocklyMenuItemContent {`,"color: #fff;","}",`${e} .blocklyHighlightedConnectionPath {`,`stroke: ${this.SELECTED_GLOW_COLOUR};`,"}",`${e} .blocklyDisabledPattern > .blocklyOutlinePath {`,"fill: var(--blocklyDisabledPattern)","}",`${e} .blocklyInsertionMarker>.blocklyPath {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}",`${e} .blocklySelected>.blocklyPath.blocklyPathSelected {`,"fill: none;","filter: var(--blocklySelectedGlowFilter);","}",`${e} .blocklyReplaceable>.blocklyPath {`,"filter: var(--blocklyReplacementGlowFilter);","}"]}},lg=class extends ac{constructor(e,t){super(e,t)}draw(){const e=this.block_.pathObject;e.beginDrawing(),this.drawOutline_(),this.drawInternals_(),this.updateConnectionHighlights(),e.setPath(this.outlinePath_+"\n"+this.inlinePath_),this.info_.RTL&&e.flipRTL(),this.recordSizeOnBlock_(),this.info_.outputConnection&&(e.outputShapeType=this.info_.outputConnection.shape.type),e.endDrawing()}drawOutline_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape&&!this.info_.hasStatementInput&&!this.info_.bottomRow.hasNextConnection?(this.drawFlatTop_(),this.drawRightDynamicConnection_(),this.drawFlatBottom_(),this.drawLeftDynamicConnection_()):super.drawOutline_()}drawLeft_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape?this.drawLeftDynamicConnection_():super.drawLeft_()}drawRightSideRow_(e){if(!(e.height<=0)){if(m.isSpacer(e)){const s=e.precedesStatement;var t=e.followsStatement;if(s||t){const n=this.constants_.INSIDE_CORNERS;var i=n.rightHeight;return t=t?n.pathBottomRight:"",e=(i=e.height-(s?i:0))>0?M("V",e.yPos+i):"",void(this.outlinePath_+=t+e+(s?n.pathTopRight:""))}}this.outlinePath_+=M("V",e.yPos+e.height)}}drawRightDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.outlinePath_+=this.info_.outputConnection.shape.pathRightDown(this.info_.outputConnection.height)}drawLeftDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.positionOutputConnection_(),this.outlinePath_+=this.info_.outputConnection.shape.pathUp(this.info_.outputConnection.height),this.outlinePath_+="z"}drawFlatTop_(){const e=this.info_.topRow;this.positionPreviousConnection_(),this.outlinePath_+=ae(e.xPos,this.info_.startY),this.outlinePath_+=M("h",e.width)}drawFlatBottom_(){const e=this.info_.bottomRow;this.positionNextConnection_(),this.outlinePath_+=M("V",e.baseline),this.outlinePath_+=M("h",-e.width)}drawInlineInput_(e){this.positionInlineInputConnection_(e);const t=e.input.name;e.connectedBlock||this.info_.isInsertionMarker||(e=Se(e.xPos+e.connectionWidth,e.centerline-e.height/2)+this.getInlineInputPath(e),this.block_.pathObject.setOutlinePath(t,e))}getInlineInputPath(e){const t=e.width-2*e.connectionWidth,i=e.height;return M("h",t)+e.shape.pathRightDown(i)+M("h",-t)+e.shape.pathUp(i)+"z"}drawStatementInput_(e){var t=e.getLastInput();const i=t.xPos+t.notchOffset+t.shape.width,s=this.constants_.INSIDE_CORNERS,n=t.shape.pathRight+M("h",-(t.notchOffset-s.width))+s.pathTop,r=e.height-2*s.height;t=s.pathBottom+M("h",t.notchOffset-s.width)+(t.connectedBottomNextConnection?"":t.shape.pathLeft),this.outlinePath_+=M("H",i)+n+M("v",r)+t+M("H",e.xPos+e.width),this.positionStatementInputConnection_(e)}drawConnectionHighlightPath(e){const t=e.connectionModel;if(t.type===N.NEXT_STATEMENT||t.type===N.PREVIOUS_STATEMENT||t.type===N.OUTPUT_VALUE&&!e.isDynamicShape)return super.drawConnectionHighlightPath(e);e=t.type===N.INPUT_VALUE?Se(e.connectionWidth,-e.height/2)+this.getInlineInputPath(e):Se(e.width,-e.height/2)+e.shape.pathDown(e.height);const i=t.getSourceBlock();let s,n;return null==(n=(s=i.pathObject).addConnectionHighlight)?void 0:n.call(s,t,e,t.getOffsetInBlock(),i.RTL)}},Hi=class extends Q{constructor(e,t,i,s,n,r,a){if(super(Q.SKIP_SETUP),this.imageElement=this.clickHandler=null,this.flipRtl=this.isDirty_=this.EDITABLE=!1,this.altText="",i=Number(l(i)),t=Number(l(t)),isNaN(i)||isNaN(t))throw Error("Height and width values of an image field must cast to numbers.");if(i<=0||t<=0)throw Error("Height and width values of an image field must be greater than 0.");this.size_=new j(t,i+Hi.Y_PADDING),this.imageHeight=i,"function"==typeof n&&(this.clickHandler=n),e!==Q.SKIP_SETUP&&(a?this.configure_(a):(this.flipRtl=!!r,this.altText=l(s)||""),this.setValue(l(e)))}configure_(e){super.configure_(e),e.flipRtl&&(this.flipRtl=e.flipRtl),e.alt&&(this.altText=l(e.alt))}initView(){this.imageElement=I(f.IMAGE,{height:this.imageHeight+"px",width:this.size_.width+"px",alt:this.altText},this.fieldGroup_),this.imageElement.setAttributeNS($t,"xlink:href",this.value_),this.fieldGroup_&&A(this.fieldGroup_,"blocklyImageField"),this.clickHandler&&(this.imageElement.style.cursor="pointer")}updateSize_(){}doClassValidation_(e){return"string"!=typeof e?null:e}doValueUpdate_(e){this.value_=e,this.imageElement&&this.imageElement.setAttributeNS($t,"xlink:href",this.value_)}getFlipRtl(){return this.flipRtl}setAlt(e){e!==this.altText&&(this.altText=e||"",this.imageElement&&this.imageElement.setAttribute("alt",this.altText))}isClickable(){return super.isClickable()&&!!this.clickHandler}showEditor_(){this.clickHandler&&this.clickHandler(this)}setOnClickHandler(e){this.clickHandler=e}getText_(){return this.altText}static fromJson(e){if(!e.src||!e.width||!e.height)throw Error("src, width, and height values for an image field arerequired. The width and height must be non-zero.");return new this(e.src,e.width,e.height,void 0,void 0,void 0,e)}};Hi.Y_PADDING=1,pt("field_image",Hi),Hi.prototype.DEFAULT_VALUE="";var Ps=class extends Q{set size_(e){super.size_=e}get size_(){const e=super.size_;return e.width<14&&(e.width=14),e}constructor(e,t,i){super(Q.SKIP_SETUP),this.spellcheck_=!0,this.htmlInput_=null,this.isTextValid_=this.isBeingEdited_=!1,this.onInputWrapper=this.onKeyDownWrapper=this.valueWhenEditorWasOpened_=null,this.fullBlockClickTarget_=!1,this.workspace_=null,this.SERIALIZABLE=!0,e!==Q.SKIP_SETUP&&(i&&this.configure_(i),this.setValue(e),t&&this.setValidator(t))}configure_(e){super.configure_(e),void 0!==e.spellcheck&&(this.spellcheck_=e.spellcheck)}initView(){if(!this.getSourceBlock())throw new fe;super.initView(),this.isFullBlockField()&&(this.clickTarget_=this.sourceBlock_.getSvgRoot()),this.fieldGroup_&&A(this.fieldGroup_,"blocklyInputField")}isFullBlockField(){const e=this.getSourceBlock();if(!e)throw new fe;let t;return this.fullBlockClickTarget_=!(null==(t=this.getConstants())||!t.FULL_BLOCK_FIELDS)&&e.isSimpleReporter()}doValueInvalid_(e,t=!0){this.isBeingEdited_&&(this.isDirty_=!0,this.isTextValid_=!1,e=this.value_,this.value_=this.valueWhenEditorWasOpened_,this.sourceBlock_&&se()&&this.value_!==e&&t&&B(new(P(b.BLOCK_CHANGE))(this.sourceBlock_,"field",this.name||null,e,this.value_)))}doValueUpdate_(e){this.isTextValid_=this.isDirty_=!0,this.value_=e}applyColour(){const e=this.getSourceBlock();if(!e)throw new fe;this.getConstants().FULL_BLOCK_FIELDS&&this.fieldGroup_&&(!this.isFullBlockField()&&this.borderRect_?(this.borderRect_.style.display="block",this.borderRect_.setAttribute("stroke",e.getColourTertiary())):(this.borderRect_.style.display="none",e.pathObject.svgPath.setAttribute("fill",this.getConstants().FIELD_BORDER_RECT_COLOUR)))}getSize(){let e;return null!=(e=this.getConstants())&&e.FULL_BLOCK_FIELDS&&(this.render_(),this.isDirty_=!1),super.getSize()}onLocationChange(){this.isBeingEdited_&&this.resizeEditor_()}render_(){if(super.render_(),this.isBeingEdited_){var e=this.htmlInput_;this.isTextValid_?(X(e,"blocklyInvalidInput"),Ee(e,ye.INVALID,!1)):(A(e,"blocklyInvalidInput"),Ee(e,ye.INVALID,!0))}if(!(e=this.getSourceBlock()))throw new fe;this.getConstants().FULL_BLOCK_FIELDS&&e.applyColour()}setSpellcheck(e){e!==this.spellcheck_&&(this.spellcheck_=e,this.htmlInput_&&this.htmlInput_.setAttribute("spellcheck",this.spellcheck_))}showEditor_(e,t=!1,i=!0){this.workspace_=this.sourceBlock_.workspace,!t&&this.workspace_.options.modalInputs&&(m$||Nh||ka)?this.showPromptEditor():this.showInlineEditor(t,i)}showPromptEditor(){_r(o.Msg$$module$build$src$core$msg.CHANGE_VALUE_TITLE,this.getText(),e=>{null!==e&&this.setValue(this.getValueFromEditorText_(e)),this.onFinishEditing_(this.value_)})}showInlineEditor(e,t){const i=this.getSourceBlock();if(!i)throw new fe;ce(this,i.RTL,this.widgetDispose_.bind(this),this.workspace_,t),this.htmlInput_=this.widgetCreate_(),this.isBeingEdited_=!0,this.valueWhenEditorWasOpened_=this.value_,e||(this.htmlInput_.focus({preventScroll:!0}),this.htmlInput_.select())}widgetCreate_(){var e=this.getSourceBlock();if(!e)throw new fe;o.setGroup$$module$build$src$core$events$utils(!0);const t=v();var i=this.getClickTarget_();if(!i)throw Error("A click target has not been set.");A(i,"blocklyEditing"),(i=document.createElement("input")).className="blocklyHtmlInput",i.setAttribute("spellcheck",this.spellcheck_);const s=this.workspace_.getAbsoluteScale();var n=this.getConstants().FIELD_TEXT_FONTSIZE*s+"pt";return t.style.fontSize=n,i.style.fontSize=n,n=Ps.BORDERRADIUS*s+"px",this.isFullBlockField()&&(n=((n=this.getScaledBBox()).bottom-n.top)/2+"px",e=e.getParent()?e.getParent().getColourTertiary():this.sourceBlock_.getColourTertiary(),i.style.border=1*s+"px solid "+e,t.style.borderRadius=n,t.style.transition="box-shadow 0.25s ease 0s",this.getConstants().FIELD_TEXTINPUT_BOX_SHADOW&&(t.style.boxShadow="rgba(255, 255, 255, 0.3) 0 0 0 "+4*s+"px")),i.style.borderRadius=n,t.appendChild(i),i.value=i.defaultValue=this.getEditorText_(this.value_),i.setAttribute("data-untyped-default-value",String(this.value_)),this.resizeEditor_(),this.bindInputEvents_(i),i}widgetDispose_(){this.isBeingEdited_=!1,this.isTextValid_=!0,this.forceRerender(),this.onFinishEditing_(this.value_),this.sourceBlock_&&se()&&null!==this.valueWhenEditorWasOpened_&&this.valueWhenEditorWasOpened_!==this.value_&&(B(new(P(b.BLOCK_CHANGE))(this.sourceBlock_,"field",this.name||null,this.valueWhenEditorWasOpened_,this.value_)),this.valueWhenEditorWasOpened_=null),o.setGroup$$module$build$src$core$events$utils(!1),this.unbindInputEvents_();var e=v().style;if(e.width="auto",e.height="auto",e.fontSize="",e.transition="",e.boxShadow="",this.htmlInput_=null,!(e=this.getClickTarget_()))throw Error("A click target has not been set.");X(e,"blocklyEditing")}onFinishEditing_(e){}bindInputEvents_(e){this.onKeyDownWrapper=L(e,"keydown",this,this.onHtmlInputKeyDown_),this.onInputWrapper=L(e,"input",this,this.onHtmlInputChange)}unbindInputEvents_(){this.onKeyDownWrapper&&(K(this.onKeyDownWrapper),this.onKeyDownWrapper=null),this.onInputWrapper&&(K(this.onInputWrapper),this.onInputWrapper=null)}onHtmlInputKeyDown_(e){if("Enter"===e.key)je(this),yt();else if("Escape"===e.key)this.setValue(this.htmlInput_.getAttribute("data-untyped-default-value"),!1),je(this),yt();else if("Tab"===e.key){e.preventDefault();var t,i=null==(t=this.workspace_)?void 0:t.getCursor();t=s=>(s instanceof Ps||s instanceof ie&&s.isSimpleReporter())&&s!==this.getSourceBlock(),(e=(e=e.shiftKey?i?.getPreviousNode(this,t,!1):i?.getNextNode(this,t,!1))instanceof ie&&e.isSimpleReporter()?e.getFields().next().value:e)instanceof Ps&&(je(this),yt(),i=e.getSourceBlock(),e.isFullBlockField()&&i&&i instanceof ie?o.getFocusManager$$module$build$src$core$focus_manager().focusNode(i):o.getFocusManager$$module$build$src$core$focus_manager().focusNode(e),e.showEditor())}}onHtmlInputChange(e){e=this.value_,this.setValue(this.getValueFromEditorText_(this.htmlInput_.value),!1),this.sourceBlock_&&se()&&this.value_!==e&&B(new(P(b.BLOCK_FIELD_INTERMEDIATE_CHANGE))(this.sourceBlock_,this.name||null,e,this.value_))}setEditorValue_(e,t=!0){this.isDirty_=!0,this.isBeingEdited_&&(this.htmlInput_.value=this.getEditorText_(e)),this.setValue(e,t)}resizeEditor_(){Ht().then(()=>{const e=this.getSourceBlock();if(!e)throw new fe;const t=v(),i=this.getScaledBBox();t.style.width=i.right-i.left+"px",t.style.height=i.bottom-i.top+"px";const s=i.top;t.style.left=`${e.RTL?i.right-t.offsetWidth:i.left}px`,t.style.top=`${s}px`})}repositionForWindowResize(){let e;const t=null==(e=this.getSourceBlock())?void 0:e.getRootBlock();return t instanceof ie&&(Uo(this.workspace_,this.workspace_.getMetricsManager().getViewMetrics(!0),t)||this.resizeEditor_(),!0)}getText_(){return this.isBeingEdited_&&this.htmlInput_?this.htmlInput_.value:null}getEditorText_(e){return`${e}`}getValueFromEditorText_(e){return e}};Ps.BORDERRADIUS=4,o.FieldTextInput$$module$build$src$core$field_textinput=class extends Ps{constructor(e,t,i){super(e,t,i)}initView(){super.initView(),this.fieldGroup_&&A(this.fieldGroup_,"blocklyTextInputField")}doClassValidation_(e){return void 0===e?null:`${e}`}static fromJson(e){return new this(l(e.text),void 0,e)}},pt("field_input",o.FieldTextInput$$module$build$src$core$field_textinput),o.FieldTextInput$$module$build$src$core$field_textinput.prototype.DEFAULT_VALUE="";var cg=class extends gu{constructor(e){super(e)}endsWithElemSpacer(){return!1}hasLeftSquareCorner(e){return!!e.outputConnection}hasRightSquareCorner(e){return!!e.outputConnection&&!e.statementInputCount&&!e.nextConnection}},gc=class extends lc{constructor(e,t){if(super(e,t),this.connectedBottomNextConnection=!1,this.connectedBlock){for(e=this.connectedBlock;t=e.getNextBlock();)e=t;e.nextConnection||(this.height=this.connectedBlockHeight,this.connectedBottomNextConnection=!0)}}},ag=class extends Qt{constructor(e){super(e),this.width=this.height=0,this.type|=m.getType("RIGHT_CONNECTION")}},ug=class extends Tu{constructor(e){super(e)}endsWithElemSpacer(){return!1}hasLeftSquareCorner(e){return!!e.outputConnection||(e.hat?"cap"===e.hat:this.constants_.ADD_START_HATS)&&!e.outputConnection&&!e.previousConnection}hasRightSquareCorner(e){return!!e.outputConnection&&!e.statementInputCount&&!e.nextConnection}},dg=class extends Jn{constructor(e,t){super(e,t),this.isInline=!0,this.renderer_=e,this.constants_=this.renderer_.getConstants(),this.topRow=new ug(this.constants_),this.bottomRow=new cg(this.constants_),this.isMultiRow=!t.getInputsInline()||t.isCollapsed(),this.hasStatementInput=t.statementInputCount>0,this.rightSide=this.outputConnection?new ag(this.constants_):null,this.rightAlignedDummyInputs=new WeakMap}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.adjustXPosition_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}shouldStartNewRow_(e,t){return!!t&&(t instanceof $o||e instanceof ut||t instanceof ut||(e instanceof o.ValueInput$$module$build$src$core$inputs$value_input||e instanceof Kt||e instanceof $o)&&(!this.isInline||this.isMultiRow))}getDesiredRowWidth_(e){return e.hasStatement?this.width-this.startX-(this.constants_.INSIDE_CORNERS.rightWidth||0):super.getDesiredRowWidth_(e)}getInRowSpacing_(e,t){return e&&t||!this.outputConnection||!this.outputConnection.isDynamicShape||this.hasStatementInput||this.bottomRow.hasNextConnection?!e&&t&&m.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:e&&m.isLeftRoundedCorner(e)&&t&&(m.isPreviousConnection(t)||m.isNextConnection(t))?t.notchOffset-this.constants_.CORNER_RADIUS:e&&m.isLeftSquareCorner(e)&&t&&m.isHat(t)||e&&m.isField(e)&&0===e.width?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:this.constants_.NO_PADDING}getSpacerRowHeight_(e,t){if(m.isTopRow(e)&&m.isBottomRow(t))return this.constants_.EMPTY_BLOCK_SPACER_HEIGHT;const i=m.isInputRow(e)&&e.hasStatement,s=m.isInputRow(t)&&t.hasStatement;return s||i?(e=Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.INSIDE_CORNERS.rightHeight||0),s&&i?Math.max(e,this.constants_.DUMMY_INPUT_MIN_HEIGHT):e):m.isTopRow(e)?e.hasPreviousConnection||this.outputConnection&&!this.hasStatementInput?this.constants_.NO_PADDING:Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):m.isBottomRow(t)?this.outputConnection?!t.hasNextConnection&&this.hasStatementInput?Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):this.constants_.NO_PADDING:Math.max(this.topRow.minHeight,Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.CORNER_RADIUS))-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING}getSpacerRowWidth_(e,t){const i=this.width-this.startX;return m.isInputRow(e)&&e.hasStatement||m.isInputRow(t)&&t.hasStatement?Math.max(i,this.constants_.STATEMENT_INPUT_SPACER_MIN_WIDTH):i}getElemCenterline_(e,t){if(e.hasStatement&&!m.isSpacer(t)&&!m.isStatementInput(t))return e.yPos+this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT/2;if(m.isInlineInput(t)){const i=t.connectedBlock;if(i&&i.outputConnection&&i.nextConnection)return e.yPos+i.height/2}return super.getElemCenterline_(e,t)}addInput_(e,t){if((e instanceof Kt||e instanceof $o)&&t.hasDummyInput&&t.align===o.Align$$module$build$src$core$inputs$align.LEFT&&e.align===o.Align$$module$build$src$core$inputs$align.RIGHT)this.rightAlignedDummyInputs.set(t,e);else if(e instanceof ut)return t.elements.push(new gc(this.constants_,e)),t.hasStatement=!0,void(null===t.align&&(t.align=e.align));super.addInput_(e,t)}addAlignmentPadding_(e,t){if(this.rightAlignedDummyInputs.get(e)){let i;for(let s=0;s<e.elements.length;s++){const n=e.elements[s];if(m.isSpacer(n)&&(i=n),m.isField(n)&&n.parentInput===this.rightAlignedDummyInputs.get(e))break}if(i)return i.width+=t,void(e.width+=t)}super.addAlignmentPadding_(e,t)}adjustXPosition_(){const e=this.constants_.NOTCH_OFFSET_LEFT+this.constants_.NOTCH_WIDTH;let t=e;for(let n=2;n<this.rows.length-1;n+=2){var i=this.rows[n-1];const r=this.rows[n];var s=this.rows[n+1];if(i=2===n?!!this.topRow.hasPreviousConnection:!!i.followsStatement,s=n+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!s.precedesStatement,m.isInputRow(r)&&r.hasStatement){let a,$;r.measure(),t=r.width-(null!=($=null==(a=r.getLastInput())?void 0:a.width)?$:0)+e}else if(i&&(2===n||s)&&m.isInputRow(r)&&!r.hasStatement){s=r.xPos,i=null;for(let a=0;a<r.elements.length;a++){const $=r.elements[a];m.isSpacer($)&&(i=$),!(i&&(m.isField($)||m.isInput($))&&s<t)||m.isField($)&&($.field instanceof Di||$.field instanceof Hi)||(i.width+=t-s),s+=$.width}}}}finalizeOutputConnection_(){if(this.outputConnection&&this.outputConnection.isDynamicShape){var e=this.outputConnection.shape;if("isDynamic"in e&&e.isDynamic){for(var t=0,i=0;i<this.rows.length;i++){const s=this.rows[i];s.yPos=t,t+=s.height}this.height=t,t=e.height(i=this.bottomRow.hasNextConnection?this.height-this.bottomRow.descenderHeight:this.height),i=e.width(i),this.outputConnection.height=t,this.outputConnection.width=i,this.outputConnection.startX=i,this.outputConnection.connectionOffsetY=e.connectionOffsetY(t),this.outputConnection.connectionOffsetX=e.connectionOffsetX(i),e=0,this.hasStatementInput||this.bottomRow.hasNextConnection||(e=i,this.rightSide.height=t,this.rightSide.width=e,this.rightSide.centerline=t/2,this.rightSide.xPos=this.width+e),this.startX=i,this.width+=i+e,this.widthWithChildren+=i+e}}}finalizeHorizontalAlignment_(){if(this.outputConnection&&!this.hasStatementInput&&!this.bottomRow.hasNextConnection){for(var e=0,t=0;t<this.rows.length;t++){var i=this.rows[t];if(!m.isInputRow(i))continue;e=i.elements[i.elements.length-2];let s=this.getNegativeSpacing_(i.elements[1]),n=this.getNegativeSpacing_(e);const r=this.constants_.MIN_BLOCK_WIDTH+2*this.outputConnection.width;this.width-(e=s+n)<r&&(s=(e=this.width-r)/2,n=e/2),i.elements.unshift(new dt(this.constants_,-s)),i.elements.push(new dt(this.constants_,-n))}if(e)for(this.width-=e,this.widthWithChildren-=e,this.rightSide.xPos-=e,t=0;t<this.rows.length;t++)m.isTopOrBottomRow(i=this.rows[t])&&(i.elements[1].width-=e),i.width-=e,i.widthWithConnectedBlocks-=e}}getNegativeSpacing_(e){if(!e||!this.outputConnection)return 0;const t=this.outputConnection.width;var i=this.outputConnection.shape.type;const s=this.constants_;if(this.inputRows.length>1)return i===s.SHAPES.ROUND?t-(i=this.height/2>(i=this.constants_.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH)?i:this.height/2)*(1-Math.sin(Math.acos((i-this.constants_.SMALL_PADDING)/i))):0;if(m.isInlineInput(e)){const n=e.connectedBlock;return null==(e=n?n.pathObject.outputShapeType:e.shape.type)||n&&n.outputConnection&&(n.statementInputCount||n.nextConnection)||i===s.SHAPES.HEXAGONAL&&i!==e?0:t-this.constants_.SHAPE_IN_SHAPE_PADDING[i][e]}return m.isField(e)?i===s.SHAPES.ROUND&&e.field instanceof o.FieldTextInput$$module$build$src$core$field_textinput?t-2.75*s.GRID_UNIT:t-this.constants_.SHAPE_IN_SHAPE_PADDING[i][0]:m.isIcon(e)?this.constants_.SMALL_PADDING:0}finalizeVerticalAlignment_(){if(!this.outputConnection)for(let s=2;s<this.rows.length-1;s+=2){const n=this.rows[s-1],r=this.rows[s],a=this.rows[s+1];var e=2===s,t=s+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!a.precedesStatement;if(e?this.topRow.hasPreviousConnection:n.followsStatement){var i=r.elements[1];if(i=3===r.elements.length&&i instanceof mu&&(i.field instanceof Di||i.field instanceof Hi),!e&&i)n.height-=this.constants_.SMALL_PADDING,a.height-=this.constants_.SMALL_PADDING,r.height-=this.constants_.MEDIUM_PADDING;else if(e||t){if(t){for(e=!1,t=0;t<r.elements.length;t++)if(m.isInlineInput(i=r.elements[t])&&i.connectedBlock&&!i.connectedBlock.isShadow()&&i.connectedBlock.getHeightWidth().height>=40){e=!0;break}e&&(n.height-=this.constants_.SMALL_PADDING,a.height-=this.constants_.SMALL_PADDING)}}else n.height+=this.constants_.SMALL_PADDING}}}finalize_(){this.finalizeOutputConnection_(),this.finalizeHorizontalAlignment_(),this.finalizeVerticalAlignment_(),super.finalize_(),this.rightSide&&(this.widthWithChildren+=this.rightSide.width)}},hg=class extends uc{constructor(e,t,i){super(e,t,i),this.svgPathSelected=null,this.outlines=new Map,this.remainingOutlines=new Set,this.outputShapeType=null,this.constants=i}setPath(e){super.setPath(e),this.svgPathSelected&&this.svgPathSelected.setAttribute("d",e)}applyColour(e){super.applyColour(e);const t=e.getParent();e.isShadow()&&t&&this.svgPath.setAttribute("stroke",t.getColourTertiary());for(const i of this.outlines.values())i.setAttribute("fill",this.style.colourTertiary)}flipRTL(){super.flipRTL();for(const e of this.outlines.values())e.setAttribute("transform","scale(-1 1)")}updateSelected(e){this.setClass_("blocklySelected",e),e?this.svgPathSelected||(this.svgPathSelected=this.svgPath.cloneNode(!0),this.svgPathSelected.classList.add("blocklyPathSelected"),X(this.svgPathSelected,Ue.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME),X(this.svgPathSelected,Ue.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME),this.svgPathSelected.removeAttribute("tabindex"),this.svgPathSelected.removeAttribute("id"),this.svgRoot.appendChild(this.svgPathSelected)):this.svgPathSelected&&(this.svgRoot.removeChild(this.svgPathSelected),this.svgPathSelected=null)}updateReplacementFade(e){this.setClass_("blocklyReplaceable",e)}updateShapeForInputHighlight(e,t){e=e.getParentInput().name,(e=this.getOutlinePath(e))&&(t?e.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):e.removeAttribute("filter"))}beginDrawing(){this.remainingOutlines.clear();for(const e of this.outlines.keys())this.remainingOutlines.add(e)}endDrawing(){if(this.remainingOutlines.size)for(const e of this.remainingOutlines)this.removeOutlinePath(e);this.remainingOutlines.clear()}setOutlinePath(e,t){(e=this.getOutlinePath(e)).setAttribute("d",t),e.setAttribute("fill",this.style.colourTertiary)}getOutlinePath(e){return this.outlines.has(e)||this.outlines.set(e,I(f.PATH,{class:"blocklyOutlinePath",d:""},this.svgRoot)),this.remainingOutlines.delete(e),this.outlines.get(e)}removeOutlinePath(e){let t,i;null==(t=this.outlines.get(e))||null==(i=t.parentNode)||i.removeChild(this.outlines.get(e)),this.outlines.delete(e)}},Ru=class extends dc{constructor(e){super(e)}makeConstants_(){return new rg}makeRenderInfo_(e){return new dg(this,e)}makeDrawer_(e,t){return new lg(e,t)}makePathObject(e,t){return new hg(e,t,this.getConstants())}getConstants(){return this.constants_}};vl("zelos",Ru);var pg=class{constructor(e){this.staticConn=this.draggedConn=this.markerConn=this.fadedBlock=null,this.workspace=e.workspace}previewReplacement(e,t,i){o.disable$$module$build$src$core$events$utils();try{this.hidePreview(),this.fadedBlock=i,i.fadeForReplacement(!0),this.workspace.getRenderer().shouldHighlightConnection(t)&&(t.highlight(),this.staticConn=t)}finally{o.enable$$module$build$src$core$events$utils()}}previewConnection(e,t){if(e!==this.draggedConn||t!==this.staticConn){o.disable$$module$build$src$core$events$utils();try{this.hidePreview(),this.shouldUseMarkerPreview(e,t)&&(this.markerConn=this.previewMarker(e,t)),this.workspace.getRenderer().shouldHighlightConnection(t)&&t.highlight(),this.draggedConn=e,this.staticConn=t}finally{o.enable$$module$build$src$core$events$utils()}}}shouldUseMarkerPreview(e,t){return t.type===N.PREVIOUS_STATEMENT||t.type===N.NEXT_STATEMENT||!(this.workspace.getRenderer()instanceof Ru)}previewMarker(e,t){const i=e.getSourceBlock(),s=this.createInsertionMarker(i),n=this.getMatchingConnection(i,s,e);if(!n)return null;s.queueRender(),Ao(),n.connect(t);const r={x:t.x-n.x,y:t.y-n.y},a=n.getOffsetInBlock().clone();return Ht().then(()=>{if(!s.isDeadOrDying()){o.disable$$module$build$src$core$events$utils();try{s?.positionNearConnection(n,r,a),s?.getSvgRoot().setAttribute("visibility","visible")}finally{o.enable$$module$build$src$core$events$utils()}}}),n}createInsertionMarker(e){const t=rt(e,{addCoordinates:!1,addInputBlocks:!1,addNextBlocks:!1,doFullSerialization:!1});if(!t)throw Error(`Failed to serialize source block. ${e.toDevString()}`);e=Ro(t,this.workspace);for(const i of e.getDescendants(!1))i.setInsertionMarker(!0);return e.initSvg(),e.getSvgRoot().setAttribute("visibility","hidden"),e}getMatchingConnection(e,t,i){if(e=e.getConnections_(!0),t=t.getConnections_(!0),e.length!==t.length)return null;for(let s=0;s<e.length;s++)if(e[s]===i)return t[s];return null}hidePreview(){o.disable$$module$build$src$core$events$utils();try{this.staticConn&&(this.staticConn.unhighlight(),this.staticConn=null),this.fadedBlock&&(this.fadedBlock.fadeForReplacement(!1),this.fadedBlock=null),this.markerConn&&(this.hideInsertionMarker(this.markerConn),this.draggedConn=this.markerConn=null)}finally{o.enable$$module$build$src$core$events$utils()}}hideInsertionMarker(e){const t=e.getSourceBlock(),i=t.outputConnection;let s;if(null!=(s=t.previousConnection)&&s.targetConnection||null!=i&&i.targetConnection)t.unplug(!0);else{let n;null==(n=e.targetBlock())||n.unplug(!1)}t.dispose()}dispose(){this.hidePreview()}};U(k.CONNECTION_PREVIEWER,ct,pg);var Vi={};Vi.Align=o.Align$$module$build$src$core$inputs$align,Vi.DummyInput=Kt,Vi.EndRowInput=$o,Vi.Input=Os,Vi.StatementInput=ut,Vi.ValueInput=o.ValueInput$$module$build$src$core$inputs$value_input,Vi.inputTypes=o.inputTypes$$module$build$src$core$inputs$input_types;var Vm=!1;o.CodeGenerator$$module$build$src$core$generator=class{constructor(e){this.forBlock=Object.create(null),this.FUNCTION_NAME_PLACEHOLDER_="{leCUI8hutHZI4480Dc}",this.STATEMENT_SUFFIX=this.STATEMENT_PREFIX=this.INFINITE_LOOP_TRAP=null,this.INDENT="  ",this.COMMENT_WRAP=60,this.ORDER_OVERRIDES=[],this.isInitialized=null,this.RESERVED_WORDS_="",this.definitions_=Object.create(null),this.functionNames_=Object.create(null),this.nameDB_=void 0,this.name_=e,this.FUNCTION_NAME_PLACEHOLDER_REGEXP_=new RegExp(this.FUNCTION_NAME_PLACEHOLDER_,"g")}workspaceToCode(e){e||(console.warn("No workspace specified in workspaceToCode call.  Guessing."),e=st());var t=[];this.init(e),e=e.getTopBlocks(!0);for(let s,i=0;s=e[i];i++){let n=this.blockToCode(s);Array.isArray(n)&&(n=n[0]),n&&(s.outputConnection&&(n=this.scrubNakedValue(n),this.STATEMENT_PREFIX&&!s.suppressPrefixSuffix&&(n=this.injectId(this.STATEMENT_PREFIX,s)+n),this.STATEMENT_SUFFIX&&!s.suppressPrefixSuffix&&(n+=this.injectId(this.STATEMENT_SUFFIX,s))),t.push(n))}return t=t.join("\n"),(t=(t=(t=this.finish(t)).replace(/^\s+\n/,"")).replace(/\n\s+$/,"\n")).replace(/[ \t]+\n/g,"\n")}prefixLines(e,t){return t+e.replace(/(?!\n$)\n/g,"\n"+t)}allNestedComments(e){const t=[];e=e.getDescendants(!0);for(let i=0;i<e.length;i++){const s=e[i].getCommentText();s&&t.push(s)}return t.length&&t.push(""),t.join("\n")}blockToCode(e,t){if(!1===this.isInitialized&&console.warn("CodeGenerator init was not called before blockToCode was called."),!e)return"";if(!e.isEnabled())return t?"":this.blockToCode(e.getNextBlock());if(e.isInsertionMarker())return t?"":this.blockToCode(e.getChildren(!1)[0]);var i=this.forBlock[e.type];if("function"!=typeof i)throw Error(`${this.name_} generator does not know how to generate code for block type "${e.type}".`);if(i=i.call(e,e,this),Array.isArray(i)){if(!e.outputConnection)throw TypeError("Expecting string from statement block: "+e.type);return[this.scrub_(e,i[0],t),i[1]]}if("string"==typeof i)return this.STATEMENT_PREFIX&&!e.suppressPrefixSuffix&&(i=this.injectId(this.STATEMENT_PREFIX,e)+i),this.STATEMENT_SUFFIX&&!e.suppressPrefixSuffix&&(i+=this.injectId(this.STATEMENT_SUFFIX,e)),this.scrub_(e,i,t);if(null===i)return"";throw SyntaxError("Invalid code generated: "+i)}valueToCode(e,t,i){if(isNaN(i))throw TypeError("Expecting valid order from block: "+e.type);var s=e.getInputTargetBlock(t);if(!s&&!e.getInput(t))throw ReferenceError(`Input "${t}" doesn't exist on "${e.type}"`);if(!s||""===(t=this.blockToCode(s)))return"";if(!Array.isArray(t))throw TypeError(`Expecting tuple from value block: ${s.type} See developers.google.com/blockly/guides/create-custom-blocks/generating-code for more information`);if(e=t[0],t=t[1],isNaN(t))throw TypeError("Expecting valid order from value block: "+s.type);if(!e)return"";s=!1;var n=Math.floor(i);const r=Math.floor(t);if(n<=r&&(n!==r||0!==n&&99!==n))for(s=!0,n=0;n<this.ORDER_OVERRIDES.length;n++)if(this.ORDER_OVERRIDES[n][0]===i&&this.ORDER_OVERRIDES[n][1]===t){s=!1;break}return s&&(e="("+e+")"),e}statementToCode(e,t){const i=e.getInputTargetBlock(t);if(!i&&!e.getInput(t))throw ReferenceError(`Input "${t}" doesn't exist on "${e.type}"`);if("string"!=typeof(e=this.blockToCode(i)))throw TypeError("Expecting code from statement block: "+(i&&i.type));return e&&(e=this.prefixLines(e,this.INDENT)),e}addLoopTrap(e,t){return this.INFINITE_LOOP_TRAP&&(e=this.prefixLines(this.injectId(this.INFINITE_LOOP_TRAP,t),this.INDENT)+e),this.STATEMENT_SUFFIX&&!t.suppressPrefixSuffix&&(e=this.prefixLines(this.injectId(this.STATEMENT_SUFFIX,t),this.INDENT)+e),this.STATEMENT_PREFIX&&!t.suppressPrefixSuffix&&(e+=this.prefixLines(this.injectId(this.STATEMENT_PREFIX,t),this.INDENT)),e}injectId(e,t){return t=t.id.replace(/\$/g,"$$$$"),e.replace(/%1/g,"'"+t+"'")}addReservedWords(e){this.RESERVED_WORDS_+=e+","}provideFunction_(e,t){if(!this.definitions_[e]){const i=this.nameDB_.getDistinctName(e,o.NameType$$module$build$src$core$names.PROCEDURE);let s;for(this.functionNames_[e]=i,Array.isArray(t)&&(t=t.join("\n")),t=t.trim().replace(this.FUNCTION_NAME_PLACEHOLDER_REGEXP_,i);s!==t;)s=t,t=t.replace(/^(( {2})*) {2}/gm,"$1\0");t=t.replace(/\0/g,this.INDENT),this.definitions_[e]=t}return this.functionNames_[e]}getVariableName(e){return this.getName(e,o.NameType$$module$build$src$core$names.VARIABLE)}getProcedureName(e){return this.getName(e,o.NameType$$module$build$src$core$names.PROCEDURE)}getName(e,t){if(!this.nameDB_)throw Error("Name database is not defined. You must initialize `nameDB_` in your generator class and call `init` first.");return this.nameDB_.getName(e,t)}init(e){this.definitions_=Object.create(null),this.functionNames_=Object.create(null)}scrub_(e,t,i){return t}finish(e){return this.definitions_=Object.create(null),this.functionNames_=Object.create(null),e}scrubNakedValue(e){return e}};var Ou=class extends oc{constructor(e){super(e)}setMetrics_(e){if(this.isVisible()){var t=this.workspace_.getMetricsManager(),i=t.getScrollMetrics(),s=t.getViewMetrics();t=t.getAbsoluteMetrics(),"number"==typeof e.y&&(this.workspace_.scrollY=-(i.top+(i.height-s.height)*e.y)),this.workspace_.translate(this.workspace_.scrollX+t.left,this.workspace_.scrollY+t.top)}}getX(){if(!this.isVisible())return 0;var e=this.targetWorkspace.getMetricsManager();const t=e.getAbsoluteMetrics(),i=e.getViewMetrics();return e=e.getToolboxMetrics(),this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?this.toolboxPosition_===G.LEFT?e.width:i.width-this.getWidth():this.toolboxPosition_===G.LEFT?0:i.width:this.toolboxPosition_===G.LEFT?0:i.width+t.left-this.getWidth()}getY(){return 0}position(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var e=this.targetWorkspace.getMetricsManager().getViewMetrics();this.height_=e.height;var t=this.getWidth()-this.CORNER_RADIUS;this.setBackgroundPath(t,e.height-2*this.CORNER_RADIUS),e=this.getX(),t=this.getY(),this.positionAt_(this.getWidth(),this.getHeight(),e,t)}}setBackgroundPath(e,t){const i=this.toolboxPosition_===G.RIGHT;var s=e+this.CORNER_RADIUS;(s=["M "+(i?s:0)+",0"]).push("h",i?-e:e),s.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,i?0:1,i?-this.CORNER_RADIUS:this.CORNER_RADIUS,this.CORNER_RADIUS),s.push("v",Math.max(0,t)),s.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,i?0:1,i?this.CORNER_RADIUS:-this.CORNER_RADIUS,this.CORNER_RADIUS),s.push("h",i?e:-e),s.push("z"),this.svgBackground_.setAttribute("d",s.join(" "))}scrollToStart(){let e;null==(e=this.workspace_.scrollbar)||e.setY(0)}wheel_(e){var t=vo(e);if(t.y){const i=this.workspace_.getMetricsManager(),s=i.getScrollMetrics();let n;t=i.getViewMetrics().top-s.top+t.y,null==(n=this.workspace_.scrollbar)||n.setY(t),Gt(this.workspace_),yt()}e.preventDefault(),e.stopPropagation()}layout_(e){this.workspace_.scale=this.targetWorkspace.scale;var t=this.MARGIN;const i=this.RTL?t:t+this.tabWidth_;for(const s of e)s.getElement().moveBy(i,t),t+=s.getElement().getBoundingRectangle().getHeight()}isDragTowardWorkspace(e){e=Math.atan2(e.y,e.x)/Math.PI*180;const t=this.dragAngleRange_;return e<t&&e>-t||e<-180+t||e>180-t}getClientRect(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;const e=this.svgGroup_.getBoundingClientRect(),t=e.left;return this.toolboxPosition_===G.LEFT?new z(-1e9,1e9,-1e9,t+e.width):new z(-1e9,1e9,t,1e9)}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();let e=this.getContents().reduce((t,i)=>Math.max(t,i.getElement().getBoundingRectangle().getWidth()),0);if(e+=1.5*this.MARGIN+this.tabWidth_,e*=this.workspace_.scale,e+=_e.scrollbarThickness,this.getWidth()!==e){if(this.RTL)for(const t of this.getContents()){const i=t.getElement().getBoundingRectangle().left,s=e/this.workspace_.scale-t.getElement().getBoundingRectangle().getWidth()-this.MARGIN-this.tabWidth_;t.getElement().moveBy(s-i,0)}this.targetWorkspace.scrollbar||this.autoClose||this.targetWorkspace.getFlyout()!==this||this.toolboxPosition_!==G.LEFT||this.targetWorkspace.translate(this.targetWorkspace.scrollX+e,this.targetWorkspace.scrollY),this.width_=e,this.position(),this.targetWorkspace.resizeContents(),this.targetWorkspace.recordDragTargets()}}};Ou.registryName="verticalFlyout",U(k.FLYOUTS_VERTICAL_TOOLBOX,ct,Ou);var gg=class extends oc{constructor(e){super(e),this.horizontalLayout=!0}setMetrics_(e){if(this.isVisible()){var t=this.workspace_.getMetricsManager(),i=t.getScrollMetrics(),s=t.getViewMetrics();t=t.getAbsoluteMetrics(),"number"==typeof e.x&&(this.workspace_.scrollX=-(i.left+(i.width-s.width)*e.x)),this.workspace_.translate(this.workspace_.scrollX+t.left,this.workspace_.scrollY+t.top)}}getX(){return 0}getY(){if(!this.isVisible())return 0;var e=this.targetWorkspace.getMetricsManager();const t=e.getAbsoluteMetrics(),i=e.getViewMetrics();e=e.getToolboxMetrics();const s=this.toolboxPosition_===G.TOP;return this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?s?e.height:i.height-this.getHeight():s?0:i.height:s?0:i.height+t.top-this.getHeight()}position(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var e=this.targetWorkspace.getMetricsManager().getViewMetrics();this.width_=e.width,e=e.width-2*this.CORNER_RADIUS;var t=this.getHeight()-this.CORNER_RADIUS;this.setBackgroundPath(e,t),e=this.getX(),t=this.getY(),this.positionAt_(this.getWidth(),this.getHeight(),e,t)}}setBackgroundPath(e,t){const i=this.toolboxPosition_===G.TOP,s=["M 0,"+(i?0:this.CORNER_RADIUS)];i?(s.push("h",e+2*this.CORNER_RADIUS),s.push("v",t),s.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,this.CORNER_RADIUS),s.push("h",-e),s.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,-this.CORNER_RADIUS)):(s.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,-this.CORNER_RADIUS),s.push("h",e),s.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,this.CORNER_RADIUS),s.push("v",t),s.push("h",-e-2*this.CORNER_RADIUS)),s.push("z"),this.svgBackground_.setAttribute("d",s.join(" "))}scrollToStart(){let e;null==(e=this.workspace_.scrollbar)||e.setX(this.RTL?1/0:0)}wheel_(e){var t=vo(e);if(t=t.x||t.y){const i=this.workspace_.getMetricsManager(),s=i.getScrollMetrics();let n;t=i.getViewMetrics().left-s.left+t,null==(n=this.workspace_.scrollbar)||n.setX(t),Gt(this.workspace_),yt()}e.preventDefault(),e.stopPropagation()}layout_(e){this.workspace_.scale=this.targetWorkspace.scale;const t=this.MARGIN;let i=t+this.tabWidth_;this.RTL&&(e=e.reverse());for(const s of e)e=s.getElement().getBoundingRectangle(),e=this.RTL?i+e.getWidth():i,s.getElement().moveBy(e,t),i+=s.getElement().getBoundingRectangle().getWidth()}isDragTowardWorkspace(e){e=Math.atan2(e.y,e.x)/Math.PI*180;const t=this.dragAngleRange_;return e<90+t&&e>90-t||e>-90-t&&e<-90+t}getClientRect(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;const e=this.svgGroup_.getBoundingClientRect(),t=e.top;return this.toolboxPosition_===G.TOP?new z(-1e9,t+e.height,-1e9,1e9):new z(t,1e9,-1e9,1e9)}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();let e=this.getContents().reduce((t,i)=>Math.max(t,i.getElement().getBoundingRectangle().getHeight()),0);e+=1.5*this.MARGIN,e*=this.workspace_.scale,e+=_e.scrollbarThickness,this.getHeight()!==e&&(this.targetWorkspace.scrollbar||this.autoClose||this.targetWorkspace.getFlyout()!==this||this.toolboxPosition_!==G.TOP||this.targetWorkspace.translate(this.targetWorkspace.scrollX,this.targetWorkspace.scrollY+e),this.height_=e,this.position(),this.targetWorkspace.resizeContents(),this.targetWorkspace.recordDragTargets())}};U(k.FLYOUTS_HORIZONTAL_TOOLBOX,ct,gg);var tr=class extends He{constructor(e,t,i,s,n){super(Q.SKIP_SETUP),this.defaultType="",this.variableTypes=[],this.variable=null,this.SERIALIZABLE=!0,this.menuGenerator_=tr.dropdownCreate,this.defaultVariableName="string"==typeof e?e:"",this.size_=new j(0,0),e!==Q.SKIP_SETUP&&(n?this.configure_(n):this.setTypes(i,s),t&&this.setValidator(t))}configure_(e){super.configure_(e),this.setTypes(e.variableTypes,e.defaultType)}initModel(){var e=this.getSourceBlock();if(!e)throw new fe;this.variable||(e=o.getOrCreateVariablePackage$$module$build$src$core$variables(e.workspace,null,this.defaultVariableName,this.defaultType),this.doValueUpdate_(e.getId()))}initView(){super.initView(),A(this.fieldGroup_,"blocklyVariableField")}shouldAddBorderRect_(){const e=this.getSourceBlock();if(!e)throw new fe;return super.shouldAddBorderRect_()&&(!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||"variables_get"!==e.type)}fromXml(e){var t=this.getSourceBlock();if(!t)throw new fe;const i=e.getAttribute("id"),s=e.textContent,n=e.getAttribute("variabletype")||e.getAttribute("variableType")||"";if(t=o.getOrCreateVariablePackage$$module$build$src$core$variables(t.workspace,i,s,n),null!==n&&n!==t.getType())throw Error("Serialized variable type with id '"+t.getId()+"' had type "+t.getType()+", and does not match variable field that references it: "+ht(e)+".");this.setValue(t.getId())}toXml(e){return this.initModel(),e.id=this.variable.getId(),e.textContent=this.variable.getName(),this.variable.getType()&&e.setAttribute("variabletype",this.variable.getType()),e}saveState(e){var t=this.saveLegacyState(tr);return null!==t||(this.initModel(),t={id:this.variable.getId()},e&&(t.name=this.variable.getName(),t.type=this.variable.getType())),t}loadState(e){const t=this.getSourceBlock();if(!t)throw new fe;this.loadLegacyState(tr,e)||(e=o.getOrCreateVariablePackage$$module$build$src$core$variables(t.workspace,e.id||null,e.name,e.type||""),this.setValue(e.getId()))}setSourceBlock(e){if(e.isShadow())throw Error("Variable fields are not allowed to exist on shadow blocks.");super.setSourceBlock(e)}getValue(){return this.variable?this.variable.getId():null}getText(){return this.variable?this.variable.getName():""}getVariable(){return this.variable}getDefaultType(){return this.defaultType}getValidator(){return this.variable?this.validator_:null}doClassValidation_(e){if(null===e)return null;var t=this.getSourceBlock();if(!t)throw new fe;return(t=o.getVariable$$module$build$src$core$variables(t.workspace,e))?(t=t.getType(),this.typeIsAllowed(t)?e:(console.warn("Variable type doesn't match this field!  Type was "+t),null)):(console.warn("Variable id doesn't point to a real variable! ID was "+e),null)}doValueUpdate_(e){const t=this.getSourceBlock();if(!t)throw new fe;this.variable=o.getVariable$$module$build$src$core$variables(t.workspace,e),super.doValueUpdate_(e)}typeIsAllowed(e){const t=this.getVariableTypes();if(!t)return!0;for(let i=0;i<t.length;i++)if(e===t[i])return!0;return!1}getVariableTypes(){if(this.variableTypes)return this.variableTypes;if(!this.sourceBlock_||this.sourceBlock_.isDeadOrDying())return[""];let e=this.sourceBlock_.workspace.getVariableMap().getTypes();if(this.sourceBlock_.isInFlyout){const t=this.sourceBlock_.workspace.getPotentialVariableMap();if(!t)return e;e=Array.from(new Set([...e,...t.getTypes()]))}return e}setTypes(e=null,t=""){var i=this.getText();if(Array.isArray(e)){if(0===e.length)throw Error(`'variableTypes' of field variable ${i} was an empty list. If you want to include all variable types, pass 'null' instead.`);i=!1;for(let s=0;s<e.length;s++)e[s]===t&&(i=!0);if(!i)throw Error("Invalid default type '"+t+"' in the definition of a FieldVariable")}else if(null!==e)throw Error(`'variableTypes' was not an array or null in the definition of FieldVariable ${i}`);this.defaultType=t,this.variableTypes=e}refreshVariableName(){this.forceRerender()}onItemSelected_(e,t){if(e=t.getValue(),this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()){if(e===Yl&&this.variable)return void o.renameVariable$$module$build$src$core$variables(this.sourceBlock_.workspace,this.variable);if(e===Kl&&this.variable)return e=this.variable.getWorkspace(),void o.deleteVariable$$module$build$src$core$variables(e,this.variable,this.sourceBlock_)}this.setValue(e)}referencesVariables(){return!0}static fromJson(e){return new this(l(e.variable),void 0,void 0,void 0,e)}static dropdownCreate(){if(!this.variable)throw Error("Tried to call dropdownCreate on a variable field with no variable selected.");const e=this.getText();let t=[];var i=this.getSourceBlock();if(i&&!i.isDeadOrDying()){i=i.workspace;const r=this.getVariableTypes();for(let a=0;a<r.length;a++){const $=r[a],C=i.getVariableMap().getVariablesOfType($);if(t=t.concat(C),i.isFlyout){var s=void 0,n=void 0;t=t.concat(null!=(n=null==(s=i.getPotentialVariableMap())?void 0:s.getVariablesOfType($))?n:[])}}}for(t.sort(ts),s=[],n=0;n<t.length;n++)s[n]=[t[n].getName(),t[n].getId()];return s.push([o.Msg$$module$build$src$core$msg.RENAME_VARIABLE,Yl]),o.Msg$$module$build$src$core$msg.DELETE_VARIABLE&&s.push([o.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",e),Kl]),s}};pt("field_variable",tr);var Mu=class extends Ps{constructor(e,t,i,s,n,r){super(Q.SKIP_SETUP),this.min_=-1/0,this.max_=1/0,this.precision_=0,this.decimalPlaces=null,this.spellcheck_=!1,e!==Q.SKIP_SETUP&&(r?this.configure_(r):this.setConstraints(t,i,s),this.setValue(e),n&&this.setValidator(n))}configure_(e){super.configure_(e),this.setMinInternal(e.min),this.setMaxInternal(e.max),this.setPrecisionInternal(e.precision)}setConstraints(e,t,i){this.setMinInternal(e),this.setMaxInternal(t),this.setPrecisionInternal(i),this.setValue(this.getValue())}setMin(e){this.setMinInternal(e),this.setValue(this.getValue())}setMinInternal(e){null==e?this.min_=-1/0:(e=Number(e),isNaN(e)||(this.min_=e))}getMin(){return this.min_}setMax(e){this.setMaxInternal(e),this.setValue(this.getValue())}setMaxInternal(e){null==e?this.max_=1/0:(e=Number(e),isNaN(e)||(this.max_=e))}getMax(){return this.max_}setPrecision(e){this.setPrecisionInternal(e),this.setValue(this.getValue())}setPrecisionInternal(e){this.precision_=Number(e)||0;let t=String(this.precision_);t.includes("e")&&(t=this.precision_.toLocaleString("en-US",{maximumFractionDigits:20}));const i=t.indexOf(".");this.decimalPlaces=-1===i?e?0:null:t.length-i-1}getPrecision(){return this.precision_}doClassValidation_(e){return null===e||(e=(e=(e=`${e}`.replace(/O/gi,"0")).replace(/,/g,"")).replace(/infinity/i,"Infinity"),e=Number(e||0),isNaN(e))?null:(e=Math.min(Math.max(e,this.min_),this.max_),this.precision_&&isFinite(e)&&(e=Math.round(e/this.precision_)*this.precision_),null!==this.decimalPlaces&&(e=Number(e.toFixed(this.decimalPlaces))),e)}widgetCreate_(){const e=super.widgetCreate_();return this.min_>-1/0&&(e.min=`${this.min_}`,Ee(e,ye.VALUEMIN,this.min_)),this.max_<1/0&&(e.max=`${this.max_}`,Ee(e,ye.VALUEMAX,this.max_)),e}initView(){super.initView(),this.fieldGroup_&&A(this.fieldGroup_,"blocklyNumberField")}static fromJson(e){return new this(e.value,void 0,void 0,void 0,void 0,e)}};pt("field_number",Mu),Mu.prototype.DEFAULT_VALUE=0;var $g=class extends Di{constructor(e,t,i){super(String(e??""),t,i),this.EDITABLE=!1,this.SERIALIZABLE=!0}static fromJson(e){return new this(l(e.text),void 0,e)}};pt("field_label_serializable",$g);var Gi=class extends Q{constructor(e,t,i){super(Q.SKIP_SETUP),this.SERIALIZABLE=!0,this.value_=this.value_,this.checkChar=Gi.CHECK_CHAR,e!==Q.SKIP_SETUP&&(i&&this.configure_(i),this.setValue(e),t&&this.setValidator(t))}configure_(e){super.configure_(e),e.checkCharacter&&(this.checkChar=e.checkCharacter)}saveState(){const e=this.saveLegacyState(Gi);return null!==e?e:this.getValueBoolean()}initView(){super.initView();const e=this.getTextElement();A(this.fieldGroup_,"blocklyCheckboxField"),e.style.display=this.value_?"block":"none"}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_(this.getConstants().FIELD_CHECKBOX_X_OFFSET)}getDisplayText_(){return this.checkChar}setCheckCharacter(e){this.checkChar=e||Gi.CHECK_CHAR,this.forceRerender()}showEditor_(){this.setValue(!this.value_)}doClassValidation_(e){return!0===e||"TRUE"===e?"TRUE":!1===e||"FALSE"===e?"FALSE":null}doValueUpdate_(e){this.value_=this.convertValueToBool(e),this.textElement_&&(this.textElement_.style.display=this.value_?"block":"none")}getValue(){return this.value_?"TRUE":"FALSE"}getValueBoolean(){return this.value_}getText(){return String(this.convertValueToBool(this.value_))}convertValueToBool(e){return"string"==typeof e?"TRUE"===e:!!e}static fromJson(e){return new this(e.checked,void 0,e)}};Gi.CHECK_CHAR="\u2713",pt("field_checkbox",Gi),Gi.prototype.DEFAULT_VALUE=!1;var mg=class{constructor(e,t){this.draggable=e,this.workspace=t,this.dragTarget=null,this.startLoc=e.getRelativeToSurfaceXY()}onDragStart(e){o.getGroup$$module$build$src$core$events$utils()||o.setGroup$$module$build$src$core$events$utils(!0),this.draggable.startDrag(e)}onDrag(e,t){this.moveDraggable(e,t),t=this.getRoot(this.draggable),Xe(t)&&t.setDeleteStyle(this.wouldDeleteDraggable(e,t)),this.updateDragTarget(e)}updateDragTarget(e){e=this.workspace.getDragTarget(e);const t=this.getRoot(this.draggable);if(this.dragTarget!==e){let i;null==(i=this.dragTarget)||i.onDragExit(t),e?.onDragEnter(t)}e?.onDragOver(t),this.dragTarget=e}moveDraggable(e,t){t=this.pixelsToWorkspaceUnits(t),t=S.sum(this.startLoc,t),this.draggable.drag(t,e)}wouldDeleteDraggable(e,t){return!(!(e=this.workspace.getDragTarget(e))||!this.workspace.getComponentManager().hasCapability(e.id,de.Capability.DELETE_AREA))&&e.wouldDelete(t)}onDragEnd(e){const t=o.getGroup$$module$build$src$core$events$utils();var i=this.workspace.getDragTarget(e);const s=this.getRoot(this.draggable);if(i){let n;null==(n=this.dragTarget)||n.onDrop(s)}this.shouldReturnToStart(e,s)&&this.draggable.revertDrag(),(i=Xe(s)&&this.wouldDeleteDraggable(e,s))&&this.draggable instanceof ie&&bs(this.draggable.getRootBlock()),this.draggable.endDrag(e),i&&Xe(s)&&(o.setGroup$$module$build$src$core$events$utils(t),s.dispose()),o.setGroup$$module$build$src$core$events$utils(!1),!i&&ai(this.draggable)&&o.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.draggable)}getRoot(e){return e instanceof ie?e.getRootBlock():e}shouldReturnToStart(e,t){return!!(e=this.workspace.getDragTarget(e))&&e.shouldPreventMove(t)}pixelsToWorkspaceUnits(e){return e=new S(e.x/this.workspace.scale,e.y/this.workspace.scale),this.workspace.isMutator&&e.scale(1/this.workspace.options.parentWorkspace.scale),e}};U(k.BLOCK_DRAGGER,ct,mg);var $c={};$c.BlockDragStrategy=vp,$c.BubbleDragStrategy=Ep,$c.CommentDragStrategy=$p,$c.Dragger=mg;var Nu=class extends qt{constructor(e,t,i){super(e?e.workspace.id:void 0),this.type=b.BLOCK_DRAG,e&&(this.blockId=e.id,this.isStart=t,this.blocks=i)}toJson(){const e=super.toJson();if(void 0===this.isStart)throw Error("Whether this event is the start of a drag is undefined. Either pass the value to the constructor, or call fromJson");if(void 0===this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");return e.isStart=this.isStart,e.blockId=this.blockId,e.blocks=this.blocks,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new Nu)).isStart=e.isStart,t.blockId=e.blockId,t.blocks=e.blocks,t}};U(k.EVENT,b.BLOCK_DRAG,Nu);var Lu=class extends Ri{constructor(e,t,i,s){super(e),this.type=b.BLOCK_FIELD_INTERMEDIATE_CHANGE,this.recordUndo=!1,e&&(this.name=t,this.oldValue=i,this.newValue=s)}toJson(){const e=super.toJson();if(!this.name)throw Error("The changed field name is undefined. Either pass a name to the constructor, or call fromJson.");return e.name=this.name,e.oldValue=this.oldValue,e.newValue=this.newValue,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new Lu)).name=e.name,t.oldValue=e.oldValue,t.newValue=e.newValue,t}isNull(){return this.oldValue===this.newValue}run(e){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");if(!(t=t.getBlockById(this.blockId)))throw Error("The associated block is undefined. Either pass a block to the constructor, or call fromJson");e=e?this.newValue:this.oldValue,(t=t.getField(this.name))?t.setValue(e):console.warn("Can't set non-existent field: "+this.name)}};U(k.EVENT,b.BLOCK_FIELD_INTERMEDIATE_CHANGE,Lu);var Du=class extends Ri{constructor(e){super(e),this.type=b.BLOCK_MOVE,e&&(e.isShadow()&&(this.recordUndo=!1),e=this.currentLocation(),this.oldParentId=e.parentId,this.oldInputName=e.inputName,this.oldCoordinate=e.coordinate)}toJson(){const e=super.toJson();return e.oldParentId=this.oldParentId,e.oldInputName=this.oldInputName,this.oldCoordinate&&(e.oldCoordinate=`${Math.round(this.oldCoordinate.x)}, ${Math.round(this.oldCoordinate.y)}`),e.newParentId=this.newParentId,e.newInputName=this.newInputName,this.newCoordinate&&(e.newCoordinate=`${Math.round(this.newCoordinate.x)}, ${Math.round(this.newCoordinate.y)}`),this.reason&&(e.reason=this.reason),this.recordUndo||(e.recordUndo=this.recordUndo),e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new Du)).oldParentId=e.oldParentId,t.oldInputName=e.oldInputName,e.oldCoordinate&&(i=e.oldCoordinate.split(","),t.oldCoordinate=new S(Number(i[0]),Number(i[1]))),t.newParentId=e.newParentId,t.newInputName=e.newInputName,e.newCoordinate&&(i=e.newCoordinate.split(","),t.newCoordinate=new S(Number(i[0]),Number(i[1]))),void 0!==e.reason&&(t.reason=e.reason),void 0!==e.recordUndo&&(t.recordUndo=e.recordUndo),t}recordNew(){const e=this.currentLocation();this.newParentId=e.parentId,this.newInputName=e.inputName,this.newCoordinate=e.coordinate}setReason(e){this.reason=e}currentLocation(){var e=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var t=e.getBlockById(this.blockId);if(!t)throw Error("The block associated with the block move event could not be found");e={};const i=t.getParent();return i?(e.parentId=i.id,(t=i.getInputWithBlock(t))&&(e.inputName=t.name)):e.coordinate=t.getRelativeToSurfaceXY(),e}isNull(){return this.oldParentId===this.newParentId&&this.oldInputName===this.newInputName&&S.equals(this.oldCoordinate,this.newCoordinate)}run(e){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var i=t.getBlockById(this.blockId);if(i){var s=e?this.newParentId:this.oldParentId,n=e?this.newInputName:this.oldInputName;if(e=e?this.newCoordinate:this.oldCoordinate,s){var r=t.getBlockById(s);if(!r)return void console.warn("Can't connect to non-existent block: "+s)}if(i.getParent()&&i.unplug(),e)n=i.getRelativeToSurfaceXY(),i.moveBy(e.x-n.x,e.y-n.y,this.reason);else{let a,$;(!(t=i.outputConnection)||i.previousConnection&&i.previousConnection.isConnected())&&(t=i.previousConnection),i=null==($=t)?void 0:$.type,n?(i=r.getInput(n))&&(a=i.connection):i===N.PREVIOUS_STATEMENT&&(a=r.nextConnection),a&&t?t.connect(a):console.warn("Can't connect to non-existent input: "+n)}}else console.warn("Can't move non-existent block: "+this.blockId)}};U(k.EVENT,b.BLOCK_MOVE,Du);var Pu,Bu=class extends qt{constructor(e,t,i){super(e?e.workspace.id:void 0),this.type=b.BUBBLE_OPEN,e&&(this.blockId=e.id,this.isOpen=t,this.bubbleType=i)}toJson(){const e=super.toJson();if(void 0===this.isOpen)throw Error("Whether this event is for opening the bubble is undefined. Either pass the value to the constructor, or call fromJson");if(!this.bubbleType)throw Error("The type of bubble is undefined. Either pass the value to the constructor, or call fromJson");return e.isOpen=this.isOpen,e.bubbleType=this.bubbleType,e.blockId=this.blockId||"",e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new Bu)).isOpen=e.isOpen,t.bubbleType=e.bubbleType,t.blockId=e.blockId,t}};(function(e){e.MUTATOR="mutator",e.COMMENT="comment",e.WARNING="warning"})(Pu||(Pu={})),U(k.EVENT,b.BUBBLE_OPEN,Bu);var Zm={};Zm.BubbleOpen=Bu,Zm.BubbleType=Pu;var to=class extends vs{constructor(e){super(),this.isBlank=!e,e&&(this.commentId=e.id,this.workspaceId=e.workspace.id,this.group=o.getGroup$$module$build$src$core$events$utils(),this.recordUndo=ke())}toJson(){const e=super.toJson();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");return e.commentId=this.commentId,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new to)).commentId=e.commentId,t}static CommentCreateDeleteHelper(e,t){const i=e.getEventWorkspace_();if(t){if(!e.json)throw Error("Encountered a comment event without proper json");an(e.json,i)}else{if(!e.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");(t=i.getCommentById(e.commentId))?t.dispose():console.warn("Can't delete non-existent comment: "+e.commentId)}}},Fu=class extends to{constructor(e,t,i){super(e),this.type=b.COMMENT_CHANGE,e&&(this.oldContents_=typeof t>"u"?"":t,this.newContents_=typeof i>"u"?"":i)}toJson(){const e=super.toJson();if(!this.oldContents_)throw Error("The old contents is undefined. Either pass a value to the constructor, or call fromJson");if(!this.newContents_)throw Error("The new contents is undefined. Either pass a value to the constructor, or call fromJson");return e.oldContents=this.oldContents_,e.newContents=this.newContents_,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new Fu)).oldContents_=e.oldContents,t.newContents_=e.newContents,t}isNull(){return this.oldContents_===this.newContents_}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(t=t.getCommentById(this.commentId)){var i=e?this.newContents_:this.oldContents_;if(void 0===i)throw Error(e?"The new contents is undefined. Either pass a value to the constructor, or call fromJson":"The old contents is undefined. Either pass a value to the constructor, or call fromJson");t.setText(i)}else console.warn("Can't change non-existent comment: "+this.commentId)}};U(k.EVENT,b.COMMENT_CHANGE,Fu);var Uu=class extends to{constructor(e,t){super(e),this.newCollapsed=t,this.type=b.COMMENT_COLLAPSE}toJson(){const e=super.toJson();if(void 0===this.newCollapsed)throw Error("The new collapse value undefined. Either call recordNew, or call fromJson");return e.newCollapsed=this.newCollapsed,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new Uu)).newCollapsed=e.newCollapsed,t}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");(t=t.getCommentById(this.commentId))?t.setCollapsed(e?!!this.newCollapsed:!this.newCollapsed):console.warn("Can't collapse or uncollapse non-existent comment: "+this.commentId)}};U(k.EVENT,b.COMMENT_COLLAPSE,Uu);var Hu=class extends to{constructor(e){super(e),this.type=b.COMMENT_CREATE,e&&(this.xml=kt(e),this.json=ui(e,{addCoordinates:!0}))}toJson(){const e=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.json)throw Error("The comment JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.xml=ht(this.xml),e.json=this.json,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new Hu)).xml=o.textToDom$$module$build$src$core$utils$xml(e.xml),t.json=e.json,t}run(e){to.CommentCreateDeleteHelper(this,e)}};U(k.EVENT,b.COMMENT_CREATE,Hu);var Vu=class extends to{constructor(e){super(e),this.type=b.COMMENT_DELETE,e&&(this.xml=kt(e),this.json=ui(e,{addCoordinates:!0}))}run(e){to.CommentCreateDeleteHelper(this,!e)}toJson(){const e=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.json)throw Error("The comment JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.xml=ht(this.xml),e.json=this.json,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new Vu)).xml=o.textToDom$$module$build$src$core$utils$xml(e.xml),t.json=e.json,t}};U(k.EVENT,b.COMMENT_DELETE,Vu);var Gu=class extends qt{constructor(e,t){super(e?e.workspace.id:void 0),this.type=b.COMMENT_DRAG,e&&(this.commentId=e.id,this.isStart=t)}toJson(){const e=super.toJson();if(void 0===this.isStart)throw Error("Whether this event is the start of a drag is undefined. Either pass the value to the constructor, or call fromJson");if(void 0===this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");return e.isStart=this.isStart,e.commentId=this.commentId,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new Gu)).isStart=e.isStart,t.commentId=e.commentId,t}};U(k.EVENT,b.COMMENT_DRAG,Gu);var Zu=class extends to{constructor(e){super(e),this.type=b.COMMENT_MOVE,e&&(this.comment_=e,this.oldCoordinate_=e.getRelativeToSurfaceXY())}recordNew(){if(this.newCoordinate_)throw Error("Tried to record the new position of a comment on the same event twice.");if(!this.comment_)throw Error("The comment is undefined. Pass a comment to the constructor if you want to use the record functionality");this.newCoordinate_=this.comment_.getRelativeToSurfaceXY()}setReason(e){this.reason=e}setOldCoordinate(e){this.oldCoordinate_=e}toJson(){const e=super.toJson();if(!this.oldCoordinate_)throw Error("The old comment position is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.newCoordinate_)throw Error("The new comment position is undefined. Either call recordNew, or call fromJson");return e.oldCoordinate=`${Math.round(this.oldCoordinate_.x)}, ${Math.round(this.oldCoordinate_.y)}`,e.newCoordinate=Math.round(this.newCoordinate_.x)+","+Math.round(this.newCoordinate_.y),e}static fromJson(e,t,i){return t=super.fromJson(e,t,i??new Zu),i=e.oldCoordinate.split(","),t.oldCoordinate_=new S(Number(i[0]),Number(i[1])),i=e.newCoordinate.split(","),t.newCoordinate_=new S(Number(i[0]),Number(i[1])),t}isNull(){return S.equals(this.oldCoordinate_,this.newCoordinate_)}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(t=t.getCommentById(this.commentId)){if(!(e=e?this.newCoordinate_:this.oldCoordinate_))throw Error("Either oldCoordinate_ or newCoordinate_ is undefined. Either pass a comment to the constructor and call recordNew, or call fromJson");t.moveTo(e)}else console.warn("Can't move non-existent comment: "+this.commentId)}};U(k.EVENT,b.COMMENT_MOVE,Zu);var Wu=class extends to{constructor(e){super(e),this.type=b.COMMENT_RESIZE,e&&(this.oldSize=e.getSize())}recordCurrentSizeAsNewSize(){if(this.newSize)throw Error("Tried to record the new size of a comment on the same event twice.");var e=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(!(e=e.getCommentById(this.commentId)))throw Error("The comment associated with the comment resize event could not be found");this.newSize=e.getSize()}toJson(){const e=super.toJson();if(!this.oldSize)throw Error("The old comment size is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.newSize)throw Error("The new comment size is undefined. Either call recordCurrentSizeAsNewSize, or call fromJson");return e.oldWidth=Math.round(this.oldSize.width),e.oldHeight=Math.round(this.oldSize.height),e.newWidth=Math.round(this.newSize.width),e.newHeight=Math.round(this.newSize.height),e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new Wu)).oldSize=new j(e.oldWidth,e.oldHeight),t.newSize=new j(e.newWidth,e.newHeight),t}isNull(){return j.equals(this.oldSize,this.newSize)}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(t=t.getCommentById(this.commentId)){if(!(e=e?this.newSize:this.oldSize))throw Error("Either oldSize or newSize is undefined. Either pass a comment to the constructor and call recordCurrentSizeAsNewSize, or call fromJson");t.setSize(e)}else console.warn("Can't resize non-existent comment: "+this.commentId)}};U(k.EVENT,b.COMMENT_RESIZE,Wu);var qu=class extends qt{constructor(e,t,i){super(i),this.type=b.TOOLBOX_ITEM_SELECT,this.oldItem=e??void 0,this.newItem=t??void 0}toJson(){const e=super.toJson();return e.oldItem=this.oldItem,e.newItem=this.newItem,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new qu)).oldItem=e.oldItem,t.newItem=e.newItem,t}};U(k.EVENT,b.TOOLBOX_ITEM_SELECT,qu);var zu=class extends Bs{constructor(e,t,i){super(e),this.oldType=t,this.newType=i,this.type=b.VAR_TYPE_CHANGE}toJson(){const e=super.toJson();if(!this.oldType||!this.newType)throw Error("The variable's types are undefined. Either pass them to the constructor, or call fromJson");return e.oldType=this.oldType,e.newType=this.newType,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,i??new zu)).oldType=e.oldType,t.newType=e.newType,t}run(e){const t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.oldType||!this.newType)throw Error("The variable's types are undefined. Either pass them to the constructor, or call fromJson");const i=t.getVariableMap().getVariableById(this.varId);i&&(e?t.getVariableMap().changeVariableType(i,this.newType):t.getVariableMap().changeVariableType(i,this.oldType))}};U(k.EVENT,b.VAR_TYPE_CHANGE,zu);var Wm,qm,zm,jm,Xm,Ym,Km,Jm,Qm,e_,t_,o_,i_,s_,n_,r_,l_,c_,a_,u_,d_,h_,p_,g_,R,_g=class extends vs{constructor(e){super(),this.isBlank=!0,this.recordUndo=!1,this.type=b.FINISHED_LOADING,this.isBlank=!!e,e&&(this.workspaceId=e.id)}};U(k.EVENT,b.FINISHED_LOADING,_g),o.BLOCK_CHANGE$$module$build$src$core$events$events=b.BLOCK_CHANGE,o.BLOCK_CREATE$$module$build$src$core$events$events=b.BLOCK_CREATE,o.BLOCK_DELETE$$module$build$src$core$events$events=b.BLOCK_DELETE,Wm=b.BLOCK_DRAG,o.BLOCK_MOVE$$module$build$src$core$events$events=b.BLOCK_MOVE,qm=b.BLOCK_FIELD_INTERMEDIATE_CHANGE,zm=b.BUBBLE_OPEN,jm=b.BLOCK_CHANGE,Xm=b.CLICK,Ym=b.COMMENT_CHANGE,Km=b.COMMENT_CREATE,Jm=b.COMMENT_DELETE,Qm=b.COMMENT_MOVE,e_=b.COMMENT_RESIZE,t_=b.COMMENT_DRAG,o_=b.BLOCK_CREATE,i_=b.BLOCK_DELETE,s_=b.FINISHED_LOADING,n_=b.BLOCK_MOVE,r_=b.SELECTED,l_=b.THEME_CHANGE,c_=b.TOOLBOX_ITEM_SELECT,a_=b.TRASHCAN_OPEN,u_=b.UI,d_=b.VAR_CREATE,h_=b.VAR_DELETE,p_=b.VAR_RENAME,g_=b.VIEWPORT_CHANGE,(R={}).Abstract=vs,R.BLOCK_CHANGE=o.BLOCK_CHANGE$$module$build$src$core$events$events,R.BLOCK_CREATE=o.BLOCK_CREATE$$module$build$src$core$events$events,R.BLOCK_DELETE=o.BLOCK_DELETE$$module$build$src$core$events$events,R.BLOCK_DRAG=Wm,R.BLOCK_FIELD_INTERMEDIATE_CHANGE=qm,R.BLOCK_MOVE=o.BLOCK_MOVE$$module$build$src$core$events$events,R.BUBBLE_OPEN=zm,R.BUMP_EVENTS=Dh,R.BlockBase=Ri,R.BlockChange=Oi,R.BlockCreate=Ya,R.BlockDelete=eu,R.BlockDrag=Nu,R.BlockFieldIntermediateChange=Lu,R.BlockMove=Du,R.BubbleOpen=Bu,R.BubbleType=Pu,R.CHANGE=jm,R.CLICK=Xm,R.COMMENT_CHANGE=Ym,R.COMMENT_CREATE=Km,R.COMMENT_DELETE=Jm,R.COMMENT_DRAG=t_,R.COMMENT_MOVE=Qm,R.COMMENT_RESIZE=e_,R.CREATE=o_,R.Click=Sa,R.ClickTarget=wa,R.CommentBase=to,R.CommentChange=Fu,R.CommentCollapse=Uu,R.CommentCreate=Hu,R.CommentDelete=Vu,R.CommentDrag=Gu,R.CommentMove=Zu,R.CommentResize=Wu,R.DELETE=i_,R.FINISHED_LOADING=s_,R.FinishedLoading=_g,R.MOVE=n_,R.SELECTED=r_,R.Selected=Qa,R.THEME_CHANGE=l_,R.TOOLBOX_ITEM_SELECT=c_,R.TRASHCAN_OPEN=a_,R.ThemeChange=Ka,R.ToolboxItemSelect=qu,R.TrashcanOpen=ku,R.UI=u_,R.UiBase=qt,R.VAR_CREATE=d_,R.VAR_DELETE=h_,R.VAR_RENAME=p_,R.VIEWPORT_CHANGE=g_,R.VarBase=Bs,R.VarCreate=yu,R.VarDelete=Cu,R.VarRename=Iu,R.VarTypeChange=zu,R.ViewportChange=Ja,R.clearPendingUndo=ci,R.disable=o.disable$$module$build$src$core$events$utils,R.disableOrphans=Lt,R.enable=o.enable$$module$build$src$core$events$utils,R.filter=li,R.fire=B,R.fromJson=zi,R.get=P,R.getDescendantIds=Io,R.getGroup=o.getGroup$$module$build$src$core$events$utils,R.getRecordUndo=ke,R.isEnabled=se,R.setGroup=o.setGroup$$module$build$src$core$events$utils,R.setRecordUndo=o.setRecordUndo$$module$build$src$core$events$utils;var bo={};bo.BottomRow=cg,bo.ConstantProvider=rg,bo.Drawer=lg,bo.PathObject=hg,bo.RenderInfo=dg,bo.Renderer=Ru,bo.RightConnectionShape=ag,bo.StatementInput=gc,bo.TopRow=ug,wh();var De={};De.registerCleanup=hh,De.registerCollapse=gh,De.registerCollapseExpandBlock=Eh,De.registerComment=fh,De.registerCommentCreate=Sh,De.registerCommentDelete=Ih,De.registerCommentDuplicate=kh,De.registerCommentOptions=i$,De.registerDefaultOptions=wh,De.registerDelete=yh,De.registerDeleteAll=_h,De.registerDisable=vh,De.registerDuplicate=bh,De.registerExpand=$h,De.registerHelp=Ch,De.registerInline=Th,De.registerRedo=dh,De.registerUndo=uh;var bg="button",fg=class{load(e,t){return(e=new Je(t.getWorkspace(),t.targetWorkspace,e,!1)).show(),new Ns(e,bg)}gapForItem(e,t){return t}disposeItem(e){(e=e.getElement())instanceof Je&&e.dispose()}getType(){return bg}};U(k.FLYOUT_INFLATER,bg,fg);var mc={};mc.Bubble=ee,mc.MiniWorkspaceBubble=go,mc.TextBubble=yp,mc.TextInputBubble=pu;var Tg="block",Eg=class{constructor(){this.permanentlyDisabledBlocks=new Set,this.listeners=new Map,this.capacityWrapper=this.filterFlyoutBasedOnCapacity.bind(this)}load(e,t){return this.setFlyout(t),(e=this.createBlock(e,t.getWorkspace())).isEnabled()?this.updateStateBasedOnCapacity(e):this.permanentlyDisabledBlocks.add(e),e.getDescendants(!1).forEach(i=>i.isInFlyout=!0),this.addBlockListeners(e),new Ns(e,Tg)}createBlock(e,t){return e.blockxml?(e="string"==typeof e.blockxml?o.textToDom$$module$build$src$core$utils$xml(e.blockxml):e.blockxml,t=uo(e,t)):(void 0===e.enabled&&(e.enabled="true"!==e.disabled&&!0!==e.disabled),void 0===e.disabledReasons&&!1===e.enabled&&(e.disabledReasons=[xt]),"x"in e&&delete e.x,"y"in e&&delete e.y,t=ss(e,t)),t}gapForItem(e,t){let i;return e.gap?i=parseInt(String(e.gap)):e.blockxml&&(e="string"==typeof e.blockxml?o.textToDom$$module$build$src$core$utils$xml(e.blockxml):e.blockxml,i=parseInt(e.getAttribute("gap"))),!i||isNaN(i)?t:i}disposeItem(e){(e=e.getElement())instanceof ie&&(this.removeListeners(e.id),e.dispose(!1,!1))}removeListeners(e){let t;(null!=(t=this.listeners.get(e))?t:[]).forEach(i=>K(i)),this.listeners.delete(e)}setFlyout(e){if(this.flyout!==e){if(this.flyout){let i;null==(i=this.flyout.targetWorkspace)||i.removeChangeListener(this.capacityWrapper)}var t;this.flyout=e,null==(t=this.flyout.targetWorkspace)||t.addChangeListener(this.capacityWrapper)}}updateStateBasedOnCapacity(e){let t,i;const s=null==(t=this.flyout)||null==(i=t.targetWorkspace)?void 0:i.isCapacityAvailable(on(e));for(;e;)e.setDisabledReason(!s,"WORKSPACE_AT_BLOCK_CAPACITY"),e=e.getNextBlock()}addBlockListeners(e){const t=[];t.push(L(e.getSvgRoot(),"pointerdown",e,i=>{let s,n;const r=null==(s=this.flyout)||null==(n=s.targetWorkspace)?void 0:n.getGesture(i);r&&this.flyout&&(r.setStartBlock(e),r.handleFlyoutStart(i,this.flyout))})),t.push(qe(e.getSvgRoot(),"pointermove",null,()=>{let i,s;null!=(i=this.flyout)&&null!=(s=i.targetWorkspace)&&s.isDragging()||e.addSelect()})),t.push(qe(e.getSvgRoot(),"pointerleave",null,()=>{let i,s;null!=(i=this.flyout)&&null!=(s=i.targetWorkspace)&&s.isDragging()||e.removeSelect()})),this.listeners.set(e.id,t)}filterFlyoutBasedOnCapacity(e){!this.flyout||e&&e.type!==b.BLOCK_CREATE&&e.type!==b.BLOCK_DELETE||this.flyout.getWorkspace().getTopBlocks(!1).forEach(t=>{this.permanentlyDisabledBlocks.has(t)||this.updateStateBasedOnCapacity(t)})}getType(){return Tg}};U(k.FLYOUT_INFLATER,Tg,Eg);var vg=class extends cc{constructor(){super(),this.FIELD_TEXT_BASELINE_CENTER=!1,this.DARK_PATH_OFFSET=1,this.MAX_BOTTOM_WIDTH=30,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT/2}getCSS_(e){return super.getCSS_(e).concat([`${e} .blocklyInsertionMarker>.blocklyPathLight,`,`${e} .blocklyInsertionMarker>.blocklyPathDark {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"])}},yg=class{constructor(e){this.inlineSteps_=this.steps_="",this.info_=e,this.RTL_=this.info_.RTL,e=e.getRenderer(),this.constants_=e.getConstants(),this.highlightConstants_=e.getHighlightConstants(),this.highlightOffset=this.highlightConstants_.OFFSET,this.outsideCornerPaths_=this.highlightConstants_.OUTSIDE_CORNER,this.insideCornerPaths_=this.highlightConstants_.INSIDE_CORNER,this.puzzleTabPaths_=this.highlightConstants_.PUZZLE_TAB,this.notchPaths_=this.highlightConstants_.NOTCH,this.startPaths_=this.highlightConstants_.START_HAT,this.jaggedTeethPaths_=this.highlightConstants_.JAGGED_TEETH}getPath(){return this.steps_+"\n"+this.inlineSteps_}drawTopCorner(e){this.steps_+=ae(e.xPos,this.info_.startY);for(let i,t=0;i=e.elements[t];t++)m.isLeftSquareCorner(i)?this.steps_+=this.highlightConstants_.START_POINT:m.isLeftRoundedCorner(i)?this.steps_+=this.outsideCornerPaths_.topLeft(this.RTL_):m.isPreviousConnection(i)?this.steps_+=this.notchPaths_.pathLeft:m.isHat(i)?this.steps_+=this.startPaths_.path(this.RTL_):m.isSpacer(i)&&0!==i.width&&(this.steps_+=M("H",i.xPos+i.width-this.highlightOffset));this.steps_+=M("H",e.xPos+e.width-this.highlightOffset)}drawJaggedEdge_(e){this.info_.RTL&&(this.steps_+=this.jaggedTeethPaths_.pathLeft+M("v",e.height-this.jaggedTeethPaths_.height-this.highlightOffset))}drawValueInput(e){const t=e.getLastInput();if(this.RTL_){const i=e.height-t.connectionHeight;this.steps_+=Se(t.xPos+t.width-this.highlightOffset,e.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)+M("v",i)}else this.steps_+=Se(t.xPos+t.width,e.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)}drawStatementInput(e){const t=e.getLastInput();if(t)if(this.RTL_){const i=e.height-2*this.insideCornerPaths_.height;this.steps_+=Se(t.xPos,e.yPos)+this.insideCornerPaths_.pathTop(this.RTL_)+M("v",i)+this.insideCornerPaths_.pathBottom(this.RTL_)+gt(e.width-t.xPos-this.insideCornerPaths_.width,0)}else this.steps_+=Se(t.xPos,e.yPos+e.height)+this.insideCornerPaths_.pathBottom(this.RTL_)+gt(e.width-t.xPos-this.insideCornerPaths_.width,0)}drawRightSideRow(e){const t=e.xPos+e.width-this.highlightOffset;e instanceof fu&&e.followsStatement&&(this.steps_+=M("H",t)),this.RTL_&&(this.steps_+=M("H",t),e.height>this.highlightOffset&&(this.steps_+=M("V",e.yPos+e.height-this.highlightOffset)))}drawBottomRow(e){if(this.RTL_)this.steps_+=M("V",e.baseline-this.highlightOffset);else{const t=this.info_.bottomRow.elements[0];m.isLeftSquareCorner(t)?this.steps_+=Se(e.xPos+this.highlightOffset,e.baseline-this.highlightOffset):m.isLeftRoundedCorner(t)&&(this.steps_+=Se(e.xPos,e.baseline),this.steps_+=this.outsideCornerPaths_.bottomLeft())}}drawLeft(){var e=this.info_.outputConnection;e&&(e=e.connectionOffsetY+e.height,this.RTL_?this.steps_+=Se(this.info_.startX,e):(this.steps_+=Se(this.info_.startX+this.highlightOffset,this.info_.bottomRow.baseline-this.highlightOffset),this.steps_+=M("V",e)),this.steps_+=this.puzzleTabPaths_.pathUp(this.RTL_)),this.RTL_||(m.isLeftRoundedCorner((e=this.info_.topRow).elements[0])?this.steps_+=M("V",this.outsideCornerPaths_.height):this.steps_+=M("V",e.capline+this.highlightOffset))}drawInlineInput(e){const t=this.highlightOffset,i=e.xPos+e.connectionWidth;var s=e.centerline-e.height/2;const n=e.width-e.connectionWidth,r=s+t;this.RTL_?(s=e.connectionOffsetY-t,e=e.height-(e.connectionOffsetY+e.connectionHeight)+t,this.inlineSteps_+=Se(i-t,r)+M("v",s)+this.puzzleTabPaths_.pathDown(this.RTL_)+M("v",e)+M("h",n)):this.inlineSteps_+=Se(e.xPos+e.width+t,r)+M("v",e.height)+M("h",-n)+Se(i,s+e.connectionOffsetY)+this.puzzleTabPaths_.pathDown(this.RTL_)}},Cg=class extends ac{constructor(e,t){super(e,t),this.highlighter_=new yg(t)}draw(){this.drawOutline_(),this.drawInternals_(),this.updateConnectionHighlights();const e=this.block_.pathObject;e.setPath(this.outlinePath_+"\n"+this.inlinePath_),e.setHighlightPath(this.highlighter_.getPath()),this.info_.RTL&&e.flipRTL(),this.recordSizeOnBlock_()}drawTop_(){this.highlighter_.drawTopCorner(this.info_.topRow),this.highlighter_.drawRightSideRow(this.info_.topRow),super.drawTop_()}drawJaggedEdge_(e){this.highlighter_.drawJaggedEdge_(e),super.drawJaggedEdge_(e)}drawValueInput_(e){this.highlighter_.drawValueInput(e),super.drawValueInput_(e)}drawStatementInput_(e){this.highlighter_.drawStatementInput(e),super.drawStatementInput_(e)}drawRightSideRow_(e){this.highlighter_.drawRightSideRow(e),this.outlinePath_+=M("H",e.xPos+e.width)+M("V",e.yPos+e.height)}drawBottom_(){this.highlighter_.drawBottomRow(this.info_.bottomRow),super.drawBottom_()}drawLeft_(){this.highlighter_.drawLeft(),super.drawLeft_()}drawInlineInput_(e){this.highlighter_.drawInlineInput(e),super.drawInlineInput_(e)}positionInlineInputConnection_(e){if(e.connectionModel){let i=e.xPos+e.connectionWidth+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(i*=-1),e.connectionModel.setOffsetInBlock(i,e.centerline-e.height/2+e.connectionOffsetY+this.constants_.DARK_PATH_OFFSET)}}positionStatementInputConnection_(e){const t=e.getLastInput();if(null!=t&&t.connectionModel){let i=e.xPos+e.statementEdge+t.notchOffset;i=this.info_.RTL?-1*i:i+this.constants_.DARK_PATH_OFFSET,t.connectionModel.setOffsetInBlock(i,e.yPos+this.constants_.DARK_PATH_OFFSET)}}positionExternalValueConnection_(e){const t=e.getLastInput();if(t&&t.connectionModel){let i=e.xPos+e.width+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(i*=-1),t.connectionModel.setOffsetInBlock(i,e.yPos)}}positionNextConnection_(){const e=this.info_.bottomRow;if(e.connection){const t=e.connection,i=t.xPos;t.connectionModel.setOffsetInBlock((this.info_.RTL?-i:i)+this.constants_.DARK_PATH_OFFSET/2,e.baseline+this.constants_.DARK_PATH_OFFSET)}}},Ig=class{constructor(e){this.OFFSET=.5,this.constantProvider=e,this.START_POINT=ae(this.OFFSET,this.OFFSET)}init(){this.INSIDE_CORNER=this.makeInsideCorner(),this.OUTSIDE_CORNER=this.makeOutsideCorner(),this.PUZZLE_TAB=this.makePuzzleTab(),this.NOTCH=this.makeNotch(),this.JAGGED_TEETH=this.makeJaggedTeeth(),this.START_HAT=this.makeStartHat()}makeInsideCorner(){const e=this.constantProvider.CORNER_RADIUS,t=this.OFFSET,i=(1-Math.SQRT1_2)*(e+t)-t,s=ae(i,i)+he("a","0 0,0",e,D(-i-t,e-i)),n=he("a","0 0,0",e+t,D(e+t,e+t)),r=ae(i,-i)+he("a","0 0,0",e+t,D(e-i,i+t));return{width:e+t,height:e,pathTop:a=>a?s:"",pathBottom:a=>a?n:r}}makeOutsideCorner(){const e=this.constantProvider.CORNER_RADIUS,t=this.OFFSET,i=(1-Math.SQRT1_2)*(e-t)+t,s=ae(i,i)+he("a","0 0,1",e-t,D(e-i,-i+t)),n=ae(t,e)+he("a","0 0,1",e-t,D(e,-e+t)),r=-i,a=ae(i,r)+he("a","0 0,1",e-t,D(-i+t,-r-e));return{height:e,topLeft:$=>$?s:n,bottomLeft:()=>a}}makePuzzleTab(){const e=this.constantProvider.TAB_WIDTH,t=this.constantProvider.TAB_HEIGHT,i=ae(-2,2.5-t+.9)+gt(-.45*e,-2.1),s=M("v",2.5)+ae(.97*-e,2.5)+Pe("q",[D(.05*-e,10),D(.3*e,9.5)])+ae(.67*e,-1.9)+M("v",2.5),n=M("v",-1.5)+ae(-.92*e,-.5)+Pe("q",[D(-.19*e,-5.5),D(0,-11)])+ae(.92*e,1),r=ae(-5,t-.7)+gt(.46*e,-2.1);return{width:e,height:t,pathUp:a=>a?i:n,pathDown:a=>a?s:r}}makeNotch(){return{pathLeft:M("h",this.OFFSET)+this.constantProvider.NOTCH.pathLeft}}makeJaggedTeeth(){return{pathLeft:gt(5.1,2.6)+ae(-10.2,6.8)+gt(5.1,2.6),height:12,width:10.2}}makeStartHat(){const e=this.constantProvider.START_HAT.height,t=ae(25,-8.7)+Pe("c",[D(29.7,-6.2),D(57.2,-.5),D(75,8.7)]),i=Pe("c",[D(17.8,-9.2),D(45.3,-14.9),D(75,-8.7)])+Se(100.5,e+.5);return{path:s=>s?t:i}}},kg=class extends _u{constructor(e,t){super(e,t),this.constants_=e,this.connectedBlock&&(this.width+=this.constants_.DARK_PATH_OFFSET,this.height+=this.constants_.DARK_PATH_OFFSET)}},Sg=class extends lc{constructor(e,t){super(e,t),this.constants_=e,this.connectedBlock&&(this.height+=this.constants_.DARK_PATH_OFFSET)}},wg=class extends Jn{constructor(e,t){super(e,t),this.renderer_=e}getRenderer(){return this.renderer_}populateBottomRow_(){super.populateBottomRow_(),this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1]instanceof ut||(this.bottomRow.minHeight=this.constants_.MEDIUM_PADDING-this.constants_.DARK_PATH_OFFSET)}addInput_(e,t){this.isInline&&e instanceof o.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new kg(this.constants_,e)),t.hasInlineInput=!0):e instanceof ut?(t.elements.push(new Sg(this.constants_,e)),t.hasStatement=!0):e instanceof o.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new $u(this.constants_,e)),t.hasExternalInput=!0):(e instanceof Kt||e instanceof $o)&&(t.minHeight=Math.max(t.minHeight,this.constants_.DUMMY_INPUT_MIN_HEIGHT),t.hasDummyInput=!0),this.isInline||null!==t.align||(t.align=e.align)}addElemSpacing_(){let e=!1;for(let s,i=0;s=this.rows[i];i++)s.hasExternalInput&&(e=!0);for(let s,i=0;s=this.rows[i];i++){var t=s.elements;if(s.elements=[],s.startsWithElemSpacer()&&s.elements.push(new dt(this.constants_,this.getInRowSpacing_(null,t[0]))),t.length){for(let n=0;n<t.length-1;n++){s.elements.push(t[n]);const r=this.getInRowSpacing_(t[n],t[n+1]);s.elements.push(new dt(this.constants_,r))}s.elements.push(t[t.length-1]),s.endsWithElemSpacer()&&(t=this.getInRowSpacing_(t[t.length-1],null),e&&s.hasDummyInput&&(t+=this.constants_.TAB_WIDTH),s.elements.push(new dt(this.constants_,t)))}}}getInRowSpacing_(e,t){if(!e)return t&&m.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:t&&m.isInlineInput(t)?this.constants_.MEDIUM_LARGE_PADDING:t&&m.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!m.isInput(e)&&(!t||m.isStatementInput(t)))return m.isField(e)&&e.isEditable?0===e.width?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:m.isIcon(e)?2*this.constants_.LARGE_PADDING+1:m.isHat(e)?this.constants_.NO_PADDING:m.isPreviousOrNextConnection(e)?this.constants_.LARGE_PADDING:m.isLeftRoundedCorner(e)?this.constants_.MIN_BLOCK_WIDTH:m.isJaggedEdge(e)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(m.isInput(e)&&!t){if(m.isExternalInput(e))return this.constants_.NO_PADDING;if(m.isInlineInput(e))return this.constants_.LARGE_PADDING;if(m.isStatementInput(e))return this.constants_.NO_PADDING}if(!m.isInput(e)&&t&&m.isInput(t)){if(m.isField(e)&&e.isEditable){if(m.isInlineInput(t)||m.isExternalInput(t))return this.constants_.SMALL_PADDING}else{if(m.isInlineInput(t)||m.isExternalInput(t))return this.constants_.MEDIUM_LARGE_PADDING;if(m.isStatementInput(t))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(m.isIcon(e)&&t&&!m.isInput(t))return this.constants_.LARGE_PADDING;if(m.isInlineInput(e)&&t&&m.isField(t))return t.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(m.isLeftSquareCorner(e)&&t){if(m.isHat(t))return this.constants_.NO_PADDING;if(m.isPreviousConnection(t))return t.notchOffset;if(m.isNextConnection(t))return t.notchOffset+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}if(m.isLeftRoundedCorner(e)&&t){if(m.isPreviousConnection(t))return t.notchOffset-this.constants_.CORNER_RADIUS;if(m.isNextConnection(t))return t.notchOffset-this.constants_.CORNER_RADIUS+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}return m.isField(e)&&t&&m.isField(t)&&e.isEditable===t.isEditable?0===e.width?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING:t&&m.isJaggedEdge(t)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(e,t){return m.isTopRow(e)&&m.isBottomRow(t)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:m.isTopRow(e)||m.isBottomRow(t)?this.constants_.NO_PADDING:e.hasExternalInput&&t.hasExternalInput?this.constants_.LARGE_PADDING:!e.hasStatement&&t.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:e.hasStatement&&t.hasStatement||!e.hasStatement&&t.hasDummyInput||e.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){if(m.isSpacer(t))return e.yPos+t.height/2;if(m.isBottomRow(e))return e=e.yPos+e.height-e.descenderHeight,m.isNextConnection(t)?e+t.height/2:e-t.height/2;if(m.isTopRow(e))return m.isHat(t)?e.capline-t.height/2:e.capline+t.height/2;let i=e.yPos;return m.isField(t)||m.isIcon(t)?(i+=t.height/2,(e.hasInlineInput||e.hasStatement)&&t.height+this.constants_.TALL_INPUT_FIELD_OFFSET_Y<=e.height&&(i+=this.constants_.TALL_INPUT_FIELD_OFFSET_Y)):i=m.isInlineInput(t)?i+t.height/2:i+e.height/2,i}alignRowElements_(){if(this.isInline){var e=0,t=new WeakMap,i=null;for(let n,s=this.rows.length-1;n=this.rows[s];s--)t.set(n,e),m.isInputRow(n)&&(n.hasStatement&&this.alignStatementRow_(n),i&&i.hasStatement&&n.width<i.width?t.set(n,i.width):e=n.hasStatement?n.width:Math.max(e,n.width),i=n);e=0;for(let n,s=0;n=this.rows[s];s++)n.hasStatement?e=this.getDesiredRowWidth_(n):m.isSpacer(n)?n.width=Math.max(e,t.get(n)):(i=n.width,(e=Math.max(e,t.get(n))-i)>0&&this.addAlignmentPadding_(n,e),e=n.width)}else super.alignRowElements_()}getDesiredRowWidth_(e){return this.isInline&&e.hasStatement?this.statementEdge+this.constants_.MAX_BOTTOM_WIDTH+this.startX:super.getDesiredRowWidth_(e)}finalize_(){let e=0,t=0;for(let n,s=0;n=this.rows[s];s++){n.yPos=t,n.xPos=this.startX,t+=n.height,e=Math.max(e,n.widthWithConnectedBlocks);var i=t-this.topRow.ascenderHeight;n===this.bottomRow&&i<this.constants_.MIN_BLOCK_HEIGHT&&(this.bottomRow.height+=i=this.constants_.MIN_BLOCK_HEIGHT-i,t+=i),this.recordElemPositions_(n)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(i=this.block_.nextConnection.targetBlock())&&(e=Math.max(e,i.getHeightWidth().width-this.constants_.DARK_PATH_OFFSET)),this.bottomRow.baseline=t-this.bottomRow.descenderHeight,this.widthWithChildren=e+this.startX+this.constants_.DARK_PATH_OFFSET,this.width+=this.constants_.DARK_PATH_OFFSET,this.height=t+this.constants_.DARK_PATH_OFFSET,this.startY=this.topRow.capline}},xg=class extends uc{constructor(e,t,i){super(e,t,i),this.constants=i,this.colourDark="#000000",this.svgPathDark=I(f.PATH,{class:"blocklyPathDark",transform:"translate(1,1)"}),this.svgRoot.insertBefore(this.svgPathDark,this.svgPath),this.svgPathLight=I(f.PATH,{class:"blocklyPathLight"},this.svgRoot)}setPath(e){this.svgPath.setAttribute("d",e),this.svgPathDark.setAttribute("d",e)}setHighlightPath(e){this.svgPathLight.setAttribute("d",e)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)"),this.svgPathLight.setAttribute("transform","scale(-1 1)"),this.svgPathDark.setAttribute("transform","translate(1,1) scale(-1 1)")}applyColour(e){if(this.svgPathLight.style.display="",this.svgPathDark.style.display="",!this.style.colourTertiary)throw Error("The renderer did not properly initialize the tertiary colour of the block style");this.svgPathLight.setAttribute("stroke",this.style.colourTertiary),this.svgPathDark.setAttribute("fill",this.colourDark),super.applyColour(e),this.svgPath.setAttribute("stroke","none")}setStyle(e){this.style=e,this.colourDark=Mo("#000",this.style.colourPrimary,.2)||this.colourDark}updateHighlighted(e){super.updateHighlighted(e),this.svgPathLight.style.display=e?"none":"inline"}updateShadow_(e){if(e){if(this.svgPathLight.style.display="none",!this.style.colourSecondary)throw Error("The renderer did not properly initialize the secondary colour of the block style block style");this.svgPathDark.setAttribute("fill",this.style.colourSecondary),this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary)}}updateDisabled_(e){super.updateDisabled_(e),e&&this.svgPath.setAttribute("stroke","none")}},Ag=class extends dc{constructor(e){super(e),this.highlightConstants=null}init(e,t){super.init(e,t),this.highlightConstants=this.makeHighlightConstants_(),this.highlightConstants.init()}refreshDom(e,t,i){super.refreshDom(e,t,i),this.getHighlightConstants().init()}makeConstants_(){return new vg}makeRenderInfo_(e){return new wg(this,e)}makeDrawer_(e,t){return new Cg(e,t)}makePathObject(e,t){return new xg(e,t,this.getConstants())}makeHighlightConstants_(){return new Ig(this.getConstants())}getHighlightConstants(){if(!this.highlightConstants)throw Error("Cannot access the highlight constants because init has not been called");return this.highlightConstants}};vl("geras",Ag);var fo={};fo.ConstantProvider=vg,fo.Drawer=Cg,fo.HighlightConstantProvider=Ig,fo.Highlighter=yg,fo.InlineInput=kg,fo.PathObject=xg,fo.RenderInfo=wg,fo.Renderer=Ag,fo.StatementInput=Sg;var Rg=class extends Jn{constructor(e,t){super(e,t)}getRenderer(){return this.renderer_}addElemSpacing_(){let e=!1;for(var t=0;t<this.rows.length;t++)if(this.rows[t].hasExternalInput){e=!0;break}for(t=0;t<this.rows.length;t++){const s=this.rows[t];var i=s.elements;if(s.elements=[],s.startsWithElemSpacer()&&s.elements.push(new dt(this.constants_,this.getInRowSpacing_(null,i[0]))),i.length){for(let n=0;n<i.length-1;n++){s.elements.push(i[n]);const r=this.getInRowSpacing_(i[n],i[n+1]);s.elements.push(new dt(this.constants_,r))}s.elements.push(i[i.length-1]),s.endsWithElemSpacer()&&(i=this.getInRowSpacing_(i[i.length-1],null),e&&s.hasDummyInput&&(i+=this.constants_.TAB_WIDTH),s.elements.push(new dt(this.constants_,i)))}}}getInRowSpacing_(e,t){if(!e)return t&&m.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:t&&m.isInlineInput(t)?this.constants_.MEDIUM_LARGE_PADDING:t&&m.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!m.isInput(e)&&!t)return m.isField(e)&&e.isEditable?0===e.width?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:m.isIcon(e)?2*this.constants_.LARGE_PADDING+1:m.isHat(e)?this.constants_.NO_PADDING:m.isPreviousOrNextConnection(e)?this.constants_.LARGE_PADDING:m.isLeftRoundedCorner(e)?this.constants_.MIN_BLOCK_WIDTH:m.isJaggedEdge(e)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(m.isInput(e)&&!t){if(m.isExternalInput(e))return this.constants_.NO_PADDING;if(m.isInlineInput(e))return this.constants_.LARGE_PADDING;if(m.isStatementInput(e))return this.constants_.NO_PADDING}if(!m.isInput(e)&&t&&m.isInput(t)){if(m.isField(e)&&e.isEditable){if(m.isInlineInput(t)||m.isExternalInput(t))return this.constants_.SMALL_PADDING}else{if(m.isInlineInput(t)||m.isExternalInput(t))return this.constants_.MEDIUM_LARGE_PADDING;if(m.isStatementInput(t))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(m.isIcon(e)&&t&&!m.isInput(t))return this.constants_.LARGE_PADDING;if(m.isInlineInput(e)&&t&&m.isField(t))return t.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(m.isLeftSquareCorner(e)&&t){if(m.isHat(t))return this.constants_.NO_PADDING;if(m.isPreviousConnection(t)||m.isNextConnection(t))return t.notchOffset}return m.isLeftRoundedCorner(e)&&t?t.notchOffset-this.constants_.CORNER_RADIUS:m.isField(e)&&t&&m.isField(t)&&e.isEditable===t.isEditable?0===e.width?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING:t&&m.isJaggedEdge(t)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(e,t){return m.isTopRow(e)&&m.isBottomRow(t)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:m.isTopRow(e)||m.isBottomRow(t)?this.constants_.NO_PADDING:e.hasExternalInput&&t.hasExternalInput?this.constants_.LARGE_PADDING:!e.hasStatement&&t.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:e.hasStatement&&t.hasStatement||e.hasDummyInput||t.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){if(m.isSpacer(t))return e.yPos+t.height/2;if(m.isBottomRow(e))return e=e.yPos+e.height-e.descenderHeight,m.isNextConnection(t)?e+t.height/2:e-t.height/2;if(m.isTopRow(e))return m.isHat(t)?e.capline-t.height/2:e.capline+t.height/2;let i=e.yPos;return m.isField(t)&&e.hasStatement?i+(this.constants_.TALL_INPUT_FIELD_OFFSET_Y+t.height/2):i+e.height/2}finalize_(){let e=0,t=0;for(var i=0;i<this.rows.length;i++){const n=this.rows[i];n.yPos=t,n.xPos=this.startX,t+=n.height,e=Math.max(e,n.widthWithConnectedBlocks);var s=t-this.topRow.ascenderHeight;n===this.bottomRow&&s<this.constants_.MIN_BLOCK_HEIGHT&&(this.bottomRow.height+=s=this.constants_.MIN_BLOCK_HEIGHT-s,t+=s),this.recordElemPositions_(n)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(i=this.block_.nextConnection.targetBlock())&&(e=Math.max(e,i.getHeightWidth().width)),this.bottomRow.baseline=t-this.bottomRow.descenderHeight,this.widthWithChildren=e+this.startX,this.height=t,this.startY=this.topRow.capline}},Og=class extends dc{constructor(e){super(e)}makeRenderInfo_(e){return new Rg(this,e)}};vl("thrasos",Og);var Mg={};Mg.RenderInfo=Rg,Mg.Renderer=Og;var $_=new Li("zelos",{colour_blocks:{colourPrimary:"#CF63CF",colourSecondary:"#C94FC9",colourTertiary:"#BD42BD"},list_blocks:{colourPrimary:"#9966FF",colourSecondary:"#855CD6",colourTertiary:"#774DCB"},logic_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC"},loop_blocks:{colourPrimary:"#0fBD8C",colourSecondary:"#0DA57A",colourTertiary:"#0B8E69"},math_blocks:{colourPrimary:"#59C059",colourSecondary:"#46B946",colourTertiary:"#389438"},procedure_blocks:{colourPrimary:"#FF6680",colourSecondary:"#FF4D6A",colourTertiary:"#FF3355"},text_blocks:{colourPrimary:"#FFBF00",colourSecondary:"#E6AC00",colourTertiary:"#CC9900"},variable_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},variable_dynamic_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},hat_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC",hat:"cap"}},{colour_category:{colour:"#CF63CF"},list_category:{colour:"#9966FF"},logic_category:{colour:"#4C97FF"},loop_category:{colour:"#0fBD8C"},math_category:{colour:"#59C059"},procedure_category:{colour:"#FF6680"},text_category:{colour:"#FFBF00"},variable_category:{colour:"#FF8C1A"},variable_dynamic_category:{colour:"#FF8C1A"}}),xE={Classic:Xl,Zelos:$_},ju=class{constructor(e,t,i){this.id_=e.toolboxitemid||ze(),this.level_=(this.parent_=i||null)?this.parent_.getLevel()+1:0,this.toolboxItemDef_=e,this.parentToolbox_=t,this.workspace_=this.parentToolbox_.getWorkspace()}init(){}getDiv(){return null}getClickTarget(){return null}getId(){return this.id_}getParent(){return null}getLevel(){return this.level_}isSelectable(){return!1}isCollapsible(){return!1}dispose(){}setVisible_(e){}getFocusableElement(){const e=this.getDiv();if(!e)throw Error("Trying to access toolbox item before DOM is initialized.");if(!(e instanceof HTMLElement))throw Error("Toolbox item div is unexpectedly not an HTML element.");return e}getFocusableTree(){return this.parentToolbox_}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}},Ot=class extends ju{constructor(e,t,i){super(e,t,i),this.colour_=this.name_="",this.labelDom_=this.iconDom_=this.rowContents_=this.rowDiv_=this.htmlDiv_=null,this.isDisabled_=this.isHidden_=!1,this.flyoutItems_=[],this.cssConfig_=this.makeDefaultCssConfig_()}init(){this.parseCategoryDef_(this.toolboxItemDef_),this.parseContents_(this.toolboxItemDef_),this.createDom_(),"true"===this.toolboxItemDef_.hidden&&this.hide()}makeDefaultCssConfig_(){return{container:"blocklyToolboxCategoryContainer",row:"blocklyToolboxCategory",rowcontentcontainer:"blocklyTreeRowContentContainer",icon:"blocklyToolboxCategoryIcon",label:"blocklyToolboxCategoryLabel",contents:"blocklyToolboxCategoryGroup",selected:"blocklyToolboxSelected",openicon:"blocklyToolboxCategoryIconOpen",closedicon:"blocklyToolboxCategoryIconClosed"}}parseContents_(e){if("custom"in e)this.flyoutItems_=e.custom;else if(e=e.contents)for(let t=0;t<e.length;t++){const i=e[t];Array.isArray(this.flyoutItems_)&&this.flyoutItems_.push(i)}}parseCategoryDef_(e){this.name_="name"in e?l(e.name):"",this.colour_=this.getColour_(e),Object.assign(this.cssConfig_,e.cssconfig||e.cssConfig)}createDom_(){this.htmlDiv_=this.createContainer_(),Ut(this.htmlDiv_,mt.TREEITEM),Ee(this.htmlDiv_,ye.SELECTED,!1),Ee(this.htmlDiv_,ye.LEVEL,this.level_+1),this.rowDiv_=this.createRowContainer_(),this.rowDiv_.style.pointerEvents="auto",this.htmlDiv_.appendChild(this.rowDiv_),this.rowContents_=this.createRowContentsContainer_(),this.rowContents_.style.pointerEvents="none",this.rowDiv_.appendChild(this.rowContents_),this.iconDom_=this.createIconDom_(),Ut(this.iconDom_,mt.PRESENTATION),this.rowContents_.appendChild(this.iconDom_),this.labelDom_=this.createLabelDom_(this.name_),this.rowContents_.appendChild(this.labelDom_);const e=this.labelDom_.getAttribute("id");return e&&Ee(this.htmlDiv_,ye.LABELLEDBY,e),this.addColourBorder_(this.colour_),this.htmlDiv_}createContainer_(){const e=document.createElement("div");e.tabIndex=-1,e.id=this.getId();const t=this.cssConfig_.container;return t&&A(e,t),e}createRowContainer_(){const e=document.createElement("div");var t=this.cssConfig_.row;return t&&A(e,t),t=Ot.nestedPadding*this.getLevel()+"px",this.workspace_.RTL?e.style.paddingRight=t:e.style.paddingLeft=t,e}createRowContentsContainer_(){const e=document.createElement("div"),t=this.cssConfig_.rowcontentcontainer;return t&&A(e,t),e}createIconDom_(){const e=document.createElement("span");if(!this.parentToolbox_.isHorizontal()){const t=this.cssConfig_.icon;t&&A(e,t)}return e.style.display="inline-block",e}createLabelDom_(e){const t=document.createElement("span");return t.setAttribute("id",this.getId()+".label"),t.textContent=e,(e=this.cssConfig_.label)&&A(t,e),t}refreshTheme(){this.colour_=this.getColour_(this.toolboxItemDef_),this.addColourBorder_(this.colour_)}addColourBorder_(e){e&&(e=Ot.borderWidth+"px solid "+(e||"#ddd"),this.workspace_.RTL?this.rowDiv_.style.borderRight=e:this.rowDiv_.style.borderLeft=e)}getColour_(e){const t=e.categorystyle||e.categoryStyle;if((e=e.colour)&&t)console.warn('Toolbox category "'+this.name_+'" must not have both a style and a colour');else{if(t)return this.getColourfromStyle(t);if(e)return this.parseColour(e)}return""}getColourfromStyle(e){var t=this.workspace_.getTheme();if(e&&t){if((t=t.categoryStyles[e])&&t.colour)return this.parseColour(t.colour);console.warn('Style "'+e+'" must exist and contain a colour value')}return""}getClickTarget(){return this.rowDiv_}parseColour(e){if(null==(e=l(e))||""===e)return"";var t=Number(e);return isNaN(t)?(t=mi(e))?t:(console.warn('Toolbox category "'+this.name_+'" has unrecognized colour attribute: '+e),""):Vr(t)}openIcon_(e){if(e){var t=this.cssConfig_.closedicon;t&&ji(e,t),(t=this.cssConfig_.openicon)&&A(e,t)}}closeIcon_(e){if(e){var t=this.cssConfig_.openicon;t&&ji(e,t),(t=this.cssConfig_.closedicon)&&A(e,t)}}setVisible_(e){this.htmlDiv_.style.display=e?"block":"none",this.isHidden_=!e,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}hide(){this.setVisible_(!1)}show(){this.setVisible_(!0)}isVisible(){return!this.isHidden_&&this.allAncestorsExpanded_()}allAncestorsExpanded_(){let e=this;for(;e.getParent();)if(e=e.getParent(),!e.isExpanded())return!1;return!0}isSelectable(){return this.isVisible()&&!this.isDisabled_}onClick(e){}setSelected(e){if(this.rowDiv_){var t=this.cssConfig_.selected;if(e){const i=this.parseColour(Ot.defaultBackgroundColour);this.rowDiv_.style.backgroundColor=this.colour_||i,t&&A(this.rowDiv_,t)}else this.rowDiv_.style.backgroundColor="",t&&X(this.rowDiv_,t);Ee(this.htmlDiv_,ye.SELECTED,e)}}setDisabled(e){this.isDisabled_=e,this.getDiv().setAttribute("disabled",`${e}`),e?this.getDiv().setAttribute("disabled","true"):this.getDiv().removeAttribute("disabled")}getName(){return this.name_}getParent(){return this.parent_}getDiv(){return this.htmlDiv_}getContents(){return this.flyoutItems_}updateFlyoutContents(e){this.flyoutItems_=[],this.toolboxItemDef_="string"==typeof e?{kind:this.toolboxItemDef_.kind,custom:e,id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden}:{kind:this.toolboxItemDef_.kind,name:"name"in this.toolboxItemDef_?this.toolboxItemDef_.name:"",contents:ln(e),id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden},this.parseContents_(this.toolboxItemDef_)}dispose(){J(this.htmlDiv_)}};Ot.registrationName="category",Ot.nestedPadding=19,Ot.borderWidth=8,Ot.defaultBackgroundColour="#57e",Pt('\n.blocklyToolboxCategory:not(.blocklyToolboxSelected):hover {\n  background-color: rgba(255, 255, 255, .2);\n}\n\n.blocklyToolbox[layout="h"] .blocklyToolboxCategoryContainer {\n  margin: 1px 5px 1px 0;\n}\n\n.blocklyToolbox[dir="RTL"][layout="h"] .blocklyToolboxCategoryContainer {\n  margin: 1px 0 1px 5px;\n}\n\n.blocklyToolboxCategory {\n  height: 22px;\n  line-height: 22px;\n  margin-bottom: 3px;\n  padding-right: 8px;\n  white-space: nowrap;\n}\n\n.blocklyToolbox[dir="RTL"] .blocklyToolboxCategory {\n  margin-left: 8px;\n  padding-right: 0;\n}\n\n.blocklyToolboxCategoryIcon {\n  background-image: url(<<<PATH>>>/sprites.png);\n  height: 16px;\n  vertical-align: middle;\n  visibility: hidden;\n  width: 16px;\n}\n\n.blocklyToolboxCategoryIconClosed {\n  background-position: -32px -1px;\n}\n\n.blocklyToolbox[dir="RTL"] .blocklyToolboxCategoryIconClosed {\n  background-position: 0 -1px;\n}\n\n.blocklyToolboxSelected>.blocklyToolboxCategoryIconClosed {\n  background-position: -32px -17px;\n}\n\n.blocklyToolbox[dir="RTL"] .blocklyToolboxSelected>.blocklyToolboxCategoryIconClosed {\n  background-position: 0 -17px;\n}\n\n.blocklyToolboxCategoryIconOpen {\n  background-position: -16px -1px;\n}\n\n.blocklyToolboxSelected>.blocklyToolboxCategoryIconOpen {\n  background-position: -16px -17px;\n}\n\n.blocklyToolboxCategoryLabel {\n  cursor: default;\n  font: 16px sans-serif;\n  padding: 0 3px;\n  vertical-align: middle;\n}\n\n.blocklyToolboxDelete .blocklyToolboxCategoryLabel {\n  cursor: url("<<<PATH>>>/handdelete.cur"), auto;\n}\n\n.blocklyToolboxSelected .blocklyToolboxCategoryLabel {\n  color: #fff;\n}\n'),U(k.TOOLBOX_ITEM,Ot.registrationName,Ot);var or=class extends ju{constructor(e,t){super(e,t),this.cssConfig_={container:"blocklyTreeSeparator"},this.htmlDiv=null,Object.assign(this.cssConfig_,e.cssconfig||e.cssConfig)}init(){this.createDom_()}createDom_(){const e=document.createElement("div");e.tabIndex=-1,e.id=this.getId();const t=this.cssConfig_.container;return t&&A(e,t),this.htmlDiv=e}getDiv(){return this.htmlDiv}dispose(){J(this.htmlDiv)}};or.registrationName="sep",Pt('\n.blocklyTreeSeparator {\n  border-bottom: solid #e5e5e5 1px;\n  height: 0;\n  margin: 5px 0;\n}\n\n.blocklyToolbox[layout="h"] .blocklyTreeSeparator {\n  border-right: solid #e5e5e5 1px;\n  border-bottom: none;\n  height: auto;\n  margin: 0 5px 0 5px;\n  padding: 5px 0;\n  width: 0;\n}\n'),U(k.TOOLBOX_ITEM,or.registrationName,or);var Fs=class extends Ot{constructor(e,t,i){super(e,t,i),this.subcategoriesDiv_=null,this.expanded_=!1,this.toolboxItems_=[]}makeDefaultCssConfig_(){const e=super.makeDefaultCssConfig_();return e.contents="blocklyToolboxCategoryGroup",e}parseContents_(e){if("custom"in e)this.flyoutItems_=e.custom;else{const t=e.contents;if(t){this.flyoutItems_=[],e=!0;for(let i=0;i<t.length;i++){const s=t[i];!ti(k.TOOLBOX_ITEM,s.kind)||s.kind.toLowerCase()===or.registrationName&&e?(this.flyoutItems_.push(s),e=!0):(this.createToolboxItem(s),e=!1)}}}}createToolboxItem(e){let t=e.kind;"CATEGORY"===t.toUpperCase()&&ar(e)&&(t=Fs.registrationName),e=new(tt(k.TOOLBOX_ITEM,t))(e,this.parentToolbox_,this),this.toolboxItems_.push(e)}init(){super.init(),this.setExpanded("true"===this.toolboxItemDef_.expanded||!0===this.toolboxItemDef_.expanded)}createDom_(){super.createDom_();const e=this.getChildToolboxItems();return this.subcategoriesDiv_=this.createSubCategoriesDom_(e),Ut(this.subcategoriesDiv_,mt.GROUP),this.htmlDiv_.appendChild(this.subcategoriesDiv_),this.closeIcon_(this.iconDom_),Ee(this.htmlDiv_,ye.EXPANDED,!1),this.htmlDiv_}createIconDom_(){const e=document.createElement("span");if(!this.parentToolbox_.isHorizontal()){const t=this.cssConfig_.icon;t&&A(e,t),e.style.visibility="visible"}return e.style.display="inline-block",e}createSubCategoriesDom_(e){const t=document.createElement("div");t.style.display="none";var i=this.cssConfig_.contents;for(i&&A(t,i),i=0;i<e.length;i++){const s=e[i];s.init();const n=s.getDiv();if(t.appendChild(n),s.getClickTarget){let r;null==(r=s.getClickTarget())||r.setAttribute("id",s.getId())}}return t}setExpanded(e){if(this.expanded_!==e){if(this.expanded_=e)this.subcategoriesDiv_.style.display="block",this.openIcon_(this.iconDom_);else{let t;null==(t=this.parentToolbox_.getFlyout())||t.setVisible(!1),this.subcategoriesDiv_.style.display="none",this.closeIcon_(this.iconDom_)}Ee(this.htmlDiv_,ye.EXPANDED,e),this.parentToolbox_.handleToolboxItemResize()}}setVisible_(e){this.htmlDiv_.style.display=e?"block":"none";const t=this.getChildToolboxItems();for(let i=0;i<t.length;i++)t[i].setVisible_(e);this.isHidden_=!e,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}isExpanded(){return this.expanded_}isCollapsible(){return!0}onClick(e){this.toggleExpanded()}toggleExpanded(){this.setExpanded(!this.expanded_)}getDiv(){return this.htmlDiv_}getChildToolboxItems(){return this.toolboxItems_}};Fs.registrationName="collapsibleCategory",U(k.TOOLBOX_ITEM,Fs.registrationName,Fs);var Ng=class extends ec{constructor(e){super(),this.id="toolbox",this.contentsDiv_=this.HtmlDiv=null,this.isVisible_=!1,this.height_=this.width_=0,this.flyout=null,this.contents=new Map,this.previouslySelectedItem_=this.selectedItem_=null,this.boundEvents_=[],this.workspace_=e,this.toolboxDef_=e.options.languageTree||{contents:[]},this.horizontalLayout=e.options.horizontalLayout,this.RTL=e.options.RTL,this.toolboxPosition=e.options.toolboxPosition}onShortcut(e){return!1}init(){var e=this.workspace_;const t=e.getParentSvg();this.flyout=this.createFlyout_(),this.HtmlDiv=this.createDom_(this.workspace_);const i=this.flyout.createDom("svg");A(i,"blocklyToolboxFlyout"),c(i,t),this.setVisible(!0),this.flyout.init(e),this.render(this.toolboxDef_),(e=e.getThemeManager()).subscribe(this.HtmlDiv,"toolboxBackgroundColour","background-color"),e.subscribe(this.HtmlDiv,"toolboxForegroundColour","color"),this.workspace_.getComponentManager().addComponent({component:this,weight:de.ComponentWeight.TOOLBOX_WEIGHT,capabilities:[de.Capability.AUTOHIDEABLE,de.Capability.DELETE_AREA,de.Capability.DRAG_TARGET]}),o.getFocusManager$$module$build$src$core$focus_manager().registerTree(this,!0)}createDom_(e){e=e.getParentSvg();const t=this.createContainer_();return t.id=ze(),this.contentsDiv_=this.createContentsContainer_(),Ut(this.contentsDiv_,mt.TREE),t.appendChild(this.contentsDiv_),e.parentNode.insertBefore(t,e),this.attachEvents_(t,this.contentsDiv_),t}createContainer_(){const e=document.createElement("div");return e.setAttribute("layout",this.isHorizontal()?"h":"v"),A(e,"blocklyToolbox"),e.setAttribute("dir",this.RTL?"RTL":"LTR"),e}createContentsContainer_(){const e=document.createElement("div");return A(e,"blocklyToolboxCategoryGroup"),this.isHorizontal()&&(e.style.flexDirection="row"),e}attachEvents_(e,t){e=L(e,"pointerdown",this,this.onClick_,!1),this.boundEvents_.push(e),t=L(t,"keydown",this,this.onKeyDown_,!1),this.boundEvents_.push(t)}onClick_(e){if(ot(e)||e.target===this.HtmlDiv)st().hideChaff(!1);else{var t=e.target.getAttribute("id");t&&(t=this.getToolboxItemById(t)).isSelectable()&&(this.setSelectedItem(t),t.onClick(e)),st().hideChaff(!0)}Ae()}onKeyDown_(e){let t=!1;switch(e.key){case"ArrowDown":t=this.selectNext();break;case"ArrowUp":t=this.selectPrevious();break;case"ArrowLeft":t=this.selectParent();break;case"ArrowRight":t=this.selectChild();break;case"Enter":case" ":this.selectedItem_&&this.selectedItem_.isCollapsible()&&(this.selectedItem_.toggleExpanded(),t=!0);break;default:t=!1}!t&&this.selectedItem_&&this.selectedItem_.onKeyDown&&(t=this.selectedItem_.onKeyDown(e)),t&&e.preventDefault()}createFlyout_(){const e=this.workspace_,t=e.copyOptionsForFlyout();return t.toolboxPosition=e.options.toolboxPosition,new(xe(e.horizontalLayout?k.FLYOUTS_HORIZONTAL_TOOLBOX:k.FLYOUTS_VERTICAL_TOOLBOX,e.options,!0))(t)}render(e){this.toolboxDef_=e,this.contents.forEach(t=>t.dispose()),this.contents.clear(),this.renderContents_(e.contents),this.position(),this.handleToolboxItemResize()}renderContents_(e){const t=document.createDocumentFragment();for(let i=0;i<e.length;i++)this.createToolboxItem(e[i],t);this.contentsDiv_.appendChild(t)}createToolboxItem(e,t){var i=e.kind;"CATEGORY"===i.toUpperCase()&&ar(e)&&(i=Fs.registrationName),(i=tt(k.TOOLBOX_ITEM,i.toLowerCase()))&&((e=new i(e,this)).init(),this.addToolboxItem_(e),(i=e.getDiv())&&t.appendChild(i),e.getClickTarget()&&e.getClickTarget().setAttribute("id",e.getId()))}addToolboxItem_(e){if(this.contents.set(e.getId(),e),e.isCollapsible()){e=e.getChildToolboxItems();for(let t=0;t<e.length;t++)this.addToolboxItem_(e[t])}}getToolboxItems(){return[...this.contents.values()]}addStyle(e){e&&this.HtmlDiv&&A(this.HtmlDiv,e)}removeStyle(e){e&&this.HtmlDiv&&X(this.HtmlDiv,e)}getClientRect(){if(!this.HtmlDiv||!this.isVisible_)return null;var e=this.HtmlDiv.getBoundingClientRect();const t=e.top,i=t+e.height,s=e.left;return e=s+e.width,this.toolboxPosition===G.TOP?new z(-1e7,i,-1e7,1e7):this.toolboxPosition===G.BOTTOM?new z(t,1e7,-1e7,1e7):this.toolboxPosition===G.LEFT?new z(-1e7,1e7,-1e7,e):new z(-1e7,1e7,s,1e7)}wouldDelete(e){return this.updateWouldDelete_(e instanceof ie?!e.getParent()&&e.isDeletable():Xe(e)&&e.isDeletable()),this.wouldDelete_}onDragEnter(e){this.updateCursorDeleteStyle_(!0)}onDragExit(e){this.updateCursorDeleteStyle_(!1)}onDrop(e){this.updateCursorDeleteStyle_(!1)}updateWouldDelete_(e){e!==this.wouldDelete_&&(this.updateCursorDeleteStyle_(!1),this.wouldDelete_=e,this.updateCursorDeleteStyle_(!0))}updateCursorDeleteStyle_(e){const t=this.wouldDelete_?"blocklyToolboxDelete":"blocklyToolboxGrab";e?this.addStyle(t):this.removeStyle(t)}getToolboxItemById(e){return this.contents.get(e)||null}getWidth(){return this.width_}getHeight(){return this.height_}getFlyout(){return this.flyout}getWorkspace(){return this.workspace_}getSelectedItem(){return this.selectedItem_}getPreviouslySelectedItem(){return this.previouslySelectedItem_}isHorizontal(){return this.horizontalLayout}position(){const e=this.workspace_.getMetrics(),t=this.HtmlDiv;t&&(this.horizontalLayout?(t.style.left="0",t.style.height="auto",t.style.width="100%",this.height_=t.offsetHeight,this.width_=e.viewWidth,this.toolboxPosition===G.TOP?t.style.top="0":t.style.bottom="0"):(this.toolboxPosition===G.RIGHT?t.style.right="0":t.style.left="0",t.style.height="100%",this.width_=t.offsetWidth,this.height_=e.viewHeight),this.flyout.position())}handleToolboxItemResize(){const e=this.workspace_;var t=this.HtmlDiv.getBoundingClientRect();const i=this.getFlyout(),s=this.toolboxPosition===G.LEFT?e.scrollX+t.width+(null!=i&&i.isVisible()?i.getWidth():0):e.scrollX;t=this.toolboxPosition===G.TOP?e.scrollY+t.height+(null!=i&&i.isVisible()?i.getHeight():0):e.scrollY,e.translate(s,t),wo(e)}clearSelection(){this.setSelectedItem(null)}refreshTheme(){this.contents.forEach(e=>{e.refreshTheme&&e.refreshTheme()})}refreshSelection(){this.selectedItem_&&this.selectedItem_.isSelectable()&&this.selectedItem_.getContents().length&&this.flyout.show(this.selectedItem_.getContents())}setVisible(e){this.isVisible_!==e&&(this.HtmlDiv.style.display=e?"block":"none",this.isVisible_=e,this.workspace_.recordDragTargets())}autoHide(e){!e&&this.flyout&&this.flyout.autoClose&&this.clearSelection()}setSelectedItem(e){const t=this.selectedItem_;!e&&!t||e&&!Rh(e)||(this.shouldDeselectItem_(t,e)&&null!==t&&this.deselectItem_(t),this.shouldSelectItem_(t,e)&&null!==e&&this.selectItem_(t,e),this.updateFlyout_(t,e),this.fireSelectEvent(t,e))}shouldDeselectItem_(e,t){return null!==e&&(!e.isCollapsible()||e!==t)}shouldSelectItem_(e,t){return null!==t&&t!==e}deselectItem_(e){this.selectedItem_=null,this.previouslySelectedItem_=e,e.setSelected(!1),Ee(this.contentsDiv_,ye.ACTIVEDESCENDANT,"")}selectItem_(e,t){this.selectedItem_=t,this.previouslySelectedItem_=e,t.setSelected(!0),Ee(this.contentsDiv_,ye.ACTIVEDESCENDANT,t.getId())}selectItemByPosition(e){(e=this.getToolboxItems()[e])&&this.setSelectedItem(e)}updateFlyout_(e,t){t&&(e!==t||t.isCollapsible())&&t.getContents().length?(this.flyout.show(t.getContents()),this.flyout.scrollToStart()):this.flyout.hide()}fireSelectEvent(e,t){const i=e&&e.getName();let s=t&&t.getName();e===t&&(s=null),e=new(P(b.TOOLBOX_ITEM_SELECT))(i,s,this.workspace_.id),B(e)}selectParent(){return!(!this.selectedItem_||(this.selectedItem_.isCollapsible()&&this.selectedItem_.isExpanded()?(this.selectedItem_.toggleExpanded(),0):!this.selectedItem_.getParent()||!this.selectedItem_.getParent().isSelectable()||(this.setSelectedItem(this.selectedItem_.getParent()),0)))}selectChild(){if(!this.selectedItem_||!this.selectedItem_.isCollapsible())return!1;const e=this.selectedItem_;return e.isExpanded()?this.selectNext():e.toggleExpanded(),!0}selectNext(){if(!this.selectedItem_)return!1;const e=[...this.contents.values()];let t=e.indexOf(this.selectedItem_)+1;if(t>-1&&t<e.length){let i=e[t];for(;i&&!i.isSelectable();)i=e[++t];if(i&&i.isSelectable())return this.setSelectedItem(i),!0}return!1}selectPrevious(){if(!this.selectedItem_)return!1;const e=[...this.contents.values()];let t=e.indexOf(this.selectedItem_)-1;if(t>-1&&t<e.length){let i=e[t];for(;i&&!i.isSelectable();)i=e[--t];if(i&&i.isSelectable())return this.setSelectedItem(i),!0}return!1}dispose(){this.workspace_.getComponentManager().removeComponent("toolbox"),this.flyout.dispose(),this.contents.forEach(e=>e.dispose());for(let e=0;e<this.boundEvents_.length;e++)K(this.boundEvents_[e]);this.boundEvents_=[],this.contents.clear(),this.HtmlDiv&&(this.workspace_.getThemeManager().unsubscribe(this.HtmlDiv),J(this.HtmlDiv)),o.getFocusManager$$module$build$src$core$focus_manager().unregisterTree(this)}getFocusableElement(){if(!this.HtmlDiv)throw Error("Toolbox DOM has not yet been created.");return this.HtmlDiv}getFocusableTree(){return this}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}getRootFocusableNode(){return this}getRestoredFocusableNode(e){if(!e||e===this){let t;return null!=(t=this.getToolboxItems().find(i=>i.isSelectable()))?t:null}return null}getNestedTrees(){return[]}lookUpFocusableNode(e){return this.getToolboxItemById(e)}onTreeFocus(e,t){e!==this?this.getSelectedItem()!==e&&this.setSelectedItem(e):this.clearSelection()}onTreeBlur(e){let t;e&&e===(null==(t=this.flyout)?void 0:t.getWorkspace())||(this.clearSelection(),this.flyout&&Oe(this.flyout)&&this.flyout.autoHide(!1))}};Pt('\n.blocklyToolboxDelete {\n  cursor: url("<<<PATH>>>/handdelete.cur"), auto;\n}\n\n.blocklyToolboxGrab {\n  cursor: url("<<<PATH>>>/handclosed.cur"), auto;\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n}\n\n/* Category tree in Toolbox. */\n.blocklyToolbox {\n  box-sizing: border-box;\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n  background-color: #ddd;\n  overflow-x: visible;\n  overflow-y: auto;\n  padding: 4px 0 4px 0;\n  position: absolute;\n  z-index: 70;  /* so blocks go under toolbox when dragging */\n  -webkit-tap-highlight-color: transparent;  /* issue #1345 */\n}\n\n.blocklyToolboxCategoryGroup {\n  display: flex;\n  flex-wrap: wrap;\n  flex-direction: column;\n}\n\n.blocklyToolboxCategoryGroup:focus {\n  outline: none;\n}\n'),U(k.TOOLBOX,ct,Ng);var BE=N.INPUT_VALUE,PE=N.OUTPUT_VALUE,FE=N.NEXT_STATEMENT,UE=N.PREVIOUS_STATEMENT,HE=G.TOP,VE=G.BOTTOM,GE=G.LEFT,ZE=G.RIGHT;Ds.prototype.newBlock=function(e,t){return new Ms(this,e,t)},Ze.prototype.newBlock=function(e,t){return new ie(this,e,t)},Ds.prototype.newComment=function(e){return new jl(this,e)},Ze.prototype.newComment=function(e){return new jt(this,e)},Ze.newTrashcan=function(e){return new eg(e)},go.prototype.newWorkspaceSvg=function(e){return new Ze(e)},o.Names$$module$build$src$core$names.prototype.populateProcedures=function(e){e=(e=Tl(e))[0].concat(e[1]);for(let t=0;t<e.length;t++)this.getName(e[t][0],o.Names$$module$build$src$core$names.NameType.PROCEDURE)};var E={};return E.Block=Ms,E.BlockFlyoutInflater=Eg,E.BlockNavigationPolicy=Ap,E.BlockSvg=ie,E.Blocks=ue,E.ButtonFlyoutInflater=fg,E.COLLAPSED_FIELD_NAME=Pl,E.COLLAPSED_INPUT_NAME=Bn,E.COLLAPSE_CHARS=30,E.CodeGenerator=o.CodeGenerator$$module$build$src$core$generator,E.CollapsibleToolboxCategory=Fs,E.ComponentManager=de,E.Connection=Y,E.ConnectionChecker=Yp,E.ConnectionDB=Rs,E.ConnectionNavigationPolicy=Op,E.ConnectionType=N,E.ContextMenu=As,E.ContextMenuItems=De,E.ContextMenuRegistry=W,E.Css=Wh,E.DELETE_VARIABLE_ID=Kl,E.DeleteArea=ec,E.DragTarget=Ip,E.DropDownDiv=Ge,E.Events=R,E.Extensions=Yt,E.Field=Q,E.FieldCheckbox=Gi,E.FieldDropdown=He,E.FieldImage=Hi,E.FieldLabel=Di,E.FieldLabelSerializable=$g,E.FieldNavigationPolicy=Mp,E.FieldNumber=Mu,E.FieldTextInput=o.FieldTextInput$$module$build$src$core$field_textinput,E.FieldVariable=tr,E.Flyout=oc,E.FlyoutButton=Je,E.FlyoutButtonNavigationPolicy=Sp,E.FlyoutItem=Ns,E.FlyoutMetricsManager=kp,E.FlyoutNavigationPolicy=wp,E.FlyoutNavigator=Lp,E.FlyoutSeparator=tc,E.FlyoutSeparatorNavigationPolicy=xp,E.FocusManager=Ue,E.FocusableTreeTraverser=Me,E.Generator=o.CodeGenerator$$module$build$src$core$generator,E.Gesture=sc,E.Grid=uu,E.HorizontalFlyout=gg,E.INPUT_VALUE=BE,E.Input=Os,E.InsertionMarkerPreviewer=pg,E.KeyboardNavigationController=Bp,E.LabelFlyoutInflater=ng,E.LineCursor=du,E.Marker=Fp,E.MarkerManager=hu,E.Menu=Oa,E.MenuItem=Bl,E.MetricsManager=lu,E.Msg=o.Msg$$module$build$src$core$msg,E.NEXT_STATEMENT=FE,E.Names=o.Names$$module$build$src$core$names,E.Navigator=cu,E.OPPOSITE_TYPE=Yo,E.OUTPUT_VALUE=PE,E.Options=Xt,E.PREVIOUS_STATEMENT=UE,E.PROCEDURE_CATEGORY_NAME=nc,E.Procedures=Qe,E.RENAME_VARIABLE_ID=Yl,E.RenderedConnection=Le,E.Scrollbar=_e,E.ScrollbarPair=au,E.SeparatorFlyoutInflater=Dp,E.ShortcutItems=_o,E.ShortcutRegistry=ne,E.TOOLBOX_AT_BOTTOM=VE,E.TOOLBOX_AT_LEFT=GE,E.TOOLBOX_AT_RIGHT=ZE,E.TOOLBOX_AT_TOP=HE,E.Theme=Li,E.ThemeManager=Xp,E.Themes=xE,E.Toast=Ai,E.Toolbox=Ng,E.ToolboxCategory=Ot,E.ToolboxItem=ju,E.ToolboxSeparator=or,E.Tooltip=_t,E.Touch=Es,E.Trashcan=eg,E.UnattachedFieldError=fe,E.VARIABLE_CATEGORY_NAME=La,E.VARIABLE_DYNAMIC_CATEGORY_NAME=vu,E.VERSION="12.2.0",E.VariableMap=Qp,E.VariableModel=Jp,E.Variables=ve,E.VariablesDynamic=Fi,E.VerticalFlyout=Ou,E.WidgetDiv=zt,E.Workspace=Ds,E.WorkspaceAudio=Kp,E.WorkspaceDragger=Pp,E.WorkspaceNavigationPolicy=Np,E.WorkspaceSvg=Ze,E.Xml=Ke,E.ZoomControls=jh,E.blockAnimations=Ql,E.blockRendering=te,E.browserEvents=Zo,E.bubbles=mc,E.bumpObjects=ru,E.clipboard=eo,E.comments=Ui,E.common=Ne,E.config=o.config$$module$build$src$core$config,E.constants=Y_,E.defineBlocksWithJsonArray=nr,E.dialog=jo,E.dragging=$c,E.fieldRegistry=tu,E.geras=fo,E.getFocusManager=o.getFocusManager$$module$build$src$core$focus_manager,E.getMainWorkspace=st,E.getSelected=Ki,E.hasBubble=Oo,E.hideChaff=s$,E.icons=Bi,E.inject=ah,E.inputs=Vi,E.isCopyable=Ln,E.isDeletable=Xe,E.isDraggable=V,E.isIcon=_s,E.isObservable=fl,E.isPaster=xh,E.isRenderedElement=Ah,E.isSelectable=Qs,E.isSerializable=es,E.isVariableBackedParameterModel=br,E.keyboardNavigationController=ic,E.layers=nb,E.navigateBlock=H,E.navigateStacks=Ho,E.procedures=Qe,E.registry=Go,E.renderManagement=Na,E.serialization=wT,E.setLocale=op,E.setParentContainer=sr,E.svgResize=wo,E.thrasos=Mg,E.uiPosition=Is,E.utils=$e,E.zelos=bo,E.__namespace__=o,E})?le.apply(oo,[]):le)&&(Qo.exports=Be)},8927:function(Qo,oo,le){var Z,Be,o;Be=[le(7519)],Z=function(U){var u=U.__namespace__,et=u.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"variables_get_dynamic",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_dynamic_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableDynamicSetterGetter"]},{type:"variables_set_dynamic",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_dynamic_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableDynamicSetterGetter"]}]),ei={customContextMenu:function(c){if(this.isInFlyout)("variables_get_dynamic"===this.type||"variables_get_reporter_dynamic"===this.type)&&(_={text:u.Msg$$module$build$src$core$msg.RENAME_VARIABLE,enabled:!0,callback:ti(this)},T=this.getField("VAR").getText(),T={text:u.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",T),enabled:!0,callback:tt(this)},c.unshift(_),c.unshift(T));else{if("variables_get_dynamic"===this.type)var h="variables_set_dynamic",_=u.Msg$$module$build$src$core$msg.VARIABLES_GET_CREATE_SET;else h="variables_get_dynamic",_=u.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET;var T=this.getField("VAR");h={type:h,fields:{VAR:T.saveState(!0)}},c.push({enabled:this.workspace.remainingCapacity()>0,text:_.replace("%1",T.getText()),callback:u.callbackFactory$$module$build$src$core$contextmenu(this,h)})}},onchange:function(c){c=this.getFieldValue("VAR"),c=u.getVariable$$module$build$src$core$variables(this.workspace,c),"variables_get_dynamic"===this.type?this.outputConnection.setCheck(c.getType()):this.getInput("VALUE").connection.setCheck(c.getType())}},ti=function(c){return function(){const h=c.workspace,_=c.getField("VAR").getVariable();u.renameVariable$$module$build$src$core$variables(h,_)}},tt=function(c){return function(){const h=c.getField("VAR").getVariable();h&&u.deleteVariable$$module$build$src$core$variables(h.getWorkspace(),h,c)}};u.registerMixin$$module$build$src$core$extensions("contextMenu_variableDynamicSetterGetter",ei),u.defineBlocks$$module$build$src$core$common(et);var Tt={blocks:et},io=u.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"variables_get",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableSetterGetter"]},{type:"variables_set",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableSetterGetter"]}]),xe={customContextMenu:function(c){if(this.isInFlyout)("variables_get"===this.type||"variables_get_reporter"===this.type)&&(_={text:u.Msg$$module$build$src$core$msg.RENAME_VARIABLE,enabled:!0,callback:so(this)},T=this.getField("VAR").getText(),T={text:u.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",T),enabled:!0,callback:it(this)},c.unshift(_),c.unshift(T));else{if("variables_get"===this.type)var h="variables_set",_=u.Msg$$module$build$src$core$msg.VARIABLES_GET_CREATE_SET;else h="variables_get",_=u.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET;var T=this.getField("VAR");h={type:h,fields:{VAR:T.saveState(!0)}},c.push({enabled:this.workspace.remainingCapacity()>0,text:_.replace("%1",T.getText()),callback:u.callbackFactory$$module$build$src$core$contextmenu(this,h)})}}},so=function(c){return function(){const h=c.workspace,_=c.getField("VAR").getVariable();u.renameVariable$$module$build$src$core$variables(h,_)}},it=function(c){return function(){const h=c.getField("VAR").getVariable();h&&u.deleteVariable$$module$build$src$core$variables(h.getWorkspace(),h,c)}};u.registerMixin$$module$build$src$core$extensions("contextMenu_variableSetterGetter",xe),u.defineBlocks$$module$build$src$core$common(io);var Ae={blocks:io},Ie=u.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"text",message0:"%1",args0:[{type:"field_input",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["text_quotes","parent_tooltip_when_inline"]},{type:"text_join",message0:"",output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_JOIN_HELPURL}",tooltip:"%{BKY_TEXT_JOIN_TOOLTIP}",mutator:"text_join_mutator"},{type:"text_create_join_container",message0:"%{BKY_TEXT_CREATE_JOIN_TITLE_JOIN} %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"STACK"}],style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_TOOLTIP}",enableContextMenu:!1},{type:"text_create_join_item",message0:"%{BKY_TEXT_CREATE_JOIN_ITEM_TITLE_ITEM}",previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_ITEM_TOOLTIP}",enableContextMenu:!1},{type:"text_append",message0:"%{BKY_TEXT_APPEND_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_TEXT_APPEND_VARIABLE}"},{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",extensions:["text_append_tooltip"]},{type:"text_length",message0:"%{BKY_TEXT_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"text_blocks",tooltip:"%{BKY_TEXT_LENGTH_TOOLTIP}",helpUrl:"%{BKY_TEXT_LENGTH_HELPURL}"},{type:"text_isEmpty",message0:"%{BKY_TEXT_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"text_blocks",tooltip:"%{BKY_TEXT_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_TEXT_ISEMPTY_HELPURL}"},{type:"text_indexOf",message0:"%{BKY_TEXT_INDEXOF_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"END",options:[["%{BKY_TEXT_INDEXOF_OPERATOR_FIRST}","FIRST"],["%{BKY_TEXT_INDEXOF_OPERATOR_LAST}","LAST"]]},{type:"input_value",name:"FIND",check:"String"}],output:"Number",style:"text_blocks",helpUrl:"%{BKY_TEXT_INDEXOF_HELPURL}",inputsInline:!0,extensions:["text_indexOf_tooltip"]},{type:"text_charAt",message0:"%{BKY_TEXT_CHARAT_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"WHERE",options:[["%{BKY_TEXT_CHARAT_FROM_START}","FROM_START"],["%{BKY_TEXT_CHARAT_FROM_END}","FROM_END"],["%{BKY_TEXT_CHARAT_FIRST}","FIRST"],["%{BKY_TEXT_CHARAT_LAST}","LAST"],["%{BKY_TEXT_CHARAT_RANDOM}","RANDOM"]]}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_CHARAT_HELPURL}",inputsInline:!0,mutator:"text_charAt_mutator"}]);Ie.text_getSubstring={init:function(){this.WHERE_OPTIONS_1=[[u.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FROM_START,"FROM_START"],[u.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FROM_END,"FROM_END"],[u.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[u.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_FROM_START,"FROM_START"],[u.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_FROM_END,"FROM_END"],[u.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_LAST,"LAST"]],this.setHelpUrl(u.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("STRING").setCheck("String").appendField(u.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT);const c=h=>{const _=u.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this["WHERE_OPTIONS_"+h]});return _.setValidator(function(T){const w=this.getValue();(T="FROM_START"===T||"FROM_END"===T)!=("FROM_START"===w||"FROM_END"===w)&&this.getSourceBlock().updateAt_(h,T)}),_};this.appendDummyInput("WHERE1_INPUT").appendField(c(1),"WHERE1"),this.appendDummyInput("AT1"),this.appendDummyInput("WHERE2_INPUT").appendField(c(2),"WHERE2"),this.appendDummyInput("AT2"),u.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL&&this.appendDummyInput("TAIL").appendField(u.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL),this.setInputsInline(!0),this.setOutput(!0,"String"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(u.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TOOLTIP)},mutationToDom:function(){const c=u.createElement$$module$build$src$core$utils$xml("mutation");var h=this.getInput("AT1")instanceof u.ValueInput$$module$build$src$core$inputs$value_input;return c.setAttribute("at1",`${h}`),h=this.getInput("AT2")instanceof u.ValueInput$$module$build$src$core$inputs$value_input,c.setAttribute("at2",`${h}`),c},domToMutation:function(c){const h="true"===c.getAttribute("at1");c="true"===c.getAttribute("at2"),this.updateAt_(1,h),this.updateAt_(2,c)},updateAt_:function(c,h){this.removeInput("AT"+c),this.removeInput("ORDINAL"+c,!0),h?(this.appendValueInput("AT"+c).setCheck("Number"),u.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+c).appendField(u.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+c),2===c&&u.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(u.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL)),1===c&&(this.moveInputBefore("AT1","WHERE2_INPUT"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","WHERE2_INPUT"))}},Ie.text_changeCase={init:function(){const c=[[u.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE,"UPPERCASE"],[u.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE,"LOWERCASE"],[u.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_TITLECASE,"TITLECASE"]];this.setHelpUrl(u.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(u.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:c}),"CASE"),this.setOutput(!0,"String"),this.setTooltip(u.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_TOOLTIP)}},Ie.text_trim={init:function(){const c=[[u.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_BOTH,"BOTH"],[u.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_LEFT,"LEFT"],[u.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_RIGHT,"RIGHT"]];this.setHelpUrl(u.Msg$$module$build$src$core$msg.TEXT_TRIM_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(u.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:c}),"MODE"),this.setOutput(!0,"String"),this.setTooltip(u.Msg$$module$build$src$core$msg.TEXT_TRIM_TOOLTIP)}},Ie.text_print={init:function(){this.jsonInit({message0:u.Msg$$module$build$src$core$msg.TEXT_PRINT_TITLE,args0:[{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:u.Msg$$module$build$src$core$msg.TEXT_PRINT_TOOLTIP,helpUrl:u.Msg$$module$build$src$core$msg.TEXT_PRINT_HELPURL})}};var oi={updateType_:function(c){this.outputConnection.setCheck("NUMBER"===c?"Number":"String")},mutationToDom:function(){const c=u.createElement$$module$build$src$core$utils$xml("mutation");return c.setAttribute("type",this.getFieldValue("TYPE")),c},domToMutation:function(c){this.updateType_(c.getAttribute("type"))}};Ie.text_prompt_ext=Object.assign({},oi,{init:function(){var c=[[u.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[u.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(u.Msg$$module$build$src$core$msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),(c=u.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:c})).setValidator(h=>{this.updateType_(h)}),this.appendValueInput("TEXT").appendField(c,"TYPE"),this.setOutput(!0,"String"),this.setTooltip(()=>"TEXT"===this.getFieldValue("TYPE")?u.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_TEXT:u.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_NUMBER)}}),Ie.text_prompt=Object.assign({},oi,{init:function(){this.mixin(L);var c=[[u.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[u.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(u.Msg$$module$build$src$core$msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),(c=u.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:c})).setValidator(h=>{this.updateType_(h)}),this.appendDummyInput().appendField(c,"TYPE").appendField(this.newQuote_(!0)).appendField(u.fromJson$$module$build$src$core$field_registry({type:"field_input",text:""}),"TEXT").appendField(this.newQuote_(!1)),this.setOutput(!0,"String"),this.setTooltip(()=>"TEXT"===this.getFieldValue("TYPE")?u.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_TEXT:u.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_NUMBER)}}),Ie.text_count={init:function(){this.jsonInit({message0:u.Msg$$module$build$src$core$msg.TEXT_COUNT_MESSAGE0,args0:[{type:"input_value",name:"SUB",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"Number",inputsInline:!0,style:"text_blocks",tooltip:u.Msg$$module$build$src$core$msg.TEXT_COUNT_TOOLTIP,helpUrl:u.Msg$$module$build$src$core$msg.TEXT_COUNT_HELPURL})}},Ie.text_replace={init:function(){this.jsonInit({message0:u.Msg$$module$build$src$core$msg.TEXT_REPLACE_MESSAGE0,args0:[{type:"input_value",name:"FROM",check:"String"},{type:"input_value",name:"TO",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:u.Msg$$module$build$src$core$msg.TEXT_REPLACE_TOOLTIP,helpUrl:u.Msg$$module$build$src$core$msg.TEXT_REPLACE_HELPURL})}},Ie.text_reverse={init:function(){this.jsonInit({message0:u.Msg$$module$build$src$core$msg.TEXT_REVERSE_MESSAGE0,args0:[{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:u.Msg$$module$build$src$core$msg.TEXT_REVERSE_TOOLTIP,helpUrl:u.Msg$$module$build$src$core$msg.TEXT_REVERSE_HELPURL})}};var L={QUOTE_IMAGE_LEFT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAn0lEQVQI1z3OMa5BURSF4f/cQhAKjUQhuQmFNwGJEUi0RKN5rU7FHKhpjEH3TEMtkdBSCY1EIv8r7nFX9e29V7EBAOvu7RPjwmWGH/VuF8CyN9/OAdvqIXYLvtRaNjx9mMTDyo+NjAN1HNcl9ZQ5oQMM3dgDUqDo1l8DzvwmtZN7mnD+PkmLa+4mhrxVA9fRowBWmVBhFy5gYEjKMfz9AylsaRRgGzvZAAAAAElFTkSuQmCC",QUOTE_IMAGE_RIGHT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAqUlEQVQI1z3KvUpCcRiA8ef9E4JNHhI0aFEacm1o0BsI0Slx8wa8gLauoDnoBhq7DcfWhggONDmJJgqCPA7neJ7p934EOOKOnM8Q7PDElo/4x4lFb2DmuUjcUzS3URnGib9qaPNbuXvBO3sGPHJDRG6fGVdMSeWDP2q99FQdFrz26Gu5Tq7dFMzUvbXy8KXeAj57cOklgA+u1B5AoslLtGIHQMaCVnwDnADZIFIrXsoXrgAAAABJRU5ErkJggg==",QUOTE_IMAGE_WIDTH:12,QUOTE_IMAGE_HEIGHT:12,quoteField_:function(c){for(let _,h=0;_=this.inputList[h];h++)for(let w,T=0;w=_.fieldRow[T];T++)if(c===w.name)return _.insertFieldAt(T,this.newQuote_(!0)),void _.insertFieldAt(T+2,this.newQuote_(!1));console.warn('field named "'+c+'" not found in '+this.toDevString())},newQuote_:function(c){return u.fromJson$$module$build$src$core$field_registry({type:"field_image",src:(c=this.RTL?!c:c)?this.QUOTE_IMAGE_LEFT_DATAURI:this.QUOTE_IMAGE_RIGHT_DATAURI,width:this.QUOTE_IMAGE_WIDTH,height:this.QUOTE_IMAGE_HEIGHT,alt:c?"\u201c":"\u201d"})}},K={itemCount_:0,mutationToDom:function(){const c=u.createElement$$module$build$src$core$utils$xml("mutation");return c.setAttribute("items",`${this.itemCount_}`),c},domToMutation:function(c){this.itemCount_=parseInt(c.getAttribute("items"),10),this.updateShape_()},saveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function(c){this.itemCount_=c.itemCount,this.updateShape_()},decompose:function(c){const h=c.newBlock("text_create_join_container");h.initSvg();let _=h.getInput("STACK").connection;for(let T=0;T<this.itemCount_;T++){const w=c.newBlock("text_create_join_item");w.initSvg(),_.connect(w.previousConnection),_=w.nextConnection}return h},compose:function(c){var h=c.getInputTargetBlock("STACK");for(c=[];h;)h.isInsertionMarker()||c.push(h.valueConnection_),h=h.getNextBlock();for(h=0;h<this.itemCount_;h++){const _=this.getInput("ADD"+h).connection.targetConnection;_&&!c.includes(_)&&_.disconnect()}for(this.itemCount_=c.length,this.updateShape_(),h=0;h<this.itemCount_;h++){let _;null==(_=c[h])||_.reconnect(this,"ADD"+h)}},saveConnections:function(c){c=c.getInputTargetBlock("STACK");let h=0;for(;c;){if(c.isInsertionMarker()){c=c.getNextBlock();continue}const _=this.getInput("ADD"+h);c.valueConnection_=_&&_.connection.targetConnection,c=c.getNextBlock(),h++}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(this.newQuote_(!0)).appendField(this.newQuote_(!1));for(var c=0;c<this.itemCount_;c++)if(!this.getInput("ADD"+c)){const h=this.appendValueInput("ADD"+c).setAlign(u.Align$$module$build$src$core$inputs$align.RIGHT);0===c&&h.appendField(u.Msg$$module$build$src$core$msg.TEXT_JOIN_TITLE_CREATEWITH)}for(c=this.itemCount_;this.getInput("ADD"+c);c++)this.removeInput("ADD"+c)}};u.register$$module$build$src$core$extensions("text_append_tooltip",u.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_TEXT_APPEND_TOOLTIP}","VAR"));var Et={isAt_:!1,mutationToDom:function(){const c=u.createElement$$module$build$src$core$utils$xml("mutation");return c.setAttribute("at",`${this.isAt_}`),c},domToMutation:function(c){c="false"!==c.getAttribute("at"),this.updateAt_(c)},updateAt_:function(c){this.removeInput("AT",!0),this.removeInput("ORDINAL",!0),c&&(this.appendValueInput("AT").setCheck("Number"),u.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(u.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)),u.Msg$$module$build$src$core$msg.TEXT_CHARAT_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(u.Msg$$module$build$src$core$msg.TEXT_CHARAT_TAIL)),this.isAt_=c}};u.register$$module$build$src$core$extensions("text_indexOf_tooltip",function(){this.setTooltip(()=>u.Msg$$module$build$src$core$msg.TEXT_INDEXOF_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"0":"-1"))}),u.register$$module$build$src$core$extensions("text_quotes",function(){this.mixin(L),this.quoteField_("TEXT")}),u.registerMixin$$module$build$src$core$extensions("quote_image_mixin",L),u.registerMutator$$module$build$src$core$extensions("text_join_mutator",K,function(){this.mixin(L),this.itemCount_=2,this.updateShape_(),this.setMutator(new u.MutatorIcon$$module$build$src$core$icons$mutator_icon(["text_create_join_item"],this))}),u.registerMutator$$module$build$src$core$extensions("text_charAt_mutator",Et,function(){this.getField("WHERE").setValidator(function(c){c="FROM_START"===c||"FROM_END"===c;const h=this.getSourceBlock();c!==h.isAt_&&h.updateAt_(c)}),this.updateAt_(!0),this.setTooltip(()=>{var c=this.getFieldValue("WHERE");let h=u.Msg$$module$build$src$core$msg.TEXT_CHARAT_TOOLTIP;return("FROM_START"===c||"FROM_END"===c)&&(c="FROM_START"===c?u.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP:u.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_END_TOOLTIP)&&(h+="  "+c.replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),h})}),u.defineBlocks$$module$build$src$core$common(Ie);var ze={blocks:Ie},Te={},ro={setStatements_:function(c){this.hasStatements_!==c&&(c?(this.appendStatementInput("STACK").appendField(u.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_DO),this.getInput("RETURN")&&this.moveInputBefore("STACK","RETURN")):this.removeInput("STACK",!0),this.hasStatements_=c)},updateParams_:function(){let c="";this.arguments_.length&&(c=u.Msg$$module$build$src$core$msg.PROCEDURES_BEFORE_PARAMS+" "+this.arguments_.join(", ")),u.disable$$module$build$src$core$events$utils();try{this.setFieldValue(c,"PARAMS")}finally{u.enable$$module$build$src$core$events$utils()}},mutationToDom:function(c){const h=u.createElement$$module$build$src$core$utils$xml("mutation");c&&h.setAttribute("name",this.getFieldValue("NAME"));for(let _=0;_<this.argumentVarModels_.length;_++){const T=u.createElement$$module$build$src$core$utils$xml("arg"),w=this.argumentVarModels_[_];T.setAttribute("name",w.getName()),T.setAttribute("varid",w.getId()),c&&this.paramIds_&&T.setAttribute("paramId",this.paramIds_[_]),h.appendChild(T)}return this.hasStatements_||h.setAttribute("statements","false"),h},domToMutation:function(c){this.arguments_=[],this.argumentVarModels_=[];for(let T,_=0;T=c.childNodes[_];_++)if("arg"===T.nodeName.toLowerCase()){var h=T;const w=h.getAttribute("name");h=h.getAttribute("varid")||h.getAttribute("varId"),this.arguments_.push(w),null!==(h=u.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,h,w,""))?this.argumentVarModels_.push(h):console.log(`Failed to create a variable named "${w}", ignoring.`)}this.updateParams_(),u.mutateCallers$$module$build$src$core$procedures(this),this.setStatements_("false"!==c.getAttribute("statements"))},saveExtraState:function(){if(!this.argumentVarModels_.length&&this.hasStatements_)return null;const c=Object.create(null);if(this.argumentVarModels_.length){c.params=[];for(let h=0;h<this.argumentVarModels_.length;h++)c.params.push({name:this.argumentVarModels_[h].getName(),id:this.argumentVarModels_[h].getId()})}return this.hasStatements_||(c.hasStatements=!1),c},loadExtraState:function(c){if(this.arguments_=[],this.argumentVarModels_=[],c.params)for(let _=0;_<c.params.length;_++){var h=c.params[_];h=u.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,h.id,h.name,""),this.arguments_.push(h.getName()),this.argumentVarModels_.push(h)}this.updateParams_(),u.mutateCallers$$module$build$src$core$procedures(this),this.setStatements_(!1!==c.hasStatements)},decompose:function(c){const h=u.createElement$$module$build$src$core$utils$xml("block");h.setAttribute("type","procedures_mutatorcontainer");var _=u.createElement$$module$build$src$core$utils$xml("statement");_.setAttribute("name","STACK"),h.appendChild(_);for(let w=0;w<this.arguments_.length;w++){const pe=u.createElement$$module$build$src$core$utils$xml("block");pe.setAttribute("type","procedures_mutatorarg");var T=u.createElement$$module$build$src$core$utils$xml("field");T.setAttribute("name","NAME");const Dt=u.createTextNode$$module$build$src$core$utils$xml(this.arguments_[w]);T.appendChild(Dt),pe.appendChild(T),T=u.createElement$$module$build$src$core$utils$xml("next"),pe.appendChild(T),_.appendChild(pe),_=T}return c=u.domToBlock$$module$build$src$core$xml(h,c),"procedures_defreturn"===this.type?c.setFieldValue(this.hasStatements_,"STATEMENTS"):c.removeInput("STATEMENT_INPUT"),u.mutateCallers$$module$build$src$core$procedures(this),c},compose:function(c){this.arguments_=[],this.paramIds_=[],this.argumentVarModels_=[];let h=c.getInputTargetBlock("STACK");for(;h&&!h.isInsertionMarker();){var _=h.getFieldValue("NAME");this.arguments_.push(_),_=this.workspace.getVariable(_,""),this.argumentVarModels_.push(_),this.paramIds_.push(h.id),h=h.nextConnection&&h.nextConnection.targetBlock()}if(this.updateParams_(),u.mutateCallers$$module$build$src$core$procedures(this),null!==(c=c.getFieldValue("STATEMENTS"))&&this.hasStatements_!==(c="TRUE"===c))if(c){var T;this.setStatements_(!0),null==(T=this.statementConnection_)||T.reconnect(this,"STACK"),this.statementConnection_=null}else T=this.getInput("STACK").connection,(this.statementConnection_=T.targetConnection)&&((T=T.targetBlock()).unplug(),T.bumpNeighbours()),this.setStatements_(!1)},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},renameVarById:function(c,h){var _=this.workspace.getVariableById(c);if(""===_.getType()){_=_.getName(),h=this.workspace.getVariableById(h);var T=!1;for(let w=0;w<this.argumentVarModels_.length;w++)this.argumentVarModels_[w].getId()===c&&(this.arguments_[w]=h.getName(),this.argumentVarModels_[w]=h,T=!0);T&&(this.displayRenamedVar_(_,h.getName()),u.mutateCallers$$module$build$src$core$procedures(this))}},updateVarName:function(c){const h=c.getName();let T,_=!1;for(let w=0;w<this.argumentVarModels_.length;w++)this.argumentVarModels_[w].getId()===c.getId()&&(T=this.arguments_[w],this.arguments_[w]=h,_=!0);_&&(this.displayRenamedVar_(T,h),u.mutateCallers$$module$build$src$core$procedures(this))},displayRenamedVar_:function(c,h){this.updateParams_();var _=this.getIcon(u.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE);if(_&&_.bubbleIsVisible()){_=_.getWorkspace().getAllBlocks(!1);for(let w,T=0;w=_[T];T++)"procedures_mutatorarg"===w.type&&u.Names$$module$build$src$core$names.equals(c,w.getFieldValue("NAME"))&&w.setFieldValue(h,"NAME")}},customContextMenu:function(c){if(!this.isInFlyout){var h=this.getFieldValue("NAME"),_={type:this.callType_,extraState:{name:h,params:this.arguments_}};if(c.push({enabled:!0,text:u.Msg$$module$build$src$core$msg.PROCEDURES_CREATE_DO.replace("%1",h),callback:u.callbackFactory$$module$build$src$core$contextmenu(this,_)}),!this.isCollapsed())for(h=0;h<this.argumentVarModels_.length;h++){const T={type:"variables_get",fields:{VAR:{name:(_=this.argumentVarModels_[h]).getName(),id:_.getId(),type:_.getType()}}};c.push({enabled:!0,text:u.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET.replace("%1",_.getName()),callback:u.callbackFactory$$module$build$src$core$contextmenu(this,T)})}}}};Te.procedures_defnoreturn=Object.assign({},ro,{init:function(){var c=u.findLegalName$$module$build$src$core$procedures("",this);(c=u.fromJson$$module$build$src$core$field_registry({type:"field_input",text:c})).setValidator(u.rename$$module$build$src$core$procedures),c.setSpellcheck(!1),this.appendDummyInput().appendField(u.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_TITLE).appendField(c,"NAME").appendField("","PARAMS"),this.setMutator(new u.MutatorIcon$$module$build$src$core$icons$mutator_icon(["procedures_mutatorarg"],this)),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&u.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_COMMENT&&this.setCommentText(u.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(u.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_TOOLTIP),this.setHelpUrl(u.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!1]},callType_:"procedures_callnoreturn"}),Te.procedures_defreturn=Object.assign({},ro,{init:function(){var c=u.findLegalName$$module$build$src$core$procedures("",this);(c=u.fromJson$$module$build$src$core$field_registry({type:"field_input",text:c})).setValidator(u.rename$$module$build$src$core$procedures),c.setSpellcheck(!1),this.appendDummyInput().appendField(u.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_TITLE).appendField(c,"NAME").appendField("","PARAMS"),this.appendValueInput("RETURN").setAlign(u.Align$$module$build$src$core$inputs$align.RIGHT).appendField(u.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.setMutator(new u.MutatorIcon$$module$build$src$core$icons$mutator_icon(["procedures_mutatorarg"],this)),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&u.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_COMMENT&&this.setCommentText(u.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(u.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_TOOLTIP),this.setHelpUrl(u.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!0]},callType_:"procedures_callreturn"}),Te.procedures_mutatorcontainer={init:function(){this.appendDummyInput().appendField(u.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORCONTAINER_TITLE),this.appendStatementInput("STACK"),this.appendDummyInput("STATEMENT_INPUT").appendField(u.Msg$$module$build$src$core$msg.PROCEDURES_ALLOW_STATEMENTS).appendField(u.fromJson$$module$build$src$core$field_registry({type:"field_checkbox",checked:!0}),"STATEMENTS"),this.setStyle("procedure_blocks"),this.setTooltip(u.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP),this.contextMenu=!1}};var Mt=class extends u.FieldTextInput$$module$build$src$core$field_textinput{constructor(){super(...arguments),this.editingInteractively=!1}showEditor_(c){super.showEditor_(c),this.editingInteractively=!0,this.editingVariable=void 0}onFinishEditing_(c){super.onFinishEditing_(c),this.editingInteractively=!1}};Te.procedures_mutatorarg={init:function(){const c=new Mt(u.DEFAULT_ARG$$module$build$src$core$procedures,this.validator_);this.appendDummyInput().appendField(u.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORARG_TITLE).appendField(c,"NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(u.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORARG_TOOLTIP),this.contextMenu=!1},validator_:function(c){var h=this.getSourceBlock();const _=h.workspace.getRootWorkspace();if(!(c=c.replace(/[\s\xa0]+/g," ").replace(/^ | $/g,"")))return null;const T=(h.workspace.targetWorkspace||h.workspace).getAllBlocks(!1),w=c.toLowerCase();for(let pe=0;pe<T.length;pe++){if(T[pe].id===this.getSourceBlock().id)continue;const Dt=T[pe].getFieldValue("NAME");if(Dt&&Dt.toLowerCase()===w)return null}return h.isInFlyout||((h=_.getVariable(c,""))&&h.getName()!==c&&_.renameVariableById(h.getId(),c),h||(this.editingInteractively?this.editingVariable?_.renameVariableById(this.editingVariable.getId(),c):this.editingVariable=_.createVariable(c,""):_.createVariable(c,""))),c}};var Nt="DISABLED_PROCEDURE_DEFINITION",Zi={getProcedureCall:function(){return this.getFieldValue("NAME")},renameProcedure:function(c,h){u.Names$$module$build$src$core$names.equals(c,this.getProcedureCall())&&(this.setFieldValue(h,"NAME"),this.setTooltip((this.outputConnection?u.Msg$$module$build$src$core$msg.PROCEDURES_CALLRETURN_TOOLTIP:u.Msg$$module$build$src$core$msg.PROCEDURES_CALLNORETURN_TOOLTIP).replace("%1",h)))},setProcedureParameters_:function(c,h){var _=u.getDefinition$$module$build$src$core$procedures(this.getProcedureCall(),this.workspace);if((_=(_=_&&_.getIcon(u.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE))&&_.bubbleIsVisible())?this.setCollapsed(!1):(this.quarkConnections_={},this.quarkIds_=null),c.join("\n")===this.arguments_.join("\n"))this.quarkIds_=h;else{if(h.length!==c.length)throw RangeError("paramNames and paramIds must be the same length.");this.quarkIds_||(this.quarkConnections_={},this.quarkIds_=[]);for(let w=0;w<this.arguments_.length;w++){var T=this.getInput("ARG"+w);T&&(this.quarkConnections_[this.quarkIds_[w]]=T=T.connection.targetConnection,_&&T&&!h.includes(this.quarkIds_[w])&&(T.disconnect(),T.getSourceBlock().bumpNeighbours()))}for(this.arguments_=[].concat(c),this.argumentVarModels_=[],c=0;c<this.arguments_.length;c++)_=u.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,null,this.arguments_[c],""),this.argumentVarModels_.push(_);if(this.updateShape_(),this.quarkIds_=h)for(h=0;h<this.arguments_.length;h++)if((c=this.quarkIds_[h])in this.quarkConnections_){let w;null!=(w=this.quarkConnections_[c])&&w.reconnect(this,"ARG"+h)||delete this.quarkConnections_[c]}}},updateShape_:function(){for(var c=0;c<this.arguments_.length;c++){var h=this.getField("ARGNAME"+c);if(h){u.disable$$module$build$src$core$events$utils();try{h.setValue(this.arguments_[c])}finally{u.enable$$module$build$src$core$events$utils()}}else h=u.fromJson$$module$build$src$core$field_registry({type:"field_label",text:this.arguments_[c]}),this.appendValueInput("ARG"+c).setAlign(u.Align$$module$build$src$core$inputs$align.RIGHT).appendField(h,"ARGNAME"+c)}for(c=this.arguments_.length;this.getInput("ARG"+c);c++)this.removeInput("ARG"+c);(c=this.getInput("TOPROW"))&&(this.arguments_.length?this.getField("WITH")||c.appendField(u.Msg$$module$build$src$core$msg.PROCEDURES_CALL_BEFORE_PARAMS,"WITH"):this.getField("WITH")&&c.removeField("WITH"))},mutationToDom:function(){const c=u.createElement$$module$build$src$core$utils$xml("mutation");c.setAttribute("name",this.getProcedureCall());for(let h=0;h<this.arguments_.length;h++){const _=u.createElement$$module$build$src$core$utils$xml("arg");_.setAttribute("name",this.arguments_[h]),c.appendChild(_)}return c},domToMutation:function(c){var h=c.getAttribute("name");this.renameProcedure(this.getProcedureCall(),h),h=[];const _=[];for(let w,T=0;w=c.childNodes[T];T++)"arg"===w.nodeName.toLowerCase()&&(h.push(w.getAttribute("name")),_.push(w.getAttribute("paramId")));this.setProcedureParameters_(h,_)},saveExtraState:function(){const c=Object.create(null);return c.name=this.getProcedureCall(),this.arguments_.length&&(c.params=this.arguments_),c},loadExtraState:function(c){if(this.renameProcedure(this.getProcedureCall(),c.name),c=c.params){const h=[];h.length=c.length,h.fill(null),this.setProcedureParameters_(c,h)}},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},onchange:function(c){if(this.workspace&&!this.workspace.isFlyout&&c.recordUndo)if(c.type===u.BLOCK_CREATE$$module$build$src$core$events$events&&c.ids.includes(this.id)){var h=this.getProcedureCall(),_=u.getDefinition$$module$build$src$core$procedures(h,this.workspace);if(!_||_.type===this.defType_&&JSON.stringify(_.getVars())===JSON.stringify(this.arguments_)||(_=null),_)_.isEnabled()||(this.setDisabledReason(!0,Nt),this.setWarningText(u.Msg$$module$build$src$core$msg.PROCEDURES_CALL_DISABLED_DEF_WARNING.replace("%1",h)));else{u.setGroup$$module$build$src$core$events$utils(c.group),c=u.createElement$$module$build$src$core$utils$xml("xml"),(h=u.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type",this.defType_);var T=(_=this.getRelativeToSurfaceXY()).y+2*u.config$$module$build$src$core$config.snapRadius;h.setAttribute("x",`${_.x+u.config$$module$build$src$core$config.snapRadius*(this.RTL?-1:1)}`),h.setAttribute("y",`${T}`),_=this.mutationToDom(),h.appendChild(_),(_=u.createElement$$module$build$src$core$utils$xml("field")).setAttribute("name","NAME"),T=this.getProcedureCall();const w=u.findLegalName$$module$build$src$core$procedures(T,this);T!==w&&this.renameProcedure(T,w),_.appendChild(u.createTextNode$$module$build$src$core$utils$xml(T)),h.appendChild(_),c.appendChild(h),u.domToWorkspace$$module$build$src$core$xml(c,this.workspace),u.setGroup$$module$build$src$core$events$utils(!1)}}else c.type===u.BLOCK_DELETE$$module$build$src$core$events$events?(h=this.getProcedureCall(),u.getDefinition$$module$build$src$core$procedures(h,this.workspace)||(u.setGroup$$module$build$src$core$events$utils(c.group),this.dispose(!0),u.setGroup$$module$build$src$core$events$utils(!1))):c.type===u.BLOCK_CHANGE$$module$build$src$core$events$events&&"disabled"===c.element&&(h=this.getProcedureCall(),(T=u.getDefinition$$module$build$src$core$procedures(h,this.workspace))&&T.id===c.blockId&&((_=u.getGroup$$module$build$src$core$events$utils())&&console.log("Saw an existing group while responding to a definition change"),u.setGroup$$module$build$src$core$events$utils(c.group),c=T.isEnabled(),this.setDisabledReason(!c,Nt),this.setWarningText(c?null:u.Msg$$module$build$src$core$msg.PROCEDURES_CALL_DISABLED_DEF_WARNING.replace("%1",h)),u.setGroup$$module$build$src$core$events$utils(_)))},customContextMenu:function(c){if(this.workspace.isMovable()){var h=this.getProcedureCall(),_=this.workspace;c.push({enabled:!0,text:u.Msg$$module$build$src$core$msg.PROCEDURES_HIGHLIGHT_DEF,callback:function(){const T=u.getDefinition$$module$build$src$core$procedures(h,_);T&&(_.centerOnBlock(T.id),u.getFocusManager$$module$build$src$core$focus_manager().focusNode(T))}})}}};Te.procedures_callnoreturn=Object.assign({},Zi,{init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(u.Msg$$module$build$src$core$msg.PROCEDURES_CALLNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null},defType_:"procedures_defnoreturn"}),Te.procedures_callreturn=Object.assign({},Zi,{init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setOutput(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(u.Msg$$module$build$src$core$msg.PROCEDURES_CALLRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null},defType_:"procedures_defreturn"});Te.procedures_ifreturn={init:function(){this.appendValueInput("CONDITION").setCheck("Boolean").appendField(u.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_IF),this.appendValueInput("VALUE").appendField(u.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(u.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_TOOLTIP),this.setHelpUrl(u.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_HELPURL),this.hasReturnValue_=!0},mutationToDom:function(){const c=u.createElement$$module$build$src$core$utils$xml("mutation");return c.setAttribute("value",String(Number(this.hasReturnValue_))),c},domToMutation:function(c){this.hasReturnValue_="1"===c.getAttribute("value"),this.hasReturnValue_||(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(u.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN))},onchange:function(c){if(!(this.workspace.isDragging&&this.workspace.isDragging()||c.type!==u.BLOCK_MOVE$$module$build$src$core$events$events&&c.type!==u.BLOCK_CREATE$$module$build$src$core$events$events)){c=!1;var h=this;do{if(this.FUNCTION_TYPES.includes(h.type)){c=!0;break}h=h.getSurroundParent()}while(h);if(c?("procedures_defnoreturn"===h.type&&this.hasReturnValue_?(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(u.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!1):"procedures_defreturn"!==h.type||this.hasReturnValue_||(this.removeInput("VALUE"),this.appendValueInput("VALUE").appendField(u.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!0),this.setWarningText(null)):this.setWarningText(u.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_WARNING),!this.isInFlyout)try{u.setRecordUndo$$module$build$src$core$events$utils(!1),this.setDisabledReason(!c,"UNPARENTED_IFRETURN")}finally{u.setRecordUndo$$module$build$src$core$events$utils(!0)}}},FUNCTION_TYPES:["procedures_defnoreturn","procedures_defreturn"]},u.defineBlocks$$module$build$src$core$common(Te);var Vs={blocks:Te},ii=u.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"math_number",message0:"%1",args0:[{type:"field_number",name:"NUM",value:0}],output:"Number",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",style:"math_blocks",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"math_arithmetic",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Number"},{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ADDITION_SYMBOL}","ADD"],["%{BKY_MATH_SUBTRACTION_SYMBOL}","MINUS"],["%{BKY_MATH_MULTIPLICATION_SYMBOL}","MULTIPLY"],["%{BKY_MATH_DIVISION_SYMBOL}","DIVIDE"],["%{BKY_MATH_POWER_SYMBOL}","POWER"]]},{type:"input_value",name:"B",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ARITHMETIC_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_single",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_SINGLE_OP_ROOT}","ROOT"],["%{BKY_MATH_SINGLE_OP_ABSOLUTE}","ABS"],["-","NEG"],["ln","LN"],["log10","LOG10"],["e^","EXP"],["10^","POW10"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_SINGLE_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_trig",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_TRIG_SIN}","SIN"],["%{BKY_MATH_TRIG_COS}","COS"],["%{BKY_MATH_TRIG_TAN}","TAN"],["%{BKY_MATH_TRIG_ASIN}","ASIN"],["%{BKY_MATH_TRIG_ACOS}","ACOS"],["%{BKY_MATH_TRIG_ATAN}","ATAN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_TRIG_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_constant",message0:"%1",args0:[{type:"field_dropdown",name:"CONSTANT",options:[["\u03c0","PI"],["e","E"],["\u03c6","GOLDEN_RATIO"],["sqrt(2)","SQRT2"],["sqrt(\xbd)","SQRT1_2"],["\u221e","INFINITY"]]}],output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTANT_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTANT_HELPURL}"},{type:"math_number_property",message0:"%1 %2",args0:[{type:"input_value",name:"NUMBER_TO_CHECK",check:"Number"},{type:"field_dropdown",name:"PROPERTY",options:[["%{BKY_MATH_IS_EVEN}","EVEN"],["%{BKY_MATH_IS_ODD}","ODD"],["%{BKY_MATH_IS_PRIME}","PRIME"],["%{BKY_MATH_IS_WHOLE}","WHOLE"],["%{BKY_MATH_IS_POSITIVE}","POSITIVE"],["%{BKY_MATH_IS_NEGATIVE}","NEGATIVE"],["%{BKY_MATH_IS_DIVISIBLE_BY}","DIVISIBLE_BY"]]}],inputsInline:!0,output:"Boolean",style:"math_blocks",tooltip:"%{BKY_MATH_IS_TOOLTIP}",mutator:"math_is_divisibleby_mutator"},{type:"math_change",message0:"%{BKY_MATH_CHANGE_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_MATH_CHANGE_TITLE_ITEM}"},{type:"input_value",name:"DELTA",check:"Number"}],previousStatement:null,nextStatement:null,style:"variable_blocks",helpUrl:"%{BKY_MATH_CHANGE_HELPURL}",extensions:["math_change_tooltip"]},{type:"math_round",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ROUND_OPERATOR_ROUND}","ROUND"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDUP}","ROUNDUP"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDDOWN}","ROUNDDOWN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ROUND_HELPURL}",tooltip:"%{BKY_MATH_ROUND_TOOLTIP}"},{type:"math_on_list",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ONLIST_OPERATOR_SUM}","SUM"],["%{BKY_MATH_ONLIST_OPERATOR_MIN}","MIN"],["%{BKY_MATH_ONLIST_OPERATOR_MAX}","MAX"],["%{BKY_MATH_ONLIST_OPERATOR_AVERAGE}","AVERAGE"],["%{BKY_MATH_ONLIST_OPERATOR_MEDIAN}","MEDIAN"],["%{BKY_MATH_ONLIST_OPERATOR_MODE}","MODE"],["%{BKY_MATH_ONLIST_OPERATOR_STD_DEV}","STD_DEV"],["%{BKY_MATH_ONLIST_OPERATOR_RANDOM}","RANDOM"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ONLIST_HELPURL}",mutator:"math_modes_of_list_mutator",extensions:["math_op_tooltip"]},{type:"math_modulo",message0:"%{BKY_MATH_MODULO_TITLE}",args0:[{type:"input_value",name:"DIVIDEND",check:"Number"},{type:"input_value",name:"DIVISOR",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_MODULO_TOOLTIP}",helpUrl:"%{BKY_MATH_MODULO_HELPURL}"},{type:"math_constrain",message0:"%{BKY_MATH_CONSTRAIN_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"Number"},{type:"input_value",name:"LOW",check:"Number"},{type:"input_value",name:"HIGH",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTRAIN_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTRAIN_HELPURL}"},{type:"math_random_int",message0:"%{BKY_MATH_RANDOM_INT_TITLE}",args0:[{type:"input_value",name:"FROM",check:"Number"},{type:"input_value",name:"TO",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_INT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_INT_HELPURL}"},{type:"math_random_float",message0:"%{BKY_MATH_RANDOM_FLOAT_TITLE_RANDOM}",output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_FLOAT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_FLOAT_HELPURL}"},{type:"math_atan2",message0:"%{BKY_MATH_ATAN2_TITLE}",args0:[{type:"input_value",name:"X",check:"Number"},{type:"input_value",name:"Y",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_ATAN2_TOOLTIP}",helpUrl:"%{BKY_MATH_ATAN2_HELPURL}"}]);u.register$$module$build$src$core$extensions("math_op_tooltip",u.buildTooltipForDropdown$$module$build$src$core$extensions("OP",{ADD:"%{BKY_MATH_ARITHMETIC_TOOLTIP_ADD}",MINUS:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MINUS}",MULTIPLY:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MULTIPLY}",DIVIDE:"%{BKY_MATH_ARITHMETIC_TOOLTIP_DIVIDE}",POWER:"%{BKY_MATH_ARITHMETIC_TOOLTIP_POWER}",ROOT:"%{BKY_MATH_SINGLE_TOOLTIP_ROOT}",ABS:"%{BKY_MATH_SINGLE_TOOLTIP_ABS}",NEG:"%{BKY_MATH_SINGLE_TOOLTIP_NEG}",LN:"%{BKY_MATH_SINGLE_TOOLTIP_LN}",LOG10:"%{BKY_MATH_SINGLE_TOOLTIP_LOG10}",EXP:"%{BKY_MATH_SINGLE_TOOLTIP_EXP}",POW10:"%{BKY_MATH_SINGLE_TOOLTIP_POW10}",SIN:"%{BKY_MATH_TRIG_TOOLTIP_SIN}",COS:"%{BKY_MATH_TRIG_TOOLTIP_COS}",TAN:"%{BKY_MATH_TRIG_TOOLTIP_TAN}",ASIN:"%{BKY_MATH_TRIG_TOOLTIP_ASIN}",ACOS:"%{BKY_MATH_TRIG_TOOLTIP_ACOS}",ATAN:"%{BKY_MATH_TRIG_TOOLTIP_ATAN}",SUM:"%{BKY_MATH_ONLIST_TOOLTIP_SUM}",MIN:"%{BKY_MATH_ONLIST_TOOLTIP_MIN}",MAX:"%{BKY_MATH_ONLIST_TOOLTIP_MAX}",AVERAGE:"%{BKY_MATH_ONLIST_TOOLTIP_AVERAGE}",MEDIAN:"%{BKY_MATH_ONLIST_TOOLTIP_MEDIAN}",MODE:"%{BKY_MATH_ONLIST_TOOLTIP_MODE}",STD_DEV:"%{BKY_MATH_ONLIST_TOOLTIP_STD_DEV}",RANDOM:"%{BKY_MATH_ONLIST_TOOLTIP_RANDOM}"}));var si={mutationToDom:function(){const c=u.createElement$$module$build$src$core$utils$xml("mutation"),h="DIVISIBLE_BY"===this.getFieldValue("PROPERTY");return c.setAttribute("divisor_input",String(h)),c},domToMutation:function(c){c="true"===c.getAttribute("divisor_input"),this.updateShape_(c)},updateShape_:function(c){const h=this.getInput("DIVISOR");c?h||this.appendValueInput("DIVISOR").setCheck("Number"):h&&this.removeInput("DIVISOR")}};u.registerMutator$$module$build$src$core$extensions("math_is_divisibleby_mutator",si,function(){this.getField("PROPERTY").setValidator(function(c){c="DIVISIBLE_BY"===c,this.getSourceBlock().updateShape_(c)})}),u.register$$module$build$src$core$extensions("math_change_tooltip",u.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_MATH_CHANGE_TOOLTIP}","VAR"));var Zs={updateType_:function(c){this.outputConnection.setCheck("MODE"===c?"Array":"Number")},mutationToDom:function(){const c=u.createElement$$module$build$src$core$utils$xml("mutation");return c.setAttribute("op",this.getFieldValue("OP")),c},domToMutation:function(c){if(null===(c=c.getAttribute("op")))throw new TypeError("xmlElement had no op attribute");this.updateType_(c)}};u.registerMutator$$module$build$src$core$extensions("math_modes_of_list_mutator",Zs,function(){this.getField("OP").setValidator(function(c){this.updateType_(c)}.bind(this))}),u.defineBlocks$$module$build$src$core$common(ii);var yo={blocks:ii},ni=u.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"controls_repeat_ext",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"input_value",name:"TIMES",check:"Number"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_repeat",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"field_number",name:"TIMES",value:10,min:0,precision:1}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_whileUntil",message0:"%1 %2",args0:[{type:"field_dropdown",name:"MODE",options:[["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_WHILE}","WHILE"],["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_UNTIL}","UNTIL"]]},{type:"input_value",name:"BOOL",check:"Boolean"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_WHILEUNTIL_HELPURL}",extensions:["controls_whileUntil_tooltip"]},{type:"controls_for",message0:"%{BKY_CONTROLS_FOR_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"FROM",check:"Number",align:"RIGHT"},{type:"input_value",name:"TO",check:"Number",align:"RIGHT"},{type:"input_value",name:"BY",check:"Number",align:"RIGHT"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],inputsInline:!0,previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOR_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_for_tooltip"]},{type:"controls_forEach",message0:"%{BKY_CONTROLS_FOREACH_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"LIST",check:"Array"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOREACH_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_forEach_tooltip"]},{type:"controls_flow_statements",message0:"%1",args0:[{type:"field_dropdown",name:"FLOW",options:[["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK}","BREAK"],["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE}","CONTINUE"]]}],previousStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FLOW_STATEMENTS_HELPURL}",suppressPrefixSuffix:!0,extensions:["controls_flow_tooltip","controls_flow_in_loop_check"]}]);u.register$$module$build$src$core$extensions("controls_whileUntil_tooltip",u.buildTooltipForDropdown$$module$build$src$core$extensions("MODE",{WHILE:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_WHILE}",UNTIL:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL}"})),u.register$$module$build$src$core$extensions("controls_flow_tooltip",u.buildTooltipForDropdown$$module$build$src$core$extensions("FLOW",{BREAK:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK}",CONTINUE:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE}"}));var js={customContextMenu:function(c){if(!this.isInFlyout){var h=this.getField("VAR"),_=h.getVariable().getName();this.isCollapsed()||null===_||(h={type:"variables_get",fields:{VAR:h.saveState(!0)}},c.push({enabled:!0,text:u.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET.replace("%1",_),callback:u.callbackFactory$$module$build$src$core$contextmenu(this,h)}))}}};u.registerMixin$$module$build$src$core$extensions("contextMenu_newGetVariableBlock",js),u.register$$module$build$src$core$extensions("controls_for_tooltip",u.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_CONTROLS_FOR_TOOLTIP}","VAR")),u.register$$module$build$src$core$extensions("controls_forEach_tooltip",u.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_CONTROLS_FOREACH_TOOLTIP}","VAR"));var Co=new Set(["controls_repeat","controls_repeat_ext","controls_forEach","controls_for","controls_whileUntil"]),Ys={getSurroundLoop:function(){let c=this;do{if(Co.has(c.type))return c;c=c.getSurroundParent()}while(c);return null},onchange:function(c){const h=this.workspace;if(h.isDragging&&!h.isDragging()&&(c.type===u.BLOCK_MOVE$$module$build$src$core$events$events||c.type===u.BLOCK_CREATE$$module$build$src$core$events$events)&&(c=!!this.getSurroundLoop(),this.setWarningText(c?null:u.Msg$$module$build$src$core$msg.CONTROLS_FLOW_STATEMENTS_WARNING),!this.isInFlyout))try{u.setRecordUndo$$module$build$src$core$events$utils(!1),this.setDisabledReason(!c,"CONTROL_FLOW_NOT_IN_LOOP")}finally{u.setRecordUndo$$module$build$src$core$events$utils(!0)}}};u.registerMixin$$module$build$src$core$extensions("controls_flow_in_loop_check",Ys),u.defineBlocks$$module$build$src$core$common(ni);var Ks={blocks:ni,loopTypes:Co},ke=u.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"logic_boolean",message0:"%1",args0:[{type:"field_dropdown",name:"BOOL",options:[["%{BKY_LOGIC_BOOLEAN_TRUE}","TRUE"],["%{BKY_LOGIC_BOOLEAN_FALSE}","FALSE"]]}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_BOOLEAN_TOOLTIP}",helpUrl:"%{BKY_LOGIC_BOOLEAN_HELPURL}"},{type:"controls_if",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],previousStatement:null,nextStatement:null,style:"logic_blocks",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",suppressPrefixSuffix:!0,mutator:"controls_if_mutator",extensions:["controls_if_tooltip"]},{type:"controls_ifelse",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],message2:"%{BKY_CONTROLS_IF_MSG_ELSE} %1",args2:[{type:"input_statement",name:"ELSE"}],previousStatement:null,nextStatement:null,style:"logic_blocks",tooltip:"%{BKYCONTROLS_IF_TOOLTIP_2}",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",suppressPrefixSuffix:!0,extensions:["controls_if_tooltip"]},{type:"logic_compare",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A"},{type:"field_dropdown",name:"OP",options:[["=","EQ"],["\u2260","NEQ"],["\u200f<","LT"],["\u200f\u2264","LTE"],["\u200f>","GT"],["\u200f\u2265","GTE"]]},{type:"input_value",name:"B"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_COMPARE_HELPURL}",extensions:["logic_compare","logic_op_tooltip"]},{type:"logic_operation",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Boolean"},{type:"field_dropdown",name:"OP",options:[["%{BKY_LOGIC_OPERATION_AND}","AND"],["%{BKY_LOGIC_OPERATION_OR}","OR"]]},{type:"input_value",name:"B",check:"Boolean"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_OPERATION_HELPURL}",extensions:["logic_op_tooltip"]},{type:"logic_negate",message0:"%{BKY_LOGIC_NEGATE_TITLE}",args0:[{type:"input_value",name:"BOOL",check:"Boolean"}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_NEGATE_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NEGATE_HELPURL}"},{type:"logic_null",message0:"%{BKY_LOGIC_NULL}",output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_NULL_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NULL_HELPURL}"},{type:"logic_ternary",message0:"%{BKY_LOGIC_TERNARY_CONDITION} %1",args0:[{type:"input_value",name:"IF",check:"Boolean"}],message1:"%{BKY_LOGIC_TERNARY_IF_TRUE} %1",args1:[{type:"input_value",name:"THEN"}],message2:"%{BKY_LOGIC_TERNARY_IF_FALSE} %1",args2:[{type:"input_value",name:"ELSE"}],output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_TERNARY_TOOLTIP}",helpUrl:"%{BKY_LOGIC_TERNARY_HELPURL}",extensions:["logic_ternary"]},{type:"controls_if_if",message0:"%{BKY_CONTROLS_IF_IF_TITLE_IF}",nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_IF_TOOLTIP}"},{type:"controls_if_elseif",message0:"%{BKY_CONTROLS_IF_ELSEIF_TITLE_ELSEIF}",previousStatement:null,nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSEIF_TOOLTIP}"},{type:"controls_if_else",message0:"%{BKY_CONTROLS_IF_ELSE_TITLE_ELSE}",previousStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSE_TOOLTIP}"}]);u.register$$module$build$src$core$extensions("logic_op_tooltip",u.buildTooltipForDropdown$$module$build$src$core$extensions("OP",{EQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_EQ}",NEQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_NEQ}",LT:"%{BKY_LOGIC_COMPARE_TOOLTIP_LT}",LTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_LTE}",GT:"%{BKY_LOGIC_COMPARE_TOOLTIP_GT}",GTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_GTE}",AND:"%{BKY_LOGIC_OPERATION_TOOLTIP_AND}",OR:"%{BKY_LOGIC_OPERATION_TOOLTIP_OR}"}));var Js={elseifCount_:0,elseCount_:0,mutationToDom:function(){if(!this.elseifCount_&&!this.elseCount_)return null;const c=u.createElement$$module$build$src$core$utils$xml("mutation");return this.elseifCount_&&c.setAttribute("elseif",String(this.elseifCount_)),this.elseCount_&&c.setAttribute("else","1"),c},domToMutation:function(c){this.elseifCount_=parseInt(c.getAttribute("elseif"),10)||0,this.elseCount_=parseInt(c.getAttribute("else"),10)||0,this.rebuildShape_()},saveExtraState:function(){if(!this.elseifCount_&&!this.elseCount_)return null;const c=Object.create(null);return this.elseifCount_&&(c.elseIfCount=this.elseifCount_),this.elseCount_&&(c.hasElse=!0),c},loadExtraState:function(c){this.elseifCount_=c.elseIfCount||0,this.elseCount_=c.hasElse?1:0,this.updateShape_()},decompose:function(c){const h=c.newBlock("controls_if_if");h.initSvg();let _=h.nextConnection;for(let T=1;T<=this.elseifCount_;T++){const w=c.newBlock("controls_if_elseif");w.initSvg(),_.connect(w.previousConnection),_=w.nextConnection}return this.elseCount_&&((c=c.newBlock("controls_if_else")).initSvg(),_.connect(c.previousConnection)),h},compose:function(c){c=c.nextConnection.targetBlock(),this.elseCount_=this.elseifCount_=0;const h=[null],_=[null];let T=null;for(;c;){if(!c.isInsertionMarker())switch(c.type){case"controls_if_elseif":this.elseifCount_++,h.push(c.valueConnection_),_.push(c.statementConnection_);break;case"controls_if_else":this.elseCount_++,T=c.statementConnection_;break;default:throw TypeError("Unknown block type: "+c.type)}c=c.getNextBlock()}this.updateShape_(),this.reconnectChildBlocks_(h,_,T)},saveConnections:function(c){c=c.nextConnection.targetBlock();let h=1;for(;c;){if(!c.isInsertionMarker())switch(c.type){case"controls_if_elseif":var _=this.getInput("IF"+h);const T=this.getInput("DO"+h);c.valueConnection_=_&&_.connection.targetConnection,c.statementConnection_=T&&T.connection.targetConnection,h++;break;case"controls_if_else":_=this.getInput("ELSE"),c.statementConnection_=_&&_.connection.targetConnection;break;default:throw TypeError("Unknown block type: "+c.type)}c=c.getNextBlock()}},rebuildShape_:function(){const c=[null],h=[null];let _=null;this.getInput("ELSE")&&(_=this.getInput("ELSE").connection.targetConnection);for(let T=1;this.getInput("IF"+T);T++){const w=this.getInput("IF"+T),pe=this.getInput("DO"+T);c.push(w.connection.targetConnection),h.push(pe.connection.targetConnection)}this.updateShape_(),this.reconnectChildBlocks_(c,h,_)},updateShape_:function(){this.getInput("ELSE")&&this.removeInput("ELSE");for(var c=1;this.getInput("IF"+c);c++)this.removeInput("IF"+c),this.removeInput("DO"+c);for(c=1;c<=this.elseifCount_;c++)this.appendValueInput("IF"+c).setCheck("Boolean").appendField(u.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_ELSEIF),this.appendStatementInput("DO"+c).appendField(u.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_THEN);this.elseCount_&&this.appendStatementInput("ELSE").appendField(u.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_ELSE)},reconnectChildBlocks_:function(c,h,_){for(let T=1;T<=this.elseifCount_;T++){let w,pe;null==(w=c[T])||w.reconnect(this,"IF"+T),null==(pe=h[T])||pe.reconnect(this,"DO"+T)}_?.reconnect(this,"ELSE")}};u.registerMutator$$module$build$src$core$extensions("controls_if_mutator",Js,null,["controls_if_elseif","controls_if_else"]);u.register$$module$build$src$core$extensions("controls_if_tooltip",function(){this.setTooltip(function(){return this.elseifCount_||this.elseCount_?!this.elseifCount_&&this.elseCount_?u.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_2:this.elseifCount_&&!this.elseCount_?u.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_3:this.elseifCount_&&this.elseCount_?u.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_4:"":u.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_1}.bind(this))});var qi={onchange:function(c){this.prevBlocks_||(this.prevBlocks_=[null,null]);var h=this.getInputTargetBlock("A");const _=this.getInputTargetBlock("B");h&&_&&!this.workspace.connectionChecker.doTypeChecks(h.outputConnection,_.outputConnection)&&(u.setGroup$$module$build$src$core$events$utils(c.group),(c=this.prevBlocks_[0])!==h&&(h.unplug(),!c||c.isDisposed()||c.isShadow()||this.getInput("A").connection.connect(c.outputConnection)),(h=this.prevBlocks_[1])!==_&&(_.unplug(),!h||h.isDisposed()||h.isShadow()||this.getInput("B").connection.connect(h.outputConnection)),this.bumpNeighbours(),u.setGroup$$module$build$src$core$events$utils(!1)),this.prevBlocks_[0]=this.getInputTargetBlock("A"),this.prevBlocks_[1]=this.getInputTargetBlock("B")}};u.register$$module$build$src$core$extensions("logic_compare",function(){this.mixin(qi)});var ci={prevParentConnection_:null,onchange:function(c){const h=this.getInputTargetBlock("THEN"),_=this.getInputTargetBlock("ELSE"),T=this.outputConnection.targetConnection;if((h||_)&&T)for(let w=0;w<2;w++){const pe=1===w?h:_;pe&&!pe.workspace.connectionChecker.doTypeChecks(pe.outputConnection,T)&&(u.setGroup$$module$build$src$core$events$utils(c.group),T===this.prevParentConnection_?(this.unplug(),T.getSourceBlock().bumpNeighbours()):(pe.unplug(),pe.bumpNeighbours()),u.setGroup$$module$build$src$core$events$utils(!1))}this.prevParentConnection_=T}};u.registerMixin$$module$build$src$core$extensions("logic_ternary",ci),u.defineBlocks$$module$build$src$core$common(ke);var se={blocks:ke},Ve=u.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"lists_create_empty",message0:"%{BKY_LISTS_CREATE_EMPTY_TITLE}",output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_CREATE_EMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_CREATE_EMPTY_HELPURL}"},{type:"lists_repeat",message0:"%{BKY_LISTS_REPEAT_TITLE}",args0:[{type:"input_value",name:"ITEM"},{type:"input_value",name:"NUM",check:"Number"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_LISTS_REPEAT_HELPURL}"},{type:"lists_reverse",message0:"%{BKY_LISTS_REVERSE_MESSAGE0}",args0:[{type:"input_value",name:"LIST",check:"Array"}],output:"Array",inputsInline:!0,style:"list_blocks",tooltip:"%{BKY_LISTS_REVERSE_TOOLTIP}",helpUrl:"%{BKY_LISTS_REVERSE_HELPURL}"},{type:"lists_isEmpty",message0:"%{BKY_LISTS_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"list_blocks",tooltip:"%{BKY_LISTS_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_ISEMPTY_HELPURL}"},{type:"lists_length",message0:"%{BKY_LISTS_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"list_blocks",tooltip:"%{BKY_LISTS_LENGTH_TOOLTIP}",helpUrl:"%{BKY_LISTS_LENGTH_HELPURL}"}]);Ve.lists_create_with={init:function(){this.setHelpUrl(u.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_HELPURL),this.setStyle("list_blocks"),this.itemCount_=3,this.updateShape_(),this.setOutput(!0,"Array"),this.setMutator(new u.MutatorIcon$$module$build$src$core$icons$mutator_icon(["lists_create_with_item"],this)),this.setTooltip(u.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_TOOLTIP)},mutationToDom:function(){const c=u.createElement$$module$build$src$core$utils$xml("mutation");return c.setAttribute("items",String(this.itemCount_)),c},domToMutation:function(c){if(!(c=c.getAttribute("items")))throw new TypeError("element did not have items");this.itemCount_=parseInt(c,10),this.updateShape_()},saveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function(c){this.itemCount_=c.itemCount,this.updateShape_()},decompose:function(c){const h=c.newBlock("lists_create_with_container");h.initSvg();let _=h.getInput("STACK").connection;for(let T=0;T<this.itemCount_;T++){const w=c.newBlock("lists_create_with_item");if(w.initSvg(),!w.previousConnection)throw Error("itemBlock has no previousConnection");_.connect(w.previousConnection),_=w.nextConnection}return h},compose:function(c){var h=c.getInputTargetBlock("STACK");for(c=[];h;)h.isInsertionMarker()||c.push(h.valueConnection_),h=h.getNextBlock();for(h=0;h<this.itemCount_;h++){const _=this.getInput("ADD"+h).connection.targetConnection;_&&!c.includes(_)&&_.disconnect()}for(this.itemCount_=c.length,this.updateShape_(),h=0;h<this.itemCount_;h++){let _;null==(_=c[h])||_.reconnect(this,"ADD"+h)}},saveConnections:function(c){c=c.getInputTargetBlock("STACK");let h=0;for(;c;){if(c.isInsertionMarker()){c=c.getNextBlock();continue}const _=this.getInput("ADD"+h);let T;c.valueConnection_=null==(T=_)?void 0:T.connection.targetConnection,c=c.getNextBlock(),h++}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(u.Msg$$module$build$src$core$msg.LISTS_CREATE_EMPTY_TITLE);for(var c=0;c<this.itemCount_;c++)if(!this.getInput("ADD"+c)){const h=this.appendValueInput("ADD"+c).setAlign(u.Align$$module$build$src$core$inputs$align.RIGHT);0===c&&h.appendField(u.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_INPUT_WITH)}for(c=this.itemCount_;this.getInput("ADD"+c);c++)this.removeInput("ADD"+c)}},Ve.lists_create_with_container={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(u.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD),this.appendStatementInput("STACK"),this.setTooltip(u.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP),this.contextMenu=!1}},Ve.lists_create_with_item={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(u.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_ITEM_TITLE),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(u.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_ITEM_TOOLTIP),this.contextMenu=!1}},Ve.lists_indexOf={init:function(){var c=[[u.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_FIRST,"FIRST"],[u.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_LAST,"LAST"]];if(this.setHelpUrl(u.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_HELPURL),this.setStyle("list_blocks"),this.setOutput(!0,"Number"),this.appendValueInput("VALUE").setCheck("Array").appendField(u.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_INPUT_IN_LIST),!(c=u.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:c})))throw Error("field_dropdown not found");this.appendValueInput("FIND").appendField(c,"END"),this.setInputsInline(!0),this.setTooltip(()=>u.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"0":"-1"))}},Ve.lists_getIndex={init:function(){var c=[[u.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_GET,"GET"],[u.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_GET_REMOVE,"GET_REMOVE"],[u.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_REMOVE,"REMOVE"]];this.WHERE_OPTIONS=[[u.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[u.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[u.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FIRST,"FIRST"],[u.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_LAST,"LAST"],[u.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(u.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_HELPURL),this.setStyle("list_blocks"),(c=u.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:c})).setValidator(function(h){h="REMOVE"===h,this.getSourceBlock().updateStatement_(h)}),this.appendValueInput("VALUE").setCheck("Array").appendField(u.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(c,"MODE").appendField("","SPACE"),(c=u.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this.WHERE_OPTIONS})).setValidator(function(h){const _=this.getValue();(h="FROM_START"===h||"FROM_END"===h)!=("FROM_START"===_||"FROM_END"===_)&&this.getSourceBlock().updateAt_(h)}),this.appendDummyInput().appendField(c,"WHERE"),this.appendDummyInput("AT"),u.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL&&this.appendDummyInput("TAIL").appendField(u.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL),this.setInputsInline(!0),this.setOutput(!0),this.updateAt_(!0),this.setTooltip(()=>{const h=this.getFieldValue("MODE"),_=this.getFieldValue("WHERE");let T="";switch(h+" "+_){case"GET FROM_START":case"GET FROM_END":T=u.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM;break;case"GET FIRST":T=u.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST;break;case"GET LAST":T=u.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST;break;case"GET RANDOM":T=u.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM;break;case"GET_REMOVE FROM_START":case"GET_REMOVE FROM_END":T=u.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM;break;case"GET_REMOVE FIRST":T=u.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST;break;case"GET_REMOVE LAST":T=u.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST;break;case"GET_REMOVE RANDOM":T=u.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM;break;case"REMOVE FROM_START":case"REMOVE FROM_END":T=u.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM;break;case"REMOVE FIRST":T=u.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST;break;case"REMOVE LAST":T=u.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST;break;case"REMOVE RANDOM":T=u.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM}return("FROM_START"===_||"FROM_END"===_)&&(T+="  "+("FROM_START"===_?u.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP:u.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_END_TOOLTIP).replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),T})},mutationToDom:function(){const c=u.createElement$$module$build$src$core$utils$xml("mutation");c.setAttribute("statement",String(!this.outputConnection));const h=this.getInput("AT")instanceof u.ValueInput$$module$build$src$core$inputs$value_input;return c.setAttribute("at",String(h)),c},domToMutation:function(c){const h="true"===c.getAttribute("statement");this.updateStatement_(h),c="false"!==c.getAttribute("at"),this.updateAt_(c)},saveExtraState:function(){return this.outputConnection?null:{isStatement:!0}},loadExtraState:function(c){c.isStatement?this.updateStatement_(!0):"string"==typeof c&&this.domToMutation(u.textToDom$$module$build$src$core$utils$xml(c))},updateStatement_:function(c){c!==!this.outputConnection&&(this.unplug(!0,!0),c?(this.setOutput(!1),this.setPreviousStatement(!0),this.setNextStatement(!0)):(this.setPreviousStatement(!1),this.setNextStatement(!1),this.setOutput(!0)))},updateAt_:function(c){this.removeInput("AT"),this.removeInput("ORDINAL",!0),c?(this.appendValueInput("AT").setCheck("Number"),u.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(u.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"),u.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL&&this.moveInputBefore("TAIL",null)}},Ve.lists_setIndex={init:function(){var c=[[u.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_SET,"SET"],[u.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INSERT,"INSERT"]];this.WHERE_OPTIONS=[[u.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[u.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[u.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FIRST,"FIRST"],[u.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_LAST,"LAST"],[u.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(u.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(u.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INPUT_IN_LIST),c=u.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:c}),this.appendDummyInput().appendField(c,"MODE").appendField("","SPACE"),(c=u.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this.WHERE_OPTIONS})).setValidator(function(h){const _=this.getValue();(h="FROM_START"===h||"FROM_END"===h)!=("FROM_START"===_||"FROM_END"===_)&&this.getSourceBlock().updateAt_(h)}),this.appendDummyInput().appendField(c,"WHERE"),this.appendDummyInput("AT"),this.appendValueInput("TO").appendField(u.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INPUT_TO),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(u.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP),this.updateAt_(!0),this.setTooltip(()=>{const h=this.getFieldValue("MODE"),_=this.getFieldValue("WHERE");let T="";switch(h+" "+_){case"SET FROM_START":case"SET FROM_END":T=u.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM;break;case"SET FIRST":T=u.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST;break;case"SET LAST":T=u.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST;break;case"SET RANDOM":T=u.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM;break;case"INSERT FROM_START":case"INSERT FROM_END":T=u.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM;break;case"INSERT FIRST":T=u.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST;break;case"INSERT LAST":T=u.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST;break;case"INSERT RANDOM":T=u.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM}return("FROM_START"===_||"FROM_END"===_)&&(T+="  "+u.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),T})},mutationToDom:function(){const c=u.createElement$$module$build$src$core$utils$xml("mutation"),h=this.getInput("AT")instanceof u.ValueInput$$module$build$src$core$inputs$value_input;return c.setAttribute("at",String(h)),c},domToMutation:function(c){c="false"!==c.getAttribute("at"),this.updateAt_(c)},saveExtraState:function(){return null},loadExtraState:function(){},updateAt_:function(c){this.removeInput("AT"),this.removeInput("ORDINAL",!0),c?(this.appendValueInput("AT").setCheck("Number"),u.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(u.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"),this.moveInputBefore("AT","TO"),this.getInput("ORDINAL")&&this.moveInputBefore("ORDINAL","TO")}},Ve.lists_getSublist={init:function(){this.WHERE_OPTIONS_1=[[u.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FROM_START,"FROM_START"],[u.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FROM_END,"FROM_END"],[u.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[u.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_FROM_START,"FROM_START"],[u.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_FROM_END,"FROM_END"],[u.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_LAST,"LAST"]],this.setHelpUrl(u.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(u.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_INPUT_IN_LIST);const c=h=>{const _=u.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this["WHERE_OPTIONS_"+h]});return _.setValidator(function(T){const w=this.getValue();(T="FROM_START"===T||"FROM_END"===T)!=("FROM_START"===w||"FROM_END"===w)&&this.getSourceBlock().updateAt_(h,T)}),_};this.appendDummyInput("WHERE1_INPUT").appendField(c(1),"WHERE1"),this.appendDummyInput("AT1"),this.appendDummyInput("WHERE2_INPUT").appendField(c(2),"WHERE2"),this.appendDummyInput("AT2"),u.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL&&this.appendDummyInput("TAIL").appendField(u.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(u.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TOOLTIP)},mutationToDom:function(){const c=u.createElement$$module$build$src$core$utils$xml("mutation");var h=this.getInput("AT1")instanceof u.ValueInput$$module$build$src$core$inputs$value_input;return c.setAttribute("at1",String(h)),h=this.getInput("AT2")instanceof u.ValueInput$$module$build$src$core$inputs$value_input,c.setAttribute("at2",String(h)),c},domToMutation:function(c){const h="true"===c.getAttribute("at1");c="true"===c.getAttribute("at2"),this.updateAt_(1,h),this.updateAt_(2,c)},saveExtraState:function(){return null},loadExtraState:function(){},updateAt_:function(c,h){this.removeInput("AT"+c),this.removeInput("ORDINAL"+c,!0),h?(this.appendValueInput("AT"+c).setCheck("Number"),u.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+c).appendField(u.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+c),1===c&&(this.moveInputBefore("AT1","WHERE2_INPUT"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","WHERE2_INPUT")),u.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL&&this.moveInputBefore("TAIL",null)}},Ve.lists_sort={init:function(){this.jsonInit({message0:"%{BKY_LISTS_SORT_TITLE}",args0:[{type:"field_dropdown",name:"TYPE",options:[["%{BKY_LISTS_SORT_TYPE_NUMERIC}","NUMERIC"],["%{BKY_LISTS_SORT_TYPE_TEXT}","TEXT"],["%{BKY_LISTS_SORT_TYPE_IGNORECASE}","IGNORE_CASE"]]},{type:"field_dropdown",name:"DIRECTION",options:[["%{BKY_LISTS_SORT_ORDER_ASCENDING}","1"],["%{BKY_LISTS_SORT_ORDER_DESCENDING}","-1"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_SORT_TOOLTIP}",helpUrl:"%{BKY_LISTS_SORT_HELPURL}"})}},Ve.lists_split={init:function(){const c=u.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:[[u.Msg$$module$build$src$core$msg.LISTS_SPLIT_LIST_FROM_TEXT,"SPLIT"],[u.Msg$$module$build$src$core$msg.LISTS_SPLIT_TEXT_FROM_LIST,"JOIN"]]});if(!c)throw Error("field_dropdown not found");c.setValidator(h=>{this.updateType_(h)}),this.setHelpUrl(u.Msg$$module$build$src$core$msg.LISTS_SPLIT_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("INPUT").setCheck("String").appendField(c,"MODE"),this.appendValueInput("DELIM").setCheck("String").appendField(u.Msg$$module$build$src$core$msg.LISTS_SPLIT_WITH_DELIMITER),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.setTooltip(()=>{const h=this.getFieldValue("MODE");if("SPLIT"===h)return u.Msg$$module$build$src$core$msg.LISTS_SPLIT_TOOLTIP_SPLIT;if("JOIN"===h)return u.Msg$$module$build$src$core$msg.LISTS_SPLIT_TOOLTIP_JOIN;throw Error("Unknown mode: "+h)})},updateType_:function(c){if(this.getFieldValue("MODE")!==c){const h=this.getInput("INPUT").connection;h.setShadowDom(null);const _=h.targetBlock();_&&(h.disconnect(),_.isShadow()?_.dispose(!1):this.bumpNeighbours())}"SPLIT"===c?(this.outputConnection.setCheck("Array"),this.getInput("INPUT").setCheck("String")):(this.outputConnection.setCheck("String"),this.getInput("INPUT").setCheck("Array"))},mutationToDom:function(){const c=u.createElement$$module$build$src$core$utils$xml("mutation");return c.setAttribute("mode",this.getFieldValue("MODE")),c},domToMutation:function(c){this.updateType_(c.getAttribute("mode"))},saveExtraState:function(){return{mode:this.getFieldValue("MODE")}},loadExtraState:function(c){this.updateType_(c.mode)}},u.defineBlocks$$module$build$src$core$common(Ve);var X={blocks:Ve},J={blocks:Object.assign({},Ve,ke,ni,ii,Te,Ie,io,et),lists:X,logic:se,loops:Ks,math:yo,procedures:Vs,texts:ze,variables:Ae,variablesDynamic:Tt};return J.__namespace__=u,J},void 0!==(o=Z.apply(oo,Be))&&(Qo.exports=o)},3329:function(Qo,oo,le){var Z,Be,o;Be=[le(7519),le(8905),le(8927)],void 0!==(o="function"==typeof(Z=function(U,u,et){"use strict";return U.setLocale(u),U})?Z.apply(oo,Be):Z)&&(Qo.exports=o)},8905:function(Qo,oo){var le,Be;void 0!==(Be="function"==typeof(le=function(){"use strict";var o=o||{Msg:Object.create(null)};return o.Msg.ADD_COMMENT="Add Comment",o.Msg.ALT_KEY="Alt",o.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE="Can't delete the variable '%1' because it's part of the definition of the function '%2'",o.Msg.CHANGE_VALUE_TITLE="Change value:",o.Msg.CHROME_OS="ChromeOS",o.Msg.CLEAN_UP="Clean up Blocks",o.Msg.CLOSE="Close",o.Msg.COLLAPSED_WARNINGS_WARNING="Collapsed blocks contain warnings.",o.Msg.COLLAPSE_ALL="Collapse Blocks",o.Msg.COLLAPSE_BLOCK="Collapse Block",o.Msg.COLOUR_BLEND_COLOUR1="colour 1",o.Msg.COLOUR_BLEND_COLOUR2="colour 2",o.Msg.COLOUR_BLEND_HELPURL="https://meyerweb.com/eric/tools/color-blend/#:::rgbp",o.Msg.COLOUR_BLEND_RATIO="ratio",o.Msg.COLOUR_BLEND_TITLE="blend",o.Msg.COLOUR_BLEND_TOOLTIP="Blends two colours together with a given ratio (0.0 - 1.0).",o.Msg.COLOUR_PICKER_HELPURL="https://en.wikipedia.org/wiki/Color",o.Msg.COLOUR_PICKER_TOOLTIP="Choose a colour from the palette.",o.Msg.COLOUR_RANDOM_HELPURL="http://randomcolour.com",o.Msg.COLOUR_RANDOM_TITLE="random colour",o.Msg.COLOUR_RANDOM_TOOLTIP="Choose a colour at random.",o.Msg.COLOUR_RGB_BLUE="blue",o.Msg.COLOUR_RGB_GREEN="green",o.Msg.COLOUR_RGB_HELPURL="https://www.december.com/html/spec/colorpercompact.html",o.Msg.COLOUR_RGB_RED="red",o.Msg.COLOUR_RGB_TITLE="colour with",o.Msg.COLOUR_RGB_TOOLTIP="Create a colour with the specified amount of red, green, and blue. All values must be between 0 and 100.",o.Msg.COMMAND_KEY="\u2318 Command",o.Msg.CONTROLS_FLOW_STATEMENTS_HELPURL="https://github.com/google/blockly/wiki/Loops#loop-termination-blocks",o.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK="break out of loop",o.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE="continue with next iteration of loop",o.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK="Break out of the containing loop.",o.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE="Skip the rest of this loop, and continue with the next iteration.",o.Msg.CONTROLS_FLOW_STATEMENTS_WARNING="Warning: This block may only be used within a loop.",o.Msg.CONTROLS_FOREACH_HELPURL="https://github.com/google/blockly/wiki/Loops#for-each",o.Msg.CONTROLS_FOREACH_TITLE="for each item %1 in list %2",o.Msg.CONTROLS_FOREACH_TOOLTIP="For each item in a list, set the variable '%1' to the item, and then do some statements.",o.Msg.CONTROLS_FOR_HELPURL="https://github.com/google/blockly/wiki/Loops#count-with",o.Msg.CONTROLS_FOR_TITLE="count with %1 from %2 to %3 by %4",o.Msg.CONTROLS_FOR_TOOLTIP="Have the variable '%1' take on the values from the start number to the end number, counting by the specified interval, and do the specified blocks.",o.Msg.CONTROLS_IF_ELSEIF_TOOLTIP="Add a condition to the if block.",o.Msg.CONTROLS_IF_ELSE_TOOLTIP="Add a final, catch-all condition to the if block.",o.Msg.CONTROLS_IF_HELPURL="https://github.com/google/blockly/wiki/IfElse",o.Msg.CONTROLS_IF_IF_TOOLTIP="Add, remove, or reorder sections to reconfigure this if block.",o.Msg.CONTROLS_IF_MSG_ELSE="else",o.Msg.CONTROLS_IF_MSG_ELSEIF="else if",o.Msg.CONTROLS_IF_MSG_IF="if",o.Msg.CONTROLS_IF_TOOLTIP_1="If a value is true, then do some statements.",o.Msg.CONTROLS_IF_TOOLTIP_2="If a value is true, then do the first block of statements. Otherwise, do the second block of statements.",o.Msg.CONTROLS_IF_TOOLTIP_3="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements.",o.Msg.CONTROLS_IF_TOOLTIP_4="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements. If none of the values are true, do the last block of statements.",o.Msg.CONTROLS_REPEAT_HELPURL="https://en.wikipedia.org/wiki/For_loop",o.Msg.CONTROLS_REPEAT_INPUT_DO="do",o.Msg.CONTROLS_REPEAT_TITLE="repeat %1 times",o.Msg.CONTROLS_REPEAT_TOOLTIP="Do some statements several times.",o.Msg.CONTROLS_WHILEUNTIL_HELPURL="https://github.com/google/blockly/wiki/Loops#repeat",o.Msg.CONTROLS_WHILEUNTIL_OPERATOR_UNTIL="repeat until",o.Msg.CONTROLS_WHILEUNTIL_OPERATOR_WHILE="repeat while",o.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL="While a value is false, then do some statements.",o.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_WHILE="While a value is true, then do some statements.",o.Msg.CONTROL_KEY="Ctrl",o.Msg.COPY_SHORTCUT="Copy",o.Msg.CUT_SHORTCUT="Cut",o.Msg.DELETE_ALL_BLOCKS="Delete all %1 blocks?",o.Msg.DELETE_BLOCK="Delete Block",o.Msg.DELETE_VARIABLE="Delete the '%1' variable",o.Msg.DELETE_VARIABLE_CONFIRMATION="Delete %1 uses of the '%2' variable?",o.Msg.DELETE_X_BLOCKS="Delete %1 Blocks",o.Msg.DIALOG_CANCEL="Cancel",o.Msg.DIALOG_OK="OK",o.Msg.DISABLE_BLOCK="Disable Block",o.Msg.DUPLICATE_BLOCK="Duplicate",o.Msg.DUPLICATE_COMMENT="Duplicate Comment",o.Msg.EDIT_BLOCK_CONTENTS="Edit Block contents",o.Msg.ENABLE_BLOCK="Enable Block",o.Msg.EXPAND_ALL="Expand Blocks",o.Msg.EXPAND_BLOCK="Expand Block",o.Msg.EXTERNAL_INPUTS="External Inputs",o.Msg.HELP="Help",o.Msg.HELP_PROMPT="Press %1 for help on keyboard controls",o.Msg.INLINE_INPUTS="Inline Inputs",o.Msg.KEYBOARD_NAV_CONSTRAINED_MOVE_HINT="Use the arrow keys to move, then %1 to accept the position",o.Msg.KEYBOARD_NAV_COPIED_HINT="Copied. Press %1 to paste.",o.Msg.KEYBOARD_NAV_CUT_HINT="Cut. Press %1 to paste.",o.Msg.KEYBOARD_NAV_UNCONSTRAINED_MOVE_HINT="Hold %1 and use arrow keys to move freely, then %2 to accept the position",o.Msg.LINUX="Linux",o.Msg.LISTS_CREATE_EMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#create-empty-list",o.Msg.LISTS_CREATE_EMPTY_TITLE="create empty list",o.Msg.LISTS_CREATE_EMPTY_TOOLTIP="Returns a list, of length 0, containing no data records",o.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD="list",o.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP="Add, remove, or reorder sections to reconfigure this list block.",o.Msg.LISTS_CREATE_WITH_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",o.Msg.LISTS_CREATE_WITH_INPUT_WITH="create list with",o.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP="Add an item to the list.",o.Msg.LISTS_CREATE_WITH_TOOLTIP="Create a list with any number of items.",o.Msg.LISTS_GET_INDEX_FIRST="first",o.Msg.LISTS_GET_INDEX_FROM_END="# from end",o.Msg.LISTS_GET_INDEX_FROM_START="#",o.Msg.LISTS_GET_INDEX_GET="get",o.Msg.LISTS_GET_INDEX_GET_REMOVE="get and remove",o.Msg.LISTS_GET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-items-from-a-list",o.Msg.LISTS_GET_INDEX_LAST="last",o.Msg.LISTS_GET_INDEX_RANDOM="random",o.Msg.LISTS_GET_INDEX_REMOVE="remove",o.Msg.LISTS_GET_INDEX_TAIL="",o.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST="Returns the first item in a list.",o.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM="Returns the item at the specified position in a list.",o.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST="Returns the last item in a list.",o.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM="Returns a random item in a list.",o.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST="Removes and returns the first item in a list.",o.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM="Removes and returns the item at the specified position in a list.",o.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST="Removes and returns the last item in a list.",o.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM="Removes and returns a random item in a list.",o.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST="Removes the first item in a list.",o.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM="Removes the item at the specified position in a list.",o.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST="Removes the last item in a list.",o.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM="Removes a random item in a list.",o.Msg.LISTS_GET_SUBLIST_END_FROM_END="to # from end",o.Msg.LISTS_GET_SUBLIST_END_FROM_START="to #",o.Msg.LISTS_GET_SUBLIST_END_LAST="to last",o.Msg.LISTS_GET_SUBLIST_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-a-sublist",o.Msg.LISTS_GET_SUBLIST_START_FIRST="get sub-list from first",o.Msg.LISTS_GET_SUBLIST_START_FROM_END="get sub-list from # from end",o.Msg.LISTS_GET_SUBLIST_START_FROM_START="get sub-list from #",o.Msg.LISTS_GET_SUBLIST_TAIL="",o.Msg.LISTS_GET_SUBLIST_TOOLTIP="Creates a copy of the specified portion of a list.",o.Msg.LISTS_INDEX_FROM_END_TOOLTIP="%1 is the last item.",o.Msg.LISTS_INDEX_FROM_START_TOOLTIP="%1 is the first item.",o.Msg.LISTS_INDEX_OF_FIRST="find first occurrence of item",o.Msg.LISTS_INDEX_OF_HELPURL="https://github.com/google/blockly/wiki/Lists#finding-items-in-a-list",o.Msg.LISTS_INDEX_OF_LAST="find last occurrence of item",o.Msg.LISTS_INDEX_OF_TOOLTIP="Returns the index of the first/last occurrence of the item in the list. Returns %1 if item is not found.",o.Msg.LISTS_INLIST="in list",o.Msg.LISTS_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#is-empty",o.Msg.LISTS_ISEMPTY_TITLE="%1 is empty",o.Msg.LISTS_ISEMPTY_TOOLTIP="Returns true if the list is empty.",o.Msg.LISTS_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Lists#length-of",o.Msg.LISTS_LENGTH_TITLE="length of %1",o.Msg.LISTS_LENGTH_TOOLTIP="Returns the length of a list.",o.Msg.LISTS_REPEAT_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",o.Msg.LISTS_REPEAT_TITLE="create list with item %1 repeated %2 times",o.Msg.LISTS_REPEAT_TOOLTIP="Creates a list consisting of the given value repeated the specified number of times.",o.Msg.LISTS_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Lists#reversing-a-list",o.Msg.LISTS_REVERSE_MESSAGE0="reverse %1",o.Msg.LISTS_REVERSE_TOOLTIP="Reverse a copy of a list.",o.Msg.LISTS_SET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#in-list--set",o.Msg.LISTS_SET_INDEX_INPUT_TO="as",o.Msg.LISTS_SET_INDEX_INSERT="insert at",o.Msg.LISTS_SET_INDEX_SET="set",o.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST="Inserts the item at the start of a list.",o.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM="Inserts the item at the specified position in a list.",o.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST="Append the item to the end of a list.",o.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM="Inserts the item randomly in a list.",o.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST="Sets the first item in a list.",o.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM="Sets the item at the specified position in a list.",o.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST="Sets the last item in a list.",o.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM="Sets a random item in a list.",o.Msg.LISTS_SORT_HELPURL="https://github.com/google/blockly/wiki/Lists#sorting-a-list",o.Msg.LISTS_SORT_ORDER_ASCENDING="ascending",o.Msg.LISTS_SORT_ORDER_DESCENDING="descending",o.Msg.LISTS_SORT_TITLE="sort %1 %2 %3",o.Msg.LISTS_SORT_TOOLTIP="Sort a copy of a list.",o.Msg.LISTS_SORT_TYPE_IGNORECASE="alphabetic, ignore case",o.Msg.LISTS_SORT_TYPE_NUMERIC="numeric",o.Msg.LISTS_SORT_TYPE_TEXT="alphabetic",o.Msg.LISTS_SPLIT_HELPURL="https://github.com/google/blockly/wiki/Lists#splitting-strings-and-joining-lists",o.Msg.LISTS_SPLIT_LIST_FROM_TEXT="make list from text",o.Msg.LISTS_SPLIT_TEXT_FROM_LIST="make text from list",o.Msg.LISTS_SPLIT_TOOLTIP_JOIN="Join a list of texts into one text, separated by a delimiter.",o.Msg.LISTS_SPLIT_TOOLTIP_SPLIT="Split text into a list of texts, breaking at each delimiter.",o.Msg.LISTS_SPLIT_WITH_DELIMITER="with delimiter",o.Msg.LOGIC_BOOLEAN_FALSE="false",o.Msg.LOGIC_BOOLEAN_HELPURL="https://github.com/google/blockly/wiki/Logic#values",o.Msg.LOGIC_BOOLEAN_TOOLTIP="Returns either true or false.",o.Msg.LOGIC_BOOLEAN_TRUE="true",o.Msg.LOGIC_COMPARE_HELPURL="https://en.wikipedia.org/wiki/Inequality_(mathematics)",o.Msg.LOGIC_COMPARE_TOOLTIP_EQ="Return true if both inputs equal each other.",o.Msg.LOGIC_COMPARE_TOOLTIP_GT="Return true if the first input is greater than the second input.",o.Msg.LOGIC_COMPARE_TOOLTIP_GTE="Return true if the first input is greater than or equal to the second input.",o.Msg.LOGIC_COMPARE_TOOLTIP_LT="Return true if the first input is smaller than the second input.",o.Msg.LOGIC_COMPARE_TOOLTIP_LTE="Return true if the first input is smaller than or equal to the second input.",o.Msg.LOGIC_COMPARE_TOOLTIP_NEQ="Return true if both inputs are not equal to each other.",o.Msg.LOGIC_NEGATE_HELPURL="https://github.com/google/blockly/wiki/Logic#not",o.Msg.LOGIC_NEGATE_TITLE="not %1",o.Msg.LOGIC_NEGATE_TOOLTIP="Returns true if the input is false. Returns false if the input is true.",o.Msg.LOGIC_NULL="null",o.Msg.LOGIC_NULL_HELPURL="https://en.wikipedia.org/wiki/Nullable_type",o.Msg.LOGIC_NULL_TOOLTIP="Returns null.",o.Msg.LOGIC_OPERATION_AND="and",o.Msg.LOGIC_OPERATION_HELPURL="https://github.com/google/blockly/wiki/Logic#logical-operations",o.Msg.LOGIC_OPERATION_OR="or",o.Msg.LOGIC_OPERATION_TOOLTIP_AND="Return true if both inputs are true.",o.Msg.LOGIC_OPERATION_TOOLTIP_OR="Return true if at least one of the inputs is true.",o.Msg.LOGIC_TERNARY_CONDITION="test",o.Msg.LOGIC_TERNARY_HELPURL="https://en.wikipedia.org/wiki/%3F:",o.Msg.LOGIC_TERNARY_IF_FALSE="if false",o.Msg.LOGIC_TERNARY_IF_TRUE="if true",o.Msg.LOGIC_TERNARY_TOOLTIP="Check the condition in 'test'. If the condition is true, returns the 'if true' value; otherwise returns the 'if false' value.",o.Msg.MAC_OS="macOS",o.Msg.MATH_ADDITION_SYMBOL="+",o.Msg.MATH_ARITHMETIC_HELPURL="https://en.wikipedia.org/wiki/Arithmetic",o.Msg.MATH_ARITHMETIC_TOOLTIP_ADD="Return the sum of the two numbers.",o.Msg.MATH_ARITHMETIC_TOOLTIP_DIVIDE="Return the quotient of the two numbers.",o.Msg.MATH_ARITHMETIC_TOOLTIP_MINUS="Return the difference of the two numbers.",o.Msg.MATH_ARITHMETIC_TOOLTIP_MULTIPLY="Return the product of the two numbers.",o.Msg.MATH_ARITHMETIC_TOOLTIP_POWER="Return the first number raised to the power of the second number.",o.Msg.MATH_ATAN2_HELPURL="https://en.wikipedia.org/wiki/Atan2",o.Msg.MATH_ATAN2_TITLE="atan2 of X:%1 Y:%2",o.Msg.MATH_ATAN2_TOOLTIP="Return the arctangent of point (X, Y) in degrees from -180 to 180.",o.Msg.MATH_CHANGE_HELPURL="https://en.wikipedia.org/wiki/Programming_idiom#Incrementing_a_counter",o.Msg.MATH_CHANGE_TITLE="change %1 by %2",o.Msg.MATH_CHANGE_TOOLTIP="Add a number to variable '%1'.",o.Msg.MATH_CONSTANT_HELPURL="https://en.wikipedia.org/wiki/Mathematical_constant",o.Msg.MATH_CONSTANT_TOOLTIP="Return one of the common constants: \u03c0 (3.141\u2026), e (2.718\u2026), \u03c6 (1.618\u2026), sqrt(2) (1.414\u2026), sqrt(\xbd) (0.707\u2026), or \u221e (infinity).",o.Msg.MATH_CONSTRAIN_HELPURL="https://en.wikipedia.org/wiki/Clamping_(graphics)",o.Msg.MATH_CONSTRAIN_TITLE="constrain %1 low %2 high %3",o.Msg.MATH_CONSTRAIN_TOOLTIP="Constrain a number to be between the specified limits (inclusive).",o.Msg.MATH_DIVISION_SYMBOL="\xf7",o.Msg.MATH_IS_DIVISIBLE_BY="is divisible by",o.Msg.MATH_IS_EVEN="is even",o.Msg.MATH_IS_NEGATIVE="is negative",o.Msg.MATH_IS_ODD="is odd",o.Msg.MATH_IS_POSITIVE="is positive",o.Msg.MATH_IS_PRIME="is prime",o.Msg.MATH_IS_TOOLTIP="Check if a number is an even, odd, prime, whole, positive, negative, or if it is divisible by certain number. Returns true or false.",o.Msg.MATH_IS_WHOLE="is whole",o.Msg.MATH_MODULO_HELPURL="https://en.wikipedia.org/wiki/Modulo_operation",o.Msg.MATH_MODULO_TITLE="remainder of %1 \xf7 %2",o.Msg.MATH_MODULO_TOOLTIP="Return the remainder from dividing the two numbers.",o.Msg.MATH_MULTIPLICATION_SYMBOL="\xd7",o.Msg.MATH_NUMBER_HELPURL="https://en.wikipedia.org/wiki/Number",o.Msg.MATH_NUMBER_TOOLTIP="A number.",o.Msg.MATH_ONLIST_HELPURL="",o.Msg.MATH_ONLIST_OPERATOR_AVERAGE="average of list",o.Msg.MATH_ONLIST_OPERATOR_MAX="max of list",o.Msg.MATH_ONLIST_OPERATOR_MEDIAN="median of list",o.Msg.MATH_ONLIST_OPERATOR_MIN="min of list",o.Msg.MATH_ONLIST_OPERATOR_MODE="modes of list",o.Msg.MATH_ONLIST_OPERATOR_RANDOM="random item of list",o.Msg.MATH_ONLIST_OPERATOR_STD_DEV="standard deviation of list",o.Msg.MATH_ONLIST_OPERATOR_SUM="sum of list",o.Msg.MATH_ONLIST_TOOLTIP_AVERAGE="Return the average (arithmetic mean) of the numeric values in the list.",o.Msg.MATH_ONLIST_TOOLTIP_MAX="Return the largest number in the list.",o.Msg.MATH_ONLIST_TOOLTIP_MEDIAN="Return the median number in the list.",o.Msg.MATH_ONLIST_TOOLTIP_MIN="Return the smallest number in the list.",o.Msg.MATH_ONLIST_TOOLTIP_MODE="Return a list of the most common item(s) in the list.",o.Msg.MATH_ONLIST_TOOLTIP_RANDOM="Return a random element from the list.",o.Msg.MATH_ONLIST_TOOLTIP_STD_DEV="Return the standard deviation of the list.",o.Msg.MATH_ONLIST_TOOLTIP_SUM="Return the sum of all the numbers in the list.",o.Msg.MATH_POWER_SYMBOL="^",o.Msg.MATH_RANDOM_FLOAT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",o.Msg.MATH_RANDOM_FLOAT_TITLE_RANDOM="random fraction",o.Msg.MATH_RANDOM_FLOAT_TOOLTIP="Return a random fraction between 0.0 (inclusive) and 1.0 (exclusive).",o.Msg.MATH_RANDOM_INT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",o.Msg.MATH_RANDOM_INT_TITLE="random integer from %1 to %2",o.Msg.MATH_RANDOM_INT_TOOLTIP="Return a random integer between the two specified limits, inclusive.",o.Msg.MATH_ROUND_HELPURL="https://en.wikipedia.org/wiki/Rounding",o.Msg.MATH_ROUND_OPERATOR_ROUND="round",o.Msg.MATH_ROUND_OPERATOR_ROUNDDOWN="round down",o.Msg.MATH_ROUND_OPERATOR_ROUNDUP="round up",o.Msg.MATH_ROUND_TOOLTIP="Round a number up or down.",o.Msg.MATH_SINGLE_HELPURL="https://en.wikipedia.org/wiki/Square_root",o.Msg.MATH_SINGLE_OP_ABSOLUTE="absolute",o.Msg.MATH_SINGLE_OP_ROOT="square root",o.Msg.MATH_SINGLE_TOOLTIP_ABS="Return the absolute value of a number.",o.Msg.MATH_SINGLE_TOOLTIP_EXP="Return e to the power of a number.",o.Msg.MATH_SINGLE_TOOLTIP_LN="Return the natural logarithm of a number.",o.Msg.MATH_SINGLE_TOOLTIP_LOG10="Return the base 10 logarithm of a number.",o.Msg.MATH_SINGLE_TOOLTIP_NEG="Return the negation of a number.",o.Msg.MATH_SINGLE_TOOLTIP_POW10="Return 10 to the power of a number.",o.Msg.MATH_SINGLE_TOOLTIP_ROOT="Return the square root of a number.",o.Msg.MATH_SUBTRACTION_SYMBOL="-",o.Msg.MATH_TRIG_ACOS="acos",o.Msg.MATH_TRIG_ASIN="asin",o.Msg.MATH_TRIG_ATAN="atan",o.Msg.MATH_TRIG_COS="cos",o.Msg.MATH_TRIG_HELPURL="https://en.wikipedia.org/wiki/Trigonometric_functions",o.Msg.MATH_TRIG_SIN="sin",o.Msg.MATH_TRIG_TAN="tan",o.Msg.MATH_TRIG_TOOLTIP_ACOS="Return the arccosine of a number.",o.Msg.MATH_TRIG_TOOLTIP_ASIN="Return the arcsine of a number.",o.Msg.MATH_TRIG_TOOLTIP_ATAN="Return the arctangent of a number.",o.Msg.MATH_TRIG_TOOLTIP_COS="Return the cosine of a degree (not radian).",o.Msg.MATH_TRIG_TOOLTIP_SIN="Return the sine of a degree (not radian).",o.Msg.MATH_TRIG_TOOLTIP_TAN="Return the tangent of a degree (not radian).",o.Msg.MOVE_BLOCK="Move Block",o.Msg.NEW_COLOUR_VARIABLE="Create colour variable...",o.Msg.NEW_NUMBER_VARIABLE="Create number variable...",o.Msg.NEW_STRING_VARIABLE="Create string variable...",o.Msg.NEW_VARIABLE="Create variable...",o.Msg.NEW_VARIABLE_TITLE="New variable name:",o.Msg.NEW_VARIABLE_TYPE_TITLE="New variable type:",o.Msg.OPTION_KEY="\u2325 Option",o.Msg.ORDINAL_NUMBER_SUFFIX="",o.Msg.PASTE_SHORTCUT="Paste",o.Msg.PROCEDURES_ALLOW_STATEMENTS="allow statements",o.Msg.PROCEDURES_BEFORE_PARAMS="with:",o.Msg.PROCEDURES_CALLNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",o.Msg.PROCEDURES_CALLNORETURN_TOOLTIP="Run the user-defined function '%1'.",o.Msg.PROCEDURES_CALLRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",o.Msg.PROCEDURES_CALLRETURN_TOOLTIP="Run the user-defined function '%1' and use its output.",o.Msg.PROCEDURES_CALL_BEFORE_PARAMS="with:",o.Msg.PROCEDURES_CALL_DISABLED_DEF_WARNING="Can't run the user-defined function '%1' because the definition block is disabled.",o.Msg.PROCEDURES_CREATE_DO="Create '%1'",o.Msg.PROCEDURES_DEFNORETURN_COMMENT="Describe this function...",o.Msg.PROCEDURES_DEFNORETURN_DO="",o.Msg.PROCEDURES_DEFNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",o.Msg.PROCEDURES_DEFNORETURN_PROCEDURE="do something",o.Msg.PROCEDURES_DEFNORETURN_TITLE="to",o.Msg.PROCEDURES_DEFNORETURN_TOOLTIP="Creates a function with no output.",o.Msg.PROCEDURES_DEFRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",o.Msg.PROCEDURES_DEFRETURN_RETURN="return",o.Msg.PROCEDURES_DEFRETURN_TOOLTIP="Creates a function with an output.",o.Msg.PROCEDURES_DEF_DUPLICATE_WARNING="Warning: This function has duplicate parameters.",o.Msg.PROCEDURES_HIGHLIGHT_DEF="Highlight function definition",o.Msg.PROCEDURES_IFRETURN_HELPURL="https://c2.com/cgi/wiki?GuardClause",o.Msg.PROCEDURES_IFRETURN_TOOLTIP="If a value is true, then return a second value.",o.Msg.PROCEDURES_IFRETURN_WARNING="Warning: This block may be used only within a function definition.",o.Msg.PROCEDURES_MUTATORARG_TITLE="input name:",o.Msg.PROCEDURES_MUTATORARG_TOOLTIP="Add an input to the function.",o.Msg.PROCEDURES_MUTATORCONTAINER_TITLE="inputs",o.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP="Add, remove, or reorder inputs to this function.",o.Msg.REDO="Redo",o.Msg.REMOVE_COMMENT="Remove Comment",o.Msg.RENAME_VARIABLE="Rename variable...",o.Msg.RENAME_VARIABLE_TITLE="Rename all '%1' variables to:",o.Msg.SHORTCUTS_CODE_NAVIGATION="Code navigation",o.Msg.SHORTCUTS_EDITING="Editing",o.Msg.SHORTCUTS_GENERAL="General",o.Msg.TEXT_APPEND_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",o.Msg.TEXT_APPEND_TITLE="to %1 append text %2",o.Msg.TEXT_APPEND_TOOLTIP="Append some text to variable '%1'.",o.Msg.TEXT_CHANGECASE_HELPURL="https://github.com/google/blockly/wiki/Text#adjusting-text-case",o.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE="to lower case",o.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE="to Title Case",o.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE="to UPPER CASE",o.Msg.TEXT_CHANGECASE_TOOLTIP="Return a copy of the text in a different case.",o.Msg.TEXT_CHARAT_FIRST="get first letter",o.Msg.TEXT_CHARAT_FROM_END="get letter # from end",o.Msg.TEXT_CHARAT_FROM_START="get letter #",o.Msg.TEXT_CHARAT_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-text",o.Msg.TEXT_CHARAT_LAST="get last letter",o.Msg.TEXT_CHARAT_RANDOM="get random letter",o.Msg.TEXT_CHARAT_TAIL="",o.Msg.TEXT_CHARAT_TITLE="in text %1 %2",o.Msg.TEXT_CHARAT_TOOLTIP="Returns the letter at the specified position.",o.Msg.TEXT_COUNT_HELPURL="https://github.com/google/blockly/wiki/Text#counting-substrings",o.Msg.TEXT_COUNT_MESSAGE0="count %1 in %2",o.Msg.TEXT_COUNT_TOOLTIP="Count how many times some text occurs within some other text.",o.Msg.TEXT_CREATE_JOIN_ITEM_TOOLTIP="Add an item to the text.",o.Msg.TEXT_CREATE_JOIN_TITLE_JOIN="join",o.Msg.TEXT_CREATE_JOIN_TOOLTIP="Add, remove, or reorder sections to reconfigure this text block.",o.Msg.TEXT_GET_SUBSTRING_END_FROM_END="to letter # from end",o.Msg.TEXT_GET_SUBSTRING_END_FROM_START="to letter #",o.Msg.TEXT_GET_SUBSTRING_END_LAST="to last letter",o.Msg.TEXT_GET_SUBSTRING_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-a-region-of-text",o.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT="in text",o.Msg.TEXT_GET_SUBSTRING_START_FIRST="get substring from first letter",o.Msg.TEXT_GET_SUBSTRING_START_FROM_END="get substring from letter # from end",o.Msg.TEXT_GET_SUBSTRING_START_FROM_START="get substring from letter #",o.Msg.TEXT_GET_SUBSTRING_TAIL="",o.Msg.TEXT_GET_SUBSTRING_TOOLTIP="Returns a specified portion of the text.",o.Msg.TEXT_INDEXOF_HELPURL="https://github.com/google/blockly/wiki/Text#finding-text",o.Msg.TEXT_INDEXOF_OPERATOR_FIRST="find first occurrence of text",o.Msg.TEXT_INDEXOF_OPERATOR_LAST="find last occurrence of text",o.Msg.TEXT_INDEXOF_TITLE="in text %1 %2 %3",o.Msg.TEXT_INDEXOF_TOOLTIP="Returns the index of the first/last occurrence of the first text in the second text. Returns %1 if text is not found.",o.Msg.TEXT_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Text#checking-for-empty-text",o.Msg.TEXT_ISEMPTY_TITLE="%1 is empty",o.Msg.TEXT_ISEMPTY_TOOLTIP="Returns true if the provided text is empty.",o.Msg.TEXT_JOIN_HELPURL="https://github.com/google/blockly/wiki/Text#text-creation",o.Msg.TEXT_JOIN_TITLE_CREATEWITH="create text with",o.Msg.TEXT_JOIN_TOOLTIP="Create a piece of text by joining together any number of items.",o.Msg.TEXT_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",o.Msg.TEXT_LENGTH_TITLE="length of %1",o.Msg.TEXT_LENGTH_TOOLTIP="Returns the number of letters (including spaces) in the provided text.",o.Msg.TEXT_PRINT_HELPURL="https://github.com/google/blockly/wiki/Text#printing-text",o.Msg.TEXT_PRINT_TITLE="print %1",o.Msg.TEXT_PRINT_TOOLTIP="Print the specified text, number or other value.",o.Msg.TEXT_PROMPT_HELPURL="https://github.com/google/blockly/wiki/Text#getting-input-from-the-user",o.Msg.TEXT_PROMPT_TOOLTIP_NUMBER="Prompt for user for a number.",o.Msg.TEXT_PROMPT_TOOLTIP_TEXT="Prompt for user for some text.",o.Msg.TEXT_PROMPT_TYPE_NUMBER="prompt for number with message",o.Msg.TEXT_PROMPT_TYPE_TEXT="prompt for text with message",o.Msg.TEXT_REPLACE_HELPURL="https://github.com/google/blockly/wiki/Text#replacing-substrings",o.Msg.TEXT_REPLACE_MESSAGE0="replace %1 with %2 in %3",o.Msg.TEXT_REPLACE_TOOLTIP="Replace all occurances of some text within some other text.",o.Msg.TEXT_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Text#reversing-text",o.Msg.TEXT_REVERSE_MESSAGE0="reverse %1",o.Msg.TEXT_REVERSE_TOOLTIP="Reverses the order of the characters in the text.",o.Msg.TEXT_TEXT_HELPURL="https://en.wikipedia.org/wiki/String_(computer_science)",o.Msg.TEXT_TEXT_TOOLTIP="A letter, word, or line of text.",o.Msg.TEXT_TRIM_HELPURL="https://github.com/google/blockly/wiki/Text#trimming-removing-spaces",o.Msg.TEXT_TRIM_OPERATOR_BOTH="trim spaces from both sides of",o.Msg.TEXT_TRIM_OPERATOR_LEFT="trim spaces from left side of",o.Msg.TEXT_TRIM_OPERATOR_RIGHT="trim spaces from right side of",o.Msg.TEXT_TRIM_TOOLTIP="Return a copy of the text with spaces removed from one or both ends.",o.Msg.TODAY="Today",o.Msg.UNDO="Undo",o.Msg.UNKNOWN="Unknown",o.Msg.UNNAMED_KEY="unnamed",o.Msg.VARIABLES_DEFAULT_NAME="item",o.Msg.VARIABLES_GET_CREATE_SET="Create 'set %1'",o.Msg.VARIABLES_GET_HELPURL="https://github.com/google/blockly/wiki/Variables#get",o.Msg.VARIABLES_GET_TOOLTIP="Returns the value of this variable.",o.Msg.VARIABLES_SET="set %1 to %2",o.Msg.VARIABLES_SET_CREATE_GET="Create 'get %1'",o.Msg.VARIABLES_SET_HELPURL="https://github.com/google/blockly/wiki/Variables#set",o.Msg.VARIABLES_SET_TOOLTIP="Sets this variable to be equal to the input.",o.Msg.VARIABLE_ALREADY_EXISTS="A variable named '%1' already exists.",o.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE="A variable named '%1' already exists for another type: '%2'.",o.Msg.VARIABLE_ALREADY_EXISTS_FOR_A_PARAMETER="A variable named '%1' already exists as a parameter in the procedure '%2'.",o.Msg.WINDOWS="Windows",o.Msg.WORKSPACE_ARIA_LABEL="Blockly Workspace",o.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT="Say something...",o.Msg.CONTROLS_FOREACH_INPUT_DO=o.Msg.CONTROLS_REPEAT_INPUT_DO,o.Msg.CONTROLS_FOR_INPUT_DO=o.Msg.CONTROLS_REPEAT_INPUT_DO,o.Msg.CONTROLS_IF_ELSEIF_TITLE_ELSEIF=o.Msg.CONTROLS_IF_MSG_ELSEIF,o.Msg.CONTROLS_IF_ELSE_TITLE_ELSE=o.Msg.CONTROLS_IF_MSG_ELSE,o.Msg.CONTROLS_IF_IF_TITLE_IF=o.Msg.CONTROLS_IF_MSG_IF,o.Msg.CONTROLS_IF_MSG_THEN=o.Msg.CONTROLS_REPEAT_INPUT_DO,o.Msg.CONTROLS_WHILEUNTIL_INPUT_DO=o.Msg.CONTROLS_REPEAT_INPUT_DO,o.Msg.LISTS_CREATE_WITH_ITEM_TITLE=o.Msg.VARIABLES_DEFAULT_NAME,o.Msg.LISTS_GET_INDEX_HELPURL=o.Msg.LISTS_INDEX_OF_HELPURL,o.Msg.LISTS_GET_INDEX_INPUT_IN_LIST=o.Msg.LISTS_INLIST,o.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST=o.Msg.LISTS_INLIST,o.Msg.LISTS_INDEX_OF_INPUT_IN_LIST=o.Msg.LISTS_INLIST,o.Msg.LISTS_SET_INDEX_INPUT_IN_LIST=o.Msg.LISTS_INLIST,o.Msg.MATH_CHANGE_TITLE_ITEM=o.Msg.VARIABLES_DEFAULT_NAME,o.Msg.PROCEDURES_DEFRETURN_COMMENT=o.Msg.PROCEDURES_DEFNORETURN_COMMENT,o.Msg.PROCEDURES_DEFRETURN_DO=o.Msg.PROCEDURES_DEFNORETURN_DO,o.Msg.PROCEDURES_DEFRETURN_PROCEDURE=o.Msg.PROCEDURES_DEFNORETURN_PROCEDURE,o.Msg.PROCEDURES_DEFRETURN_TITLE=o.Msg.PROCEDURES_DEFNORETURN_TITLE,o.Msg.TEXT_APPEND_VARIABLE=o.Msg.VARIABLES_DEFAULT_NAME,o.Msg.TEXT_CREATE_JOIN_ITEM_TITLE_ITEM=o.Msg.VARIABLES_DEFAULT_NAME,o.Msg.MATH_HUE="230",o.Msg.LOOPS_HUE="120",o.Msg.LISTS_HUE="260",o.Msg.LOGIC_HUE="210",o.Msg.VARIABLES_HUE="330",o.Msg.TEXTS_HUE="160",o.Msg.PROCEDURES_HUE="290",o.Msg.COLOUR_HUE="20",o.Msg.VARIABLES_DYNAMIC_HUE="310",o.Msg})?le.apply(oo,[]):le)&&(Qo.exports=Be)}}]);